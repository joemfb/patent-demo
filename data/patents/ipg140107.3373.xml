<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08624436-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08624436</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12796489</doc-number>
<date>20100608</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>475</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>02</class>
<subclass>J</subclass>
<main-group>1</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>307 77</main-classification>
</classification-national>
<invention-title id="d2e53">Power harvesting circuit and method for serially coupled DC power sources</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6222344</doc-number>
<kind>B1</kind>
<name>Peterson et al.</name>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6356055</doc-number>
<kind>B1</kind>
<name>Lin et al.</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7023107</doc-number>
<kind>B2</kind>
<name>Okuda et al.</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>307 101</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7688048</doc-number>
<kind>B2</kind>
<name>Nielsen</name>
<date>20100300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>323268</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2005/0024015</doc-number>
<kind>A1</kind>
<name>Houldsworth et al.</name>
<date>20050200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2008/0197806</doc-number>
<kind>A1</kind>
<name>Ridder et al.</name>
<date>20080800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>KR</country>
<doc-number>10-0468127</doc-number>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>WO</country>
<doc-number>2005-112551</doc-number>
<kind>A2</kind>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00009">
<othercit>International Search Report of PCT/US2010/037806, 3 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00010">
<othercit>Written Opinion of the International Searching Authority of PCT/US2010/037806, 3 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00011">
<othercit>Extended EP Search Report Dated Oct. 31, 2013 for EP Application No. 10786705.3.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00012">
<othercit>Toshihisa Shimizu et al., &#x201c;Generation Control Circuit for Photovoltaic Modules&#x201d;, Published May 1, 2001, IEEE Transactions on Power Electronics, IEEE Service Center, Piscataway, NJ, US, Vol. 16, No. 3, pp. 293-300.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00013">
<othercit>Osamu Hasimoto et al., &#x201c;A Novel High Performance Utility Interactive Photovoltaic Inverter System&#x201d;, Published Oct. 8, 2000, Industry Applications Conference 2000, Conference Record of the 2000 IEEE Oct. 8-12, 2000, Piscataway, NJ, US IEEE, vol. 4, pp. 2255-2260.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00014">
<othercit>Roberto Giral et al., &#x201c;Minimizing the Effects of Shadowing in a PV Module by Means of Active Voltage Sharing&#x201d;, Published Mar. 14, 2010, Industrial Technology (ICIT), 2010 IEEE International Conference on, IEEE, Piscataway, NJ, US, pp. 943-948.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>14</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>307 77</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>320116</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>11</number-of-drawing-sheets>
<number-of-figures>12</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61185264</doc-number>
<date>20090609</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20100308660</doc-number>
<kind>A1</kind>
<date>20101209</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Willis</last-name>
<first-name>Andre Poskatcheev</first-name>
<address>
<city>Palo Alto</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Willis</last-name>
<first-name>Andre Poskatcheev</first-name>
<address>
<city>Palo Alto</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
</us-parties>
<examiners>
<primary-examiner>
<last-name>Cavallari</last-name>
<first-name>Daniel</first-name>
<department>2836</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Circuitry and method for maximizing power from multiple DC power sources mutually coupled in series and providing unequal DC currents. Current related to the difference between the unequal DC currents is diverted from the serially coupled sources, captured as magnetic field energy and then added to the DC current provided by the serially coupled sources.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="150.96mm" wi="160.87mm" file="US08624436-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="173.91mm" wi="161.71mm" file="US08624436-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="216.07mm" wi="169.84mm" file="US08624436-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="236.22mm" wi="156.72mm" file="US08624436-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="234.10mm" wi="178.39mm" orientation="landscape" file="US08624436-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="236.98mm" wi="184.32mm" file="US08624436-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="135.97mm" wi="148.51mm" file="US08624436-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="195.50mm" wi="162.39mm" file="US08624436-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="241.98mm" wi="150.88mm" orientation="landscape" file="US08624436-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="217.00mm" wi="183.47mm" orientation="landscape" file="US08624436-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="235.03mm" wi="174.16mm" orientation="landscape" file="US08624436-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="124.97mm" wi="158.33mm" file="US08624436-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This patent application claims priority from U.S. provisional patent application 61/185,264, filed Jun. 9, 2009, and entitled &#x201c;Solar Array Inverter with Per-Panel Maximum Power Point Tracking&#x201d;.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to circuits and methods for harvesting power from energy conversion circuits, and in particular to such circuits and methods for maximizing power harvested from serially coupled DC power sources.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">As is well known in the art, central inverter based energy conversion installations use groups of DC power sources connected in series, sometimes called strings. Examples include biomass, chemical, fuel cells and energy storage batteries. However, long strings of such sources have inherent deficiencies. For example, in the case of solar panels, if panels are shaded or obscured, they generate less photocurrent. Panel currents also may be unbalanced for other reasons. Because solar panels in a series string are constrained to all conduct the same current, the weakest one will limit the power harvest from the remaining solar panels, thereby reducing the overall efficiency of the array. For similar reasons, solar panels in a string should be given the same orientation and be of identical type and size. This is not always possible or desirable for aesthetic or other architectural reasons.</p>
<p id="p-0005" num="0004">Another well-known approach is the microinverter. Microinverters convert solar energy from a single solar panel for feeding to the commercial AC power grid. Although MPPT is done on a per panel basis, thereby maximizing energy harvesting, cost effectiveness of microinverter installations are low due to higher cost per watt and lower efficiency of the electrical conversion.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0006" num="0005">In accordance with the presently claimed invention, circuitry and a method are provided for maximizing power from multiple DC power sources mutually coupled in series and providing unequal DC currents. Current related to the difference between the unequal DC currents is diverted from the serially coupled sources, captured as magnetic field energy and then added to the DC current provided by the serially coupled sources.</p>
<p id="p-0007" num="0006">In accordance with one embodiment of the presently claimed invention, current balancing circuitry includes:</p>
<p id="p-0008" num="0007">first, second and third electrodes for coupling to first and second serially coupled DC power sources to receive</p>
<p id="p-0009" num="0008">via the first and third electrodes, a sum of first and second DC voltages produced by the first and second DC power sources, respectively, and a common DC current produced by the first and second DC power sources, and</p>
<p id="p-0010" num="0009">via the second electrode, a difference DC current substantially equal to a difference between first and second DC currents produced by the first and second DC power sources, respectively;</p>
<p id="p-0011" num="0010">capacitive circuitry coupled to the first, second and third electrodes;</p>
<p id="p-0012" num="0011">switching circuitry coupled between the first and third electrodes;</p>
<p id="p-0013" num="0012">inductive circuitry coupled between the second electrode and the switching circuitry; and</p>
<p id="p-0014" num="0013">control circuitry coupled to the first, second and third electrodes and the switching circuitry, wherein</p>
<p id="p-0015" num="0014">the control circuitry is responsive to the first and second DC voltages and the first and second DC currents by providing a plurality of control signals, and</p>
<p id="p-0016" num="0015">the switching circuitry is responsive to the plurality of control signals by providing a first DC current path between the inductive circuitry and the first electrode during a first time interval, and a second DC current path between the inductive circuitry and the third electrode during a second time interval.</p>
<p id="p-0017" num="0016">In accordance with another embodiment of the presently claimed invention, a method for maximizing power from multiple DC power sources includes:</p>
<p id="p-0018" num="0017">receiving, via first and third electrodes, a sum of first and second DC voltages produced by first and second DC power sources, respectively, and a common DC current produced by the first and second DC power sources;</p>
<p id="p-0019" num="0018">receiving, via a second electrode, a difference DC current substantially equal to a difference between first and second DC currents produced by the first and second DC power sources, respectively;</p>
<p id="p-0020" num="0019">capacitively coupling the first, second and third electrodes; and</p>
<p id="p-0021" num="0020">sensing the first and second DC voltages and the first and second DC currents and in accordance therewith</p>
<p id="p-0022" num="0021">providing, for the difference DC current, a first inductive DC current path between the second and first electrodes during a first time interval, and</p>
<p id="p-0023" num="0022">providing, for the difference DC current, a second inductive DC current path between the second and third electrodes during a second time interval.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic diagram of a power balancer in accordance with one embodiment.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 2</figref> illustrates operation of the power balancer of <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 3</figref> is an exemplary signal timing diagram for the switch control signals used in the power balancer of <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 4</figref> illustrates full and zoomed graphs of current-voltage and power-voltage characteristic curves for a typical solar panel.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 5</figref> is a schematic diagram of a power balancer module implementation with multiple power balancers connected in series in accordance with another embodiment.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 5</figref><i>a </i>is a schematic diagram of a power balancer module implementation with multiple power balancers connected in series in accordance with another embodiment.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 5</figref><i>b </i>is a block diagram of an exemplary embodiment of the control unit of <figref idref="DRAWINGS">FIG. 5</figref><i>a. </i></p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 5</figref><i>c </i>is a flowchart of exemplary embodiments of processes running in the control unit of <figref idref="DRAWINGS">FIG. 5</figref><i>b. </i></p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram of four power balancer modules coupled to provide a DC current to be converted into AC current by a DC/AC converter in accordance with another embodiment.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 6</figref><i>a </i>is a block diagram of a distributed inverter system architecture in accordance with another embodiment.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 7</figref> is a schematic diagram of a DC/AC converter for a 3-phase power grid in accordance with another embodiment.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 7</figref><i>a </i>is a schematic diagram of a DC/AC converter for a single-phase power grid in accordance with another embodiment.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0036" num="0035">The following detailed description is of example embodiments of the presently claimed invention with references to the accompanying drawings. Such description is intended to be illustrative and not limiting with respect to the scope of the present invention. Such embodiments are described in sufficient detail to enable one of ordinary skill in the art to practice the subject invention, and it will be understood that other embodiments may be practiced with some variations without departing from the spirit or scope of the subject invention.</p>
<p id="p-0037" num="0036">Throughout the present disclosure, absent a clear indication to the contrary from the context, it will be understood that individual circuit elements as described may be singular or plural in number. For example, the terms &#x201c;circuit&#x201d; and &#x201c;circuitry&#x201d; may include either a single component or a plurality of components, which are either active and/or passive and are connected or otherwise coupled together (e.g., as one or more integrated circuit chips) to provide the described function. Additionally, absent a clear indication otherwise, the term &#x201c;signal&#x201d; may refer to one or more currents, one or more voltages, or a data signal. Further, while the present invention has been discussed in the context of implementations using discrete electronic circuitry (preferably in the form of one or more integrated circuit chips), the functions of any part of such circuitry may alternatively be implemented using one or more appropriately programmed processors, depending upon the signal frequencies or data rates to be processed. Moreover, to the extent that the figures illustrate diagrams of the functional blocks of various embodiments, the functional blocks are not necessarily indicative of the division between hardware circuitry. Thus, for example, one or more of the functional blocks (e.g., processors, memories, etc.) may be implemented in a single piece of hardware (e.g., a general purpose signal processor, random access memory, hard disk drive, etc.). Similarly, any programs described may be standalone programs, may be incorporated as subroutines in an operating system, may be functions in an installed software package, etc.</p>
<p id="p-0038" num="0037">As discussed in more detail below, the presently claimed invention maximizes harvesting of power from serially coupled DC power sources. As a means for presenting an example application, the discussion that follows is based on an example of conversion of solar energy into AC current to be fed into commercial power grids, with increased conversion efficiency and cost effectiveness of the conversion. Higher solar energy harvesting is achieved using MPPT for each solar panel. Based on published statistical data, such per-module MPPT contributes to energy harvest gains of 5-25% for typical solar installations. Maintenance of solar installations additionally benefits from continuous monitoring of the performance of each photovoltaic module. A further advantage is an absence of high DC voltage wiring on a roof.</p>
<p id="p-0039" num="0038">Referring to <figref idref="DRAWINGS">FIG. 1</figref>, an important feature of the presently claimed invention is a power balancer. As shown for this exemplary embodiment, two solar panels PV<b>1</b> <b>100</b>, PV<b>2</b> <b>101</b> are connected in series. If they have identical characteristics, a MPPT converter will find a point at which both panels deliver maximum power. If they are not identical, the weaker panel will limit the power harvested from the stronger one. For example, if one panel PV<b>1</b> is shaded and produces one ampere less current than the other panel PV<b>2</b>, the power balancer allows a MPPT converter to harvest more power from both panels, e.g., by compensating for the mismatch between the panels.</p>
<p id="p-0040" num="0039">In accordance with one embodiment, the power balancer includes capacitors C<b>1</b> <b>102</b>, C<b>2</b> <b>103</b>, an inductor L<b>1</b> <b>104</b>, switches SW<b>1</b> <b>105</b>, SW<b>2</b> <b>106</b> (e.g., metal oxide semiconductor field effect transistors (MOSFETs)), and a control unit <b>107</b>, interconnected substantially as shown. If the switches <b>105</b>, <b>106</b> are operated with a 50% duty cycle, the power balancer will maintain substantially equal voltages on the panels PV<b>1</b>, PV<b>2</b> independent from the currents produced by the panels PV<b>1</b>, PV<b>2</b>.</p>
<p id="p-0041" num="0040">Suppose panel PV<b>1</b> produces current I<sub>1 </sub>and panel PV<b>2</b> produces I<sub>2</sub>=I<sub>1</sub>+I<sub>delta</sub>. If the power balancer is not used, a MPPT converter would receive total current I<sub>1 </sub>and I<sub>delta </sub>would not be recovered, or harvested. The purpose of the power balancer is to harvest this additional current I<sub>delta </sub>from panel PV<b>2</b> and deliver the extra power associated with it to the MPPT.</p>
<p id="p-0042" num="0041">Referring to <figref idref="DRAWINGS">FIG. 2</figref>, operation of the power balancer can be compared to that of a classic boost converter. During the interval that switch SW<b>2</b> <b>200</b> is closed, switch SW<b>1</b> <b>203</b> is open and the current difference I<sub>2</sub>&#x2212;I<sub>1</sub>=I<sub>delta </sub>is conducted via PATH<b>1</b> <b>202</b> and energy accumulates in the magnetic field of the inductor L<b>1</b> <b>201</b>. During the interval that switch SW<b>1</b> <b>203</b> is closed, switch SW<b>2</b> <b>200</b> is open and current is conducted via PATH<b>2</b> <b>205</b> and the energy previously stored in the inductor L<b>1</b> <b>201</b> is delivered as additional current (having an average magnitude I<sub>added </sub>related to the difference current I<sub>delta </sub>of the solar panels PV<b>1</b>, PV<b>2</b>, and ideally equal to I<sub>delta</sub>*V<sub>PV2</sub><sup>mpp</sup>/(V<sub>PV1</sub><sup>mpp</sup>+V<sub>PV2</sub><sup>mpp</sup>) to the MPPT converter <b>204</b>. Thus the power balancer converts only the unbalanced portion of energy <b>206</b> but does not affect the balanced portion of the energy associated with current I<sub>1</sub>, which goes directly to the MPPT converter <b>204</b>. Accordingly, the efficiency of energy conversion in the power balancer is substantially proportional to the magnitude of the unbalanced portion of energy <b>206</b>. The capacitance values of the capacitors C<b>1</b> <b>204</b>, C<b>2</b> <b>203</b> are not critical, but should be selected based on criteria including switching frequency of the switches SW<b>1</b> <b>105</b>, SW<b>2</b> <b>106</b> and maximum allowed panel mismatch. Also, the capacitance values should be sufficiently high to ensure that the voltage ripple across them does not cause the voltages across the solar panels PV<b>1</b>, PV<b>2</b> to deviate too much from the maximum power point (MPP) voltages of the panels PV<b>1</b>, PV<b>2</b>. This will maintain close to maximum energy harvesting from the solar panels. For a typical crystalline silicon solar panel, 99.5% energy harvest will be achieved if voltage ripples are about 5% (peak-to-peak) from panel MPP voltages.</p>
<p id="p-0043" num="0042">Referring to <figref idref="DRAWINGS">FIG. 4</figref>, further improvement in power harvesting can be obtained by optimizing voltages individually for each panel. Graph <b>400</b> illustrates current-voltage and power-voltage characteristic curves for a typical solar panel. For example, the &#x201c;PV<b>1</b> I-V curve&#x201d; corresponds to panel PV<b>1</b> <b>100</b>, which is shaded, while the &#x201c;PV<b>2</b> I-V curve&#x201d; corresponds to panel PV<b>2</b> <b>101</b>, which is not shaded. Zoomed graph <b>401</b> shows that maximum power for panel PV<b>2</b> is reached at a slightly higher voltage than for panel PV<b>1</b>, e.g., V<sub>PV2</sub><sup>mpp </sup><b>402</b> and V<sub>pv1</sub><sup>mpp </sup><b>403</b>, respectively. This optimization is performed by a secondary (e.g., slower) optimization loop in the control unit <b>107</b> (<figref idref="DRAWINGS">FIG. 1</figref>) based on measurements of the voltages V<sub>1 </sub><b>108</b>, V<sub>2 </sub><b>109</b> and currents I<sub>1 </sub><b>110</b>, I<sub>2 </sub><b>111</b> (discussed in more detail below).</p>
<p id="p-0044" num="0043">Referring to <figref idref="DRAWINGS">FIG. 3</figref>, the control unit <b>107</b> sets the duty cycle of the control signals for opening and closing the switches SW<b>1</b>, SW<b>2</b> as follows: T<sub>1</sub>/T<sub>2</sub>=V<sub>PV2</sub><sup>mpp</sup>/V<sub>PV1</sub><sup>mpp</sup>, where V<sub>PV1</sub><sup>mpp </sup>and V<sub>PV2</sub><sup>mpp </sup>are optimal voltages on panels PV<b>1</b> and PV<b>2</b>, respectively, and T<sub>1 </sub>and T<sub>2 </sub>are pulse widths of the control signals SW<sub>1 </sub><b>300</b>, SW<sub>2 </sub><b>301</b>, respectively.</p>
<p id="p-0045" num="0044">Referring to <figref idref="DRAWINGS">FIG. 5</figref>, in accordance with another embodiment, a similar technique can be applied to maximize the power harvested from more than two solar panels, e.g., in a multi-balancer power harvest maximizer module implementation having four solar panels PV<b>1</b> <b>500</b>, PV<b>2</b> <b>501</b>, PV<b>3</b> <b>502</b>, PV<b>4</b> <b>503</b> connected in series. Three power balancers are used to balance the four panels, which are arranged as two balanced pairs. Power balancing of each pair of solar panels PV<b>1</b>+PV<b>2</b>, PV<b>3</b>+PV<b>4</b>, operates as described above. The third power balancer balances the two pairs of solar panels PV<b>1</b>+PV<b>2</b>, PV<b>3</b>+PV<b>4</b>. As a result, all four panels get balanced and provide power for the MPPT converter <b>504</b>. The MPPT converter <b>504</b> includes an inductor L<b>4</b> <b>505</b>, a switch SW<b>7</b> <b>506</b> (e.g., a MOSFET), a diode D<b>1</b> <b>507</b>, and a capacitor C<b>5</b> <b>508</b>, interconnected substantially as shown, which operate as an efficient boost converter.</p>
<p id="p-0046" num="0045">The control unit <b>509</b> implements four optimization loops. The fastest loop tracks the MPP for all four balanced panels by controlling the duty cycle of the switch SW<b>7</b> <b>506</b> of the MPPT converter <b>504</b>. Two slower optimization loops (preferably identical) optimize the individual solar panels within the solar panel pairs. Solar panel pair PV<b>1</b>+PV<b>2</b> is controlled by the switching duty cycles of their switches SW<b>1</b> <b>510</b>, SW<b>2</b> <b>511</b>, while solar panel pair PV<b>3</b>+PV<b>4</b> is controlled by the switching duty cycles of their switches SW<b>3</b> <b>512</b>, SW<b>4</b> <b>513</b>. The slowest optimization loop balances the solar panel pairs PV<b>1</b>+PV<b>2</b>, PV<b>3</b>+PV<b>4</b> as a group by controlling the switching duty cycles of its switches SW<b>5</b> <b>514</b>, SW<b>6</b> <b>515</b>.</p>
<p id="p-0047" num="0046">Referring to <figref idref="DRAWINGS">FIG. 5</figref><i>a</i>, in accordance with another embodiment, a power balancer for multiple solar panels can implemented for an odd number of solar panels. For example, five solar panels can be balanced by four power balancer circuits, arranged in a way that reduces the maximum voltage applied to any single power balancer. In this implementation, a single power balancer circuit is used to balance each electrically adjacent pair in the series-connected solar panels (as discussed above), where each solar panel pair is balanced by interleaving power balancer circuits as shown. Operation of the interleaved power balancers is such that the optimized voltage ratios are maintained among all solar panels in the series. The first power balancer <b>502</b><i>a </i>which includes two switches SW<b>1</b>, SW<b>2</b> and maintains a ratio of voltages on its associated solar panels PV<b>1</b>, PV<b>2</b> substantially equal to the inverse ratio of the duty cycle of the states of the switches SW<b>1</b>, SW<b>2</b>. Similarly, the second power balancer <b>504</b><i>a </i>defines the voltage ratio between its associated solar panels PV<b>2</b>, PV<b>3</b>, and so forth for all panels in the chain. Thus the five solar panels PV<b>1</b>, PV<b>2</b>, PV<b>3</b>, PV<b>4</b>, PV<b>5</b> have their respective voltage ratios defined by four power balancer circuits <b>502</b><i>a</i>, <b>504</b><i>a</i>, <b>505</b><i>a</i>, <b>506</b><i>a</i>, and provide power to the MPPT converter <b>507</b><i>a </i>as discussed above. In the general case of this implementation, N solar panels connected in series can be balanced by N&#x2212;1 power balancer circuits.</p>
<p id="p-0048" num="0047">Referring to <figref idref="DRAWINGS">FIG. 5</figref><i>b</i>, in accordance with one embodiment, the control units <b>107</b>, <b>509</b><i>a</i>, <b>508</b><i>a </i>of <figref idref="DRAWINGS">FIGS. 1</figref>, <b>5</b> and <b>5</b><i>a </i>can be implemented substantially as shown. Voltage and current sensing of the solar panel voltages and currents, respectively, are performed using transducers <b>501</b><i>b</i>, <b>502</b><i>b</i>, <b>503</b><i>b</i>, <b>504</b><i>b </i>provide analog voltages proportional to the solar panel voltages and currents for conversion by an analog-to-digital converter (ADC) <b>505</b><i>b</i>. The MPPT feedback voltage is also digitized by the ADC <b>505</b><i>b</i>. The ADC <b>505</b><i>b </i>supplies these converted signals as digitized measurement data to a microprocessor <b>507</b><i>b</i>, which, in concert with its associated data memory <b>506</b><i>b </i>(e.g., random access memory (RAM)) and program memory <b>508</b><i>b </i>(e.g., read only memory (ROM)), performs computational algorithms (discussed in more detail below). The results are written to switch pulse forming logic <b>509</b><i>b</i>, e.g., implemented using a field programmable gate array (FPGA). Output pulses from the switch pulse forming logic <b>509</b><i>b </i>is converted to appropriate levels by signal drivers <b>510</b><i>b </i>(e.g., MOSFET drivers) for driving the power balancer and MPPT converter switches, as discussed above.</p>
<p id="p-0049" num="0048">Referring to <figref idref="DRAWINGS">FIG. 5</figref><i>c</i>, in accordance with exemplary embodiments, operation of the control units, e.g., as depicted in <figref idref="DRAWINGS">FIG. 5</figref><i>b</i>, can proceed as shown. Following initialization <b>501</b><i>c </i>of the MPPT converter control loop, the switch control pulse width is increased <b>502</b><i>c </i>by a small increment of dTm, after which the sum of the power for all solar panels is calculated <b>503</b><i>c</i>, according to the formula
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>P</i><sub>current</sub><i>=V</i>1<i>*I</i>1<i>+V</i>2*<i>I</i>2+ . . . +<i>Vn*In </i><?in-line-formulae description="In-line Formulae" end="tail"?>
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0049">where: Vn=voltage from solar panel N
        <ul id="ul0003" list-style="none">
            <li id="ul0003-0001" num="0050">In=current from solar panel N</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0050" num="0051">This newly computed power P<sub>current </sub>is compared <b>504</b><i>c </i>with the previously stored power P<sub>previous</sub>. If the current power P<sub>current </sub>is higher than the previous power P<sub>previous</sub>, the stored value for power is updated <b>506</b><i>c </i>with the current value, and the loop continues. Otherwise, the sign of the switch control pulse increment dTm is reversed <b>505</b><i>c</i>, and the loop continues.</p>
<p id="p-0051" num="0052">Similarly, a slower power balancer control loop is initialized <b>507</b><i>c</i>, followed by a change <b>508</b><i>c </i>in the balancer switch timing. The timing relationship between two switches in a power balancer (<figref idref="DRAWINGS">FIG. 3</figref>) is altered by increasing the duty cycle T<b>1</b> of one switch control signal SW<sub>1 </sub>by an amount dTn and decreasing the duty cycle T<b>2</b> of the other switch control signal SW<sub>2 </sub>by the same amount dTn. Power is measured <b>509</b><i>c </i>as before, but only for those solar panels attached to the power balancer. This value P<sub>current </sub>is compared <b>510</b><i>c </i>with the previously stored power P<sub>previous</sub>. If the current power P<sub>current </sub>is higher than the previous previous power P<sub>previous</sub>, the stored value for power is updated <b>512</b><i>c </i>with the current value, and the loop continues <b>513</b><i>c </i>for the next power balancer. Otherwise, the sign of the switch control pulse increment dTn is reversed <b>511</b><i>c</i>, and the loop continues, as discussed above.</p>
<p id="p-0052" num="0053">Referring to <figref idref="DRAWINGS">FIG. 6</figref>, the output of a MPPT converter acts as a current source, thereby allowing several MPPT converters to be connected in parallel, e.g., four parallel-connected MPPT converters M<b>1</b> <b>600</b>, M<b>2</b> <b>601</b>, M<b>3</b> <b>602</b>, M<b>4</b> <b>603</b> (identified as &#x201c;Power Harvest Maximizer Modules&#x201d;). The DC current generated by them is converted into AC current by a DC/AC converter <b>604</b>.</p>
<p id="p-0053" num="0054">Referring to <figref idref="DRAWINGS">FIG. 6</figref><i>a</i>, the stand-alone nature of the power harvest maximizer module makes it practical to separate this function physically from the grid-connected DC-to-AC inverter function. This allows a distributed inverter system architecture, as shown. In this implementation, two or more solar panels <b>601</b><i>a </i>are connected to and optimized by one or more power harvest maximizer modules <b>602</b><i>a</i>. Each power harvest maximizer module serves one or more solar panels and includes one MPPT converter and an appropriate number of balancers for the number of solar panels connected. Two or more power harvest maximizer modules are then connected to the DC-to-3-phase AC converter <b>603</b><i>a</i>. A monitoring and control gateway interface <b>605</b><i>a </i>provides a means for monitoring of the system via power line communications and provides a communication bridge to allow local and remote interaction with the power system for status monitoring and control.</p>
<p id="p-0054" num="0055">Referring to <figref idref="DRAWINGS">FIG. 7</figref>, shows an implementation of a DC/AC converter for providing power to a 3-phase power grid. The DC current goes into a chopper <b>700</b>, which produces a high frequency (e.g., &#x3e;20 KHz) voltage for a step-up transformer T<b>1</b> <b>701</b>. The galvanically isolated output of the transformer T<b>1</b> is rectified with a rectifier <b>702</b> to produce a DC voltage across a filter capacitor C<b>1</b> <b>703</b>. Six switches SW<b>1</b> <b>704</b>, SW<b>2</b> <b>705</b>, SW<b>3</b> <b>706</b>, SW<b>4</b> <b>707</b>, SW<b>5</b> <b>708</b>, SW<b>6</b> <b>709</b> (e.g., MOSFETs or insulated gate bipolar transistors (IGBTs)) produce a 3-phase AC voltage which is filtered by a filter circuit <b>710</b> for delivery to a commercial 3-phase power grid.</p>
<p id="p-0055" num="0056">A control unit <b>711</b> monitors the 3-phase grid voltage V<sub>3-phase </sub>and current I<sub>3-phase</sub>, and generates control pulses for the switches SW<b>1</b>, SW<b>2</b>, SW<b>3</b>, SW<b>4</b>, SW<b>5</b>, SW<b>6</b> to deliver energy to the grid with proper phases. If galvanic isolation is not required for standards compliance, the DC input voltage V<sub>inp </sub>can be applied directly to the filter capacitor <b>703</b>, thereby eliminating the need for the chopper <b>700</b>, transformer T<b>1</b> <b>701</b> and rectifier <b>702</b>.</p>
<p id="p-0056" num="0057">The above architecture advantageously maximizes efficiency of DC/AC power conversion by keeping the conversion ratio V<sub>rect</sub>/V<sub>inp </sub>constant. As a result, the input DC voltage V<sub>inp </sub>tracks the grid voltage. The rectified DC voltage V<sub>rect </sub>across the switches SW<b>1</b>, SW<b>2</b>, SW<b>3</b>, SW<b>4</b>, SW<b>5</b>, SW<b>6</b> is kept at the minimal level required to provide an undistorted output waveform for the current grid voltage. In this architecture, matching of varying solar energy and varying grid voltage is performed in one place, i.e., the MPPT converter <b>504</b> (<figref idref="DRAWINGS">FIG. 5</figref>).</p>
<p id="p-0057" num="0058">Referring to <figref idref="DRAWINGS">FIG. 7</figref><i>a</i>, in accordance with another embodiment, the power harvest maximizer can be used in single phase power inverters. As discussed above, the solar panels provide a continuous flow of energy. Because energy cannot be continuously supplied to the single phase grid, an energy storage buffer is required. Such energy storage can be implemented as a capacitor <b>701</b><i>a</i>, as shown. The sum of the voltage across the series-connected, balanced solar panels applied to the MPPT boost converter results in a high power harvest maximizer module output voltage. Because energy stored in the capacitor is proportional to the square of the applied voltage, this results in a corresponding reduction in the physical size of the capacitive storage element compared to existing single solar panel inverters. Voltage ripple present across the capacitor <b>701</b><i>a </i>can be isolated from the solar panels by an appropriate power harvest maximizer module control algorithm, further reducing the size of the capacitor <b>701</b><i>a. </i></p>
<p id="p-0058" num="0059">Based upon the foregoing discussion, in accordance with the presently claimed invention, it can be seen that: a power balancer is provided that improves energy harvesting from serially coupled DC power sources such as solar panels by compensating mismatches between the solar panels; such a power balancer can be used to balance more than two solar panels; the MPPT converter, which acts as a current source, allows multiple converters to be connected in parallel for summing their output currents; a highly efficient architecture is provided for a DC/AC power converter that compensates for varying solar energy levels and varying grid voltages in a single place in the energy conversion chain; and multi-loop control algorithms are provided for optimizing system performance.</p>
<p id="p-0059" num="0060">Various other modifications and alternations in the structure and method of operation of this invention will be apparent to those skilled in the art without departing from the scope and the spirit of the invention. Although the invention has been described in connection with specific preferred embodiments, it should be understood that the invention as claimed should not be unduly limited to such specific embodiments. It is intended that the following claims define the scope of the present invention and that structures and methods within the scope of these claims and their equivalents be covered thereby.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An apparatus including current balancing circuitry, comprising:
<claim-text>first, second and third electrodes for coupling to first and second serially coupled DC power sources to receive
<claim-text>via said first and third electrodes, a sum of first and second DC voltages produced by said first and second DC power sources, respectively, and a common DC current produced by said first and second DC power sources, and</claim-text>
<claim-text>via said second electrode, a difference DC current substantially equal to a difference between first and second DC currents produced by said first and second DC power sources, respectively;</claim-text>
</claim-text>
<claim-text>capacitive circuitry coupled to said first, second and third electrodes;</claim-text>
<claim-text>switching circuitry coupled between said first and third electrodes;</claim-text>
<claim-text>inductive circuitry coupled between said second electrode and said switching circuitry; and</claim-text>
<claim-text>control circuitry coupled to said first, second and third electrodes and said switching circuitry, wherein
<claim-text>said control circuitry is responsive to measured values of said first and second DC voltages and measured values of said first and second DC currents by providing a plurality of control signals, and</claim-text>
<claim-text>said switching circuitry is responsive to said plurality of control signals by providing a first DC current path between said inductive circuitry and said first electrode during a first time interval, and a second DC current path between said inductive circuitry and said third electrode during a second time interval.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said capacitive circuitry comprises:
<claim-text>a first capacitance coupled between said first and second electrodes; and</claim-text>
<claim-text>a second capacitance coupled between said second and third electrodes.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said inductive circuitry comprises an inductance coupled between said second electrode and said switching circuitry.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said difference DC current is conducted via said inductive circuitry during said first and second time intervals.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said switching circuitry comprises:
<claim-text>a first switching device coupled between said first electrode and said inductive circuitry; and</claim-text>
<claim-text>a second switching device coupled between said third electrode and said inductive circuitry.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The apparatus of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein said inductive circuitry comprises an inductance coupled between said second electrode and said first and second switching devices.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The apparatus of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein said difference DC current is conducted:
<claim-text>via said inductive circuitry and said first switching device during said first time interval; and</claim-text>
<claim-text>via said inductive circuitry and said second switching device during said second time interval.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein a ratio of said first and second time intervals is proportional to a ratio of said first and second DC voltages.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A method for maximizing power from multiple DC power sources, comprising:
<claim-text>receiving, via first and third electrodes, a sum of first and second DC voltages produced by first and second DC power sources, respectively, and a common DC current produced by said first and second DC power sources;</claim-text>
<claim-text>receiving, via a second electrode, a difference DC current substantially equal to a difference between first and second DC currents produced by said first and second DC power sources, respectively;</claim-text>
<claim-text>capacitively coupling said first, second and third electrodes; and</claim-text>
<claim-text>measuring said first and second DC voltages and said first and second DC currents and in accordance with measured values thereof
<claim-text>providing, for said difference DC current, a first inductive DC current path between said second and first electrodes during a first time interval, and</claim-text>
<claim-text>providing, for said difference DC current, a second inductive DC current path between said second and third electrodes during a second time interval.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein said capacitively coupling said first, second and third electrodes comprises:
<claim-text>capacitively coupling said first and second electrodes; and</claim-text>
<claim-text>capacitively coupling said second and third electrodes.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein:
<claim-text>said providing, for said difference DC current, a first inductive DC current path between said second and first electrodes during a first time interval comprises inductively coupling said second and first electrodes during said first time interval; and</claim-text>
<claim-text>said providing, for said difference DC current, a second inductive DC current path between said second and third electrodes during a second time interval comprises inductively coupling said second and third electrodes during said second time interval.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein:
<claim-text>said providing, for said difference DC current, a first inductive DC current path between said second and first electrodes during a first time interval comprises conveying said difference DC current via an inductance and a first switching device; and</claim-text>
<claim-text>said providing, for said difference DC current, a second inductive DC current path between said second and third electrodes during a second time interval comprises conveying said difference DC current via said inductance and a second switching device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein said difference DC current is conducted via an inductance during said first and second time intervals.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein a ratio of said first and second time intervals is proportional to a ratio of said first and second DC voltages. </claim-text>
</claim>
</claims>
</us-patent-grant>
