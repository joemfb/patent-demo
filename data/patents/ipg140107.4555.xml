<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625641-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625641</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13250324</doc-number>
<date>20110930</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>CN</country>
<doc-number>2009 1 0106520</doc-number>
<date>20090402</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>263</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>J</subclass>
<main-group>3</main-group>
<subgroup>06</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>370503</main-classification>
</classification-national>
<invention-title id="d2e71">Apparatus, method, and system for synchronizing time</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>8116405</doc-number>
<kind>B2</kind>
<name>Cho et al.</name>
<date>20120200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375316</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2006/0209901</doc-number>
<kind>A1</kind>
<name>Kim</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2008/0075217</doc-number>
<kind>A1</kind>
<name>Ilnicki et al.</name>
<date>20080300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>CN</country>
<doc-number>1866803</doc-number>
<kind>A</kind>
<date>20061100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>CN</country>
<doc-number>1866813</doc-number>
<kind>A</kind>
<date>20061100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>CN</country>
<doc-number>1925386</doc-number>
<kind>A</kind>
<date>20070300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>CN</country>
<doc-number>101296048</doc-number>
<kind>A</kind>
<date>20071000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>CN</country>
<doc-number>101252404</doc-number>
<kind>A</kind>
<date>20080800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>CN</country>
<doc-number>101296070</doc-number>
<kind>A</kind>
<date>20081000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>CN</country>
<doc-number>101299749</doc-number>
<kind>A</kind>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>CN</country>
<doc-number>101345763</doc-number>
<kind>A</kind>
<date>20090100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>CN</country>
<doc-number>101534185</doc-number>
<kind>A</kind>
<date>20090900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>WO</country>
<doc-number>2008/093600</doc-number>
<kind>A1</kind>
<date>20080800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>WO</country>
<doc-number>WO 2008103170</doc-number>
<kind>A1</kind>
<date>20080800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00015">
<othercit>International Search Report in corresponding PCT Application No. PCT/CN2010/071519 (Jul. 8, 2010).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00016">
<othercit>Written Opinion of the International Searching Authority in corresponding PCT Application No. PCT/CN2010/071519 (Jul. 8, 2010).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00017">
<othercit>Extended European Search Report in corresponding European Patent Application No. 10758065.6 (Apr. 20, 2012).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00018">
<othercit>He et al., &#x201c;XP015059948&#x2014;Time Synchronization Method in Packet-Switched Transport Network for Mobile Backhaul,&#x201d; Internet Draft, Oct. 27, 2008, Internet Society, Geneva, Switzerland.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00019">
<othercit>Jasperneite et al., &#x201c;XP010756406&#x2014;Enhancements to the Time Synchronization Standard IEEE-1588 for a System of Cascaded Bridges,&#x201d; IEEE International Workshop, Sep. 22, 2004, IEEE, Piscataway, New Jersey.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00020">
<othercit>Rodrigues, &#x201c;XP031161293&#x2014;IEEE-1588 and Synchronous Ethernet in Telecom,&#x201d; International IEEE Symposium on Precision Clock Synchronization for Measurement, Control, and Communication, Oct. 1, 2007, IEEE, Piscataway, New Jersey.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>9</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>7</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>PCT/CN2010/071519</doc-number>
<date>20100402</date>
</document-id>
<parent-status>PENDING</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13250324</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120020376</doc-number>
<kind>A1</kind>
<date>20120126</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Liang</last-name>
<first-name>Bing</first-name>
<address>
<city>Beijing</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Liang</last-name>
<first-name>Bing</first-name>
<address>
<city>Beijing</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Leydig, Voit &#x26; Mayer, Ltd.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Huawei Technologies Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Hailu</last-name>
<first-name>Kibrom T</first-name>
<department>2461</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The present invention relates to an apparatus, method and system for synchronizing time. The method includes: extracting line clock frequency information from an input line code stream, and extracting a time synchronization packet from a packet stream corresponding to the input line code stream; sending the input line code stream after extracting the line clock frequency information and the time synchronization packet to a packet switching device; receiving an output line code stream sent by the packet switching device; and calibrating local time according to the line clock frequency information and the time synchronization packet, recovering line clock frequency information of the output line code stream according to the calibrated local time, and inserting a time synchronization response packet into a packet stream corresponding to the output line code stream. In this way, the time synchronization network may be deployed without requiring the packet switching device to support time synchronization.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="94.91mm" wi="156.38mm" file="US08625641-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="254.68mm" wi="173.65mm" file="US08625641-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="260.18mm" wi="166.88mm" file="US08625641-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="169.59mm" wi="177.04mm" file="US08625641-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="236.98mm" wi="166.88mm" file="US08625641-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="131.40mm" wi="170.26mm" file="US08625641-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is a continuation of International Application No. PCT/CN2010/071519, filed on Apr. 2, 2010, which claims priority to Chinese Patent Application No. 200910106520.X, filed on Apr. 2, 2009, both of which are hereby incorporated by reference in their entireties.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to the network communication field, and in particular, to an apparatus, a method and a system for synchronizing time.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">Synchronization is a commonly used term in communication networks. Synchronization includes frequency synchronization and time synchronization.</p>
<p id="p-0005" num="0004">The frequency synchronization is also known as clock synchronization, and means that the working clock frequency value of one device maintains a strict fixed specific relation with that of another device being separate from said one device. The strict fixed specific relation is the same or is in a fixed proportion. For example, if device A works at 2048000.000 Hz and device B works at 4096000.000 Hz, device A is synchronized with device B; if device B works at 4096001 Hz, device A is not synchronized with device B. The synchronicity is not completely precise, and allows for a certain range of errors. Generally, the precision is required to be within several Parts Per Billion (ppb).</p>
<p id="p-0006" num="0005">The pulses transmitted in a digital communication network are Pulse Code Modulation (PCM) discrete pulses which derive from coded information. If the clock frequency of one digital switching device is inconsistent with that of another digital switching device, or, if phase drift and jitters is superimposed after the digital bit streams are impaired by interference in the transmission process, code elements may be lost or repeated in the buffer store of the digital switching system, causing slip impairment in the transmitted bit streams.</p>
<p id="p-0007" num="0006">The time synchronization is also known as clock phase synchronization, and means that the internal time of one device and that of another device being separate from said one device are the same (in the range of allowable error). Supposing that at specific time, the time recorded by device A is 18:01, and the time recorded by device B is also 18:01, the time recorded by said one device and that recorded by said another device are synchronized. Different demands require different precision of time synchronization. General computer applications need to be accurate to milliseconds, and mobile communication technologies need to be accurate to microseconds.</p>
<p id="p-0008" num="0007">The time synchronization differs from the frequency synchronization in that: If the time of one device and that of another device are always consistent, this state is called the time synchronization (or phase synchronization); if the time of one device is different from that of another device, but the difference is constant, this state is called the frequency synchronization.</p>
<p id="p-0009" num="0008">Phase-Locked Loop (PLL) is a commonly used synchronization technology, and has three main functional modules: a frequency division phase discriminator, a low-pass filter, and a voltage-controlled oscillator.</p>
<p id="p-0010" num="0009">The voltage-controlled oscillator may output clock frequency independently, and change the output frequency according to an input voltage signal. The frequency division phase discriminator is configured to compare the speed of two frequencies. The low-pass filter may convert this speed information into voltage information, and meanwhile filter some jitters out.</p>
<p id="p-0011" num="0010">Traditional telecom networks have a perfect mechanism for publishing line clock frequencies. A clock source provides an external line interface, and synchronizes the clock frequency of the external interface with its internal frequency (such as atomic clock frequency). A downstream device recovers clock from the line first, and then synchronizes its internal clock with the line clock, and finally synchronizes all line output clocks with the internal clock. In this way, the whole network may be synchronized to be in a same clock frequency.</p>
<p id="p-0012" num="0011">Ethernet is an asynchronous network, and does not require the same working frequency between separate devices. Definitely, to ensure interworking between devices, the clock frequency difference between devices is limited to 100 ppm, which is 2000 times greater than the clock frequency difference in the traditional telecom network (namely 50 ppb).</p>
<p id="p-0013" num="0012">IP-based network is an irresistible trend for the future network, so it is necessary to provide synchronization features in IP networks. At present, the IP network should provide performance of 50 ppb clock frequency synchronization and 3-microsecond time synchronization.</p>
<p id="p-0014" num="0013">BITS is short for Building integrated time system. Building Integrated Time System (BITS) networks can provide clock synchronization function for communication equipment in the equipment room of buildings. A BITS network includes a local clock source and a cabling network in the building. However, a BITS device, in fact, merely refers to a clock source device, which is generally a rubidium atomic clock with GPS calibration in communication applications.</p>
<p id="p-0015" num="0014">The local clock source inside the BITS device is output to devices requiring clocks through a dedicated interface. A mainstream clock interface is a frequency interface capable of outputting a clock frequency of 2 MHz/2M bits, and is generally known as a BITS interface.</p>
<p id="p-0016" num="0015">Another interface is One Pulse per Second (1PPS) interface, which is a time interface, namely, outputs a time pulse signal per second.</p>
<p id="p-0017" num="0016">The BITS interface and the 1PPS interface are key interfaces indispensible to clock devices.</p>
<p id="p-0018" num="0017">Synchronous Ethernet is a technology to recover clocks by adopting Ethernet link code streams. As mentioned above, Ethernet is an asynchronous system and can work normally without requiring high-precision clocks, so general Ethernet devices do not provide high-precision clocks. But that does not mean the Ethernet is incapable of providing high-precision clocks. In fact, on the physical layer, the Ethernet transmits signals in the form of serial code streams like the traditional optical network device, and a receiver must have clock recovery function. If the receiver does not have the clock recovery function, communication is impossible. In other words, the Ethernet itself is capable of transmitting clocks, but the capability is not put into use.</p>
<p id="p-0019" num="0018">In a synchronous Ethernet, the transmitter imports a high-precision clock into the physical-layer chip of the Ethernet, and the physical-layer chip uses the high-precision clock to send data. The physical-layer chip in the receiver may extract the clock out of the line code stream, and during this process the clock precision is not impaired. That is the basic principles of the synchronous Ethernet.</p>
<p id="p-0020" num="0019">Same as traditional telecom optical network devices, the synchronous network technology needs support of the whole network. As long as one device on the clock link does not support the synchronous Ethernet, the downstream devices are all incapable of obtaining the clock frequency. However, almost none of the existing IP networks support the synchronous Ethernet. Therefore, the deployment of a synchronous Ethernet requires replacement of devices throughout the whole network, which is not practicable. Moreover, the synchronous Ethernet supports the frequency synchronization only, but does not support the time synchronization.</p>
<p id="p-0021" num="0020">Currently, the main solutions to time synchronization on an Internet Protocol (IP) network are: Network Time Protocol (NTP), and a precise clock synchronization protocol of a network measurement and control system (IEEE1588). The NTP is mature and widely supported, but provides precision as low as milliseconds, which is far from enough to meet requirements.</p>
<p id="p-0022" num="0021">The basic synchronization procedures of the IEEE1588 include: A slave clock sends a time synchronization packet that carries a timestamp to a master clock; the master clock receives the packet and returns a time synchronization response packet, and records the local time at the moment of receiving the packet and the local time at the moment of sending the response packet into the time synchronization response packet; the slave clock calculates the bidirectional delays between the slave clock and the peer clock according to four timestamps; supposing that the bidirectional delays are equal, the slave clock can calculate the difference between the local time and the remote time, and then adjust the local time accordingly until the local time is synchronized with the peer time.</p>
<p id="p-0023" num="0022">The IEEE 1588 theoretically depends on a prerequisite, that is, the bidirectional delays for a packet are equal. Delay in an IP network may be divided into two types: line delay and device forwarding delay. The line delay is fixed, and the bidirectional delays for the packet are equal after the factor that the fiber path for sending the packet is not equal to the fiber path for receiving the packet is eliminated. The forwarding delay is caused by the devices which store and forward packets (such as routers and switches). The forwarding delay is uncertain, and changes between microseconds and milliseconds. When the IP network is congested, the forwarding delay is even longer.</p>
<p id="p-0024" num="0023">In order to improve synchronization precision, many devices adopt a processing method of internal shunting. For IEEE1588 packets, the uplink interface extracts time information, and sends the time information to the downstream interface through an out-band channel (bypassing the switching chip), and the packet is sent out of the downlink interface. In this way, the uncertainty of the delay caused by the switching chip is eliminated, and the final precision can meet requirements.</p>
<p id="p-0025" num="0024">The IEEE1588 needs to be deployed throughout the network. If any device on the clock link does not support the IEEE1588, the downstream devices are incapable of obtaining enough precise synchronization. The upgrade of the existing IP network requires replacement of devices throughout the whole network, which is hard to realize.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0026" num="0025">Embodiments of the present invention are directed to providing an apparatus, a method and a system for synchronizing time to upgrade an existing IP network to a time synchronization network.</p>
<p id="p-0027" num="0026">Objectives of the embodiments of the present invention are realized through the following technical solution:</p>
<p id="p-0028" num="0027">A time synchronization apparatus includes a processing module, at least one inputting module, and at least one outputting module.</p>
<p id="p-0029" num="0028">The inputting module is configured to extract line clock frequency information from an input line code stream, extract a time synchronization packet from a packet stream corresponding to the input line code stream, and send the line clock frequency information and the time synchronization packet to the processing module;</p>
<p id="p-0030" num="0029">The processing module is configured to calibrate local time according to the line clock frequency information and the time synchronization packet, and send a time synchronization response packet and line clock frequency recovery information according to the calibrated local time; and</p>
<p id="p-0031" num="0030">The outputting module is configured to insert the time synchronization response packet sent by the processing module into a packet stream corresponding to an output line code stream, and recover line clock frequency information of the output line code stream according to the line clock frequency recovery information sent by the processing module.</p>
<p id="p-0032" num="0031">A time synchronization method includes:</p>
<p id="p-0033" num="0032">extracting line clock frequency information from an input line code stream, and extracting a time synchronization packet from a packet stream corresponding to the input line code stream;</p>
<p id="p-0034" num="0033">sending the input line code stream after extracting the line clock frequency information and the time synchronization packet in the corresponding packet stream to a packet switching device;</p>
<p id="p-0035" num="0034">receiving an output line code stream sent by the packet switching device; and</p>
<p id="p-0036" num="0035">calibrating local time according to the line clock frequency information and the time synchronization packet, recovering line clock frequency information of the output line code stream according to the calibrated local time, and inserting a time synchronization response packet into a packet stream corresponding to the output line code stream.</p>
<p id="p-0037" num="0036">A time synchronization network includes:</p>
<p id="p-0038" num="0037">a time synchronization apparatus, configured to: extract line clock frequency information from an input line code stream, extract a time synchronization packet from a packet stream corresponding to the input line code stream, and send the input line code stream after extracting the line clock frequency information and the time synchronization packet in the corresponding packet stream to a packet switching device; receive an output line code stream sent by the packet switching device, calibrate local time according to the line clock frequency information and the time synchronization packet, recover line clock frequency information of the output line code stream according to the calibrated local time, and insert a time synchronization response packet into a packet stream corresponding to the output line code stream; and</p>
<p id="p-0039" num="0038">a packet switching device, configured to receive the input line code stream, forward the packet stream corresponding to the input line code stream to a corresponding interface, and use a line code stream corresponding to the packet stream on the corresponding interface as output line code stream and send the output line code stream to the time synchronization apparatus.</p>
<p id="p-0040" num="0039">According to technical solutions provided by the embodiments of the present invention, the line clock frequency information is extracted from the input line code stream, and the time synchronization packet is extracted from the packet stream corresponding to the input line code stream. In this way, the clock path is isolated from the service path, and the time synchronization network may be deployed without requiring the packet switching device to support the time synchronization function, and the existing IP network can be upgraded to the time synchronization network smoothly.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of a time synchronization apparatus according to an embodiment of the present invention;</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic diagram of a time synchronization apparatus according to an embodiment of the present invention;</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of an inputting module according to an embodiment of the present invention;</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram of an outputting module according to an embodiment of the present invention;</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of a processing module according to an embodiment of the present invention;</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 6</figref> is a flow chart of a time synchronization method according to an embodiment of the present invention; and</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 7</figref> is a block diagram of a time synchronization network according to an embodiment of the present invention,</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE EMBODIMENTS</heading>
<p id="p-0048" num="0047">The following describes an embodiment of the present invention with reference to <figref idref="DRAWINGS">FIG. 1</figref> and <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of a time synchronization apparatus according to an embodiment of the present invention. The apparatus includes at least one inputting module <b>102</b>, a processing module <b>104</b>, and at least one outputting module <b>106</b>.</p>
<p id="p-0050" num="0049">The inputting module <b>102</b> is configured to extract line clock frequency information from an input line code stream, extract a time synchronization packet from a packet stream corresponding to the input line code stream, and send the line clock frequency information and the time synchronization packet to the processing module <b>104</b>. For example, the time synchronization packet may include an IEEE1588 time synchronization packet or an NTP time synchronization packet, or other packets with the function of time synchronization. The line code streams include the code streams transmitted in the form of optical signals or electric signals on the physical layer. The input line code streams include the line code stream sent from the network side to the packet switching device.</p>
<p id="p-0051" num="0050">For example, supposing that the time synchronization packet is an IEEE1588 packet, the physical-layer chip in the inputting module <b>102</b> extracts line clock frequency information including clock frequency from an input line code stream, and sends the line clock frequency information to the processing module. The inputting module <b>102</b> further extracts an IEEE1588 time synchronization packet from the packet stream corresponding to the input line code stream, and sends this packet to the processing module <b>104</b>.</p>
<p id="p-0052" num="0051">The processing module <b>104</b> is configured to calibrate local time according to the line clock frequency information and the time synchronization packet, send a time synchronization response packet according to the calibrated local time, and send line clock frequency recovery information according to the frequency of the calibrated local time. When a precise external clock source exists on the time synchronization apparatus locally, a time pulse signal and/or frequency signal of the external clock source may also serve as a basis for calibrating the local time. The precise external clock source may be a Global Positioning System (GPS), an atomic clock such as rubidium atomic clock, cesium atomic clock, hydrogen atomic clock or any other precise clock sources known by persons of ordinary skill in the art.</p>
<p id="p-0053" num="0052">For example, supposing that the time synchronization packet is an IEEE1588 packet and a precise external clock source exists on the time synchronization apparatus locally, the processing module <b>104</b> receives IPPS time pulse signals provided by the 1PPS interface of the external clock source, and the BITS frequency signals provided by the frequency interface of the external clock source; and calibrates the local time according to the line clock frequency information and the IEEE1588 time synchronization packet sent by the inputting module <b>102</b>, where the line clock frequency information includes a clock frequency. The processing module <b>104</b> sends an IEEE1588 time synchronization response packet and line clock frequency recovery information including the calibrated clock frequency to the outputting module <b>106</b> according to the calibrated local time.</p>
<p id="p-0054" num="0053">The outputting module <b>106</b> is configured to insert the time synchronization response packet sent by the processing module into a packet stream corresponding to an output line code stream, and recover line clock frequency information of the output line code stream according to the line clock frequency recovery information sent by the processing module. For example, the time synchronization response packet include an IEEE1588 time synchronization response packet or an NTP time synchronization response packet, or an IEEE1588 time synchronization packet or NTP time synchronization packet sent by the processing module <b>104</b> actively. The output line code streams include the line code stream sent from the packet switching device to the network.</p>
<p id="p-0055" num="0054">For example, supposing that the time synchronization response packet is an IEEE1588 response packet, the outputting module <b>106</b> inserts the IEEE1588 time synchronization response packet sent by the processing module <b>104</b> into the packet stream corresponding to the output line code stream, and recovers line clock frequency information of the output line code stream by using the calibrated clock frequency in the line clock frequency recovery information.</p>
<p id="p-0056" num="0055">The time synchronization apparatus in the foregoing embodiment may be realized in an optical-electric conversion apparatus or optical-electric-optical conversion device as required, for example, optical switch, optical transceiver, or optical modem. According to different devices, the inputting module <b>102</b> is further configured to perform optical-electric conversation or optical-electric-optical conversion for the input line code stream; and the outputting module <b>106</b> is further configured to perform electric-optical conversion or optical-electric-optical conversion for the output line code stream.</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic diagram of a time synchronization apparatus according to an embodiment of the present invention. When the packet switching device does not support time synchronization, no packet switching device needs to be replaced, but only a time synchronization apparatus needs to be added and connected to the packet switching device, so as to achieve the time synchronization. After being processed by the inputting module of the time synchronization apparatus, the packet stream on the network side is sent to the packet switching device. The packet stream processed by the packet switching device is sent to the time synchronization apparatus, and the outputting module processes the packet stream and sends it to the network side. The inputting module and the outputting module are logical components, and may be physical components of the same or different structures. For example, the packet switching device may be a router, a network bridge, a switch, an optical transceiver, or an optical modem. According to the specific conditions of the packet switching device and networking, different numbers of inputting modules and outputting modules may be set. In practice, the time synchronization apparatus with different interface number and different interface types may be designed. The interface type may be Ethernet interfaces of various specifications, Packet Over SONET/SDH (POS) interface, Optical Transport Network (OTN) interface, Asynchronous Transfer Mode (ATM) interface, or any other interfaces known by persons of ordinary skill in the art.</p>
<p id="p-0058" num="0057">The following describes an embodiment of the present invention with reference to <figref idref="DRAWINGS">FIG. 3</figref>.</p>
<p id="p-0059" num="0058"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of an inputting module according to an embodiment of the present invention. The inputting module includes: a first inputting unit <b>302</b>, a shunting unit <b>304</b>, and a second inputting unit <b>306</b>.</p>
<p id="p-0060" num="0059">The first inputting unit <b>302</b> is configured to terminate the physical-layer codes of the input line code stream, extract the line clock frequency information, send the line clock frequency information to the processing module, and send the processed input line code stream to the shunting unit.</p>
<p id="p-0061" num="0060">For example, the physical-layer chip in the first inputting unit <b>302</b> terminates the physical-layer codes of the input line code stream, and converts serial signals into parallel signals to be processed by the downstream device. The first inputting unit <b>302</b> is further configured to extract line clock frequency information including the clock frequency, and send the line clock frequency information to the processing module. According to different devices, the first inputting module <b>302</b> may perform optical-electric conversion when terminating the physical-layer codes of the input line code stream, and convert the input line code stream over optical signals into an input line code stream over electric signals.</p>
<p id="p-0062" num="0061">The shunting unit <b>304</b> is configured to identify the corresponding packet stream in the input line code stream; extract the time synchronization packet when the packet in the packet stream is the time synchronization packet and the destination address of the time synchronization packet matches the local address; send the time synchronization packet to the processing module; and send the processed input line code stream to the second inputting unit.</p>
<p id="p-0063" num="0062">For example, supposing that the time synchronization packet is an IEEE1588 packet, the shunting unit <b>304</b> recovers the packet stream from the input line code stream, identifies the format of the packet in the packet stream, judges the function of the packet, and sends the packet to the second inputting unit <b>306</b> directly if the packet is an ordinary Ethernet packet, or intercepts the packet and sends it to the processing module if the packet is an IEEE1588 packet and the destination address of the IEEE1588 packet matches the local address, or intercepts the packet and transmits it transparently if the packet is an IEEE1588 packet but the destination address of the packet does not match the local address.</p>
<p id="p-0064" num="0063">The second inputting unit <b>306</b> is configured to recover the physical-layer codes of the input line code stream.</p>
<p id="p-0065" num="0064">For example, the physical-layer chip in the second inputting unit <b>306</b> converts parallel signals into serial signals, and recovers the physical-layer codes of the input line code stream. In some application scenarios, the second inputting unit <b>306</b> may further recover the line clock frequency information of the input line code stream by using the calibrated clock frequency in the line clock frequency recovery information sent by the processing module. According to different devices, the second inputting module <b>306</b> may further perform electric-optical conversion when recovering the physical-layer codes of the input line code stream, and convert the input line code stream over electric signals into an input line code stream over optical signals.</p>
<p id="p-0066" num="0065">The following describes an embodiment of the present invention with reference to <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0067" num="0066"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram of an outputting module according to an embodiment of the present invention. The outputting module includes: a first outputting unit <b>402</b>, an inserting unit <b>404</b>, and a second outputting unit <b>406</b>.</p>
<p id="p-0068" num="0067">The first outputting unit <b>402</b> is configured to terminate the physical-layer codes of the output line code stream, and send the processed output line code stream to the inserting unit.</p>
<p id="p-0069" num="0068">For example, the physical-layer chip in the first outputting unit <b>402</b> terminates the physical-layer codes of the output line code stream, and converts serial signals into parallel signals to be processed by the downstream device. In some application scenarios, the first outputting unit <b>402</b> is further configured to extract line clock frequency information including the clock frequency from the output line code stream, and send the line clock frequency information to the processing module. According to different devices, the first outputting module <b>402</b> may perform optical-electric conversion when terminating the physical-layer codes of the input line code stream, and convert the input line code stream over optical signals into an input line code stream over electric signals.</p>
<p id="p-0070" num="0069">The inserting unit <b>404</b> is configured to insert the time synchronization response packet sent by the processing module into the packet stream corresponding to the output line code stream. For example, the time synchronization response packet includes an IEEE1588 time synchronization response packet or an NTP time synchronization response packet, or an IEEE1588 time synchronization packet or NTP time synchronization packet actively sent by the processing module. The processed output line code stream is sent to the second outputting unit.</p>
<p id="p-0071" num="0070">For example, supposing that the time synchronization response packet is an IEEE1588 response packet, the inserting unit <b>404</b> inserts the IEEE1588 time synchronization response packet sent by the processing module into the packet stream corresponding to the output line code stream.</p>
<p id="p-0072" num="0071">The second outputting unit <b>406</b> is configured to recover the physical-layer codes of the output line code stream, and recover the line clock frequency information of the output line code stream according to the line clock frequency recovery information sent by the processing module.</p>
<p id="p-0073" num="0072">For example, the second outputting unit <b>406</b> recovers the line clock frequency information of the output line code stream by using the calibrated clock frequency in the line clock frequency recovery information sent by the processing module. The physical-layer chip in the second outputting unit <b>406</b> converts parallel signals into serial signals, and recovers the physical-layer codes of the output line code stream. According to different devices, the second outputting module <b>406</b> may perform electric-optical conversion when recovering the physical-layer codes of the output line code stream, and convert the output line code stream over electric signals into an output line code stream over optical signals.</p>
<p id="p-0074" num="0073">The following describes an embodiment of the present invention with reference to <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of a processing module according to an embodiment of the present invention. The processing module includes: a first processing unit <b>502</b>, a converting unit <b>504</b>, and a second processing unit <b>506</b>.</p>
<p id="p-0076" num="0075">The first processing unit <b>502</b> is configured to calibrate system time according to the time synchronization packet and the reference frequency sent by the converting unit <b>504</b>, send a system time pulse signal to the converting unit <b>504</b> according to the calibrated system time, and send the time synchronization response packet. When a precise external clock source exists on the time synchronization apparatus locally, the time pulse signal of the external clock source may also serve as a basis for calibrating the system time.</p>
<p id="p-0077" num="0076">For example, supposing that the time synchronization packet is an IEEE1588 packet and a precise external clock source exists on the time synchronization apparatus locally, the first processing unit <b>502</b> receives 1PPS time pulse signals sent by the IPPS interface of the external clock source, the IEEE1588 time synchronization packet sent by the inputting module, and the reference frequency sent by the converting unit <b>504</b>. System time is obtained through a priority algorithm according to the 1PPS time pulse signal and the IEEE1588 time synchronization packet. The IPPS time pulse signal and the IEEE1588 time synchronization packet are not continuous. The system time still goes on running when no calibration of the system time occurs, and the running of the system time is maintained according to the reference frequency provided by the converting unit <b>504</b>. The first processing unit <b>502</b> sends a 1PPS system time pulse signal to the converting unit <b>504</b> according to the calibrated system time, and sends an IEEE1588 time synchronization response packet.</p>
<p id="p-0078" num="0077">The converting unit <b>504</b> is configured to calibrate local time according to the system time pulse signal sent by the first processing unit <b>502</b> and the calibrated frequency sent by the second processing unit <b>506</b>, and send a reference frequency to the first processing unit <b>502</b> and the second processing unit <b>506</b> according to the calibrated local time.</p>
<p id="p-0079" num="0078">For example, the converting unit <b>504</b> receives a 1PPS system time pulse signal sent by the first processing unit <b>502</b> and the calibrated frequency sent by the second processing unit <b>506</b>. The local time is calibrated according to the IPPS system time pulse signal sent by the first processing unit <b>502</b>. When no calibration of the local time occurs, the running of the local time is maintained according to the calibrated frequency sent by the second processing unit <b>506</b>.</p>
<p id="p-0080" num="0079">The second processing unit <b>506</b> is configured to calibrate the local frequency according to the line clock frequency information and the reference frequency sent by the converting unit <b>504</b>, send a calibrated frequency to the converting unit <b>504</b> according to the calibrated local frequency, and send line clock frequency recovery information. When a precise external clock source exists on the time synchronization apparatus locally, the frequency signal of the external clock source may also serve as a basis for calibrating the local frequency.</p>
<p id="p-0081" num="0080">For example, supposing that a precise external clock source exists on the time synchronization apparatus locally, the second processing unit <b>506</b> receives BITS frequency signals sent by the frequency interface of the external clock source, the line clock frequency information including the clock frequency, and the reference frequency sent by the converting unit <b>504</b>; obtains a local frequency according to a priority algorithm; and sends the calibrated frequency and the line clock frequency recovery information to the converting unit <b>504</b> according to the calibrated local frequency.</p>
<p id="p-0082" num="0081">The following describes an embodiment of the present invention with reference to <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0083" num="0082"><figref idref="DRAWINGS">FIG. 6</figref> is a flow chart of a time synchronization method according to an embodiment of the present invention. The method includes:</p>
<p id="p-0084" num="0083"><b>602</b>. Extract line clock frequency information from an input line code stream, and extract a time synchronization packet from a packet stream corresponding to the input line code stream. For example, the time synchronization apparatus extracts line clock frequency information including the clock frequency from the input line code stream, and extracts an IEEE1588 time synchronization packet from the packet stream corresponding to the input line code stream.</p>
<p id="p-0085" num="0084"><b>604</b>. Send the input line code stream to a packet switching device.</p>
<p id="p-0086" num="0085"><b>606</b>. Receive an output line code stream sent by the packet switching device.</p>
<p id="p-0087" num="0086"><b>608</b>. Calibrate the local time according to the line clock frequency information and the time synchronization packet. For example, supposing that the time synchronization packet is an IEEE1588 packet, the time synchronization apparatus calibrates the local time according to the extracted line clock frequency information and the IEEE1588 time synchronization packet.</p>
<p id="p-0088" num="0087"><b>610</b>. Recover the line clock frequency information of the output line code stream according to the calibrated local time, and insert a time synchronization response packet into the packet stream corresponding to the output line code stream. For example, supposing that the time synchronization response packet is an IEEE1588 response packet, the time synchronization apparatus recovers the line clock frequency information of the output line code stream according to the calibrated local time, and inserts an IEEE1588 time synchronization response packet into the packet stream corresponding to the output line code stream.</p>
<p id="p-0089" num="0088">In the time synchronization method of the forgoing embodiment, depending on the specific requirement, optical-electric conversation or optical-electric-optical conversion may be performed for the input line code stream; and/or electric-optical conversion or optical-electric-optical conversion may be performed for the output line code stream.</p>
<p id="p-0090" num="0089">The following describes an embodiment of the present invention with reference to <figref idref="DRAWINGS">FIG. 7</figref>.</p>
<p id="p-0091" num="0090"><figref idref="DRAWINGS">FIG. 7</figref> is a block diagram of a time synchronization network according to an embodiment of the present invention. The time synchronization network includes:</p>
<p id="p-0092" num="0091">a time synchronization apparatus <b>702</b>, configured to: extract line clock frequency information from an input line code stream, extract a time synchronization packet from a packet stream corresponding to the input line code stream, and send the input line code stream after extracting the line clock frequency information and the time synchronization packet to a packet switching device <b>704</b>; receive an output line code stream sent by the packet switching device <b>704</b>, calibrate local time according to the line clock frequency information and the time synchronization packet, recover line clock frequency information of the output line code stream according to the calibrated local time, and insert a time synchronization response packet into a packet stream corresponding to the output line code stream.</p>
<p id="p-0093" num="0092">For example, supposing that the time synchronization packet is an IEEE1588 packet, the time synchronization apparatus <b>702</b> extracts line clock frequency information including the clock frequency from the input line code stream. The time synchronization apparatus <b>702</b> further extracts an IEEE1588 time synchronization packet from the packet stream corresponding to the input line code stream; sends the input line code stream after extracting the line clock frequency information and the time synchronization packet to the packet switching device <b>704</b>; and receives the output line code stream sent by the packet switching device <b>704</b>. The time synchronization apparatus <b>702</b> calibrates the local time according to the extracted line clock frequency information and the IEEE1588 time synchronization packet; recovers the line clock frequency information of the output line code stream according to the calibrated local time; and inserts an IEEE1588 time synchronization response packet into the packet stream corresponding to the output line code stream.</p>
<p id="p-0094" num="0093">The packet switching device <b>704</b> is configured to receive the input line code stream, forward the packet stream corresponding to the input line code stream to a corresponding interface, and use a line code stream corresponding to the packet stream on the corresponding interface as output line code stream and send the output line code stream to the time synchronization apparatus. For example, the packet switching device <b>704</b> may be a router, a network bridge, a switch, an optical transceiver, or an optical modem.</p>
<p id="p-0095" num="0094">In specific application scenarios of the time synchronization network, the connection between the packet switching device <b>704</b> and the time synchronization apparatus <b>702</b> may be set differently as required. The packet switching device <b>704</b> may be connected to the time synchronization apparatus <b>702</b> only, or may be connected to both the time synchronization apparatus <b>702</b> and the external network.</p>
<p id="p-0096" num="0095">In this embodiment of the present invention, the network topology is changed. Before the change, two packet switching devices <b>704</b> are connected directly in a network that supports no time synchronization; after the change, the packet switching device <b>704</b> is connected to the time synchronization apparatus <b>702</b> first, and different time synchronization apparatuses <b>702</b> are interconnected. The service path is isolated from the clock path, and the time synchronization network may be deployed without requiring the packet switching device <b>704</b> to support the time synchronization function.</p>
<p id="p-0097" num="0096">In the technical solutions provided by the embodiments of the present invention, the line clock frequency information is extracted from the input line code stream, and the time synchronization packet is extracted from the packet stream corresponding to the input line code stream. In this way, the clock path is isolated from the service path, and the time synchronization network may be deployed without requiring the packet switching device to support the time synchronization function, and the existing IP network can be upgraded to the time synchronization network smoothly.</p>
<p id="p-0098" num="0097">Persons of ordinary skill in the art may understand that all or part of the steps of the method according to the embodiments of the present invention may be implemented by a program instructing relevant hardware. The program may be stored in computer readable storage media. The storage medium may be a Read-Only Memory (ROM), a Random Access Memory (RAM), a magnetic disk, or an optical disk, etc.</p>
<p id="p-0099" num="0098">To sum up, the above descriptions are merely some exemplary embodiments of the present invention, but not intended to limit the scope of the present invention. Any variation or replacement that may be easily derived by those skilled in the art within the technology scope disclosed in the present invention shall fall within the protection scope of the present invention. Therefore, the protection scope of the present invention is subject to the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A non-transitory computer readable medium including computer executable instructions that facilitate performing the steps of:
<claim-text>extracting line clock frequency information from an input line code stream, extracting a time synchronization packet from a packet stream corresponding to the input line code stream, and sending the line clock frequency information and the time synchronization packet wherein the line clock frequency information includes a clock frequency;</claim-text>
<claim-text>calibrating local time according to the line clock frequency information and the time synchronization packet, and sending a time synchronization response packet and line clock frequency recovery information according to the calibrated local time wherein the line clock frequency recovery information includes the calibrated clock frequency; and</claim-text>
<claim-text>inserting the time synchronization response packet into a packet stream corresponding to an output line code stream, and recovering line clock frequency information of the output line code stream according to the line clock frequency recovery information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The non-transitory computer readable medium according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the extracting line clock frequency information from an input line code stream, extracting a time synchronization packet from a packet stream corresponding to the input line code stream, and sending the line clock frequency information and the time synchronization packet wherein the line clock frequency information includes a clock frequency comprises:
<claim-text>terminating physical-layer codes of the input line code stream, extracting the line clock frequency information from the input line code stream, sending the line clock frequency information, and sending the processed input line code stream;</claim-text>
<claim-text>identifying the corresponding packet stream in the input line code stream, extracting the time synchronization packet when the packet in the packet stream is the time synchronization packet and a destination address of the time synchronization packet matches the local address, sending the time synchronization packet, and sending the processed input line code stream; and</claim-text>
<claim-text>recovering the physical-layer codes of the input line code stream.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The non-transitory computer readable medium according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein:
<claim-text>the recovering the physical-layer codes of the input line code stream further comprises recovering the line clock frequency information of the input line code stream according to the line clock frequency recovery information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The non-transitory computer readable medium according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the inserting the time synchronization response packet into a packet stream corresponding to an output line code stream, and recovering line clock frequency information of the output line code stream according to the line clock frequency recovery information comprises:
<claim-text>terminating physical-layer codes of the output line code stream, and sending the processed output line code stream;</claim-text>
<claim-text>inserting the time synchronization response packet into the packet stream corresponding to the output line code stream, and sending the processed output line code stream to the second outputting unit; and</claim-text>
<claim-text>recovering the physical-layer codes of the output line code stream, and recovering the line clock frequency information of the output line code stream according to the line clock frequency recovery information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The non-transitory computer readable medium according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein:
<claim-text>the terminating physical-layer codes of the output line code stream, and sending the processed output line code stream further comprises extracting the line clock frequency information from the output line code stream, and sending the line clock frequency information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The non-transitory computer readable medium according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein a basis for calibrating the local time, further includes:
<claim-text>time pulse signals of an external clock source; and/or</claim-text>
<claim-text>frequency signals of the external clock source.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The non-transitory computer readable medium according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the calibrating local time according to the line clock frequency information and the time synchronization packet, and sending a time synchronization response packet and line clock frequency recovery information according to the calibrated local time wherein the line clock frequency recovery information includes the calibrated clock frequency comprises:
<claim-text>calibrating system time according to the time synchronization packet and a reference frequency, sending a system time pulse signal according to the calibrated system time, and sending the time synchronization response packet;</claim-text>
<claim-text>calibrating local time according to the system time pulse signal and a calibrated frequency, and sending a reference frequency according to the calibrated local time; and</claim-text>
<claim-text>calibrating a local frequency according to the line clock frequency information and the reference frequency, sending a calibrated frequency according to the calibrated local frequency, and sending line clock frequency recovery information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A time synchronization method, comprising:
<claim-text>extracting line clock frequency information from an input line code stream, and extracting a time synchronization packet from a packet stream corresponding to the input line code stream wherein the line clock frequency information includes a clock frequency;</claim-text>
<claim-text>sending the input line code stream after extracting the line clock frequency information and the time synchronization packet in the corresponding packet stream to a packet switching device;</claim-text>
<claim-text>receiving an output line code stream sent by the packet switching device; and</claim-text>
<claim-text>calibrating local time according to the line clock frequency information and the time synchronization packet, recovering line clock frequency information of the output line code stream according to the calibrated local time, and inserting a time synchronization response packet into a packet stream corresponding to the output line code stream wherein recovering the line clock frequency information of the output line code stream comprises recovering the line clock frequency information of the output line code stream according to line clock frequency recovery information wherein the line clock frequency recovery information includes the calibrated clock frequency.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A time synchronization network, comprising:
<claim-text>a time synchronization apparatus, configured to: extract line clock frequency information from an input line code stream wherein the line clock frequency information includes a clock frequency, extract a time synchronization packet from a packet stream corresponding to the input line code stream, and send the input line code stream after extracting the line clock frequency information and the time synchronization packet in the corresponding packet stream to a packet switching device; receive an output line code stream sent by the packet switching device, calibrate local time according to the line clock frequency information and the time synchronization packet, recover line clock frequency information of the output line code stream according to the calibrated local time, and insert a time synchronization response packet into a packet stream corresponding to the output line code stream wherein recovering the line clock frequency information of the output line code stream comprises recovering the line clock frequency information of the output line code stream according to line clock frequency recovery information wherein the line clock frequency recovery information includes the calibrated clock frequency; and</claim-text>
<claim-text>a packet switching device, configured to receive the input line code stream, forward the packet stream corresponding to the input line code stream to a corresponding interface, and use a line code stream corresponding to the packet stream on the corresponding interface as output line code stream and send the output line code stream to the time synchronization apparatus. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
