<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625126-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625126</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12263951</doc-number>
<date>20081103</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2007-287850</doc-number>
<date>20071105</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>996</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>3</main-group>
<subgroup>12</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>3</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>29</main-group>
<subgroup>06</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>358  115</main-classification>
<further-classification>356  114</further-classification>
<further-classification>356  116</further-classification>
<further-classification>710 15</further-classification>
<further-classification>713161</further-classification>
<further-classification>382100</further-classification>
</classification-national>
<invention-title id="d2e71">Management of recording medium storage when outputting print job log information</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5602933</doc-number>
<kind>A</kind>
<name>Blackwell et al.</name>
<date>19970200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382116</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5960460</doc-number>
<kind>A</kind>
<name>Marasco et al.</name>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711162</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5978477</doc-number>
<kind>A</kind>
<name>Hull et al.</name>
<date>19991100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7516102</doc-number>
<kind>B2</kind>
<name>Takamine</name>
<date>20090400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7576883</doc-number>
<kind>B2</kind>
<name>Ragnet et al.</name>
<date>20090800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  115</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7586635</doc-number>
<kind>B2</kind>
<name>Maeda et al.</name>
<date>20090900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  115</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7623253</doc-number>
<kind>B1</kind>
<name>Oyama et al.</name>
<date>20091100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>7698471</doc-number>
<kind>B2</kind>
<name>Aoki et al.</name>
<date>20100400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710 15</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2002/0023084</doc-number>
<kind>A1</kind>
<name>Eyal et al.</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2002/0120875</doc-number>
<kind>A1</kind>
<name>Kiwada et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2002/0159092</doc-number>
<kind>A1</kind>
<name>Christodoulou et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2003/0196090</doc-number>
<kind>A1</kind>
<name>Nagahama</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2003/0231331</doc-number>
<kind>A1</kind>
<name>Tanaka</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2003/0234952</doc-number>
<kind>A1</kind>
<name>Abe</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  114</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2005/0111051</doc-number>
<kind>A1</kind>
<name>Uchikawa</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2005/0134897</doc-number>
<kind>A1</kind>
<name>Mase</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2005/0144469</doc-number>
<kind>A1</kind>
<name>Saitoh</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713189</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2006/0044592</doc-number>
<kind>A1</kind>
<name>Wakana</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  114</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2006/0048019</doc-number>
<kind>A1</kind>
<name>Takahashi</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714 48</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2006/0279764</doc-number>
<kind>A1</kind>
<name>Shimada</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  114</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>2006/0288285</doc-number>
<kind>A1</kind>
<name>Lai et al.</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>2006/0290975</doc-number>
<kind>A1</kind>
<name>Murakami et al.</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2007/0118760</doc-number>
<kind>A1</kind>
<name>Masui</name>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>2007/0133054</doc-number>
<kind>A1</kind>
<name>Kobayashi et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>2007/0285712</doc-number>
<kind>A1</kind>
<name>Komada</name>
<date>20071200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>2009/0116061</doc-number>
<kind>A1</kind>
<name>Yasuhara</name>
<date>20090500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>2011/0255132</doc-number>
<kind>A1</kind>
<name>Shimada</name>
<date>20111000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00028">
<document-id>
<country>JP</country>
<doc-number>6-268791</doc-number>
<kind>A</kind>
<date>19940900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00029">
<document-id>
<country>JP</country>
<doc-number>2002016788</doc-number>
<kind>A</kind>
<date>20020100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00030">
<document-id>
<country>JP</country>
<doc-number>2002-358244</doc-number>
<kind>A</kind>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00031">
<document-id>
<country>JP</country>
<doc-number>2003-023517</doc-number>
<kind>A</kind>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00032">
<document-id>
<country>JP</country>
<doc-number>2003-304243</doc-number>
<kind>A</kind>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00033">
<document-id>
<country>JP</country>
<doc-number>2006081119</doc-number>
<kind>A</kind>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00034">
<document-id>
<country>JP</country>
<doc-number>3821293</doc-number>
<kind>B2</kind>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00035">
<document-id>
<country>JP</country>
<doc-number>2006-246350</doc-number>
<kind>A</kind>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00036">
<othercit>Office Action issued in corresponding Japanese Patent Application No. 2007-287850 dated Sep. 28, 2009.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00037">
<othercit>Japanese Office Action cited in JP 2006-162809, dated Apr. 28, 2011. (JPOA cited in related co-pending application US 2007-0285712).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00038">
<othercit>Japanese Office Action cited in corresponding JP 2007-287850, previously cited an IDS dated Oct. 15, 2009, without an English translation. English translation is submitted herewith.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00039">
<othercit>Michael J. Shelton, et al.; &#x201c;Thumbnail or encoding history of jobs copied/printed/sent for audits&#x201d;; Research Disclosure Journal, ISSN 0374-4353, Research Disclosure Database No. 473025; Sep. 2003.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>8</number-of-claims>
<us-exemplary-claim>7</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>9</number-of-drawing-sheets>
<number-of-figures>11</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20090116061</doc-number>
<kind>A1</kind>
<date>20090507</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Yasuhara</last-name>
<first-name>Hiroshi</first-name>
<address>
<city>Kawasaki</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Yasuhara</last-name>
<first-name>Hiroshi</first-name>
<address>
<city>Kawasaki</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Rossi, Kimms &#x26; McDowell LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Canon Kabushiki Kaisha</orgname>
<role>03</role>
<address>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Kau</last-name>
<first-name>Steven</first-name>
<department>2671</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An output job in an image forming apparatus not connected to a network is managed. To accomplish this, an image forming apparatus in an image forming system includes an input unit which inputs document data stored in a recording medium, a verification unit which verifies the validity of the document data on the basis of verification information associated with the input document data, an output unit which forms and outputs an image on a print medium on the basis of the document data, and an output log storing control unit which, when it is determined that the document data is valid, stores, in the recording medium, output log information containing no output image, and when it is determined that the document data is invalid, stores output log information containing the output image in the recording medium.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="254.68mm" wi="174.41mm" file="US08625126-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="184.57mm" wi="176.28mm" file="US08625126-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="244.26mm" wi="139.70mm" file="US08625126-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="228.35mm" wi="124.88mm" orientation="landscape" file="US08625126-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="227.67mm" wi="177.63mm" file="US08625126-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="158.16mm" wi="127.68mm" file="US08625126-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="269.24mm" wi="173.48mm" file="US08625126-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="113.37mm" wi="112.01mm" file="US08625126-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="225.30mm" wi="131.83mm" orientation="landscape" file="US08625126-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="221.66mm" wi="136.48mm" orientation="landscape" file="US08625126-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates to a management technology for document data output from an image forming apparatus.</p>
<p id="p-0004" num="0003">2. Description of the Related Art</p>
<p id="p-0005" num="0004">In an office, copy machines are widely used as an image forming apparatus for printing out document data obtained by reading a document. These days, among such apparatuses, a growing number of image forming apparatuses have a facsimile function, a printer function, a function of transmitting a read image as data to a terminal, and a function of reading and outputting image data saved in a portable recording medium. Further, it has become popular in recent years to output business documents using an image forming apparatus not only in an office but also in public places such as convenience stores. Also, it has become popular to store business documents in a portable recording medium, connect to an image forming apparatus present in a public place, and output an image.</p>
<p id="p-0006" num="0005">Recently, confidential information leakage in has become a serious problem in offices. To prevent leakage of confidential information in an office, many software programs having a function of monitoring printout, mail sending/reception, file copying, and the like are commercially available. As a method of preventing leakage of confidential information in the form of a paper medium, there is proposed a technique of saving image data of a document and data (date and time of copying, user, location, and the like) about an output job of the image in association with each other to enable later tracking, as disclosed in Japanese Patent No. 3821293.</p>
<p id="p-0007" num="0006">However, storage devices which manage data regarding an output job are not always connected via a network to an image forming apparatus present in a public place. If an image forming apparatus not connected to a storage device via a network outputs data, it cannot transmit data regarding the output job to an external server, and thus fails in data management of that output job against leakage of confidential information.</p>
<p id="p-0008" num="0007">It is also possible to store data regarding an output job in a portable recording medium and recover the information in an office. However, when document data is saved as data regarding an output job, the data size may become large, and the data may not be storable in a portable recording medium. Japanese Patent No. 3821293 proposes a method of preventing output itself when an area for storing information regarding an output job cannot be ensured in the storage area. However, output failure may decrease business efficiency and hinder the business itself.</p>
<p id="p-0009" num="0008">The present invention has been made in consideration of the above situation, and has as its object to enable data management of an output job even in an image forming apparatus not connected to a network.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0010" num="0009">The present invention can provide a technique capable of data management of an output job in an image forming apparatus not connected to a network.</p>
<p id="p-0011" num="0010">According to one aspect of the present invention, an image forming system includes a client apparatus which generates document data, an image forming apparatus which forms and outputs an image on a print medium on the basis of input document data, and a management server apparatus which manages outputs of document data, the client apparatus comprising: a generating unit which generates document data; a transmitting unit which transmits document data to be managed to the management server apparatus; a receiving unit which receives verification information-added document data from the management server apparatus; and a storing unit which stores the document data in a recording medium, the management server apparatus comprising: an accepting unit which accepts the document data to be managed from the client apparatus; a registering unit which registers the accepted document data in a management table; and an adding unit which adds verification information to the accepted document data, and the image forming apparatus comprising: an input unit which inputs the document data stored in the recording medium; a verification unit which verifies validity of the document data on the basis of verification information associated with the input document data; an output unit which forms and outputs an image on a print medium on the basis of the document data; and a storing control unit which, when the verification unit determines that the document data is valid, stores, in the recording medium, output log information containing no image output from the output unit, and when the verification unit determines that the document data is invalid, stores output log information containing the image in the recording medium.</p>
<p id="p-0012" num="0011">According to another aspect of the present invention, an image forming apparatus comprises: an input unit which inputs document data stored in a recording medium; a verification unit which verifies validity of the document data on the basis of verification information associated with the input document data; an output unit which forms and outputs an image on a print medium on the basis of the document data; and an output log storing control unit which, when the verification unit determines that the document data is valid, stores, in the recording medium, output log information containing no image output from the output unit, and when the verification unit determines that the document data is invalid, stores output log information containing the image in the recording medium.</p>
<p id="p-0013" num="0012">According to still another aspect of the present invention, a method of controlling an image forming apparatus, the method comprises: an input step of inputting document data stored in a recording medium; a verification step of verifying validity of the document data on the basis of verification information associated with the input document data; an output step of forming and outputting an image on a print medium on the basis of the document data; and an output log storing control step of, when the document data is determined in the verification step to be valid, storing, in the recording medium, output log information containing no image output in the output step, and when the document data is determined to be invalid, storing output log information containing the image in the recording medium.</p>
<p id="p-0014" num="0013">Further features of the present invention will become apparent from the following description of exemplary embodiments with reference to the attached drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0015" num="0014">The accompanying drawings, which are incorporated in and constitute a part of the specification, illustrate embodiments of the invention and, together with the description, serve to explain the principles of the invention.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic view showing the overall configuration of an image forming system including an image forming apparatus according to the first embodiment;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2</figref> is a functional block diagram of the image forming apparatus;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 3</figref> is a functional block diagram of a management server;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 4</figref> is a functional block diagram of a client apparatus;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 5</figref> is a table showing an example of an output job information management table managed by the management server;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart showing an operation sequence in the client apparatus;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 7</figref> is a flowchart showing an operation sequence in the management server;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 8</figref> is a flowchart showing an operation sequence in the image forming apparatus;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 9</figref> is a flowchart showing an operation sequence executed by the management server after outputting an image;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 10</figref> is a block diagram showing the internal arrangement of the image forming apparatus; and</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 11</figref> is a block diagram showing the hardware configuration of the client apparatus and management server.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF THE EMBODIMENTS</heading>
<p id="p-0027" num="0026">Preferred embodiments of the present invention will be described in detail below with reference to the accompanying drawings. The following embodiments are merely examples, and do not limit the scope of the present invention.</p>
<p id="p-0028" num="0027">(First Embodiment)</p>
<p id="p-0029" num="0028">&#x3c;System Configuration&#x3e;</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic view showing the network configuration of an image forming system according to the first embodiment. Information processing apparatuses <b>101</b> and <b>103</b> are client apparatuses, and an output job information management server <b>102</b> has a management unit which manages output job information.</p>
<p id="p-0031" num="0030">The client apparatus <b>101</b> or <b>103</b> generates document data, and transmits it to the management server <b>102</b> via a network <b>104</b>. The management server <b>102</b> registers the document data, and transmits the registered document data to the client apparatus <b>101</b> or <b>103</b>. The client apparatus <b>101</b> or <b>103</b> stores the registered document data in a portable recording medium.</p>
<p id="p-0032" num="0031">The portable recording medium which stores document data is connected to an image forming apparatus <b>105</b>, and the image forming apparatus <b>105</b> prints out the stored document data. The image forming apparatus <b>105</b> stores output job information upon printout in the portable recording medium. The image forming apparatus <b>105</b> need not be connected to the client apparatuses <b>101</b> and <b>103</b> and management server <b>102</b> via a network, but may also be connected.</p>
<p id="p-0033" num="0032">The above-described portable recording medium suffices to be a readable/writable storage medium, such as a USB memory or SD card, which is detachable from the client apparatuses <b>101</b> and <b>103</b> and image forming apparatus <b>105</b>.</p>
<p id="p-0034" num="0033">The client apparatuses <b>101</b> and <b>103</b> have a function of acquiring output job information from a portable recording medium. When the client apparatuses <b>101</b> and <b>103</b> acquire output job information from the portable recording medium, they transmit it to the management server <b>102</b>. The management server itself <b>102</b> may also have a function of acquiring output job information from a portable recording medium.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 10</figref> is a block diagram showing the internal arrangement of the image forming apparatus <b>105</b>.</p>
<p id="p-0036" num="0035">A communication interface <b>1006</b> allows a CPU <b>1001</b> to communicate with the outside of the image forming apparatus. The communication interface <b>1006</b> is, for example, a USB interface, Ethernet&#xae; interface, or interface. The communication interface <b>1006</b> may also be another arbitrary communication interface.</p>
<p id="p-0037" num="0036">A scanner engine <b>1007</b> is a functional unit which reads a paper document as electronic data. A printer engine <b>1008</b> is a functional unit which prints and forms an image on a paper medium on the basis of electronic data. The printer engine <b>1008</b> is, for example, a laser beam printer or inkjet printer, but may also be another printer. A FAX board <b>1009</b> implements a FAX function of transmitting and receiving an image via a telephone line.</p>
<p id="p-0038" num="0037">An LCD <b>1003</b> and keyboard <b>1004</b> are user interfaces for notifying the user of information or accepting an input from the user. The LCD <b>1003</b> may also have a touch panel function and accept an input from the user.</p>
<p id="p-0039" num="0038">These hardware units are connected to each other via a system bus <b>1020</b>, and controlled by the CPU <b>1001</b>.</p>
<p id="p-0040" num="0039">The image forming apparatus <b>105</b> allows the user to select the printer engine <b>1008</b> and issue a print job. Also, the image forming apparatus <b>105</b> allows the user to select the scanner engine <b>1007</b> and issue a scan job. The image forming apparatus <b>105</b> allows the user to select the printer engine <b>1008</b> and scanner engine <b>1007</b>, and issue a copy job.</p>
<p id="p-0041" num="0040">In addition, the image forming apparatus <b>105</b> allows the user to select the printer engine <b>1008</b> or scanner engine <b>1007</b> and the FAX board <b>1009</b>, and issue a FAX reception job and FAX transmission job.</p>
<p id="p-0042" num="0041">The image forming apparatus <b>105</b> acquires document data via the communication interface <b>1006</b>, and executes a print job using the printer engine <b>1008</b>. The image forming apparatus <b>105</b> acquires document data via the communication interface, and executes a FAX transmission job.</p>
<p id="p-0043" num="0042">For example, when a portable recording medium which stores document data is connected to the communication interface <b>1006</b>, the CPU <b>1001</b> acquires document data from the portable recording medium via the communication interface <b>1006</b>. The CPU <b>1001</b> forms and outputs, on a print medium such as paper, an image based on document data acquired using the printer engine <b>1008</b>.</p>
<p id="p-0044" num="0043">Programs which run in the image forming apparatus <b>105</b> are stored in a ROM <b>1005</b> or DISK <b>1010</b>. If necessary, a program is loaded to a RAM <b>1002</b> and executed by the CPU <b>1001</b>. In addition to control programs, the ROM <b>1005</b> and DISK <b>1010</b> store attribute information representing the function and status of a job processed by the image forming apparatus <b>105</b> and a multi-functional peripheral. Further, the ROM <b>1005</b> and DISK <b>1010</b> store job data to be output, and the like.</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 11</figref> is a block diagram showing the hardware configuration of the client apparatuses <b>101</b> and <b>103</b> and management server <b>102</b>. In the first embodiment, the client apparatuses <b>101</b> and <b>103</b> and management server <b>102</b> are implemented by executing software on a personal computer (PC) which is a general information processing apparatus. The hardware configuration is identical between the client apparatuses <b>101</b> and <b>103</b> and the management server <b>102</b>, so the client apparatus <b>101</b> will be explained.</p>
<p id="p-0046" num="0045">Programs which control the client apparatus <b>101</b> are stored in a ROM <b>1105</b> or DISK <b>1107</b>. If necessary, a program is loaded to a RAM <b>1102</b> and executed by a CPU <b>1101</b>. In addition to control programs, the ROM <b>1105</b> and DISK <b>1107</b> store document data to be printed by the image forming apparatus <b>105</b>, management information for managing output job information, and output job information.</p>
<p id="p-0047" num="0046">A communication interface <b>1106</b> allows the CPU <b>1101</b> to communicate with the outside of the client apparatus <b>101</b>. The communication interface <b>1106</b> is, for example, a USB interface, Ethernet&#xae; interface, or interface. The communication interface <b>1106</b> may also be another arbitrary communication interface. In the following description, communication with a portable recording medium uses a USB interface, and communication between the client apparatuses or between the client apparatus and the management server uses an Ethernet&#xae; interface.</p>
<p id="p-0048" num="0047">An LCD <b>1103</b> and keyboard <b>1104</b> are user interfaces for notifying the user of information or accepting an input from the user. The LCD <b>1103</b> may also have a touch panel function and accept an input from the user.</p>
<p id="p-0049" num="0048">These hardware units are connected to each other via a system bus <b>1108</b>, and controlled by the CPU <b>1101</b>.</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram of functional blocks implemented by executing software on the image forming apparatus <b>105</b>.</p>
<p id="p-0051" num="0050">A print control unit <b>201</b> controls the communication interface <b>1006</b>, the LCD <b>1003</b>, the keyboard <b>1004</b>, the printer engine <b>1008</b>, a management level determination unit <b>202</b>, and an environment information acquiring unit <b>203</b>.</p>
<p id="p-0052" num="0051">The print control unit <b>201</b> acquires document data from the portable recording medium via the communication interface <b>1006</b>. The print control unit <b>201</b> outputs document data to the management level determination unit <b>202</b> (to be described later), and determines, in accordance with a management level determined by the management level determination unit <b>202</b>, whether to handle, as output job information, document data and environment information obtained from the environment information acquiring unit. Based on the status of a portable recording medium connected to the communication interface <b>1006</b>, the print control unit <b>201</b> determines and controls whether to output a document via the printer engine <b>1008</b>.</p>
<p id="p-0053" num="0052">The management level determination unit <b>202</b> acquires document data from the print control unit <b>201</b> and a certificate, and determines the management level of the document data. The certificate may also be data separated from document data, or stored in associated document data. When signature verification of document data using a certificate is successful, the management level determination unit <b>202</b> determines &#x201c;management level 1&#x201d; as the management level. If signature verification fails or only document data is acquired, the management level determination unit <b>202</b> determines the management level to be &#x201c;management level 0&#x201d;. The criterion of the management level is not limited to the signature verification, and the management level associated with a document may also be determined by another method.</p>
<p id="p-0054" num="0053">The environment information acquiring unit <b>203</b> acquires environment information of a job output from the print control unit <b>201</b>. The environment information includes, for example, the date and time of issue of a job, and the size of document data. The environment information further includes the name of a user who outputs document data, the document data management level determined by the management level determination unit <b>202</b>, the serial number of an image forming system for output, and the installation location. However, the environment information is not limited to these types of information, and a combination of arbitrary types of information used in the image forming apparatus <b>105</b> is available.</p>
<p id="p-0055" num="0054">Upon completion of executing a designated job, when document data of &#x201c;management level 0&#x201d; is output, the print control unit <b>201</b> stores &#x201c;document data and environment information&#x201d; as output job information in the portable recording medium via the communication interface <b>1006</b>. When document data of &#x201c;management level 1&#x201d; is output, the print control unit <b>201</b> stores only &#x201c;environment information&#x201d; as output job information in the portable recording medium via the communication interface <b>1006</b>.</p>
<p id="p-0056" num="0055">The print control unit <b>201</b> may also take the following arrangement. That is, before executing a job, the print control unit <b>201</b> acquires in advance acquirable environment information from the environment information acquiring unit <b>203</b>, and stores it in the portable recording medium via the communication interface <b>1006</b>. Upon completion of executing the job, the print control unit <b>201</b> acquires additional information from the environment information acquiring unit <b>203</b>, and adds it via the communication interface <b>1006</b> to the information stored in the portable recording medium.</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of functional blocks implemented by executing software in the management server <b>102</b>.</p>
<p id="p-0058" num="0057">An output job information management table <b>301</b> holds environment information of an output job, document data of the output job, and status information. An output job information management unit <b>302</b> manages the output job information management table <b>301</b>.</p>
<p id="p-0059" num="0058">A document data registering unit <b>303</b> receives document data from the client apparatus <b>101</b> or <b>103</b> via the communication interface <b>1106</b>. The document data registering unit <b>303</b> registers document data in the output job information management table <b>301</b> via the output job information management unit <b>302</b>. When the document data registering unit <b>303</b> registers document data, the output job information management unit <b>302</b> registers information representing that the document data has been registered in status information of the output job information management table <b>301</b>. After registering the information, the document data registering unit <b>303</b> outputs the document data to a management level adding unit <b>304</b>. When the document data registering unit <b>303</b> receives document data to which management level information is added by the management level adding unit <b>304</b>, it transmits the management level information-added document data to the client apparatus <b>101</b> or <b>103</b> via the communication interface <b>1106</b>.</p>
<p id="p-0060" num="0059">The management level adding unit <b>304</b> receives document data registered in the management table from the document data registering unit <b>303</b>, and adds a management level. In the first embodiment, the management level is determined based on signature information, as described in the description of the print control unit <b>201</b>. Upon receiving document data from the document data registering unit <b>303</b>, the management level adding unit <b>304</b> acquires key data from the output job information management unit, and executes signature adding processing for the document data by using the key data. After adding signature information to the document data, the management level adding unit <b>304</b> sends back the signature information-added document data to the document data registering unit. As the &#x201c;key data&#x201d;, a private key in public key cryptography is available.</p>
<p id="p-0061" num="0060">An output job information acquiring unit <b>305</b> receives output job information from the portable recording medium via the communication interface <b>1106</b>. The output job information acquiring unit <b>305</b> registers the output job information in the output job information management table <b>301</b> via the output job information management unit <b>302</b>.</p>
<p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram of functional blocks implemented by executing software in the client apparatuses <b>101</b> and <b>103</b>.</p>
<p id="p-0063" num="0062">A document data generating unit <b>401</b> generates document data from an image generated by a program stored in the DISK <b>1107</b>, RAM <b>1102</b>, or ROM <b>1105</b>. Programs stored in the DISK <b>1107</b>, RAM <b>1102</b>, and ROM <b>1105</b> are a document creation program and photographic data editing program, but are not limited to them.</p>
<p id="p-0064" num="0063">An output control unit <b>402</b> transmits document data to be managed out of a document generated by the document data generating unit <b>401</b> to the management server <b>102</b> via the communication interface <b>1106</b>. The output control unit <b>402</b> receives document data to which the management level is added by the management server <b>102</b>, and stores the document data in the portable recording medium via the communication interface <b>1106</b>.</p>
<p id="p-0065" num="0064">The output control unit <b>402</b> can also directly store document data generated by the document data generating unit <b>401</b> in the portable recording medium via the communication interface <b>1106</b>. In this case, neither a signature nor a management level is added to the document data.</p>
<p id="p-0066" num="0065"><figref idref="DRAWINGS">FIG. 5</figref> is a table showing an example of the output job information management table <b>301</b> managed by the management server <b>102</b>.</p>
<p id="p-0067" num="0066">Two attributes In and Out (to be described later) are defined for one Index <b>501</b>. An attribute <b>502</b> represents whether data is document data or output job information. Information In is input when document data is registered. Information Out is input when output job information is registered, that is, when the image forming apparatus <b>105</b> prints.</p>
<p id="p-0068" num="0067">As a date <b>503</b>, when the attribute <b>502</b> is In, a date and time when an output job was registered in the information management table is added. When the attribute <b>502</b> is Out, a date and time when output job information was registered is added. A user name <b>504</b> is information of a user who registered data when the attribute <b>502</b> is In, and information of a user who output data when the attribute <b>502</b> is Out. As a file name <b>505</b>, the file name of document data registered by the user in the document data registering unit is registered.</p>
<p id="p-0069" num="0068">As a file size <b>506</b>, the file size of registered document data is registered. A management level <b>507</b> is &#x201c;management level 1&#x201d; for FileA.pdf corresponding to the Index <b>501</b>=1 and FileC.txt corresponding to the Index <b>501</b>=1, and &#x201c;management level 0&#x201d; for FileB.doc. Note that &#x201c;management level 0&#x201d; is registered when no document data is registered in the management server <b>102</b> and the image forming apparatus <b>105</b> handles environment information and document data as output job information.</p>
<p id="p-0070" num="0069">As a status <b>508</b>, information &#x201c;upload&#x201d; is added when document data of &#x201c;management level 1&#x201d; is registered, and information &#x201c;complete&#x201d; is added when output job information is registered. As a file location <b>509</b>, the file path of registered document data is registered. Information is added to In when document data is registered in advance, and Out when document data is registered upon acquiring output job information. As a Device <b>510</b>, information representing the device name and location is registered. More specifically, the information is added to Out upon acquiring output job information.</p>
<p id="p-0071" num="0070">A Job <b>511</b> represents the type of job. In the example of <figref idref="DRAWINGS">FIG. 5</figref>, information representing that Device A and Device C printed FileA.pdf and FileB.doc, respectively.</p>
<p id="p-0072" num="0071">In the example of <figref idref="DRAWINGS">FIG. 5</figref>, jobs corresponding to Index <b>501</b>=1 and 2 have already been completed. The output job information acquiring unit <b>305</b> has acquired output job information from the portable recording medium, and the output job information management unit <b>302</b> has registered the information in the output job information management table <b>301</b>. In contrast, as for a job corresponding to Index <b>501</b>=3, document data has been registered in the output job information management unit <b>302</b> via the document data registering unit <b>303</b>, but no output job information has been registered yet in the output job information management table <b>301</b>.
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0072">By managing this table in the management server <b>102</b>, each job takes the following three states:</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0073" num="0073">Registered in only In: Document data is registered in advance in the management server <b>102</b>, but the completion of outputting the document data is not confirmed. For example, the user keeps bringing out document data.
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0074">Registered in only Out: Document data is not registered in advance in the management server <b>102</b>, but output job information is registered upon completion of outputting the document data.</li>
        <li id="ul0004-0002" num="0075">Registered in In and Out: Document data is registered in advance in the management server <b>102</b>, and output job information is registered upon completion of outputting the document data.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0074" num="0076">&#x3c;System Operation&#x3e;</p>
<p id="p-0075" num="0077"><figref idref="DRAWINGS">FIG. 6</figref> shows an operation sequence in the client apparatus <b>101</b> or <b>103</b>. <figref idref="DRAWINGS">FIG. 6</figref> shows an operation sequence from generation of document data to storage of it in a portable recording medium. The following steps are implemented by executing a control program by the CPU <b>1101</b> of the client apparatus <b>101</b> or <b>103</b>.</p>
<p id="p-0076" num="0078">In step S<b>601</b>, the document data generating unit <b>401</b> generates document data.</p>
<p id="p-0077" num="0079">In step S<b>602</b>, the output control unit <b>402</b> displays, to the user via the LCD <b>1103</b>, a message that it is necessary to determine whether to register the document data generated in step S<b>601</b> in the management server <b>102</b>. The output control unit <b>402</b> receives an instruction from the user via the keyboard <b>1104</b>. If the output control unit <b>402</b> has received an instruction from the user to register the document data, the process advances to step S<b>604</b>. If the output control unit <b>402</b> has received an instruction not to register the document data, the process advances to step S<b>603</b>.</p>
<p id="p-0078" num="0080">In step S<b>603</b>, the document data generated in step S<b>601</b> is stored in a connected portable recording medium via the communication interface <b>1106</b>.</p>
<p id="p-0079" num="0081">In step S<b>604</b>, the document data generated in step S<b>601</b> is transmitted to the management server <b>102</b> via the communication interface <b>1106</b> together with a command which requests registration.</p>
<p id="p-0080" num="0082">In step S<b>605</b>, management level information-added document data is received from the management server <b>102</b>. As described above, in the first embodiment, the management level information is signature information (verification information) for document data.</p>
<p id="p-0081" num="0083">In step S<b>606</b>, data is acquired to verify the validity of the document data received from the management server <b>102</b> in step S<b>605</b>. More specifically, the public key (or a server certificate containing a public key) of the management server <b>102</b> that is used to confirm the validity of signature information is acquired.</p>
<p id="p-0082" num="0084">In step S<b>607</b>, the document data and public key acquired in steps S<b>605</b> and S<b>606</b> are stored in the portable recording medium connected via the communication interface <b>1106</b>.</p>
<p id="p-0083" num="0085">By this sequence, the generated document data is stored in the portable recording medium.</p>
<p id="p-0084" num="0086"><figref idref="DRAWINGS">FIG. 7</figref> shows an operation sequence in the management server <b>102</b>. <figref idref="DRAWINGS">FIG. 7</figref> shows an operation sequence from reception of document data from the client apparatus <b>101</b> or <b>103</b> to reply of management level information-added document data to the client apparatus <b>101</b> or <b>103</b>. The following steps are implemented by executing a control program by the CPU <b>1101</b> of the management server <b>102</b>.</p>
<p id="p-0085" num="0087">In step S<b>701</b>, the document data registering unit <b>303</b> receives document data from the client apparatus <b>101</b> or <b>103</b> via the communication interface <b>1106</b>.</p>
<p id="p-0086" num="0088">In step S<b>702</b>, the document data received by the document data registering unit <b>303</b> in step S<b>701</b> is stored in the DISK <b>1107</b>.</p>
<p id="p-0087" num="0089">In step S<b>703</b>, information on the document data received in step S<b>701</b> is registered in the output job information management table <b>301</b>. More specifically, the output job information management unit <b>302</b> registers information on the document data in the output job information management table <b>301</b>. The registered information includes the file path, file size, status, user name, date and time, and Index, as described with reference to <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0088" num="0090">In step S<b>704</b>, the management level adding unit <b>304</b> adds signature information to the document data registered in step S<b>703</b>. More specifically, the management level adding unit <b>304</b> obtains signature information by encoding (encrypting or hashing) document data by using a private key (private key in public key cryptography) unique to the management server <b>102</b>.</p>
<p id="p-0089" num="0091">In step S<b>705</b>, the public key and the document data to which the signature data is added in step S<b>704</b> are transmitted to the client apparatus <b>101</b> or <b>103</b> via the communication interface <b>1106</b>.</p>
<p id="p-0090" num="0092">By this sequence, the management server <b>102</b> adds signature information (management level information) to document data received from the client apparatus <b>101</b> or <b>103</b>, and sends back the document data.</p>
<p id="p-0091" num="0093">The operation sequence of <figref idref="DRAWINGS">FIG. 6</figref> in the client apparatus <b>101</b> or <b>103</b> and that of <figref idref="DRAWINGS">FIG. 7</figref> in the management server <b>102</b> operate in association with each other. More specifically, document data transmitted from the client apparatus <b>101</b> or <b>103</b> in step S<b>604</b> is received by the management server <b>102</b> in step S<b>701</b>. Management level information-added document data transmitted from the management server <b>102</b> to the client apparatus <b>101</b> or <b>103</b> in step S<b>705</b> is received by the client apparatus <b>101</b> or <b>103</b> in step S<b>605</b>. A public key transmitted from the management server <b>102</b> to the client apparatus <b>101</b> or <b>103</b> in step S<b>705</b> is received by the client apparatus <b>101</b> or <b>103</b> in step S<b>606</b>.</p>
<p id="p-0092" num="0094"><figref idref="DRAWINGS">FIG. 8</figref> shows an operation sequence in the image forming apparatus <b>105</b>. <figref idref="DRAWINGS">FIG. 8</figref> shows an operation sequence from acquisition of document data stored in a portable recording medium in step S<b>607</b> to storage of output job information corresponding to the document data in the portable recording medium. The following steps are implemented by executing a control program by the CPU <b>1001</b> of the image forming apparatus <b>105</b>.</p>
<p id="p-0093" num="0095">In step S<b>801</b>, the print control unit <b>201</b> acquires document data from a portable recording medium connected via the communication interface <b>1006</b>, and outputs it to the management level determination unit <b>202</b>.</p>
<p id="p-0094" num="0096">In step S<b>802</b>, if data for confirming the validity of signature information (verification information) can be acquired from the portable recording medium via the communication interface <b>1106</b>, the print control unit <b>201</b> acquires the data. In this case, the print control unit <b>201</b> acquires the public key of the management server <b>102</b>. If the print control unit <b>201</b> has acquired the public key, the process advances to step S<b>803</b>. If the print control unit <b>201</b> cannot acquire the public key, the document data is set to &#x201c;management level 0&#x201d;, and the process advances to step S<b>804</b>.</p>
<p id="p-0095" num="0097">In step S<b>803</b>, the management level determination unit <b>202</b> executes processing for verifying the validity of the signature information by using the document data and public key input in steps S<b>801</b> and S<b>802</b>. If the management level determination unit <b>202</b> has failed in confirming the validity of the signature information, it sets the document data to &#x201c;management level 0&#x201d;, and the process advances to step S<b>804</b>. If the management level determination unit <b>202</b> has confirmed the validity of the signature information, it sets the document data to &#x201c;management level 1&#x201d;, and the process advances to step S<b>811</b>.</p>
<p id="p-0096" num="0098">In step S<b>804</b>, the print control unit <b>201</b> determines whether the available area (i.e., free area) of the portable recording medium is large enough to store output document data information and environment information (area determination unit). If the available area is sufficient, the process advances to step S<b>805</b>; if it is insufficient, to step S<b>817</b>.</p>
<p id="p-0097" num="0099">In step S<b>805</b>, the environment information acquiring unit <b>203</b> acquires environment information (setting information). For example, the environment information acquiring unit <b>203</b> acquires the user name, file name, device name and location, and job type.</p>
<p id="p-0098" num="0100">In step S<b>806</b>, the print control unit <b>201</b> stores the environment information acquired in step S<b>805</b> in the portable recording medium connected via the communication interface <b>1006</b>.</p>
<p id="p-0099" num="0101">In step S<b>807</b>, the output control unit forms and outputs an image based on the document data. More specifically, the document data is rasterized into image data, and printing is done on a print medium such as paper on the basis of the image data.</p>
<p id="p-0100" num="0102">In step S<b>808</b>, the image data generated in step S<b>807</b> is acquired. The reduced image (thumbnail image) of the image data generated in step S<b>807</b> may also be acquired.</p>
<p id="p-0101" num="0103">In step S<b>809</b>, the environment information acquiring unit <b>203</b> acquires status information of the output job executed in step S<b>807</b>.</p>
<p id="p-0102" num="0104">In step S<b>810</b>, the print control unit <b>201</b> stores the following information. More specifically, the image data and status information acquired in steps S<b>808</b> and S<b>809</b> are stored as output job information (output log information) in the portable recording medium connected via the communication interface <b>1006</b> (output log storing control unit).</p>
<p id="p-0103" num="0105">In step S<b>811</b>, the print control unit <b>201</b> determines whether the available area (i.e., free area) of the portable recording medium is large enough to store environment information (area determination unit). If the available area is sufficient, the process advances to step S<b>812</b>; if it is insufficient, to step S<b>817</b>.</p>
<p id="p-0104" num="0106">In step S<b>812</b>, the environment information acquiring unit <b>203</b> acquires environment information (setting information). For example, the environment information acquiring unit <b>203</b> acquires the user name, file name, device name and location, and job type.</p>
<p id="p-0105" num="0107">In step S<b>813</b>, the print control unit <b>201</b> stores the environment information acquired in step S<b>805</b> in the portable recording medium connected via the communication interface <b>1006</b>. The environment information may also be encoded (encrypted) using the public key acquired in step S<b>802</b>, and stored in the portable recording medium.</p>
<p id="p-0106" num="0108">In step S<b>814</b>, the output control unit forms and outputs an image based on the document data. More specifically, the document data is rasterized into image data, and printing is done on a print medium such as paper on the basis of the image data.</p>
<p id="p-0107" num="0109">In step S<b>815</b>, the environment information acquiring unit <b>203</b> acquires status information of the output job executed in step S<b>814</b>.</p>
<p id="p-0108" num="0110">In step S<b>816</b>, the print control unit <b>201</b> stores the status information acquired in step S<b>815</b> in the portable recording medium connected via the communication interface <b>1006</b> (output log storing control unit). The status information may also be encoded (encrypted) using the public key acquired in step S<b>802</b>, and stored as output job information (output log information) in the portable recording medium.</p>
<p id="p-0109" num="0111">In step S<b>817</b>, the output job is canceled. Since the free area of the portable recording medium is insufficient to store the output log, output is inhibited to prevent a management failure.</p>
<p id="p-0110" num="0112">By this sequence, the image forming apparatus <b>105</b> outputs document data stored in the portable recording medium, and stores the output log in the portable recording medium.</p>
<p id="p-0111" num="0113">According to the first embodiment, when verification of signature information is successful, environment information is stored in a portable recording medium. When verification of signature information fails, environment information and document data are stored in the portable recording medium. This can reduce the possibility of running short of the area for storing document data. This can also reduce the possibility of decreasing the business efficiency upon a failure in outputting document data owing to shortage of the area for storing document data.</p>
<p id="p-0112" num="0114"><figref idref="DRAWINGS">FIG. 9</figref> shows an operation sequence executed in the management server <b>102</b> after the image forming apparatus <b>105</b> outputs an image. <figref idref="DRAWINGS">FIG. 9</figref> shows an operation sequence from acquisition of output job information to update of information in the output job information environment table. The following steps are implemented by executing a control program by the CPU <b>1101</b> of the management server <b>102</b>.</p>
<p id="p-0113" num="0115">In step S<b>901</b>, the output job information acquiring unit <b>305</b> acquires output job information (output log information) in a portable recording medium connected via the communication interface <b>1106</b> (log input unit). When the information has been encrypted in steps S<b>813</b> and S<b>816</b>, it is decrypted using a private key held in the management server <b>102</b>. Then, the process advances to step S<b>902</b>.</p>
<p id="p-0114" num="0116">In step S<b>902</b>, the output job information management unit <b>302</b> registers the output job information (output log information) acquired in step S<b>901</b> in the output job information management table <b>301</b>.</p>
<p id="p-0115" num="0117">The above-described image forming system can manage an output job in an image forming apparatus <b>105</b> not connected to a network.</p>
<p id="p-0116" num="0118">(Other Embodiments)</p>
<p id="p-0117" num="0119">The object of the present invention is also achieved by supplying a recording medium which records software program codes for implementing the functions of the above-described embodiment to a system or apparatus, and reading out and executing the program codes recorded in the recording medium by the computer (or the CPU or MPU) of the system or apparatus.</p>
<p id="p-0118" num="0120">In this case, the program codes read out from the computer-readable recording medium implement the functions of the above-described embodiment, and the recording medium which records the program codes constitutes the present invention.</p>
<p id="p-0119" num="0121">The recording medium for supplying the program codes includes a flexible disk, hard disk, optical disk, magnetooptical disk, CD-ROM, CD-R, magnetic tape, nonvolatile memory card, and ROM.</p>
<p id="p-0120" num="0122">The functions of the above-described embodiment are implemented when the computer executes the readout program codes. Also, the present invention includes a case where an OS (Operating System) or the like running on the computer performs part or all of actual processing on the basis of the instructions of the program codes and thereby implements the functions of the above-described embodiment.</p>
<p id="p-0121" num="0123">Furthermore, the present invention includes a case wherein, after the program codes read out from the recording medium are written in the memory of a function expansion board inserted into the computer or the memory of a function expansion unit connected to the computer, the CPU of the function expansion board or function expansion unit performs part or all of actual processing on the basis of the instructions of the program codes and thereby implements the functions of the above-described embodiment.</p>
<p id="p-0122" num="0124">While the present invention has been described with reference to exemplary embodiments, it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structures and functions.</p>
<p id="p-0123" num="0125">This application claims the benefit of Japanese Patent Application No. 2007-287850, filed Nov. 5, 2007, which is hereby incorporated by reference herein in its entirety.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An image forming apparatus comprising:
<claim-text>an input unit which inputs document data generated and stored in a portable recording medium by a client apparatus, the document data being input by the input unit when the portable recording medium is detached from the client apparatus and is attached to the image forming apparatus;</claim-text>
<claim-text>a verification unit which verifies validity of the document data on the basis of verification information associated with the input document data;</claim-text>
<claim-text>an output unit which forms and outputs an image on a print medium on the basis of the document data; and</claim-text>
<claim-text>an output log storing control unit which, when said verification unit determines that the document data is valid, stores, in the portable recording medium, output log information containing no image output from said output unit, and when said verification unit determines that the document data is invalid, stores output log information containing the image in the portable recording medium,</claim-text>
<claim-text>wherein the verification unit verifies that the document data is valid when the verification information indicates that the document data is registered in a management server that manacles output job information,</claim-text>
<claim-text>wherein the verification unit verifies that the document data is invalid when the verification information indicates that the document data is not registered in the management server, and</claim-text>
<claim-text>wherein the output log storing control unit stores first information in the portable recording medium, when said verification unit determines that the document data is registered in the management server, the first information comprising output log information including environment information regarding the outputting of said output unit but not including the image output from said output unit, and stores second information in the portable recording medium, when said verification unit determines that the document data is not registered in the management server, the second information comprising output log information including the environment information regarding the outputting of said output unit and including the image output from said output unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising a determination unit which determines whether verification information associated with the document data input from said input unit exists,
<claim-text>wherein when said determination unit determines that no verification information exists, said output log storing control unit stores the output log information containing the image in the portable recording medium.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>an area determination unit which determines whether a free area for storing output log information exists in the portable recording medium; and</claim-text>
<claim-text>a control unit which, when said area determination unit determines that the free area for storing output log information does not exist in the portable recording medium, inhibits execution of outputting the document data from said output unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the image forming apparatus is communicatively disconnected from a management server apparatus when the output log storing control unit stores in the portable recording medium either the output log information containing no image output from said output unit or the output log information containing the image.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A method of controlling an image forming apparatus, the method comprising:
<claim-text>an input step of inputting document data generated and stored in a portable recording medium by a client apparatus, the document data being input by the input step when the portable recording medium is detached from the client apparatus and is attached to the image forming apparatus;</claim-text>
<claim-text>a verification step of verifying validity of the document data on the basis of verification information associated with the input document data;</claim-text>
<claim-text>an output step of forming and outputting an image on a print medium on the basis of the document data; and</claim-text>
<claim-text>an output log storing control step of, when the document data is determined in the verification step to be valid, storing, in the portable recording medium, output log information containing no image output in the output step, and when the document data is determined to be invalid, storing output log information containing the image in the portable recording medium,</claim-text>
<claim-text>wherein each of said steps is implemented at least in part by a computer of the image forming apparatus,</claim-text>
<claim-text>wherein the verification step includes verifying that the document data is valid when the verification information indicates that the document data is registered in a management server that manages output job information,</claim-text>
<claim-text>wherein the verification step includes verifying that the document data is invalid when the verification information indicates that the document data is not registered in the management server, and</claim-text>
<claim-text>wherein the output log storing control step includes storing in the portable recording medium, when it is determined in said verification step that the document data is registered in the management server, output log information including environment information regarding the outputting in said output step but not including the image output in said output step, and storing in the portable recording medium, when it is determined in said verification step that the document data is not registered in the management server, output log information including the environment information regarding the outputting in said output step and including the image output in said output step.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the image forming apparatus is communicatively disconnected from a management server apparatus when the output log storing control step stores in the portable recording medium either the output log information containing no image output in said output step or the output log information containing the image.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A non-transitory computer-readable storage medium storing a computer program, the computer program causing at least a computer in an image forming apparatus to execute a method of controlling the image forming apparatus, the method comprising:
<claim-text>an input step of inputting document data generated and stored in a portable recording medium by a client apparatus, the document data being input by the input step when the portable recording medium is detached from the client apparatus and is attached to the image forming apparatus,</claim-text>
<claim-text>a verification step of verifying validity of the document data on the basis of verification information associated with the input document data, an output step of forming and outputting an image on a print medium on the basis of the document data, and</claim-text>
<claim-text>an output log storing control step of, when the document data is determined in the verification step to be valid, storing, in the portable recording medium, output log information containing no image output in the output step, and when the document data is determined in the verification step to be invalid, storing output log information containing the image in the portable recording medium,</claim-text>
<claim-text>wherein the verification step includes verifying that the document data is valid when the verification information indicates that the document data is registered in a management server that manages output job information,</claim-text>
<claim-text>wherein the verification step includes verifying that the document data is invalid when the verification information indicates that the document data is not registered in the management server, and</claim-text>
<claim-text>wherein the output log storing control step includes storing in the portable recording medium, when it is determined in said verification step that the document data is registered in the management server, output log information including environment information regarding the outputting in said output step but not including the image output in said output step, and storing in the portable recording medium, when it is determined in said verification step that the document data is not registered in the management server, output log information including the environment information regarding the outputting in said output step and including the image output in said output step.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The non-transitory computer-readable storage medium according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the image forming apparatus is communicatively disconnected from a management server apparatus when the output log storing control step stores in the portable recording medium either the output log information containing no image output in said output step or the output log information containing the image. </claim-text>
</claim>
</claims>
</us-patent-grant>
