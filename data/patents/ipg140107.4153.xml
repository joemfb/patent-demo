<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625222-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625222</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13365635</doc-number>
<date>20120203</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<us-term-extension>51</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>11</class>
<subclass>B</subclass>
<main-group>5</main-group>
<subgroup>09</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>360 51</main-classification>
<further-classification>360 42</further-classification>
<further-classification>369 4753</further-classification>
</classification-national>
<invention-title id="d2e53">Storage device having calibration circuitry providing programmable phase update values</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5550685</doc-number>
<kind>A</kind>
<name>Drouin</name>
<date>19960800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6943978</doc-number>
<kind>B1</kind>
<name>Lee</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7675703</doc-number>
<kind>B2</kind>
<name>Albrecht et al.</name>
<date>20100300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7872825</doc-number>
<kind>B2</kind>
<name>Sanghvi</name>
<date>20110100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7911724</doc-number>
<kind>B2</kind>
<name>Buch et al.</name>
<date>20110300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>8049982</doc-number>
<kind>B1</kind>
<name>Grundvig et al.</name>
<date>20111100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>8289643</doc-number>
<kind>B2</kind>
<name>Grundvig et al.</name>
<date>20121000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 51</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2005/0135212</doc-number>
<kind>A1</kind>
<name>Adachi</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>369 4753</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2011/0058274</doc-number>
<kind>A1</kind>
<name>Nishida et al.</name>
<date>20110300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2012/0123726</doc-number>
<kind>A1</kind>
<name>Sakai</name>
<date>20120500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>702117</main-classification></classification-national>
</us-citation>
</us-references-cited>
<number-of-claims>21</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>360 51</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>360 31</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>360 42</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>360 69</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>360 75</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>360 70</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>360 7302</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>360 7708</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>369 4751</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>369 4752</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>369 4753</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>369116</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>7</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20130201576</doc-number>
<kind>A1</kind>
<date>20130808</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Grundvig</last-name>
<first-name>Jeffrey P.</first-name>
<address>
<city>Loveland</city>
<state>CO</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Grundvig</last-name>
<first-name>Jeffrey P.</first-name>
<address>
<city>Loveland</city>
<state>CO</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Ryan, Mason &#x26; Lewis, LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>LSI Corporation</orgname>
<role>02</role>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Hindi</last-name>
<first-name>Nabil</first-name>
<department>2686</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A hard disk drive or other disk-based storage device comprises a storage disk, a read/write head configured to read data from and write data to the disk, and control circuitry coupled to the read/write head and configured to process data received from and supplied to the read/write head. The control circuitry comprises calibration circuitry configured to vary a phase of a clock signal as a test pattern is written to the storage disk as part of a calibration procedure, and disk locked clock circuitry coupled to the calibration circuitry and configured to obtain phase lock between the clock signal and a timing pattern on a surface of the storage disk. The calibration circuitry is further configured to determine an initial phase update value to be applied by the disk locked clock circuitry in a control loop as the phase of the clock signal is varied as part of the calibration procedure.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="201.68mm" wi="155.19mm" file="US08625222-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="258.83mm" wi="162.14mm" file="US08625222-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="242.49mm" wi="156.72mm" file="US08625222-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="190.08mm" wi="169.59mm" file="US08625222-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="222.76mm" wi="158.07mm" file="US08625222-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="242.49mm" wi="146.47mm" file="US08625222-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND</heading>
<p id="p-0002" num="0001">Disk-based storage devices such as hard disk drives (HDDs) are used to provide non-volatile data storage in a wide variety of different types of data processing systems. A typical HDD comprises a spindle which holds one or more flat circular storage disks, also referred to as platters. Each storage disk comprises a substrate made from a non-magnetic material, such as aluminum or glass, which is coated with one or more thin layers of magnetic material. In operation, data is read from and written to tracks of the storage disk via a read/write head that is moved precisely across the disk surface by a positioning arm as the disk spins at high speed.</p>
<p id="p-0003" num="0002">The storage capacity of HDDs continues to increase, and HDDs that can store multiple terabytes (TB) of data are currently available. However, increasing the storage capacity often involves shrinking track dimensions in order to fit more tracks onto each storage disk, such that inter-track interference (ITI) becomes an important performance issue.</p>
<p id="p-0004" num="0003">A number of techniques have been developed in an attempt to further increase storage capacity. For example, a technique known as shingled magnetic recording (SMR) attempts to increase storage capacity of an HDD by &#x201c;shingling&#x201d; a given track over a previously written adjacent track on a storage disk. In another technique, referred to as bit-patterned media (BPM), high density tracks of magnetic islands are preformed on the surface of the storage disk, and bits of data are written to respective ones of these islands.</p>
<p id="p-0005" num="0004">A conventional HDD may implement a disk locked clock (DLC) technique to reduce frequency and phase differences between an internal read channel clock and a servo timing pattern on a surface of the storage disk. This allows data sectors to be written with less frequency variation, such that a clock recovery loop in the read channel does not have to handle as much frequency variation when the data sectors are read.</p>
<p id="p-0006" num="0005">A typical DLC technique may involve, for example, measuring the position and phase of servo address marks (SAMs) that provide the timing pattern on the surface of the storage disk. Additional details regarding measurement of SAMs in an HDD or other disk-based storage device may be found in U.S. Pat. No. 8,049,982, entitled &#x201c;Methods and Apparatus for Measuring Servo Address Mark Distance in a Read Channel Using Selective Fine Phase Estimate,&#x201d; which is commonly assigned herewith and incorporated by reference herein.</p>
<p id="p-0007" num="0006">In many HDD applications it is important to calibrate the phase of an internal read channel clock relative to fixed magnetic information on the disk. For example, in the case of</p>
<p id="p-0008" num="0007">BPM, the phase of the write clock must be properly aligned relative to the bit-sized magnetic islands preformed on the surface of the storage disk in order to be able to write data to these islands. A conventional write calibration procedure generally involves writing one or more test patterns on the disk using different phases or writing such test patterns with a modulated phase across a predetermined phase range, and then going back to read the test patterns to determine which phase was optimal for the desired purpose, such as determining which phase aligns most optimally with the magnetic islands in the case of BPM. As a more particular example, this write calibration procedure may involve writing a periodic test pattern to the media while ramping the write clock phase and then determining at what point during the phase ramp the best result was achieved.</p>
<p id="p-0009" num="0008">In these and similar write calibration procedures, the write clock phase must be accurately controlled while the test pattern is being written. This functionality is provided by DLC circuitry of the HDD. Since the same internal read channel clock is typically used for both reading and writing, the phase of this clock will be varying during write calibration. However, the DLC circuitry still needs to lock to the SAM timing pattern on the storage disk, and without such a lock the calibration results will not be sufficiently accurate. Thus, the write calibration may be periodically interrupted in order to allow the DLC circuitry to read the timing pattern and compute an error term so as to maintain a phase lock to the timing pattern during the write clock calibration procedure. The amount of time required to perform write calibration is therefore adversely impacted by factors such as the settling time of the DLC circuitry in locking to the timing pattern as the clock phase is varied.</p>
<heading id="h-0002" level="1">SUMMARY</heading>
<p id="p-0010" num="0009">Illustrative embodiments of the invention provide HDDs or other types of disk-based storage devices that exhibit enhanced operating performance by implementing write calibration in a manner that significantly reduces the settling time of the DLC circuitry as the write clock phase is varied, thereby reducing the amount of time required to perform the write clock calibration.</p>
<p id="p-0011" num="0010">In one embodiment, an HDD or other disk-based storage device comprises a storage disk, a read/write head configured to read data from and write data to the storage disk, and control circuitry coupled to the read/write head and configured to process data received from and supplied to the read/write head. The control circuitry comprises calibration circuitry configured to vary a phase of a clock signal as a test pattern is written to the storage disk as part of a calibration procedure, and DLC circuitry coupled to the calibration circuitry and configured to obtain phase lock between the clock signal and a timing pattern on a surface of the storage disk. The calibration circuitry is further configured to determine an initial phase update value to be applied by the DLC circuitry in a control loop as the phase of the clock signal is varied as part of the calibration procedure.</p>
<p id="p-0012" num="0011">By way of example, the initial phase update value may be selected so as to reduce an acquisition time of the control loop relative to an acquisition time that would result if the initial phase update value were instead selected in accordance with a phase variation as specified in the calibration procedure.</p>
<p id="p-0013" num="0012">As a more particular example, the phase of the clock signal may vary in accordance with a phase ramp as the test pattern is written to the storage disk as part of the calibration procedure. In such an arrangement, the initial phase update value may be determined based at least in part on a phase ramp error measurement generated for a previous iteration of the calibration procedure, such as a single phase ramp error measurement generated for a single immediately preceding iteration of the calibration procedure. Alternatively, the initial phase update value may be determined based at least in part on a plurality of phase ramp error measurements generated for respective previous iterations of the calibration procedure, such as a moving average of a designated number of phase ramp error measurements generated for respective immediately preceding iterations of the calibration procedure. A wide variety of similar embodiments may be configured in which the phase of the clock signal does not vary in accordance with a phase ramp, but instead utilizes a different type of predetermined phase variation.</p>
<p id="p-0014" num="0013">Additionally or alternatively, the calibration circuitry may be configured to determine a steady state phase update value to be applied by the DLC circuitry in the control loop as the phase of the clock signal is varied as part of the calibration procedure, where the steady state phase update value is different than the initial phase update value.</p>
<p id="p-0015" num="0014">The calibration circuitry may comprise a plurality of programmable calibration registers configured for storing respective initial and steady state phase update values for use by the DLC circuitry.</p>
<p id="p-0016" num="0015">One or more of the embodiments of the invention provide significant improvements in disk-based storage devices. For example, by implementing programmable initial update values for phase ramping or other types of phase variations specified by write calibration procedures, the settling time of the DLC circuitry can be significantly reduced, thereby allowing a given iteration of the write calibration procedure to be completed much more quickly and accurately than would otherwise be possible. This leads to improved overall operating performance of the disk-based storage device.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 1</figref> shows a perspective view of a disk-based storage device in accordance with an illustrative embodiment of the invention.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 2</figref> shows a plan view of a storage disk in the storage device of <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of a portion of the storage device of <figref idref="DRAWINGS">FIG. 1</figref> including an exemplary system-on-chip comprising a disk controller and read channel circuitry.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 4</figref> shows a more detailed view of the read channel circuitry of <figref idref="DRAWINGS">FIG. 3</figref> including calibration circuitry and associated DLC circuitry in an illustrative embodiment.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 5</figref> is a flow diagram illustrating the operation of the circuitry shown in <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 6</figref> illustrates interconnection of the storage device of <figref idref="DRAWINGS">FIG. 1</figref> with a host processing device in a data processing system.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 7</figref> shows a virtual storage system incorporating a plurality of disk-based storage devices of the type shown in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0024" num="0023">Embodiments of the invention will be illustrated herein in conjunction with exemplary disk-based storage devices, control circuitry and associated calibration circuitry and techniques. It should be understood, however, that these and other embodiments of the invention are more generally applicable to any disk-based storage device in which improved performance in terms of accurate and efficient calibration is desired. Additional embodiments may be implemented using components other than those specifically shown and described in conjunction with the illustrative embodiments.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 1</figref> shows a disk-based storage device <b>100</b> in accordance with an illustrative embodiment of the invention. The storage device <b>100</b> in this embodiment more specifically comprises an HDD that includes a storage disk <b>110</b>. The storage disk <b>110</b> has a storage surface coated with one or more magnetic materials capable of storing data in the form of magnetization states. The storage disk <b>110</b> is connected to a spindle <b>120</b>. The spindle <b>120</b> is driven by a spindle motor, not explicitly shown in the figure, in order to spin the storage disk <b>110</b> at high speed.</p>
<p id="p-0026" num="0025">Data is read from and written to the storage disk <b>110</b> via a read/write head <b>130</b> that is mounted on a positioning arm <b>140</b>. The position of the read/write head over the magnetic surface of the storage disk <b>110</b> is controlled by an electromagnetic actuator <b>150</b>. The electromagnetic actuator <b>150</b> and its associated driver circuitry in the present embodiment may be viewed as comprising a portion of what is more generally referred to herein as &#x201c;control circuitry&#x201d; of the storage device <b>100</b>. Such control circuitry in this embodiment is assumed to further include additional electronics components arranged on an opposite side of the assembly and therefore not visible in the perspective view of <figref idref="DRAWINGS">FIG. 1</figref>. The term &#x201c;control circuitry&#x201d; as used herein is therefore intended to be broadly construed so as to encompass, by way of example and without limitation, drive electronics, signal processing electronics, and associated processing and memory circuitry, and may encompass additional or alternative elements utilized to control positioning of a read/write head relative to a storage surface of a storage disk in a storage device. A connector <b>160</b> is used to connect the storage device <b>100</b> to a host computer or other related processing device.</p>
<p id="p-0027" num="0026">It is to be appreciated that, although <figref idref="DRAWINGS">FIG. 1</figref> shows an embodiment of the invention with only one instance of each of the single storage disk <b>110</b>, read/write head <b>130</b>, and positioning arm <b>140</b>, this is by way of illustrative example only, and alternative embodiments of the invention may comprise multiple instances of one or more of these or other drive components. For example, one such alternative embodiment may comprise multiple storage disks attached to the same spindle so all such disks rotate at the same speed, and multiple read/write heads and associated positioning arms coupled to one or more actuators. A given read/write head as that term is broadly used herein may be implemented in the form of a combination of separate read and write heads.</p>
<p id="p-0028" num="0027">Also, the storage device <b>100</b> as illustrated in <figref idref="DRAWINGS">FIG. 1</figref> may include other elements in addition to or in place of those specifically shown, including one or more elements of a type commonly found in a conventional implementation of such a storage device. These and other conventional elements, being well understood by those skilled in the art, are not described in detail herein. It should also be understood that the particular arrangement of elements shown in <figref idref="DRAWINGS">FIG. 1</figref> is presented by way of illustrative example only. The disclosed techniques are more generally applicable without limitation to any storage device application in which it is desirable to provide improved calibration within the storage device. Those skilled in the art will therefore recognize that a wide variety of other storage device configurations may be used in implementing embodiments of the invention.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 2</figref> shows the storage surface of the storage disk <b>110</b> in greater detail. As illustrated, the storage surface of storage disk <b>110</b> comprises a plurality of concentric tracks <b>210</b>. Each track is subdivided into a plurality of sectors <b>220</b> which are capable of storing a block of data for subsequent retrieval. The tracks located toward the outside edge of the storage disk have a larger circumference when compared to those located toward the center of the storage disk. The tracks are grouped into several annular zones <b>230</b>, where the tracks within a given one of the zones have the same number of sectors. Those tracks in the outer zones have more sectors than those located in the inner zones. In this example, it is assumed that the storage disk <b>110</b> comprises M+1 zones, including an outermost zone <b>230</b>-<b>0</b> and an innermost zone <b>230</b>-M.</p>
<p id="p-0030" num="0029">The outer zones of the storage disk <b>110</b> provide a higher data transfer rate than the inner zones. This is in part due to the fact that the storage disk in the present embodiment, once accelerated to rotate at operational speed, spins at a constant angular or radial speed regardless of the positioning of the read/write head, but the tracks of the inner zones have smaller circumference than those of the outer zones. Thus, when the read/write head is positioned over one of the tracks of an outer zone, it covers a greater linear distance along the disk surface for a given 360&#xb0; turn of the storage disk than when it is positioned over one of the tracks of an inner zone. Such an arrangement is referred to as having constant angular velocity (CAV), since each 360&#xb0; turn of the storage disk takes the same amount of time, although it should be understood that CAV operation is not a requirement of embodiments of the invention.</p>
<p id="p-0031" num="0030">Data bit density is generally constant across the entire storage surface of the storage disk <b>110</b>, which results in higher data transfer rates at the outer zones. Since each outer zone stores more data than the inner zones, the read/write head need not be moved as frequently to read a given amount of data when accessing data in the outer zones. Data can therefore be transferred at a higher rate to or from tracks in the outer zones than to or from tracks in the inner zones.</p>
<p id="p-0032" num="0031">Accordingly, the outermost annular zone <b>230</b>-<b>0</b> of the storage disk has a higher average data transfer rate than the innermost annular zone <b>230</b>-M of the storage disk. The average data transfer rates may differ between the innermost and outermost annular zones in a given embodiment by more than a factor of two.</p>
<p id="p-0033" num="0032">As one example embodiment, provided by way of illustration only, the outermost annular zone may have a data transfer rate of approximately 2.3 Gigabits per second (Gb/s), while the innermost annular zone has a data transfer rate of approximately 1.0 Gb/s. In such an implementation, the HDD may more particularly have a total storage capacity of 500 GB and a spindle speed of 7200 RPM, with the data transfer rates ranging, as noted above, from about 2.3 Gb/s for the outermost zone to about 1.0 Gb/s for the innermost zone.</p>
<p id="p-0034" num="0033">The storage disk <b>110</b> is also assumed to include a timing pattern formed on its storage surface. Such a timing pattern may comprise one or more sets of servo address marks (SAMs) or other types of servo marks formed in particular sectors in a conventional manner. SAMs may therefore be viewed as an example of what are more specifically referred to herein as servo marks. Thus, a &#x201c;timing pattern&#x201d; as that term is used herein refers to an arrangement of multiple servo marks.</p>
<p id="p-0035" num="0034">The storage device <b>100</b> in the present embodiment implements a disk locked clock (DLC) technique to reduce frequency and phase differences between an internal read channel clock and a servo timing pattern on a surface of the storage disk <b>110</b>. As indicated previously, a typical DLC technique may involve, for example, measuring the position and phase of servo marks that provide the timing pattern on the surface of the storage disk.</p>
<p id="p-0036" num="0035">The particular data transfer rates and other features referred to in the embodiment described above are presented for purposes of illustration only, and should not be construed as limiting in any way. A wide variety of other data transfer rates and storage disk configurations may be used in other embodiments.</p>
<p id="p-0037" num="0036">An embodiment of the invention will be described below in conjunction with <figref idref="DRAWINGS">FIGS. 3 to 5</figref>, in which the storage device <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref> is configured to implement calibration circuitry that interacts with DLC circuitry in order to provide improved write calibration in the storage device <b>100</b>. The embodiment may be viewed as an example of an arrangement in which the calibration circuitry is configured to vary a phase of a clock signal as a test pattern is written to the storage disk as part of a calibration procedure. The DLC circuitry is coupled to the calibration circuitry and configured to obtain a phase lock between the clock signal and a timing pattern on a surface of the storage disk. The calibration circuitry is further configured to determine an initial phase update value to be applied by the DLC circuitry in a control loop as the phase of the clock signal is varied as part of the calibration procedure.</p>
<p id="p-0038" num="0037">The calibration circuitry may additionally or alternatively be configured to determine a steady state phase update value to be applied by the DLC circuitry in the control loop as the phase of the clock signal is varied as part of the calibration procedure, with the steady state phase update value being different than the initial phase update value.</p>
<p id="p-0039" num="0038">The term &#x201c;test pattern&#x201d; as used herein is intended to be broadly construed, so as to encompass, for example, any arrangement of test data that may be written to a disk as part of a calibration procedure. A given such test pattern may therefore comprise a portion of a larger data pattern, a combination of multiple smaller data patterns, a group of repeated data patterns, etc. Numerous calibration test patterns suitable for use in embodiments of the present invention are well known to those skilled in the art.</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 3</figref> shows a portion of the storage device <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref> in greater detail. In this view, the storage device <b>100</b> comprises a processor <b>300</b>, a memory <b>302</b> and a system-on-a-chip (SOC) <b>304</b>, which communicate over a bus <b>306</b>. The storage device further comprises driver circuitry <b>305</b> providing an interface between the SOC <b>304</b> and the read/write head <b>130</b>. The driver circuitry <b>305</b> may comprise, for example, a preamplifier and other associated interface circuitry. The memory <b>302</b> is an external memory relative to the SOC <b>304</b> and other components of the storage device <b>100</b>, but is nonetheless internal to that storage device. The SOC <b>304</b> in the present embodiment includes read channel circuitry <b>310</b> and a disk controller <b>312</b>, and directs the operation of the read/write head <b>130</b> in reading data from and writing data to the storage disk <b>110</b>. The read channel circuitry <b>310</b> comprises DLC circuitry <b>315</b>, write calibration circuitry <b>318</b>, a clock generator <b>320</b>, servo circuitry <b>322</b>, a data processor <b>324</b>, and read channel memory <b>326</b>.</p>
<p id="p-0041" num="0040">The bus <b>306</b> may comprise, for example, one or more interconnect fabrics. Such fabrics may be implemented in the present embodiment as Advanced eXtensible Interface (AXI) fabrics, described in greater detail in, for example, the Advanced Microcontroller Bus Architecture (AMBA) AXI v2.0 Specification, which is incorporated by reference herein. The bus may also be used to support communications between other system components, such as between the SOC <b>304</b> and the driver circuitry <b>305</b>. It should be understood that AXI interconnects are not required, and that a wide variety of other types of bus configurations may be used in embodiments of the invention.</p>
<p id="p-0042" num="0041">The processor <b>300</b>, memory <b>302</b>, SOC <b>304</b> and driver circuitry <b>305</b> may be viewed as collectively comprising one possible example of &#x201c;control circuitry&#x201d; as that term is utilized herein. Numerous alternative arrangements of control circuitry may be used in other embodiments, and such arrangements may include only a subset of the components <b>300</b>, <b>302</b>, <b>304</b> and <b>305</b>, or portions of one or more of these components. For example, the SOC <b>304</b> itself may be viewed as an example of &#x201c;control circuitry.&#x201d; The control circuitry of the storage device <b>100</b> in the embodiment as shown in <figref idref="DRAWINGS">FIG. 3</figref> is generally configured to process data received from and supplied to the read/write head <b>130</b> and to control positioning of the read/write head <b>130</b> relative to the storage disk <b>110</b>.</p>
<p id="p-0043" num="0042">The write calibration circuitry <b>318</b> of SOC <b>304</b> may be viewed as an example of what is more generally referred to herein as &#x201c;calibration circuitry.&#x201d; Write calibration of the type provided by write calibration circuitry <b>318</b> as described below can be particularly beneficial in embodiments that implement high-density storage technologies such as shingled magnetic recording (SMR) and bit-patterned media (BPM).</p>
<p id="p-0044" num="0043">The DLC circuitry <b>315</b> as illustrated in <figref idref="DRAWINGS">FIG. 3</figref> receives servo timing information from the servo circuitry <b>322</b>, and also receives a read channel clock from the clock generator <b>320</b>. The clock generator <b>320</b> may comprise, for example, an analog synthesizer. The servo circuitry <b>322</b> generates the servo timing information by detecting the timing pattern formed by SAMs on the surface of the storage disk <b>110</b>. The DLC circuitry <b>315</b> may include a phase error detector that compares the read channel clock signal from clock generator <b>320</b> with the servo timing information from servo circuitry <b>322</b>. By way of example, this comparison may involve determining if the number of clock cycles of a divided-down version of the read channel clock signal that occur within a time period defined by adjacent detected SAMs is above or below an expected number of such clock cycles.</p>
<p id="p-0045" num="0044">In such an arrangement, the control signal supplied by the DLC circuitry <b>315</b> back to the clock generator <b>320</b> may vary in a manner that causes the frequency of the clock signal to increase if the number of clock cycles of the divided-down version of the clock signal that occur within the time period defined by adjacent detected SAMs is below the expected number of such clock cycles. Similarly, the control signal supplied by the DLC circuitry <b>315</b> back to the clock generator <b>320</b> may vary in a manner that causes the frequency of the clock signal to decrease if the number of clock cycles of the divided-down version of the clock signal that occur within the time period defined by adjacent detected SAMs is above the expected number of such clock cycles. The control signal generated by the DLC circuitry <b>315</b> is therefore configured to vary responsive to the comparison of the read channel clock and the servo timing information so as to cause the frequency and phase of the read channel clock to be locked to the servo timing information.</p>
<p id="p-0046" num="0045">The above-described variations in the control signal are generated in a control loop for which an initial phase update value is determined by the write calibration circuitry <b>318</b>, as will be described in greater detail below in conjunction with <figref idref="DRAWINGS">FIGS. 4 and 5</figref>. However, the term &#x201c;control loop&#x201d; as used herein should not be viewed as being limited to these or similar arrangements, and numerous alternative control loop configurations may be used in other embodiments.</p>
<p id="p-0047" num="0046">It should be noted that certain operations of the SOC <b>304</b> in the storage device <b>100</b> of <figref idref="DRAWINGS">FIG. 3</figref> may be directed by processor <b>300</b>, which executes code stored in external memory <b>302</b>. For example, the processor <b>300</b> may be configured to execute code stored in the memory <b>302</b> for performing at least a portion of a write calibration procedure carried out by the SOC <b>304</b>. Thus, at least a portion of the calibration functionality of the storage device <b>100</b> may be implemented at least in part in the form of software code.</p>
<p id="p-0048" num="0047">The external memory <b>302</b> may comprise electronic memory such as random access memory (RAM) or read-only memory (ROM), in any combination. In the present embodiment, it is assumed without limitation that the external memory <b>302</b> is implemented at least in part as a double data rate (DDR) synchronous dynamic RAM (SDRAM). The memory <b>302</b> is an example of what is more generally referred to herein as a &#x201c;computer-readable storage medium.&#x201d; Such a medium may also be writable.</p>
<p id="p-0049" num="0048">Although the SOC <b>304</b> in the present embodiment is assumed to be implemented on a single integrated circuit, that integrated circuit may further comprise portions of the processor <b>300</b>, memory <b>302</b>, driver circuitry <b>305</b> and bus <b>306</b>. Alternatively, portions of the processor <b>300</b>, memory <b>302</b>, driver circuitry <b>305</b> and bus <b>306</b> may be implemented at least in part in the form of one or more additional integrated circuits, such as otherwise conventional integrated circuits designed for use in an HDD and suitably modified to provide calibration functionality as disclosed herein.</p>
<p id="p-0050" num="0049">An example of an SOC integrated circuit that may be modified to incorporate an embodiment of the present invention is disclosed in U.S. Pat. No. 7,872,825, entitled &#x201c;Data Storage Drive with Reduced Power Consumption,&#x201d; which is commonly assigned herewith and incorporated by reference herein.</p>
<p id="p-0051" num="0050">Other types of integrated circuits that may be used to implement processor, memory or other storage device components of a given embodiment include, for example, a microprocessor, digital signal processor (DSP), application-specific integrated circuit (ASIC), field-programmable gate array (FPGA) or other integrated circuit device.</p>
<p id="p-0052" num="0051">In an embodiment comprising an integrated circuit implementation, multiple integrated circuit dies may be formed in a repeated pattern on a surface of a wafer. Each such die may include a device as described herein, and may include other structures or circuits. The dies are cut or diced from the wafer, then packaged as integrated circuits. One skilled in the art would know how to dice wafers and package dies to produce packaged integrated circuits. Integrated circuits so manufactured are considered embodiments of the invention.</p>
<p id="p-0053" num="0052">Although shown as part of the storage device <b>100</b> in the present embodiment, one or both of the processor <b>300</b> and memory <b>302</b> may be implemented at least in part within an associated processing device, such as a host computer or server in which the storage device is installed. Accordingly, elements <b>300</b> and <b>302</b> in the <figref idref="DRAWINGS">FIG. 3</figref> embodiment may be viewed as being separate from the storage device <b>100</b>, or as representing composite elements each including separate processing or memory circuitry components from both the storage device and its associated processing device. As noted above, at least portions of the processor <b>300</b> and memory <b>302</b> may be viewed as comprising &#x201c;control circuitry&#x201d; as that term is broadly defined herein.</p>
<p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. 4</figref> shows portions of the read channel circuitry <b>310</b> in greater detail. In this embodiment, calibration circuitry <b>318</b> comprises a plurality of programmable calibration registers <b>400</b>, some of which are configured for storing respective initial phase update values <b>402</b> for use by the DLC circuitry <b>315</b>. The programmable calibration registers <b>400</b> in the present embodiment include other registers configured to store respective steady state phase update values <b>404</b> for use by the DLC circuitry <b>315</b>. More particularly, these initial or steady state phase update values are applied by the DLC circuitry in a control loop that controls the frequency and phase of the read channel clock generated by the clock generator <b>320</b>.</p>
<p id="p-0055" num="0054">The calibration circuitry <b>318</b> is configured to vary a phase of the read channel clock as a test pattern is written to the storage disk <b>110</b> as part of a calibration procedure. It is assumed in this embodiment that the read channel clock signal is utilized for both reading data from and writing data to the storage disk <b>110</b>. Accordingly, the phase of this clock signal varies as the test pattern is written to the storage disk. The DLC circuitry is configured to obtain a phase lock between this clock signal and a timing pattern on a surface of the storage disk <b>110</b>. As indicated previously, this timing pattern may comprise a plurality of servo marks preformed on the surface of the storage disk. For example, such servo marks may be formed using a servo writer during manufacture of the storage device <b>100</b>.</p>
<p id="p-0056" num="0055">The calibration circuitry <b>318</b> is also configured to determine an initial phase update value to be applied by the DLC circuitry in the control loop as the phase of the clock signal is varied as part of the calibration procedure. It may also determine a steady state phase update value to be applied by the DLC circuitry in the control loop as the phase of the clock signal is varied as part of the calibration procedure, with the steady state phase update value being different than the initial phase update value.</p>
<p id="p-0057" num="0056">In the present embodiment, the initial phase update value to be applied by the DLC circuitry <b>315</b> is selected from the set of stored initial update values <b>402</b> so as to reduce an acquisition time of the control loop relative to an acquisition time that would result if the initial phase update value were instead selected in accordance with a phase variation as specified in the calibration procedure.</p>
<p id="p-0058" num="0057">By way of example, the calibration procedure may specify that the phase of the clock signal is varied in accordance with a phase ramp as the test pattern is written to the storage disk <b>110</b> as part of the calibration procedure. Such a phase ramp can be characterized as a frequency step. If an initial phase update value was determined based only on the phase ramp, the acquisition time of the control loop may be adversely impacted due to the presence of overshoot, ringing or other non-ideal behavior that can occur from the point in time when the phase ramp starts to when it settles onto the desired linear ramp. Such non-ideal behavior often arises before the control loop is able to drive the read channel clock phase to fully settle within a required tolerance, and thereby adversely impacts control loop acquisition time.</p>
<p id="p-0059" num="0058">The update time of the control loop is typically a longer period of time than the settling time of the analog synthesizer of clock generator <b>320</b>. In an embodiment in which the servo marks are arranged in radial &#x201c;wedges&#x201d; around the storage disk, a control loop update may be performed once per servo wedge where the servo wedge spacing in time is typically on the order of 30 &#x3bc;Sec, whereas the settling time of the analog synthesizer of the clock generator <b>320</b> is typically closer to 10 &#x3bc;sec. Several updates may be required to lock on to the desired ramping clock trajectory, which could move the overall settling time into the millisecond range for a conventional control loop. A similar issue can arise at the end of the phase ramp when the phase needs to return to a non-phase-varying steady state value after the write calibration procedure is completed.</p>
<p id="p-0060" num="0059">As a more particular example, assume that the calibration procedure specifies an ideal phase ramp in which the clock phase is changed by 2.5 clock periods each servo wedge interval, where each servo wedge comprises a servo mark. If the requisite frequency step for causing this phase ramp was applied to the analog synthesizer at a given servo wedge, and initially ignoring control loop behavior, the error measurement for the second servo wedge would show a non-ideal phase movement less than the desired 2.5 clock periods. However, the error measurements for the third servo wedge and each servo wedge thereafter would each show a phase movement of 2.5 clock periods.</p>
<p id="p-0061" num="0060">If we consider now the control loop behavior, at the second servo wedge the DLC circuitry <b>315</b> would see that the clock phase had not moved by the desired 2.5 periods and would therefore increase the synthesizer frequency. But at the third servo wedge it would be seen that this caused the clock period to move by more than the desired 2.5 clock periods and the frequency would be decreased thus leading to a ringing effect until the DLC-based read channel clock control settled to the correct value to always move the clock by 2.5 periods each servo wedge interval.</p>
<p id="p-0062" num="0061">This ringing effect in the control loop can be avoided if for the first servo wedge interval the DLC circuitry <b>315</b> is instructed to use a different initial phase update value, as selected by the calibration circuitry <b>318</b> from the stored initial update values <b>402</b>. More particularly, the DLC circuitry <b>315</b> is instructed to not expect a full movement of 2.5 clock periods but rather something less than the normal 2.5 clock periods and ideally equal to whatever the actual amount of phase movement was for the first servo interval. This actual amount of phase movement cannot be exactly determined beforehand, but can be estimated in an accurate and efficient manner, for example, using initial phase update values and associated phase error measurements for previous iterations of the calibration procedure. Other techniques can be used to estimate initial phase update values. Such values may vary depending upon analog behavior of the control loop, as well as other factors such as temperature and integrated circuit process variations.</p>
<p id="p-0063" num="0062">By configuring the calibration circuitry to determine an appropriate initial phase update value that deviates from the value specified by the phase ramp, the acquisition time of the control loop can be substantially reduced, and non-ideal behavior such as the above-noted ringing effect is eliminated. In this example, the initial phase update value is applied only for the first servo wedge interval after initiation of the phase ramp. If the selected initial phase update value closely matches the actual amount of phase movement for the first servo interval, the phase error measurement at the second servo mark would be close to zero, such that no significant adjustment is made in synthesizer frequency at that point, and the control loop would be locked to the servo timing information. For servo wedge intervals after the first servo interval, the standard expected phase movement of 2.5 clock periods would be used in DLC circuitry <b>315</b>, in accordance with the phase ramp specified by the calibration procedure, and as a result the control loop remains locked despite the presence of the phase ramp.</p>
<p id="p-0064" num="0063">An appropriate steady state phase update value may be determined and applied by DLC circuitry <b>315</b> as the phase is varied in accordance with the phase ramp specified by the calibration procedure, in a manner similar to that described above for the initial phase update value for the beginning of the phase ramp.</p>
<p id="p-0065" num="0064">Accordingly, the present embodiment addresses issues relating to non-ideal behavior by configuring calibration circuitry <b>318</b> to determine an appropriate initial phase update value to be applied by the DLC circuitry <b>315</b> at the beginning of the phase ramp, as well as to determine an appropriate steady state value to be applied by the DLC circuitry at the end of the phase ramp. It is to be understood, however, that use of a phase ramp as the write calibration phase variation is only an example, and other embodiments can utilize other functions to vary the clock phase as part of a calibration procedure. Also, although only a single initial update value for the first servo wedge interval is utilized in the present embodiment, other embodiments may determine multiple update values to be applied at the beginning of the phase ramp, for example, for respective ones of at least first and second servo wedge intervals, with similar processing utilized for the steady state phase update values.</p>
<p id="p-0066" num="0065">The calibration circuitry <b>318</b> in the present embodiment determines the appropriate initial phase update value based at least in part on one or more phase error measurements generated for respective previous iterations of the calibration procedure. This determination more particularly involves use of a state machine <b>405</b>, a phase ramp error measurement module <b>410</b>, and an initial update and phase ramp error history module <b>412</b>.</p>
<p id="p-0067" num="0066">The phase ramp error measurement module <b>410</b> takes phase error measurements for respective iterations of the calibration procedure, and provides those measurements to the initial update and phase ramp error history module <b>412</b>. This module communicates via processor interface <b>414</b>A with the programmable registers <b>400</b>, and stores one or more initial update values <b>402</b> as determined based on previous initial update values and their corresponding phase ramp error measurements. For example, the module <b>412</b> may determine an initial phase update value to be stored in registers <b>400</b> as a moving average of a designated number of phase error measurements generated for respective immediately preceding iterations of the calibration procedure. The state machine <b>405</b> determines when to provide certain stored initial update or steady state values to the DLC circuitry <b>315</b>. Such values may also be applied to clock generator <b>320</b> as shown.</p>
<p id="p-0068" num="0067">Multiple phase error measurements may be taken by module <b>410</b> for each of a plurality of iterations of the calibration procedure, and processed in module <b>412</b> to determine appropriate initial update or steady state values for storage in registers <b>400</b>. Such values may be stored in the registers under program control.</p>
<p id="p-0069" num="0068">The processor interface <b>414</b>A may be one of a plurality of processor interfaces utilized in read channel circuitry <b>310</b>. As noted above, portions of the calibration circuitry may be implemented using software executed by a processor, and these portions may include at least phase ramp error measurement module <b>410</b> and initial update and phase ramp error history module <b>412</b>. The state machine <b>405</b> may also be at least in part implemented in software, and accordingly additional processor interfaces may be implemented between state machine <b>405</b> and one or both of DLC circuitry <b>315</b> and clock generator <b>320</b>.</p>
<p id="p-0070" num="0069">As noted above, the initial phase update estimate can be determined adaptively based on one or more phase error measurements from each of a plurality of previous iterations of the calibration procedure, using a moving average or other function of the corresponding one or more initial phase update values, so as to drive the residual first update error towards zero.</p>
<p id="p-0071" num="0070">In some embodiments, the analog synthesizer settling time could span more than one servo wedge interval, in which case more than one unique phase update value could be utilized. Alternatively, the servo updates could simply be blocked until after the maximum settling time and then a single unique initial phase update value could be applied at the first servo update after the synthesizer is known to have settled.</p>
<p id="p-0072" num="0071"><figref idref="DRAWINGS">FIG. 5</figref> shows an exemplary process implemented using the <figref idref="DRAWINGS">FIG. 4</figref> circuitry. The process as shown includes steps <b>500</b> through <b>512</b>.</p>
<p id="p-0073" num="0072">In step <b>500</b>, a given iteration of a write calibration procedure is initiated, where the write calibration procedure involves varying clock signal phase as a test pattern is written to the storage disk <b>110</b>. As noted above, the variation may be in accordance with a phase ramp, or another function. Illustratively, the clock signal is an internal read channel clock signal that is used for both reading and writing in the storage device <b>100</b>.</p>
<p id="p-0074" num="0073">In step <b>502</b>, one or more of the programmable calibration registers <b>400</b> are accessed to determine an initial phase update value for a control loop that controls the frequency and phase of the clock signal.</p>
<p id="p-0075" num="0074">In step <b>504</b>, the selected initial phase update value is utilized in the control loop to obtain phase lock between the clock signal and a timing pattern of servo marks on the surface of the storage disk <b>110</b>.</p>
<p id="p-0076" num="0075">In step <b>506</b>, a phase error measurement is determined and stored in association with the initial phase update value.</p>
<p id="p-0077" num="0076">In step <b>508</b>, the current iteration of the write calibration procedure continues, utilizing, for example, the above-noted phase ramp to vary the clock phase as the test pattern is written to the storage disk <b>110</b>.</p>
<p id="p-0078" num="0077">In step <b>510</b>, a determination is made as to whether or not the current iteration of the write calibration procedure is complete. If the current iteration is not complete, the process returns to step <b>508</b> as indicated. Otherwise, the process moves to step <b>512</b>.</p>
<p id="p-0079" num="0078">In step <b>512</b>, the process waits a designated amount of time to initiate the next iteration of the write calibration procedure, and after the designated amount of time returns back to step <b>500</b> such that the next iteration is initiated.</p>
<p id="p-0080" num="0079">Similar process steps may be utilized in determining an appropriate steady state phase update value to be utilized in conjunction with the current iteration of the write calibration procedure.</p>
<p id="p-0081" num="0080">It is to be appreciated that the particular circuitry arrangements and processing operations shown in <figref idref="DRAWINGS">FIGS. 3</figref>, <b>4</b> and <b>5</b> are presented by way of example only, and other embodiments of the invention may utilize other types and arrangements of elements for implementing calibration functionality as disclosed herein.</p>
<p id="p-0082" num="0081">For example, with reference to the flow diagram of <figref idref="DRAWINGS">FIG. 5</figref>, process steps illustrated as being performed serially can instead be performed at least in part in parallel with one another. Also, the relative ordering of at least a subset of the process steps may be altered in other embodiments.</p>
<p id="p-0083" num="0082">As mentioned previously, the storage device configuration can be varied in other embodiments of the invention. For example, the storage device may comprise a hybrid HDD which includes a flash memory in addition to one or more storage disks.</p>
<p id="p-0084" num="0083">It should also be understood that the particular storage disk configuration and recording mechanism can be varied in other embodiments of the invention. For example, as noted above, recording techniques such as SMR and BPM can be used in one or more embodiments of the invention. In one possible BPM embodiment of the invention, the write clock phase may need to be calibrated as often as once every few seconds. Therefore, as in one or more other embodiments herein, this BPM embodiment may be configured to set a unique initial phase update value for the first servo wedge interval based on, for example, a single previous initial phase update value and its associated phase measurement error for a previous iteration of the calibration procedure, or a moving average of a designated number of previous initial phase update values and their associated phase measurement errors for respective previous iterations of the calibration procedure. As described previously, this can reduce control loop acquisition time and significantly improve overall performance of the storage device.</p>
<p id="p-0085" num="0084"><figref idref="DRAWINGS">FIG. 6</figref> illustrates a processing system <b>600</b> comprising the disk-based storage device <b>100</b> coupled to a host processing device <b>602</b>, which may be a computer, server, communication device, etc. Although shown as a separate element in this figure, the storage device <b>100</b> may be incorporated into the host processing device. Instructions such as read commands and write commands directed to the storage device <b>100</b> may originate from the processing device <b>602</b>, which may comprise processor and memory elements similar to those previously described in conjunction with <figref idref="DRAWINGS">FIG. 3</figref>.</p>
<p id="p-0086" num="0085">Multiple disk-based storage devices <b>100</b> may be incorporated into a virtual storage system <b>700</b> as illustrated in <figref idref="DRAWINGS">FIG. 7</figref>. The virtual storage system <b>700</b>, also referred to as a storage virtualization system, illustratively comprises a virtual storage controller <b>702</b> coupled to a RAID system <b>704</b>, where RAID denotes Redundant Array of Independent Disks. The RAID system more specifically comprises N distinct storage devices denoted <b>100</b>-<b>1</b>, <b>100</b>-<b>2</b>, . . . <b>100</b>-N, one or more of which are assumed to be configured to include calibration functionality as disclosed herein. These and other virtual storage systems comprising HDDs or other disk-based storage devices of the type disclosed herein are considered embodiments of the invention. The host processing device <b>602</b> in <figref idref="DRAWINGS">FIG. 6</figref> may also be an element of a virtual storage system, and may incorporate the virtual storage controller <b>702</b>.</p>
<p id="p-0087" num="0086">Again, it should be emphasized that the above-described embodiments of the invention are intended to be illustrative only. For example, other embodiments can use different types and arrangements of storage disks, read/write heads, control circuitry and other storage device elements for implementing the described calibration functionality. Also, the particular manner in which a write calibration procedure or other type of calibration procedure is implemented using calibration circuitry of a storage device may be varied in other embodiments. These and numerous other alternative embodiments within the scope of the following claims will be apparent to those skilled in the art.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An apparatus comprising:
<claim-text>control circuitry adapted for coupling to a read/write head configured to read data from and write data to a storage disk, the control circuitry being configured to process data received from and supplied to the read/write head;</claim-text>
<claim-text>the control circuitry comprising:</claim-text>
<claim-text>calibration circuitry configured to vary a phase of a clock signal as a test pattern is written to the storage disk as part of a calibration procedure; and</claim-text>
<claim-text>disk locked clock circuitry coupled to the calibration circuitry and configured to obtain a phase lock between the clock signal and a timing pattern on a surface of the storage disk;</claim-text>
<claim-text>wherein the calibration circuitry is further configured to determine an initial phase update value to be applied by the disk locked clock circuitry in a control loop as the phase of the clock signal is varied as part of the calibration procedure.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the initial phase update value is selected so as to reduce an acquisition time of the control loop relative to an acquisition time that would result if the initial phase update value were instead selected in accordance with a phase variation as specified in the calibration procedure.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the calibration circuitry comprises a plurality of programmable calibration registers configured for storing respective initial phase update values for use by the disk locked clock circuitry.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the calibration circuitry is further configured to determine a steady state phase update value to be applied by the disk locked clock circuitry in the control loop as the phase of the clock signal is varied as part of the calibration procedure, the steady state phase update value being different than the initial phase update value.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The apparatus of <claim-ref idref="CLM-00004">claim 4</claim-ref> wherein the calibration circuitry comprises a plurality of programmable calibration registers configured for storing respective steady state phase update values for use by the disk locked clock circuitry.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the phase of the clock signal varies in accordance with a phase ramp as the test pattern is written to the storage disk as part of the calibration procedure.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the initial phase update value is determined based at least in part on a plurality of phase error measurements generated for respective previous iterations of the calibration procedure.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The apparatus of <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein the initial phase update value is determined as a moving average of a designated number of phase error measurements generated for respective immediately preceding iterations of the calibration procedure.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the timing pattern comprises a plurality of servo marks preformed on the surface of the storage disk.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the control circuitry is fabricated in at least one integrated circuit.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the clock signal comprises an internal read channel clock signal utilized for both reading data from and writing data to the storage disk.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The apparatus of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein the control circuitry further comprises:
<claim-text>a disk controller; and</claim-text>
<claim-text>read channel circuitry comprising a read channel memory;</claim-text>
<claim-text>wherein the disk locked clock circuitry is implemented at least in part within the read channel circuitry and is operative to lock the read channel clock signal to the timing pattern on the surface of the storage disk.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The apparatus of <claim-ref idref="CLM-00012">claim 12</claim-ref> wherein the control circuitry comprises a system-on-chip integrated circuit that implements at least a portion of both the disk controller and the read channel circuitry.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> comprising a processor and a memory coupled to the processor, wherein at least a portion of at least one of the calibration circuitry, the disk locked clock circuitry and the control loop is implemented by the processor executing software code stored in the memory.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A storage device comprising the apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A virtual storage system comprising the storage device of <claim-ref idref="CLM-00015">claim 15</claim-ref>.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. A method comprising the steps of:
<claim-text>initiating a calibration procedure in which a phase of a clock signal is varied as a test pattern is written to a storage disk;</claim-text>
<claim-text>determining an initial phase update value for a control loop; and</claim-text>
<claim-text>utilizing the initial phase update value in the control loop to obtain a phase lock between the clock signal and a timing pattern on a surface of the storage disk.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method of <claim-ref idref="CLM-00017">claim 17</claim-ref> wherein determining the initial phase update value for the control loop comprises determining the initial phase update value based at least in part on a plurality of error measurements generated for respective previous iterations of the calibration procedure.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method of <claim-ref idref="CLM-00017">claim 17</claim-ref> wherein determining the initial phase update value for the control loop comprises determining the initial phase update value based as a moving average of a designated number of phase error measurements generated for respective immediately preceding iterations of the calibration procedure.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. A non-transitory computer-readable storage medium having embodied therein executable code for performing the steps of the method of <claim-ref idref="CLM-00017">claim 17</claim-ref>.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. A processing system comprising:
<claim-text>a processing device; and</claim-text>
<claim-text>a storage device coupled to the processing device and comprising at least one storage disk;</claim-text>
<claim-text>wherein the storage device further comprises:</claim-text>
<claim-text>a read/write head configured to read data from and write data to the storage disk; and</claim-text>
<claim-text>control circuitry coupled to the read/write head and configured to process data received from and supplied to the read/write head;</claim-text>
<claim-text>the control circuitry comprising:</claim-text>
<claim-text>calibration circuitry configured to vary a phase of a clock signal as a test pattern is written to the storage disk as part of a calibration procedure; and</claim-text>
<claim-text>disk locked clock circuitry coupled to the calibration circuitry and configured to obtain a phase lock between the clock signal and a timing pattern on a surface of the storage disk;</claim-text>
<claim-text>wherein the calibration circuitry is further configured to determine an initial phase update value to be applied by the disk locked clock circuitry in a control loop as the phase of the clock signal is varied as part of the calibration procedure. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
