<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08624183-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08624183</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13455988</doc-number>
<date>20120425</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="regional">
<country>EP</country>
<doc-number>11163633</doc-number>
<date>20110426</date>
</priority-claim>
</priority-claims>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>01</class>
<subclass>N</subclass>
<main-group>23</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>21</class>
<subclass>K</subclass>
<main-group>7</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>250307</main-classification>
<further-classification>250311</further-classification>
</classification-national>
<invention-title id="d2e61">Determining a reconstructed image with viterbi detection using a particle-optical apparatus</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5432347</doc-number>
<kind>A</kind>
<name>Coene</name>
<date>19950700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5654547</doc-number>
<kind>A</kind>
<name>Coene et al.</name>
<date>19970800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>850 21</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5753913</doc-number>
<kind>A</kind>
<name>Coene et al.</name>
<date>19980500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6115436</doc-number>
<kind>A</kind>
<name>Ramesh et al.</name>
<date>20000900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375341</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6800864</doc-number>
<kind>B2</kind>
<name>Scaman</name>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>25049222</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6882959</doc-number>
<kind>B2</kind>
<name>Rui et al.</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>702179</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6888136</doc-number>
<kind>B2</kind>
<name>Geurts et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2003/0006373</doc-number>
<kind>A1</kind>
<name>Koguchi et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>250311</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2006/0029286</doc-number>
<kind>A1</kind>
<name>Lim et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382260</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2008/0251719</doc-number>
<kind>A1</kind>
<name>Nakahira et al.</name>
<date>20081000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>250311</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2009/0316558</doc-number>
<kind>A1</kind>
<name>Hashimoto et al.</name>
<date>20091200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>369103</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2010/0008201</doc-number>
<kind>A1</kind>
<name>Hashimoto et al.</name>
<date>20100100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>369 5922</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2011/0248163</doc-number>
<kind>A1</kind>
<name>Morris et al.</name>
<date>20111000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>250307</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>EP</country>
<doc-number>0760109</doc-number>
<date>19970500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>EP</country>
<doc-number>2416165</doc-number>
<date>20120200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00016">
<othercit>Miller et al. (&#x201c;Image Restoration with the Viterbi Algorithm&#x201d; vol. 17, No. 2, Feb. 2000, J. Opt. Soc. Am. A. 265-275).</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00017">
<othercit>Miller, C. et al., &#x201c;Image Reconstruction Using the Viterbi Algorithm,&#x201d; Image Analysis and Interpretation, Apr. 5, 1998, p. 160-163.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00018">
<othercit>Chung, Pei-Jung et al., &#x201c;A GLRT and Bootstrap Approach to Detection in Magnetic Resonance Force Microscopy,&#x201d; IEEE International onference on Montreal, Quebec, Canada, May 17-21, 2004, p. 1061-1064.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>250306</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>250307</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>250310</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>250311</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382226</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382228</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382238</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382240</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>22</number-of-drawing-sheets>
<number-of-figures>23</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61479149</doc-number>
<date>20110426</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120273676</doc-number>
<kind>A1</kind>
<date>20121101</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Kuijper</last-name>
<first-name>Maarten</first-name>
<address>
<city>Eindhoven</city>
<country>NL</country>
</address>
</addressbook>
<residence>
<country>NL</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Kuijper</last-name>
<first-name>Maarten</first-name>
<address>
<city>Eindhoven</city>
<country>NL</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Scheinberg &#x26; Associates, PC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Scheinberg</last-name>
<first-name>Michael O.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>FEI Company</orgname>
<role>02</role>
<address>
<city>Hillsboro</city>
<state>OR</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Vanore</last-name>
<first-name>David A</first-name>
<department>2881</department>
</primary-examiner>
<assistant-examiner>
<last-name>Purinton</last-name>
<first-name>Brooke</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The invention relates to a method for determining a reconstructed image using a particle-optical apparatus. The particle-optical apparatus comprises a particle source for producing a beam of particles, an object plane on which an object to be imaged may be placed, a condenser system for illuminating the object plane with the beam of particles, a projection system for forming an image of the object plane by imaging particles transmitted through the object on an image plane, and a detector for detecting the image, the detector comprising a semiconductor sensor having an array of pixels for providing a plurality of pixel signals from respective pixels of the array in response to particles incident on the detector.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="197.44mm" wi="183.22mm" file="US08624183-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="217.09mm" wi="183.13mm" file="US08624183-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="150.28mm" wi="200.32mm" file="US08624183-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="194.39mm" wi="182.88mm" file="US08624183-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="161.46mm" wi="191.77mm" file="US08624183-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="156.46mm" wi="189.48mm" file="US08624183-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="221.06mm" wi="176.95mm" file="US08624183-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="204.98mm" wi="208.53mm" file="US08624183-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="202.27mm" wi="187.79mm" file="US08624183-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="222.76mm" wi="84.33mm" file="US08624183-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="219.46mm" wi="185.84mm" file="US08624183-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="228.35mm" wi="190.42mm" file="US08624183-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="217.17mm" wi="196.34mm" file="US08624183-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="208.87mm" wi="193.38mm" file="US08624183-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="237.57mm" wi="186.77mm" file="US08624183-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="219.79mm" wi="204.30mm" file="US08624183-20140107-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="225.72mm" wi="183.81mm" file="US08624183-20140107-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="240.20mm" wi="136.06mm" file="US08624183-20140107-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="239.78mm" wi="173.14mm" file="US08624183-20140107-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00019" num="00019">
<img id="EMI-D00019" he="180.59mm" wi="191.77mm" file="US08624183-20140107-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00020" num="00020">
<img id="EMI-D00020" he="212.17mm" wi="92.63mm" file="US08624183-20140107-D00020.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00021" num="00021">
<img id="EMI-D00021" he="228.35mm" wi="151.21mm" file="US08624183-20140107-D00021.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00022" num="00022">
<img id="EMI-D00022" he="105.07mm" wi="118.96mm" file="US08624183-20140107-D00022.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<p id="p-0002" num="0001">This application claims priority from U.S. Provisional Patent Application 61/479,149, filed Apr. 26, 2011, which is hereby incorporated by reference.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">TECHNICAL FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The invention relates to a method for determining a reconstructed image using a particle-optical apparatus.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">In a TEM an object, also referred to as a sample, is irradiated with a beam of electrons, the electrons having an energy of e.g. between 50 keV and 400 keV. Some of the electrons are transmitted through the sample, and these electrons are focused on the image plane to form an enlarged image of the sample. The imaging of the sample on the image plane is realized with a projection system, that can be set to a configurable magnification of e.g. between 10<sup>3 </sup>and 10<sup>6 </sup>times. Typically a detector, such as a CCD camera or CMOS camera, is placed in the image plane, whereby the image is detected. Such detector may e.g. have a semiconductor sensor having 4 k&#xd7;4 k pixels arranged in a two-dimensional array. With such detector, the electrons impinge on the semiconductor chip of the CCD or CMOS sensor and generate electron hole pairs, thereby forming the charge to be detected by the CCD or CMOS chip.</p>
<p id="p-0005" num="0004">For some applications, a very low dose of electrons is required. For example, biological materials may already degrade at doses of 10-30 electrons per 0.1 nm&#xd7;0.1 nm within a frame time of 8-10 seconds. This may result in an average dose of 0.001-0.1 electrons per pixel or even less at the detector. Although CCD and CMOS cameras are constantly improving, Signal to Noise Ratio (SNR) and Modulation Transfer Function (MTF) may still be limiting the performance of the detector. For an exemplary direct electron detection CMOS camera in a TEM, one incident electron may generate thousands of electron hole pairs which diffuse over an area of e.g. 5&#xd7;5 pixels and finally generate about a total of 240 output signal counts in the 5&#xd7;5 pixels. As a result, the Point Spread Function (PSF) may be significant larger than the spatial sampling dimensions (one pixel). In the following, any reference to the length of the PSF may refer to the width of the PSF in terms of number of pixels: the length is five when the electron hole pairs diffuse over an area of 5&#xd7;5 pixels. At halve-Nyquist frequency of the sensor, an MTF less than 0.5 is achieved. The MTF at Nyquist is approaching to zero. This results in a loss of MTF and thus resolution. Secondly, the peak count at the center pixel may be roughly 30 counts, while the dark current noise of the semiconductor sensor may typically vary between 0 and 30 counts. This results in an SNR around 1. At these low doses, both SNR and MTF determine the image quality. Due to the relatively high noise level, known image improvement technologies like image deconvolution are not very successful to recover from this noise and point spread function. Besides the dark current noise, also the number of electron hole pairs that are being generated in the semiconductor sensor for a single incident electron, and thus of the deposited energy per electron, may vary wildly and affect the SNR. One incident electron of 300 keV may e.g. result in any number of electron hole pairs between 0 and 80.000 and a corresponding spread in detected charge. In the following, the charge detected by a pixel of the semiconductor chip will be represented by a corresponding pixel signal with a signal strength representing a certain number of signal counts.</p>
<p id="p-0006" num="0005">It is known to determine whether an electron is present on a pixel by comparing the pixel signal to a predetermined reference level in so-called threshold detection. However, such threshold detection may result in many misdetections when the dose is low and when the SNR around 1.</p>
<p id="p-0007" num="0006">To overcome the effects of the Point Spread Function, it has been proposed to use Partial Response (PR) detection, using a Partial Response function resembling the Point Spread Function. For binary images, a Partial Response Maximum Likelihood (PRML) detection and Viterbi Detection have been proposed with success. However, the inventor has found that such known methods do not give a satisfactory results when applied to an image obtained in a TEM, especially not in the presence of SNR is around 1 and/or when the spread in signal counts for a single incident electron is large.</p>
<p id="p-0008" num="0007">A disadvantage of the aforementioned methods is that the achievable resolution may be compromised. Especially when the dose is low, it may not be possible to determine the number of incident electrons on each pixel with a sufficient reliability.</p>
<p id="p-0009" num="0008">Accordingly, there is a need to provide a method wherein the quality of an image acquired by a detector in a particle-optical apparatus, such as a TEM, is improved, especially at low dose and where the signal of a single incident particle, such as an electron, is spread over a plurality of pixels, e.g. due to diffusion in the semiconductor sensor.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0010" num="0009">An object of the invention is to improve the quality of an image acquired by a detector in a particle-optical apparatus, such as a TEM.</p>
<p id="p-0011" num="0010">The invention relates to a method for determining a reconstructed image using a particle-optical apparatus. The particle-optical apparatus comprises a particle source for producing a beam of particles, an object plane on which an object to be imaged may be placed, a condenser system for illuminating the object plane with the beam of particles, a projection system for forming an image of the object plane by imaging particles transmitted through the object on an image plane, and a detector for detecting the image, wherein the detector comprising a semiconductor sensor having an array of pixels for providing a plurality of pixel signals from respective pixels of the array in response to particles incident on the detector.</p>
<p id="p-0012" num="0011">The invention further relates to a particle-optical apparatus arranged to execute such method for determining a reconstructed image.</p>
<p id="p-0013" num="0012">The invention further relates to a computer program product comprising instructions for causing a processor system to perform such method.</p>
<p id="p-0014" num="0013">The foregoing has outlined rather broadly the features and technical advantages of the present invention in order that the detailed description of the invention that follows may be better understood. Additional features and advantages of the invention will be described hereinafter. It should be appreciated by those skilled in the art that the conception and specific embodiments disclosed may be readily utilized as a basis for modifying or designing other structures for carrying out the same purposes of the present invention. It should also be realized by those skilled in the art that such equivalent constructions do not depart from the spirit and scope of the invention as set forth in the appended claims.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0015" num="0014">For a more complete understanding of the present invention, and the advantages thereof, reference is now made to the following descriptions taken in conjunction with the accompanying drawings, in which:</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 1</figref> schematically shows an apparatus according to the invention.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2</figref> shows an example of states and transitions of an exemplary Viterbi Detector.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 3-FIG</figref>. <b>5</b> illustrate the operation of a Viterbi Detector.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 6</figref> shows an example of states and transitions for use with a Viterbi Detector in an embodiment of the invention.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 7</figref> illustrates the operation of the Viterbi Detector of <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 8-FIG</figref>. <b>9</b> illustrate examples of states for use with other embodiments.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 10</figref> schematically shows a two-dimensional semiconductor sensor.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 11-FIG</figref>. <b>12</b> schematically illustrate the operation of a two-dimensional according to an embodiment.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 13</figref> schematically illustrates another embodiment.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 14-FIG</figref>. <b>15</b> illustrate examples of states for use with other embodiments.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 16-FIG</figref>. <b>17</b> schematically illustrate another embodiment.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 18A</figref> and <figref idref="DRAWINGS">FIG. 18B</figref> schematically illustrate signal levels of a pixel signal.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 19</figref> shows a result of a simulation of a method according to the invention.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 20</figref> schematically shows an overview of a method according to an embodiment.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 21</figref> schematically illustrates a further embodiment.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 22</figref> shows a computer readable medium comprising a computer program product.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0032" num="0031">The accompanying drawings are not intended to be drawn to scale. In the drawings, each identical or nearly identical component that is illustrated in various figures is represented by a like numeral. For purposes of clarity, not every component may be labeled in every drawing.</p>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF PREFERRED EMBODIMENTS</heading>
<p id="p-0033" num="0032">Embodiments of the invention provides a method wherein the quality of an image acquired by a detector in a particle-optical apparatus, such as a TEM, is improved, especially at low dose and where the signal of a single incident particle, such as an electron, is spread over a plurality of pixels, e.g. due to diffusion in the semiconductor sensor.</p>
<p id="p-0034" num="0033">A method according to one embodiment of the invention comprises: receiving the plurality of pixel signals, and determining a reconstructed image from using Viterbi Detection on the plurality of pixel signals, the Viterbi Detection using a plurality of different states corresponding to a plurality of configurations of particles incident on the detector, and at least two states of the plurality of different states corresponding to a same, non-zero multiplicity of incident particles on a single pixel of the plurality of pixel signals.</p>
<p id="p-0035" num="0034">The non-zero multiplicity of incident particles on the single pixel may in particular be one, whereby the at least two states of the plurality of different states correspond to a single electron being incident on the single pixel. In this embodiment, the Viterbi Detection may use a first state of the plurality of different states wherein a single electron is incident on a pixel and generates a first pixel signal, i.e. a first number of pixel counts, and a second state of the plurality of different states wherein again a single electron is incident on the pixel, but wherein the single electron generates a different, second pixel signal, i.e. a second number of pixel counts different from the first number. The first and second state may thus both relate to configurations wherein a single electron is incident on the pixel, but with different signal count. The Viterbi Detection may thus successfully account for the large spread in generated number of electron hole pairs from a single incident electron and the corresponding spread in detected charge, in contrast to known Viterbi Detection schemes wherein no such plurality comprising at least such first state and such second state is used.</p>
<p id="p-0036" num="0035">In an embodiment of the method according to the invention, the different states are modelled using a different multiplicity of particles.</p>
<p id="p-0037" num="0036">In this embodiment, the states may e.g. be modeled as if all electrons generate substantially the same number of electron hole pairs and therefore substantially the same pixel signal, i.e. a predetermined signal count. The first state may then be modeled as one electron with the corresponding predetermined pixel count, whereas the second state may be modeled as two electrons, each generating the corresponding predetermined pixel count, i.e., with twice the pixel count of a single electron. When the Viterbi Detection decides that the second state is the most likely state, the Viterbi Detection will however output that a single electron was present. Especially when the dose is relatively low and when the predetermined signal count is suitably selected, this may improve the reconstructed image, as the likelihood of having two electrons on a single pixel may then be significantly smaller than the likelihood that a single electron has resulted in a larger signal count.</p>
<p id="p-0038" num="0037">In an embodiment of the method according to the invention, the different states are modelled using different deposited energies of the particle(s).</p>
<p id="p-0039" num="0038">In this embodiment, the states of the Viterbi Detection explicitly take into account that a single electron may result in different pixel counts. The first state may e.g. relate to a single electron of a first predetermined signal count and the second state may e.g. relate to a single electron of a second, different predetermined signal count, the second predetermined signal count being e.g. twice the first predetermined signal count. The Viterbi Detection will thus not only result in the determination whether an electron was incident on a pixel, but, when it was present, also provide the likely signal count of the electron.</p>
<p id="p-0040" num="0039">In an embodiment of the method according to the invention, the different states are modelled using different point spread functions in modelling deposited energies of the particle(s).</p>
<p id="p-0041" num="0040">In this embodiment, the first state may e.g. relate to a single electron generating pixel counts in a plurality of neighboring pixels according to a first point spread function, and the second state may e.g. relate to a single electron generating pixel counts in a plurality of neighboring pixels according to a second point spread function, the second point spread function being different from the first point spread function. The Viterbi Detection may thus account for possible different signal count distributions in response to a single electron being incident on a pixel. The different point spread functions may e.g. corresponds to a different relative amplitude and/or a different shape and/or a different length.</p>
<p id="p-0042" num="0041">In an embodiment of the method according to the invention, the different states are used in different iterations of the Viterbi Detection.</p>
<p id="p-0043" num="0042">In this embodiment, the Viterbi Detection uses in e.g. a first iteration a first state corresponding to an incident electron resulting in a first, large pixel count, and a second iteration wherein a second state is used corresponding to an incident electron resulting in a second, smaller pixel count. After the first iteration, contributions from all detected electrons may be modeled and removed from the pixel signals. Hereby, the first iteration detects electrons with a high pixel count and the second iteration detects electrons with a low pixel count.</p>
<p id="p-0044" num="0043">Preferably, the states used in successive iterations correspond to decreasing signal level of a single electron.</p>
<p id="p-0045" num="0044">In an embodiment of the method according to the invention, wherein the array of pixels is a one-dimensional array.</p>
<p id="p-0046" num="0045">The semiconductor sensor thus forms a line sensor, which may e.g. be scanned along the image plane. Using such line sensor may be advantageous because of reduced computational complexity and memory requirements, as the Viterbi Detection only has to accommodate for contributions from neighboring pixels in one dimension. The Viterbi Detection may thus use a smaller number of states compared to the situation wherein a two-dimensional array is used, and states have to be considered wherein an electron is incident in a two-dimensional environment of the pixel.</p>
<p id="p-0047" num="0046">In an embodiment of the method according to the invention, the array of pixels is a two-dimensional array and the Viterbi Detection is applied to sequences of pixel signals per row of pixels of the two-dimensional array.</p>
<p id="p-0048" num="0047">In this embodiment, the Viterbi Detection substantially operates row-by-row. Hereby, the number of states&#x2014;and hence computational complexity and memory requirements&#x2014;that are being considered in the Viterbi Detection is reduced compared to a full two-dimensional Viterbi Detection, whereas the benefits of using Viterbi Detection largely remain. The Viterbi Detection preferably uses a two-dimensional PSF and considers the contributions of pixels in a two-dimensional area around the pixels on the row for each state, in order to optimally model the pixel signal.</p>
<p id="p-0049" num="0048">In an embodiment of the method according to the invention, the array of pixels is a two-dimensional array and the Viterbi Detection is applied to sequences of pixel signals per column of pixels of the two-dimensional array.</p>
<p id="p-0050" num="0049">In this embodiment, the Viterbi Detection substantially operates column-by-column, with similar advantages and effects as when operating row-by-row.</p>
<p id="p-0051" num="0050">In a further embodiment, the Viterbi Detection uses a first iteration with a row-by-row operation and a second iteration with a column-by-column operation, after which the results of the first and second iteration are combined to obtain the output of the Viterbi Detection. The combining may e.g. comprises an averaging, or a selection based on determined path metrics obtained from first and second iterations.</p>
<p id="p-0052" num="0051">In further embodiments, the states of the Viterbi Detection correspond to predetermined two-dimensional configurations of particles incident on the detector.</p>
<p id="p-0053" num="0052">The Viterbi Detection may thus e.g. determine contributions from particles incident on the respective pixel on the row or column, as well as from particles incident on pixels of neighboring rows or columns, which may also contribute to the pixel signal. This embodiment may be referred to as strip-wise Viterbi Detection.</p>
<p id="p-0054" num="0053">In an embodiment of the method according to the invention, the method further comprises, after having detected one or more incident particles on a pixel, removing a contribution from the detected one or more incident particles from the plurality of pixel signals.</p>
<p id="p-0055" num="0054">In this embodiment, the plurality of pixel signals that is being considered is substantially free from the contributions from electrons that have already been detected. Computational complexity and/or robustness may thus be improved.</p>
<p id="p-0056" num="0055">In an embodiment of the method according to the invention, the Viterbi Detection uses a PR (13531) or PR (13531)<sup>2 </sup>response.</p>
<p id="p-0057" num="0056">Such PR responses have been found to result in a good balance between computational complexity and memory requirements and performance of the Viterbi Detection. The plurality of pixels of semiconductor sensor may be dimensioned and arranged such that the diffusion pattern substantially corresponds to a point spread function corresponding to such PR responses.</p>
<p id="p-0058" num="0057">An alternative PR response may be used, and e.g. selected in accordance with an energy deposition pattern of a particle incident on the semiconductor sensor.</p>
<p id="p-0059" num="0058">In embodiments of the method according to the invention, the Viterbi Detection uses a path memory length in a range of 2-5, preferably 2-4, even more preferably 3-4, times the length of a Point Spread Function used in the Viterbi Detection, the Point Spread Function corresponding to a PR-response used in the Viterbi Detection.</p>
<p id="p-0060" num="0059">The inventors have found that, with the length of the path memory is chosen in the indicated ranges, a good balance between computational complexity and memory requirements and performance of the Viterbi Detection is obtained.</p>
<p id="p-0061" num="0060">In an embodiment of the method according to the invention, the image detected by the detector comprises a dose in a range of 0.0001-0.5, preferably 0.001-0.3, even more preferably 0.01-0.1 particle per pixel.</p>
<p id="p-0062" num="0061">The inventors have found that the Viterbi Detection according to the invention when the dose is in the ranges indicated. These ranges are particularly suitable for allowing a reasonably low number of states, and thus reasonable computational complexity, while maintaining a good performance.</p>
<p id="p-0063" num="0062">In an embodiment of the method according to the invention, the method comprises:</p>
<p id="p-0064" num="0063">receiving a first plurality of pixel signals from respective pixels of the array in response to particles incident on the detector upon detecting a first image of the object,</p>
<p id="p-0065" num="0064">determining a first reconstructed image from using the Viterbi Detection on the first plurality of pixel signals,</p>
<p id="p-0066" num="0065">receiving a second plurality of pixel signals from the respective pixels of the array in response to particles incident on the detector upon detecting a second image of the object,</p>
<p id="p-0067" num="0066">determining a second reconstructed image from using the Viterbi Detection on the second plurality of pixel signals, and combining the first reconstructed image and the second reconstructed image to form the reconstructed image.</p>
<p id="p-0068" num="0067">The method may further comprise receiving at least one further plurality of pixel signals from the respective pixels of the array in response to particles incident on the detector upon detecting at least one respective further image of the object, determining at least one further reconstructed image from using the Viterbi Detection on the respective further plurality of pixel signals, and combining the first reconstructed image, the second reconstructed image and the at least one further reconstructed images to form the reconstructed image. Thus, the method acquires and processes two or more reconstructed images of the same object, and combines the corresponding reconstructed images to form the reconstructed image. The two or more reconstructed images may e.g. have been acquired at a low dose, e.g. selected to prevent damage to the object, while the reconstructed image as obtained from combining the two or more reconstructed images may effectively correspond to a higher dose. Hereby, the quality of the reconstructed image may be improved. Combining the first and second (and, if applicable, the further) reconstructed images may e.g. comprise an addition or an averaging of the first and second (and, if applicable, the further) reconstructed images, but may, in further embodiments, comprise correcting for a shift and/or distortion between the first and second (and, if applicable, the further) reconstructed images. The shift and/or distortion may e.g. be determined from the first and second (and, if applicable, the further) reconstructed images that are being combined. The shift and/or distortion may alternatively be predetermined or be provided by other parts of the particle-optical apparatus, e.g. from the projection system.</p>
<p id="p-0069" num="0068">In some embodiments of the method according to the invention, the method comprises: producing a beam of particles, placing an object to be imaged on an object plane, illuminating the object plane with the beam of particles, forming an image of the object plane by imaging particles transmitted through the object on an image plane, and detecting the image with the detector comprising the semiconductor sensor and providing a plurality of pixel signals from the respective pixels of the array in response to the particles incident on the detector.</p>
<p id="p-0070" num="0069">A further aspect of the invention provides a particle-optical apparatus comprising: a particle source for producing a beam of particles, an object plane on which an object to be imaged may be placed, a condenser system for illuminating the object plane with the beam of particles, a projection system for forming an image of the object plane by imaging particles transmitted through the object on an image plane, a detector for detecting the image, the detector comprising a semiconductor sensor having an array of pixels for providing a plurality of pixel signals from respective pixels of the array in response to particles incident on the detector, and a signal processor arranged to: receive the plurality of pixel signals, and determine a reconstructed image from using Viterbi Detection on the plurality of pixel signals, the Viterbi Detection using a plurality of different states corresponding to a plurality of configurations of particles incident on the detector, and at least two states of the plurality of different states corresponding to a same, non-zero multiplicity of incident particles on a single pixel of the plurality of pixel signals.</p>
<p id="p-0071" num="0070">The signal processor may be part of the detector, or be arranged as a separate unit in communication with the detector.</p>
<p id="p-0072" num="0071">In a further aspect of the invention, a computer program product is provided comprising instructions for causing a processor system to perform the method set forth.</p>
<p id="p-0073" num="0072">It will be appreciated by those skilled in the art that two or more of the above-mentioned embodiments, implementations, and/or aspects of the invention may be combined in any way deemed useful.</p>
<p id="p-0074" num="0073">Modifications and variations of the particle-optical apparatus and/or the computer program product, which correspond to the described modifications and variations of the method, can be carried out by a person skilled in the art on the basis of the present description.</p>
<p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. 1</figref> schematically shows an apparatus according to the invention. It shows a TEM, comprising a vacuum housing <b>120</b> evacuated via tube <b>121</b> by a vacuum pump <b>122</b>. A particle source in the form of an electron source <b>101</b> produces a beam of electrons along a particle-optical axis <b>100</b>. The particle source may be any type of electron source, such as e.g. a field emitter gun, a Schottky emitter, or a thermionic electron emitter. The electron source can be e.g. a field emitter gun, a Schottky emitter, or a thermionic electron emitter. The electrons are then accelerated to an adjustable energy of typically between 80-300 keV, although TEM's using electrons with an adjustable energy of e.g. 50-500 keV are known. Deflectors 102 centre the beam of particles on beam limiting aperture <b>103</b>. The beam then passes through a condenser system comprising two lenses <b>104</b>.</p>
<p id="p-0076" num="0075">A sample <b>111</b> is held by a manipulator <b>112</b>, positioning the sample in the object plane of the objective lens <b>105</b>. The sample is imaged by a projection system comprising lenses <b>106</b> onto fluorescent screen <b>107</b>, and can be viewed through a window <b>108</b>. The fluorescent screen <b>107</b> is connected to a hinge <b>109</b> and can be retracted/folded away, so that the image made by the projection system is imaged on detector <b>150</b>. It is noted that the projection system may need to be re-focused so as to form the image on the detector <b>150</b> instead of on the fluorescent screen. The image formed on the screen or on the detector typically has a magnification of between 10<sup>3 </sup>to 10<sup>6 </sup>times and may show details as small as 0.1 nm or smaller. It is further noted that the projection system may form intermediate images. The detector <b>150</b> comprises a semiconductor sensor <b>151</b>, such as a charge coupled device (CCD) or a CMOS device, for detecting impinging electrons. The semiconductor sensor <b>151</b> has a plurality of pixels (not shown in <figref idref="DRAWINGS">FIG. 1</figref>) arranged in a two-dimensional array. One incident electron may generate thousands of electron hole pairs which diffuse over an area of e.g. 5&#xd7;5 pixels of the array, where the charge is collected to generate pixel signals. The pixel signals may be referred to as &#x2018;raw pixel data&#x2019; or &#x2018;data samples&#x2019;. The plurality of pixel signals may be referred to as &#x2018;raw image&#x2019;. The detector <b>150</b> further comprises a signal processor <b>152</b>, for processing the pixel signals and determining an improved image, representing a reconstruction of the configuration of electrons incident on the detector <b>150</b>. The improved image may further be referred to as &#x2018;output image&#x2019;.</p>
<p id="p-0077" num="0076">It is noted that in alternative embodiments, the plurality of pixels may also be arranged in other configurations, such as in a one-dimensional array, forming a line sensor. The line sensor may be movable relative to the projected image to obtain a sequence of one-dimensional images which together form a two-dimensional image.</p>
<p id="p-0078" num="0077">It is noted that <figref idref="DRAWINGS">FIG. 1</figref> shows a schematic description of a typical TEM only, and that in reality a TEM comprises many more deflectors, apertures etc. Also TEM's with correctors for correcting the aberration of the objective lens <b>105</b> are known, said correctors employing multipoles and round lenses. Also other detectors may be used, such as secondary electron detectors, X-ray detectors, etc. These detectors may be positioned at the side of the sample facing the gun or the side of the sample facing detector <b>150</b>.</p>
<p id="p-0079" num="0078"><figref idref="DRAWINGS">FIG. 1</figref> further shows an interface device <b>160</b> which connects the TEM to a user interface system, herein shown as a computer, having input means <b>170</b>, such as a keyboard and a mouse, and visualization means <b>175</b>, such as a display screen. The user interface system may also have a storage device, such as a hard disk drive and an optical disk drive, as well as interfacing devices for connecting with removable solid state storage, such as a USB-stick, and/or for connecting to a network, such as the internet or a local network. The interface device <b>160</b> is further connected to the detector <b>150</b> for obtaining the output image from the detector <b>150</b> and to provide the output image the user interface system. Further, the interface device <b>160</b> is connected to the signal processor <b>152</b> allowing a user to adapt setting of the signal processor <b>152</b>. Further, the interface device <b>160</b> is connected to the TEM for operating the TEM from the user interface device, e.g. allowing the user to input commands using the input means to operate parts of the TEM, such as e.g. to operate the vacuum pump <b>122</b>, the electron source <b>101</b>, the manipulator <b>112</b> and the hinged screen <b>107</b>.</p>
<p id="p-0080" num="0079">The signal processor <b>152</b> is arranged to process the raw pixel signals and to determine an output image, representing a reconstruction of the configuration of electrons incident on the detector <b>150</b>. It is known to process the raw pixel signals using a threshold detector, which compares each raw pixel signal to a predetermined threshold value, and determines that an incident electron was present when the raw pixel signal is larger than the predetermined threshold value, whereas it is determined that no incident electron was present when the raw pixel signal is smaller than the predetermined threshold value. Such threshold detection however only shows a sufficient performance when the signal to noise ratio is sufficiently large to discriminate between noise (resulting in a raw pixel signal below the predetermined threshold) and the presence of an electron (resulting in a raw pixel signal above the predetermined threshold). However, when the dose is low, such threshold detection will not result in a satisfactory performance. Moreover, one incident electron will generate signals in a plurality of adjacent pixels in a semiconductor sensor, which may be characterized by a point spread function and which may be referred to as inter-symbol-interference (ISI). It is known to use deconvolution techniques to accommodate for such ISI, but known deconvolution techniques do not result in a satisfactory performance when the signal to noise ratio is very poor.</p>
<p id="p-0081" num="0080">For one-dimensional signals corresponding to binary data as well as for two-dimensional signals corresponding to binary data, it is known to use a signal processing techniques known as Viterbi Detection. A Viterbi Detector performs maximum-likelihood detection in an efficient manner using a technique known as dynamic programming Hereto, the Viterbi Detector operates on a sequence of data samples. In data storage, this sequence corresponds to a sequence of data samples in the time domain, but in embodiments of the image reconstruction, the sequence corresponds to a sequence of adjacent pixels. Central to Viterbi Detection is the notion of states: a state corresponds to a possible configuration of the original data. An example will be given below. When considering the next data sample of the sequence, transitions are considered between the possible state(s) of the current data sample and the possible state(s) of the next data sample. A weight may be accorded to each transition to indicate the likelihood of such transition. The weight may be determined from evaluating the difference between the actual state of a pixel and a model of the state of the pixel. The model of the state of the pixel may e.g. be represented by a calculation of the pixel signal that would be obtained for the state using a model that models the contribution of the configuration of the original data corresponding to the state while ignoring noise, hereby obtaining a modelled pixel signal. The weight may then be determined as e.g. the absolute value of difference of the actual pixel signal and the modelled pixel signal. Such weight may be calculated between the actual pixel signal and a plurality of modelled signals, one for each state. For the state representing the actual configuration, the weight will substantially only be noise. For other states, the value will deviate more. In order to improve the performance, a Viterbi Detector does not decide on the basis comparing a single pixel with all possible states, but uses sequences of states instead. The number of successive states of a sequence is referred to as the path memory length. The path memory length is preferably between 2 and 5 times the length of the PSF, preferably between 3 and 4 times. A sequence of states comprises transitions between successive states, each with their respective weight. In such sequence, a weight relating one transition (from one data sample to the next) is referred to as &#x2018;branch metric&#x2019;. The sum of all weights of a sequence of states is referred to as &#x2018;path metric&#x2019;. The sequences of states and the transitions between successive states are referred to as a trellis diagram. Viterbi Detection relates to finding the path with the lowest path metric through the trellis diagram. A complete maximum likelihood detector would evaluate and keep track of all possible paths through the trellis diagram. The complexity of a Viterbi Detector is reduced by only keeping track of those paths that may result in the path with the lowest metric. Hereto, the Viterbi Detector determines for each state along the trellis which path(s) have the smallest path metric leading to that state along the trellis, and maintains those as &#x2018;survivor path(s)&#x2019;, while the other path(s) are discarded from further use.</p>
<p id="p-0082" num="0081">Viterbi Detection has been developed for data storage and mobile communication. Hereby, Viterbi Detection can accommodate for inter-symbol-interference and noise, provided the characteristics of the system can be well modelled. Now, an example of Viterbi Detection of a known type is described. The example relates to an exemplary system with a binary input signal, i.e., with data values &#x2018;0&#x2019; or &#x2018;1&#x2019;, and a point spread function PSF=(121) defining that each data value &#x2018;1&#x2019; results in relative signal contributions 1:2:1 in adjacent data samples, whereas data value &#x2018;0&#x2019; does not result a signal contribution. The system has white noise. Further, the system is characterized by a run-length constraint that there should be at least two &#x2018;0&#x2019;s between two &#x2018;1&#x2019;s.</p>
<p id="p-0083" num="0082"><figref idref="DRAWINGS">FIG. 2</figref> shows an example of states and transitions of such exemplary Viterbi Detector.</p>
<p id="p-0084" num="0083">As shown in <figref idref="DRAWINGS">FIG. 2</figref>, the Viterbi Detector has a plurality <b>200</b> of states, consisting of one states, labelled s<b>0</b>, with three successive data values of &#x2018;0&#x2019;, and three different states, labelled s<b>1</b>, s<b>2</b> and s<b>3</b>, with one data value &#x2018;1&#x2019; and two data values &#x2018;0&#x2019;. The states s<b>0</b>, s<b>1</b>, s<b>2</b> and s<b>3</b> may also be referred to as &#x2018;000&#x2019;, &#x2018;001&#x2019;, &#x2018;010&#x2019; and &#x2018;100&#x2019;. <figref idref="DRAWINGS">FIG. 2</figref> shows that the run-length constraint defines a plurality <b>204</b> of transitions from the plurality <b>200</b> of states to the next plurality of states <b>202</b>: state s<b>0</b> can only be followed by state s<b>0</b> or s<b>1</b> as shown by transitions t<b>00</b> and t<b>01</b>, state s<b>1</b> can only be followed by state s<b>2</b> as shown by transition t<b>12</b>, state s<b>2</b> can only be followed by state s<b>3</b> as shown by transition t<b>23</b>, state s<b>3</b> can only be followed by states s<b>0</b> and s<b>1</b> as shown by transitions t<b>30</b> and t<b>31</b>.</p>
<p id="p-0085" num="0084"><figref idref="DRAWINGS">FIG. 3</figref> and <figref idref="DRAWINGS">FIG. 4</figref> illustrate the operation of the Viterbi Detector.</p>
<p id="p-0086" num="0085"><figref idref="DRAWINGS">FIG. 3</figref> shows a plurality of k=0, . . . , 9 successive input data values ak <b>222</b> of values &#x2018;0&#x2019; or &#x2018;1&#x2019; indicated in boxes. For k&#x3c;0, all input data values are considered to be 0. <figref idref="DRAWINGS">FIG. 3</figref> also shows the corresponding data samples rk <b>224</b>. Dashed box <b>230</b> indicates the range of data samples that are being considered over a path memory length L for a first detection of the Viterbi Detector. Modelled, noiseless detector values xi may be obtained from convoluting the PSF=(121) with the input data values: for the center pixel of each state, states s<b>0</b>, s<b>1</b>, s<b>2</b> and s<b>3</b> thus correspond to modelled, noiseless detector values x<b>0</b>=0, x<b>1</b>=1, x<b>2</b>=2 and x<b>3</b>=1.</p>
<p id="p-0087" num="0086"><figref idref="DRAWINGS">FIG. 3</figref> also shows a trellis <b>210</b>. The trellis <b>210</b> indicates all possible transitions between successive states. The trellis also indicates the survivor paths <b>216</b>, i.e. the paths that have the lowest summed branch metrics for the successor state up along the trellis. As branch metric BM, the absolute difference between the modelled, noiseless detector value xi and the data sample rk is used, i.e.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>BM=|<i>xi&#x2212;rk|. </i><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0088" num="0087">The skilled person will appreciate that alternative branch metrics BM&#x2032; may be used, such as e.g.:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>BM&#x2032;=(<i>xi&#x2212;rk</i>)<sup>2</sup>.<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0089" num="0088">As an example, at k=0, the input data value is a<b>0</b>=1, noiseless detector values are x<b>0</b>=0, x<b>1</b>=1, x<b>2</b>=2 and x<b>3</b>=1, r<b>0</b>=2, so the branch metrics BM=|xi&#x2212;rk| are: BM(s<b>0</b>)=2, BM(s<b>1</b>)=1, BM(S<b>2</b>)=0, BM(s<b>3</b>)=1. Thus, the survivor path leading to s<b>0</b> as successor state is selected as the minimum from transition t<b>00</b> and t<b>30</b> with corresponding branch metrics 2 and 1: to reach s<b>0</b> at k=1, only the path consisting of transition t<b>30</b> from s<b>3</b> is kept as candidate path, whereas the path from s<b>0</b> is discarded. The other survivor paths leading to s<b>1</b>, s<b>2</b> and d<b>3</b> at k=1 are respectively t<b>31</b> (the lowest BM of transitions t<b>21</b> and t<b>31</b>), t<b>12</b> (the only possible transition to s<b>2</b>) and t<b>23</b> (the only possible transition to s<b>3</b>). Likewise are the survivor paths to states at k=2, . . . , 9 indicated in the trellis with full errors <b>216</b> and all discarded paths are discarded with dashed arrows <b>214</b>.</p>
<p id="p-0090" num="0089">The Viterbi Detector determines at k=8 which of all survivor paths along the path memory length has the lowest path metric. For the example shown, the path metrics at k=8 are 3, 3, 2 and 0 to states s<b>0</b>, s<b>1</b>, s<b>2</b> and s<b>3</b> respectively. Thus, the path leading to s<b>3</b> is selected as the path with the maximum likelihood of representing the actual sequence of states. The Viterbi Detector traces back this path to its originating state at k=0, and finds state s<b>2</b>, i.e. &#x2018;010&#x2019; at k=0. The left-most value of this state, i.e. &#x2018;0&#x2019;, is outputted as the output value for the previous position: the reconstructed output value for k=&#x2212;1 thus equals &#x2018;0&#x2019;.</p>
<p id="p-0091" num="0090">Then, the Viterbi Detector shifts to the next data sample to obtain the situation as shown in <figref idref="DRAWINGS">FIG. 4</figref>. Dashed box <b>231</b> indicates the range of data samples that are now being considered a second detection of the Viterbi Detector.</p>
<p id="p-0092" num="0091">Trellis <b>211</b> of <figref idref="DRAWINGS">FIG. 4</figref> corresponds to the trellis of <b>210</b>, wherein the transitions from k=0 to k=1 are discarded and new branch metrics from k=8 to k=9 have been calculated and the trellis <b>211</b> is extended with the corresponding survivor paths. It may be observed that s<b>0</b> and s<b>1</b> both have a path metric of 0 at k=9. Both originate from s<b>3</b> at k=1. So the Viterbi Detector finds states s<b>3</b>, i.e. &#x2018;100&#x2019; at k=1, and outputs a reconstructed output value for k=0 as &#x2018;1&#x2019;.</p>
<p id="p-0093" num="0092">The Viterbi Detector may this continue until all output values have been determined When the right-most value of the range of data samples that are being considered is the last value of the sequence, the Viterbi Detector may output the complete path as outputs for the last 9 states. Alternatively, the Viterbi Detector may use ak=0 for subsequent data samples.</p>
<p id="p-0094" num="0093">The above described Viterbi Detector may be very effective for systems wherein the model of the system is sufficiently accurate to model the noiseless detector value xi for each possible configuration of input data values ak, wherein at the same time a sufficient discrimination between a true input signal and noise can be obtained. Such and similar Viterbi Detectors may successfully be used to recover from the ISI for one-dimensional binary data with a significant amount of ISI, i.e. a point spread function of several data samples. Also, such and similar Viterbi Detectors may successfully be used to reconstruct two-dimensional binary data, such as Smart Codes used to for identification. For two-dimensional data, a Viterbi Detector may e.g. be used strip-wise, wherein Viterbi Detection is used along rows, and hard decisions are made from row to row or from strip to strip. However, the Viterbi Detector as described above does not work well with TEM images.</p>
<p id="p-0095" num="0094"><figref idref="DRAWINGS">FIG. 5</figref> illustrates the performance of the above described Viterbi Detector for an exemplary one-dimensional TEM image. The Viterbi Detector uses the same states and same transitions as the Viterbi Detector described with reference to <figref idref="DRAWINGS">FIGS. 3 and 4</figref>. In these states and their branch metrics, the modelled signal level is defined as the peak signal level Epeak of the distribution of signal levels resulting from a single incident electron. The model hereby uses the knowledge that an incident electron of 300 keV may result in any number of electron hole pairs between 0 and 80.000 and a corresponding distribution of detected charge, with a distribution that is similar to a Landau-function, i.e., strongly peaked at the signal level Epeak. The k=0, . . . , 9 successive input data values ak <b>222</b> of values &#x2018;0&#x2019; or &#x2018;1&#x2019; indicate the absence or presence of an electron on the corresponding pixel and is indicated in the boxes. <figref idref="DRAWINGS">FIG. 5</figref> also shows the corresponding data samples rk <b>224</b><i>a</i>, which are equal to the values from <figref idref="DRAWINGS">FIG. 3</figref>, except for r<b>0</b> and r<b>1</b> relating to positions k=0 and k=1. The inventor believes that the different values for r<b>0</b> and r<b>1</b> originate from an electron having resulted in a significantly larger amount of charge in the sensor than the amount of charge corresponding to Epeak. For this exemplary situation, the trellis and the paths with minimum path metric are indicated <figref idref="DRAWINGS">FIG. 5</figref>. It is observed that two paths with the same minimum path metric are obtained: one originating from s<b>2</b> and the other from s<b>3</b>. For the Viterbi Detector, both paths have an equal likelihood. The Viterbi Detector may thus output either a &#x2018;0&#x2019; according to state s<b>2</b>, or a &#x2018;1&#x2019; according to state. However, the correct output is &#x2018;1&#x2019; as there is a single electron at k=0. The Viterbi Detector may thus erroneously output &#x2018;0&#x2019;.</p>
<p id="p-0096" num="0095"><figref idref="DRAWINGS">FIG. 6</figref> shows an example of states and transitions for use with a Viterbi Detector in an embodiment of the invention.</p>
<p id="p-0097" num="0096">As shown in <figref idref="DRAWINGS">FIG. 6</figref>, the Viterbi Detector has a plurality <b>300</b> of states, consisting of one states, labelled s<b>0</b>, with three successive data values of &#x2018;0&#x2019;, three different states, labelled s<b>1</b>, s<b>2</b> and s<b>3</b>, each having one data value &#x2018;1&#x2019; and two data values &#x2018;0&#x2019; and three different states, labelled s<b>4</b>, s<b>5</b> and s<b>6</b>, each having one data value &#x2018;2&#x2019; and two data values &#x2018;0&#x2019;. <figref idref="DRAWINGS">FIG. 6</figref> also shows all allowable transitions <b>304</b>, allowing to define the full trellis diagram.</p>
<p id="p-0098" num="0097">In a first embodiment, the numerical value indicated in the boxes in <figref idref="DRAWINGS">FIG. 6</figref> indicates the number of electrons incident on a single pixel. Compared to <figref idref="DRAWINGS">FIG. 2</figref>, it may thus be seen that the states are extended with states wherein more than one electron is incident on the same pixel, i.e. states s<b>4</b>, s<b>5</b> and s<b>6</b>. According to this embodiment, a new trellis is constructed and a corresponding Viterbi Detector will obtain state s<b>6</b>=&#x2018;200&#x2019; at k=1 as resulting in the minimum path metric: the trellis is shown in <figref idref="DRAWINGS">FIG. 7</figref>. The Viterbi Detector will thus output &#x2018;2&#x2019; as a result, indicative of the presence of two electrons on the corresponding pixel. After having obtained the output from the Viterbi Detector, the method according to the first embodiment analyses the output from the Viterbi Detector and adjusts all non-zero output values to &#x2018;1&#x2019;. Hereby, assuming a low coincidence rate of two electrons on a single pixel, the most likely multiplicity of electrons per pixel, i.e. just one instead of two, may be used as the output of the method. Thus, in this first embodiment, a plurality of different states of the Viterbi Decoder relates to the same multiplicity (in this case, one) of incident electrons as output of the method, the different states being modelled using a different multiplicity of electrons. It will be appreciated that, for a low dose, e.g. of 0.01 electron per pixel, and with the reference level suitable selected, the frequency of occurrence of two electrons on a single pixel may significantly smaller, e.g. an order of magnitude smaller, than the frequency of occurrence of a single electron with a double deposited energy.</p>
<p id="p-0099" num="0098">In a second embodiment, the numerical value indicated in the boxes in <figref idref="DRAWINGS">FIG. 6</figref> indicates an energy bin accorded to a single electron incident on a single pixel. Compared to <figref idref="DRAWINGS">FIG. 2</figref>, it may thus be seen that the states are extended with states wherein a single electron is incident on the same pixel, but of a different typical energy, i.e. states s<b>4</b>, s<b>5</b> and s<b>6</b>. According to this embodiment, a new trellis is constructed and a corresponding Viterbi Detector will obtain state s<b>6</b>=&#x2018;200&#x2019; at k=1 as resulting in the minimum path metric: the trellis is shown in <figref idref="DRAWINGS">FIG. 7</figref>. The Viterbi Detector will thus output &#x2018;2&#x2019; as a result, indicative of the presence of a single electron of energy bin &#x2018;2&#x2019; on the corresponding pixel. Thus, in this second embodiment, a plurality of different states of the Viterbi Decoder relates to the same multiplicity of incident electrons (in this case, one) as output of the method, the different states being modelled using different deposited energies of the electron(s).</p>
<p id="p-0100" num="0099">In another embodiment, the different states are modelled using different point spread functions in modelling deposited energies of the particle(s). The different point spread functions may e.g. have different amplitudes, thereby modelling different deposited energies of the electron(s).</p>
<p id="p-0101" num="0100"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a third embodiment using the same states as shown in <figref idref="DRAWINGS">FIG. 6</figref>. In the third embodiment, the Viterbi Decoder operates in a plurality of iterations. In each iteration, state s<b>0</b> is used together with a plurality of different states, each of the plurality of different states having one data value of a specific data value (with the same specific data value for all three states) and two data values &#x2018;0&#x2019;, where the data values of the specific data value are located at different positions for each of the different state. The third embodiment is illustrated using an example shown in <figref idref="DRAWINGS">FIG. 8</figref>. The example shows a configuration of electrons labelled with their deposited energy bin &#x2018;0&#x2019;, &#x2018;1&#x2019; or &#x2018;2&#x2019; in row <b>350</b>, and with corresponding data samples <b>352</b>. In the example shown, the Viterbi Decoder operates in a first iteration with a first plurality <b>360</b> of states s<b>0</b>, s<b>4</b>, s<b>5</b> and s<b>6</b>. States s<b>4</b>, s<b>5</b> and s<b>6</b> may be defined similarly to those in the first embodiment, or, alternatively, to those in the second embodiment. In the first iteration, the Viterbi Decoder will thus effectively only reconstruct electrons with an energy corresponding to that of states s<b>4</b>, s<b>5</b> and s<b>6</b>, but not to that of states s<b>1</b>, s<b>2</b> and s<b>3</b>. The number of states is thus reduced to 4 and the number of transitions to 6, whereby trellis is significantly simplified compared to the trellis associated with the first and second embodiments. The Viterbi decoder outputs from this first iteration, for the example shown, two electrons indicated with E<sub>2 </sub>on <b>370</b>, which correspond to data values as shown in <b>372</b>. The data values <b>372</b> corresponding to the found electrons are then subtracted from the corresponding original data values <b>352</b>, to result in residue data values <b>376</b>. The residue data values <b>376</b> are then used as input to a second iteration of the Viterbi Decoder with a second plurality <b>380</b> of states s<b>0</b>, s<b>1</b>, s<b>2</b> and s<b>3</b>. The Viterbi decoder outputs from this second iteration, for the example shown, two electrons indicated with E<sub>1 </sub>on <b>390</b>. The outputs of the first and second iteration are then added to result in the complete output shown as <b>390</b>: all 4 electrons, two of a deposited energy around E<b>2</b> and one of a deposited energy around E<b>1</b>, have been reconstructed. Thus, in this third embodiment, a plurality of different states of the Viterbi Decoder relates to the same multiplicity of incident electrons (in this case, one) as output of the method, the different states being used in different iterations of the Viterbi Decoder.</p>
<p id="p-0102" num="0101"><figref idref="DRAWINGS">FIG. 9</figref> shows the states of a fourth embodiment. The fourth embodiment comprises the same states as the first embodiment, as well as three additional different states s<b>7</b>, s<b>8</b> and s<b>9</b>, each having two data values &#x2018;2&#x2019; and one data values &#x2018;0&#x2019;. States s<b>0</b>-s<b>9</b> thus define 10 different states having 0, 1 or 2 electrons. As in the first embodiment, after having obtained the output from the Viterbi Detector, the method according to the fourth embodiment analyses the output from the Viterbi Detector and adjusts all non-zero output values to &#x2018;1&#x2019;. Hereby, assuming a low coincidence rate of two electrons on a single pixel, the most likely multiplicity of electrons per pixel, i.e. just one instead of two, may be used as the output of the method. Thus, in this fourth embodiment, a plurality of different states of the Viterbi Decoder relates to the same multiplicity (in this case, one) of incident electrons as output of the method, the different states being modelled using a different multiplicity of electrons on a single pixel. An advantage of the fourth embodiment may be that a larger dose can be accommodated, at the cost of more states, resulting in a larger memory requirement and a larger computational load.</p>
<p id="p-0103" num="0102">It will be appreciated that the invention is not limited to the exemplary embodiments described above, but also includes e.g. other PSFs and other multiplicities of electrons than two or a larger number of energy bins than two.</p>
<p id="p-0104" num="0103">The embodiments described above used one-dimensional data sequences. The embodiments may be extended to two-dimensional data sequences, such obtained from a two-dimensional array of pixels e.g. as described in the following.</p>
<p id="p-0105" num="0104"><figref idref="DRAWINGS">FIG. 10</figref> schematically shows a two-dimensional semiconductor sensor of a plurality of pixels arranged in a matrix <b>500</b>, organized in a plurality of columns (of which 15 are shown; not numbered) and a plurality of rows of which rows numbered R<b>0</b>-R<b>12</b> are shown. Four electrons are incident on the sensor, resulting in four regions on 3&#xd7;3 pixels, denoted by <b>501</b>, <b>502</b>, <b>503</b> and <b>504</b>. The electron hole pairs generated by each of the electrons diffuses to generate charge with a distribution according to a two-dimensional Point Spread Function PSF<b>2</b>=(121)<sup>2</sup>. The numbers 1 and 2 in areas <b>501</b>-<b>504</b> thus indicate the relative contribution of an electron incident on the center pixel of the respective area to all surrounding pixels.</p>
<p id="p-0106" num="0105"><figref idref="DRAWINGS">FIG. 10-FIG</figref>. <b>12</b> schematically illustrate the operation of a two-dimensional method using Viterbi Detection according to a further embodiment of the invention.</p>
<p id="p-0107" num="0106">Along a row, the Viterbi Detector operates analogously to that described above for a one-dimensional sequence of data samples: the adjacent pixels on a row for the one-dimensional sequence of data samples which are processed sequentially, in a direction indicated with arrow <b>520</b>. Hashed area <b>510</b> in <figref idref="DRAWINGS">FIG. 11</figref> and <figref idref="DRAWINGS">FIG. 12</figref> indicated the area where detection has been completed. A first electron <b>511</b> corresponding to 3&#xd7;3 region <b>501</b>, a second electron <b>512</b> corresponding to 3&#xd7;3 region <b>502</b> and a third electron <b>513</b> corresponding to 3&#xd7;3 region <b>503</b> have been detected. Preferably, the (modelled) contributions to the pixel signals in the corresponding 3&#xd7;3 regions has been subtracted from the data samples in the 3&#xd7;3 regions. Hereby, their contribution to the data samples used for further detection has been deleted. No further electrons are detected in the rest of area <b>510</b>. The method has proceeded to decide on the value of pixel <b>531</b>. Hereto, the Viterbi Detector analyses the trellis, its branch metrics and states for the sequence of pixels in area <b>530</b>, extending over a path memory length L from the pixel indicated with <b>530</b>-<b>0</b> to the pixel indicated with <b>530</b>-<b>8</b>. In an embodiment, the Viterbi Detector calculates the branch metric for a state using a predetermined area around a respective pixel of pixels <b>530</b>-<b>0</b> to <b>530</b>-<b>8</b>. The size of the predetermined are corresponds preferably substantially to the PSF. Hereby, all contributions of electrons at positions in the predetermined area to the respective pixel are summed and model the total pixel signal according to the state. The Viterbi Detector may e.g. use the plurality of states shown in <figref idref="DRAWINGS">FIG. 14</figref> or <figref idref="DRAWINGS">FIG. 15</figref>.</p>
<p id="p-0108" num="0107">In the embodiment described with reference to <figref idref="DRAWINGS">FIG. 12</figref>, the Viterbi Detector operates row-wise, i.e. the Viterbi Detection is applied to sequences of pixel signals per row of pixels of the two-dimensional array. In another embodiment, the Viterbi Detector operates column-wise, i.e., the Viterbi Detection is applied to sequences of pixel signals per column of pixels of the two-dimensional array.</p>
<p id="p-0109" num="0108"><figref idref="DRAWINGS">FIG. 14</figref> schematically shows a plurality <b>560</b> of states used in a first further embodiment using a PSF=(121)<sup>2</sup>, indicating the configuration of electrons incident on a 3&#xd7;3 area of the sensor. <figref idref="DRAWINGS">FIG. 15</figref> schematically shows another plurality <b>580</b> of states used in a second further embodiment. It is noted that the hashed area, corresponding to the pixels for which the Viterbi Detector has already taken a decision, may comprise an electron, but as its contribution has already been subtracted in the hashed as well as the non-hashed area (see above), such presence can be disregarded without any loss of generality. It will be understood that, when such contributions have not been subtracted while an electron has been detected, its contribution to the center pixel of the state will also have to be considered. However, as the decision on its presence has already been taken, it is not necessary to also consider the hashed positions as variable in the state definition.</p>
<p id="p-0110" num="0109"><figref idref="DRAWINGS">FIG. 14</figref> relates to a first further embodiment wherein a PSF is used on a 3&#xd7;3 area. The PSF is shown in dashed form with reference number <b>569</b>. The plurality of states <b>560</b> of <figref idref="DRAWINGS">FIG. 14</figref> comprises one state <b>561</b> without any electrons; six different states <b>562</b> with one electron, on six different positions; six states <b>563</b> with two electrons on a single position within a state (or one double energy electron, cf. the first and second embodiment of the one-dimensional examples given above) but different between states; and, optionally, fifteen different states <b>564</b> with two electrons at different positions.</p>
<p id="p-0111" num="0110"><figref idref="DRAWINGS">FIG. 15</figref> relates to a second further embodiment wherein the same PSF=(121)<sup>2 </sup>is used, but the states are defined based on a cross-shaped area of 1+3+1 pixels. The PSF is shown in dashed form with reference number <b>579</b>. The plurality of states <b>580</b> of <figref idref="DRAWINGS">FIG. 15</figref> comprises one state <b>571</b> without any electrons; four different states <b>582</b> with one electron, on four different positions; four states <b>584</b> with two electrons on a single position within a state (or one double energy electron, cf. the first and second embodiment of the one-dimensional examples given above) but different between states; and, optionally, six different states <b>574</b> with two electrons at different positions.</p>
<p id="p-0112" num="0111">A Viterbi Decoder may use the states of <figref idref="DRAWINGS">FIG. 14</figref> or <figref idref="DRAWINGS">FIG. 15</figref> depending on the dose, allowed or required computational complexity and memory requirements etc.</p>
<p id="p-0113" num="0112">It will be appreciated that, similarly to the third embodiment described with reference to <figref idref="DRAWINGS">FIG. 9</figref>, the Viterbi Decoder may also for the two-dimensional PSF, employ a plurality of iterations using a different multiplicity of electrons, or a different energy bin, per iteration.</p>
<p id="p-0114" num="0113"><figref idref="DRAWINGS">FIG. 16-FIG</figref>. <b>17</b> schematically illustrate the operation of a two-dimensional method using Viterbi Detection according to again a further embodiment of the invention, similarly to the embodiments of <figref idref="DRAWINGS">FIG. 10-FIG</figref>. <b>15</b>, but with a wider Point Spread Function.</p>
<p id="p-0115" num="0114"><figref idref="DRAWINGS">FIG. 16</figref> schematically shows a two-dimensional semiconductor sensor of a plurality of pixels arranged in a matrix <b>600</b>, organized in a plurality of columns (of which 15 are shown; not numbered) and a plurality of rows of which rows numbered R<b>0</b>-R<b>12</b> are shown. Four electrons are incident on the sensor, resulting in four regions on 5&#xd7;5 pixels, denoted by <b>601</b>, <b>602</b>, <b>603</b> and <b>604</b>. The electron hole pairs generated by each of the electrons diffuses to generate charge with a distribution according to a two-dimensional Point Spread Function PSF<b>3</b>=(13531)<sup>2</sup>. This PSF closely resembles the actual diffusion in an exemplary CMOS sensor having 4 k&#xd7;4 k pixels of approximately 15 &#x3bc;m&#xd7;15 &#x3bc;m size and a thickness of its active layer of 15 &#x3bc;m. Hashed area <b>610</b> indicates the area where detection has been completed. Three electrons <b>611</b>, <b>612</b>, <b>613</b> have already been detected.</p>
<p id="p-0116" num="0115">The method has proceeded to decide on the value of pixel <b>631</b>. Hereto, the Viterbi Detector analyses the trellis, its branch metrics and states for the sequence of pixels in area <b>630</b>, extending over a path memory length L from the pixel indicated with <b>630</b>-<b>0</b> to the pixel indicated with <b>630</b>-<b>8</b>. In an embodiment, the Viterbi Detector calculates the branch metric for a state using a predetermined area around a respective pixel of pixels <b>630</b>-<b>0</b> to <b>630</b>-<b>8</b>. The size of the predetermined are corresponds preferably substantially to the PSF. Hereby, all contributions of electrons at positions in the predetermined area to the respective pixel are summed and model the total pixel signal according to the state. The Viterbi Detector may e.g. use one of the embodiments of the plurality of states shown in <figref idref="DRAWINGS">FIG. 17</figref>. The numbers 1, 3 and 5 in area <b>604</b> indicate the relative contribution of an electron incident on the center pixel of area <b>604</b> to all surrounding pixels.</p>
<p id="p-0117" num="0116"><figref idref="DRAWINGS">FIG. 17</figref> schematically three different embodiments defining the states of the Viterbi Detector, wherein question marks indicate the positions within an area around a pixel of the sequence of pixels used to determine the branch metrics upon which an electron may be incident. As in <figref idref="DRAWINGS">FIG. 14</figref>, the hashed area corresponds to the pixels for which the Viterbi Detector has already taken a decision (when scanning a previous row or earlier on the same row). The number of states increases with the total number of allowable electrons and with the number of allowable positions for an electron. A larger number of allowable electrons and/or a larger number of positions may however be preferred with increasing dose.</p>
<p id="p-0118" num="0117">Embodiment <b>661</b> schematically indicates states having one, or in further embodiments more than one, of fifteen different positions which may have zero, one or a plurality of electrons. Embodiment <b>662</b> schematically indicates states having one, or in further embodiments more than one, of thirteen different positions which may have zero, one or a plurality of electrons. Embodiment <b>663</b> schematically indicates states having one, or in further embodiments more than one, of nine different positions which may have zero, one or a plurality of electrons.</p>
<p id="p-0119" num="0118"><figref idref="DRAWINGS">FIG. 18A</figref> and <figref idref="DRAWINGS">FIG. 18B</figref> schematically illustrates frequency of occurrence of a signal level from a pixel when one electron is incident on the pixel of a typical semiconductor sensor. Signal level is increasing along the horizontal axis, relative frequency of occurrence is increasing along the vertical axis. Curve <b>702</b> indicates the frequency of occurrence of the signal level. Curve <b>702</b> is approximately a Landau-distribution. Curve <b>702</b> shows a clear peak at a signal level indicated with Epeak. Arrow <b>704</b> indicates the dark current noise of the semiconductor sensor.</p>
<p id="p-0120" num="0119"><figref idref="DRAWINGS">FIG. 18A</figref> and <figref idref="DRAWINGS">FIG. 18B</figref> also shows examples of reference levels used to define an energy bin or a multiplicity of electrons as used in the internal states. Below, we will refer to reference levels defining the &#x2018;number of electrons&#x2019; on a single pixel in a state (cf. the first embodiment), but the reader shall understand that this may also be interpreted as &#x2018;energy bin&#x2019; of an electron in a state (cf. the second embodiment).</p>
<p id="p-0121" num="0120">In <figref idref="DRAWINGS">FIG. 18A</figref>, the reference level E<b>1</b>, associated with the number of electrons in a single pixel of a state being one, is chosen to correspond to the peak Epeak of the curve <b>702</b>. It may however also be observed that the noise level extends well beyond halve the peak value. Using such choice for the reference level may thus have a risk of a relatively high &#x2018;false positives&#x2019; where an electron is detected without actual an electron being incident on the detector. However, such choice may advantageously have relatively few little &#x2018;false negatives&#x2019; where no electron is detected despite it being present. Reference levels E<b>2</b>, E<b>3</b>, E<b>4</b> and E<b>5</b>, associated respectively with two, three, four and five electrons on one pixel, are selected and used to define states accordingly, in order to also detect electrons with a higher pixel signal, i.e. a larger energy deposit, with a sufficient reliability. Thus, in the embodiment of <figref idref="DRAWINGS">FIG. 18A</figref>,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>En=n*E</i>peak,<i>n=</i>1<i>, . . . , N, </i><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
with N preferably being 4, 5 or larger.
</p>
<p id="p-0122" num="0121">In <figref idref="DRAWINGS">FIG. 18B</figref>, the reference level E<b>1</b>, associated with the number of electrons in a single pixel of a state being one, is chosen to correspond to twice the value of the peak Epeak of the curve <b>702</b>, Further reference levels are chosen as multiples of E<b>1</b>, or
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>En=n*</i>2<i>*E</i>peak,<i>n=</i>1<i>, . . . , N, </i><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0123" num="0122">with N preferably being 2 or 3. Using such choice for the reference levels may reduce the number of states significantly, but may have the risk that several electrons with only a low deposited energy are not detected as electrons, but being overseen as noise.</p>
<p id="p-0124" num="0123">It will be understood that other choices of reference levels may be used. The choice of reference levels and their number may e.g. be selected based on available resources for the Viterbi Detection, such as computational power, available memory size and available computation time per image, or e.g. on required image quality of the reconstructed image</p>
<p id="p-0125" num="0124"><figref idref="DRAWINGS">FIG. 19</figref> shows a result of a simulation of a method according to the invention. The method used in the simulation uses a dose of 0.01, i.e. with an average number of 1 electron on 100 pixels, a PSF=(13531)<sup>2</sup>, 15 positions per state (cf. <b>661</b> in <figref idref="DRAWINGS">FIG. 17</figref>), maximum 2 electrons per state, with the reference level for a single electron being selected as twice the peak value of curve <b>702</b>. The simulation uses a CMOS semiconductor sensor used in a TEM and electrons of typical energy when analysing a biological sample at such low dose. <figref idref="DRAWINGS">FIG. 19</figref> shows the Modulation Transfer Function, which is a measure of the resolution obtained. The horizontal axis corresponds to a frequency of a repeating pattern, and extends from zero to the Nyquist frequency. The vertical axis is the relative output level from such repeating patterns. It is observed that the MTF <b>900</b> of the detector itself, i.e. of the raw data signals, is already smaller than 0.5 at half the Nyquist frequency. The output <b>902</b> of the Viterbi Detector however remains above 0.8 until the Nyquist frequency. The Viterbi Detector thus allows to substantially recover the full pixel resolution of the sensor, which is indicated by line <b>904</b>.</p>
<p id="p-0126" num="0125"><figref idref="DRAWINGS">FIG. 20</figref> schematically shows an overview of a method according to an embodiment.</p>
<p id="p-0127" num="0126">The method <b>1</b> shown in <figref idref="DRAWINGS">FIG. 20</figref> comprises:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0127">producing <b>10</b> a beam of particles,</li>
        <li id="ul0002-0002" num="0128">placing <b>20</b> an object <b>111</b> to be imaged on an object plane,</li>
        <li id="ul0002-0003" num="0129">illuminating <b>30</b> the object plane with the beam of particles,</li>
        <li id="ul0002-0004" num="0130">forming <b>40</b> an image of the object plane by imaging particles transmitted through the object on an image plane, and</li>
        <li id="ul0002-0005" num="0131">detecting <b>50</b> the image with the detector comprising the semiconductor sensor and providing a plurality of pixel signals from the respective pixels of the array in response to the particles incident on the detector,</li>
        <li id="ul0002-0006" num="0132">receiving <b>60</b> the plurality of pixel signals by a Viterbi Detector, and</li>
        <li id="ul0002-0007" num="0133">determining <b>70</b> a reconstructed image from using Viterbi Detection on the plurality of pixel signals by the Viterbi Detector, the Viterbi Detection using a plurality of different states corresponding to a plurality of configurations of particles incident on the detector, and at least two states of the plurality of different states corresponding to a same, non-zero multiplicity of incident particles on a single pixel of the plurality of pixel signals.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0128" num="0134">The determining <b>70</b> may be performed according to any one of the embodiments described above, to any useful combination of two or more of the embodiments described above or to a modification of any one of the embodiments or their combination. <figref idref="DRAWINGS">FIG. 21</figref> schematically illustrates a further embodiment. In the embodiment of <figref idref="DRAWINGS">FIG. 21</figref>, the method comprises receiving <b>61</b><i>a </i>first plurality of pixel signals from respective pixels of the array in response to particles incident on the detector upon detecting a first image of the object and determining <b>71</b><i>a </i>first reconstructed image from using the Viterbi Detection on the first plurality of pixel signals. The Viterbi Detection may be performed according to any of the embodiments described above, The method further comprises receiving <b>62</b> a second plurality of pixel signals from the respective pixels of the array in response to particles incident on the detector upon detecting a second image of the object and determining <b>72</b> a second reconstructed image from using the Viterbi Detection on the second plurality of pixel signals. As indicated with dashed lines, the method may further comprise receiving <b>63</b> at least one further plurality of pixel signals from the respective pixels of the array in response to particles incident on the detector upon detecting at least one respective further image of the object and determining <b>73</b> at least one further reconstructed image from using the Viterbi Detection on the respective further plurality of pixel signals. The method then combines <b>80</b> the first reconstructed image, the second reconstructed image and, if appropriate, the at least one further reconstructed images to form the reconstructed image.</p>
<p id="p-0129" num="0135"><figref idref="DRAWINGS">FIG. 22</figref> shows a computer readable medium <b>500</b> comprising a computer program <b>1020</b>, the computer program <b>1020</b> comprising instructions for causing a processor system to perform a method according to an embodiment. The computer program <b>1020</b> may be embodied on the computer readable medium <b>1000</b> as physical marks or by means of magnetization of the computer readable medium <b>1000</b>. However, any other suitable embodiment is conceivable as well. Furthermore, it will be appreciated that, although the computer readable medium <b>1000</b> is shown in <figref idref="DRAWINGS">FIG. 22</figref> as an optical disc, the computer readable medium <b>1000</b> may be any suitable computer readable medium, such as a hard disk, solid state memory, flash memory, etc., and may be non-recordable or recordable.</p>
<p id="p-0130" num="0136">It will be appreciated that the invention also applies to computer programs, particularly computer programs on or in a carrier, adapted to put the invention into practice. The program may be in the form of a source code, an object code, a code intermediate source and an object code such as in a partially compiled form, or in any other form suitable for use in the implementation of the method according to the invention. It will also be appreciated that such a program may have many different architectural designs. For example, a program code implementing the functionality of the method or system according to the invention may be sub-divided into one or more sub-routines. Many different ways of distributing the functionality among these sub-routines will be apparent to the skilled person. The sub-routines may be stored together in one executable file to form a self-contained program. Such an executable file may comprise computer-executable instructions, for example, processor instructions and/or interpreter instructions (e.g. Java interpreter instructions). Alternatively, one or more or all of the sub-routines may be stored in at least one external library file and linked with a main program either statically or dynamically, e.g. at run-time. The main program contains at least one call to at least one of the sub-routines. The sub-routines may also comprise function calls to each other. An embodiment relating to a computer program product comprises computer-executable instructions corresponding to each processing step of at least one of the methods set forth herein. These instructions may be sub-divided into sub-routines and/or stored in one or more files that may be linked statically or dynamically. Another embodiment relating to a computer program product comprises computer-executable instructions corresponding to each means of at least one of the systems and/or products set forth herein. These instructions may be sub-divided into sub-routines and/or stored in one or more files that may be linked statically or dynamically.</p>
<p id="p-0131" num="0137">The carrier of a computer program may be any entity or device capable of carrying the program. For example, the carrier may include a storage medium, such as a ROM, for example, a CD ROM or a semiconductor ROM, or a magnetic recording medium, for example, a hard disk. Furthermore, the carrier may be a transmissible carrier such as an electric or optical signal, which may be conveyed via electric or optical cable or by radio or other means. When the program is embodied in such a signal, the carrier may be constituted by such a cable or other device or means. Alternatively, the carrier may be an integrated circuit in which the program is embedded, the integrated circuit being adapted to perform, or used in the performance of, the relevant method.</p>
<p id="p-0132" num="0138">In this document, the term &#x201c;particles&#x201d; does not include photons, but refers to particles with a rest energy different from zero. The term &#x201c;particles&#x201d; may in particular relate to electrons. The particle-optical apparatus may e.g. comprise a TEM.</p>
<p id="p-0133" num="0139">It should be noted that the above-mentioned embodiments illustrate rather than limit the invention, and that those skilled in the art will be able to design many alternative embodiments without departing from the scope of the appended claims. In the claims, any reference signs placed between parentheses shall not be construed as limiting the claim. Use of the verb &#x201c;comprise&#x201d; and its conjugations does not exclude the presence of elements or steps other than those stated in a claim. The article &#x201c;a&#x201d; or &#x201c;an&#x201d; preceding an element does not exclude the presence of a plurality of such elements. The invention may be implemented by means of hardware comprising several distinct elements, and by means of a suitably programmed computer. In the device claim enumerating several means, several of these means may be embodied by one and the same item of hardware. The mere fact that certain measures are recited in mutually different dependent claims does not indicate that a combination of these measures cannot be used to advantage.</p>
<p id="p-0134" num="0140">Although the present invention and its advantages have been described in detail, it should be understood that various changes, substitutions, and alterations can be made to the embodiments described herein without departing from the spirit and scope of the invention as defined by the appended claims. Moreover, the scope of the present application is not intended to be limited to the particular embodiments of the process, machine, manufacture, composition of matter, means, methods and steps described in the specification. As one of ordinary skill in the art will readily appreciate from the disclosure of the present invention, processes, machines, manufacture, compositions of matter, means, methods, or steps, presently existing or later to be developed that perform substantially the same function or achieve substantially the same result as the corresponding embodiments described herein may be utilized according to the present invention. Accordingly, the appended claims are intended to include within their scope such processes, machines, manufacture, compositions of matter, means, methods, or steps.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>I claim as follows:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. Method for determining a reconstructed image using a particle-optical apparatus, the particle-optical apparatus comprising:
<claim-text>a particle source for producing a beam of particles,</claim-text>
<claim-text>an object plane on which an object to be imaged may be placed,</claim-text>
<claim-text>a condenser system for illuminating the object plane with the beam of particles,</claim-text>
<claim-text>a projection system for forming an image of the object plane by imaging particles transmitted through the object on an image plane, and</claim-text>
<claim-text>a detector for detecting the image, the detector comprising a semiconductor sensor having an array of pixels for providing a plurality of pixel signals from respective pixels of the array in response to particles incident on the detector, the method comprising:</claim-text>
<claim-text>receiving the plurality of pixel signals, and</claim-text>
<claim-text>determining a reconstructed image using Viterbi Detection on the plurality of pixel signals, by:</claim-text>
<claim-text>modelling possible states of a path corresponding to a plurality of possible configurations incident on the detector by determining a plurality of possible state transitions between the pixels, wherein the states are characterized by a run-length constraint that there should be at least two &#x2018;0&#x2019;s between two &#x2018;1&#x2019;s;</claim-text>
<claim-text>determining the path of state transitions having the highest probability of producing the plurality of pixel signals, and</claim-text>
<claim-text>determining from the path of state transitions having the highest probability of producing the plurality of pixel signals, the configuration of particles incident on the detector; and</claim-text>
<claim-text>modifying an output of the Viterbi detection by adjusting the determined configuration of particles incident on the detector to define:</claim-text>
<claim-text>the modified output to be zero particles for pixels having zero particles in the output of the Viterbi detection, and</claim-text>
<claim-text>the modified output to be one particle for pixels having one or more particles in the output of the Viterbi detection.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. Method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the states are modelled using a different multiplicity of particles.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. Method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the states are modelled using different deposited energies of the particle(s).</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. Method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the states are modelled using different point spread functions in modelling deposited energies of the particle(s).</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. Method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the states are used in different iterations of the Viterbi Detection.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. Method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the array of pixels is a one-dimensional array.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. Method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the array of pixels is a two-dimensional array and the Viterbi Detection is applied to sequences of pixel signals per row of pixels of the two-dimensional array.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. Method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the array of pixels is a two-dimensional array and the Viterbi Detection is applied to sequences of pixel signals per column of pixels of the two-dimensional array.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. Method according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the states of the Viterbi Detection correspond to predetermined two-dimensional configurations of particles incident on the detector.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. Method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising, after having detected one or more incident particles on a pixel, removing a contribution from the detected one or more incident particles from the plurality of pixel signals.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. Method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the image detected by the detector comprises a dose in a range of 0.0001-0.5 particles per pixel.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. Method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, the method further comprising:
<claim-text>receiving a second plurality of pixel signals from the respective pixels of the array in response to particles incident on the detector upon detecting a second image of the object,</claim-text>
<claim-text>determining a second reconstructed image using Viterbi Detection on the second plurality of pixel signals by:
<claim-text>modelling possible states of a path corresponding to a plurality of possible configurations of particles incident on the detector in detecting the second image by determining a plurality of possible state transitions between the pixels, wherein the states are characterized by a run-length constraint that there should be at least two &#x2018;0&#x2019;s between two &#x2018;1&#x2019;s;</claim-text>
<claim-text>determining the path of state transitions having the highest probability of producing the second plurality of pixel signals, and</claim-text>
<claim-text>determining from the path of state transitions having the highest probability of producing the second plurality of pixel signals, a second configuration of particles incident on the detector; and</claim-text>
</claim-text>
<claim-text>modifying the output of the Viterbi detection on the second plurality of pixel signals by adjusting the second determined configuration of particles incident on the detector to define:
<claim-text>the modified output to be zero particles for pixels having zero particles in the output of the Viterbi Detection, and</claim-text>
<claim-text>the modified output to be one particle for pixels having one or more particles in the output of the Viterbi detection, and</claim-text>
</claim-text>
<claim-text>combining the modified output of the Viterbi Detection for the first reconstructed image and the modified output of the Viterbi Detection for the second reconstructed image to form a combined reconstructed image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. Method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>producing a beam of particles,</claim-text>
<claim-text>placing an object to be imaged on an object plane,</claim-text>
<claim-text>illuminating the object plane with the beam of particles,</claim-text>
<claim-text>forming an image of the object plane by imaging particles transmitted through the object on an image plane, and</claim-text>
<claim-text>detecting the image with the detector comprising the semiconductor sensor and providing a plurality of pixel signals from the respective pixels of the array in response to the particles incident on the detector.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. Particle-optical apparatus comprising:
<claim-text>a particle source for producing a beam of particles,</claim-text>
<claim-text>an object plane on which an object to be imaged may be placed,</claim-text>
<claim-text>a condenser system for illuminating the object plane with the beam of particles,</claim-text>
<claim-text>a projection system for forming an image of the object plane by imaging particles transmitted through the object on an image plane,</claim-text>
<claim-text>a detector for detecting the image, the detector comprising a semiconductor sensor having an array of pixels for providing a plurality of pixel signals from respective pixels of the array in response to particles incident on the detector, and</claim-text>
<claim-text>a signal processor configured to perform the method of <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A computer program hardware product carrying instructions for causing a processor system to perform the method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A method according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the states of the Viterbi Detection correspond to predetermined two-dimensional configurations of particles incident on the detector.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. A method for determining a reconstructed image using a particle-optical apparatus, comprising:
<claim-text>providing a particle optical apparatus having a detector for detecting an image, the detector providing a plurality of pixel signals from respective pixels in response to particles incident on the detector;</claim-text>
<claim-text>receiving the plurality of pixel signals;</claim-text>
<claim-text>determining a reconstructed image using Viterbi detection on the plurality of pixel signals, by:</claim-text>
<claim-text>modelling possible states of a path corresponding to a plurality of possible configurations incident on the detector by determining a plurality of possible state transitions between the pixels, wherein the states are characterized by a run-length constraint that there should be at least two &#x2018;0&#x2019;s between two &#x2018;1&#x2019;s;</claim-text>
<claim-text>determining the path of state transitions having the highest probability of producing the plurality of pixel signals, the most likely configuration of particles incident on the detector; and</claim-text>
<claim-text>modifying a Viterbi output by adjusting the determined configuration of particles incident on the detector to define:</claim-text>
<claim-text>the modified output to be zero particles for pixels having zero particles in the output of the Viterbi detection, and</claim-text>
<claim-text>the modified output to be one particle for pixels having one or more particles in the output of the Viterbi detection.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein the different states are modelled using a different multiplicity of particles.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein the different states are modelled using different deposited energies of the particle(s).</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The method of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein the different states are modelled using different point spread functions in modelling deposited energies of the particle(s).</claim-text>
</claim>
</claims>
</us-patent-grant>
