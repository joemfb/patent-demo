<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08626875-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08626875</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12406857</doc-number>
<date>20090318</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>592</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>16</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>709219</main-classification>
<further-classification>709224</further-classification>
<further-classification>709226</further-classification>
</classification-national>
<invention-title id="d2e53">Stream server selection based on feedback information from a client</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5928331</doc-number>
<kind>A</kind>
<name>Bushmitch</name>
<date>19990700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709231</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6594260</doc-number>
<kind>B1</kind>
<name>Aviani, Jr. et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6742044</doc-number>
<kind>B1</kind>
<name>Aviani et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7080138</doc-number>
<kind>B1</kind>
<name>Baker et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7143184</doc-number>
<kind>B1</kind>
<name>Shah et al.</name>
<date>20061100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7225237</doc-number>
<kind>B1</kind>
<name>Tenereillo</name>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709219</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7650376</doc-number>
<kind>B1</kind>
<name>Blumenau</name>
<date>20100100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709203</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2002/0112036</doc-number>
<kind>A1</kind>
<name>Bohannon et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709220</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2003/0233478</doc-number>
<kind>A1</kind>
<name>Chuah et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709247</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2005/0226196</doc-number>
<kind>A1</kind>
<name>Suh</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370338</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2005/0281205</doc-number>
<kind>A1</kind>
<name>Chandwadkar et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370249</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2006/0036724</doc-number>
<kind>A1</kind>
<name>Iizuka et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709223</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2007/0097987</doc-number>
<kind>A1</kind>
<name>Rey et al.</name>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2008/0028093</doc-number>
<kind>A1</kind>
<name>Pickens et al.</name>
<date>20080100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709231</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2008/0270225</doc-number>
<kind>A1</kind>
<name>Beygelzimer et al.</name>
<date>20081000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 11</main-classification></classification-national>
</us-citation>
</us-references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>709239-242</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709219</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370231-236</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>8</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>12047984</doc-number>
<date>20080313</date>
</document-id>
<parent-status>PENDING</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>12406857</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20090234965</doc-number>
<kind>A1</kind>
<date>20090917</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Viveganandhan</last-name>
<first-name>Mahesh Chakravarthy Vittal</first-name>
<address>
<city>Sunnyvale</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Koroth</last-name>
<first-name>Dipak Punnoran</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Thomas</last-name>
<first-name>Anil</first-name>
<address>
<city>Milipitas</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Viveganandhan</last-name>
<first-name>Mahesh Chakravarthy Vittal</first-name>
<address>
<city>Sunnyvale</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Koroth</last-name>
<first-name>Dipak Punnoran</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Thomas</last-name>
<first-name>Anil</first-name>
<address>
<city>Milipitas</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Merchant &#x26; Gould</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Cisco Technology, Inc.</orgname>
<role>02</role>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Biagini</last-name>
<first-name>Christopher</first-name>
<department>2445</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A technique for selecting a media streaming engine, such as a stream server, to source a media stream to a client involves receiving feedback information from a client that indicates a quality of service experienced by the client and then selecting a media streaming engine, from a set of media streaming engines, in response to the feedback information. In an embodiment, the feedback information is provided in Real-Time Control Protocol (RTCP) messages. For example, the RTCP messages are Receiver Report (RR) messages that contain packet loss and/or inter-arrival jitter information. Feedback information such as packet loss and/or inter-arrival jitter information represents the actual quality of service experienced by a client for a media stream. Because a media streaming engine is selected based on the actual quality of service experienced by a client, the selection process can be configured to optimize the quality of service of the media streaming.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="180.76mm" wi="255.69mm" file="US08626875-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="260.77mm" wi="184.83mm" orientation="landscape" file="US08626875-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="262.47mm" wi="192.28mm" orientation="landscape" file="US08626875-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="267.55mm" wi="187.20mm" orientation="landscape" file="US08626875-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="263.82mm" wi="180.09mm" orientation="landscape" file="US08626875-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="264.50mm" wi="187.88mm" file="US08626875-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="213.87mm" wi="105.58mm" file="US08626875-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">The current application is a Continuation In-Part of application Ser. No. 12/047,984, filed Mar. 13, 2008, entitled &#x201c;SERVER SELECTION FOR ROUTING CONTENT TO A CLIENT USING APPLICATION LAYER REDIRECTION,&#x201d; the entirety of which is incorporated by reference herein.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">TECHNICAL FIELD</heading>
<p id="p-0003" num="0002">The present disclosure relates generally to digital media networks, and more particularly, to techniques for selecting a media steaming engine from which to stream digital media to a client.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">Packet-based networking technology is increasingly being used to stream digital media, such as digital video, to clients. Digital media streaming involves transmitting packets of time-sensitive digital media from a media source, such as a stream server, to a client, such as a personal computer or a digital set-top-box (STB). As an example, digital media is streamed downstream from a stream server to a STB using Motion Picture Expert Group (MPEG)-2 Transport Stream (TS) over UDP/IP or Real-time Transport (RTP)/UDP/IP.</p>
<p id="p-0005" num="0004">Service provider networks that support digital media streaming often times have multiple different stream servers from which a particular media stream can be sourced. When a request for a media stream is made by a client, a stream server must be selected to source the media stream. While it may be easy to simply select the stream server that is physically closest to the client to source the media stream, selecting the closest stream server to the client does not necessarily provide the best result to the client.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0006" num="0005">A technique for selecting a media streaming engine, such as a stream server, to source a media stream to a client involves receiving feedback information from a client that indicates a quality of service experienced by the client and then selecting a media streaming engine, from a set of media streaming engines, in response to the feedback information. In an embodiment, the feedback information is provided in Real-Time Control Protocol (RTCP) messages. For example, the RTCP messages are Receiver Report (RR) messages that contain packet loss and/or inter-arrival jitter information. Feedback information such as packet loss and/or inter-arrival jitter information represents the actual quality of service experienced by a client for a media stream. Because a media streaming engine is selected based on the actual quality of service experienced by a client, the selection process can be configured to optimize the quality of service of the media streaming.</p>
<p id="p-0007" num="0006">Other aspects and advantages of the present invention will become apparent from the following detailed description, taken in conjunction with the accompanying drawings, illustrating by way of example the principles of the invention.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 1</figref> depicts an embodiment of a system for streaming digital media to a client that includes media streaming engines, a service router, a distribution network, and a client.</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIGS. 2A-2C</figref> illustrate an embodiment of a technique for selecting a media streaming engine.</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 3</figref> is a process flow diagram of a method for selecting a media streaming engine to source a media stream to a client.</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 4</figref> is a process flow diagram of another method for selecting a media streaming engine to source a media stream to a client.</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 5</figref> is a functional block diagram of an embodiment of the service router depicted in FIGS. <b>1</b> and <b>2</b>A-<b>2</b>C.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 6</figref> is a functional block diagram of an embodiment of the media streaming engines depicted in FIGS. <b>1</b> and <b>2</b>A-<b>2</b>C.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0014" num="0013">Throughout the description, similar reference numbers may be used to identify similar elements.</p>
<heading id="h-0006" level="1">DESCRIPTION OF EXAMPLE EMBODIMENTS</heading>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> depicts an embodiment of a system <b>100</b> for streaming digital media to a client. The system includes media streaming engines <b>102</b>, a service router <b>104</b>, a distribution network <b>106</b>, and a client <b>108</b>. The system is able to stream digital media from any one of the media streaming engines to the client. As an example, digital video content is streamed downstream from one of the media streaming engines to the client using Motion Picture Expert Group (MPEG)-2 Transport Stream (TS) over UDP/IP or Real-time Transport (RTP)/UDP/IP.</p>
<p id="p-0016" num="0015">In the system <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref>, the media streaming engines <b>102</b> are elements that are configured to stream digital media, such as digital video or digital music, to the client <b>108</b>. Each of the media streaming engines includes at least one stream server <b>110</b>, which ingests digital media from a media source (not shown) and streams the digital media into the distribution network <b>106</b>. In an embodiment, each of the media streaming engines includes a session controller (not shown) that monitors and controls stream sessions that are supported by the respective media streaming engine. A media streaming engine may include multiple stream servers that are managed as a group. For example, the stream servers may be logically grouped, geographically grouped, and/or physically s grouped. Stream servers located in different geographic locations (e.g., San Francisco and Los Angles) could be logically managed as a group even though they are in different geographic locations. Stream servers that are located in the same geographic location could be managed as a group even if the stream servers are not located in the same building and/or server rack and stream servers that are located in the same physical location (e.g., the same Video Hub Office (VHO) or the same server rack) could be managed as a group. Whatever the case, the media streaming engines depicted in <figref idref="DRAWINGS">FIG. 1</figref> are each considered as a single resource for the purpose of selecting a media streaming engine to source a media stream to the client.</p>
<p id="p-0017" num="0016">The service router <b>104</b> is configured to mediate requests from the client <b>108</b>. In particular, the service router is responsible for choosing the most appropriate media streaming engine <b>102</b> to source a requested media stream. In an embodiment, the service router can select the media streaming engine based on the location of the client and/or media streaming engine, the status of the media streaming engines, and/or load conditions, including network load conditions and load conditions of the media streaming engines. Once a media streaming engine is selected, the service router redirects the client to the selected media streaming engine to begin a media streaming session. Various Hyper-Text Transfer Protocol (HTTP) and Real-Time Streaming Protocol (RTSP) based techniques can be utilized to implement the redirects. In an embodiment, the service router maintains a topology map, which is an administrative configuration to indicate the mapping between the client subnets and/or locations and a list of available media streaming engines. The list could include stream servers from multiple media streaming engines, each of the stream servers having an associated initial cost metric. The service router updates the topology map based on input such as keepalive messages from the media streaming engines.</p>
<p id="p-0018" num="0017">The distribution network <b>106</b> between the media streaming engines <b>102</b> and the client <b>108</b> is any type of network that supports packet-based media streaming. The distribution network may include, for example, transport network, wide area network (WAN), metropolitan area network (MAN), and/or local area network (LAN) technologies. The distribution network may be wired, wireless, or a combination thereof In an embodiment, a &#x201c;last-mile&#x201d; portion of the network may be a cable-based network, a s digital subscriber line (DSL) network, a passive optical network (PON), or a wireless access network. The distribution network may utilize, for example, IP, Ethernet, ATM, or a combination thereof to stream digital media to the client.</p>
<p id="p-0019" num="0018">In the system <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref>, the client <b>108</b> is an element that receives streamed digital media from one of the media streaming engines <b>102</b> via the distribution network <b>106</b> and provides the digital video content to a media playout device such as a television or a music player. The client may be embodied as hardware, firmware, software, or any combination thereof In an embodiment, the client is embodied within a personal computer, a set-top-box (STB), a Wi-Fi connected mobile phone, or a personal digital assistant. The client may also serve other functions such as establishing a media session with one of the media streaming engines. In an embodiment, the client manages Network Layer (Layer 3) and Transport Layer (Layer 4), and Application Layer (Layer 5) communications between the client, the service router <b>104</b>, and the media streaming engines.</p>
<p id="p-0020" num="0019">Although only one client <b>108</b> is depicted in <figref idref="DRAWINGS">FIG. 1</figref>, there may be more than one client connected to the distribution network <b>106</b>. Communications between the client and the media streaming engines <b>102</b> may utilize unicasting or multicasting. Multicasting typically involves replicating packets at nodes that include multiple branches leading to different clients. The replication of packets at branching nodes eliminates the need to send multiple packets of the same content over the same link. Unicasting typically involves point-to-point messaging between nodes (e.g., servers and clients). Point-to-point messaging can be accomplished, for example, using well-known source/destination address based protocols (e.g., IP or Ethernet).</p>
<p id="p-0021" num="0020">In operation, when the client <b>108</b> requests a particular piece of digital media, one of the media streaming engines <b>102</b> must be selected to source the digital media stream. In accordance with an embodiment of the invention, feedback information from a client, which indicates a quality of service experienced by the client, is used to select a media stream engine to source the requested media stream. In an embodiment, the feedback information is provided in RTCP RR messages that contain packet loss and/or inter-arrival jitter information. The packet loss and/or inter-arrival jitter information represents the actual quality of service experienced by a client for a media stream. Because a media streaming engine is selected based on the actual quality of service experienced by a client, the selection process can be configured to optimize the quality of service of the media streaming.</p>
<p id="p-0022" num="0021">An embodiment of a technique for selecting a media streaming engine is described with reference to <figref idref="DRAWINGS">FIGS. 2A-2C</figref>. The technique utilizes feedback information in RTCP RR messages that are received from the client <b>108</b> to select a media streaming engine. The feedback information reflects actual conditions experienced by the client that has received a media stream.</p>
<p id="p-0023" num="0022">With reference to <figref idref="DRAWINGS">FIG. 2A</figref>, a request <b>120</b> for a media stream is made by the client <b>108</b> and received by the service router <b>104</b>. As is known in the field, communications can be in the form of RTSP messages, which include DESCRIBE, SETUP, PLAY, PAUSE, RECORD, and TEARDOWN messages, see Internet Engineering Task Force (IETF) Request for Comment (RFC) 2326, which is incorporated by reference herein. In an embodiment, the request is in the form of an RTSP DESCRIBE message. An example of an RTSP DESCRIBE message from the client to the service router is as follows:</p>
<p id="p-0024" num="0023">DESCRIBE rtsp://edn.vault.com/content.mov RTSP/1.0</p>
<p id="p-0025" num="0024">CSeq: 1</p>
<p id="p-0026" num="0025">Accept: application/sdp</p>
<p id="p-0027" num="0026">Bandwidth: 384000</p>
<p id="p-0028" num="0027">Accept-Language: en-US</p>
<p id="p-0029" num="0028">User-Agent: QuickTime/7.4.1 (qtver=7.4.1;os=Windows NT 5.1Service Pack 2)</p>
<p id="p-0030" num="0029">Upon receipt of the request, the service router <b>104</b> identifies a set of media streaming engines that could source the requested media stream. For example, the service router identifies three media streaming engines that are able to source the requested media stream, although the exact number of media streaming engines that are identified is implementation specific. The set of media streaming engines could be selected based on various different criteria such as the location of the client and/or media streaming engine, the status of the media streaming engines, and/or load conditions, including network load conditions and/or load conditions of the media streaming engines.</p>
<p id="p-0031" num="0030">In addition to identifying the set of media streaming engines, one of the media streaming engines in the set is selected to be the master session controller for the client request. Media streaming engine A is identified as the master session controller. The master session controller manages the media session for the life of the session. The master session controller may also monitor feedback from participating media streaming engines and propagate the feedback information to the service router. Once the master session controller is identified, the client <b>108</b> is redirected to the master session controller using, for example, a redirect message <b>122</b>, <figref idref="DRAWINGS">FIG. 2A</figref>. In an embodiment, the redirect message also includes an identification of the other media streaming engines in the set of media streaming engines. An example of a redirect message from the service router to the client is as follows:</p>
<p id="p-0032" num="0031">RSTP/1.0 302 Moved Temporarily</p>
<p id="p-0033" num="0032">CSeq: 1</p>
<p id="p-0034" num="0033">Location:</p>
<p id="p-0035" num="0034">Rtsp://MSE-A.se.edn.vault.com/content.mov?race_with=MSE-B,MSE-C</p>
<p id="h-0007" num="0000">In the example redirect message, media streaming engine A, MSE-A, is the master session controller for this stream session and media streaming engines B and C, MSE-B and MSE-C, are the participants for the stream session.</p>
<p id="p-0036" num="0035">Once the redirect message <b>122</b> is received by the client <b>108</b>, the client follows the redirect message and contacts the master session controller to set up the media stream. In an embodiment, the client sends RTSP SETUP and PLAY messages, <b>124</b> <figref idref="DRAWINGS">FIG. 2A</figref>, to the master session controller to set up and play the media stream. The client and/or the media streaming engine may send other RTSP messages to further manage the session. In response to the RTSP SETUP and PLAY messages, the media streaming engine begins to stream digital media to the client, for example, using MPEG2-TS RTP/UDP/IP, represented as media stream <b>126</b> in <figref idref="DRAWINGS">FIG. 2A</figref>. When the RTP protocol is used to stream the digital media to the client, the client generates RTCP RR messages and sends the RTCP RR messages upstream to the media streaming engine. RTCP is fully described in IETF RFC 1889 and 1890, both of which are incorporated by reference herein. The RTCP RR messages include feedback information <b>128</b>, which is indicative of a quality of service experienced by the client. For example, the RTCP RR messages include the highest packet number received, packet loss, inter-arrival jitter, and timestamp information, which is indicative of the actual conditions experienced by the client with respect to the media stream that is sourced by the specific media streaming engine. As such, the feedback information provided by the RTCP RR messages is specific to a media streaming engine and client pair.</p>
<p id="p-0037" num="0036">The media streaming engine <b>102</b> evaluates the feedback information to see if the quality of service is satisfactory. For example, the packet loss and inter-arrival jitter information is compared to respective packet loss and inter-arrival jitter thresholds to see if the thresholds are exceeded. If the quality of service is found to be unsatisfactory, e.g., the packet loss or inter-arrival jitter threshold is exceeded, then the master session controller begins a process of evaluating the other media streaming engines in the set of media streaming engines to see if any of the other media streaming engines can provide a satisfactory quality of service. In an embodiment, the master session controller triggers the other media streaming engines in the set to be evaluated one-by-one to find a media streaming engine that can source the media stream at a satisfactory quality of service. The process of evaluating the other media streaming engines in the set is referred to herein as a &#x201c;race.&#x201d;</p>
<p id="p-0038" num="0037">In an embodiment, the master session controller first checks to see if one of the other media streaming engines <b>102</b>, referred to herein as the &#x201c;next&#x201d; media streaming engine, is available to source the media stream. If the next media streaming engine is available, then the media stream is switched over to the next media streaming engine. In order to make a seamless switch to the next media streaming engine, stream state information is passed to the next media streaming engine so that the media stream can be started at the right point. For example, the current streaming state information is passed on so that the next media streaming engine can start from the correct normal play time (NPT) and use the required synchronization source (SSRC), RTP timestamp, and/or an offset within the media file from which the media stream is sourced.</p>
<p id="p-0039" num="0038">Once the media stream is switched over, the client begins to receive the media stream from the next media streaming engine. <figref idref="DRAWINGS">FIG. 2B</figref> illustrates the system after s the media stream has been switched over to media streaming engine B. In response to the media stream <b>126</b>, the client begins sending RTCP RR messages to the sourcing media streaming engine. As with the first media streaming engine, the sourcing media streaming engine evaluates the feedback information <b>128</b> that is carried in the RTCP RR messages to determine if the quality of service is satisfactory. If the quality of service is satisfactory, the media streaming engine continues to source the media stream. The media streaming engine may also provide the feedback information to the master session controller.</p>
<p id="p-0040" num="0039">If the quality of service is unsatisfactory, the media streaming engine <b>102</b> notifies the master session controller and the master session controller initiates a switch to the next media streaming engine in the set of media streaming engines. <figref idref="DRAWINGS">FIG. 2C</figref> illustrates the system after the media stream has been switched over to media streaming engine C. As with <figref idref="DRAWINGS">FIG. 2B</figref>, the client will send RTCP RR messages, which carry feedback information, to the sourcing media streaming engine. The process can be repeated amongst the media streaming engines in the set of media streaming engines until one of the media streaming engines is found to provide a satisfactory quality of service to the client.</p>
<p id="p-0041" num="0040">Whenever feedback information is received by a media streaming engine, the feedback information is provided to the master session controller. The master session controller in turn provides the feedback information to the service router <b>104</b>, which can use the feedback information to make future media streaming engine selections. The master session controller can pre-process the feedback information before sending the feedback information to the service router and/or the master session controller can provide raw feedback information to the service router.</p>
<p id="p-0042" num="0041">The above-described technique for selecting a media streaming engine involves the collection of feedback information &#x201c;on-the-fly.&#x201d; In an alternative embodiment, feedback information that has already been collected can be used up front by the service router to select a media streaming engine in response to a request. For example, the service router can compare the feedback information from all of the media streaming engines in the set to each other. The media streaming engine that has provided the best quality of service to the client, e.g., as indicated by the packet loss and inter-arrival jitter information, is then selected to source the media stream. The up-front use of previously collected feedback information can speed up the selection of the optimal media streaming engine because the above-described process of collecting and evaluating the feedback information has already been completed. In another embodiment, previously collected feedback information is used in the initial selection of the set of media streaming engines and then subsequently collected feedback information is evaluated as described above to fine tune the media streaming engine selection.</p>
<p id="p-0043" num="0042">The above-described techniques can be used to select media streaming engines on a client-by-client basis or to select media streaming engines on a client subnet basis. For example, feedback information can be applied to select a media streaming engine based on the complete IP address of the client or based on the IP subnet to which the client belongs. In an embodiment, all clients from a certain subnet are treated similarly, e.g., the same media streaming engine is selected to service their requests. Using this technique, the feedback information used to select a media streaming engine for a client is not necessarily feedback information that was generated by the particular client itself</p>
<p id="p-0044" num="0043">Ultimately, the use of feedback information, as provided in the RTCP RR messages, enables the optimal media streaming engine to be selected. In an embodiment, the optimal media streaming engine is the media streaming engine that provides the highest quality of service to the client, where the highest quality of service corresponds to the fewest lost packets and/or the lowest inter-arrival jitter. Although the feedback information is one criterion used in the selection process, other criteria may also be considered in selecting the optimal media streaming engine to source a media stream.</p>
<p id="p-0045" num="0044">Network conditions tend to be very dynamic in nature especially in networks that provide bandwidth intensive services such as media streaming. Because of the dynamic nature of network conditions, in an embodiment, heuristic information is generated from the feedback information and the heuristic information is used to select media streaming engines. For example, heuristic information may be collected on a subnet basis to characterize the quality of service experienced by the subnet on a per-time interval basis, e.g., per hour of the day or per day of the week basis.</p>
<p id="p-0046" num="0045">The master session controller and the media streaming engines may communicate with each other using, for example, RTSP messages. In an embodiment, the master session controller uses RTSP SETUP/PLAY messages with header extensions to initiate and manage the switching between media streaming engines, i.e., the race. Additionally, the media streaming engines may use RTSP ANNOUNCE/SET_PARAMETER messages to send feedback information to the master session controller.</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 3</figref> is a process flow diagram of a method for selecting a media streaming engine to source a media stream to a client. At block <b>170</b>, RTCP RR messages, which include feedback information that is indicative of a quality of service experienced by a client, are received. At block <b>172</b>, a media streaming engine is selected from a set of media streaming engines to source a media stream to a client in response to the feedback information. In this embodiment, the feedback information is not necessarily generated by the same client that has made the request.</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 4</figref> is a process flow diagram of another method for selecting a media streaming engine to source a media stream to a client. At block <b>174</b>, a request for a media stream is received. At block <b>176</b>, a set of media streaming engines is identified, for example a set of N media streaming engines is identified. At block <b>178</b>, one of the media streaming engines is selected as the master session controller for the media stream. At block <b>180</b>, the media stream is sourced to the client from the master session controller. At block <b>182</b>, feedback information, e.g., in the form of RTCP RR messages, is received. At decision point <b>184</b>, the feedback information is used to determine if the quality of service experienced by the client is satisfactory. If the quality of service experienced by the client is unsatisfactory, then at block <b>186</b>, the media stream is switched to a different media streaming engine in the set of media streaming engines and the process returns to block <b>182</b>. On the other hand, if the quality of service experienced by the client is satisfactory, then at block <b>188</b>, the media stream continues to be sourced by the same media streaming engine and the process returns to block <b>182</b>.</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 5</figref> is a functional block diagram of an embodiment of the service router <b>104</b> depicted in FIGS. <b>1</b> and <b>2</b>A-<b>2</b>C. The service router includes a selection engine <b>190</b>, a topology map <b>192</b>, and a heuristics database <b>194</b>. The selection engine is configured to implement a selection process as described above, the topology map includes location information on the media streaming engines, and the heuristics database includes heuristic information that is generated from the feedback information received from the clients.</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 6</figref> is a functional block diagram of an embodiment of the media streaming engines <b>104</b> depicted in FIGS. <b>1</b> and <b>2</b>A-<b>2</b>C. The media streaming engine includes stream servers <b>110</b> and a session controller <b>196</b>. As described above, when a particular media streaming engine is designated as the master session controller, the session controller <b>196</b> carries out the above-described master session controller functions.</p>
<p id="p-0051" num="0050">In an embodiment, algorithms may be implemented to achieve time-smoothing in order to extract the relative goodput to be obtained by the different stream servers over the time scale of streaming sessions. That is, an algorithm may be implemented to ensure that the switching of stream servers is not too reactive to short term changes in the feedback information. For example, it may be desirable to damp short-term spikes/changes in the feedback information, while not over-weight long-term averages that don't correspond to the current load distribution.</p>
<p id="p-0052" num="0051">In an embodiment of a smoothing algorithm, a Feedback Processing Interval is defined as the interval, N, over which the feedback information from the clients is aggregated/normalized and a Tolerance Threshold is defined as a value, which when exceeded, makes the feedback unsatisfactory. According to the algorithm, over the Feedback Processing Interval N, a running score is started. The running score gets modified every time an RTCP RR message is received from a client. RTCP RR messages having feedback information that exceeds the Tolerance Threshold causes the running score to be decremented by a value, D, and RTCP RR messages having feedback information that is within the Tolerance Threshold causes the running score to be incremented by a value, I. At the end of the Feedback Processing Interval, N, the running score is inspected and if the running score is greater than or equal to zero, then the streaming experience is considered satisfactory and if the running score is less than zero, the streaming experience is considered unsatisfactory. Although one example of a smoothing algorithm is described, other smoothing algorithms may be implemented.</p>
<p id="p-0053" num="0052">In another embodiment, an algorithm may be implemented to filter out loss and/or jitter that is independent of stream server selection from the loss and/or jitter that is different from different stream servers, under the time horizon constraints above.</p>
<p id="p-0054" num="0053">At least some of the operations of the above-described techniques may be implemented using software instructions stored on a computer useable storage medium for execution by a computer. As an example, an embodiment of a computer program product includes logic encoded in one or more tangible media for execution and when executed, causes the computer to perform operations, as described above.</p>
<p id="p-0055" num="0054">Embodiments of the above-described technique can take the form of an entirely hardware embodiment, an entirely software embodiment, or an embodiment containing both hardware and software elements. In one embodiment, the above-described technique is implemented in software, which includes but is not limited to firmware, resident software, microcode, etc.</p>
<p id="p-0056" num="0055">Furthermore, embodiments of the above-described technique can take the form of a computer program product accessible from a computer-usable or computer-readable storage medium providing program code for use by or in connection with a computer or any instruction execution system. For the purposes of this description, a computer-usable or computer readable storage medium can be any apparatus that can store the program for use by or in connection with the instruction execution system, apparatus, or device.</p>
<p id="p-0057" num="0056">The computer-useable or computer-readable storage medium can be an electronic, magnetic, optical, electromagnetic, infrared, or semiconductor system (or apparatus or device), or a propagation medium. Examples of a computer-readable storage medium include a semiconductor or solid state memory, magnetic tape, a removable computer diskette, a random access memory (RAM), a read-only memory (ROM), a rigid magnetic disk, and an optical disk. Current examples of optical disks include a compact disk with read only memory (CD-ROM), a compact disk with read/write (CD-R/W), a digital video disk (DVD), and high-definition (HD) disks such as Blu-Ray and HD-DVD.</p>
<p id="p-0058" num="0057">An embodiment of a data processing system suitable for storing and/or executing program code includes at least one processor coupled directly or indirectly to memory elements through a system bus such as a data, address, and/or control bus. The memory elements can include local memory employed during actual execution of the program code, bulk storage, and cache memories which provide temporary storage of at least some program code in order to reduce the number of times code must be retrieved from bulk storage during execution.</p>
<p id="p-0059" num="0058">Although specific embodiments of the invention have been described and illustrated, the invention is not to be limited to the specific forms or arrangements of parts as described and illustrated herein. The invention is limited only by the claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for selecting a media streaming engine to source a media stream to a client, the method comprising:
<claim-text>accumulating, at a service router, historical Real-Time Control Protocol (RTCP) Receiver Report (RR) messages wherein the RTCP RR messages contain feedback information related to at least one of packet loss and inter- arrival jitter;</claim-text>
<claim-text>receiving a request from a client for a media stream;</claim-text>
<claim-text>selecting a set of media streaming engines, to source the media stream to the client;</claim-text>
<claim-text>selecting a master controller from the set of media streaming engines in response to at least one of the packet loss and the inter-arrival jitter as contained in the the accumulated RTCP RR messages;</claim-text>
<claim-text>redirecting the client to the master controller to begin a media streaming session;</claim-text>
<claim-text>receiving at the master controller a feedback information from the client; and</claim-text>
<claim-text>evaluating, by the master controller, the feedback information received from the client, wherein evaluating the feedback information comprises:
<claim-text>determining a feedback processing interval and a tolerance threshold, and</claim-text>
<claim-text>creating a score for the feedback processing interval, wherein the feedback score is decremented by one if the feedback information is below the tolerance threshold and is incremented by one otherwise.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>evaluating the score at the end of the feedback processing interval and determining if a quality of service is satisfactory; and</claim-text>
<claim-text>if the quality of service is unsatisfactory, sourcing the media stream from a next media streaming engine in the set of the media streaming engines and evaluating feedback information related to the media stream sourced by the next media streaming engine.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising:
<claim-text>if the quality of service is unsatisfactory from all of the media streaming engines in the set of media streaming engines, comparing the evaluated feedback information from all of the media streaming engines to each other; and</claim-text>
<claim-text>selecting the media streaming engine in response to the comparison of the feedback information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein evaluating feedback information related to the media stream sourced by the next media streaming engine comprises initiating by the master controller collection of feedback information related to the next media streaming engine in the set of media streaming engines.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref> further comprising passing stream state information to the next media streaming engine so that the media stream can be started at a correct normal playtime (NPT).</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein determining if the quality of service is satisfactory comprises determining the quality of service satisfactory if the feedback score is above a predetermined value.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein selecting the set of media streaming engines comprises selecting a set of media streaming engines in response to a topology map that indicates a mapping between client subnets or locations and available media streaming engines.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein selecting the master controller comprises selecting the master controller on a client subnet basis such that clients from a certain subnets are serviced by the same master controller.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising the master controller and the media streaming engines communicating with each other using RTSP messages.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein determining the feedback processing interval comprises determining the feedback processing interval to damp short-term spikes and changes in the feedback information.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein determining the feedback processing interval comprises determining the feedback processing interval to not over weight long term averages that do not correspond to a current load distribution.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein determining the tolerance threshold comprises determining a minimum value of at least one of: highest packet number received, packet loss, timestamp information, and inter-arrival jitter.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein selecting the set of media streaming engines, comprises:
<claim-text>determining a subnet associated with the client; and</claim-text>
<claim-text>determining the set of media streaming engines based on accumulated feedback information for the subnet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein selecting the master controller comprises selecting the master controller based on a heuristic information, the heuristic information being generated from the feedback information, wherein the heuristic information is generated on a subnet basis to characterize a quality of service experienced by the subnet on a predetermined time interval basis.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A method for selecting a media streaming engine to source a media stream to a client, the method comprising:
<claim-text>sourcing media streams to a first client from multiple different media streaming engines;</claim-text>
<claim-text>receiving feedback information that indicates a quality of service experienced by the first client related to each of the media streams that is sourced from the multiple different media streaming engines, wherein the feedback information is media streaming engine-specific and wherein the feedback information is provided in Real-Time Control Protocol (RTCP) Receiver Report (RR) messages that contain feedback information related to at least one of packet loss and inter-arrival jitter;</claim-text>
<claim-text>receiving a request from a second client for a media stream;</claim-text>
<claim-text>selecting a media streaming engine, from the multiple different media streaming engines, to source the media stream to the second client in response to the previously received media streaming engine-specific feedback information;</claim-text>
<claim-text>redirecting the second client to the selected media streaming engine to begin a media streaming session;</claim-text>
<claim-text>receiving at the selected media streaming engine a feedback information from the second client; and</claim-text>
<claim-text>evaluating the feedback information received from the second client wherein evaluating the feedback information comprises:
<claim-text>determining a feedback processing interval and a tolerance threshold, and</claim-text>
<claim-text>creating a score for the feedback processing interval, wherein the score is decremented by one if the feedback information is below the tolerance threshold and is incremented by one otherwise.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein selecting a media streaming engine further comprises an initial step of selecting a set of media streaming engines.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein selecting the set of media streaming engines comprises selecting the set of media streaming engines in response to a topology map that indicates the mapping between at least one of: second client subnets and second client locations, and available media streaming engines.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method of <claim-ref idref="CLM-00016">claim 16</claim-ref> further comprising selecting one of the media streaming engines as a master session controller, wherein the master session controller initiates the collection of feedback information related to the other media streaming engines in the set of media streaming engines.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. A system for selecting a media streaming engine to source a media stream to a client, the apparatus comprising:
<claim-text>a processor and memory configured to implement a service router that collects feedback information for a plurality of media streaming engines, wherein the feedback information is received by the media streaming engines from clients, and wherein the feedback information is provided from the clients in Real-Time Control Protocol (RTCP) Receiver Report (RR) messages and wherein the RTCP RR messaged contain feedback information related to at least one of packet loss and inter-arrival jitter, the service router having a selection engine configured to:</claim-text>
<claim-text>receive a request from a client to source a media stream;</claim-text>
<claim-text>use the previously collected feedback information, including at least one of the packet loss and the inter-arrival jitter as contained in the RTCP RR messages, to select a media streaming engine to source the media stream to the client; and</claim-text>
<claim-text>redirect the client to the selected media streaming engine to begin a media streaming session, wherein the selected streaming media engine is configured to:
<claim-text>receive a feedback information from the client;</claim-text>
<claim-text>evaluate the feedback information wherein evaluating the feedback information comprises:
<claim-text>determine a feedback processing interval and a tolerance threshold, and</claim-text>
<claim-text>create a score for the feedback processing interval, wherein the score is decremented by one if the feedback information is below the tolerance threshold and is incremented by one otherwise.</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The system of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the selected media streaming engine is further configured to:
<claim-text>evaluate the score at the end of the feedback processing interval and determining if a quality of service is satisfactory;</claim-text>
<claim-text>if the quality of service is unsatisfactory, source the media stream from a next media streaming engine in a set of the media streaming engines; and</claim-text>
<claim-text>evaluate feedback information related to the media stream sourced by the next media streaming engine. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
