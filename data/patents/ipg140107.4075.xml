<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625144-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625144</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12696206</doc-number>
<date>20100129</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2009-021947</doc-number>
<date>20090202</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>1015</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>15</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>358  116</main-classification>
<further-classification>358  19</further-classification>
<further-classification>358  113</further-classification>
<further-classification>358  114</further-classification>
<further-classification>358  115</further-classification>
<further-classification>358  118</further-classification>
<further-classification>713  1</further-classification>
<further-classification>713  2</further-classification>
<further-classification>713100</further-classification>
<further-classification>719321</further-classification>
<further-classification>709221</further-classification>
</classification-national>
<invention-title id="d2e71">Apparatuses and methods for switching between printing apparatuses</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6661530</doc-number>
<kind>B1</kind>
<name>Munetomo et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  115</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2005/0157315</doc-number>
<kind>A1</kind>
<name>Kato</name>
<date>20050700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  11</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2006/0072140</doc-number>
<kind>A1</kind>
<name>Mitani</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  113</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2008/0180741</doc-number>
<kind>A1</kind>
<name>Miyata</name>
<date>20080700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  115</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2008/0307212</doc-number>
<kind>A1</kind>
<name>Asano</name>
<date>20081200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713  1</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2009/0109487</doc-number>
<kind>A1</kind>
<name>Tsukada</name>
<date>20090400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  116</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2009/0147290</doc-number>
<kind>A1</kind>
<name>Tomita</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  19</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>JP</country>
<doc-number>H8-147118</doc-number>
<kind>A</kind>
<date>19960600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>JP</country>
<doc-number>09-146731</doc-number>
<kind>A</kind>
<date>19970600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>JP</country>
<doc-number>2009-015798</doc-number>
<kind>A</kind>
<date>20090100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00011">
<othercit>Office Action for Counterpart Japanese Application No. 2009-021947, dated Dec. 18, 2012.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>7</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>11</number-of-drawing-sheets>
<number-of-figures>13</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20100195132</doc-number>
<kind>A1</kind>
<date>20100805</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Takashima</last-name>
<first-name>Keiichi</first-name>
<address>
<city>Kawasaki</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Takashima</last-name>
<first-name>Keiichi</first-name>
<address>
<city>Kawasaki</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Carter, DeLuca, Farrell &#x26; Schmidt LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Canon Kabushiki Kaisha</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Cato</last-name>
<first-name>Miya J</first-name>
<department>2676</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A storage medium for storing a program that switches a plurality of printing apparatuses by changing a port of a logical printer for printout and is executed by a computer having a storage unit configured to associate the port with device settings for storing it, the computer comprising a reflecting unit configured to acquire the stored device settings corresponding to the changed port to reflect the stored device settings in the device settings held by the logical printer if the port is changed; and a changing unit configured to change print settings so as not to be inconsistent with the device settings to be reflected by the reflecting unit.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="221.74mm" wi="175.09mm" file="US08625144-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="258.49mm" wi="189.65mm" file="US08625144-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="231.73mm" wi="174.16mm" file="US08625144-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="250.78mm" wi="186.01mm" file="US08625144-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="225.04mm" wi="152.65mm" orientation="landscape" file="US08625144-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="136.65mm" wi="165.95mm" file="US08625144-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="258.49mm" wi="160.87mm" file="US08625144-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="257.98mm" wi="177.80mm" file="US08625144-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="222.00mm" wi="133.10mm" orientation="landscape" file="US08625144-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="215.31mm" wi="170.60mm" orientation="landscape" file="US08625144-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="262.04mm" wi="183.98mm" file="US08625144-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="94.06mm" wi="111.00mm" file="US08625144-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates to a storage medium that stores a program for switching a printing apparatus which executes printing, a print control apparatus, and a print control method.</p>
<p id="p-0004" num="0003">2. Description of the Related Art</p>
<p id="p-0005" num="0004">In many OSs (Operation Systems) such as Windows (registered trademark) by Microsoft Corp. and Mac OS (registered trademark) by Apple Inc., a printer driver mechanism is available for controlling a printing apparatus from application software. When a user installs a printer driver, which corresponds to the model of a printing apparatus for printout, on the OS, the printing apparatus can provide a printout from any application software corresponding to the printing I/F (interface) of the OS.</p>
<p id="p-0006" num="0005">In general, a plurality of printer drivers can be installed on the same OS simultaneously, and a plurality of printing apparatuses can be controlled without restarting the application software. Conventionally, the printer drivers are available for each model of the printing apparatus. Naturally, by using a correct printer driver corresponding to the printing apparatus, printing can be carried out correctly and model-specific functions can be used. However, in a system having several types of printing apparatuses that have been introduced into an office environment, a system administrator manages all printer drivers that are independently installed by each client, resulting in a great burden on the system administrator.</p>
<p id="p-0007" num="0006">An example of a burden on the system administrator includes an operation validation by installing/uninstalling a printer driver. In other words, when a part of the printing apparatuses is switched to a new model, the system administrator is to validate whether a trouble occurs in the operation of the existing printer driver when a printer driver for a new printer model is additionally installed on the OS on which a printer driver for a different printer model has already been installed. Installation into a system cannot be decided as long as no trouble in the operation of the existing printer is validated. Also, when the operation screen is different for each printer driver, a system operation manual directed to a user is to be updated.</p>
<p id="p-0008" num="0007">In order to reduce such a burden on the system administrator, a printer driver referred to as generic printer driver (or universal printer driver) has been developed. The generic printer driver is characterized in that it does not correspond to model-specific special functions but corresponds to general functions and broader models. By using the generic printer driver, the printer driver to be installed by each client can be combined into a single type. As a result, there is no need to worry about the occurrence of any trouble due to the installation of a plurality of printer drivers. Furthermore, in the case of a model change, the printer driver already installed hitherto can be used as is.</p>
<p id="p-0009" num="0008">Such a generic printer driver also improves the printing environment on a mobile PC (Personal Computer). For example, consider the case where an employee who comes and goes between a plurality of offices makes a printout on a printing apparatus connected to the office's network from a notebook PC that which the employee carries. Conventionally, different types of printer drivers are installed at different offices for separate use. However, it is cumbersome to properly select and use a driver from a plurality of printer drivers. Thus, when the generic printer driver is used, a single printer driver can switch a printing apparatus of a port for printout. For example, the Universal Printer Driver by Hewlett-Packard Company displays the setting screen for each print job so as to specify the output printer.</p>
<p id="p-0010" num="0009">However, print settings is to be reset so as not to use the functions which the printing apparatus does not have, whenever the printing apparatus to be output is switched. For example, when the printing apparatus is switched from a printing apparatus having a stapling function to a printing apparatus not having the stapling function, the stapling function is to be reset to &#x201c;OFF&#x201d;. Otherwise, a print control command and a drawing command, which are incompatible with the printing apparatus, may be executed, resulting in printing errors and unintended print results.</p>
<p id="p-0011" num="0010">Thus, a technique to switch print settings for solving these situations has been proposed (e.g., see Japanese Patent Laid-Open No. 8-147118). In this technique, print setting information, which has been initialized for each application software, is firstly registered for each application name. Then, when a printer driver is activated by a print request instruction from that application, if the application name has already been registered, the registered print setting information is invoked so as to display the print setting screen. If the application name has not been registered, the default print setting information is displayed on the print setting screen. By applying this technique to the printing apparatus, the print settings, which have been initially set for each printing apparatus, can be invoked for printout.</p>
<p id="p-0012" num="0011">However, in the technique disclosed in Japanese Patent Laid-Open No. 8-147118, print setting information, which has been set before switching the printing apparatus for printout, may be deleted, thereby causing the situation in resetting the initially-registered print settings back to its original print settings.</p>
<p id="p-0013" num="0012">Not only print settings but also settings (hereinafter referred to as &#x201c;device settings&#x201d;) to be performed for each device, such as optional equipment configuration connected to the printing apparatus and various passwords is to be reset for each switch of the apparatus to be output. Although optional equipment configuration can be automatically reset when a configuration information acquire function is used, the load on the network and the printing apparatus may increase, and such configuration information may not be acquired when the network carries out one-way communication. In addition, a security situation may arise if a password can be readily acquired from the printing apparatus. Hence, in general, a password cannot be acquired from the printing apparatus.</p>
<p id="p-0014" num="0013">The present invention is directed to enable the output destination printing apparatus to be switched in a smooth manner without requiring any laborious setting of the printing apparatus when the printing apparatus to be output is switched.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0015" num="0014">The present invention provides a storage medium for storing a program that switches a plurality of printing apparatuses by changing a port of a logical printer for printout and is executed by a computer having a storage unit configured to associate the port with device settings for storing it, the storage medium that stores the program for the functioning of the computer includes a reflecting unit configured to acquire the stored device settings corresponding to the changed port to reflect the stored device settings in the device settings held by the logical printer if the port is changed; and a changing unit configured to change print settings so as not to be inconsistent with the device settings to be reflected by the reflecting unit.</p>
<p id="p-0016" num="0015">Further features of the present invention will become apparent from the following description of exemplary embodiments with reference to the attached drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 1</figref> is a view showing a configuration of a printing system including the print control apparatus according to the first embodiment.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram showing the functional structure of a host computer <b>300</b>.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram showing an example of a port setting screen.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 4</figref> is a diagram showing an example of a device setting screen.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 5</figref> is a view for explaining an outline of print control processing performed by the host computer <b>300</b>.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram showing the detailed configuration of a port change section <b>501</b>.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 7</figref> is a flowchart diagram showing print control processing according to the first embodiment.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 8</figref> is a flowchart diagram showing the procedure for port history store processing (step S<b>601</b>) according to the first embodiment.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 9</figref> is a flowchart diagram showing the procedure for device setting change processing according to the first embodiment.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 10</figref> is a view for illustrating a trouble occurring during port change.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 11</figref> is a view for explaining an outline of print control processing according to the second embodiment.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 12</figref> is a flowchart diagram showing the procedure for print control processing according to the second embodiment.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 13</figref> is a flowchart diagram showing the procedure for print setting change processing according to the second embodiment.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF THE EMBODIMENTS</heading>
<p id="p-0030" num="0029">Hereinafter, the best mode for carrying out the invention will now be described with reference to the accompanying drawings.</p>
<p id="h-0005" num="0000">(First Embodiment)</p>
<p id="h-0006" num="0000">&#x3c;System Configuration&#x3e;</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 1</figref> is a view showing a configuration of a printing system including the print control apparatus according to the first embodiment. The printing system includes a printer <b>150</b> (printing apparatus) that executes print processing, and a host computer <b>300</b> (print control apparatus) that controls the printer <b>150</b>. The OS used in the present embodiment shall be compliant with the printing system for Windows (registered trademark) by Microsoft Corp. Unless otherwise specified, it goes without saying that the present invention can be applied within the scope that can achieve the purpose of the present invention. More specifically, although the printer <b>150</b> and the host computer <b>300</b> are merely shown in <figref idref="DRAWINGS">FIG. 1</figref> for reasons of space limitation, the respective equipment can be provided in plural number. The printing system may also be a system in which the respective equipment is mutually connected through a network such as LAN, WAN, or the like for processing.</p>
<p id="p-0032" num="0031">In <figref idref="DRAWINGS">FIG. 1</figref>, the host computer <b>300</b> includes a CPU <b>1</b> that executes image processing on documents including a combination of graphics, images, characters, tables (including spreadsheets), and the like on the basis of a document processing program and the like stored in a program ROM constituting a ROM <b>3</b> or an external memory <b>11</b>. Furthermore, the CPU <b>1</b> integrally controls each of the devices connected to a system bus <b>4</b>.</p>
<p id="p-0033" num="0032">The program ROM constituting the ROM <b>3</b> or the external memory <b>11</b> stores an operating system (hereinafter referred to as &#x201c;OS&#x201d;), which is the control program of the CPU <b>1</b>, or the like. A font ROM constituting the ROM <b>3</b> or the external memory <b>11</b> stores font data or the like to be used for performing the document processing described above. A data ROM constituting the ROM <b>3</b> or the external memory <b>11</b> stores various data to be used for the image processing described above, or the like.</p>
<p id="p-0034" num="0033">A RAM <b>2</b> functions as a main memory, a work area, or the like of the CPU <b>1</b>. A keyboard I/F (interface) <b>5</b> controls the key input from a keyboard <b>9</b> and a pointing device (not shown). A display I/F <b>6</b> controls the display of a display <b>10</b>. An external memory I/F <b>7</b> controls the access to and from the external memory <b>11</b> such as a hard disc (HD), a flexible disc (FD), or the like. The external memory <b>11</b> stores a boot program, various applications, font data, user files, edit files, printer drivers for realizing functionalities shown in <figref idref="DRAWINGS">FIG. 2</figref> to be described below, and the like. A printer I/F <b>8</b> is connected to the printer <b>150</b> through a predetermined bi-directional interface <b>22</b> to execute communication control processing with the printer <b>150</b>.</p>
<p id="p-0035" num="0034">The CPU <b>1</b> executes, for example, outline-font expansion (rasterization) processing into a display information RAM, which is set in the RAM <b>2</b>, and provides WYSIWYG (what you see is what you get) on the display <b>10</b>. Also, the CPU <b>1</b> opens various registered windows, and executes various data processing based on the commands instructed by a mouse cursor (not shown), or the like, on the display <b>10</b>.</p>
<p id="p-0036" num="0035">When printing application-generated information, a user opens a user interface for configuring settings to the information on the display <b>10</b>, and the user performs the settings for the printer <b>150</b> and a selection of print mode. At this time, the user can carry out the settings of various print processing methods through the user interface provided by the printer driver.</p>
<p id="p-0037" num="0036">On the other hand, the printer <b>150</b> also controls each of the devices provided therein. The CPU <b>12</b> outputs an image signal as output information to a print section (printer engine) <b>19</b> connected to a system bus <b>15</b> through a print section I/F <b>17</b> based on the control program and the like stored in a program ROM constituting a ROM <b>14</b> or the control program and the like stored in an external memory <b>21</b>. The program ROM constituting the ROM <b>14</b> stores a control program and the like of the CPU <b>12</b>. A font ROM constituting the ROM <b>14</b> stores font data and the like to be used when the above-described output information is generated. Also, a data ROM constituting the ROM <b>14</b> stores information and the like to be used in a host computer when a printer does not have the external memory <b>21</b> such as a hard disk or the like.</p>
<p id="p-0038" num="0037">The CPU <b>12</b> is capable of performing bi-directional communication processing with the host computer <b>300</b> through an input section <b>16</b>, and is capable of notifying the host computer <b>300</b> about information and the like in the printer <b>150</b>. Here, information includes a printer engine status, network setting information, device name, resource name, and the like. A RAM <b>13</b> functions as a main memory, a working area, and the like of the CPU <b>12</b>, and the memory capacity thereof can be expanded by an optional RAM connected to an expansion port (not shown). In this regard, the RAM <b>13</b> is used for an output information expansion area, environment data storage area, an NVRAM (Non-Volatile RAM), and the like.</p>
<p id="p-0039" num="0038">The external memory <b>21</b> such as a hard disk (HD), an IC card, or the like is access-controlled by an external memory I/F <b>18</b>. The external memory <b>21</b> is connected as an option, and stores font data, an emulation program(s), and the like. Note that the external memory <b>21</b> is not limited to a single device. At least one or more of the external memories <b>21</b> may be included, and a plurality of optional font cards and external memories storing programs which interpret printer control languages for different language systems may be connected in addition to the internal fonts.</p>
<p id="p-0040" num="0039">Furthermore, the printer <b>150</b> may include an NVRAM, and printer-mode setting information from an operation section <b>20</b> may be stored there. A switch, an LED display, and the like for use in operation are disposed in the operation section <b>20</b>.</p>
<p id="h-0007" num="0000">&#x3c;Function of Host Computer&#x3e;</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram showing the functional structure of the host computer <b>300</b>. In the present embodiment, the CPU <b>1</b> executes a program module to be described below to perform various print processes. Components having functions equivalent to those in <figref idref="DRAWINGS">FIG. 1</figref> are represented by the same reference numerals.</p>
<p id="p-0042" num="0041">In <figref idref="DRAWINGS">FIG. 2</figref>, an application <b>201</b>, a graphic engine <b>202</b>, a printer driver <b>203</b>, and a system spooler <b>204</b> are present as files stored in the external memory <b>11</b>. These are program modules that are loaded into the RAM <b>2</b> by the module itself using an OS and the module, and they are executed by the CPU <b>1</b>.</p>
<p id="p-0043" num="0042">The application <b>201</b> and the printer driver <b>203</b> can be stored in a hard disc (HD) that functions as the external memory <b>11</b> through a FD, a CD-ROM (not shown), or a network (not shown). The application <b>201</b> stored in the external memory <b>11</b> is loaded into the RAM <b>2</b> and executed by the CPU <b>1</b>. Note that the application <b>201</b> and the printer driver <b>203</b> may be installed in the external memory <b>11</b> after the download from a server apparatus (not shown) to the host computer <b>300</b> through a network.</p>
<p id="p-0044" num="0043">When printing is performed from the application <b>201</b> to the printer <b>150</b>, output (drawing) is performed by using the graphic engine <b>202</b> which has been loaded into the RAM <b>2</b> and which has become executable.</p>
<p id="p-0045" num="0044">The graphic engine <b>202</b> manages a plurality of logical printers <b>207</b>. The logical printer refers to a virtual output destination of print data specified by the application <b>201</b>. The logical printer <b>207</b> holds port settings <b>208</b>, driver information <b>209</b>, device settings <b>210</b>, default print settings <b>211</b>, and the like.</p>
<p id="p-0046" num="0045">The port settings <b>208</b> includes information regarding the name and the type of the interface <b>22</b> (port) connected to the printer <b>150</b>. There are several types of ports, such as serial ports, parallel ports, USB ports, TCP/IP ports, and each port is attached to a port name which is capable of unique identification, such as COM1, LPT1, USB001, or 192.168.0.1.</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram showing an example of a port setting screen. This port setting screen is displayed, for example, on the display <b>10</b>. In <figref idref="DRAWINGS">FIG. 3</figref>, when the printer property of the logical printer <b>207</b> is displayed and the port tab <b>301</b> is selected, this port setting screen is displayed. The port to be connected to the printer <b>150</b> is set by selecting any one of port names from the port list <b>302</b>. When an operator wants to connect to a port not present on the list, the operator pushes an add port button <b>303</b>, an add port screen (not shown) is displayed, and the port can thereby be added on the list. When the operator pushes a delete port button <b>304</b>, the selected port can be deleted from the list. Finally, the operator specifies the port, pushes an OK button <b>305</b>, and the port settings are thereby established.</p>
<p id="p-0048" num="0047">The driver information <b>209</b> includes information such as the driver name and driver version that can uniquely specify the printer driver <b>203</b> to be used.</p>
<p id="p-0049" num="0048">The device settings <b>210</b> denote setting information unique to the printer <b>150</b> which is the output destination, and include information such as optional equipment configuration that is obtainable from the printer <b>150</b> and information such as a password that is not obtainable from the printer <b>150</b>.</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 4</figref> is a diagram showing an example of a device setting screen. This device setting screen is also displayed on the display <b>10</b>. In <figref idref="DRAWINGS">FIG. 4</figref>, when the printer property of the logical printer <b>207</b> is displayed and the port tab <b>401</b> is selected, this port setting screen is displayed. Here, a device option is set by checking a staple check box <b>402</b>. Also, the ID and password settings dependent on a predetermined device are performed by checking a department management setting box <b>403</b>. After various settings are completed, the operator pushes an OK button <b>404</b>, and the device settings are thereby established. Note that the device settings are set in advance before the application <b>201</b> executes print processing.</p>
<p id="p-0051" num="0050">The default print settings <b>211</b> are the initial values for print settings to be used by the application <b>201</b>. The application <b>201</b> acquires the default print settings <b>211</b>, and passes print settings <b>212</b>, which have been changed appropriately depending on print processing conditions to be performed, to the graphic engine <b>202</b>. By setting the default print settings <b>211</b> to be used as the normally used settings, the task of changing the default print settings <b>211</b> by the application <b>201</b> each time can be eliminated.</p>
<p id="p-0052" num="0051">Also, the consistency of the default print settings <b>211</b> with the changed device settings <b>210</b> is checked by the printer driver <b>203</b> when the device settings <b>210</b> are changed. If inconsistent combinations of set values exist, the default print settings <b>211</b> are changed into set values that are consistent with each other. For example, when a device setting value is set such that a staple finisher is not connected, the print settings in a &#x201c;staple ON&#x201d; mode are inconsistent. Hence, the print settings are changed into a &#x201c;staple OFF&#x201d; mode after a consistency check. Changing to the set values that have been made consistent by performing a consistency check is also referred to as &#x201c;rounding&#x201d;.</p>
<p id="p-0053" num="0052">The application <b>201</b> specifies the logical printer <b>207</b> as the output destination during printing. Then, the graphic engine <b>202</b> refers to the driver information <b>209</b> of the specified logical printer <b>207</b> and determines the printer driver <b>203</b> to be used so as to load the printer driver <b>203</b> from the external memory <b>11</b> into the RAM <b>2</b>. The output of the graphic engine <b>202</b> and the application <b>201</b> is set to the printer driver <b>203</b>. In addition, the graphic engine <b>202</b> receives the print settings <b>212</b> or print data from the application <b>201</b>, outputs it as print data to the printer driver <b>203</b>.</p>
<p id="p-0054" num="0053">The graphic component <b>205</b> of the printer driver <b>203</b> receives print data from the graphic engine <b>202</b>, and converts print data into a control command recognizable by the printer <b>150</b>, e.g., PDL (Page Description Language) data. The printer control command, which has been converted by the graphic component <b>205</b>, passes through the system spooler <b>204</b> loaded by the OS to the RAM <b>2</b>, and is output as print data to the printer <b>150</b> through the interface <b>22</b>.</p>
<p id="p-0055" num="0054">A UI (user interface) component <b>206</b> receives the print settings <b>212</b> from the graphic engine <b>202</b>, displays and changes the print settings <b>212</b>, and notifies the application <b>201</b> about the results through the graphic engine <b>202</b>. The UI (user interface) component <b>206</b> is one of the modules of the printer driver <b>203</b>.</p>
<p id="h-0008" num="0000">&#x3c;Outline of Print Control Processing&#x3e;</p>
<p id="p-0056" num="0055">Next, an outline of print control processing will be described. <figref idref="DRAWINGS">FIG. 5</figref> is a view for explaining an outline of print control processing performed by the host computer <b>300</b>. Components having functions equivalent to those in <figref idref="DRAWINGS">FIG. 2</figref> are represented by the same reference numerals.</p>
<p id="p-0057" num="0056">In the present embodiment, the printer driver <b>203</b> includes the port change section <b>501</b>. When a user specifies the logical printer <b>207</b> from the application <b>201</b> to order printing, print data is output from the graphic engine <b>202</b> to the printer driver <b>203</b> corresponding to the driver information <b>209</b>. When the printer driver <b>203</b> receives print data from the graphic engine <b>202</b>, the port change section <b>501</b> displays the port setting screen shown in <figref idref="DRAWINGS">FIG. 3</figref> on the display <b>10</b>, and the user specifies the output destination. When the user specifies the change in output destination from the printer <b>150</b> to the printer <b>150</b><i>a</i>, the port change section <b>501</b> changes the port settings <b>208</b> of the logical printer <b>207</b>. As a result, print data from the printer driver <b>203</b> is output to the printer <b>150</b><i>a. </i></p>
<p id="p-0058" num="0057">The port change section <b>501</b> stores a port history <b>502</b> in the RAM <b>2</b> (storage unit) for management. The port history <b>502</b> is composed of port settings <b>503</b> and device settings <b>504</b>. The port settings <b>503</b> denote information equivalent to the port settings <b>208</b> of the logical printer <b>207</b>. The device settings <b>504</b> denote information equivalent to the device settings <b>210</b> of the logical printer <b>207</b>. Device settings corresponding to each port are stored. For example, port A stores the device settings corresponding to the device on the port A, and port B stores the device settings corresponding to the device on the port B. The port change section <b>501</b> stores the port settings <b>208</b> and the device settings <b>210</b> of the logical printer <b>207</b> in the form of a history when a port change is made. The stored port history <b>502</b> is read by the port change section <b>501</b> when the port is changed to the same port, and restores the device settings <b>504</b> to the device settings <b>210</b> of the logical printer <b>207</b>. The restored device settings <b>210</b> may be inconsistent with the default print settings <b>211</b> that have already been set and the print settings <b>212</b> that have been passed to the printer driver <b>203</b>. Hence, the port change section <b>501</b> checks their consistency. When inconsistent combinations of set values exist as a result of the consistency check, the restored device settings <b>210</b> are changed into set values that are consistent with each other. The port history <b>502</b> is held for each printer driver, and shared between the logical printers that are associated with the same printer driver. Hence, once a printing apparatus has been used as the output destination for a logical printer, such a printing apparatus can use the port history even if the printing apparatus has never been used as the output destination for the other logical printer.</p>
<p id="h-0009" num="0000">&#x3c;Detailed Configuration of Port Change Section <b>501</b>&#x3e;</p>
<p id="p-0059" num="0058">Next, the detailed configuration of the port change section <b>501</b> will be described. <figref idref="DRAWINGS">FIG. 6</figref> is a block diagram showing the detailed configuration of the port change section <b>501</b>. The port change section <b>501</b> includes a port history management section <b>101</b>, a port setting screen control section <b>102</b>, a port change detection section <b>103</b>, a port setting change section <b>104</b>, a setting processing section <b>105</b>, and a consistency determination section <b>106</b>.</p>
<p id="p-0060" num="0059">The port history management section <b>101</b> creates and updates port history. Also, the port history management section <b>101</b> stores the updated port history in a storage unit such as the RAM <b>2</b>. Furthermore, the port history management section <b>101</b> performs a search of a port history to the storage unit and a determination of the presence or absence of the port history of interest. The port setting screen control section <b>102</b> displays the port setting screen (see <figref idref="DRAWINGS">FIG. 3</figref>) on the display <b>10</b>, and receives any port change made by a user. The port change detection section <b>103</b> detects what kind of change has been made to the port settings on the port setting screen. The port setting change section <b>104</b> changes the port settings <b>208</b> of the logical printer <b>207</b>, which is the virtual output destination of print data designated by the application <b>201</b>, based on the detection results obtained by the port change detection section <b>103</b>. The setting processing section <b>105</b> acquires the device settings <b>504</b> of the port history <b>502</b>. The setting processing section <b>105</b> acquires information such as configuration information among the device settings that are obtainable from the printer <b>150</b>. This is performed when the port history <b>502</b> was not found as a result of searching performed by the port history management section <b>101</b>. Furthermore, the setting processing section <b>105</b> determines whether or not information relating to device settings has been acquired. When information relating to device settings has not been acquired, the setting processing section <b>105</b> acquires the defined value for the device settings of the printer driver <b>203</b>. The setting processing section <b>105</b> overwrites (restores) the acquired device settings to the device settings <b>210</b> of the logical printer <b>207</b>. The consistency determination section <b>106</b> checks the consistency between the overwritten device settings <b>210</b> and the print settings <b>212</b> passed to the printer driver <b>203</b> and the consistency between the overwritten device settings <b>210</b> and the default print settings <b>211</b>. When the port change is performed at the start of printing described above, two consistency checks are performed. However, when the port change is not performed at the start of printing, the print settings <b>212</b>, which have been passed to the printer driver <b>203</b>, are not present. Hence, only the consistency between the overwritten device settings <b>210</b> and the default print settings <b>211</b> is checked.</p>
<p id="h-0010" num="0000">&#x3c;Procedure for Print Control Processing&#x3e;</p>
<p id="p-0061" num="0060">Next, the procedure for print control processing according to the present embodiment will be described in detail with reference to <figref idref="DRAWINGS">FIGS. 7 to 9</figref>.</p>
<p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. 7</figref> is a flowchart diagram showing the procedure for print control processing according to the first embodiment. The program according to the flowchart shown in <figref idref="DRAWINGS">FIG. 7</figref> is stored in the external memory <b>11</b>, read by the RAM <b>2</b>, and executed by the CPU <b>1</b>. As shown in <figref idref="DRAWINGS">FIG. 7</figref>, first, a port history is stored (step S<b>601</b>). When the printer driver <b>203</b> receives print data, the port history management section <b>101</b> of the port change section <b>501</b> stores the port history with respect to the current port, i.e., pre-changed port in the RAM <b>2</b>. In this way, the port history <b>502</b> in the current device settings <b>210</b> is created or updated. The detail of port history store processing will be described later.</p>
<p id="p-0063" num="0062">Next, the port setting screen is displayed (step S<b>602</b>). Here, the port setting screen control section <b>102</b> displays the port setting screen (see <figref idref="DRAWINGS">FIG. 3</figref>) on the display <b>10</b>. In this way, a user can specify the output destination.</p>
<p id="p-0064" num="0063">Next, it is detected whether or not any port change instruction has been made (step S<b>603</b>). The port change detection section <b>103</b> detects whether or not any change instruction has been made after the port setting screen is closed, and detects what kinds of changes have occurred when change instruction has been made. Here, when any change instruction has not been made (No in step S<b>603</b>), port change processing is terminated, and the subsequent print processing is performed.</p>
<p id="p-0065" num="0064">On the other hand, when a port change instruction has been made in step S<b>603</b> (Yes in step S<b>603</b>), a port change is performed (step S<b>604</b>). Here, the port setting change section <b>104</b> changes the port settings <b>208</b> of the logical printer <b>207</b>, which is the virtual output destination of print data specified by the application <b>201</b>, based on the detection results performed by the port change detection section <b>103</b>.</p>
<p id="p-0066" num="0065">Next, a port history is searched (step S<b>605</b>). Here, the port history management section <b>101</b> starts search of the RAM <b>2</b> so as to detect whether or not the port history <b>502</b> corresponding to the changed port is present. Then, it is determined whether or not a port history is present (step S<b>606</b>). This processing is also executed by the port history management section <b>101</b>. Here, if there exists a port history of interest (Yes in step S<b>606</b>), the device settings <b>504</b> corresponding to the port history <b>502</b> of interest is acquired (step S<b>607</b>). The device settings <b>504</b> is acquired by the setting processing section <b>105</b>. Then, the process advances to step S<b>611</b>.</p>
<p id="p-0067" num="0066">On the other hand, if there is no port history of interest in step S<b>606</b> (No in step S<b>606</b>), configuration information is acquired from the printing apparatus (step S<b>608</b>). More specifically, the setting processing section <b>105</b> acquires information that is obtainable from the printing apparatus, such as configuration information that can be substituted as the device settings.</p>
<p id="p-0068" num="0067">Next, it is determined whether or not information relating to the device settings has been successfully acquired (step S<b>609</b>). This determination is performed by the setting processing section <b>105</b>. Here, if information has been successfully acquired (Yes in step S<b>609</b>), the process advances to step S<b>611</b>. On the other hand, if information has not been successfully acquired (No in step S<b>609</b>), the default device settings are acquired (step S<b>610</b>). Here, the setting processing section <b>105</b> acquires the device setting defined value of the printer driver <b>203</b>. Then, the process advances to step S<b>611</b>.</p>
<p id="p-0069" num="0068">Note that in step S<b>608</b> or step S<b>610</b>, if information to be acquired, such as various passwords, cannot be acquired from the printing apparatus, the device settings are in a null state.</p>
<p id="p-0070" num="0069">Then, the device setting is overwritten (step S<b>611</b>). More specifically, the setting processing section <b>105</b> overwrites the device settings, which have been acquired in any one of steps S<b>607</b>, S<b>608</b>, or S<b>610</b>, to the device settings <b>210</b> of the logical printer <b>207</b>.</p>
<p id="p-0071" num="0070">Then, the consistency of print settings is checked (step S<b>612</b>). Here, the consistency determination section <b>106</b> checks the consistency between the device settings <b>210</b> that have been overwritten by the process in step S<b>611</b> and the print settings <b>212</b> that has been passed to the printer driver <b>203</b>. Furthermore, the consistency determination section <b>106</b> checks the consistency between the device settings <b>210</b> that have been overwritten by the process in step S<b>611</b> and the default print settings <b>211</b>.</p>
<p id="p-0072" num="0071">Finally, the port history is stored (step S<b>613</b>). Here, the port history management section <b>101</b> creates or updates the port history <b>502</b> based on the device settings <b>210</b> that have been overwritten by the process in step S<b>611</b>, and stores it. Step S<b>613</b> is similar to step S<b>601</b>.</p>
<p id="p-0073" num="0072">Next, port history store processing shown in <figref idref="DRAWINGS">FIG. 7</figref> (step S<b>601</b>, step S<b>613</b>) will be described in detail. <figref idref="DRAWINGS">FIG. 8</figref> is a flowchart diagram showing the procedure for port history store processing (step S<b>601</b>, step S<b>613</b>). The program according to the flowchart shown in <figref idref="DRAWINGS">FIG. 8</figref> is stored in the external memory <b>11</b>, read by the RAM <b>2</b>, and executed by the CPU <b>1</b>.</p>
<p id="p-0074" num="0073">In the flowchart shown in <figref idref="DRAWINGS">FIG. 8</figref>, first, a port history is searched (step S<b>701</b>). More specifically, the port history management section <b>101</b> starts checking whether or not a port history corresponding to the port to be updated is present among the plurality of port histories <b>502</b> that have already been stored in the RAM <b>2</b>. Then, it is determined whether or not the port history is present (step S<b>702</b>). This processing is also executed by the port history management section <b>101</b>. Here, if there is no port history of interest (No in step S<b>702</b>), it is determined whether or not the number of port histories has reached the maximum number (MAX) thereof (step S<b>703</b>). More specifically, the port history management section <b>101</b> determines whether or not the number of port histories has reached a predetermined maximum number thereof. Here, if the number of port histories has not reached the maximum number (MAX) thereof (No in step S<b>703</b>), the process advances to step S<b>705</b>. On the other hand, if the number of port histories has reached the maximum number (MAX) thereof (Yes in step S<b>703</b>), the oldest port history is deleted (step S<b>704</b>). This processing is also performed by the port history management section <b>101</b>. Although this processing is performed to restrict the number of port histories such that the port history <b>502</b> is not added in infinitum, such a restriction may be made by other method such as the number of total bites.</p>
<p id="p-0075" num="0074">Next, the port history is added (step S<b>705</b>). More specifically, the port history management section <b>101</b> copies the port settings <b>208</b> and the device settings <b>210</b> of the current logical printer <b>207</b> and creates the port history <b>502</b> for addition.</p>
<p id="p-0076" num="0075">It should be noted that if the port history of interest has been found in step S<b>702</b> (Yes in step S<b>702</b>), the order of the found port history <b>502</b> is moved to the top (newest) (step S<b>706</b>). Then, the device settings <b>504</b> of the port history <b>502</b> is updated so as to be equivalent to the device settings <b>210</b> of the current logical printer <b>207</b> (step S<b>707</b>). The processes in step S<b>706</b> and step S<b>707</b> are performed by the port history management section <b>101</b>.</p>
<p id="p-0077" num="0076">Next, a description will be given for processing when the device settings <b>210</b> are changed by a user. <figref idref="DRAWINGS">FIG. 9</figref> is a flowchart diagram showing the procedure for the device setting change processing. The program according to the flowchart shown in <figref idref="DRAWINGS">FIG. 9</figref> is stored in the external memory <b>11</b>, read by the RAM <b>2</b>, and executed by the CPU <b>1</b>.</p>
<p id="p-0078" num="0077">In the flowchart shown in <figref idref="DRAWINGS">FIG. 9</figref>, first, a conventional device setting change is performed (step S<b>801</b>). More specifically, the setting processing section <b>105</b> changes the device settings <b>210</b> of the logical printer <b>207</b> using a conventional method. The Port history store processing shown in the flowchart of <figref idref="DRAWINGS">FIG. 7</figref> (step S<b>613</b>) is performed. By being carried out in this way, when the device settings <b>210</b> have been changed from the other logical printer <b>207</b> which uses the same printer driver <b>203</b>, the stored port history <b>502</b> can be quickly found by the process in step S<b>605</b> shown in <figref idref="DRAWINGS">FIG. 7</figref>. Consequently, the stored port history <b>502</b> can be reflected in the device settings <b>210</b> by the process in step S<b>607</b>. Even when the device settings <b>210</b> are changed while a port change screen at the start of printing is displayed, a similar effect as that of the foregoing can be expected.</p>
<p id="p-0079" num="0078">By executing the processing described above, the device settings <b>210</b> are automatically restored to the device settings of the printing apparatus that has previously been designated as the output destination, when the output destination of the logical printer is changed. Furthermore, the print settings are appropriately &#x201c;rounded&#x201d; in accordance with the restored device settings, which eliminates the need to conduct print settings again. Consequently, the output of the print control command and the drawing command, which are incompatible with the printing apparatus due to the change of the output destination, is eliminated, whereby loss of time due to failure of printing and loss of paper due to an unintended print result can be eliminated.</p>
<p id="p-0080" num="0079">In the present embodiment, a password for department management, which cannot be acquired in one-way communication network or from the printing apparatus, can also be restored. Furthermore, when a logical printer is created by the same printer driver, the same port history can be used immediately after creation, output processing at the printing apparatus of the switched destination can be performed smoothly.</p>
<p id="h-0011" num="0000">(Second Embodiment)</p>
<p id="p-0081" num="0080">Although the first embodiment has been described through the example in which a port is changed during print processing of the printer driver <b>203</b>, the port may be changed before printing. For example, a port may be changed from being dedicated to property of the logical printer <b>207</b>. When a port is changed during print processing, the port is changed only one time. When a port is changed before printing, it is contemplated that port is changed several times in succession. In this case, even though a user does not change the default print settings <b>211</b> of the logical printer <b>207</b>, there arises a situation in that set values are gradually rounded only by changing a port. Hereinbelow, a trouble arising in the course of such a port change will be described.</p>
<p id="p-0082" num="0081"><figref idref="DRAWINGS">FIG. 10</figref> is a view for illustrating trouble that may occur during a port change. In <figref idref="DRAWINGS">FIG. 10</figref>, a description will be given of an example in which device settings of &#x201c;device type&#x201d;, which indicates a color printing apparatus or a monochrome printing apparatus, and print settings of a &#x201c;color mode&#x201d;, which indicates color printing or monochrome printing, are available.</p>
<p id="p-0083" num="0082">First, assume that port is a color printing apparatus, the device type of the device settings <b>210</b> is set to color, and the color mode of the default print settings <b>211</b> is set to color. When a port is changed to a monochrome printing apparatus, the device type of the device settings is restored to monochrome from the port history, and the color mode becomes monochrome as a result of the consistency check. Then, when a port is changed to the color printing apparatus again without changing the default print settings <b>211</b>, the device type of the device settings is restored to color. Even if the consistency check is performed, the color mode remains as monochrome because the color printing apparatus can also perform monochrome printing. In other words, when a port is changed to various different printing apparatuses, there arises a situation in that the default print settings <b>211</b> are gradually rounded even if a user does not change it. In order to resolve these situations, the following processing is executed in the present embodiment.</p>
<p id="p-0084" num="0083"><figref idref="DRAWINGS">FIG. 11</figref> is a view for explaining an outline of print control processing according to the second embodiment. As shown in <figref idref="DRAWINGS">FIG. 11</figref>, to resolve the above situations, a print setting back-up <b>1001</b>, which is a copy of the default print settings <b>211</b> that have been changed by a user operation, is created to be held in the logical printer <b>207</b>. For example, this processing be carried out by the setting processing section <b>105</b> shown in <figref idref="DRAWINGS">FIG. 7</figref>. When a port is changed, its consistency with the device settings should be checked on the basis of the print setting back-up <b>1001</b>, not the current default print settings <b>211</b>. By being carried out in this way, even when only a port is changed without changing the default print settings <b>211</b>, the default print settings <b>211</b> are not gradually rounded, and are rounded only against the default print settings <b>211</b> that have been set by a user.</p>
<p id="h-0012" num="0000">&#x3c;Procedure for Print Control Processing&#x3e;</p>
<p id="p-0085" num="0084">Next, the procedure for print control processing according to the present embodiment will be described. <figref idref="DRAWINGS">FIG. 12</figref> is a flowchart diagram showing the procedure for print control processing according to the second embodiment. The program according to the flowchart shown in <figref idref="DRAWINGS">FIG. 12</figref> is stored in the external memory <b>11</b>, read by the RAM <b>2</b>, and executed by the CPU <b>1</b>. In <figref idref="DRAWINGS">FIG. 12</figref>, the processes in steps S<b>601</b> to step S<b>611</b> and the process in step S<b>613</b> are the same as those shown in <figref idref="DRAWINGS">FIG. 7</figref>. It differs in that instead of the process for checking the consistency of print setting in <figref idref="DRAWINGS">FIG. 7</figref> (step S<b>612</b>), the processes in steps S<b>1101</b> to S<b>1104</b> in the following are added. In the following, a description will be made regarding the processes in steps S<b>1101</b> to S<b>1104</b> only.</p>
<p id="p-0086" num="0085">In the flowchart shown in <figref idref="DRAWINGS">FIG. 12</figref>, it is determined whether or not a print setting back-up is present after the process in step S<b>611</b> is conducted (step S<b>1101</b>). Here, the print setting back-up <b>1001</b> is not present if a print setting change by a user operation and a port change from the printer property of the logical printer <b>207</b> has not been made after the creation of the logical printer <b>207</b>. In step S<b>1101</b>, the setting processing section <b>105</b> shown in <figref idref="DRAWINGS">FIG. 6</figref> determines whether or not the print setting back-up <b>1001</b> is present in the logical printer <b>207</b>. Here, if there is no print setting back-up (No in step S<b>1101</b>), the consistency of print settings is checked (step S<b>1102</b>). More specifically, the consistency determination section <b>106</b> shown in <figref idref="DRAWINGS">FIG. 6</figref> checks the consistency between the current device settings <b>210</b> of the logical printer <b>207</b> and the default print settings <b>211</b> of the logical printer <b>207</b> and the consistency between the current device settings <b>210</b> of the logical printer <b>207</b> and the print settings <b>212</b> passed to the printer driver. Next, the print settings are backed up (step S<b>1103</b>). Here, the setting processing section <b>105</b> copies the default print settings <b>211</b> after consistency check processing performed at step S<b>1102</b>, and creates the print setting back-up <b>1001</b> to store it in the logical printer <b>207</b>. Then, the process advances to step S<b>613</b>.</p>
<p id="p-0087" num="0086">On the other hand, if the print setting back-up is present in step S<b>1101</b> (Yes in step S<b>1101</b>), the print settings are restored to those of the print setting back-up (step S<b>1104</b>). More specifically, the setting processing section <b>105</b> overwrites the print setting back-up <b>1001</b> and copies it to the default print settings <b>211</b>. Then, the consistency of the print settings is checked (step S<b>1102</b>). Here, the consistency determination section <b>106</b> checks the consistency between the device settings <b>210</b> of the logical printer <b>207</b> and the default print settings <b>211</b> of which the print setting back-up <b>1001</b> has been overwritten and the consistency between the device settings <b>210</b> of the logical printer <b>207</b> and the print settings <b>212</b> passed to the printer driver. Then, the process advances to step S<b>613</b>.</p>
<p id="p-0088" num="0087">Next, a description will be given regarding a processing when the default print settings <b>211</b> are changed by a user. <figref idref="DRAWINGS">FIG. 13</figref> is a flowchart diagram showing the procedure for print setting change processing according to the second embodiment. The program according to the flowchart shown in <figref idref="DRAWINGS">FIG. 13</figref> is stored in the external memory <b>11</b>, read by the RAM <b>2</b>, and executed by the CPU <b>1</b>. In the flowchart shown in <figref idref="DRAWINGS">FIG. 13</figref>, first, a conventional device setting change is performed (step S<b>1201</b>). More specifically, the setting processing section <b>105</b> changes the default print settings <b>211</b> using the conventional method. Next, the print setting is backed up (step S<b>1202</b>). More specifically, the setting processing section <b>105</b> stores a copy of the default print settings <b>211</b> that have been changed by the process in step S<b>1201</b> as the print setting back-up <b>1001</b> in the logical printer <b>207</b>. However, if the print setting back-up <b>1001</b> already exists, the print setting back-up <b>1001</b> is overwritten.</p>
<p id="p-0089" num="0088">By executing the processing described above, when port is changed before printing, in particular, even when port is changed several times in succession, the situation in which only the default print settings <b>211</b> are gradually rounded can be avoided, whereby the same effects as those of the above-described first embodiment can be obtained.</p>
<p id="p-0090" num="0089">While the present invention has been described with reference to exemplary embodiments, it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structures and functions.</p>
<p id="h-0013" num="0000">Other Embodiments</p>
<p id="p-0091" num="0090">Aspects of the present invention can also be realized by a computer of a system or apparatus (or devices such as a CPU or MPU) that reads out and executes a program recorded on a memory device to perform the functions of the above-described embodiment(s), and by a method, the steps of which are performed by a computer of a system or apparatus by, for example, reading out and executing a program recorded on a memory device to perform the functions of the above-described embodiment(s). For this purpose, the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device (e.g., computer-readable medium).</p>
<p id="p-0092" num="0091">This application claims the benefit of Japanese Patent Application No. 2009-021947 filed Feb. 2, 2009 which is hereby incorporated by reference herein in its entirety.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A non-transitory storage medium for storing a program that switches a plurality of printing apparatuses by changing a port of a logical printer for printout and is executed by a computer having a storage unit configured to associate the port with device settings for storing it, the storage medium storing the program for the functioning of the computer comprising:
<claim-text>a reflecting unit configured to acquire the stored device settings corresponding to the changed port to reflect the stored device settings in the device settings held by the logical printer if the port is changed; and</claim-text>
<claim-text>a changing unit configured to change print settings so as not to be inconsistent with the device settings to be reflected by the reflecting unit,</claim-text>
<claim-text>wherein the reflecting unit acquires the device settings from a changed printing apparatus if the stored device settings corresponding to the changed port cannot be acquired by the storage unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The non-transitory storage medium according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the reflecting unit acquires default print settings if the stored device settings corresponding to the changed port cannot be acquired by the storage unit and the device settings cannot be acquired from the changed printing apparatus.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. An apparatus that switches a plurality of printing apparatuses by changing a port of a logical printer for printout, the apparatus comprising:
<claim-text>a storage unit configured to associate the port with device settings for storing it;</claim-text>
<claim-text>a reflecting unit configured to, if the port of the logical printer is changed, acquire the stored device settings corresponding to the changed port by the storage unit so as to reflect them in the device settings held by the logical printer; and</claim-text>
<claim-text>a changing unit configured to change print settings so as not to be inconsistent with the device settings to be reflected by the reflecting unit,</claim-text>
<claim-text>wherein the reflecting unit acquires the device settings from a changed printing apparatus if the stored device settings corresponding to the changed port cannot be acquired by the storage unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. A control method that switches a plurality of printing apparatuses by changing a port of a logical printer for printout and is executed by a computer having a storage unit configured to associate the port with device settings for storing it, the method comprising:
<claim-text>acquiring the stored device settings corresponding to the changed port by the storage unit so as to reflect them in the device settings held by the logical printer if the port of the logical printer is changed; and</claim-text>
<claim-text>changing print settings so as not to be inconsistent with the device settings to be reflected,</claim-text>
<claim-text>wherein the device settings are acquired from a changed printing apparatus if the stored device settings corresponding to the changed port cannot be acquired by the storage unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein default print settings are acquired if the stored device settings corresponding to the changed port cannot be acquired by a storage unit and the device settings cannot be acquired from a changed printing apparatus.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. A non-transitory storage medium storing a computer-executable program of instructions for causing a computer to perform a method comprising:
<claim-text>changing a port of a logical printer for printout;</claim-text>
<claim-text>storing device settings of the port;</claim-text>
<claim-text>acquiring the stored device settings corresponding to changed port to reflect the device settings held by the logical printer if the port is changed; and</claim-text>
<claim-text>changing print settings so as not to be inconsistent with the device settings to be reflected,</claim-text>
<claim-text>wherein the device settings are acquired from the changed printing apparatus if the stored device settings corresponding to the changed port cannot be acquired by a storage unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The non-transitory storage medium according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein default print settings are acquired if the stored device settings corresponding to the changed port cannot be acquired by a storage unit and the device settings cannot be acquired from a changed printing apparatus.</claim-text>
</claim>
</claims>
</us-patent-grant>
