<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08626122-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08626122</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13201500</doc-number>
<date>20100129</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<us-term-extension>102</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>M</subclass>
<main-group>1</main-group>
<subgroup>66</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>M</subclass>
<main-group>3</main-group>
<subgroup>16</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20090101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>W</subclass>
<main-group>4</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>B</subclass>
<main-group>7</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>29</main-group>
<subgroup>06</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>32</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>7</main-group>
<subgroup>04</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>455410</main-classification>
<further-classification>455411</further-classification>
<further-classification>4554351</further-classification>
<further-classification>455522</further-classification>
<further-classification>713151</further-classification>
<further-classification>713153</further-classification>
<further-classification>713168</further-classification>
<further-classification>713180</further-classification>
<further-classification>726 30</further-classification>
<further-classification>380278</further-classification>
</classification-national>
<invention-title id="d2e53">Un-ciphered network operation solution</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6819937</doc-number>
<kind>B2</kind>
<name>Knuutila et al.</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455522</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2007/0101120</doc-number>
<kind>A1</kind>
<name>Patel et al.</name>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713151</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2008/0305792</doc-number>
<kind>A1</kind>
<name>Khetawat et al.</name>
<date>20081200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4554351</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2009/0061877</doc-number>
<kind>A1</kind>
<name>Gallagher et al.</name>
<date>20090300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455436</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2009/0305671</doc-number>
<kind>A1</kind>
<name>Luft et al.</name>
<date>20091200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455411</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2010/0293372</doc-number>
<kind>A1</kind>
<name>Fischer et al.</name>
<date>20101100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713168</main-classification></classification-national>
</us-citation>
<us-citation>
<nplcit num="00007">
<othercit>3GPP, &#x201c;3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; 3GPP System Architecture Evolution (SAE); Security Architecture (Release 8)&#x201d;, 3GPP TS 33.401 ver. 8.2.1, Dec. 19, 2008, pp. 1-58; XP002574135.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00008">
<othercit>3GPP, &#x201c;3rd Generation Partnership Project; Technical Specification Group Core Network and Terminals; Non-Access-Stratum (NAS) Protocol for Evolved Packet System (EPS); Stage 3 (Release 8)&#x201d;, 3GPP TS 24.301 ver. 8.0.0, Dec. 1, 2008, pp. 1-110; XP002607004.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>13</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>455410-411</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4554351</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455436</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455522</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370272</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713153</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713168</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713180</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713748</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713151</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>714748</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380278</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 30</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>5</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61152817</doc-number>
<date>20090216</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110300828</doc-number>
<kind>A1</kind>
<date>20111208</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Wass</last-name>
<first-name>Mikael</first-name>
<address>
<city>Hyssna</city>
<country>SE</country>
</address>
</addressbook>
<residence>
<country>SE</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Wass</last-name>
<first-name>Mikael</first-name>
<address>
<city>Hyssna</city>
<country>SE</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Rothwell, Figg, Ernst &#x26; Manbeck, P.C.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Telefonaktiebolaget L M Ericsson (publ)</orgname>
<role>03</role>
<address>
<city>Stockholm</city>
<country>SE</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Mehra</last-name>
<first-name>Inder</first-name>
<department>2645</department>
</primary-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/EP2010/051105</doc-number>
<kind>00</kind>
<date>20100129</date>
</document-id>
<us-371c124-date>
<date>20110815</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO2010/091966</doc-number>
<kind>A </kind>
<date>20100819</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The present invention relates to a solution for handling security issues of non access stratum (NAS) signaling in a telecommunications network (<b>100</b>) The NAS signaling is performed between a user equipment (UE) and a mobility management node, e.g. a mobility management entity (MME) The solution is realized in a device and in a method comprising steps of receiving an initial non access stratum message from the UE (<b>101</b>) communicating wirelessly (<b>105</b>) with the telecommunications network, determining security context status for the UE, determining if un-ciphered mode is to be used in the security context, set ciphering algorithm to a null ciphering algorithm, transmitting a security context and activation message to the UE, comprising information indicating ciphering algorithm, and receiving a security context activation acknowledge message from the UE.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="210.99mm" wi="336.97mm" file="US08626122-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="95.17mm" wi="134.37mm" file="US08626122-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="213.28mm" wi="162.39mm" file="US08626122-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="225.64mm" wi="174.41mm" file="US08626122-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="155.11mm" wi="162.81mm" file="US08626122-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="152.65mm" wi="154.01mm" file="US08626122-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATION</heading>
<p id="p-0002" num="0001">This application is a 35 U.S.C. &#xa7;371 national phase entry application from PCT/EP2010/051105, filed Jan. 29, 2010, and designating the U.S., and which claims priority to U.S. Patent Application No. 61/152,817, filed Feb. 16, 2009, the disclosures of which are incorporated by reference herein in their entirety.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">TECHNICAL FIELD</heading>
<p id="p-0003" num="0002">The present invention relates to a solution for handling security issues of non access stratum signaling in a telecommunications network.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">The NAS protocol used for UE/MME interaction has a security protection mechanism comprising integrity protection and/or ciphering of messages. In normal ciphered operation all messages shall be ciphered as soon as a security context has been activated for a specific NAS connection.</p>
<p id="p-0005" num="0004">It is also specified in 3GPP TS 24.301 that ciphering is an operator option. Thus SAE needs to support un-ciphered operation in the NAS protocol.</p>
<p id="p-0006" num="0005">Different methods to solve un-ciphered operation may be selected and one way is to always use non security protected NAS messages. There are two general types of NAS messages, plain NAS messages that have no security protection and security protected NAS messages that have integrity protection and/or ciphering applied.</p>
<p id="p-0007" num="0006">If there is no common way to solve un-ciphered operation mode in SAE there will be interoperability problems between UE and MME and between different vendors, effectively making un-ciphered operation impossible.</p>
<p id="p-0008" num="0007">If a method is chosen where non security protected NAS messages are used for all messages in un-ciphered operation mode, it implies that the MME implementations will be more complicated and needs to be able to distinguish between ciphered and un-ciphered operation for most NAS messages.</p>
<p id="p-0009" num="0008">Furthermore, if using plain NAS messages in un-ciphered operation, integrity protection of the NAS messages will not be available and exceptions to those rules would also have to be implemented.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0010" num="0009">It is therefore an object of the present invention to address these problems and to provide a solution for interoperability of NAS security.</p>
<p id="p-0011" num="0010">The concept of the present invention is to select a &#x201c;null ciphering algorithm&#x201d; when a security context is selected for use by a mobility management device, e.g. a Mobility Management Entity (MME) operating in un-ciphered mode. This may be done for all UEs using the network in un-ciphered operation or for individual UEs in connection with the MME. In all other aspects the NAS messages may be sent, received, and treated in the same way as in a network in normal ciphered operation.</p>
<p id="p-0012" num="0011">This is provided in a number of aspects of the present invention, in which a first is a method for handling security issues in an infrastructure node in a telecommunications network. The method comprising the steps of:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0012">Receiving an initial non access stratum, i.e. NAS, message from a user equipment (UE) communicating wirelessly with the telecommunications network.</li>
        <li id="ul0002-0002" num="0013">Determining security context status for the UE.</li>
        <li id="ul0002-0003" num="0014">Determining if un-ciphered mode is to be used in the security context.</li>
        <li id="ul0002-0004" num="0015">Set ciphering algorithm to a null ciphering algorithm.</li>
        <li id="ul0002-0005" num="0016">Transmitting a security context and activation message to the UE, comprising information indicating ciphering algorithm.</li>
        <li id="ul0002-0006" num="0017">Receiving a security context activation acknowledge message from UE.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0013" num="0018">All security contexts may be created with a null ciphering algorithm and/or security context for individual UEs may be set to a null ciphering algorithm.</p>
<p id="p-0014" num="0019">The method may further comprise steps of receiving further NAS messages and deciphering the further NAS messages using the null ciphering algorithm. Furthermore, the method may also comprise a step of providing integrity protection of communication messages. Messages may be treated as being in normal ciphered mode independent on ciphering mode.</p>
<p id="p-0015" num="0020">The null ciphering algorithm is preferably arranged so as to operate on messages in such a way that the messages are un-altered.</p>
<p id="p-0016" num="0021">The method according to claim <b>1</b>, wherein the step of transmitting security context comprise indicating in a field in a message one of no integrity protection and no ciphering, integrity protection only, or integrity protection and ciphering on.</p>
<p id="p-0017" num="0022">Another aspect of the present invention is provided, an infrastructure device in a telecommunications network. The device comprising a processing unit, a memory unit, and a communication interface unit. The processing unit may be configured to execute instructions sets stored in the memory unit for receiving using the communication interface an initial non access stratum, i.e. NAS, message from a user equipment, determining security context status, creating a new security context, determining if un-ciphered mode is to be used in the security context, set ciphering algorithm to null, transmitting, using the communication interface, a security context and activation message to the UE, comprising information indicating ciphering algorithm, and receiving, using the communication interface, a security context activation acknowledge message from UE.</p>
<p id="p-0018" num="0023">The infrastructure device may be a mobility management device, e.g. a mobility management entity (MME).</p>
<p id="p-0019" num="0024">With the solution according to the present invention the following advantages may be realized:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0025">The criteria for accepting a particular NAS message may be the same in ciphered and un-ciphered operation;</li>
        <li id="ul0004-0002" num="0026">The integrity protection part of security protection may still be active in un-ciphered operation;</li>
        <li id="ul0004-0003" num="0027">The solution may be entirely implemented in the MME&#x2014;i.e. no UE impact; which thus provides a cost efficient implementation of the present invention.</li>
    </ul>
    </li>
</ul>
</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0020" num="0028">In the following the invention will be described in a non-limiting way and in more detail with reference to exemplary embodiments illustrated in the enclosed drawings, in which:</p>
<p id="p-0021" num="0029"><figref idref="DRAWINGS">FIG. 1</figref> illustrates schematically a network according to the present invention;</p>
<p id="p-0022" num="0030"><figref idref="DRAWINGS">FIG. 2</figref> illustrates schematically a device according to the present invention;</p>
<p id="p-0023" num="0031"><figref idref="DRAWINGS">FIG. 3</figref> illustrates schematically in a block diagram a method according to the present invention; and</p>
<p id="p-0024" num="0032"><figref idref="DRAWINGS">FIG. 4</figref> illustrates schematically in a block diagram another method according to the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0025" num="0033">In <figref idref="DRAWINGS">FIG. 1</figref>, reference numeral <b>100</b> generally denote a telecommunications network comprising a radio access network <b>102</b> in connection <b>106</b> with a mobility management device <b>103</b>, e.g. a mobility management entity (MME), which is part of a core network <b>104</b>. The radio access network provides access to the telecommunications network for user equipment <b>101</b> (UP) connecting wirelessly <b>105</b> to the radio access network, for instance via a base station (not shown), e.g. an eNodeB or similar network access node. For illustrative purposes the MME will be used in the description but it should be noted that other mobility management devices may be applicable. The network may comprise further nodes; however, these are not shown since they do not form part of the present invention, for instance a serving gateway, a packet data network gateway, a home subscriber server, and so on. Furthermore, the network also comprises communication distribution devices such as routers, switches, and cabling for physical distribution of communication data.</p>
<p id="p-0026" num="0034">The UE attaches to the network using normal attachment procedures depending on protocol standard in use, e.g. LTE, SAE, or similar packet based protocols. During attachment to the network the UE is to establish a non access stratum connection to the core network <b>104</b>. This is initiated by the UP which sends a request for establishment to the core network and to the MME.</p>
<p id="p-0027" num="0035">When a new NAS connection is established between the UP and the MME a security context shall be taken into use and this is negotiated between the UP and the MME. If the MME has been configured not to apply ciphering for NAS messages the MME selects a &#x201c;null ciphering algorithm&#x201d; to be used by the security context. Apart from this exception the MME may handle all procedures and NAS messages between the UE and the MME as if the network was operating in normal ciphered mode, i.e. the same rules apply when a particular NAS message shall be marked as &#x201c;plain&#x201d; or &#x201c;security protected&#x201d;.</p>
<p id="p-0028" num="0036">The null ciphering algorithm may comprise an algorithm that does not change the data during encryption. This may be defined in the algorithm itself or by the use of key set identifiers used in seeding the algorithm making the algorithm perform as not changing the data during encryption.</p>
<p id="p-0029" num="0037">Normal authentication procedures may be executed, for instance for integrity protection of data transmitted. This allows for integrity protection of data together with null ciphering of data.</p>
<p id="p-0030" num="0038">The solution according to the present invention is advantageously implemented in the mobility management device, e.g. the MME. The MME <b>103</b>, <b>200</b> may comprise, as is seen in <figref idref="DRAWINGS">FIG. 2A</figref>, at least one processing unit <b>201</b>, at least one computer readable storage medium, e.g. a memory unit, <b>202</b>, and at least one communication interlace <b>203</b>. The processing unit is configured to read software or hardware instruction sets from the memory unit and together with the communication interface execute methods according to the present invention. The processing unit may comprise any suitable processing device such as for instance a microprocessor, central processing unit (CPU), digital signal processor (DSP), application specific integrated circuit (ASIC), or field programmable gate array (FPGA). It should be noted that the instruction sets may also comprise hardware instructions as usually implemented for ASIC solutions. Furthermore, the memory unit may comprise a volatile or non-volatile memory type or a combination of these types. The communication interface is preferably configured to communicate in a packet based manner, e.g. through protocols such as Internet Protocol (IP) based protocols.</p>
<p id="p-0031" num="0039">Functional elements of the MME is shown in <figref idref="DRAWINGS">FIG. 2B</figref> where the processor has a receiving portion for receiving communication data from the communication interface, a decision portion for executing software commands for handling decisions related to the operation of the MME and in particular of handling decision related to the security context as will be described below in more detail. The processor also has a transmitting portion configured to transmit messages via the communication interface. All portions of the processor may use the memory unit for temporary storage of data and/or for permanent storage of data depending on configuration of the node.</p>
<p id="p-0032" num="0040">During operation the MME will communicate with the UE and with other devices for operation of network related provisions. For instance as will be discussed below, the MME participates in establishment procedures when a UE attaches to a network; for instance at initial connection or during hand over from another network.</p>
<p id="p-0033" num="0041"><figref idref="DRAWINGS">FIG. 3</figref> illustrates an example of initial NAS establishment procedure. The UE first initiates the establishment by transmitting <b>301</b> an initial NAS message requesting establishment which is received <b>302</b> by the MME. In the next step, the MME checks <b>303</b> if a security context needs to be created. Depending on if a security context is to be created or not different paths will be executed. If no new security context need to be created it is decided <b>304</b> to use an existing security context and the security context is transmitted <b>309</b> to the UE; however, if a security is to be created, it is created <b>305</b>. Furthermore, the MME checks <b>306</b> if un-ciphered mode is to be used; if an un-ciphered mode is used, the ciphering algorithm is set to null <b>308</b>; otherwise the ciphering algorithm is set <b>307</b> as chosen. A message is sent <b>309</b> to activate the chosen security context and this is received <b>310</b> by the UE.</p>
<p id="p-0034" num="0042">The UE activates <b>311</b> the security context and invokes <b>312</b> the ciphering algorithm indicated in the security message. The UE sets <b>313</b> the ciphering indicator in an acknowledge message header to true and transmits <b>314</b> the activation acknowledge message to the MME which receives <b>315</b> the security context activation acknowledge message.</p>
<p id="p-0035" num="0043"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a continued action of a communication link between a sender, e.g. the UE, and a Receiver, e.g. the MME, when the initial NAS establishment procedure has been executed. The UE invokes <b>401</b> the ciphering algorithm indicated in the security context and sets <b>402</b> a ciphering indicator in a message header to true. The UE then sends <b>403</b> the message which is received <b>404</b> by the MME. The MME decipher <b>405</b> the message using the ciphering algorithm indicated in the security context and finally interpret <b>406</b> the message accordingly. It should be appreciated that the communication may be performed in any direction and that other nodes may be involved in NAS communication with the UE then the MME.</p>
<p id="p-0036" num="0044">It should be noted that the selection of un-ciphered mode may be done at any time, not only when creating a security context. If un-ciphered mode is selected at a certain point in time also the already attached UE's may get the selected ciphering algorithm changed to null. Also the un-ciphered mode may be turned off at any time by selecting a &#x201c;normal&#x201d; ciphering algorithm. Changing the ciphered mode may be used for instance for tests of UE connection to the infrastructure network or tests of the UE condition.</p>
<p id="p-0037" num="0045">It should be noted that the word &#x201c;comprising&#x201d; does not exclude the presence of other elements or steps than those listed and the words &#x201c;a&#x201d; or &#x201c;an&#x201d; preceding an element do not exclude the presence of a plurality of such elements. It should further be noted that any reference signs do not limit the scope of the claims, that the invention may be at least in part implemented by means of both hardware and software, and that several &#x201c;means&#x201d; or &#x201c;units&#x201d; may be represented by the same item of hardware.</p>
<p id="p-0038" num="0046">The above mentioned and described embodiments are only given as examples and should not be limiting to the present invention. Other solutions, uses, objectives, and functions within the scope of the invention as claimed in the below described patent claims should be apparent for the person skilled in the art.</p>
<p id="h-0007" num="0000">Abbreviations</p>
<p id="p-0039" num="0000">
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0047">EPS Evolved Packet System</li>
    <li id="ul0005-0002" num="0048">LTE Long Term Evolution</li>
    <li id="ul0005-0003" num="0049">MME Mobility Management Entity</li>
    <li id="ul0005-0004" num="0050">NAS Non Access Stratum</li>
    <li id="ul0005-0005" num="0051">SAE System Architecture Evolution</li>
    <li id="ul0005-0006" num="0052">UE User Equipment
<br/>
References
</li>
    <li id="ul0005-0007" num="0053">[1] 3GPP TS 33.401: &#x201c;3GPP System Architecture Evolution; Security architecture&#x201d;.</li>
    <li id="ul0005-0008" num="0054">[2] 3GPP TS 24.301: &#x201c;Non-Access-Stratum (NAS) protocol for Evolved Packet System (EPS); Stage 3&#x201d;.</li>
</ul>
</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for handling security issues in an infrastructure node in a telecommunications network, comprising the steps of:
<claim-text>receiving an initial non access stratum (NAS) message from a user equipment (UE) communicating wirelessly with the telecommunications network;</claim-text>
<claim-text>after receiving the initial NAS message, determining if un-ciphered mode is to be used in a security context;</claim-text>
<claim-text>in response to determining that un-ciphered mode is to be used, selecting a predefined ciphering algorithm from a set of predefined ciphering algorithms and, after selecting the predefined ciphering algorithm, transmitting to the UE a security mode message comprising an identifier identifying the selected ciphering algorithm; and</claim-text>
<claim-text>receiving a security context activation acknowledge message from UE.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein all security contexts are created with a null ciphering algorithm.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the security context for one UE is set to a null ciphering algorithm.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising the steps of
<claim-text>receiving further NAS messages; and</claim-text>
<claim-text>deciphering the further NAS messages using the null ciphering algorithm.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein messages are treated as being in normal ciphered mode.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising a step of providing integrity protection of communication messages.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the null ciphering algorithm operates on messages in such a way that the messages are un-altered.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the step of transmitting security context comprise indicating in a field in a message one of: (a) no integrity protection and no ciphering, (b) integrity protection only, or (c) integrity protection and ciphering on.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the infrastructure node is a mobility management entity (MME).</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. An infrastructure device in a telecommunications network, comprising:
<claim-text>a processing unit;</claim-text>
<claim-text>a memory unit;</claim-text>
<claim-text>a communication interface unit;</claim-text>
<claim-text>wherein the processing unit is configured to execute instructions sets stored in the memory unit for:</claim-text>
<claim-text>receiving using the communication interface an initial non access stratum (NAS) message from a user equipment (UE);</claim-text>
<claim-text>determining security context status;</claim-text>
<claim-text>creating a new security context;</claim-text>
<claim-text>determining if un-ciphered mode is to be used in the security context;</claim-text>
<claim-text>in response to determining that un-ciphered mode is to be used, selecting a predefined ciphering algorithm from a set of predefined ciphering algorithms and, after selecting the predefined ciphering algorithm, transmitting to the UE, using the communication interface, a security mode message comprising an identifier identifying the selected ciphering algorithm;</claim-text>
<claim-text>receiving, using the communication interface, a security context activation acknowledge message from the UE.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The infrastructure device according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the device is a mobility management device.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The infrastructure device according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the device is a mobility management entity (MME).</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The infrastructure device according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the processing unit is further arranged to receive, using the communication interface, further NAS messages and decipher the further NAS messages using the null ciphering algorithm. </claim-text>
</claim>
</claims>
</us-patent-grant>
