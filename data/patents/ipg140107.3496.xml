<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08624561-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08624561</doc-number>
<kind>B1</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12940068</doc-number>
<date>20101105</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>438</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>02</class>
<subclass>J</subclass>
<main-group>7</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>02</class>
<subclass>M</subclass>
<main-group>3</main-group>
<subgroup>06</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>320166</main-classification>
<further-classification>320101</further-classification>
<further-classification>320135</further-classification>
<further-classification>320139</further-classification>
<further-classification>136291</further-classification>
<further-classification>323234</further-classification>
<further-classification>307109</further-classification>
</classification-national>
<invention-title id="d2e53">Power conversion having energy storage with dynamic reference</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5357419</doc-number>
<kind>A</kind>
<name>Limpaecher</name>
<date>19941000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>363140</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5598326</doc-number>
<kind>A</kind>
<name>Liu et al.</name>
<date>19970100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>363 34</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5677833</doc-number>
<kind>A</kind>
<name>Bingley</name>
<date>19971000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>363 71</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6462976</doc-number>
<kind>B1</kind>
<name>Olejniczak et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>363147</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6713890</doc-number>
<kind>B2</kind>
<name>Kondo et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>290 40 B</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6800964</doc-number>
<kind>B2</kind>
<name>Beck</name>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>307126</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2006/0043954</doc-number>
<kind>A1</kind>
<name>Markowski</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>323283</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2007/0159866</doc-number>
<kind>A1</kind>
<name>Siri</name>
<date>20070700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>363 95</main-classification></classification-national>
</us-citation>
</us-references-cited>
<number-of-claims>22</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>320166</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>10</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61290821</doc-number>
<date>20091229</date>
</document-id>
</us-provisional-application>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Slavin</last-name>
<first-name>Keith</first-name>
<address>
<city>Beaverton</city>
<state>OR</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Slavin</last-name>
<first-name>Keith</first-name>
<address>
<city>Beaverton</city>
<state>OR</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Barnes &#x26; Thornburg LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>SolarBridge Technologies, Inc.</orgname>
<role>02</role>
<address>
<city>Austin</city>
<state>TX</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Fantu</last-name>
<first-name>Yalkew</first-name>
<department>2859</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A power conversion system may include a controller to cause a power stage to control the flow of power to or from an energy storage device in response to a dynamic reference. The flow of power to or from the energy storage device may be controlled at a substantially higher speed than power fluctuations in a power source or load. In a power conversion system, a model including an energy storage device may be generated in real-time, and a condition of the energy storage device may be determined in response to the model.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="104.14mm" wi="188.55mm" file="US08624561-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="213.87mm" wi="193.72mm" file="US08624561-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="218.44mm" wi="172.64mm" file="US08624561-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="242.49mm" wi="176.61mm" file="US08624561-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="242.82mm" wi="194.06mm" file="US08624561-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="248.41mm" wi="166.37mm" orientation="landscape" file="US08624561-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="146.30mm" wi="173.99mm" file="US08624561-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application claims priority from U.S. Provisional Patent application Ser. No. 61/290,821 filed Dec. 29, 2009, which is incorporated by reference.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">Power converters are used to convert electric power from one form to another, for example, to convert direct current (DC) power to alternating current (AC) power. One important application for power converters is in transferring power from energy sources such as solar panels, batteries, fuel cells, etc., to electric power distribution systems such as local and regional power grids. Most power grids operate on AC current at a line (or mains) frequency of 50 or 60 cycles per second (Hertz or Hz). Power in an AC grid flows in a pulsating manner with power peaks occurring at twice the line frequency, i.e., 100 Hz or 120 Hz. In contrast, many energy sources supply DC power in a steady manner. Therefore, a power conversion system for transferring power from a DC source to an AC grid typically includes some form of energy storage to balance the steady input power with the pulsating output power.</p>
<p id="p-0004" num="0003">This can be better understood with reference to <figref idref="DRAWINGS">FIG. 1</figref> which illustrates the mismatch between a DC power source and a 60 Hz AC load. The amount of power available from the DC source is shown as a constant value at the center line of the sine wave. In contrast, the amount of power that must be transferred to the AC load is shown as a sine wave that fluctuates from the zero power level at the minimum of the sine wave to a maximum value and back down to minimum once every half line cycle. For a system with a grid frequency f<sub>grid</sub>, a half line cycle is given by 1/(2*f<sub>grid</sub>), which is 10 milliseconds (ms) 50 Hz systems, and 8.33 ms for 60 Hz systems. During time T<b>1</b>, the power available from the DC source exceeds the instantaneous power required by the AC load. During time T<b>2</b>, however, the maximum power available from the DC source is less than that required by the load. Therefore, to effectively transfer power from the source to the load, the power conversion system must store the excess energy from the power source during time T<b>1</b> (shown as the shaded area S), and discharge the stored energy to the load during time T<b>2</b> (shown as the shaded area D).</p>
<p id="p-0005" num="0004"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a conventional system for converting DC power from a photovoltaic (PV) panel to AC power. The PV panel <b>10</b> generates a DC output current I<sub>PV </sub>at a typical voltage V<sub>PV </sub>of about 35 volts, but panels having other output voltages may be used. A DC/DC converter <b>12</b> boosts V<sub>PV </sub>to a link voltage V<sub>DC </sub>of a few hundred volts. A DC/AC inverter <b>14</b> converts the DC link voltage to an AC output voltage V<sub>GRID</sub>. In this example, the output is assumed to be 120VAC at 60 Hz to facilitate connection to a local power grid, but other voltages and frequencies may be used.</p>
<p id="p-0006" num="0005">The system of <figref idref="DRAWINGS">FIG. 2</figref> also includes a DC link capacitor C<sub>DC </sub>and a decoupling capacitor C<sub>1</sub>. Either or both of these capacitors may perform an energy storage function to balance the nominally steady power flow from the PV panel with the fluctuating power requirements of the grid. Power ripple within the system originate at the DC/AC inverter <b>14</b>, which must necessarily transfer power to the grid in the form of 120 Hz ripple. In the absence of a substantial energy storage device, this current ripple would be transferred all the way back to the PV panel where they would show up as fluctuations (or &#x201c;ripple&#x201d;) in the panel voltage V<sub>PV </sub>and/or current I<sub>PV</sub>. Therefore, the DC link capacitor C<sub>DC</sub>, or less often, the decoupling capacitor C<sub>1</sub>, is used to store enough energy on a cycle-by-cycle basis to reduce the ripple at the PV panel to an acceptable level.</p>
<p id="p-0007" num="0006">Ripple on a link capacitor also affects the downstream operation of the system. <figref idref="DRAWINGS">FIG. 3</figref> illustrates the instantaneous demand for voltage from an H-bridge type DC/AC inverter in comparison to the voltage available from a DC link capacitor that is maintained at a fixed voltage. As long as the DC link voltage is maintained above the peak voltage demand from the inverter (plus an extra amount for headroom), the inverter can produce the AC output with little or no harmonic distortion (HD) in the output voltage and current waveforms. Therefore, reducing ripple on the link capacitor is also beneficial from the perspective of the downstream operation of the system. The ripple can be reduced by using a larger capacitor, but increasing the size of a capacitor dramatically increases its cost.</p>
<p id="p-0008" num="0007">Moreover, in conventional systems, energy storage capacitors tend to be problematic components for several reasons. First, a capacitor that is large enough to provide adequate energy storage must generally be of the electrolytic type, since other large capacitors are usually prohibitively expensive. Electrolytic capacitors, however, have limited life spans and tend to have a high failure rate. As a further complication, the capacitance of an electrolytic capacitor steadily decreases over its lifetime as the electrolyte dissipates and/or deteriorates, thereby reducing its effectiveness and changing the dynamics of the entire system. Further, electrolytic capacitors tend to be bulky, heavy and fragile, and have a large equivalent series resistance (ESR). Thus, the capacitor in a conventional power conversion system is often the weakest link.</p>
<p id="p-0009" num="0008">In a relatively recent development, gains in reliability and other characteristics have been achieved by taking the opposite approach to sizing the link capacitor. See, e.g., U.S. Patent Application Publication Nos. 2010/0157638 and 2010/0157632 which are incorporated by reference. In such systems, rather than maximizing the size of the link capacitor to minimize the ripple, a smaller link capacitor is used, and the voltage on this capacitor is purposely allowed to vary over a relatively wide range as shown in <figref idref="DRAWINGS">FIG. 4</figref>. Relaxing the ripple voltage range in this manner may enable the size of the link capacitor to be reduced because the amount of energy stored in a capacitor is directly related to the voltage swing across the capacitor. This may also make it economically viable to use more reliable types of capacitors such as those having metal film or other non-electrolytic construction.</p>
<p id="p-0010" num="0009">As long as the minimums in the voltage available from the link capacitor do not drop below the voltage demanded from the inverter, distortion in the output voltage and/or current from the inverter can be held to an acceptable level using advanced algorithms such as those disclosed in the U.S. patent application Publications referenced above.</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a prior art control loop for regulating the voltage on a link capacitor in a system having relaxed ripple voltage requirements. A control signal CTRL controls a power stage <b>16</b> which in turn causes a certain amount of ripple on a DC link capacitor <b>18</b>. From the perspective of power flow, the power stage may be arranged before or after the link capacitor. From the perspective of the control loop, however, the power stage has a causal effect on the link capacitor voltage V<sub>DC</sub>, which is filtered by a low-pass filter <b>20</b> to generate an average value V<sub>AVE </sub>that is compared to a reference signal REF at a nulling circuit <b>22</b> to generate the control signal CTRL.</p>
<p id="p-0012" num="0011">The low-pass filter <b>20</b> has a cut-off frequency that is substantially lower than the ripple frequency of the DC link capacitor. For example, in a 60 Hz power system the capacitor experiences a 120 Hz ripple, so the cut-off frequency of the low-pass filter <b>20</b> may be set to about 240 Hz to filter out the harmonic distortion and provide a sine wave of 120 Hz.</p>
<p id="p-0013" num="0012">The reference signal REF is applied as a fixed or slowly varying signal with a time constant that is longer than the time constant of the low pass filter. The control loop attempts to balance the input and output power by controlling the output power injected into the load to match the available input power. The power withdrawn from the link capacitor is controlled so as to maintain an average target voltage across the capacitor. This average is maintained by reducing or increasing the current out of the capacitor into the DC/AC inverter. The minimum voltage across the capacitor must always be greater than the grid voltage in order for the inverter circuit to work without distorting the power injection onto the grid. In addition, the maximum voltage across the capacitor must be less than the rated capacitor voltage, with some additional safety margin to increase reliability of the system. Thus, the control loop causes the link capacitor voltage to slide up and down on a pedestal, which is the average value V<sub>AVE </sub>of the link capacitor voltage, to satisfy the requirements for power balance, safety margin, etc.</p>
<p id="p-0014" num="0013">A problem with the conventional approach is that the low-pass filter causes long delays in the feedback loop, so the system is slow to adapt to unpredictable changes in input power (e.g., solar) or output power (e.g., load connection/disconnection). If the capacitor voltage exceeds one of the safety margins, the input power may need to be switched off to avoid a capacitor overvoltage situation, or the load current may need to be reduced to avoid an under-voltage situation.</p>
<p id="p-0015" num="0014">If power into the system increases suddenly, or the output load decreases (i.e. the inverter output is disconnected), the system cannot respond fast enough, so a fast capacitor over-voltage condition occurs. One conventional response to this potentially destructive situation is to implement a fast over-voltage protection system to protect the capacitor. This response, however, increases the cost of the system and can significantly increase power dissipated within the inverter if it is used frequently.</p>
<p id="p-0016" num="0015">Another conventional response to a capacitor over-voltage condition is to completely switch off input power. Although this type of complete shut down typically takes longer to achieve, it can effectively neutralize an on-going uncorrectable power imbalance. However, switching off the power source may incur a large delay before power can be reapplied because the control loop cannot control a sudden application of input power due to its slow speed. Instead, a gradual power-up ramp is typically used. Moreover, in grid-tie inverter situations, once the inverter is disconnected from the grid, reconnection may require a mandatory waiting period of several minutes. This leads to reduced energy harvest from the power source such as a photovoltaic array.</p>
<p id="p-0017" num="0016">Likewise, if the power into the system drops suddenly, or an output load increases, the slow response of the control loop causes a fast capacitor under-voltage condition to occur, thereby causing distortion of the power injected onto the grid. While such a situation is typically not critical, it may cause the inverter power injection distortion to be non-compliant with regulations if it happens too frequently.</p>
<p id="p-0018" num="0017">In either case, greater DC link capacitor voltage margins may be used to compensate for the slow system response. However, this requires a DC link capacitor with a higher voltage rating which is more expensive. Higher DC link voltages may also increase the costs of other system components.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 1</figref> illustrates the mismatch between a DC power source and an AC load.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a prior art system for converting DC power from a photovoltaic panel to AC power.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 3</figref> illustrates the instantaneous demand for voltage from an inverter in comparison to the voltage available from a DC link capacitor that is maintained at a fixed voltage.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 4</figref> illustrates instantaneous demand for voltage from an inverter in comparison to the voltage available from a DC link capacitor having relaxed operating conditions.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a prior art control loop for regulating the voltage on a link capacitor in a system having relaxed ripple voltage requirements.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 6</figref> illustrates an embodiment of a power conversion system according to some inventive principles of this patent disclosure.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 7</figref> illustrates another embodiment of a power conversion system according to some inventive principles of this patent disclosure.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 8</figref> illustrates another embodiment of a power conversion system according to some inventive principles of this patent disclosure.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 9</figref> illustrates some example implementation details of another embodiment of a power conversion system according to some inventive principles of this patent disclosure.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 10</figref> illustrates an embodiment of a control loop for regulating the voltage on a link capacitor according to some inventive principles of this patent disclosure.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 6</figref> illustrates an embodiment of a power conversion system according to some inventive principles of this patent disclosure. The embodiment of <figref idref="DRAWINGS">FIG. 6</figref> includes a power converter <b>24</b> to transfer power from a power source to a load. The converter <b>24</b> includes a power stage <b>28</b> and an energy storage device <b>30</b> arranged to balance the instantaneous power available from the power source with the instantaneous power demand of the load. A controller <b>32</b> generates one or more control signals S<sub>C </sub>that cause the power stage <b>28</b> to control the flow of power to the energy storage device in response to a dynamic reference <b>34</b>.</p>
<p id="p-0030" num="0029">Either the power source or the load may have substantial fluctuations, for example, if the power source is an AC source, or the load is an AC load. The power source may include a PV panel, fuel cell, battery, wind turbine, etc. The power stage <b>28</b> may include one or more DC/DC converters, DC/AC inverters, rectifiers, etc. The energy storage device <b>30</b> may include one or more capacitors, inductors, etc. The load may include an AC grid load, a motor, a purely resistive load, etc. In one example embodiment, the power source includes a PV panel, the power stage <b>28</b> includes a DC/DC converter, and the energy storage device <b>30</b> includes a link capacitor.</p>
<p id="p-0031" num="0030">The controller <b>32</b> is arranged to control a parameter of the energy storage device in response to the dynamic reference <b>34</b>. For example, the energy storage device may be a capacitor, and the parameter may be the voltage of the capacitor. The controller may generate the dynamic reference in response to a model of the energy storage device and the input and output power conditions. The dynamic reference may be generated internally or obtained externally by the controller. The flow of power to or from the energy storage device may be controlled at a substantially higher speed than the power fluctuations in the power source and/or energy storage device.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 7</figref> illustrates another embodiment of a power conversion system according to some inventive principles of this patent disclosure. The embodiment of <figref idref="DRAWINGS">FIG. 7</figref> is similar to the embodiment of <figref idref="DRAWINGS">FIG. 6</figref> except that the order of the power stage <b>28</b> and energy storage device <b>30</b> is reversed.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 8</figref> illustrates another embodiment of a power conversion system according to some inventive principles of this patent disclosure. The embodiment of <figref idref="DRAWINGS">FIG. 8</figref> is similar to the embodiment of <figref idref="DRAWINGS">FIG. 6</figref>, but a second power stage <b>36</b> is included after the energy storage device <b>30</b>. As with the first power stage <b>28</b>, the second power stage <b>36</b> may include one or more DC/DC converters, DC/AC inverters, rectifiers, etc.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 9</figref> illustrates another embodiment of a power conversion system according to some inventive principles of this patent disclosure. The embodiment of <figref idref="DRAWINGS">FIG. 9</figref> illustrates some example implementation details in the context of an inverter system for connecting a photovoltaic (PV) power source to a grid, but the inventive principles are not limited to these specific details.</p>
<p id="p-0035" num="0034">The system of <figref idref="DRAWINGS">FIG. 9</figref> receives power from photovoltaic cells in a PV panel <b>38</b>. The system includes a DC/DC converter <b>40</b>, a link capacitor C<sub>DC</sub>, a DC/AC inverter <b>42</b>, and a controller <b>44</b> that operates in response to a dynamic reference <b>46</b>. The DC/DC converter may include one or more stages such as buck converters, boost converters, push-pull stages, rectifiers, etc., arranged as pre-regulators, main stages, etc. The DC/AC inverter <b>42</b> may include any suitable inverter topology such as an H-bridge with a buck front end, a resonant inverter, etc. Voltage and current sensors <b>48</b> and <b>50</b> provide signals indicating the PV panel output voltage V<sub>PV </sub>and current I<sub>PV</sub>, respectively, to the controller <b>44</b>. Voltage and current sensors <b>52</b> and <b>54</b> provide signals indicating the link voltage V<sub>DC </sub>and output current I<sub>OUT</sub>, respectively. The controller outputs a first control signal S<sub>C1 </sub>to control the DC/DC converter <b>40</b>, and a second control signal S<sub>C2 </sub>to control the DC/AC inverter <b>42</b>.</p>
<p id="p-0036" num="0035">Controller <b>44</b> implements a control algorithm with a much shorter time response in the control loop compared to the line cycles of the grid. This may be achieved by generating a dynamic internal reference voltage (or digital representation of that voltage) that indicates what the capacitor voltage should be given the known value of the link capacitor, and the known input and output power conditions. For example, in a 60 Hz power conversion system, the dynamic reference signal may be implemented as a 120 Hz waveform that defines the optimum values of the link capacitor voltage during each line cycle.</p>
<p id="p-0037" num="0036">The flow of power onto the grid or from the PV panel may then be controlled so that the unfiltered capacitor voltage follows this reference using a control loop that may have a much faster response time compared to the line cycles of the grid. The generation of the internal reference may be much more complex than in a conventional system, but is readily implementable on a modern digital signal processor (DSP). In essence, the system may be modeled in real-time, and the model may serve as the basis for generating the dynamic reference signal.</p>
<p id="p-0038" num="0037">This fast response time allows the system to adapt to changing loads or input power much more rapidly, reducing the rate of under-voltage or over-voltage events, and resulting in a more robust system without the use of a higher voltage link capacitor than is strictly necessary. While a capacitance over-voltage protection system may still be useful for safety, it may be less frequently needed.</p>
<p id="p-0039" num="0038">Furthermore, it is possible to generate sinusoidal margins of safety within which the DC link capacitor voltage is supposed to lie, and in which normal feedback control is applied. If the capacitor voltage goes outside these limits, then more drastic action can be taken.</p>
<p id="p-0040" num="0039">For example, if the capacitor voltage goes above the upper sinusoidal voltage limit, but is not already above the normal working voltage limit of the capacitor, then the system can proceed to dump more current into the load, if possible. This may distort the current injection into the grid, but only temporarily until normal control operation is restored. This reduces the probability of frequently dissipating excessive power into the capacitor system.</p>
<p id="p-0041" num="0040">Similarly, if the capacitor voltage falls below the lower limit sinusoid, but is not already at the grid voltage, then the system can immediately start to reduce injected power in a more gradual manner, rather than hitting the hard limit where the capacitance voltage equals the grid voltage (producing more severe injection distortion).</p>
<p id="p-0042" num="0041">In practice, the bandwidth of the DC link capacitor voltage control loop can be reduced to suit the available processing power in the DSP. A lower bandwidth reduces compute load at the expense of responsiveness, allowing the designer to trade off compute power and responsiveness to external power events. For example, a system may have 100 KHz sampling, and filtering down to 3 KHz sampling for the control loop, which may provide much better performance than the 120 Hz response dictated by conventional systems.</p>
<p id="p-0043" num="0042">Some example implementation details are provided in the APPENDIX, but the inventive principles are not limited to these details.</p>
<p id="p-0044" num="0043">Some additional inventive principles relate to the use of real-time modeling of one or more system components to determine a condition of the component, and then take one or more actions based on the condition. For example, in the example embodiment illustrated above with respect to <figref idref="DRAWINGS">FIG. 9</figref>, as the capacitor ages, the value of the capacitor gradually decreases and the voltage swing across the capacitor increases accordingly. The system model enables the value of the link capacitor to be determined by monitoring these small changes over time.</p>
<p id="p-0045" num="0044">If the capacitance deteriorates to a point that the system may no longer operate efficiently or effectively, the condition of the capacitor may be reported to a gateway or centralized control center using power-line communications, dedicated communication lines, wireless communications, or any other suitable form of communication. If the capacitance further deteriorates to a point that continued operation may pose a risk of damage, corrective action may be taken such as reducing the operating power level or disabling the system entirely.</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 10</figref> illustrates an embodiment of a control loop for regulating the voltage on a link capacitor according to some inventive principles of this patent disclosure. The embodiment of <figref idref="DRAWINGS">FIG. 10</figref> may be implemented, for example, using any of the systems of <figref idref="DRAWINGS">FIGS. 6-9</figref>. In the system of <figref idref="DRAWINGS">FIG. 10</figref>, the dynamic reference signal is compared by nulling circuit <b>56</b> to the substantially unfiltered feedback signal V<sub>DC </sub>from a DC link capacitor <b>60</b> or other energy storage device. The resulting control signal CTRL is used to control one or more power stages <b>58</b> which control the flow of power to the energy storage device.</p>
<p id="p-0047" num="0046">The inventive principles relating to determining and/or reporting conditions of system components are independent of the principles relating to dynamic references. For example, the inventive principles may implemented in a conventional centralized inverter to monitor and report the condition of one or more electrolytic capacitors, thereby enabling more efficient maintenance of inverter systems. This may eliminate the need for periodic manual checks on the condition of electrolytic capacitors, as well as eliminate failures due to unanticipated or unmonitored capacitor degradation.</p>
<p id="p-0048" num="0047">The inventive principles of this patent disclosure have been described above with reference to some specific example embodiments, but these embodiments can be modified in arrangement and detail without departing from the inventive concepts. Such changes and modifications are considered to fall within the scope of the following claims.</p>
<heading id="h-0005" level="1">APPENDIX</heading>
<p id="p-0049" num="0048">For DC link capacitance C with voltage Vc and input current Ic, Vc(t) essentially becomes the dynamic reference to which the capacitor voltage is controlled. The charge/discharge during inverter operation is given by:</p>
<p id="h-0006" num="0000">1) (power_in(t)&#x2212;power_out(t))/Vc(t)=Ic=C*dVc(t)/dt</p>
<p id="p-0050" num="0049">With voltage on the output related to the peak voltage:</p>
<p id="h-0007" num="0000">2a) V(t)=Vpk*sin (w*t)</p>
<p id="h-0008" num="0000">(where Vpk=sqrt(2)*Vrms) and in-phase current related to the peak current:</p>
<p id="h-0009" num="0000">2b) I(t)=Ipk*sin(w*t)</p>
<p id="h-0010" num="0000">provides the following:</p>
<p id="h-0011" num="0000">3) power_out(t)=Vpk*Ipk*sin (w*t)A2=Vpk*Ipk*(1&#x2212; cos (2*w*t))/2</p>
<p id="h-0012" num="0000">and the average of power in=average of power out. The average input power (which depends on panel illumination) is given by the DC term above:</p>
<p id="h-0013" num="0000">4) avg_RMS_power=Vpk*Ipk/2=avg_power_in</p>
<p id="h-0014" num="0000">so that</p>
<p id="h-0015" num="0000">5) avg_power_in&#x2212;power_out(t)=avg_RMS_power*cos(2*w*t)</p>
<p id="h-0016" num="0000">and therefore:</p>
<p id="h-0017" num="0000">6) avg_RMS_power*cos(<b>2</b>*w*t)=C*Vc*dVc/dt</p>
<p id="p-0051" num="0050">Solving the above differential equation gives:</p>
<p id="h-0018" num="0000">7) Vc(t)=sgrt(K^2+avg_RMS_power/(w*C)*sin(2*w*t))</p>
<p id="h-0019" num="0000">where K is the RMS value of Vc(t). Defining a quantity A proportional to voltage (note: power=energy/sec=&#xbd;*C*V^2) gives:</p>
<p id="h-0020" num="0000">8) A^2=avg_RMS_power/(w*C)=Vpk*Ipk/(2*w*C)</p>
<p id="h-0021" num="0000">and from (7):</p>
<p id="h-0022" num="0000">9) Vc(t)=sgrt(K^2+A^2*sin(2*w*t))</p>
<p id="p-0052" num="0051">Max(Vc(t)) and Min(Vc(t)) can be measured over one complete sin( )cycle (w can be measured by other means, or by asuming a 60 Hz or 50 Hz system), so:</p>
<p id="h-0023" num="0000">10) Max^2=K^2+A^2</p>
<p id="h-0024" num="0000">and</p>
<p id="h-0025" num="0000">11) Min^2=K^2&#x2212;A^2</p>
<p id="h-0026" num="0000">and therefore:</p>
<p id="h-0027" num="0000">12) K^2=(Max^2+Min^2)/2</p>
<p id="h-0028" num="0000">and</p>
<p id="h-0029" num="0000">13) A^2=(Max^2&#x2212;Min^2)/2</p>
<p id="p-0053" num="0052">If the average value of Vc(t)^2 is measured over exactly one cycle (t=Pi/w), K^2 can be obtained to a higher degree of accuracy.</p>
<p id="p-0054" num="0053">The bridge voltage is the absolute magnitude of the output voltage (2a):</p>
<p id="h-0030" num="0000">14) Vb(t)=Abs(V(t))</p>
<p id="h-0031" num="0000">so maintaining a+ve voltage difference between Vb(t) and Vc(t) is necessary for correct operation for all t. Therefore</p>
<p id="h-0032" num="0000">15) f(t)=sqrt(K^2+A^2*sin(2*w*t))&#x2212;Vb(t)&#x3e;=0</p>
<p id="p-0055" num="0054">K=Kmin must be found such that f(t)&#x3e;0 for all t.</p>
<p id="p-0056" num="0055">Note that Vb(t)*sin(w*t) is maximum in the first half of the sine, so from (2a) the more analytical form:</p>
<p id="h-0033" num="0000">16) Vb(t)=Vpk*sin(w*t)</p>
<p id="h-0034" num="0000">can be used instead of Abs(V(t)) in (14). Then:</p>
<p id="h-0035" num="0000">17) f(t)=sqrt(Kmin^2+A^2*sin(2*w*t))&#x2212;Vpk*sin(w*t)</p>
<p id="h-0036" num="0000">which must be &#x3e;=0 for all t. The two right-hand terms are both sinusoidal, with a fixed phase relationship, so for constant power in, a solution can be found for all t by examining one cycle of sin(w*t). Assuming f(t)=0 at Kmin:</p>
<p id="h-0037" num="0000">18) sqrt(Kmin^2+A^2*sin(2*w*t))=Vpk*sin(w*t)</p>
<p id="h-0038" num="0000">so that</p>
<p id="h-0039" num="0000">19) Kmin^2+A^2*sin(2*w*t)=Vpk^2*sin(w*t)^2</p>
<p id="h-0040" num="0000">and therefore</p>
<p id="h-0041" num="0000">20) Kmin^2=Vpk^2*sin(w*t)^2&#x2212;A^2*sin(2*w*t)</p>
<p id="p-0057" num="0056">Using the identity sin(x)^2=(1&#x2212; cos(2*x))/2:</p>
<p id="h-0042" num="0000">21) Kmin^2=Vpk^2*(1&#x2212; cos(2*w*t))/2&#x2212;A^2*sin(2*w*t)</p>
<p id="p-0058" num="0057">Differentiation (19) with respect to t and equating to zero to find a maxima/minima:</p>
<p id="h-0043" num="0000">22) A^2*2*w*cos(2*w*t)=Vpk^2*2*sin(w*t)*w*cos(w*t)</p>
<p id="p-0059" num="0058">Cancelling w and using sin(2x)=2*sin(x)*cos(x):</p>
<p id="h-0044" num="0000">23) 2*A^2*cos(2*w*t)=Vpk^2*sin(2*w*t) so that:</p>
<p id="h-0045" num="0000">24) tan(2*w*t)=2*A^2/Vpk^2 and therefore:</p>
<p id="h-0046" num="0000">25) cos(2*w*t)=Vpk^2/sqrt(Vpk^4+4*A^4)</p>
<p id="h-0047" num="0000">and</p>
<p id="h-0048" num="0000">26) sin(2*w*t)=2*A^2/sqrt(Vpk^4+4*A^4)</p>
<p id="p-0060" num="0059">Substituting these into (21):</p>
<p id="h-0049" num="0000">27) Kmin^2=Vpk^2/2&#x2212;(Vpk^4/2+2*A^4)/sqrt(Vpk^4+4*A^4)</p>
<p id="h-0050" num="0000">which simplifies to:</p>
<p id="h-0051" num="0000">28) Kmin^2=Vpk^2/2&#x2212;sqrt(Vpk^4+4*A^4)/2</p>
<p id="p-0061" num="0060">Now sqrt(Vpk^4+4*A^4) is always &#x3e;Vpk^2 for real values, so taking the negative root of (28) gives:</p>
<p id="h-0052" num="0000">29) Kmin^2=(Vpk^2+sqrt(Vpk^4+4*A^4))/2</p>
<p id="h-0053" num="0000">which is independent of w and t.</p>
<p id="p-0062" num="0061">Vpk is fairly constant (grid peak voltage), and A is invariant over the long term, even though it depends upon Ipk (8) which depends on solar panel output power. Therefore Kmin can be fairly reliably calculated. As K is measured, an extrapolation can be performed to guess whether K&#x3c;Kmin occurs. If it does not occur, then there is no voltage to drive the output, which may then become distorted. In this case Vc must begin to be increased early to avoid this possibility. This is accomplished by reducing Ipk (2b) to reduce power_out over the next cycle (3). This reduces power_out in (1), which if, over one power cycle of sin(2*w*t), is less than avg_power_in. This causes dVc(t)/dt to be positive, which increases Vc(t).</p>
<p id="p-0063" num="0062">Because A is a function of steady state RMS power (from the solar panels), and K is not determined by power levels, but is changed by the average energy stored in the capacitor, K needs to be recalculated for long term stability in a phase-locked loop. However, as Ipk is modified to do this, A (8) can be temporarily changed:</p>
<p id="h-0054" num="0000">30) d(A^2)=Vpk*dI/(2*w*C)</p>
<p id="p-0064" num="0063">Considering energy in C, if Ipk is at energy equilibrium, then K^2 changes by:</p>
<p id="h-0055" num="0000">31) C/2 d(K^2)=(power_in&#x2212;Vpk*Ipk/2)*t=&#x2212;Vpk*dI/2*pi/w</p>
<p id="h-0056" num="0000">in one power cycle (t=pi/w) period. Therefore</p>
<p id="h-0057" num="0000">32) d(K^2)=&#x2212;Vpk*dI*pi/(w*C)</p>
<p id="p-0065" num="0064">This effect dominates (30), so the non-cumulative changes in A can be ignored. Therefore if:</p>
<p id="h-0058" num="0000">33) Ipk+=dI</p>
<p id="h-0059" num="0000">does an update on Ipk each power cycle, then from (32):</p>
<p id="h-0060" num="0000">34) dI=(K^2&#x2212;Kcenter^2)*w*C/(Vpk*pi) should give stability as a feedback loop. Kcenter can be chosen as</p>
<p id="h-0061" num="0000">35) Kcenter^2=(Kmin^2+Kmax^2)/2</p>
<p id="h-0062" num="0000">where Kmin^2 is from (29), and from (8),(10):</p>
<p id="h-0063" num="0000">36) Kmax^2=Vmax^2&#x2212;A^2</p>
<p id="h-0064" num="0000">where Vmax is the maximum allowable voltage across the capacitor. Kcenter therefore depends on reasonably well known constants, Vmax, Vpk (29), average input power (4,8), w (8), and C (8). See the example below.</p>
<p id="p-0066" num="0065">The voltage-squared terms are used (Energy) because an equal likelihood of Ipk (power) being above or below the point of power equilibrium can be assumed. This provides an equally large guard band either side of Kcenter, allowing the PLL as much time as possible to compensate for solar input variations and load (output power) variations.</p>
<p id="p-0067" num="0066">For example:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0067">Vmax=600V</li>
        <li id="ul0002-0002" num="0068">Power_in =240W</li>
        <li id="ul0002-0003" num="0069">C=10 uF=le-<b>5</b>F</li>
        <li id="ul0002-0004" num="0070">f=60 Hz</li>
        <li id="ul0002-0005" num="0071">Vrms=240V
<br/>
so
</li>
        <li id="ul0002-0006" num="0072">w=2*pi*f=376.991</li>
        <li id="ul0002-0007" num="0073">A^2=Power in/(w*C)=63661.977 (4),(8)</li>
        <li id="ul0002-0008" num="0074">Kmax^2=Vmax^2&#x2212;A^2=360000-63661.978=296338.023</li>
        <li id="ul0002-0009" num="0075">Vpk=sqrt(2)*Vrms=339.411</li>
        <li id="ul0002-0010" num="0076">Kmin^2=(Vpk^2+sqrt(Vpk^4+4*A^4))/2=143452.241</li>
        <li id="ul0002-0011" num="0077">Kcenter^2=(Kmin^2+Kmax^2)/2=219895.132
<br/>
so
</li>
        <li id="ul0002-0012" num="0078">Kcenter=468.93 Volts</li>
    </ul>
    </li>
</ul>
</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An inverter to convert a direct current (DC) power from a DC source to an alternating current (AC) power, the inverter comprising:
<claim-text>a DC link capacitor;</claim-text>
<claim-text>an input stage electrically coupled to the DC link capacitor, the input stage configured to be electrically coupled to the DC source to receive a DC input power therefrom and generate a DC output waveform;</claim-text>
<claim-text>an output stage electrically coupled to the DC link capacitor and configured to convert the DC output waveform to an AC output waveform; and</claim-text>
<claim-text>a controller electrically coupled to the input stage and the DC link capacitor, the controller configured to:
<claim-text>(i) generate a dynamic reference signal as a function of a model of the DC link capacitor,</claim-text>
<claim-text>(ii) generate a control signal as a function of the dynamic reference signal and a measurement signal indicative of an operational parameter of the DC link capacitor, and</claim-text>
<claim-text>(iii) control the input stage using the control signal to control a flow of power to the DC link capacitor.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The inverter of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the model of the DC link capacitor is a function of a reference capacitance value of the DC link capacitor.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The inverter of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the controller is further configured to determine the present capacitance value of the DC link capacitor based on the operational parameter of the DC link capacitor and the dynamic reference signal.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The inverter of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the controller is further configured to:
<claim-text>determine a difference between the reference capacitance value of the DC link capacitor and the present capacitance value of the DC link capacitor, and</claim-text>
<claim-text>generate an alert in response to the difference being greater than a threshold amount.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The inverter of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein to generate the alert comprises to transmit a report indicating a condition of the DC link capacitor.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The inverter of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the report includes the present capacitance value of the DC link capacitor.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The inverter of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein to transmit the report comprises to transmit the report using power-line communications.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The inverter of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein to generate the alert comprises to generate an alert in response to the difference being greater than a first threshold, and wherein the controller is further to:
<claim-text>control operation of the input stage in response to the difference being greater than a second threshold that is greater than the first threshold.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The inverter of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the control is further to disable at least one of the input stage and the output stage in response to the difference being greater than the second threshold.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The inverter of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein to generate the dynamic reference signal comprises to generate a dynamic reference signal as a function of the model of the DC link capacitor, the DC input power of the input stage, and a DC input power of the output stage.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The inverter of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein to generate the control signal comprises to generate a control signal based on a difference between the dynamic reference signal and the measurement signal.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The inverter of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the dynamic reference signal is a voltage signal and the operational parameter is a voltage of the DC link capacitor.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The inverter of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein to control the input stage comprises to control the operational parameter of the DC link capacitor toward the dynamic reference signal.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A method for controlling a direct current-to-alternating current (DC-to-AC) inverter, the DC-to-AC inverter including a DC link capacitor, an input stage electrically connected to the DC link capacitor, and an output stage electrically connected to the DC link capacitor, the method comprising:
<claim-text>generating, by a controller of the DC-to-AC inverter, a dynamic reference signal as a function of a model of the DC link capacitor;</claim-text>
<claim-text>generating, by the controller, a control signal as a function of the dynamic reference signal and a measurement signal indicative of an operational parameter of the DC link capacitor, and</claim-text>
<claim-text>controlling, by the controller and using the control signal, the input stage of the inverter to control a flow of power to the DC link capacitor.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein generating the dynamic reference signal comprises generating a dynamic reference signal as a function of a model of the DC link capacitor based on a reference capacitance value of the DC link capacitor.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, further comprising determining the present capacitance value of the DC link capacitor based on the operational parameter of the DC link capacitor and the dynamic reference signal.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00016">claim 16</claim-ref>, further comprising:
<claim-text>determining a difference between the reference capacitance value of the DC link capacitor and the present capacitance value of the DC link capacitor, and</claim-text>
<claim-text>generating an alert in response to the difference being greater than a threshold amount.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein generating the alert comprises transmitting a report indicating a condition of the DC link capacitor.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein transmitting the report comprises transmitting the report using power-line communications.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The method of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein generating the alert comprises generating an alert in response to the difference being greater than a first threshold, and wherein the method further comprises:
<claim-text>disabling at least one of the input stage and the output stage in response to the difference being greater than a second threshold that is greater than the first threshold.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein:
<claim-text>generating the dynamic reference signal comprises generating a dynamic reference voltage signal, and</claim-text>
<claim-text>generating the control signal comprises generating the control signal as a function of the dynamic reference voltage signal and a measurement signal indicative of a voltage of the DC link capacitor.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. A system comprising:
<claim-text>a photovoltaic panel configured to generate a DC power output</claim-text>
<claim-text>a DC-to-AC inverter comprising:
<claim-text>a DC link capacitor;</claim-text>
<claim-text>an input stage having an input electrically coupled to the photovoltaic panel to receive the DC power output therefrom and an output electrically coupled to the DC link capacitor;</claim-text>
<claim-text>an output stage having an input electrically coupled to the DC link capacitor;</claim-text>
<claim-text>a first voltage sensor configured to generate a first voltage signal indicative of an input voltage of the input stage;</claim-text>
<claim-text>a first current sensor configured to generate a second current signal indicative of an input current of the input stage;</claim-text>
<claim-text>a second voltage sensor configured to generate a second voltage signal indicative of a voltage of the DC link capacitor;</claim-text>
<claim-text>a second current sensor configured to generate a second current signal indicative of an output current; and</claim-text>
<claim-text>a controller electrically coupled to the input stage and configured to:
<claim-text>(i) generate a dynamic reference voltage signal as a function of a model of the DC link capacitor, the first voltage signal, the first current signal, the second voltage signal, and the second current signal,</claim-text>
<claim-text>(ii) generate a control signal as a function of the dynamic reference voltage signal and a measurement signal indicative of the voltage of the DC link capacitor, and</claim-text>
<claim-text>(iii) control the input stage using the control signal to control a flow of power to the DC link capacitor.</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
