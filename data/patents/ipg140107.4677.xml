<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625765-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625765</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13363971</doc-number>
<date>20120201</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>CN</country>
<doc-number>2005 1 0055231</doc-number>
<date>20050316</date>
</priority-claim>
<priority-claim sequence="02" kind="national">
<country>CN</country>
<doc-number>2005 1 0063128</doc-number>
<date>20050404</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<disclaimer>
<text>This patent is subject to a terminal disclaimer.</text>
</disclaimer>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>M</subclass>
<main-group>3</main-group>
<subgroup>42</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>M</subclass>
<main-group>3</main-group>
<subgroup>46</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>M</subclass>
<main-group>3</main-group>
<subgroup>54</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>37920102</main-classification>
<further-classification>3792011</further-classification>
<further-classification>3792072</further-classification>
<further-classification>37921101</further-classification>
</classification-national>
<invention-title id="d2e88">Method and system for intelligent routing</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5247571</doc-number>
<kind>A</kind>
<name>Kay et al.</name>
<date>19930900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5422941</doc-number>
<kind>A</kind>
<name>Hasenauer et al.</name>
<date>19950600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6134314</doc-number>
<kind>A</kind>
<name>Dougherty et al.</name>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6631258</doc-number>
<kind>B1</kind>
<name>Chow et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6711156</doc-number>
<kind>B1</kind>
<name>Gourraud</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6745025</doc-number>
<kind>B1</kind>
<name>Chow et al.</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7260203</doc-number>
<kind>B2</kind>
<name>Holt et al.</name>
<date>20070800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>7680259</doc-number>
<kind>B2</kind>
<name>Kent, Jr. et al.</name>
<date>20100300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2002/0122547</doc-number>
<kind>A1</kind>
<name>Hinchey et al.</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2002/0168061</doc-number>
<kind>A1</kind>
<name>Bruening et al.</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2003/0112948</doc-number>
<kind>A1</kind>
<name>Brown et al.</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2004/0208305</doc-number>
<kind>A1</kind>
<name>Gross et al.</name>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>CN</country>
<doc-number>1270747</doc-number>
<kind>A</kind>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>CN</country>
<doc-number>1309861</doc-number>
<kind>A</kind>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>CN</country>
<doc-number>1409526</doc-number>
<kind>A</kind>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>WO</country>
<doc-number>WO 93/17515</doc-number>
<kind>A1</kind>
<date>19930900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>WO</country>
<doc-number>WO 9965214</doc-number>
<kind>A1</kind>
<date>19991200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>WO</country>
<doc-number>WO 00/35175</doc-number>
<kind>A1</kind>
<date>20000600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>WO</country>
<doc-number>WO 01/72008</doc-number>
<kind>A2</kind>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00020">
<othercit>U.S. Appl. No. 11/845,611 (Jan. 30, 2012).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00021">
<othercit>Written Opinion of the International Searching Authority in corresponding PCT Application No. PCT/CN2006/000344 (Jun. 15, 2006).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00022">
<othercit>International Search Report in corresponding PCT Application No. PCT/CN2006/000344 (Jun. 15, 2006).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00023">
<othercit>1st Office Action in corresponding European Application No. 06705730.7 (Feb. 17, 2010).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00024">
<othercit>2nd Office Action in corresponding European Application No. 06705730.7 (Sep. 5, 2011).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00025">
<othercit>3<sup>rd </sup>Office Action in related U.S. Appl. No. 11/845,611 (Feb. 17, 2012).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00026">
<othercit>Extended European Search Report in corresponding European Patent Application No. 06705730.7 (Dec. 10, 2008).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00027">
<othercit>4<sup>th </sup>Office Action in corresponding European Patent Application No. 06705730.7 (Nov. 20, 2012).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00028">
<othercit>3<sup>rd </sup>Office Action in corresponding European Patent Application No. 06705730.7 (Aug. 21, 2012).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00029">
<othercit>5<sup>th </sup>Office Action in corresponding European Patent Application No. 06705730.7 (Jun. 5, 2013).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>19</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>37920101</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>37920102</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>3792011</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>37920112</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>37920702</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>37921102</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>2</number-of-drawing-sheets>
<number-of-figures>4</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>11845611</doc-number>
<date>20070827</date>
</document-id>
<parent-status>PENDING</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13363971</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>PCT/CN2006/000344</doc-number>
<date>20060308</date>
</document-id>
<parent-status>PENDING</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>11845611</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120128145</doc-number>
<kind>A1</kind>
<date>20120524</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Shi</last-name>
<first-name>Youzhu</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Shi</last-name>
<first-name>Youzhu</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Leydig, Voit &#x26; Mayer, Ltd.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Huawei Technologies Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Hong</last-name>
<first-name>Harry</first-name>
<department>2652</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Embodiments of the present invention provide methods and systems for intelligent routing. An intelligent routing processing module sets at least one intelligent routing trigger condition and at least one corresponding intelligent routing policy in advance, and an incoming call or message is processed according to intelligent routing contact manners in the intelligent routing policy. The intelligent routing trigger condition includes relevant information of the incoming call or message and the intelligent routing policy may include more than one intelligent routing contact manner. The embodiments of the present invention may provide more intelligent routing contact manners and intelligent routing policies for communication routing technology and may make full use of subscriber presence information.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="121.41mm" wi="134.28mm" file="US08625765-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="236.39mm" wi="175.09mm" file="US08625765-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="215.22mm" wi="158.75mm" file="US08625765-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is a continuation application of U.S. patent application Ser. No. 11/845,611, filed on Aug. 27, 2007, which is a continuation of International Patent Application No. PCT/CN2006/000344, filed on Mar. 8, 2006. The International Patent Application claims priority to Chinese Patent Application No. 200510055231.3, filed on Mar. 16, 2005, and Chinese Patent Application No. 200510063128.3, filed on Apr. 4, 2005. The afore-mentioned patent applications are hereby incorporated by reference in their entireties.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to a routing technique in the field of communication technologies, and particularly, to methods and systems for intelligent routing.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTIONS</heading>
<p id="p-0004" num="0003">In conventional circuit switched domain services, a subscriber may subscribe to at least one of multiple called side services, such as call waiting, call forwarding unconditional, call forwarding busy and call forwarding no reply. The multiple called side services provide for incoming calls different called side contact manners of forwarding and waiting. The multiple called side services are independent of each other and their trigger points are set as the following three: the called party being busy, the called party giving no answer and without conditions, which cover limited application scenarios, e.g., a scenario that the subscriber hopes to forward a call during meeting is not covered.</p>
<p id="p-0005" num="0004">With the development of voice services over packet switched domain, a call intelligent routing service has emerged currently. The call intelligent routing service is customized by a subscriber in advance, and provides different forwarding patterns for incoming calls based on subscriber presence information, such as serial call forwarding, parallel call forwarding, call forwarding to voice mailbox, and call information converted to text information. The subscriber may publish his presence information, such as &#x201c;I'm in a meeting&#x201d;, in a packet switched domain through network messages such as the Session Initiation Protocol (SIP) PUBLISH message. The scenario that the user hopes to forward the call during meeting is thus fulfilled. However, the inventor of the present invention finds that there are still disadvantages below of the conventional technical scheme.</p>
<p id="p-0006" num="0005">Firstly, called contract modes provided for incoming calls are mainly limited to call forwarding services and do not cover other effective routing contact manners such as call waiting, queue, and call record converted to email. Therefore there are few routing contact manners.</p>
<p id="p-0007" num="0006">Secondly, there is a lack of the call intelligent routing service for user groups, e.g., a Centrex group and a pickup group, there is no more than one intelligent routing policy based on different called attribute identities such as a called number or a group number to which the called party belongs either.</p>
<p id="p-0008" num="0007">Thirdly, the subscriber presence information, as one of the trigger conditions for intelligent routing, includes explicit presence information and implicit presence information; the former is the presence information published in the network by the subscriber in certain manner, while the latter is the natural presence information of the subscriber terminal in the network, such as the device connection status, service applications, and network locations and types. However, not all the possible implicit presence information can be fully used currently, and it is hard for the subscriber, while customizing services, to precisely describe a status of the subscriber when an intelligent routing service is triggered.</p>
<p id="p-0009" num="0008">Moreover, all conventional messaging services, such as Instant Messaging (IM), Short Message Service (SMS), a Multimedia Messaging Service (MMS), email, voice mail, fax, and paging messaging, have their own application networks respectively. In order to effectively unify these messaging services, a unified messaging service has emerged in the industry. The unified messaging service integrates the messaging services which were previously carried out respectively through networks such as the telephone network, the paging network, the mobile network and the Internet, such that a subscriber may receive messages from various messaging services in any manner, for example, a voice message may be sent through email as the attachment of the email.</p>
<p id="p-0010" num="0009">To be brief, a unified messaging system may be regarded as an integrated mailbox which may store and forward information of all types from various terminals, including the instant messages, short messages, multimedia messages, email, voice massages, fax and Paging messages. A subscriber may send and receive all these messages anywhere and anytime through devices such as a telephone, a fax machine, a personal computer (in communication with the Internet), a cell phone and a pager.</p>
<p id="p-0011" num="0010">However, applications of a unified messaging service are still limited because the unified messaging service focuses on the conversion between different types of messages and provides a system framework application that is comparatively fixed, e.g., a unified messaging email box may be provided for the subscriber and all the information received is converted into email to be sent to the subscriber. There are not comprehensive pre-customized intelligent routing policies for all types of messaging services above, for example:</p>
<p id="p-0012" num="0011">the conversion of various incoming messages is a main service provided, while no other effective contact manner, such as message forwarding or message converted to call, is provided;</p>
<p id="p-0013" num="0012">the unified messages may not be processed based on all possible presence information of the destination subscriber, and there is no effective conjunction with other related applications, e.g., the presence information may not be in conjunction with real-time call control; as a result, classified demands of the subscriber may not be satisfied, e.g., the subscriber may wish a short message sent from his family to be converted into a voice call that may be answered through an onboard mobile phone while he/she is driving and is unable to check a short message;</p>
<p id="p-0014" num="0013">the unified messages may not be processed for user groups including the Centrex group and the pickup group, and there are not intelligent routing policies based on different called attribute identities, such as a called number or a group number to which the called party belongs.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0015" num="0014">The present invention provides methods and systems for intelligent routing to solve the problem in the prior art of communication routing technology with regard to the lack of routing contact manners and routing policies and the problem that subscriber status information cannot be fully utilized.</p>
<p id="p-0016" num="0015">The technical scheme in accordance with embodiments of the present invention is described below.</p>
<p id="p-0017" num="0016">In an embodiment, a method for intelligent routing includes:</p>
<p id="p-0018" num="0017">triggering an incoming call to an intelligent routing processing module at a designated trigger point;</p>
<p id="p-0019" num="0018">triggering, by the intelligent routing processing module, an intelligent routing service, acquiring relevant information of the incoming call and composing at least one intelligent routing trigger condition of the incoming call with the relevant information;</p>
<p id="p-0020" num="0019">matching the intelligent routing trigger condition of the incoming call with preset intelligent routing trigger conditions and obtaining at least one intelligent routing policy including at least one intelligent routing contact manner; and</p>
<p id="p-0021" num="0020">routing the incoming call according to the intelligent routing contact manner in the intelligent routing policy.</p>
<p id="p-0022" num="0021">In an embodiment, a system for intelligent routing includes:</p>
<p id="p-0023" num="0022">a call session control function unit, adapted for triggering an incoming call;</p>
<p id="p-0024" num="0023">an intelligent routing processing module, in communication with the call session control function unit, adapted for receiving the incoming call from the call session control function unit, performing logic control for an intelligent routing service; and</p>
<p id="p-0025" num="0024">a subscriber presence information processing module, in communication with one of the intelligent routing processing module and the call session control function unit, adapted for collecting and publishing subscriber presence information and providing the subscriber presence information for the intelligent routing processing module.</p>
<p id="p-0026" num="0025">In an embodiment, a method for intelligent routing includes:</p>
<p id="p-0027" num="0026">triggering an incoming message to an intelligent routing processing module;</p>
<p id="p-0028" num="0027">triggering, by the intelligent routing processing module, an intelligent routing service, acquiring relevant information of the incoming message and composing at least one intelligent routing trigger condition of the incoming message with the relevant information of the incoming message;</p>
<p id="p-0029" num="0028">matching, by the intelligent routing processing module, the intelligent routing trigger condition of the incoming message with preset intelligent routing trigger conditions, obtaining at least one intelligent routing policy which comprises at least one intelligent routing contact manner and sending the intelligent routing policy to a unified messaging server; and</p>
<p id="p-0030" num="0029">routing, by the unified messaging server, the incoming message according to the intelligent routing contact manner in the intelligent routing policy.</p>
<p id="p-0031" num="0030">In an embodiment, a system for intelligent routing includes:</p>
<p id="p-0032" num="0031">a unified messaging server, adapted for triggering an incoming message, processing the incoming message according to an intelligent routing policy;</p>
<p id="p-0033" num="0032">an intelligent routing processing module, in communication with the unified messaging server, adapted for acquiring the intelligent routing policy according to the incoming message triggered by the unified messaging server, and providing the intelligent routing policy for the unified messaging server; and</p>
<p id="p-0034" num="0033">a subscriber presence information processing module, in communication with the intelligent routing processing module, adapted for collecting and publishing subscriber presence information, and providing the subscriber presence information for the intelligent routing processing module.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic diagram illustrating the structure of a system for intelligent routing in accordance with an embodiment of the present invention.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 2</figref> is a flowchart of a method for intelligent routing in accordance with an embodiment of the present invention.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 3</figref> is a schematic diagram illustrating the structure of a system for intelligent routing in accordance with an embodiment of the present invention.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart of a method for intelligent routing in accordance with an embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0039" num="0038">Embodiments of the present invention are described with reference to accompanying drawings.</p>
<p id="p-0040" num="0039">According to an embodiment of the present invention, an intelligent routing processing module sets intelligent routing trigger conditions and intelligent routing policies in advance, and processes an incoming call or message in accordance with an intelligent routing contact manner in the intelligent routing policy. The intelligent routing trigger conditions include relevant information of the incoming call or message, and the intelligent routing policy may include one or more intelligent routing contact manners. The relevant information of the incoming call or message includes the called attribute identity, the incoming call attribute, the called presence information and the current time.</p>
<p id="p-0041" num="0040">A method and a system for intelligent routing in accordance with an embodiment of the present invention provide, for a voice or video call with a designated destination, a call intelligent routing service based on one or more called attribute identities, the incoming call attribute, the called presence information and the current time, such that the incoming call may be processed according to one or more intelligent routing contact manners in the intelligent routing policy customized in advance by a destination subscriber. The incoming call will be processed until an application of a contact manner succeeds (the application of announcement pickup excluded) or until all the intelligent routing contact manners have been handled.</p>
<p id="p-0042" num="0041">The intelligent routing system provided by the embodiment of the present invention is shown in <figref idref="DRAWINGS">FIG. 1</figref>, including a call session control function unit, an intelligent routing processing module in communication with the call session control function unit, a subscriber presence information processing module in communication with the intelligent routing processing module or in communication with the call session control function unit, and a unified messaging server.</p>
<p id="p-0043" num="0042">The call session control function unit provides, for the calls of a subscriber, processing functions including session proceeding, addressing, session status management, etc. The call session control function unit is an independent physical device, such as a soft switch. The subscriber may access, in certain manner, the call session control function unit that is registered to the home domain of the subscriber.</p>
<p id="p-0044" num="0043">The intelligent routing processing module provides the subscriber with hosting environment of logic control of intelligent routing service, it may be an independent physical device, e.g., an application server, in such a case, an interface I1 is a Session Initiation Protocol (SIP) interface; or the intelligent routing processing module may be resident, with an interface I1 being a self-defining internal interface, in the call session control function unit.</p>
<p id="p-0045" num="0044">The subscriber presence information processing module collects and publishes subscriber presence information, and provides subscriber presence information needed in service control for the call intelligent routing service. The subscriber presence information includes explicit presence information and implicit presence information. The subscriber presence information processing module may be a logic function network element, and the logic function network element is in communication and interacts with the intelligent routing processing module through the interface I2, or is in communication with the call session control function unit through the interface I2 and interacts with the intelligent routing processing module via the call session control function unit. The subscriber presence information processing module may be an independent physical device such as a presence server, at this point, the interface I2 is an SIP interface through which the subscriber presence information is sent to the intelligent routing processing module. Optionally, the subscriber presence information processing module may be resident, with the interface I2 being a self-defining internal interface, in the intelligent routing processing module.</p>
<p id="p-0046" num="0045">The unified messaging server processes various types of messages, generates and sends the email, SMS, MMS and IM for the call intelligent routing service. The unified messaging server is usually an independent physical device which is in communication connection with and interacts with the intelligent routing processing module through the interface I3, or is in communication connection with the call session control function unit through the interface I3 and interacts with the intelligent routing processing module via the call session control function unit. The Interface I3 is an SIP interface.</p>
<p id="p-0047" num="0046">The destination subscriber in the embodiment of the present invention has an identifiable unique public identity in a communication network, i.e., a called number, which may be a telephone number of the destination subscriber, a Uniform Resource Locator (URL) address, a special service number, a telephone exchange number, etc.</p>
<p id="p-0048" num="0047">In the intelligent routing method and system provided in the embodiment of the present invention, the called attribute identity may be the called number or the number of the user group to which the called party belongs, and the intelligent routing trigger condition includes the called attribute identity, the incoming call attribute, the called presence information and the current time. An intelligent routing trigger condition may correspond to multiple intelligent routing contact manners including incoming call barring, serial call forwarding, parallel call forwarding, call forwarded to voice mailbox or secretary station, call converted to email, call converted to data message, call distributing, call waiting, queue, announcement pickup and callback register.</p>
<p id="p-0049" num="0048">The intelligent routing processing module acquires a destination address, i.e. the called number, from an initial incoming call and records the destination address as the called attribute identity. The intelligent routing processing module may also search attribute data sheets of the called party, obtain the valid number of a group to which the called party belongs, such as a Centrex group number or a pickup group number, and record the valid number of a group as the called attribute identity. The pickup group is a group in which all group members may pick up an incoming call in a same way.</p>
<p id="p-0050" num="0049">From the initial incoming call, the intelligent routing processing module may also acquire and record attributes of the incoming call, which may include one or any combination of the caller number, the media type of the incoming call and the call attribute of the incoming call. The media type of the incoming call refers to media capability and coding modes supported by the incoming call, such as voice and video. The incoming call attribute may be distance call, Centrex in-group call, Centrex out-group call, etc.</p>
<p id="p-0051" num="0050">The called presence information is one or the combination of the explicit presence information and the implicit presence information of the called party. The explicit presence information is presence information published by the subscriber in a network by a means, e.g. by an SIP PUBLISH message which is from the subscriber terminal to the network and contains the presence information; the implicit presence information is current natural presence information of the subscriber terminal in the network, such as connection statuses of devices, service applications, and location and type of the visited network. The methods through which the intelligent routing processing module acquires the subscriber presence information include the following.</p>
<p id="p-0052" num="0051">Method A: the call session control function unit of the home domain of the called party triggers a message containing the subscriber presence information to the intelligent routing processing module, such as the SIP PUBLISH message, call signaling message, network registration message and network de-registration message. The intelligent routing processing module acquires and records the subscriber presence information; Method B: the subscriber presence information is maintained and managed by the presence server in the network, and the intelligent routing processing module subscribes to the subscriber presence information needed at the presence server, e.g., subscribes through an SIP SUBSCRIBE message; the presence server informs, e.g., through an SIP NOTIFY message, the intelligent routing processing module of the subscriber presence information when a subscription message is received or when the subscriber presence information changes.</p>
<p id="p-0053" num="0052">The destination subscriber has to customize intelligent routing trigger conditions and corresponding intelligent routing contact manners in advance so as to utilize intelligent routing services. Generally, the intelligent routing trigger conditions and corresponding intelligent routing contact manners may be designed in the form of a data sheet called a call intelligent routing service data sheet. As the called attribute identity may be the called number or the number of the user group to which the called party belongs, such as a Centrex group number or a pickup group number, there are multiple call intelligent routing service data sheets, such as a user call intelligent routing service data sheet, a Centex group call intelligent routing service data sheet, and a pickup group call intelligent routing service data sheet. Table 1 and Table 2 below show the exemplary designs of the user call intelligent routing service data sheet and the Centex group call intelligent routing service data sheet respectively (the two data sheets shown do not include all possible fields and are not the only format of such data sheets).</p>
<p id="p-0054" num="0053">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="147pt" align="center"/>
<colspec colname="2" colwidth="56pt" align="center"/>
<colspec colname="3" colwidth="70pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="3" rowsep="1">TABLE 1</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry/>
<entry>Intelligent routing</entry>
</row>
<row>
<entry>Intelligent routing trigger conditions</entry>
<entry/>
<entry>contact manners</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="6">
<colspec colname="1" colwidth="49pt" align="center"/>
<colspec colname="2" colwidth="35pt" align="center"/>
<colspec colname="3" colwidth="42pt" align="center"/>
<colspec colname="4" colwidth="21pt" align="center"/>
<colspec colname="5" colwidth="56pt" align="center"/>
<colspec colname="6" colwidth="70pt" align="center"/>
<tbody valign="top">
<row>
<entry>Called number</entry>
<entry>Incoming</entry>
<entry>Called</entry>
<entry>Time</entry>
<entry>Processing order</entry>
<entry>Incoming call barring</entry>
</row>
<row>
<entry/>
<entry>call</entry>
<entry>presence</entry>
<entry/>
<entry>No.</entry>
<entry>Serial call forwarding</entry>
</row>
<row>
<entry/>
<entry>attribute</entry>
<entry>information</entry>
<entry/>
<entry/>
<entry>Parallel call forwarding</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Call forwarded to voice</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>mailbox or secretary</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>station</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Call converted to email</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Call converted to data</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>message</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Call distributing</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Call waiting</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Queue</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Announcement pickup</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Callback register</entry>
</row>
<row>
<entry namest="1" nameend="6" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0055" num="0054">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="6">
<colspec colname="1" colwidth="56pt" align="center"/>
<colspec colname="2" colwidth="35pt" align="center"/>
<colspec colname="3" colwidth="42pt" align="center"/>
<colspec colname="4" colwidth="21pt" align="center"/>
<colspec colname="5" colwidth="35pt" align="center"/>
<colspec colname="6" colwidth="84pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="6" rowsep="1">TABLE 2</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="6" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Intelligent routing</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="154pt" align="center"/>
<colspec colname="2" colwidth="35pt" align="center"/>
<colspec colname="3" colwidth="84pt" align="center"/>
<tbody valign="top">
<row>
<entry>Intelligent routing trigger conditions</entry>
<entry/>
<entry>contact manners</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="6">
<colspec colname="1" colwidth="56pt" align="center"/>
<colspec colname="2" colwidth="35pt" align="center"/>
<colspec colname="3" colwidth="42pt" align="center"/>
<colspec colname="4" colwidth="21pt" align="center"/>
<colspec colname="5" colwidth="35pt" align="center"/>
<colspec colname="6" colwidth="84pt" align="center"/>
<tbody valign="top">
<row>
<entry>Number of the</entry>
<entry>Incoming</entry>
<entry>Called</entry>
<entry>Time</entry>
<entry>Processing</entry>
<entry>Incoming call barring</entry>
</row>
<row>
<entry>Centrex group to</entry>
<entry>call</entry>
<entry>presence</entry>
<entry/>
<entry>order No.</entry>
<entry>Serial Call Forwarding</entry>
</row>
<row>
<entry>which the called</entry>
<entry>attribute</entry>
<entry>information</entry>
<entry/>
<entry/>
<entry>Parallel call forwarding</entry>
</row>
<row>
<entry>party belongs</entry>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Call forwarded to voice </entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>mailbox or secretary station</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Call converted to email</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Call converted to data </entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>message</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Call distributing</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Call waiting</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Queue</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Announcement pickup</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Callback register</entry>
</row>
<row>
<entry namest="1" nameend="6" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0056" num="0055">The processing order number (No.) includes Arabic numerals starting from 1, indicating the processing order of the contact manners of an intelligent routing policy. Eleven intelligent routing contact manners are given in the examples above and every entry set by the destination subscriber in the data sheet may include only one contact manner, i.e., an intelligent routing trigger condition plus a processing order number matches only one contact manner. An identical intelligent routing trigger condition may correspond to one or more contact manners with different processing order numbers, and multiple contact manners organized in a series according to their processing order numbers compose an intelligent routing policy.</p>
<p id="p-0057" num="0056">The destination subscriber may set the call intelligent routing service data sheets above according to his own wish, and the data in the data sheets will be loaded into the intelligent routing processing module. The called attribute identity herein is a required field while the fields of incoming call attribute, called presence information and time are optional. If the destination subscriber does not set a value for an optional field, the field will not be considered while matching the intelligent routing trigger conditions.</p>
<p id="p-0058" num="0057">The flowchart of a method for intelligent routing provided by an embodiment of the present invention is shown in <figref idref="DRAWINGS">FIG. 2</figref>, including the following.</p>
<p id="p-0059" num="0058">Block <b>21</b>: a call session control function unit of the home domain of the called party triggers an incoming call, e.g., a voice or video incoming call, at a designated trigger point to an intelligent routing processing module without any condition or according to the static configuration data.</p>
<p id="p-0060" num="0059">In the process of triggering the incoming call to the intelligent routing processing module at the designated trigger point, the call session control function unit triggers the incoming call to the intelligent routing processing module only when an initial incoming call is received, or only when a failure response to the initial incoming call is received.</p>
<p id="p-0061" num="0060">Block <b>22</b>: the intelligent routing processing module triggers intelligent routing services, generates at least one intelligent routing trigger condition for the incoming call according to the called attribute identity and the incoming call attribute that are acquired from the incoming call, the called presence information and the current time.</p>
<p id="p-0062" num="0061">The intelligent routing processing module generates one intelligent routing trigger condition according to certain called attribute identity, the incoming call attribute and the called presence information plus current time; or the intelligent routing processing module generates multiple intelligent routing trigger conditions according to more than one different called attribute identities respectively and the same incoming call attribute, the called presence information and the current time.</p>
<p id="p-0063" num="0062">The trigger point at which the intelligent routing processing module triggers the call intelligent routing service for an identical incoming call can be one of the following three scenarios:</p>
<p id="p-0064" num="0063">firstly, the intelligent routing processing module triggers the intelligent routing service once only in response to receiving the initial incoming call;</p>
<p id="p-0065" num="0064">secondly, the intelligent routing processing module triggers the intelligent routing service once only in response to receiving a first failure response to the incoming call;</p>
<p id="p-0066" num="0065">thirdly, when the intelligent routing processing module has triggered the intelligent routing service once in response to receiving the initial incoming call and the application of the intelligent routing service has failed, the intelligent routing processing module triggers the intelligent routing service once again only in response to receiving the first failure response to the incoming call.</p>
<p id="p-0067" num="0066">Block <b>23</b>: match the generated intelligent routing trigger condition with preset intelligent routing trigger conditions. When a preset intelligent routing trigger condition is found to be matched with the generated intelligent routing trigger condition, preset intelligent routing contact manners may be obtained. Through matching the generated intelligent routing trigger condition, multiple intelligent routing contact manners in a series according to their processing order numbers are obtained and an intelligent routing policy is composed.</p>
<p id="p-0068" num="0067">In the embodiment of the present invention, the called attribute identity may be the called number and the numbers of the user groups to which the called party belongs at the same time, thus there may be one or more intelligent routing trigger conditions for one incoming call. When the intelligent routing processing module triggers the intelligent routing service, the intelligent routing processing module matches different called attribute identities (e.g., the called number, the Centrex group number of the called party and the pickup group number of the called) and the same incoming call attribute, called presence information and current time with all possible preset intelligent trigger conditions in turn, so as to obtain at least one routing policy.</p>
<p id="p-0069" num="0068">As shown in Table 1, the intelligent routing processing module searches the user call intelligent routing service data sheet according to the called number, incoming call attribute, called presence information and current time, and obtains a user intelligent routing policy if the searching succeeds. As shown in Table 2, if the called party also has a valid group number, such as a Centrex group number, the intelligent routing processing module also searches the Centrex group call intelligent routing service data sheet according to the Centrex group number, incoming call attribute, called presence information and current time, and obtains a Centrex group intelligent routing policy if the searching succeeds.</p>
<p id="p-0070" num="0069">Block <b>24</b>: the intelligent routing processing module processes the incoming call according to the intelligent routing contact manners in the obtained intelligent routing policy.</p>
<p id="p-0071" num="0070">When more than one intelligent routing policy is obtained, the intelligent routing processing module may handle every intelligent routing policy according to agreed or preset order, or may apply only the intelligent routing policy with the highest priority according to agreed or preset priority.</p>
<p id="p-0072" num="0071">The intelligent routing contact manners in the intelligent routing policy provided by the embodiment of the present invention may be one or any orderly combination of incoming call barring, serial call forwarding, parallel call forwarding, call forwarded to voice mailbox or secretary station, call converted to email, call converted to data message, call distributing, call waiting, queue, announcement pickup and callback register; however, the intelligent routing contact manners provided by the embodiment of the present invention are not limited to the above and may include other intelligent routing contact manners. The intelligent routing processing module applies each intelligent routing contact manner according to the predetermined order until the application of a contact manner succeeds (the application of announcement pickup excluded), thus the call intelligent routing service is terminated even if there are other preset contact manners or other intelligent routing policies left unprocessed. Optionally, when the applications of all contact manners fail (the application of announcement pickup excluded), the intelligent routing processing module continues with other intelligent routing policies if there are still other intelligent routing policies to be processed; otherwise, the call intelligent routing service is terminated.</p>
<p id="p-0073" num="0072">The method through which the intelligent routing processing module processes the incoming call according to the obtained intelligent routing policy includes the following processing patterns.</p>
<p id="p-0074" num="0073">First, the destination subscriber sets a contact manner of incoming call barring in the intelligent routing policy, showing that he bars the incoming call. The intelligent routing processing module directly bars the incoming call and thus the application of the contact manner of incoming call barring succeeds.</p>
<p id="p-0075" num="0074">Second, the destination subscriber sets a contact manner of serial call forwarding in the intelligent routing policy, which includes one or more forwarding destination addresses, showing that the incoming call shall be forwarded to the forwarding destination addresses according to a predetermined order until one of the forwarding destination addresses answers, or until none of the forwarding destination addresses answers. The intelligent routing processing module initiates a new call to every forwarding destination address one by one according to the predetermined order until the new call is answered, or until none of the forwarding destination addresses answers. When calling a forwarding destination address, the intelligent routing processing module starts up an answer monitor timer in response to receiving a ring signal. If the forwarding destination address has not yet answered when the answer monitor timer expires, the intelligent routing processing module regards that the forwarding destination address cannot answer. The duration of the answer monitor timer for a forwarding destination address may be designated by the destination subscriber directly in the intelligent routing policy, or be designated by default by the intelligent routing processing module according to an agreement.</p>
<p id="p-0076" num="0075">Third, the destination subscriber sets a contact manner of parallel call forwarding in the intelligent routing policy, which includes one or more forwarding destination addresses, showing that the incoming call shall be forwarded to all of the forwarding destination addresses at the same time until a first forwarding destination address is answered, or until none of the forwarding destination addresses can be answered. The intelligent routing processing module initiates new calls to all forwarding destination addresses at the same time until a first new call is answered, then the intelligent routing processing module releases all other new calls which are yet to be answered, or until none of the forwarding destination addresses can be answered.</p>
<p id="p-0077" num="0076">Fourth, the destination subscriber sets a contact manner of call forwarded to voice mailbox or secretary station in the intelligent routing policy, which includes a number of the voice mailbox or a number of the secretary station, showing that the incoming call should be forwarded to the voice mailbox or the secretary station. The intelligent routing processing module initiates a call to the voice mailbox or the secretary station until the call is answered, or until the voice mailbox or the secretary station does not answer.</p>
<p id="p-0078" num="0077">Fifth, the destination subscriber sets a contact manner of call converted to email in the intelligent routing policy, which includes one or more forwarding email addresses, showing that caller side information and/or a message left of the incoming call should be forwarded to the forwarding email addresses one by one according to a predetermined order until a forwarding email address receives the caller side information and/or message left of the incoming call, or until none of the forwarding email addresses can be reached. The method includes the processes of generating an email containing the caller side information and/or the message left of the incoming call by a unified messaging server, forwarding the email to the forwarding email addresses one by one according to a predetermined order until a forwarding email address receives the email, or until none of the forwarding email addresses can be reached. The email may be generated through one of the following methods:</p>
<p id="p-0079" num="0078">(1) the intelligent routing processing module initiates a new initial request to the unified messaging server for the incoming call, it is indicated in the new initial request that the incoming call shall be converted to email and the forwarding email addresses are also designated in the new initial request; in response to receiving and parsing the new initial request, the unified messaging server applies for media resources to notify the caller of the incoming call to leave a message, and when the caller has left a message, generates an email containing the caller number of the incoming call and the message left by the caller;</p>
<p id="p-0080" num="0079">(2) the intelligent routing processing module directly applies for media resources to notify the caller to leave a message, and when the caller has left a message, sends a message that contains both the caller number of the incoming call and the message left by the caller to the unified messaging server to indicate that the incoming call shall be converted to email and to designate the forwarding email addresses; in response to receiving the message, the unified messaging server parses the message and generates an email containing the caller number of the incoming call and the message left by the caller.</p>
<p id="p-0081" num="0080">The format of the message left by the caller may be one of the following: the URL link address of a record file, a record file in Multipurpose Internet Mail Extensions (MIME) format, the text format of a record converted by an Automatic Speech Recognition (ASR) resource for which the unified messaging server or intelligent routing processing module has applied.</p>
<p id="p-0082" num="0081">If the caller fails to leave a message, the unified messaging server may also send an email in text format to the forwarding email address containing only the incoming call attribute, such as the caller number.</p>
<p id="p-0083" num="0082">Sixth, the destination subscriber sets a contact manner of call converted to data message in the intelligent routing policy. The data message may be one of a short message, a multimedia message, an instant message or a paging message, and the contact manner includes one or more corresponding destination numbers, showing that the caller side information and/or the message left of the incoming call shall be forwarded based on the type of data message to destination addresses one by one according to a predetermined order until a destination address receives the data message, or until none of the destination addresses can be reached. Specifically, the method includes the processes of generating a data message containing the caller side information and/or the message left of the incoming call by a unified messaging server, forwarding the data message to destination addresses of the data message one by one according to a predetermined order until a destination address receives the data message, or until none of the destination addresses can be reached. The data message may be generated through one of the following methods.</p>
<p id="p-0084" num="0083">In one method, the intelligent routing processing module initiates a new initial request to the unified messaging server for the incoming call. In the new initial request, it is indicated that the incoming call shall be converted to a data message, and the destination numbers are designated. In response to receiving and parsing the new initial request, the unified messaging server applies for media resources to notify the caller of the incoming call to leave a message, and, when the caller has left a message, generates a data message containing the caller number of the incoming call and the message left by the caller.</p>
<p id="p-0085" num="0084">In the other method, the intelligent routing processing module directly applies for media resources to notify the caller to leave a message, and, when the caller has left a message, sends certain message containing the caller number of the incoming call and the message left by the caller to the unified messaging server to indicate that the incoming call shall be converted to a type of data message and to designate the destination addresses. In response to receiving the message, the unified messaging server parses the message and generates a data message that contains both the caller number of the incoming call and the message left by the caller.</p>
<p id="p-0086" num="0085">The format of the message left by the caller may be one of the following: URL link address of a record file, a record file in MIME format (the MIME format cannot be employed when the data message is SMS or Paging message), the text format of a record converted by an ASR resource for which the unified messaging server or intelligent routing processing module has applied.</p>
<p id="p-0087" num="0086">If the caller fails to leave a message, the unified messaging server may also send a message in text format that only contains the incoming call attribute, such as the caller number, to the destination number.</p>
<p id="p-0088" num="0087">Seventh, the destination subscriber sets a contact manner of call distributing in the intelligent routing policy, which includes one or more pickup group numbers, inter-group distribution modes and in-group distribution modes, showing that the incoming call shall be distributed to an idle subscriber in these pickup groups according to a designated distribution mode until the incoming call is answered, or until none of subscribers in the pickup groups can answer. The intelligent routing processing module distributes the incoming call to a pickup group according to a designated inter-group distribution mode, and further calls the idle subscriber in the pickup group according to a designated in-group distribution mode, until the incoming call is answered or none of subscribers in the pickup groups can answer.</p>
<p id="p-0089" num="0088">The inter-group distribution modes include:</p>
<p id="p-0090" num="0089">distributing in sequence, i.e., according to the sequence of the pickup group numbers;</p>
<p id="p-0091" num="0090">distributing to the idlest one, i.e., according to the number of idle subscribers in each pickup group.</p>
<p id="p-0092" num="0091">The in-group distribution modes include:</p>
<p id="p-0093" num="0092">distributing simultaneously, i.e., initiating a call to all idle subscribers in the pickup group at the same time by the intelligent routing processing module in response to receiving the incoming call;</p>
<p id="p-0094" num="0093">distributing in sequence, i.e., initiating calls to idle subscribers in the pickup group according to the sequence of the identities of the idle subscribers.</p>
<p id="p-0095" num="0094">Eighth, the destination subscriber sets a contact manner of call waiting in the intelligent routing policy, showing that the incoming call shall be waiting when the destination subscriber is busy, and the destination subscriber is notified that there is a new incoming call. The intelligent routing processing module should employ the contact manner of call waiting when the destination subscriber of the incoming call is in conversation. The intelligent routing processing module plays a prompting tone or sends a prompting message such as an SIP message to notify the caller of the new incoming call to wait. Meanwhile the intelligent routing processing module also plays a prompting tone or sends a prompting message such as an SIP message to notify the destination subscriber of the new incoming call, the destination subscriber may choose to answer the new incoming call through an operation.</p>
<p id="p-0096" num="0095">Generally, the intelligent routing processing module will initiate a call waiting timer for the incoming call to monitor the call waiting state, if the incoming call has not been answered when the call waiting timer expires, the intelligent routing processing module will usually release the incoming call. The duration of the call waiting timer can be designated directly by the destination subscriber in the intelligent routing policy, or designated by default by the intelligent routing processing module.</p>
<p id="p-0097" num="0096">Ninth, the destination subscriber sets a contact manner of queue in the intelligent routing policy, showing that the incoming call shall be waiting in the queue of the destination subscriber. The intelligent routing processing module assigns a queue to the destination subscriber to store information of the incoming call, and plays a prompting tone or sends a prompting message such as an SIP message to the caller of the incoming call, notifying the caller to queue. Generally, the intelligent routing processing module will initiate a queue timer for the incoming call to monitor the state of the incoming call, if the incoming call has not been answered yet when the queue timer expires, the intelligent routing processing module will usually release the incoming call. The duration of the queue timer can be designated directly by the destination subscriber in the intelligent routing policy, or designated by default by the intelligent routing processing module. The destination subscriber may answer the incoming call through one of the following methods.</p>
<p id="p-0098" num="0097">(1) The intelligent routing processing module sends a prompting message to the destination subscriber, e.g., an SIP message, for notifying the destination subscriber of a new incoming call; information of incoming calls is displayed on a kind of terminal interface of the destination subscriber according to calling time, and the destination subscriber may choose to answer one of the incoming calls through an operation, then the intelligent routing processing module deletes the information of the answered incoming call from the queue.</p>
<p id="p-0099" num="0098">(2) The intelligent routing processing module retrieves, when the destination subscriber is idle, the information of an incoming call from the queue according to the rule of First In First Out, and initiates a new initial request to the destination subscriber; when the incoming call is answered, the intelligent routing process module deletes the information of the answered incoming call from the queue.</p>
<p id="p-0100" num="0099">Tenth, the destination subscriber sets a contact manner of announcement pickup in the intelligent routing policy, which includes an announcement type, showing that a designated announcement will be played to the caller of the incoming call. The intelligent routing processing module applies for corresponding resources of announcement according to the type of the designated announcement, creates a session between the incoming call and the corresponding resources of announcement, and the caller of the incoming call listens to the designated announcement.</p>
<p id="p-0101" num="0100">The announcement may be set by the network, or be recorded in advance by the destination subscriber. For example, when the announcement type is &#x201c;number change announcement&#x201d;, the announcement may be set by the network, the destination subscriber sets a new destination number in the contact manner in advance and the intelligent routing processing module applies for the resources of announcement with the new destination number; or the announcement may also be recorded by the destination subscriber in advance, giving the new destination number in the announcement recorded.</p>
<p id="p-0102" num="0101">If the application of the announcement pickup succeeds and there are other contact manners in the intelligent routing policy, the intelligent routing processing module continues with the rest contact manners until the application of the last contact manner or the application of one contact manner before the last contact manner succeeds.</p>
<p id="p-0103" num="0102">Eleventh, the destination subscriber sets a contact manner of callback register in the intelligent routing policy, which includes a callback condition which is called presence information that must be different from the called presence information in the intelligent routing conditions corresponding to the intelligent routing policy. The callback condition shows that the calling and the called sides of the incoming call shall be recorded and the incoming call shall be released, such that a connection between the calling and the called sides shall be created automatically when the callback condition is triggered. The intelligent routing processing module records the caller number, the called number and the callback condition of the incoming call, and releases the incoming call in response to setting a &#x201c;callback activation identity&#x201d; for the called party. In a successful application of the contact manner of callback register, the caller of the incoming call may be called back when the called presence information changes into the callback condition.</p>
<p id="p-0104" num="0103">When the called presence information changes, the intelligent routing processing module determines that the &#x201c;callback activation identity&#x201d; is valid and that the called presence information is the callback condition currently, the intelligent routing processing module invokes a callback service and establishes a call automatically between the caller and the called party when both of the caller and the called party are idle, and connects a conversation between the caller and the called party.</p>
<p id="p-0105" num="0104">The intelligent routing policy includes one or more contact manners customized in advance; whether the processing order of the contact manners is logically appropriate may be determined by the destination subscriber while configuring data for customizing a service without intervention of a system, or the system may provide data consistency check when the data is configured, and the data consistency check is performed according to some agreed conditions, e.g., incoming call barring or callback register should be a last contact manner in an intelligent routing policy usually.</p>
<p id="p-0106" num="0105">It can be seen from the above that contact may be created for an incoming call, e.g., a voice or video incoming call with a designated destination through one or more contact manners customized by the destination subscriber in advance; when the destination subscriber wishes, he can always establish a session connection successfully for the incoming call according to his desire and current scenario, and he may always establish an effective connection for the incoming call through contact manners available currently. In this way, not only the call completion rate, but also the income of operators is increased.</p>
<p id="p-0107" num="0106">And the subscriber can design different intelligent routing policies conveniently for designated incoming calls. The following are some examples.</p>
<p id="p-0108" num="0107">When a subscriber is on a business trip, an announcement recorded by the subscriber in advance may be played for an incoming call to indicate the current status of the subscriber and the record of the incoming call may be converted to email.</p>
<p id="p-0109" num="0108">When the contact number of the subscriber changes, a &#x201c;number change announcement&#x201d; may be played for an incoming call to inform the caller of current contact number, then the incoming call may be forwarded to the current contact number.</p>
<p id="p-0110" num="0109">An enterprise may configure call intelligent routing policies for his telephone exchange or hotline number, e.g., it may set a first contact manner to distribute incoming calls among one or more pickup groups (operator attendant groups), a second contact manner to make the incoming calls queue, a third contact manner to convert the incoming calls to emails.</p>
<p id="p-0111" num="0110">Another method and system provided by embodiments of the present invention for intelligent routing are described below.</p>
<p id="p-0112" num="0111">The method and system for intelligent routing in accordance with the embodiments of the present invention provide, for an incoming message with a designated destination, e.g. SMS, MMS, IM, email, voice mail, FAX and paging, a unified messaging intelligent routing service based on one or more called attribute identities, the incoming call attribute, the called presence information and the current time. Thus the incoming message may be processed according to one or more routing contact manners in the intelligent routing policy customized by the destination subscriber in advance, until the application of a contact manner succeeds (the application of automatic message answer excluded) or the applications of all contact manners are handle. When a message is successfully established, the destination subscriber may be notified through a contact manner customized in advance. Embodiments of the present invention are based on unified messaging system, the conversion of types of the message brought about by the unified messaging intelligent routing service is in the field of unified messaging system technology and would not be described herein, where the conversion includes the conversion of the content media in the message.</p>
<p id="p-0113" num="0112">The second intelligent routing system in accordance with an embodiment of the present invention is shown in <figref idref="DRAWINGS">FIG. 3</figref>, including a unified messaging server, an intelligent routing processing module and a subscriber presence information processing module.</p>
<p id="p-0114" num="0113">The unified messaging server provides a unified messaging service and functions of converting and sending various types of messages. Generally, the unified messaging server is an independent physical device.</p>
<p id="p-0115" num="0114">The intelligent routing processing module provides the subscriber with hosting environment of a unified messaging intelligent routing service, it may be an independent physical device, e.g., an application server, with interface I1 being a Session Initiation Protocol (SIP) interface; or, it may be configured, with the interface I1 being a self-defining internal interface, in the unified messaging server.</p>
<p id="p-0116" num="0115">The subscriber presence information processing module collects and publishes the subscriber presence information, and provides subscriber presence information needed in service control, including explicit presence information and implicit presence information, and the subscriber presence information processing module may be a logic function network element. Optionally the subscriber presence information processing module may be an independent physical device such as a presence server, with the interface I2 being an SIP interface, and the subscriber presence information processing module sends the subscriber presence information to the intelligent routing processing module in certain manner; or the subscriber presence information processing module may be configured, with the interface I2 being a self-defining internal interface, in the intelligent routing processing module.</p>
<p id="p-0117" num="0116">The destination subscriber described in the method and system for intelligent routing in accordance with an embodiment of the present invention has a public identity that is identifiable and unique in the home communication network of the incoming message, i.e., a destination address. The public identity may be a cell phone number of the subscriber, a URL address, a FAX number or the like.</p>
<p id="p-0118" num="0117">The called attribute identity may be the destination address or the number of a group to which the called party belongs, and an intelligent routing trigger condition includes the called attribute identity, the incoming call attribute, the called presence information and current time. An intelligent routing trigger condition may correspond to multiple intelligent routing contact manners including keeping incoming mode, message forwarding, message converted to call, group sending, incoming messaging barring and automatic message answer.</p>
<p id="p-0119" num="0118">The intelligent routing processing module receives a message in interface I1 protocol format from the unified messaging server, acquires the destination address from the message and records the destination address. The intelligent routing processing module searches the attribute data sheet of the destination subscriber in a manner, acquires and records valid numbers of groups to which the called party belongs, e.g., Centrex group number, pickup group number, etc. A pickup group is a group in which all members may pick up an incoming message in a manner.</p>
<p id="p-0120" num="0119">The intelligent routing processing module receives the message in interface I1 protocol format from the unified messaging server, acquires and records the incoming message attribute which may be one or any combination of the caller address, the incoming message type and the content media type. The incoming message type includes SMS, MMS, IM, email, voice mail, FAX, paging, etc.; the content media type includes text, audio, video, picture, etc.</p>
<p id="p-0121" num="0120">The called presence information is one or the combination of the explicit presence information and the implicit presence information of the destination subscriber. The explicit presence information is the presence information published by a subscriber in a network through a means, e.g. through an SIP PUBLISH message which is from a subscriber terminal to the network and contains the presence information; the implicit presence information is the natural presence information of the subscriber terminal in the network, such as call states and network locations. The methods through which the intelligent routing processing module acquires the subscriber presence information include the following two.</p>
<p id="p-0122" num="0121">Method A: the unified messaging server triggers a message containing the presence information published by the subscriber or the natural presence information through a means to the intelligent routing processing module. The message may be an SIP PUBLISH message, a call signaling message, a network registration message, a network de-registration message, etc. The intelligent routing processing module acquires and records the subscriber presence information from the message</p>
<p id="p-0123" num="0122">Method B: the subscriber presence information is maintained and managed by a presence server in the network and the intelligent routing processing module subscribes to the subscriber presence information needed at the presence server through a subscription message, e.g., an SIP SUBSCRIBE message. The presence server informs, e.g., through an SIP NOTIFY message, the intelligent routing processing module of the subscriber presence information when the subscription message is received or when the subscriber presence information changes.</p>
<p id="p-0124" num="0123">The destination subscriber has to customize intelligent routing trigger conditions and intelligent routing contact manners corresponding to the intelligent routing trigger conditions in advance so as to utilize the unified messaging intelligent routing service. Generally, intelligent routing trigger conditions and intelligent routing contact manners can be designed in the form of data sheet called unified messaging intelligent routing service data sheet. As the called attribute identity may be the destination number or the number of a group to which the called party belongs, such as a Centrex group number or a pickup group number, there are actually multiple call intelligent routing service data sheets, such as the subscriber unified messaging intelligent routing service data sheet, the Centex group unified messaging intelligent routing service data sheet, and the pickup group unified messaging intelligent routing service data sheet. Table 3 and Table 4 below describe exemplary designs of the subscriber unified messaging intelligent routing service data sheet and the Centex group unified messaging intelligent routing service data sheet respectively (the two data sheets below do not include all possible fields and are not the only format of such data sheets).</p>
<p id="p-0125" num="0124">
<tables id="TABLE-US-00003" num="00003">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="1" colwidth="140pt" align="center"/>
<colspec colname="2" colwidth="35pt" align="left"/>
<colspec colname="3" colwidth="49pt" align="left"/>
<colspec colname="4" colwidth="49pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="4" rowsep="1">TABLE 3</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry/>
<entry>Intelligent</entry>
<entry/>
</row>
<row>
<entry/>
<entry/>
<entry>routing contact</entry>
<entry>Notification</entry>
</row>
<row>
<entry>Intelligent routing trigger conditions</entry>
<entry/>
<entry>manners</entry>
<entry>manner</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="7">
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="35pt" align="left"/>
<colspec colname="3" colwidth="42pt" align="left"/>
<colspec colname="4" colwidth="21pt" align="left"/>
<colspec colname="5" colwidth="35pt" align="left"/>
<colspec colname="6" colwidth="49pt" align="left"/>
<colspec colname="7" colwidth="49pt" align="left"/>
<tbody valign="top">
<row>
<entry>Destination</entry>
<entry>Incoming</entry>
<entry>Called</entry>
<entry>Time</entry>
<entry>Processing</entry>
<entry>Keeping</entry>
<entry>Notification</entry>
</row>
<row>
<entry>address</entry>
<entry>message</entry>
<entry>presence</entry>
<entry/>
<entry>order No.</entry>
<entry>incoming</entry>
<entry>manner of a</entry>
</row>
<row>
<entry/>
<entry>attribute</entry>
<entry>information</entry>
<entry/>
<entry/>
<entry>mode</entry>
<entry>message</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Message</entry>
<entry>establishment</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>forwarding</entry>
<entry>success: IM,</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Message</entry>
<entry>SMS, Paging,</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>converted to</entry>
<entry>MWI, etc.</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>call</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Group sending</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Incoming</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>messaging</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>barring</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Automatic</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>message</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>answer</entry>
</row>
<row>
<entry namest="1" nameend="7" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0126" num="0125">The processing order number includes Arabic numerals starting from 1, indicating the processing order of the contact manners of an intelligent routing policy. Six intelligent contact manners are given in the examples above and every entry set by the destination subscriber in the data sheet may include only one contact manner, i.e., an intelligent routing trigger condition plus a processing order number matches only one contact manner and one possible notification manner of a message establishment success. The notification manner of a message establishment success includes corresponding notification address, and may be one of IM, SMS, Paging Messaging and Message Waiting Indicator (MWI).</p>
<p id="p-0127" num="0126">
<tables id="TABLE-US-00004" num="00004">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="1" colwidth="133pt" align="center"/>
<colspec colname="2" colwidth="35pt" align="left"/>
<colspec colname="3" colwidth="56pt" align="left"/>
<colspec colname="4" colwidth="49pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="4" rowsep="1">TABLE 4</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry/>
<entry>Intelligent</entry>
<entry/>
</row>
<row>
<entry/>
<entry/>
<entry>routing contact</entry>
<entry>Notification</entry>
</row>
<row>
<entry>Intelligent routing trigger conditions</entry>
<entry/>
<entry>manners</entry>
<entry>manner</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="7">
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="35pt" align="left"/>
<colspec colname="3" colwidth="42pt" align="left"/>
<colspec colname="4" colwidth="21pt" align="left"/>
<colspec colname="5" colwidth="35pt" align="left"/>
<colspec colname="6" colwidth="56pt" align="left"/>
<colspec colname="7" colwidth="49pt" align="left"/>
<tbody valign="top">
<row>
<entry>Number</entry>
<entry>Incoming</entry>
<entry>Called</entry>
<entry>Time</entry>
<entry>Processing</entry>
<entry>Keeping</entry>
<entry>Notification</entry>
</row>
<row>
<entry>of the</entry>
<entry>message</entry>
<entry>presence</entry>
<entry/>
<entry>order No.</entry>
<entry>incoming mode</entry>
<entry>manner of a</entry>
</row>
<row>
<entry>Centrex</entry>
<entry>attribute</entry>
<entry>information</entry>
<entry/>
<entry/>
<entry>Message</entry>
<entry>message</entry>
</row>
<row>
<entry>group to</entry>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>forwarding</entry>
<entry>establishment</entry>
</row>
<row>
<entry>which the</entry>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Message</entry>
<entry>success: IM,</entry>
</row>
<row>
<entry>called</entry>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>converted to</entry>
<entry>SMS, Paging,</entry>
</row>
<row>
<entry>party</entry>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Call</entry>
<entry>MWI, etc.</entry>
</row>
<row>
<entry>belongs</entry>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Group sending</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Incoming</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>messaging</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>barring</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Automatic</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>message answer</entry>
</row>
<row>
<entry namest="1" nameend="7" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0128" num="0127">One intelligent routing trigger condition may correspond to one or more contact manners with different processing order numbers, and multiple contact manners organized in a series according to the processing order numbers form an intelligent routing policy.</p>
<p id="p-0129" num="0128">The destination subscriber may set the unified messaging intelligent routing service data sheets above in a manner according to his own wish, and the data in the data sheets will be loaded into the intelligent routing processing module. The called attribute identity is a required field while the fields of incoming message attribute, called presence information and time are optional. If the subscriber does not set a value for an optional field, the optional field will not be considered while matching the intelligent routing trigger conditions.</p>
<p id="p-0130" num="0129">The flowchart of the method provided by an embodiment of the present invention for unified messaging intelligent routing is shown in <figref idref="DRAWINGS">FIG. 4</figref>, including the following Blocks.</p>
<p id="p-0131" num="0130">Block <b>41</b>: a unified messaging server triggers an incoming message to an intelligent routing processing module without conditions or according to the static configuration data. The incoming message may be SMS, MMS, IM, email, voice mail, FAX, Paging, etc.</p>
<p id="p-0132" num="0131">In response to receiving an initial request of the incoming message, or in response to receiving a failure response to the incoming message after the incoming message is processed according to an original routing contact manner of the incoming message, the unified messaging server translates the incoming message into a message in interface I1 protocol format and sends the message to the intelligent routing processing module.</p>
<p id="p-0133" num="0132">Block <b>42</b>: the intelligent routing processing module triggers an intelligent routing service, acquires the destination address and the incoming message attribute (such as the caller address, the content media type, and the incoming message type), searches the attribute data sheet of the destination subscriber according to the destination address to obtain valid group numbers of groups to which the called party belongs, e.g., the Centrex group number or the pickup group number. The intelligent routing processing module composes an intelligent routing trigger condition with the destination address, the incoming message attribute, the called presence information obtained from the subscriber presence information processing module, and current time. If the destination subscriber has valid group numbers, different intelligent routing trigger conditions may be composed with different group numbers, the same incoming message attribute, called presence information and current time.</p>
<p id="p-0134" num="0133">The trigger point at which the intelligent routing processing module triggers the call intelligent routing service for one incoming message may be one of the following three scenarios:</p>
<p id="p-0135" num="0134">(1) the intelligent routing processing module triggers the intelligent routing service once only in response to receiving the initial request of the incoming message in interface I1 format;</p>
<p id="p-0136" num="0135">(2) the intelligent routing processing module triggers the intelligent routing service once only in response to receiving a first failure response of the incoming message in interface I1 format;</p>
<p id="p-0137" num="0136">(3) when the intelligent routing processing module has triggered the intelligent routing service once in response to receiving the initial request of the incoming message in interface I1 format and an application of the intelligent routing service has failed, the intelligent routing processing module triggers the intelligent routing service once again only in response to receiving the first failure response of the incoming message in interface I1 format.</p>
<p id="p-0138" num="0137">Block <b>43</b>: the intelligent routing processing module matches the intelligent routing trigger condition of the incoming message with the intelligent routing trigger conditions preset in the unified messaging intelligent routing service data sheet so as to obtain a corresponding intelligent routing policy, and the intelligent routing processing module provides the corresponding intelligent routing policy to the unified messaging server.</p>
<p id="p-0139" num="0138">In the embodiment of the present invention, the called attribute identity may be the destination address and the numbers of the groups to which the called party belongs, so there may be one or more intelligent routing trigger conditions for one incoming message. When the intelligent routing processing module triggers the intelligent routing service, the intelligent routing processing module matches different called attribute identities (e.g., the destination address, the Centrex group number of the called party and the pickup group number of the called party) and the same incoming call attribute, called presence information and current time with all possible preset intelligent routing trigger conditions. When more than one intelligent routing policy is obtained by the intelligent routing processing module for one incoming message, every intelligent routing policy is processed according to an agreed or preset order, or only the intelligent routing policy with the highest priority is processed according to agreed or preset priority. Referring to Table 3, the intelligent routing processing module searches the subscriber unified messaging intelligent routing service data sheet according to the destination address, incoming call attribute, called presence information and current time, and obtains a subscriber intelligent routing policy if the search succeeds. Referring to Table 4, if the called party also has a valid group number such as a Centrex group number, the intelligent routing processing module also searches the Centrex group unified messaging intelligent routing service data sheet according to the Centrex group number, incoming call attribute, called presence information and current time, and obtains a Centrex group intelligent routing policy if the search succeeds.</p>
<p id="p-0140" num="0139">The intelligent routing processing module sends to the unified messaging server a message in interface I1 format. The message contains intelligent routing contact manners and possible notification manners of a message establishment success corresponding to the contact manners by the following means:</p>
<p id="p-0141" num="0140">one message contains all intelligent routing contact manners customized in advance and all possible notification manners; or,</p>
<p id="p-0142" num="0141">the intelligent routing processing module sends a message according to a predetermined order, the message containing a contact manner and a possible notification manner corresponding to the contact manner; if the unified messaging server fails to apply this contact manner, a failure response is translated into a message in interface I1 format by the unified messaging server to be sent to the intelligent routing processing module, and the intelligent routing processing module sends a second message containing a second contact manner and a possible notification manner according to the predetermined order, until the application of a contact manner succeeds (automatic message answer excluded), or until the applications of all contact manners customized in advance are used up.</p>
<p id="p-0143" num="0142">Block <b>44</b>: the unified messaging server parses the message which contains the intelligent routing contact manners, and performs corresponding management on the incoming message until the application of a contact manner succeeds (automatic message answer excluded), or until the applications of all contact manners customized in advance are used up.</p>
<p id="p-0144" num="0143">When the unified messaging server manages the incoming message according to the intelligent routing policy, if the application of a contact manner succeeds (automatic message answer excluded), the unified messaging intelligent routing service is terminated even though there are still other contact manners that are customized in advance or other intelligent routing policies left unprocessed. If the applications of all contact manners fail (automatic message answer excluded) in an intelligent routing policy, the intelligent routing processing module continues with the other intelligent routing policies when there are still other intelligent routing policies to be applied, or the unified messaging intelligent routing service is terminated when there are not other intelligent routing policies to be applied.</p>
<p id="p-0145" num="0144">When a message is established successfully, the unified messaging server notifies the destination subscriber of the incoming message through a notification manner of a message establishment success corresponding to the contact manner, such that the destination subscriber may check the incoming message in time. IM, SMS, Paging Messaging and MWI may be employed to notify the destination subscriber. For example, when the unified messaging server creates a voice mail for the destination subscriber, the destination subscriber may be notified through a short message.</p>
<p id="p-0146" num="0145">The intelligent routing contact manners above are described below.</p>
<p id="p-0147" num="0146">First, the destination subscriber sets a contact manner of keeping incoming mode in the intelligent routing policy, showing that the incoming message is routed directly according to a contact manner designated in the incoming message. The unified messaging server processes the incoming message according to the contact manner designated in the incoming message without modifying the incoming message until the incoming message is successfully established or fails to be established.</p>
<p id="p-0148" num="0147">Second, the destination subscriber sets in the intelligent routing policy a contact manner of message forwarding. The contact manner of message forwarding includes one or multiple forwarding destination addresses, and forwarding message types corresponding to the forwarding destination addresses respectively. The forwarding message types may include SMS, MMS, IM, email, voice mail, FAX and Paging Messaging. Through the contact manner of message forwarding, the incoming message is forwarded to the forwarding destination addresses in turn according to a predetermined order until a forwarding destination address receives the message, or until none of the forwarding destination addresses could be reached. The unified messaging server processes each forwarding destination address and forwarding message type corresponding to the forwarding destination address according to the predetermined order. The unified messaging server first determines whether the incoming message type is identical with the forwarding message type. If not identical, the incoming message type is converted into the forwarding message type, including necessary conversion of the content media type. If identical, the incoming message need not be converted. Then the unified messaging server initiates a new message request to the forwarding destination address until the message is successfully established, or until none of the forwarding destination addresses can be reached.</p>
<p id="p-0149" num="0148">When the forwarding message type does not support the content media type of the incoming message, the unified messaging server determines whether a content media type can be converted to that supported by the forwarding message type, if yes, the unified messaging server converts the content media type, e.g., converts audio to text, text to audio, or the like. The unified messaging server may apply for ASR media resources or Text-to-Speech (TTS) media resources to perform corresponding conversion. If the content media type can not be converted to that supported by the forwarding message type, e.g., the content media type of the incoming message is a picture and the forwarding message type is SMS, the unified messaging server may include a URL link address of the content media of the incoming message in the forwarding message translated.</p>
<p id="p-0150" num="0149">Third, the destination subscriber sets in the intelligent routing policy a contact manner of message converted to call, which includes one or multiple call numbers, showing that media channels to the call numbers are established for the voice media contained in the incoming message or are established for the voice media forwarded from the incoming message according to a predetermined order until a call number receives the voice media, or until none of the call numbers can be reached. The unified messaging server initiates calls to the call numbers according to the predetermined order until the terminal of a call number answers, then a media channel to the call number is established for the voice media contained in the incoming message or the voice media forwarded from the incoming message, thus the terminal may listen to the announcement. Optionally the unified messaging server initiates calls to the call numbers according to the predetermined order until none of the call numbers can be reached. If the content media type of the incoming message is text, the unified messaging server applies for TTS media resources to convert the text into voice.</p>
<p id="p-0151" num="0150">Fourth, the destination subscriber in the intelligent routing policy sets a contact manner of group sending, which includes one or multiple group sending destination addresses and group sending types corresponding to the group sending destination addresses respectively. The group sending types may be one of SMS, MMS, IM, email, voice mail, FAX and Paging. Through the contact manner of group sending, the incoming message is forwarded to all the forwarding destination addresses at the same time. The unified messaging server processes all group sending destination addresses and corresponding group sending types at the same time. The unified messaging server first determines whether the incoming message type is identical with the group sending types. If not identical, the incoming message type is converted into the group sending type, including necessary conversion of the content media type; otherwise, the incoming message need not be converted. The unified messaging server initiates a new message request to all group sending destination addresses at the same time.</p>
<p id="p-0152" num="0151">When the group sending type does not support the content media type of the incoming message, the unified messaging server determines whether a content media type can be converted to that supported by the group sending type, if yes, the unified messaging server converts the content media type of the incoming message, e.g., converts audio to text, text to audio or the like. The unified messaging server may apply for ASR media resources or Text-to-Speech (TTS) media resources to perform corresponding conversion. If the content media type can not be converted to that supported by the group sending type, e.g., the content media type of the incoming message is a picture and the group sending type is an SMS, the unified messaging server may give a URL link address of the content media of the incoming message in translated contents of the group sending messages.</p>
<p id="p-0153" num="0152">Fifth, the destination subscriber sets in the intelligent routing policy a contact manner of incoming messaging barring, which includes one or multiple barring rules, for example, the content of the incoming message includes a certain word. Through the contact manner of incoming messaging barring, the incoming message will be barred. The unified messaging server bars the incoming message directly and the application of such contact manner succeeds.</p>
<p id="p-0154" num="0153">Sixth, the destination subscriber sets in the intelligent routing policy a contact manner of automatic message answer, the contact manner of automatic message answer including pickup message contents inputted by the subscriber in advance, showing that the pickup message contents are replied to the incoming message automatically. The unified messaging server directly replies the incoming message with the pickup message contents inputted by the subscriber, and the application of such contact manner succeeds. When there are still other intelligent routing contact manners left unprocessed after the application of automatic message answer has succeeded, these other intelligent routing contact manners shall continue to be processed until the application of one of them succeeds, or until the applications of all these other intelligent routing contact manners fail, then the intelligent routing service is terminated.</p>
<p id="p-0155" num="0154">In the embodiment of the present invention, the intelligent routing policy includes one or multiple contact manners customized in advance; whether the processing order of the contact manners is logically appropriate may be determined by the destination subscriber while customizing the intelligent routing service without system intervention, or the system may provide data consistency check when the intelligent routing service is customized and the data is set, and the data consistency check is performed according to some agreed conditions, e.g., incoming messaging barring may only be the last contact manner usually in an intelligent routing policy, and the contact manner should not be message converted to call when the content media type in the incoming message attribute is set as picture.</p>
<p id="p-0156" num="0155">Similarly, the system may also determine whether the notification manner of a message establishment success is appropriate through data consistency check according to agreed conditions, e.g., no notification manner of a message establishment success shall be set when the contact manner is incoming messaging barring or automatic message answer, the incoming message type in the incoming message attribute of an intelligent routing trigger condition should not be the same as the notification manner of the message establishment success set by the destination subscriber.</p>
<p id="p-0157" num="0156">Compared with the prior art, the embodiments of the present invention adopt an intelligent routing processing module which sets intelligent routing trigger conditions and corresponding intelligent routing policies in advance. In the embodiments of the present invention, an incoming call or message is processed in accordance with an intelligent routing contact manner in an intelligent routing policy. The intelligent routing trigger conditions include the called attribute identity, the incoming call attribute, the called presence information and the current time, and an intelligent routing policy may include one or more intelligent routing contact manners. Therefore, according to the embodiments of the present invention, the problem of communication routing technology in the prior art may be solved with regard to the lack of routing contact manners and routing policies, and the subscriber presence information may be fully utilized.</p>
<p id="p-0158" num="0157">Particularly, the embodiments of the present invention provide the following benefits for routing an incoming call.</p>
<p id="p-0159" num="0158">First, the contact may be established for a voice or video call with a designated destination through one or multiple contact manners preset by the destination subscriber. If the destination subscriber wishes, session contact may always be established successfully for an incoming call according to his design and current scenario, and an effective contact is always established for the incoming call through contact manners available currently. In this way not only call completion rate, but also the income of operators is increased.</p>
<p id="p-0160" num="0159">Second, the subscriber may conveniently design different routing policies for specific incoming calls, e.g., when the subscriber is on a business trip, an announcement recorded in advance may be played for an incoming call to inform the caller of current situations and the incoming call may be recorded and converted to an email.</p>
<p id="p-0161" num="0160">Third, when a contact number of the subscriber changes, an announcement may be played for an incoming call to inform the caller of the number alteration and the current contact number, the incoming call may then be forwarded to the current contact number.</p>
<p id="p-0162" num="0161">Fourth, an enterprise user may set a call intelligent routing policy for his telephone exchange or hotline, e.g., it may set a first contact manner to distribute calls among one or multiple pickup groups (operator attendant groups), a second contact manner to make the incoming calls queue, a third contact manner to convert calls to emails.</p>
<p id="p-0163" num="0162">The embodiments of the present invention also provide technical merits for routing process in a unified messaging service.</p>
<p id="p-0164" num="0163">According to the embodiments of the present invention, through one or multiple contact manners preset by the destination subscriber, the contact may be established for a certain type of messages with designated destination, such as SMS, MMS, IM, email, voice mail, FAX and paging. The destination subscriber may always establish session contact successfully for an incoming message according to his/her design and current scenario, and always establish effective contact for the incoming message through contact manners available currently. Therefore the technical solutions of the present invention bring about great convenience to subscribers.</p>
<p id="p-0165" num="0164">According to the embodiments of the present invention, the subscriber may easily design different routing policies for incoming messages. For example, when the subscriber is driving and it will be inconvenient for him to check short messages, he may wish to convert the short messages from his family to voice calls to be answered through an onboard mobile phone, then he may publish explicit presence information, stating &#x201c;I'm driving&#x201d;, through an SIP PUBLISH message, and establish an entry in the data sheet of unified messaging intelligent routing service of the subscriber. In the data sheet, the caller address in the incoming message attributes is set as the cell phone number of his family, the incoming message type is SMS, the called presence information is &#x201c;I'm driving&#x201d; and the contact manner is message converted to call.</p>
<p id="p-0166" num="0165">Obviously, those skilled in the art may make numerous changes and variations on the solution of this invention without departing from the spirit and scope thereof. Accordingly, it is intended that this invention includes the changes and variations in case that such changes and variations come within the scope as set forth in the appended claims and the equivalent techniques thereof.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for intelligent routing, comprising:
<claim-text>receiving, by an intelligent routing processing module, an incoming call;</claim-text>
<claim-text>acquiring, by the intelligent routing processing module, relevant information of the incoming call;</claim-text>
<claim-text>acquiring subscriber presence information from a presence server;</claim-text>
<claim-text>composing at least one intelligent routing trigger condition of the incoming call with the relevant information, the subscriber presence information, and a current time;</claim-text>
<claim-text>matching, by the intelligent routing processing module, the intelligent routing trigger condition of the incoming call with preset intelligent routing trigger conditions and obtaining at least one intelligent routing policy comprising one or more intelligent routing contact manners;</claim-text>
<claim-text>routing, by the intelligent routing processing module, the incoming call according to at least one of the intelligent routing contact manners.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the relevant information of the incoming call comprises a called attribute identity.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the relevant information of the incoming call further comprises an incoming call attribute.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the called attribute identity is one of a called number and a number of a user group to which a called party belongs.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the incoming call attribute comprises at least one of a caller number, a media type of the incoming call and a call attribute of the incoming call;
<claim-text>called presence information is at least one of explicit presence information and implicit presence information of the called party.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the acquiring, by the intelligent routing processing module, the called presence information comprises one of:
<claim-text>triggering, by a call session control function unit of a home domain of the called party, a message containing the called presence information to the intelligent routing processing module, acquiring and recording, by the intelligent routing processing module, the called presence information from the message; and</claim-text>
<claim-text>managing, by a presence server in a network, the called presence information;</claim-text>
<claim-text>subscribing, by the intelligent routing processing module, to the called presence information at the presence server and informing, by the presence server, the intelligent routing processing module of the called presence information in one of the following cases that subscription information is received and the case that the called presence information changes.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the intelligent routing contact manner comprises at least one of: incoming call barring, serial call forwarding, parallel call forwarding, call forwarded to voice mailbox or secretary station, call converted to email, call converted to data message, call distributing, call waiting, queue, announcement pickup and callback register.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein routing the incoming call when at least one of the intelligent routing contact manners is the call converted to data message comprises:
<claim-text>sending the incoming call to a unified messaging server where the incoming call is converted into a data message; and</claim-text>
<claim-text>routing the data message.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein, when multiple intelligent routing policies are obtained, the incoming call is processed according to an agreed or preset order of the multiple intelligent routing policies, or the incoming call is processed in accordance with one of the multiple intelligent routing policies with the highest priority according to the agreed or preset priority.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the incoming call is processed in accordance with the one or more intelligent routing contact manners in a predetermined order when the intelligent routing policy comprises more than one of the intelligent routing contact manners.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein, when an application of announcement pickup succeeds, if there are still other of the one or more intelligent routing contact manners left unprocessed, the other one or more intelligent routing contact manners continue to be processed until an application of one of the other intelligent routing contact manners succeeds or until the applications of all the other intelligent routing contact manners fail.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein, for one incoming call, the intelligent routing processing module acquiring relevant information of the incoming call once only when an initial request of the incoming call is received or when a first failure response to the incoming call is received; or the intelligent routing processing module acquiring the relevant information of the incoming call once again only when the first failure response to the incoming call is received after an application of the intelligent routing service fails with the intelligent routing service triggered in response to receiving the initial request of the incoming call.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A system for intelligent routing, comprising:
<claim-text>a call session control function unit;</claim-text>
<claim-text>an intelligent routing processing module, in communication with the call session control function unit, configured to receive an incoming call, perform logic control for an intelligent routing service through the steps of:</claim-text>
<claim-text>acquiring relevant information of the incoming call;</claim-text>
<claim-text>acquiring subscriber presence information from a subscriber presence information processing module;</claim-text>
<claim-text>composing at least one intelligent routing trigger condition of the incoming call with the relevant information, the subscriber presence information, and a current time;</claim-text>
<claim-text>matching the at least one intelligent routing trigger condition of the incoming call with preset intelligent routing trigger conditions and obtaining at least one intelligent routing policy comprising one or more intelligent routing contact manners; and</claim-text>
<claim-text>routing the incoming call according to the one or more intelligent routing contact manners; and</claim-text>
<claim-text>the subscriber presence information processing module, in communication with the intelligent routing processing module, configured to collect and publish the subscriber presence information and providing the subscriber presence information for the intelligent routing processing module.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The system of <claim-ref idref="CLM-00013">claim 13</claim-ref>, further comprising: a unified messaging server, in communication with the intelligent routing processing module, configured to process a message in the intelligent routing service.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein
<claim-text>the intelligent routing processing module, the unified messaging server and the subscriber presence information processing module are separate from each other.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. An intelligent routing processing apparatus, comprising:
<claim-text>a receiving unit, configured to receive an incoming call;</claim-text>
<claim-text>an acquiring unit, configured to:
<claim-text>acquire relevant information of the incoming call,</claim-text>
<claim-text>acquire subscriber presence information from a presence server, and</claim-text>
<claim-text>compose at least one intelligent routing trigger condition of the incoming call with the relevant information, the subscriber presence information, and a current time;</claim-text>
</claim-text>
<claim-text>a matching unit, configured to match the intelligent routing trigger condition of the incoming call with preset intelligent routing trigger conditions and obtain at least one intelligent routing policy comprising one or more intelligent routing contact manners; and</claim-text>
<claim-text>a routing unit, configured to route the incoming call according to the one or more intelligent routing contact manners.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The apparatus of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the relevant information of the incoming call comprises a called attribute identity.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The apparatus of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein the relevant information of the incoming call further comprises an incoming call attribute.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The apparatus of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein the called attribute identity is one of a called number and a number of a user group to which a called party belongs. </claim-text>
</claim>
</claims>
</us-patent-grant>
