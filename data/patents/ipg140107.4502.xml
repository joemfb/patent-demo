<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625585-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625585</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13032095</doc-number>
<date>20110222</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2010-051823</doc-number>
<date>20100309</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>151</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>12</main-group>
<subgroup>50</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>370357</main-classification>
<further-classification>370252</further-classification>
<further-classification>370230</further-classification>
<further-classification>711154</further-classification>
<further-classification>710316</further-classification>
</classification-national>
<invention-title id="d2e71">Switch apparatus</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5274633</doc-number>
<kind>A</kind>
<name>Kato et al.</name>
<date>19931200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2002/0107980</doc-number>
<kind>A1</kind>
<name>Kawaguchi</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2004/0100927</doc-number>
<kind>A1</kind>
<name>Black et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370335</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2005/0027919</doc-number>
<kind>A1</kind>
<name>Aruga</name>
<date>20050200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710316</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2007/0208758</doc-number>
<kind>A1</kind>
<name>Yeap et al.</name>
<date>20070900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707100</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2008/0276086</doc-number>
<kind>A9</kind>
<name>Proudler</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713165</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>JP</country>
<doc-number>2000/228671</doc-number>
<date>20000800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>JP</country>
<doc-number>2002/229965</doc-number>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>JP</country>
<doc-number>2004/086367</doc-number>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>JP</country>
<doc-number>2004/282293</doc-number>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>JP</country>
<doc-number>2005-539284</doc-number>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>WO</country>
<doc-number>WO 91/08632</doc-number>
<date>19910600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>WO</country>
<doc-number>WO 03/061222</doc-number>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00014">
<othercit>Japanese Office Action issued on Sep. 24, 2013 in copending Japanese Patent Application No. 2010-051823.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>6</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>370357</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370230</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370252</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>710316</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>711154</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>7</number-of-drawing-sheets>
<number-of-figures>8</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110222533</doc-number>
<kind>A1</kind>
<date>20110915</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Masaki</last-name>
<first-name>Atsushi</first-name>
<address>
<city>Kawasaki</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Masaki</last-name>
<first-name>Atsushi</first-name>
<address>
<city>Kawasaki</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Staas &#x26; Halsey LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Fujitsu Limited</orgname>
<role>03</role>
<address>
<city>Kawasaki</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Phan</last-name>
<first-name>Man</first-name>
<department>2475</department>
</primary-examiner>
<assistant-examiner>
<last-name>Ambaye</last-name>
<first-name>Mewale</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A switch apparatus includes: a first switch circuit for receiving data from external, sending first data including the received data, and sending second data including the received data after a predetermined time period from sending of the first data; a first controller for outputting the first data received from the first switch circuit; a second controller for outputting the second data received from the first switch circuit; and a second switch circuit for receiving the first data from the first controller and second data received from the second controller, sending the first data to external when the first data is free from an error, and sending the second data to external when the first data has an error and when the second data is free from an error.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="148.25mm" wi="183.73mm" file="US08625585-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="186.01mm" wi="147.15mm" orientation="landscape" file="US08625585-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="190.58mm" wi="119.89mm" orientation="landscape" file="US08625585-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="146.47mm" wi="143.76mm" orientation="landscape" file="US08625585-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="180.51mm" wi="135.55mm" orientation="landscape" file="US08625585-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="255.44mm" wi="173.06mm" file="US08625585-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="263.65mm" wi="186.69mm" file="US08625585-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="168.91mm" wi="104.22mm" file="US08625585-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATION</heading>
<p id="p-0002" num="0001">This application is based upon and claims the benefit of priority of the prior Japanese Patent Application No. 2010-051823 filed on Mar. 9, 2010, the entire contents of which are incorporated herein by reference.</p>
<heading id="h-0002" level="1">FIELD</heading>
<p id="p-0003" num="0002">The embodiments discussed herein are related to switch apparatuses for transferring data and to control methods for the switch apparatuses.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">Switch apparatuses are used for transferring data between a plurality of server apparatuses and a plurality of storage apparatuses so that the server apparatuses share the storage apparatuses and data-backup is performed with higher reliability.</p>
<p id="p-0005" num="0004">Such a switch apparatus includes a plurality of transmission paths for receiving data from any of the server apparatuses and sending the received data to any of the storage apparatuses. The data received by the switch apparatus from the server apparatuses are sent to the transmission paths in the switch apparatus via port modules included in the switch apparatus. The port module is a switch circuit for switching a connection between the transmission path in the switch apparatus and an external apparatus.</p>
<p id="p-0006" num="0005">The port module sends and receives data. The port module having received data from the external apparatus sends the data to a controller in the switch apparatus. Based on information included in the data received from the port module, the controller sends the data to a port module connected to a destination apparatus. The switch apparatus includes a plurality of controllers. The port module selects one of the controllers, and sends data thereto. Thus, a plurality of transmission paths are present between one port module and another port module.</p>
<p id="p-0007" num="0006">The port module having data received from the controller sends the data to the storage apparatus connected to the port module.</p>
<p id="p-0008" num="0007">In the case where a plurality of controllers are present in the switch apparatus, even when one of the controllers fails, the switch apparatus can continue a data sending/receiving process with use of another one of the controllers. However, when the controllers themselves fail during the data sending/receiving, the data being sent/received at the time of failure occurrence are destroyed.</p>
<p id="p-0009" num="0008">Japanese Laid-open Patent Publication No. 2005-539284 and International Publication Pamphlet No. 91/08632 below each disclose a technology of propagating a signal in a redundant system.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0010" num="0009">According to an aspect of the embodiment, a first switch circuit for receiving data from external, sending first data including the received data, and sending second data including the received data after a predetermined time period from sending of the first data; a first controller for outputting the first data received from the first switch circuit; a second controller for outputting the second data received from the first switch circuit; and a second switch circuit for receiving the first data from the first controller and second data received from the second controller, sending the first data to external when the first data is free from an error, and sending the second data to external when the first data has an error and when the second data is free from an error.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of a switch apparatus;</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 2</figref> is a timing chart for preceding frames and subsequent frames;</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 3</figref> is a format diagram of the preceding frame;</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 4</figref> is a specific block diagram of a port module;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 5</figref> is a flow chart of a switch circuit at the time of sending frames;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 6</figref> is a flow chart of the switch circuit at the time of receiving frames;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 7A</figref> is a table chart of control information stored in the port module for sending frames; and</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 7B</figref> is a table chart of control information stored in the port module for receiving frames.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DESCRIPTION OF EMBODIMENTS</heading>
<p id="p-0019" num="0018">In the following, description is made of an embodiment of the present invention. Combinations of structures according to the embodiment are included in the embodiment of the present invention.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of a switch apparatus <b>1</b> according to the embodiment of the present invention. For example, based on header information of data received at one port module, the switch apparatus <b>1</b> performs switching to another port module to send the data.</p>
<p id="p-0021" num="0020">The switch apparatus <b>1</b> includes port modules <b>11</b>, <b>14</b>, <b>87</b>, <b>88</b>, <b>89</b>, and <b>90</b>, and controllers <b>12</b> and <b>13</b>. Each of the port modules <b>11</b>, <b>14</b>, <b>87</b>, <b>88</b>, <b>89</b>, and <b>90</b> sends data received from external of the switch apparatus <b>1</b> to another port module, and sends data received from another port module to external of the switch apparatus <b>1</b>. Server apparatuses and storage apparatuses are connected to the port modules <b>11</b>, <b>14</b>, <b>87</b>, <b>88</b>, <b>89</b>, and <b>90</b>. The port modules are connected to each other through the controllers <b>12</b> and <b>13</b>. <figref idref="DRAWINGS">FIG. 1</figref> illustrates a connection state between the port module <b>11</b> and the port module <b>14</b>, and illustration of communication states between other port modules is omitted. The switch apparatus <b>1</b> includes two or more port modules and two or more controllers. The port modules and the controllers are replaceable by insertion and removal. Each of the port modules <b>11</b>, <b>14</b>, <b>87</b>, <b>88</b>, <b>89</b>, and <b>90</b> has the same structure and the same functions. Thus, in this embodiment, detailed description is only made of the port modules <b>11</b> and <b>14</b>, and description of the other port modules is omitted.</p>
<p id="p-0022" num="0021">In this embodiment, server apparatuses <b>2</b> and <b>3</b> are connected to the port module <b>11</b>, and storage apparatuses <b>4</b> and <b>5</b> are connected to the port module <b>14</b>. The port modules <b>11</b> and <b>14</b> are connected to each other through two transmission paths <b>7</b> and <b>8</b>. The transmission path <b>7</b> is via the controller <b>12</b>, and the transmission path <b>8</b> is via the controller <b>13</b>. The switch apparatus <b>1</b> sends data received from the server apparatus <b>2</b> or <b>3</b> to the storage apparatus <b>4</b> or <b>5</b>. Also, the switch apparatus <b>1</b> sends data received from the storage apparatus <b>4</b> or <b>5</b> to the server apparatus <b>2</b> or <b>3</b>.</p>
<p id="p-0023" num="0022">The port module <b>11</b> includes external ports <b>34</b> and <b>35</b>, internal ports <b>38</b> and <b>39</b>, and a switch circuit <b>15</b>. The external ports <b>34</b> and <b>35</b> are ports for connecting external apparatuses external to the switch apparatus <b>1</b> and the port module <b>11</b> to each other. The external port <b>34</b> is connected to the server apparatus <b>2</b> via a transmission path <b>33</b>. The external port <b>35</b> is connected to the server apparatus <b>3</b> via a transmission path <b>10</b>. The data received through the external ports are detected by the switch circuit <b>15</b>.</p>
<p id="p-0024" num="0023">The internal ports <b>38</b> and <b>39</b> are ports for connecting the port module <b>11</b> and the controllers <b>12</b> and <b>13</b> to each other in the switch apparatus <b>1</b>. The internal port <b>38</b> is connected to the controller <b>12</b> via the transmission path <b>7</b>, and the internal port <b>39</b> is connected to the controller <b>13</b> via the transmission path <b>8</b>. The data received through the internal ports are also detected by the switch circuit <b>15</b>.</p>
<p id="p-0025" num="0024">The port module <b>14</b> includes external ports <b>85</b> and <b>86</b>, internal ports <b>83</b> and <b>84</b>, and a switch circuit <b>82</b>. The external ports <b>85</b> and <b>86</b> are ports for connecting external apparatuses external to the switch apparatus <b>1</b> and the port module <b>14</b> to each other. The external port <b>85</b> is connected to the storage apparatus <b>4</b>, and the external port <b>86</b> is connected to the storage apparatus <b>5</b>. The data received through the external ports are detected by the switch circuit <b>82</b>.</p>
<p id="p-0026" num="0025">The internal ports <b>83</b> and <b>84</b> are ports for connecting the port module <b>14</b> and the controllers <b>12</b> and <b>13</b> to each other in the switch apparatus <b>1</b>. The internal port <b>83</b> is connected to the controller <b>12</b>, and the internal port <b>84</b> is connected to the controller <b>13</b>. The data received through the internal ports are also detected by the switch circuit <b>82</b>. Each of the port modules <b>11</b> and <b>14</b> has the same structure and the same functions. Thus, in this embodiment, description is only made of the port module <b>11</b>, and description of the port module <b>14</b> is omitted.</p>
<p id="p-0027" num="0026">The switch circuit <b>15</b> determines through which port among the internal ports <b>38</b> and <b>39</b> or the external ports <b>34</b> and <b>35</b> data have been received. The switch circuit <b>15</b> switches data process contents in accordance with the port through which the data have been received. In a case where data have been received through the external port <b>34</b> or <b>35</b>, the switch circuit <b>15</b> copies the received data, sends one copy of the copied data to another switch circuit via the transmission path <b>7</b>, and sends another copy of the copied data to the other switch circuit via the transmission path <b>8</b> with a predetermined time period delay.</p>
<p id="p-0028" num="0027">Meanwhile, in a case where data have been received through the internal port <b>38</b> or <b>39</b>, the switch circuit <b>15</b> performs error detection on one copy of the data copied in another switch circuit. When the one copy of the copied data is normal, the switch circuit <b>15</b> outputs the data to the external. When the one copy of the copied data is abnormal, the switch circuit <b>15</b> performs error detection on another copy of the copied data. When the other copy of the copied data is normal, the switch circuit <b>15</b> outputs the data to the external. Detailed description of the switch circuit <b>15</b> is made later.</p>
<p id="p-0029" num="0028">The controllers <b>12</b> and <b>13</b> for example set all the settings of, manage the state of, and control the operation of the switch apparatus <b>1</b>. Each of the controllers <b>12</b> and <b>13</b> transfers data received from one port module to another port module corresponding to destination information included in the data.</p>
<p id="p-0030" num="0029">The controller <b>12</b> includes a CPU (Central Processing Unit) <b>16</b> and a transfer circuit <b>17</b>. The CPU <b>16</b> performs control of the operation of the transfer circuit <b>17</b>. The transfer circuit <b>17</b> transfers date received from one of the port modules to another one of the port modules corresponding to the destination information included in the data.</p>
<p id="p-0031" num="0030">The controller <b>13</b> includes a CPU <b>80</b> and a transfer circuit <b>81</b>. The CPU <b>80</b> performs control of the operation of the transfer circuit <b>81</b>. The transfer circuit <b>81</b> has the same functions as the transfer circuit <b>17</b>. The transfer circuit <b>81</b> switches a destination port module of the received data in accordance with a command from the CPU <b>80</b>.</p>
<p id="p-0032" num="0031">In this embodiment, data is exchanged in frame units between a server apparatus and a storage apparatus. For example, when a command of reading certain data is sent from a server apparatus to a storage apparatus, the storage apparatus outputs data called a sequence in accordance with the reading command. Frames are obtained by dividing the sequence by a fixed data length and adding additional information thereto. Examples of the additional information include address information and header information. Detailed description of a frame structure is made later.</p>
<p id="p-0033" num="0032">In the following, description is made of a procedure in which the storage apparatus <b>4</b> receives a frame A sent from the server apparatus <b>2</b> via the switch apparatus <b>1</b>. The port module <b>11</b> receives the frame A from the server apparatus <b>2</b>. The port module <b>11</b> generates frames Ax and Ay based on the received frame A.</p>
<p id="p-0034" num="0033">The port module <b>11</b> sends the frame Ax to the controller <b>12</b> via the internal port <b>38</b>. After confirming, based on the header information of the frame Ax, that the destination of the frame Ax is the port module <b>14</b>, the controller <b>12</b> sends the received frame Ax to the port module <b>14</b>. Among copied frames, frames to be precedingly sent are called preceding frames. Further, the port module <b>11</b> sends a frame Ay to the controller <b>13</b> via the internal port <b>39</b> after a predetermined time period has elapsed from sending of the preceding frame Ax. Among copied frames, frames to be subsequently sent are called subsequent frames. Sending-timing gap between the preceding frame Ax and the subsequent frame Ay enables distribution of receiving processes of the port module for receiving the frames Ax and Ay. After confirming, based on the header information of the subsequent frame Ay, that the destination of the frame Ay is the port module <b>14</b>, the controller <b>13</b> sends the received subsequent frame Ay to the port module <b>14</b>.</p>
<p id="p-0035" num="0034">The port module <b>14</b> having received the preceding frame Ax through the port <b>83</b> performs an error checking process such as CRC (Cyclic Redundancy Check) for confirmation as to whether or not the received frame is normal. When normality of the preceding frame Ax is confirmed as a result of the error checking process, the port module <b>14</b> outputs the preceding frame Ax as the frame A to the storage apparatus <b>4</b>.</p>
<p id="p-0036" num="0035">When abnormality of the preceding frame Ax is confirmed as a result of the error checking process on the preceding frame Ax, the port module <b>14</b> performs another error checking process on the subsequent frame Ay received through the port <b>84</b>. When normality of the subsequent frame Ay is confirmed as a result of the error checking process, the port module <b>14</b> outputs the subsequent frame Ay as the frame A to the storage apparatus <b>4</b>. Detailed description of the process of the port module <b>14</b> is made later.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 2</figref> is a timing chart for preceding frames and subsequent frames. Arrows <b>7</b> and <b>8</b> indicate the transmission paths <b>7</b> and <b>8</b> for transmitting the frames output from the port module <b>11</b>, respectively. Arrows A<b>1</b><i>x</i>, A<b>2</b><i>x</i>, and A<b>3</b><i>x </i>indicate timings at which the port module <b>11</b> outputs preceding frames A<b>1</b><i>x</i>, A<b>2</b><i>x</i>, and A<b>3</b><i>x </i>to the transmission path <b>7</b>, respectively. Arrows A<b>1</b><i>y</i>, A<b>2</b><i>y</i>, and A<b>3</b><i>y </i>indicate timings at which the port module <b>11</b> outputs subsequent frames A<b>1</b><i>y</i>, A<b>2</b><i>y</i>, and A<b>3</b><i>y </i>to the transmission path <b>8</b>, respectively.</p>
<p id="p-0038" num="0037">In <figref idref="DRAWINGS">FIG. 2</figref>, a time period T<b>1</b> is a standby time period taken from after sending of the preceding frame A<b>1</b><i>x </i>to sending of the subsequent frame A<b>1</b><i>y </i>corresponding to the sent preceding frame A<b>1</b><i>x</i>. In consideration of propagation errors in the transmission paths <b>7</b> and <b>8</b>, a processing time gap between the controllers <b>12</b> and <b>13</b>, and the like, the time period T<b>1</b> is set so that the subsequent frame A<b>1</b><i>y </i>reaches the port module <b>14</b> after the preceding frame A<b>1</b><i>x </i>has reached the port module <b>14</b>. That is, the time period T<b>1</b> is a time period longer than the difference between a data-transmission time period taken for the data sent from the switch circuit <b>15</b> to reach the switch circuit <b>82</b> via the controller <b>12</b> for precedingly sending the data and a data-transmission time period taken for the data sent from the switch circuit <b>15</b> to reach the switch circuit <b>82</b> via the controller <b>13</b> for subsequently sending the data.</p>
<p id="p-0039" num="0038">In <figref idref="DRAWINGS">FIG. 2</figref>, a time period T<b>2</b> is a standby time period taken from after sending of the preceding subsequent frame A<b>1</b><i>y </i>to sending of the subsequent preceding frame A<b>2</b><i>x</i>. In consideration of propagation errors in the transmission paths <b>7</b> and <b>8</b>, the processing time gap between the controllers <b>12</b> and <b>13</b>, and the like, the time period T<b>2</b> is set so that the subsequent preceding frame A<b>2</b><i>x </i>reaches the port module <b>14</b> after the preceding subsequent frame A<b>1</b><i>y </i>has reached the port module <b>14</b>.</p>
<p id="p-0040" num="0039">Setting of the time periods T<b>1</b> and T<b>2</b> as described above enables sending of frames to the external apparatuses external to the switch apparatus <b>1</b> without frame disordering in one sequence. Sending without frame disordering to the external apparatus eliminates the necessity of reordering the frames in the external apparatus and enables reduction of processing load in the external apparatus. Further, appropriate gaps in timing at which the port module receives frames enable distribution of processing timings such as those of the CRC checking process and a frame output process to the external in the port module on a receiving side.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 3</figref> is a format diagram of the preceding frame A<b>1</b><i>x</i>. The preceding frame A<b>1</b><i>x </i>is one of the frames included in the sequence. Each of the other preceding frames and subsequent frames has the same structure as the preceding frame A<b>1</b><i>x</i>. The preceding frame A<b>1</b><i>x </i>includes an SOF (Start of Frame Delimiter) <b>41</b>, a flag <b>59</b>, a FH (Frame Header) <b>42</b>, an optional header <b>44</b>, a payload <b>45</b>, CRC <b>46</b>, and an EOF (End of Frame Delimiter) <b>47</b>.</p>
<p id="p-0042" num="0041">The SOF <b>41</b> is a delimiter indicating a start position of the preceding frame A<b>1</b><i>x</i>. The delimiter is a code indicating a break position between frames. The flag <b>59</b> is a flag inserted into a copied frame, and is an identifier used for distinguishing the preceding frame A<b>1</b><i>x </i>and the subsequent frame A<b>1</b><i>y </i>from each other. For example, the flag <b>59</b> of the preceding frame A<b>1</b><i>x </i>has a logical value &#x201c;1&#x201d; and the flag <b>59</b> of the subsequent frame A<b>1</b><i>y </i>has a logical value &#x201c;0.&#x201d; Insertion of the flag <b>59</b> into each of the preceding frame A<b>1</b><i>x </i>and the subsequent frame A<b>1</b><i>y </i>enables the port module on the receiving side to identify whether the received frame is the preceding frame A<b>1</b><i>x </i>or the subsequent frame A<b>1</b><i>y. </i></p>
<p id="p-0043" num="0042">The FH <b>42</b> includes information of destination addresses of frames and a frame order in a sequence. Detailed description of the FH is made later. The optional header <b>44</b> and the payload <b>45</b> constitute a data field <b>43</b>. The optional header <b>44</b> is a preliminarily provided header region. The payload <b>45</b> is a region for storing part of data for responding to a request from an external apparatus. The flag <b>59</b> may be provided in the region of the optional header <b>44</b>. The CRC <b>46</b> is a check code for bit-error detection on the frame header and the data field. The EOF <b>47</b> is a delimiter indicating an end position of the preceding frame A<b>1</b><i>x. </i></p>
<p id="p-0044" num="0043">The FH <b>42</b> is an identifier for identifying frames. The FH <b>42</b> includes R-CTL (Routing Control) <b>48</b>, CS-CTL (Class Specific Control) <b>49</b>, a TYPE (Data Structure Type) <b>50</b>, an SEQ-ID (Sequence Identifier) <b>51</b>, an OX-ID (Originator Exchange Identifier) <b>52</b>, a D-ID (Destination Identifier) <b>53</b>, an S-ID (Source Identifier) <b>54</b>, F-CTL (Frame Control) <b>55</b>, DF-CTL (Data Field Control) <b>56</b>, an SEQ-CNT (Sequence Count) <b>57</b>, and an RX-ID (Responder Exchange Identifier) <b>58</b>.</p>
<p id="p-0045" num="0044">The R-CTL <b>48</b> indicates a frame type such as a link-control frame, a link-data frame, and a data frame. The CS-CTL <b>49</b> indicates frame attribution and frame-sending priority. The TYPE <b>50</b> indicates a command code for link control when a frame is a link-control frame. The SEQ-ID <b>51</b> indicates a sequence to which a frame at the time of mixed transfer belongs. The OX-ID <b>52</b> is an exchange number issued by an originator. The D-ID <b>53</b> is a destination port address of a frame. The S-ID <b>54</b> is a source port address of a frame. The F-CTL <b>55</b> is used for control of a frame transfer sequence constituted by flags and codes. The DF-CTL <b>56</b> displays the presence or absence of the optional header and the length of the optional header in the case of using an optional header. The SEQ-CNT <b>57</b> displays a frame order in one sequence or a sequence order during the same exchange. The SEQ-CNT <b>57</b> is a unique number with which the preceding frame A<b>1</b><i>x </i>is identified as one of frames. The RX-ID <b>58</b> displays an exchange number issued by a responder.</p>
<p id="p-0046" num="0045">As described above, frames received from the external are copied in the switch apparatus <b>1</b> in a port module on a sending side, and the flag <b>59</b> is inserted thereinto. As a result, the port module on the receiving side can distinguish the preceding frame A<b>1</b><i>x </i>and the subsequent frame A<b>1</b><i>y </i>from each other.</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 4</figref> is a specific block diagram of the port module <b>11</b>. As described above, the port module <b>11</b> includes the switch circuit <b>15</b>, the external ports <b>34</b> and <b>35</b>, and the internal ports <b>38</b> and <b>39</b>. The switch circuit <b>15</b> has a storage <b>30</b>, a controller <b>31</b>, and a switching processor <b>32</b>. Each of the other port modules <b>14</b>, <b>87</b>, <b>88</b>, <b>89</b>, and <b>90</b> has the same structure and functions as the port module <b>11</b>, and hence description thereof is omitted.</p>
<p id="p-0048" num="0047">The switch circuit <b>15</b> includes both a frame-sending function and a frame-receiving function. The switch circuit <b>15</b> executes different processes in accordance with the port through which frames are received: an internal port or an external port. Detailed description is made later of the process executed when frames are received through an internal port and the process executed when frames are received through an external port.</p>
<p id="p-0049" num="0048">The switching processor <b>32</b> detects through which port among the external ports <b>34</b> and <b>35</b> or the internal ports <b>38</b> and <b>39</b> frames have been received. The switching processor <b>32</b> sends, as a detection signal <b>28</b>, a detection result to the controller <b>31</b>. The switching processor <b>32</b> writes, as frames <b>26</b>, the received frames into the storage <b>30</b>. In accordance with a control signal <b>29</b> received from the controller <b>31</b>, the switching processor <b>32</b> outputs frames <b>27</b> read out from the storage <b>30</b> to any of the external ports <b>34</b> and <b>35</b> and the internal ports <b>38</b> and <b>39</b>.</p>
<p id="p-0050" num="0049">The storage <b>30</b> stores the frames written thereinto from the switching processor <b>32</b>. The storage <b>30</b> makes control information for managing a sent state or a received state of the preceding frames and the subsequent frames correspond to frame identification information and stores the control information. In accordance with a control signal <b>36</b> received from the controller <b>31</b>, the storage <b>30</b> outputs, as the frames <b>27</b>, the stored frames to the switching processor <b>32</b>. After outputting the stored frames, the storage <b>30</b> outputs a notification signal <b>37</b> to the controller <b>31</b> in response to the control signal <b>36</b> received from the controller <b>31</b>.</p>
<p id="p-0051" num="0050">The controller <b>31</b> controls the storage <b>30</b> and the switching processor <b>32</b> in accordance with the detection signal <b>28</b> received from the switching processor <b>32</b>. Based on the control signal <b>29</b>, the controller <b>31</b> controls the internal ports for outputting the frames. Based on the control signal <b>36</b>, the controller <b>31</b> controls read-out timings of the frames stored in the storage <b>30</b>.</p>
<p id="p-0052" num="0051">In the following, with reference to the flow chart of <figref idref="DRAWINGS">FIG. 5</figref>, description is made of sending operations of the preceding frames and the subsequent frames in the port module <b>11</b>. Further, with reference to the flow chart of <figref idref="DRAWINGS">FIG. 6</figref>, description is made of receiving operations of the preceding frames and the subsequent frames in the port module <b>11</b>. Each of the other port modules has the same structure and functions as the port module <b>11</b>, and hence description thereof is omitted.</p>
<p id="p-0053" num="0052"><figref idref="DRAWINGS">FIG. 5</figref> is a flow chart showing a process of the switch circuit <b>15</b> when the port module <b>11</b> sends frames received from an external apparatus to another port module. When a frame from the external apparatus is received through the external port <b>34</b> or <b>35</b>, the switching processor <b>32</b> of the switch circuit <b>15</b> detects reception of the frame through the external port, and sends the detection signal <b>28</b> to the controller <b>31</b> (S<b>1</b>).</p>
<p id="p-0054" num="0053">The switching processor <b>32</b> writes, as the frame <b>26</b>, the received frame into the storage <b>30</b>. The storage <b>30</b> stores the written-in frame <b>26</b>. The controller <b>31</b> having received the detection signal <b>28</b> notifying reception of the frame through the external port copies the frame <b>26</b> stored in the storage <b>30</b> to another address (S<b>2</b>).</p>
<p id="p-0055" num="0054">The controller <b>31</b> inserts the flag <b>59</b> into each of the copied frames as illustrated in <figref idref="DRAWINGS">FIG. 3</figref> (S<b>3</b>). Specifically, as described above, in order that the preceding frames and the subsequent frames can be distinguished from each other, the controller <b>31</b> inserts the flags <b>59</b> having logical values different from each other into the copied frames, respectively.</p>
<p id="p-0056" num="0055">The controller <b>31</b> makes the storage <b>30</b> store control information of each frame, which is information notifying whether or not a preceding frame and a subsequent frame have already been sent (S<b>4</b>). The control information is stored, as a management table for managing the sent state of the frames, in the storage <b>30</b>. The control information of each of the frames is stored in the management table together with the FH <b>42</b> as the identification information corresponding to each of the frames. The management table is not required to store all information of the FH <b>42</b>, and may store only information required for identification of the frames. The control information includes a flag for indicating whether or not the preceding frame and the subsequent frame have already been sent. The port module <b>11</b> has not yet sent any frame at the time of generation of the control information, and hence sending-completion flags of both the preceding frame and the subsequent frame indicate OFF. Detailed description of the control information is made later.</p>
<p id="p-0057" num="0056">The controller <b>31</b> refers to the control information stored in the storage <b>30</b>, and determines, prior to sending of a preceding frame, based on a flag value of the control information whether or not a preceding subsequent frame has already been sent (S<b>5</b>). In a case where the preceding subsequent frame has already been sent or there is no preceding subsequent frame (S<b>5</b>: YES), the controller <b>31</b> sends, to the storage <b>30</b>, the control signal <b>36</b> for reading out a subsequent preceding frame. The storage <b>30</b> having received the control signal <b>36</b> outputs a stored preceding frame to the switching processor <b>32</b>. The controller <b>31</b> send the control signal <b>29</b> to the switching processor <b>32</b> so that the frame <b>27</b> read out from the storage <b>30</b> is sent via any of the internal ports <b>38</b> and <b>39</b> (S<b>6</b>).</p>
<p id="p-0058" num="0057">The storage <b>30</b> having output the preceding frame outputs the notification signal <b>37</b> to the controller <b>31</b>. The controller <b>31</b> having received the notification signal <b>37</b> outputs the control signal <b>36</b> for setting the sending-completion flag of the preceding frame to ON to the storage <b>30</b> (S<b>7</b>), the flag being stored in the control information. After confirming, by the notification signal <b>37</b>, that the preceding frame has already been sent, the controller <b>31</b> sends the control signal <b>36</b> for sending a subsequent frame to the storage <b>30</b>. In this manner, the frame order in one sequence can be maintained.</p>
<p id="p-0059" num="0058">In a case where a preceding subsequent frame has not yet been sent (S<b>5</b>: NO), the controller <b>31</b> sends the control signal <b>36</b> to the storage <b>30</b> so that a preceding subsequent frame is output (S<b>11</b>). The storage <b>30</b> having output the preceding subsequent frame outputs the notification signal <b>37</b> for notifying frame-sending completion to the controller <b>31</b>. The controller <b>31</b> having received the notification signal <b>37</b> sets the sending-completion flag of the preceding subsequent frame to ON in the control information stored in the storage <b>30</b> (S<b>12</b>).</p>
<p id="p-0060" num="0059">The controller <b>31</b> refers to the FH <b>42</b> of the sent preceding frame, and determines whether or not the sent preceding frame is the last frame of a sequence to which the sent preceding frame belongs (S<b>8</b>). When the sent preceding frame is the last frame (S<b>8</b>: YES), the controller <b>31</b> sends the control signal <b>36</b> to the storage <b>30</b> so that a subsequent frame is sent after a predetermined time period has elapsed from output of the preceding frame. The storage <b>30</b> having received the control signal <b>36</b> outputs a subsequent frame to the switching processor <b>32</b> (S<b>9</b>). After outputting the subsequent frame, the storage <b>30</b> outputs the notification signal <b>37</b> to the controller <b>31</b>, the signal notifying that the subsequent frame has been sent. The controller <b>31</b> having received the notification signal <b>37</b> sends the control signal <b>29</b> to the switching processor <b>32</b> so that the subsequent frame is sent to another of the internal ports <b>38</b> and <b>39</b> via which the preceding frame is sent. The switching processor <b>32</b> having received the control signal <b>29</b> sends the received subsequent frame to the internal port specified by the controller <b>31</b>.</p>
<p id="p-0061" num="0060">The controller <b>31</b> having received the notification signal <b>37</b> notifying output of the subsequent frame from the storage <b>30</b> sets the sending-completion flag of the subsequent frame in the control information to ON (S<b>10</b>).</p>
<p id="p-0062" num="0061">When the preceding frame is determined not to be the last frame in Step S<b>8</b> (S<b>8</b>: NO), the switch circuit <b>15</b> repeats the frame-sending process from Step S<b>1</b>.</p>
<p id="p-0063" num="0062">The process as described above on frames received from the external apparatus enables the switch circuit <b>15</b> to send preceding frames and subsequent frames at different timings to different transmission paths in the switch apparatus <b>1</b>.</p>
<p id="p-0064" num="0063"><figref idref="DRAWINGS">FIG. 6</figref> is a flow chart of a process of the switch circuit <b>15</b> at the time of sending frames received from another module in the switch apparatus <b>1</b> to the external of the switch apparatus <b>1</b>. Note that, in this embodiment, the switch circuit in each of all the port modules has the same structure and functions as the switch circuit <b>15</b>. Thus, description thereof is omitted. Further, in <figref idref="DRAWINGS">FIG. 6</figref>, values of both a preceding-reception-completion flag and a subsequent-reception-completion flag indicate OFF.</p>
<p id="p-0065" num="0064">When a frame is received through the internal port <b>38</b> or <b>39</b> from another port module, the switching processor <b>32</b> of the switch circuit <b>15</b> detects that the frame is received through the internal port. Then, the switching processor <b>32</b> sends the detection signal <b>28</b> to the controller <b>31</b>. The switching processor <b>32</b> sends the received frame <b>26</b> to the storage <b>30</b>. The controller <b>31</b> reads out the flag <b>59</b> stored in the storage <b>30</b>. Based on the read-out flag <b>59</b>, the controller <b>31</b> recognizes that the frame written into the storage <b>30</b> is a preceding frame (S<b>20</b>).</p>
<p id="p-0066" num="0065">Based on the CRC <b>46</b> of the preceding frame, the controller <b>31</b> performs a CRC process as an error checking process on the data stored in the data field <b>43</b> of the preceding frame (S<b>21</b>).</p>
<p id="p-0067" num="0066">In a case of having determined that the data of the preceding frame is correct as a result of the CRC (S<b>22</b>: YES), the controller <b>31</b> writes the control information in which the preceding-reception-completion flag indicates ON into the storage <b>30</b> (S<b>23</b>). With reference to the value of the preceding-reception-completion flag, the controller <b>31</b> can confirm whether or not the data of the received preceding frame is correct.</p>
<p id="p-0068" num="0067">The controller <b>31</b> deletes the flag <b>59</b> of the preceding frame (S<b>24</b>). The controller <b>31</b> outputs the control signal <b>36</b> to the storage <b>30</b> so that the frame <b>27</b> from which the flag <b>59</b> is deleted is sent to the switching processor <b>32</b>. The controller <b>31</b> outputs the control signal <b>29</b> to the switching processor <b>32</b> so that the received frame <b>27</b> is sent to any of the external ports <b>34</b> and <b>35</b>. The switching processor <b>32</b> having received the control signal <b>29</b> outputs the received frame <b>27</b> to any of the external ports <b>34</b> and <b>35</b> (S<b>25</b>).</p>
<p id="p-0069" num="0068">Meanwhile, in a case of having determined that the data of the preceding frame has an error, or a case of not having received the preceding frame (S<b>22</b>: NO), the controller <b>31</b> maintains the preceding-reception-completion flag indicating OFF as it is.</p>
<p id="p-0070" num="0069">Next, the switching processor <b>32</b> receives a frame from the internal port <b>38</b> or <b>39</b>. The switching processor <b>32</b> having received the frame from the internal port sends the detection signal <b>28</b> to the controller <b>31</b>. The switching processor <b>32</b> sends the received frame <b>26</b> to the storage <b>30</b>. The controller <b>31</b> reads out the flag <b>59</b> stored in the storage <b>30</b>. Based on the red-out flag <b>59</b>, the controller <b>31</b> recognizes that the frame stored in the storage <b>30</b> is a subsequent frame (S<b>27</b>).</p>
<p id="p-0071" num="0070">Based on the CRC <b>46</b> of the subsequent frame stored in the storage <b>30</b>, the controller <b>31</b> performs a CRC process on the data of the data field <b>43</b> (S<b>28</b>).</p>
<p id="p-0072" num="0071">In a case of having determined that the data of the subsequent frame is correct as a result of the error checking (S<b>29</b>: YES), the controller <b>31</b> rewrites the control information stored in the storage <b>30</b> so that the subsequent-reception-completion flag is set to ON (S<b>30</b>).</p>
<p id="p-0073" num="0072">Meanwhile, in a case of having determined that the data of the subsequent frame has an error as a result of the error checking (S<b>29</b>: NO), the controller <b>31</b> rewrites the control information stored in the storage <b>30</b> so that the subsequent-reception-completion flag is set to OFF (S<b>31</b>). When the value of the subsequent-reception-completion flag indicates OFF, the controller <b>31</b> can confirm that correct data of the subsequent frame have not been received.</p>
<p id="p-0074" num="0073">After receiving a subsequent frame having correct data, the controller <b>31</b> refers to the control information stored in the storage <b>30</b>. When the preceding-reception-completion flag in the control information indicates ON (S<b>32</b>: YES), the controller <b>31</b> determines that the preceding frame has already been sent to the external, and performs processes of and after Step S<b>35</b>. Meanwhile, when the preceding-reception-completion flag in the control information indicates OFF (S<b>32</b>: NO), the controller <b>31</b> determines that the preceding frame has not yet been sent to the external, and deletes the flag <b>59</b> of the subsequent frame (S<b>33</b>). The controller <b>31</b> sends the control signal <b>36</b> to the storage <b>30</b> so that the subsequent frame from which the flag <b>59</b> is deleted is sent to the switching processor <b>32</b>. Further, the controller <b>31</b> outputs the control signal <b>29</b> to the switching processor <b>32</b> so that the frame <b>27</b> received from the storage <b>30</b> is output to the external apparatus from the external port <b>34</b> or <b>35</b> (S<b>34</b>).</p>
<p id="p-0075" num="0074">In this embodiment, when both the preceding-sending-completion flag and the subsequent-sending-completion flag indicate OFF, the frames are not to be sent to the external apparatus.</p>
<p id="p-0076" num="0075">The controller <b>31</b> reads out the FH <b>42</b> of the subsequent frame stored in the storage <b>30</b>. The controller <b>31</b> refers to the FH <b>42</b> and confirms whether or not all the frames have been processed (S<b>35</b>). In a case where all the frames have already been processed (S<b>35</b>: YES), the switch circuit <b>15</b> ends the frame-receiving processes. Meanwhile, in a case where not all the frames have been processed (S<b>35</b>: NO), the switch circuit <b>15</b> returns to Step S<b>20</b> and starts a receiving process of the next preceding frame (S<b>20</b>).</p>
<p id="p-0077" num="0076">The processes as described above on frames received from another port module enable the switch circuit <b>15</b> to send frames of received preceding frames or received subsequent frames to the external apparatus connected to the external of the switch apparatus <b>1</b>, the sent frames having been able to receive correct data.</p>
<p id="p-0078" num="0077">Note that, in the embodiment shown in <figref idref="DRAWINGS">FIG. 6</figref>, the receiving process of the subsequent frame is performed after the receiving process of the preceding frame. However, in a case where a subsequent frame has been received prior to reception of a preceding frame, the process may be started from Step S<b>27</b>. Starting of the process from Step S<b>27</b> enables the controller <b>31</b> to perform the receiving process of the subsequent frame without reception of the preceding frame.</p>
<p id="p-0079" num="0078"><figref idref="DRAWINGS">FIG. 7A</figref> is a table chart of a control information table stored in the port module for sending frames. <figref idref="DRAWINGS">FIG. 7B</figref> is a table chart of a control information table stored in the port module for receiving the frames.</p>
<p id="p-0080" num="0079">In this embodiment, a control information table <b>70</b> illustrated in <figref idref="DRAWINGS">FIG. 7A</figref> is stored in the storage <b>30</b> included in the port module <b>11</b> on the frame-sending side. The controller <b>31</b> generates the control information table <b>70</b> and stores the same into the storage <b>30</b>.</p>
<p id="p-0081" num="0080">The control information table <b>70</b> includes the FH <b>42</b>, a preceding-sending-completion flag <b>71</b>, and a subsequent-sending-completion flag <b>72</b>. The FH <b>42</b> is obtained by copying the FH <b>42</b> of a frame received from the external apparatus.</p>
<p id="p-0082" num="0081">The preceding-sending-completion flag <b>71</b> is a flag indicating whether or not a preceding frame has already been sent. For example, it can be determined that the preceding frame has already been sent when a value of the preceding-sending-completion flag <b>71</b> is &#x201c;1,&#x201d; and that the preceding frame has not yet been sent when the value of the preceding-sending-completion flag <b>71</b> is &#x201c;0.&#x201d;</p>
<p id="p-0083" num="0082">The subsequent-sending-completion flag <b>72</b> is a flag indicating whether or not a subsequent frame has already been sent. For example, it can be determined that the subsequent frame has already been sent when a value of the subsequent-sending-completion flag <b>72</b> is &#x201c;1,&#x201d; and that the subsequent frame has not yet been sent when the value of the subsequent-sending-completion flag <b>72</b> is &#x201c;0.&#x201d;</p>
<p id="p-0084" num="0083">In this embodiment, a control information table <b>75</b> illustrated in <figref idref="DRAWINGS">FIG. 7B</figref> is stored in the storage <b>30</b> included in the port module <b>14</b> on the frame-sending side. The controller <b>31</b> generates the control information table <b>75</b> and stores the same into the storage <b>30</b>.</p>
<p id="p-0085" num="0084">The control information table <b>75</b> includes the FH <b>42</b>, a preceding-reception-completion flag <b>76</b>, and a subsequent-reception-completion flag <b>77</b>. The FH <b>42</b> is obtained by copying the FH <b>42</b> of a frame received from the external apparatus.</p>
<p id="p-0086" num="0085">The preceding-reception-completion flag <b>76</b> is a flag indicating whether or not a preceding frame has already been received. For example, it can be determined that the preceding frame has already been received when a value of the preceding-reception-completion flag <b>76</b> is &#x201c;1,&#x201d; and that the preceding frame has not yet been received when the value of the preceding-reception-completion flag <b>76</b> is &#x201c;0.&#x201d;</p>
<p id="p-0087" num="0086">The subsequent-reception-completion flag <b>77</b> is a flag indicating whether or not a subsequent frame has already been received. For example, it can be determined that the subsequent frame has already been received when a value of the subsequent-reception-completion flag <b>77</b> is &#x201c;1,&#x201d; and that the subsequent frame has not yet been received when the value of the subsequent-reception-completion flag <b>77</b> is &#x201c;0.&#x201d;</p>
<p id="p-0088" num="0087">Storing as described above of the control information tables respectively in the port modules on the frame-sending side and the frame-receiving side enables management of exchange of preceding frames and subsequent frames which propagate through different transmission paths between port modules at different timings.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A switch apparatus comprising: a first switch circuit to receive frame data sent from a first device, to send first frame data created based on the received frame data and including the received frame data, and to send second frame data created based on the received frame data and including the received frame data after a predetermined time period elapses from sending of the first frame data; a first controller to output the first frame data received from the first switch circuit; a second controller to output the second frame data received from the first switch circuit; and a second switch circuit to: receive the first frame data from the first controller and second frame data received from the second controller, determine whether each of the first frame data created and the second frame data created has an error, send the received frame data in the first data to a second device when determining that the first frame data created is free from an error, send the received frame data in the second frame data-to the second device when determining that the first frame data created has an error and when determining that the second frame data created is free from an error, and prevent sending of the second frame data to the second device when the received frame data in the first frame data is sent to the second device.</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The switch apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the predetermined time period is a time period longer than a difference between a data-transmission time period for transmitting the first frame data from the first switch circuit to the second switch circuit via the first controller and a data-transmission time period for transmitting the second frame data from the first switch circuit to the second switch circuit via the second controller.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The switch apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first switch circuit includes a storage to store the received frame data storage, adds a first identifier to the received frame data to generate the first frame data, the first identifier identifying the first frame data, and adds a second identifier to the received frame data to generate the second frame data, the second identifier identifying the second frame data.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The switch apparatus according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the first switch circuit stores identification information identifying the stored frame data in association with control information which indicates that the stored frame data has already been sent, and wherein the first switch sends next frame data after confirming that the stored frame data has already been sent based on the control information.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A method executed by a switch apparatus including a first switch circuit, a second switch circuit, a first controller, and a second controller, the method comprising: receiving frame data sent from a first device by the first switch circuit; sending first frame data created based on the received frame data and including the received frame data to the first controller by the first switch circuit; sending second frame data created based on the received frame data and including the received frame data to the second controller after a predetermined time period elapses from sending of the first frame data by the first switch circuit; transferring the first frame data sent from the first switch circuit to the second switch circuit by the first controller; transferring the second frame data sent from the first switch circuit to the second switch circuit by the second controller; receiving the first frame data sent from the first controller and the second frame data sent from the second controller by the second switch circuit; determining, using the second switch circuit, whether each of the first frame data created and the second frame data created has an error; sending the received frame data in the first frame data to the second device by the second switch circuit when determining that the first frame data created is free from an error;
<claim-text>and sending the received frame data in the second frame data to the second device by the second switch circuit when determining that the first frame data created has an error and when the second frame data created is free from an error, and wherein the sending of the second frame data is prevented when the received frame data in the first frame data is sent to the second device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the predetermined time period is a time period longer than a difference between a data-transmission time period for transmitting the first frame data from the first switch circuit to the second switch circuit via the first controller and a data-transmission time period for transmitting the second frame data from the first switch circuit to the second switch circuit via the second controller. </claim-text>
</claim>
</claims>
</us-patent-grant>
