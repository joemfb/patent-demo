<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08627484-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08627484</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12976908</doc-number>
<date>20101222</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>385</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20130101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>21</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 26</main-classification>
<further-classification>726 29</further-classification>
</classification-national>
<invention-title id="d2e53">Unauthorized location detection and countermeasures</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6311059</doc-number>
<kind>B1</kind>
<name>Walton</name>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455425</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6505048</doc-number>
<kind>B1</kind>
<name>Moles et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4554561</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6506048</doc-number>
<kind>B1</kind>
<name>Staffin et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>432  9</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6633621</doc-number>
<kind>B1</kind>
<name>Bishop et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375376</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7006835</doc-number>
<kind>B2</kind>
<name>Otsuka et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4554561</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7751826</doc-number>
<kind>B2</kind>
<name>Gardner et al.</name>
<date>20100700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4554561</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7800533</doc-number>
<kind>B2</kind>
<name>Harper et al.</name>
<date>20100900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>8060074</doc-number>
<kind>B2</kind>
<name>Danford et al.</name>
<date>20111100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455419</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2002/0173317</doc-number>
<kind>A1</kind>
<name>Nykanen et al.</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455456</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2003/0001774</doc-number>
<kind>A1</kind>
<name>Harris</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>3423571</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2005/0136891</doc-number>
<kind>A1</kind>
<name>Wang et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2006/0040677</doc-number>
<kind>A1</kind>
<name>Dietrich et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4554562</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2006/0099970</doc-number>
<kind>A1</kind>
<name>Morgan et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4554566</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2006/0258352</doc-number>
<kind>A1</kind>
<name>Ishii</name>
<date>20061100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4554351</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2009/0036111</doc-number>
<kind>A1</kind>
<name>Danford et al.</name>
<date>20090200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2009/0325615</doc-number>
<kind>A1</kind>
<name>McKay et al.</name>
<date>20091200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2010/0231383</doc-number>
<kind>A1</kind>
<name>Levine et al.</name>
<date>20100900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2010/0328064</doc-number>
<kind>A1</kind>
<name>Rogel</name>
<date>20101200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>340540</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2011/0214184</doc-number>
<kind>A1</kind>
<name>Whitehouse et al.</name>
<date>20110900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 24</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2013/0064202</doc-number>
<kind>A1</kind>
<name>Zhang et al.</name>
<date>20130300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370329</main-classification></classification-national>
</us-citation>
<us-citation>
<nplcit num="00021">
<othercit>3rd Generation Partnership Group (3GPP), TS 43.059, V9.0.0, 3<sup>rd </sup>Generation Partnership Project; Technical Specifications Group GSM/EDGE, Radio Access Network; &#x201c;Functional stage 2 description of Location Services (LCS) in GERAN&#x201d;, Nov. 2009, 69 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00022">
<othercit>3<sup>rd </sup>Generation Partnership Group (3GPP), TS 25.305, V9.0.0, 3<sup>rd </sup>Generation Partnership Project; Technical Specification Group Radio Access Network; &#x201c;Stage 2 functional specification of User Equipment (UE) positioning in UNTRAN&#x201d;, Dec. 2009, 79 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00023">
<othercit>3<sup>rd </sup>Generation Partnership Group (3GPP), TS 36.305, V9.8.0, 3<sup>rd </sup>Generation Partnership Project; Technical Specification Group Radio Access Network (E-UTRAN); &#x201c;Stage 2 functional specification of User Equipment (UE) positioning in E-UTRAN&#x201d;, Release 9, Sep. 2011, 51 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00024">
<othercit>3<sup>rd </sup>Generation Partnership Project 2 (3GPP2), C.S0022-0, V3.0, 3<sup>rd </sup>Generation Partnership Project 2, &#x201c;Position Determination Service Standards for Dual Mode Spread Spectrum Systems&#x201d; Feb. 16, 2011, 146 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00025">
<othercit>3<sup>rd </sup>Generation Partnership Project 2 (3GPP2), C.S0022-A, V1.0 ,3<sup>rd </sup>Generation Partnership Project 2, &#x201c;Position Determination Service for cdma2000 Spread Spectrum Systems&#x201d;, Mar. 2004, 298 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00026">
<othercit>Enck, W. et al., &#x201c;TaintDroid: An Information-Flow Tracking System for Realtime Privacy Monitoring on Smartphones,&#x201d; presented at The 9th USENIX Symposium on Operating Systems Design and Implementation 2010 (&#x201c;OSDI 10&#x201d;) held in Vancouver BC Canada, Oct. 4-5, 2010, 15 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00027">
<othercit>Lederman, &#x201c;Surveillance requests to cellphone carriers surge&#x201d;, myfoxny.com, Jul. 9, 2012, http://www.myfoxny.com/story/18984877/surveillance-requests-to-cellp ..., 3 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00028">
<othercit>Lichtblau, &#x201c;More Demands on Cell Carriers in Surveillance&#x201d;, The New York Times, Jul. 8, 2012, http://www.nytimes.com/2012/07/09/us/cell-carriers-see-uptick-in-reques ..., 4 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00029">
<othercit>Markey, &#x201c;Letter to Randall Stephenson regarding New York Times article&#x201d;, Congress of the United States, House of Representatives, May 2, 2012, 3 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00030">
<othercit>McAllister, &#x201c;US law enforcement phone snooping on the rise&#x2014;John Law made 1.3 million rat-on requests in 2011&#x201d;, The Register, Jul. 9, 2012, http://www.theregister.co.uk/2012/07/09/markey<sub>&#x2014;</sub>wireless<sub>&#x2014;</sub>snooping/, 3 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00031">
<othercit>McKone, &#x201c;Response to letter to Randall Stephenson dated May 2, 2012&#x201d;, AT&#x26;T Services, Inc., May 29, 2012, 8 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00032">
<othercit>&#x201c;Thousands of iPhones Apps Tracking Users Location Without Permission&#x201d;, cellular-news, Jul. 18, 2012, http://www.cellular-news.com/story/printer/55445.php?ModPagespeed=off, 2 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>17</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726 22</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 26</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 29</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 30</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>8</number-of-drawing-sheets>
<number-of-figures>8</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120167207</doc-number>
<kind>A1</kind>
<date>20120628</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Beckley</last-name>
<first-name>Frederic A.</first-name>
<address>
<city>Philadelphia</city>
<state>PA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Anderson</last-name>
<first-name>Robert J.</first-name>
<address>
<city>Phoenixville</city>
<state>PA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Ward</last-name>
<first-name>Matthew L.</first-name>
<address>
<city>Collegeville</city>
<state>PA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Beckley</last-name>
<first-name>Frederic A.</first-name>
<address>
<city>Philadelphia</city>
<state>PA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Anderson</last-name>
<first-name>Robert J.</first-name>
<address>
<city>Phoenixville</city>
<state>PA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Ward</last-name>
<first-name>Matthew L.</first-name>
<address>
<city>Collegeville</city>
<state>PA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Woodcock Washburn LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>TruePosition, Inc.</orgname>
<role>02</role>
<address>
<city>Berwyn</city>
<state>PA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Kim</last-name>
<first-name>Jung</first-name>
<department>2494</department>
</primary-examiner>
<assistant-examiner>
<last-name>Ho</last-name>
<first-name>Thomas</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A location sentry system is provided for use within a mobile device. The sentry system can be configured to detect unauthorized attempts to locate mobile devices by monitoring messages passed between the mobile device and the wireless network and/or messages passed between components of the mobile device, and determining that one or more of the messages is/are indicative of an attempt to locate the mobile device. In response to a determination that an unauthorized attempt has been detected, the location sentry can be configured to take one or more actions. For example, the location sentry system could prevent location information from being sent back to the wireless network and/or the location sentry system could cause incorrect information to be sent to the wireless network.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="147.15mm" wi="114.30mm" file="US08627484-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="212.77mm" wi="158.75mm" file="US08627484-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="158.75mm" wi="115.23mm" file="US08627484-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="158.75mm" wi="84.92mm" file="US08627484-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="158.75mm" wi="89.07mm" file="US08627484-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="158.75mm" wi="90.51mm" file="US08627484-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="207.52mm" wi="158.75mm" file="US08627484-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="158.75mm" wi="157.31mm" file="US08627484-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="158.75mm" wi="122.94mm" file="US08627484-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">TECHNICAL FIELD</heading>
<p id="p-0002" num="0001">The present invention relates generally to methods and apparatus for locating wireless devices, also called mobile stations (MS), such as those used in analog or digital cellular systems, personal communications systems (PCS), enhanced specialized mobile radios (ESMRs), and other types of wireless communications systems. More particularly, but not exclusively, the present invention relates to a method for detecting and preventing unauthorized location of a mobile device.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">The location of a mobile wireless device utilizes one or more positioning techniques in order to estimate the location and in some cases, the speed, direction-of-travel, and altitude of the mobile device (also known as the mobile, mobile station (MS), handset, or user equipment (UE).</p>
<p id="p-0004" num="0003">Determining the position of a mobile device involves two main steps: collection of radio signal measurements, and a local or remote position estimate computation based on those measurements. Signal collection can be performed by a receiver within or co-located with the mobile device.</p>
<p id="p-0005" num="0004">Hybrid positioning, using multiple methods positioning methods, is used to increase the accuracy or yield of a location estimate.</p>
<p id="h-0003" num="0000">Location Technique Standardization</p>
<p id="p-0006" num="0005">The location techniques used in different wireless communications networks (WCN) using different radio transmission technologies are subject to standardization. Notable standards development organizations include the 3<sup>rd </sup>Generation Partnership Program (3GPP), the 3<sup>rd </sup>Generation Partnership Program 2(3GPP2), and the Open Mobile Alliance (OMA.)</p>
<p id="p-0007" num="0006">Location techniques standardized for the Global System for Mobility (GSM) are detailed in 3GPP Technical Specification TS 43.059<i>, &#x201c;Functional stage </i>2 <i>description of Location Services </i>(<i>LCS</i>) <i>in GERAN</i>&#x201d;. The GSM location techniques include: cell coverage based positioning, Enhanced Observed Time Difference (E-OTD) positioning, Assisted Global Navigation Satellite System (A-GNSS) based positioning; and Uplink Time Difference of Arrival (U-TDOA) positioning.</p>
<p id="p-0008" num="0007">Location techniques standardized for the Wide-band CDMA system (better known as Universal Mobile Telecommunications System (UMTS)) are detailed in 3GPP Technical Specification 25.305<i>, &#x201c;Stage </i>2 <i>functional specification of User Equipment </i>(<i>UE</i>) <i>positioning in UTRAN</i>.&#x201d; The UMTS location techniques include: cell coverage based positioning, Observed Time Difference Of Arrival (OTDOA) positioning, A-GNSS based positioning, and U-TDOA.</p>
<p id="p-0009" num="0008">Location techniques standardized for the Evolved Universal Mobile Telecommunications System (more commonly known as the Long-Term Evolution or LTE system) are described in 3GPP Technical Specification 36.305<i>, &#x201c;Stage </i>2 <i>functional specification of User Equipment </i>(<i>UE</i>) <i>positioning in E</i>-<i>UTRAN</i>.&#x201d; The current (release <b>9</b>) LTE location techniques include: uplink and downlink cell coverage based positioning, Observed Time Difference Of Arrival (OTDOA) positioning, and A-GNSS based positioning. While not yet standardized, the U-TDOA positioning technique is applicable to LTE.</p>
<p id="p-0010" num="0009">Location techniques standardized for the IS-95 (CDMAOne) and IS-2000 (CDMA-2000) radio access networks are described in 3GPP2 Specifications C.S0022-0, &#x201c;Position Determination Service Standards for Dual Mode Spread Spectrum Systems,&#x201d; and C.S0022-A &#x201c;Position Determination Service for cdma2000 Spread Spectrum Systems.&#x201d; The 3GPP2 standardized techniques include cell-based positioning, Advanced Forward Link Trilateration (AFLT) and Assisted Global Positioning Satellite positioning.</p>
<p id="p-0011" num="0010">Mobile-Based and Mobile-Assisted Location Techniques</p>
<p id="p-0012" num="0011">Mobile location techniques use radio signals collected at the mobile device to generate a location estimate. Mobile Location techniques for wireless communication devices can be broadly categorized as mobile-based or mobile-assisted dependent on the use of precursor information and where the final location estimate is calculated. Mobile location techniques can be combined with each other and with network-based location techniques (Uplink time-difference-of-arrival (U-TDOA) and/or angle of arrival (AoA)) to achieve the highest yields and accuracies.</p>
<p id="p-0013" num="0012">The least accurate, but highest availability mobile location method is called cell-ID Positioning. The cell-ID, cell coverage based positioning or cell-ID positioning technique uses radio broadcast information from the cellular network already in use to allow mobility. Translation of the cell-ID (or cell/sector ID) into a latitude and longitude may be performed at the mobile or at a networked, landside server. The basic cell-ID location can be improved with the addition of time or power-based ranging.</p>
<p id="p-0014" num="0013">Enhanced Cell-ID (ECID) positioning uses cell-ID positioning with the addition of timing and power measurements made by the mobile of the downlink broadcast beacon from the serving and neighboring cell sites. ECID is considered a mobile-based location technique as the signal collection and measurement is performed at the mobile but location calculation is generally preformed at a network server. Although not explicitly standardized this technique has been commercially deployed.</p>
<p id="p-0015" num="0014">Enhanced Observed Time Difference (E-OTD) positioning is a mobile-based technique for unsynchronized wireless networks. The EOTD system uses the time-of-arrival of a cell broadcast radio signals at the mobile device receiver. Collected signal timing and cell-ID information is then transmitted to a networked, landside server. The EOTD system must supply the geographic location and the collected timing offsets for each cell transmitter in order to determine a location estimate.</p>
<p id="p-0016" num="0015">A variation of ECID is Radio Fingerprinting. Radio Fingerprinting may be implemented as a mobile-based technique uses downlink (network-to-mobile) radio signal collected by the mobile. Radio Fingerprinting is also called Wireless Signatures, Multipath Fingerprinting, Database Correlation Method (DCM), or Pilot Correlation. The radio fingerprinting technique uses the propagation characteristics of a reflected and refracted radio signal as received by the mobile device to determine a location by matching with a signal from a database of recorded or modeled signal propagation characteristics (also called radio fingerprints). Although not explicitly standardized this technique has been commercially deployed.</p>
<p id="p-0017" num="0016">Observed Time Difference Of Arrival (OTDOA) is a mobile-based technique that uses the relative timing offset of the broadcast beacons from different cells. A time difference of arrival technique, OTDOA requires a minimum of three cell beacons to determine a location. The purely downlink-TDOA based location estimation will typically be combined with a cell-ID-with-ranging location estimate and databased information on the geographic location of the reported cell beacon transmitter antenna to create a final hybrid location estimate.</p>
<p id="p-0018" num="0017">Advanced (or Enhanced) Forward Link Trilateration (AFLT or EFLT) is a mobile-based technology used only in WCN with precise timing and base station synchronization. Mobile-based AFLT requires reception of beacons from four or more cells and knowledge (normally via cell broadcast) of the geographic locations of those cells. Network-assisted AFLT requires reception of three or more cell beacons by the mobile device and a communications channel to a landside server which uses the mobile device-collected signal measurements and geographic locations of the cells to calculate a location estimate.</p>
<p id="p-0019" num="0018">Assisted Global Navigation Satellite System (A-GNSS) and Assisted Global Positioning Satellite positioning is technically a mobile-based technique since the satellite broadcast signals used for location are collected at the mobile device via a specialized receiver and antenna. Network-generated assistance information is transmitted to the receiver to increase receiver sensitivity and decrease the time-to-first-fix. A-GNSS may be deployed as network-assisted, mobile-based where the signals are collected and final location is produced local to the mobile device, or as network-assisted, network-computed, where the collected signal information is transmitted to a landside server for final location estimation.</p>
<p id="p-0020" num="0019">The inventive techniques and concepts described herein apply to time and frequency division multiplexed (TDMA/FDMA) radio communications systems including the widely used IS-136 (TDMA), GSM, and OFDM-based wireless systems, such as the IEEE 802.16e &#x201c;WIMAN&#x201d; and 802.20 &#x201c;WIMAX&#x201d; system and the 3GPP Long Term Evolution (LTE and LTE Advanced) system, as well as code-division radio communications systems such as CDMA (IS-95, IS-2000) and Universal Mobile Telecommunications System (UTMS), the latter of which is also known as W-CDMA. The Global System for Mobile Communications (GSM) model used herein as examples is an exemplary but not exclusive environment in which the present invention may be used.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0021" num="0020">With the advent of wide area wireless location systems for mobile telecommunications, the need to detect and foil unwanted, unauthorized location attempts become paramount to ensure privacy and security of users in a wireless world. By detecting location related events and messaging at the mobile device, the user is alerted to location disclosure.</p>
<p id="p-0022" num="0021">As explained in more detail in the following paragraphs, a location sentry system for use in a mobile device can be used to detect unauthorized attempts to locate a mobile device. Generally, the location sentry system can be configured to detect unauthorized location attempts by gathering information indicative of changes to the internal state of a mobile device along with sent/received messages and storing the information as event records in a log. The sentry system can be configured to analyze the log of events and determine that an event, or a sequence of events, is indicative of an attempt to locate the mobile device.</p>
<p id="p-0023" num="0022">Once an unauthorized attempt has been detected, the location sentry system can be configured to log the attempt and/or alert a user. In the same, or another embodiment, the location sentry system may also be configured to prevent the location attempt and/or provide incorrect information to the wireless network. In addition to the foregoing, other techniques are described in the claims, the detailed description, and the figures.</p>
<p id="p-0024" num="0023">The foregoing is a summary and thus contains, by necessity, simplifications, generalizations and omissions of detail. Those skilled in the art will appreciate that the summary is illustrative only and is not intended to be in any way limiting.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0025" num="0024">The foregoing summary as well as the following detailed description are better understood when read in conjunction with the appended drawings. For the purpose of illustrating the invention, there is shown in the drawings exemplary constructions of the invention; however, the invention is not limited to the specific methods and instrumentalities disclosed.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a high-level block diagram of a mobile device that can include the location sentry system.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 2</figref> shows a high-level depiction of the location sentry implemented as a privileged client application</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 3</figref> shows a high-level depiction of the location sentry implemented within a hardware virtualization environment.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 4</figref> shows a high-level depiction of the location sentry implemented as part of the mobile device operating system</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 5</figref> depicts the generalized procedure for discovery of an unauthorized location attempt.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 6</figref> depicts the generalized procedure for discovery of an unauthorized location attempt.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 7</figref> depicts the generalized procedure for discovery of an unauthorized location attempt.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 8</figref> shows a high-level depiction of the spoofing capabilities of the location sentry.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF ILLUSTRATIVE EMBODIMENTS</heading>
<p id="p-0034" num="0033">We will now describe illustrative embodiments of the present invention. First, we provide a detailed overview of the problem and then a more detailed description of our solutions.</p>
<p id="p-0035" num="0034">Wide area wireless location system have been deployed to support emergency services and telematics. With growing public awareness of location-based services came the fears that unauthorized locations were being made without the users express consent and being used by commercial entities such as marketers and advertisers.</p>
<p id="p-0036" num="0035">As wireless data services proliferate, with wireless data-capable devices already exceeding the personal computer in number and accesses to the internet. As location is a legal requirement for mobile devices, it is expected that unauthorized location will also proliferate.</p>
<p id="p-0037" num="0036">Unauthorized location is detected at the mobile device. Detection of a location is by means of analysis of messaging, events and patterns of events that indicate an unauthorized location attempt has been initiated (or is in progress, or has just completed). These events range from standardized location request messaging to patterns of messaging dependent on the location technology, data and control linkage, and radio access technology.</p>
<p id="p-0038" num="0037">Trending is the recording of time-stamped event data that could be part of a location attempt. Trend data becomes the historical data that can lead to recognition of a location event. Heuristic algorithms can be employed to assist in the recognition of unusual messaging, events and timings.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 1</figref></p>
<p id="p-0040" num="0039">Referring now to <figref idref="DRAWINGS">FIG. 1</figref>, it illustrates a mobile device <b>100</b> in which the invention can be implemented. Generally, mobile device <b>100</b> can be a cellular phone, a personal digital assistant (PDA), a pager with a graphics display, a smart-phone, or any other type of mobile communications unit. As shown, mobile device <b>100</b> can include a memory <b>110</b>, which can be random access memory (RAM), read-only memory (ROM), electronically programmable read-only ROM (EPROM), etc. In at least one exemplary embodiment, location sentry <b>102</b> can be one or more modules of executable instructions that can be stored in memory <b>110</b>. A processor, e.g., processor <b>104</b>, can be operatively coupled to memory <b>102</b> via a communication bus. When powered, processor <b>104</b> can read information from memory <b>110</b> and execute instructions. Processor <b>104</b> can be any type of processor suitable to operate in a mobile environment. For example, an exemplary processor could be based on the Advanced RISC Machine (ARM) v7 instruction set and optimized for use in smart-phone environments.</p>
<p id="p-0041" num="0040">Continuing with the general description of <figref idref="DRAWINGS">FIG. 1</figref>, mobile device <b>100</b> can also include user interface <b>106</b>, which could be a touch display or a display/keyboard combination. User interface <b>106</b> can be configured to render one or more notifications in the instance that sentry <b>102</b> detects an unauthorized attempt to locate mobile device <b>100</b>. Mobile device <b>100</b> can include a global positioning system (GPS) receiver <b>112</b> (illustrated in dashed lines to indicate that it is considered optional) coupled to a specialized antenna. In an exemplary embodiment of the invention where mobile device <b>100</b> includes GPS receiver <b>112</b>, mobile device <b>100</b> can be configured to use it to sample satellite signals. GPS <b>112</b> can then use the signals to calculate its position or send the signals to the wireless network for processing. <figref idref="DRAWINGS">FIG. 1</figref> also depicts radio <b>108</b>. Radio <b>108</b> can include all the hardware and firmware necessary to send and receive radio signals to a wireless network base station, etc. For example, radio <b>108</b> can include the physical transceiver, antenna, chipset, and any firmware to enable mobile device <b>100</b> to communicate with a wireless network.</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 2</figref></p>
<p id="p-0043" num="0042">Referring now to <figref idref="DRAWINGS">FIG. 2</figref>, it depicts the detection procedure for the location sentry. Each incoming message is monitored <b>201</b>. Each internal subsystem activation on the mobile device is monitored <b>202</b> and each outgoing message is monitored <b>203</b>. A record, including a timestamp is made for each monitored event <b>204</b>. The record is stored in a relational database <b>205</b> on the wireless device <b>100</b> for future use. The database <b>205</b> also stores location authorizations, both Ad Hoc and persistent.</p>
<p id="p-0044" num="0043">Detection <b>206</b> of unauthorized attempts to locate the mobile device <b>100</b> is a two stage process. Each monitored event is examined for a location recognition event <b>207</b>. The location recognition analysis looks at the message type and message contents to detect a location event.</p>
<p id="p-0045" num="0044">The trending analysis <b>208</b> uses historical information or modeled information from the database <b>205</b> to assess the probability of an unauthorized location event. Trending analysis detects on the basis of repeated actions and deviations from past message sequences and activations. In a specific example, location sentry can include a module of executable instructions that looks at each message and calculates the probability that the event is an unauthorized attempt to locate the mobile device <b>100</b> by comparing the message to information stored in database <b>205</b>.</p>
<p id="p-0046" num="0045">For example, database <b>205</b> can include a data structure that lists the process identifiers for processes that are authorized to access a location subsystem and/or the conditions under which a process can access the location subsystem. Database <b>205</b> can also include a list of processes that are authorized to send location information and/or the conditions under which a process can send location information. Suppose mobile device <b>100</b> includes a map program, in a specific example the map program may be authorized to access location subsystem and send location information to the network when user input is received directing it to do so; otherwise, the map program may not be authorized to access the location subsystem and/or send location information.</p>
<p id="p-0047" num="0046">Design of a Mobile-Based Application</p>
<p id="p-0048" num="0047">The location sentry can be a mobile-based application, the general design of mirrors that of a internet firewall and malicious software (anti-virus) scanning software but designed to detect location related events. Depending on the preferences of the implementer, three options for the design of the location sentry are foreseen.</p>
<p id="h-0007" num="0000">Client Application Option</p>
<p id="p-0049" num="0048">If implemented as a client software, the location sentry insinuates itself into the various hardware drivers, protocol stacks and application programming interfaces (API's) implementations as to have access all incoming and outgoing messages, subsystem activations and intra-system messaging between other applications.</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 3</figref> shows a high-level depiction of such a client application. The mobile device <b>301</b> has a wireless radio receiver subsystem <b>302</b> that can receive demodulated messages from a receiver such as radio <b>108</b> of <figref idref="DRAWINGS">FIG. 1</figref> and pass them to the operating system <b>306</b> via a virtual or physical data interconnection <b>304</b>. The LS (location sentry) client application <b>305</b> encapsulates the operating system's receiver API <b>313</b> and monitors the incoming message stream for location-related traffic. For example, the LS client application <b>305</b> can implement the interfaces used by receiver API <b>313</b> to interface with wireless radio receiver <b>302</b> and receive demodulated messages; analyze them; and then pass them to receiver API <b>313</b>.</p>
<p id="p-0051" num="0050">Location hardware (such as a GPS chipset) or location software (routines for signal collection for location) are shown in <figref idref="DRAWINGS">FIG. 3</figref> as the location subsystem <b>309</b>, communicating with the operating system <b>306</b> via a virtual or physical data interconnection <b>308</b>. The location sentry application <b>307</b> encapsulates the operating system's application program interface for the location subsystem <b>312</b>. Similar to LS client <b>305</b>, LS client <b>307</b> can be configured to implement the interfaces used by location subsystem API <b>312</b> so that it can receive messages; analyze them; and pass them between operating system <b>306</b> and location subsystem <b>309</b>.</p>
<p id="p-0052" num="0051">A location sentry <b>310</b> gateway and API for outgoing messaging allows for analysis of messaging before being delivered to the wireless radio transmitter <b>303</b> via a virtual or physical data interconnection <b>311</b>. The LS client application <b>310</b> encapsulates the operating system's transmitter gateway API <b>314</b> and monitors the outgoing message stream for location-related traffic. Any detected outbound location-related messages can then be filtered, edited, or substituted before transmission.</p>
<p id="h-0008" num="0000">Hardware Virtualization Option</p>
<p id="p-0053" num="0052">The location sentry may be implemented as part of a hardware virtualization (HV) package. The HV package transparently encapsulates the mobile device's operating system allowing full functionality while granting the location sentry full access to all incoming and outgoing messages, subsystem activations state changes, and intra-system messaging.</p>
<p id="p-0054" num="0053">Referring to <figref idref="DRAWINGS">FIG. 4</figref>, it shows a high level example depiction of the location sentry implementation as part of a hardware virtualization package <b>416</b>. The mobile device <b>401</b> has a wireless radio receiver subsystem <b>402</b> that passes demodulated messages to the hardware virtualization environment (HVE) <b>416</b> via a virtual or physical data interconnection <b>404</b>. The mobile device operating system <b>406</b> operates within the hardware virtualization environment <b>412</b>, which itself is an operating system with a complement of hardware interfaces and driver applications. The LS client application <b>405</b> here acts as a bridge between the HVE <b>412</b> and the wireless receiver API <b>413</b>, analyzing and filtering location related radio messaging.</p>
<p id="p-0055" num="0054">Location hardware (such as a GPS chipset) or location software (routines for signal collection for location) are shown in <figref idref="DRAWINGS">FIG. 4</figref> as the location subsystem <b>409</b>, communicating with the operating system <b>406</b> via a virtual or physical data interconnection <b>408</b> which passes thru the location subsystem API <b>412</b> and the Location Sentry <b>407</b> allowing for deactivation, filtering and substitution of location or location-related measurements.</p>
<p id="p-0056" num="0055">A location sentry <b>410</b> gateway and API for outgoing messaging allows analysis of messaging before being delivered to the wireless radio transmitter <b>403</b> via a virtual or physical data interconnection <b>411</b>. As part of the hardware virtualization environment <b>416</b>, the location sentry <b>410</b> can filter, edit, or substitute location-related messaging generated within the location subsystem <b>409</b> or OS <b>406</b> before transmission.</p>
<p id="p-0057" num="0056">In this exemplary embodiment, the virtualization environment <b>416</b> can emulate the interfaces for the wireless radio receiver subsystem <b>402</b>, the wireless radio transmitter subsystem <b>403</b>, and/or the location subsystem <b>409</b>. In this example, the operating system <b>406</b> would not have to be modified nor would application program interfaces be encapsulated. Rather, the hardware virtualization environment <b>416</b> could be configured to trap attempts by the various APIs to access hardware resources and/or subsystems and analyze any messages they attempt to pass. In addition, the HVE <b>416</b> can be configured to analyze received messages prior to reporting them to the receiver application program interface <b>413</b>.</p>
<p id="h-0009" num="0000">Custom Designed Secure Mobile Option</p>
<p id="p-0058" num="0057">The location sentry can be implemented as part of customized secure mobile device. Effectively acting as part of the customized operating system and hardware level firmware, the location sentry gains full access to all incoming and outgoing messages, state changes, subsystem activations and intra-system messaging.</p>
<p id="p-0059" num="0058"><figref idref="DRAWINGS">FIG. 5</figref></p>
<p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. 5</figref> depicts an example of the location sentry implemented as part of the mobile device's operating system <b>506</b>. This implementation could be achieved by the writing of a custom operating system or patching of the core system structures within the operating system, allowing the location sentry specific drivers to replace existing drivers and daemons in the modified operating system.</p>
<p id="p-0061" num="0060">The mobile device <b>501</b> has a wireless radio receiver subsystem <b>502</b> that passes demodulated messages to the hardware operating system <b>506</b> via a virtual or physical data interconnection <b>504</b>. The LS application <b>505</b> is the gateway and API for the incoming messaging to the operating system <b>506</b> and analyzes and filterers location related radio messaging before routing to the correct application. In this example, LS application <b>505</b> could be a modified version of the wireless radio receiver application program interface.</p>
<p id="p-0062" num="0061">Location hardware (such as a GPS chipset) or location software (routines for signal collection for location) are shown in <figref idref="DRAWINGS">FIG. 5</figref> as the location subsystem <b>509</b>, communicating with the operating system <b>506</b> via a virtual or physical data interconnection <b>508</b>. The location sentry <b>507</b> is the gateway and API for the for exchange of messages between the operating system <b>506</b>, an application, and the location subsystem <b>509</b> allowing for deactivation, filtering and substitution of location or location-related measurements.</p>
<p id="p-0063" num="0062">A location sentry <b>510</b> gateway and API for outgoing messaging allows analysis of messaging before being delivered to the wireless radio transmitter <b>503</b> via a virtual or physical data interconnection <b>511</b>. As part of the operating system <b>506</b> drivers, daemons, and APIs, the location sentry <b>510</b> can filter, edit, or substitute location-related messaging before transmission.</p>
<p id="p-0064" num="0063">Location Request and Response Types</p>
<p id="p-0065" num="0064">A location attempt can be immediate, with a timely response expected. A location attempt can be immediate with delayed delivery. A location attempt can be delayed with the response sent after a set delay or triggering event. A location attempt can be store and burst, with multiple location estimations stored with the collected responses transmitted after a set delay or triggering event.</p>
<p id="p-0066" num="0065">Mobile States and States Transitions</p>
<p id="p-0067" num="0066">A mobile device has two general states, active and idle. While in the idle state, the mobile conserves power by limiting on-board activity and keeping transmission facilities powered down. While in idle mode, the mobile device typically periodically activates receiver facilities to check the local beacon(s) for relevant messages. When in active mode, the mobile device uses control or traffic channel resources (or in a packet radio network, control plane and user plane resources) to transfer data between the mobile device and the wireless communications network.</p>
<p id="p-0068" num="0067">The terms control channel, traffic channel, control plane and user plane are indicative of the design of the wireless network.</p>
<p id="p-0069" num="0068">In a WCN designed for switched-circuit, predominately voice traffic, transmissions; control channels are used for messaging between the wireless network that controls mobile device states, radio settings, and network access. Limited bandwidth, limited duration data sessions (predominately Short-Message-Service (SMS) may also be supported on the control channel. A traffic channel is a radio network equivalent of a switched circuit and is designed to support high bandwidth, high duration voice and data sessions.</p>
<p id="p-0070" num="0069">In a WCN designed for packet-data transmissions, control data is deemed the control plane while data traffic (including packetized voice) is deemed user plane. The control plane, defined as the messaging between the wireless network that controls mobile device states, radio settings, and network access parameters. The user plane, defined as the messaging between peer entities, allows for data transmissions between software applications local to the mobile device and land-based (or mobile-based) server-based applications. Generally, the wireless communications network (WCN) is unaware of the contents of the user plane. User plane transmitted message contents may be encrypted to prevent snooping. User plane conveyed data can be used by privileged mobile-resident applications to access the mobile's location subsystems.</p>
<p id="p-0071" num="0070">Generic Detection of Mobile-Based Location Attempts</p>
<p id="p-0072" num="0071">Mobile-based (and mobile-assisted) location techniques require the collection of radio information at the mobile-device. This radio information may be the reception of satellite signaling for GNSS positioning or the radio information may be collected from cell broadcasts (forward-link) for the EOTD, OTDOA, or AFLT positioning techniques.</p>
<p id="p-0073" num="0072">Mobile-Based Active Mobile Location</p>
<p id="p-0074" num="0073">An active mobile is engaged in an information transfer using the wireless communication network radio resources. To locate active mobile using a mobile-based location technique, the mobile must receive location-related messaging (activation and potentially assistance data), the mobile will collect location information, e.g., GPS coordinates, beacon measurements from surrounding base stations, satellite measurements etc., the mobile will activate location-related hardware (if applicable) and then the mobile must transmit the location or location-related signal data. All of these mobile actions can be detected and any can act as a trigger for analysis for recognition of a location event in progress.</p>
<p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. 6</figref></p>
<p id="p-0076" num="0075"><figref idref="DRAWINGS">FIG. 6</figref> shows a simplified illustration of a location recognition event. In this example, the Wireless Communications Network <b>601</b> sends a message (or messaging) <b>603</b> to the mobile device <b>602</b>.</p>
<p id="p-0077" num="0076">The Location Sentry <b>604</b> examines the incoming message(s) <b>603</b>. If an unauthorized location event is detected, e.g., an event indicative of receipt of a location request and/or data used to assist in a location calculation, the Location Sentry <b>604</b> can respond <b>606</b> with an error message, a default location, or a spoofed location.</p>
<p id="p-0078" num="0077">Mobile-Based Idle Mobile Location</p>
<p id="p-0079" num="0078">An idle mobile acts as a receiver, listening to the broadcast channel(s) for messages specific to it's on-air identity. To locate a idle mobile using mobile-based techniques, the mobile first must be brought active and then location-related messaging used to activate the mobile-based software (and potentially hardware) before a location or location data can be developed. The change in state followed by the location-related messaging is an indicator of a location attempt.</p>
<p id="p-0080" num="0079"><figref idref="DRAWINGS">FIG. 7</figref></p>
<p id="p-0081" num="0080"><figref idref="DRAWINGS">FIG. 7</figref> illustrates the example of location detection via device state changes and subsystem activations.</p>
<p id="p-0082" num="0081">The mobile achieves IDLE state <b>701</b> sometime after successfully accessing the radio access network. Due to incoming radio messaging or internal application-level messaging, the mobile is moved to the ACTIVE <b>701</b> state. The location sentry detects an unauthorized activation of the onboard location subsystem <b>703</b>, causing an alert to be generated and optionally displayed on a display of the mobile device. Similar to that described above, the onboard location subsystem <b>703</b> can include both the circuitry-based systems (e.g. GNSS) and also the software API based (e.g. AFLT, OTDOA). For example, an unauthorized activation could be detected by comparing a process identifier of a process that attempts to access the location subsystem <b>703</b> to a list stored in a database. In the instance that the process identifier is not in the list, the location sentry can be configured to determine that this is an unauthorized attempt.</p>
<p id="p-0083" num="0082">Detection of Locally Activated Location Attempts</p>
<p id="p-0084" num="0083">A software application local to the mobile device may request unauthorized positioning. Two examples of possible infiltration include use of the SIM-tookit or software &#x201c;apps&#x201d; running under the control of the mobile-devices operating system.</p>
<p id="p-0085" num="0084">SIM Toolkit</p>
<p id="p-0086" num="0085">Since 1996 the SIM (subscriber identity module) Toolkit (STK) has provided a method for retention of small software applications and data on the SIM. These SIM-based applications can interact with the subsystems of the mobile device via the SIM toolkit APIs. Almost every SIM (U-SIM, R-UIM) comes equipped with the STK making the it the most spread application platform for mobile phones/equipment. Implantation of a rogue SIM-based application could be used to generate location estimates periodically or in response to an external event. Detection of the SIM-based rogue application will be by analysis of the STK API, the activation of the location subsystem or attempted transmission of the location data. Thus, in an exemplary embodiment where the LS is implemented as a client application, the LS can encapsulate the STK API. In an exemplary embodiment where the LS is implemented as part of a HVE, the LS can be configured to receive requests from the SIM card and analyze them. Similarly, in an exemplary embodiment where the LS is implemented as part of a secured mobile operating system, the LS can receive requests from the SIM card and analyze them.</p>
<p id="p-0087" num="0086">Mobile Malware</p>
<p id="p-0088" num="0087">With the wide acceptance of smart-phones, phones with general purpose operating systems, means that the whole menagerie of malware; including viruses, Trojans, and root-kits are available to induce unauthorized location attempts.</p>
<p id="p-0089" num="0088">Detection of the malware application attempting to induce an unauthorized location attempt can be accomplished by analyzing the location API(s), the activation of the location subsystem, or attempted transmission of the location data, for messages that indicate that a malware application is attempting to access these subsystems.</p>
<p id="p-0090" num="0089">Technology Specific Location Attempt Recognition</p>
<p id="p-0091" num="0090">Mobile-Based, Mobile Assisted</p>
<p id="p-0092" num="0091">For many of the mobile-based or mobile-assisted wireless location techniques, a control channel or control-plane implementation has been standardized. User plane implementations of each of the following techniques are possible so the location sentry application, as designed, can recognize either implementation.</p>
<p id="p-0093" num="0092">GNSS Positioning</p>
<p id="p-0094" num="0093">In GNSS Positioning, the mobile must be or become active, a location must be requested and satellite signals must be collected at the mobile device. Location computation may be local or at a land-side processor with the mobile transmitting the location or collected satellite signal data.</p>
<p id="p-0095" num="0094">Triggers for recognition of a GNSS positioning attempt include an event indicating a possible state change, an event indicting a location request was received, an event indicating that a GNSS receiver was activated, an event indicating that a location was computed, or an event indicating that location coordinates or collected satellite data was placed in the outbound transmission queue.</p>
<p id="p-0096" num="0095">AGNSS Positioning</p>
<p id="p-0097" num="0096">In AGNSS Positioning, the mobile must be or become active, assistance data must be provided, a location must be requested and satellite signals must be collected at the mobile device. Location computation may be local or at a land-side processor with the mobile transmitting the location or collected satellite signal data.</p>
<p id="p-0098" num="0097">Triggers for recognition of a GNSS positioning event include an event indicating a possible state change, an event indicating receipt of assistance data, an event indicating that a location request was received, an event indicating that the GNSS receiver was activated, an event indicating that location coordinates were computed, and/or an event indicating that location coordinates or collected satellite data was placed in the outbound transmission queue.</p>
<p id="p-0099" num="0098">SUPL Positioning</p>
<p id="p-0100" num="0099">In SUPL Positioning the user plane is used, assistance data must be provided, a location must be requested and satellite signals must be collected at the mobile device. Location computation may be local or at a land-side processor with the mobile transmitting the location or collected satellite signal data.</p>
<p id="p-0101" num="0100">Triggers for recognition of a GNSS positioning event include an event indicating the receipt of assistance data, an event indicating that a location request was received, an event indicating that the GNSS receiver was activated, an event indicating that location coordinates were calculated, and/or an event indicating that location coordinates or collected satellite data was placed the outbound transmission queue.</p>
<p id="p-0102" num="0101">OTDOA Positioning</p>
<p id="p-0103" num="0102">With OTDOA positioning, beacon timing information is collected from the broadcasts of the wireless communications network and either the control plane or user plane may be used. Location computation may be local or at a land-side processor with the mobile transmitting the location or collected beacon data.</p>
<p id="p-0104" num="0103">Triggers for recognition of a OTDOA positioning event include an event indicating that assistance data was received, an event indicating that a location request was received, an event indicating that a specialized receiver scanning mode was activated, an event indicating that coordinates were computed, and/or an event indicating that coordinates or collected location data was placed in the outbound transmission queue.</p>
<p id="p-0105" num="0104">AFLT Positioning</p>
<p id="p-0106" num="0105">With OTDOA positioning, beacon timing information is collected from the broadcasts of the wireless communications network and either the control plane or user plane may be used. Location computation may be local or at a land-side processor with the mobile transmitting the location or collected beacon data.</p>
<p id="p-0107" num="0106">Triggers for recognition of a AFLT positioning event include an event indicating that assistance data was received, an event indicating that a location request was received, an event indicating that a specialized receiver scanning procedure was activated, an event indicating ordered changes in the collection of beacon timing, an event indicating that the location was computed, or an event indicating that coordinate or collected location-related data was placed in the outbound transmission queue.</p>
<p id="p-0108" num="0107">EOTD Positioning</p>
<p id="p-0109" num="0108">With EOTD positioning, beacon timing information is collected from the broadcasts of the wireless communications network and either the control plane or user plane may be used. Location computation may be local or at a land-side processor with the mobile transmitting the location or collected beacon data.</p>
<p id="p-0110" num="0109">Triggers for recognition of a EOTD positioning event include an event indicating that the assistance data was received, an event indicating that a location request was received, an event indicating that a specialized receiver scanning mode was activated, an event indicating that coordinates were computed, and/or an event indicating that coordinates or collected location data was placed in the outbound transmission queue.</p>
<p id="p-0111" num="0110">ECID Positioning</p>
<p id="p-0112" num="0111">With ECID positioning, serving cell beacon timing information and power measurements from nearby cell sites is collected from the broadcasts of the wireless communications network. Location computation may be local or at a land-side processor with the mobile transmitting the location or collected beacon data.</p>
<p id="p-0113" num="0112">Triggers for recognition of a ECID positioning event include an event indicating that a location request was received, timing changes in the reporting of beacons, an event indicating that a specialized receiver scanning mode was activated, an event indicating that coordinates were computed, and/or an event indicating that coordinates or collected location data was placed in the outbound transmission queue.</p>
<p id="p-0114" num="0113">RF Fingerprinting Positioning</p>
<p id="p-0115" num="0114">With RF Fingerprinting positioning, also known as wireless signatures, power measurements from nearby cell sites are collected from the broadcasts of the wireless communications network. This power information can be combined with the serving cell identification and timing range (e.g. Timing Advance, Round-Trip-Time, or Serving-One-Way-Delay) from the serving cell as a hybrid location. Location computation may be local or at a land-side processor with the mobile transmitting the location or collected beacon data. Regardless of mobile-based or network-assisted location computation, the power measurements must be compared to the recorded or modeled measurements from the calibration database to find the best match and thus the most probable location.</p>
<p id="p-0116" num="0115">Triggers for recognition of an RF Fingerprinting positioning event include an event indicating that a location request was received, timing changes in the reporting of beacons, an event indicating that a specialized receiver scanning mode was activated, an event indicating that coordinates were locally computed, and/or an event indicating that coordinates or collected location data was placed in the outbound transmission queue.</p>
<heading id="h-0010" level="1">Alternative Embodiments</heading>
<p id="p-0117" num="0116">Location Spoofing</p>
<p id="p-0118" num="0117">Once a fraudulent or simply unwanted location attempt has been detected, prevention or spoofing of a mobile device's location may be desired. For example, the location sentry can remove the location information from the outgoing message queue and/or spoof the location or location-related measurement information. Spoofing of location includes:</p>
<p id="p-0119" num="0118">Local Interception and Replacement</p>
<p id="p-0120" num="0119">The location sentry can, with its emplacement into the exit queue for the mobile device's transmitter, replace a location estimate with coordinates for a default location, a previous location, or a current dithered (lower accuracy) location.</p>
<p id="p-0121" num="0120">Local Spoofing of Received Satellite Information</p>
<p id="p-0122" num="0121">The location sentry can, with its emplacement into the exit queue for the mobile transmitter, replace location related signal measurements (such as GPS pseudo-ranges) with degraded measurements.</p>
<p id="p-0123" num="0122">Local Spoofing of Received Network Information</p>
<p id="p-0124" num="0123">The location sentry can, with its emplacement into the exit queue for the mobile transmitter, replace received network based information, such as the serving cell identifier or the identifiers and received power levels from neighboring cells with minimal disruptions. A specific example of a spoofing technique in a spread spectrum system could be configuring the mobile device to randomly select from any of the active set cells to report a cell-ID location. Another specific example of a spoofing method could be to report a subset of detected neighboring beacons. For instance, if the mobile only reports a single serving and a single neighboring cell, ECID, OTDOA, and AFLT techniques are negated while the communications and mobility are not affected.</p>
<p id="p-0125" num="0124">Falsification of Mobile Location Capabilities</p>
<p id="p-0126" num="0125">When an unauthorized location attempt is detected, the location sentry can, with its emplacement into the exit queue for the mobile transmitter, block outgoing location-related messaging and instead respond to the location request with a location-type-not-supported message, concealing the true location capabilities of the mobile device.</p>
<p id="p-0127" num="0126"><figref idref="DRAWINGS">FIG. 8</figref></p>
<p id="p-0128" num="0127"><figref idref="DRAWINGS">FIG. 8</figref> graphically depicts the procedure for implementing of a spoofing scheme. The mobile device based location sentry detects an unauthorized location event <b>801</b>. Based on user preferences and/or mobile device capabilities as stored in the database <b>805</b>, location spoofing <b>804</b> may be used to report incorrect, inaccurate or a previously recorded (in the database <b>805</b>) location. Location spoofing <b>804</b> may also be used to report the mobile device capabilities as not supporting the requested location technique.</p>
<p id="p-0129" num="0128">If the mobile device is equipped with a GNSS receiver and GNSS positioning is requested, satellite spoofing <b>802</b> may be used to report inadequate satellite coverage, degraded satellite broadcast measurements, substituted satellite broadcast measurements, or preset/recorded prior satellite broadcast measurements.</p>
<p id="p-0130" num="0129">If a unauthorized beacon-based location or beacon measurement request is received, beacon spoofing <b>803</b> may be used. A subset of the actual detected beacons or degraded beacon signal strengths would be used to generate an inaccurate location or delivered for landside processing.</p>
<p id="p-0131" num="0130">For each spoofing method, the altered messaging or location would be send over the radio air interface as an outgoing transmission <b>806</b>.</p>
<p id="p-0132" num="0131">One example of location spoofing would be a privileged mobile device where the user is never tracked. In this case, every mobile location attempt and every network measurement would be distorted or degraded to prevent precise location</p>
<p id="p-0133" num="0132">The true scope the present invention is not limited to the presently preferred embodiments disclosed herein. Insofar as the block diagrams and/or examples described above contain one or more functions and/or operations, it will be understood by those within the art that each function and/or operation within such block diagrams, or examples can be implemented, individually and/or collectively, by a wide range of hardware, software, firmware, or virtually any combination thereof. While particular aspects of the present subject matter described herein have been shown and described, it will be apparent to those skilled in the art that, based upon the teachings herein, changes and modifications may be made without departing from the subject matter described herein and its broader aspects and, therefore, the appended claims are to encompass within their scope all such changes and modifications as are within the scope of the subject matter described herein. Accordingly, except as they may be expressly so limited, the scope of protection of the following claims is not intended to be limited to the specific embodiments described above.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A mobile device operable to communicate with a wireless network and configured to monitor software running on the mobile device to detect unauthorized location attempts, comprising:
<claim-text>a processor; and</claim-text>
<claim-text>a memory coupled to the processor, the memory including instructions that upon execution cause the processor to execute an operational procedure for monitoring software running on the mobile device, the memory comprising:</claim-text>
<claim-text>instructions for identifying a sequence of events indicative of a possible unauthorized attempt to locate the mobile device, wherein the sequence of events includes:</claim-text>
<claim-text>an event indicating that a location subsystem of the mobile device was activated;</claim-text>
<claim-text>an event indicating that the mobile device entered into a scanning mode for receiving beacon signals from a plurality of base stations or for receiving satellite signals from a plurality of satellites; and</claim-text>
<claim-text>an event indicating that data used to assist in a location calculation was received from a wireless network;</claim-text>
<claim-text>instructions for logging the sequence of events and analyzing the sequence of events to identify an unauthorized location attempt;</claim-text>
<claim-text>instructions for responding to the unauthorized location attempt by transmitting inaccurate location information;</claim-text>
<claim-text>instructions for a receiver-location sentry client application that encapsulates an application program interface for a wireless receiver, wherein the receiver-location sentry client application is configured to analyze incoming messages received by the wireless receiver;</claim-text>
<claim-text>instructions for a transmitter-location sentry client application that encapsulates an application program interface for a wireless transmitter, wherein the transmitter-location sentry client application is configured to analyze messages placed into an outgoing queue for transmission to the wireless network; and</claim-text>
<claim-text>instructions for a location-subsystem-location sentry client application that encapsulates an application program interface for the location subsystem, wherein the location-subsystem-location sentry client application is configured to analyze messages sent to the location subsystem.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for determining that the sequence of events includes an event indicating that a program executing on the mobile device requested to access the location subsystem; and</claim-text>
<claim-text>instructions for determining that the program is not authorized to access the location subsystem.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The mobile device of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the program is a program stored on a SIM card.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for determining that the sequence of events includes an event indicating that the mobile device transitioned from an idle mode to an active mode.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for displaying an alert indicating that an unauthorized attempt to locate the mobile device was identified.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for sending an error message to the wireless network indicating that the mobile device cannot support a location attempt.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for sending a message to the wireless network that indicates that the mobile device does not include a location subsystem.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for sending inaccurate location information to the wireless network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for sending location information for a default location to the wireless network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for sending location information for a previous location to the wireless network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for sending inaccurate satellite measurement information to the wireless network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for sending inaccurate location related signal measurement data to the wireless network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for sending a cell-ID identifier randomly selected from a group of active set cells to the wireless network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for sending identifiers for a subset of detected beacon signals to the wireless network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for sending information to the wireless network indicating that the satellite coverage is inadequate to receive satellite signals.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for running an operating system for the mobile device within a virtualization environment, wherein the virtualization environment is configured to monitor messages received by the wireless receiver, messages placed into an outgoing queue for transmission to the wireless network, and messages sent to the location subsystem for message indicative of attempts to location to the mobile device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory further comprises:
<claim-text>instructions for a wireless receiver application program interface, wherein the wireless receiver application program interface is configured to monitor incoming messages for messages that include location request and/or message that include data used to assist in a location calculation;</claim-text>
<claim-text>instructions for wireless transmitter application program interface, wherein the wireless transmitter application program interface is configured to monitor outgoing for messages that include location information; and</claim-text>
<claim-text>instructions for a location subsystem application program interface, wherein the location subsystem application program interface is configured to monitor messages sent to the location subsystem for unauthorized attempts to activate the location subsystem.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
