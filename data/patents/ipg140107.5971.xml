<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08627084-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08627084</doc-number>
<kind>B1</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13658678</doc-number>
<date>20121023</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>32</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>713171</main-classification>
</classification-national>
<invention-title id="d2e43">Secure messaging systems</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5016276</doc-number>
<kind>A</kind>
<name>Matumoto et al.</name>
<date>19910500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5159632</doc-number>
<kind>A</kind>
<name>Crandall</name>
<date>19921000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5271061</doc-number>
<kind>A</kind>
<name>Crandall</name>
<date>19931200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5272755</doc-number>
<kind>A</kind>
<name>Miyaji et al.</name>
<date>19931200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>5418908</doc-number>
<kind>A</kind>
<name>Keller et al.</name>
<date>19950500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>5581616</doc-number>
<kind>A</kind>
<name>Crandall</name>
<date>19961200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>5790790</doc-number>
<kind>A</kind>
<name>Smith et al.</name>
<date>19980800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>5920630</doc-number>
<kind>A</kind>
<name>Wertheimer et al.</name>
<date>19990700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6061448</doc-number>
<kind>A</kind>
<name>Smith et al.</name>
<date>20000500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6192407</doc-number>
<kind>B1</kind>
<name>Smith et al.</name>
<date>20010200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6377688</doc-number>
<kind>B1</kind>
<name>Numao</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>6442600</doc-number>
<kind>B1</kind>
<name>Anderson</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>6487599</doc-number>
<kind>B1</kind>
<name>Smith et al.</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>6560705</doc-number>
<kind>B1</kind>
<name>Perlman et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>6651087</doc-number>
<kind>B1</kind>
<name>Dennis</name>
<date>20031100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>6687741</doc-number>
<kind>B1</kind>
<name>Ramaley et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>6707890</doc-number>
<kind>B1</kind>
<name>Gao et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>6741705</doc-number>
<kind>B1</kind>
<name>Nelson et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>6760752</doc-number>
<kind>B1</kind>
<name>Liu et al.</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>6839741</doc-number>
<kind>B1</kind>
<name>Tsai</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>6993574</doc-number>
<kind>B2</kind>
<name>Hall</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>7020688</doc-number>
<kind>B2</kind>
<name>Sykes</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>7058971</doc-number>
<kind>B1</kind>
<name>Horikiri</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>7113594</doc-number>
<kind>B2</kind>
<name>Boneh et al.</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>7149893</doc-number>
<kind>B1</kind>
<name>Leonard et al.</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>7266847</doc-number>
<kind>B2</kind>
<name>Pauker et al.</name>
<date>20070900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>2002/0004899</doc-number>
<kind>A1</kind>
<name>Azuma</name>
<date>20020100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>2002/0016910</doc-number>
<kind>A1</kind>
<name>Wright et al.</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00029">
<document-id>
<country>US</country>
<doc-number>2002/0038421</doc-number>
<kind>A1</kind>
<name>Hamada</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00030">
<document-id>
<country>US</country>
<doc-number>2002/0076042</doc-number>
<kind>A1</kind>
<name>Sandhu et al.</name>
<date>20020600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00031">
<document-id>
<country>US</country>
<doc-number>2002/0076055</doc-number>
<kind>A1</kind>
<name>Filipi-Martin et al.</name>
<date>20020600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00032">
<document-id>
<country>US</country>
<doc-number>2002/0124167</doc-number>
<kind>A1</kind>
<name>Toyota et al.</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00033">
<document-id>
<country>US</country>
<doc-number>2003/0076954</doc-number>
<kind>A1</kind>
<name>Vanstone et al.</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00034">
<document-id>
<country>US</country>
<doc-number>2003/0142364</doc-number>
<kind>A1</kind>
<name>Goldstone</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00035">
<document-id>
<country>US</country>
<doc-number>2004/0025019</doc-number>
<kind>A1</kind>
<name>Watanabe et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00036">
<document-id>
<country>US</country>
<doc-number>2004/0179684</doc-number>
<kind>A1</kind>
<name>Appenzeller et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00037">
<document-id>
<country>US</country>
<doc-number>2005/0071632</doc-number>
<kind>A1</kind>
<name>Pauker et al.</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00038">
<document-id>
<country>US</country>
<doc-number>2005/0138353</doc-number>
<kind>A1</kind>
<name>Spies et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00039">
<document-id>
<country>WO</country>
<doc-number>0251066</doc-number>
<date>20020600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00040">
<document-id>
<country>WO</country>
<doc-number>03001326</doc-number>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00041">
<othercit>Jeremy Horwits and Ben Lynn, &#x201c;Toward Hierarchical Identity-Based Encryption,&#x201d; Advances in Cryptology: Eurocrypt 2002, Lecture Notes in Computer Science, vol. 2332, pp. 466-481, 2002.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00042">
<othercit>Xue Lai and James L. Massey, &#x201c;A Proposal for a New Block Encryption Standard,&#x201d; Advances in Cryptology&#x2014;Eurocrypt '90, pp. 389-404, Proceedings, LNCS 473, Springer-Verlag, 1991.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>10</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>713168</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713182</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380258</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380178</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380286</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380 44</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380 30</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>15</number-of-drawing-sheets>
<number-of-figures>16</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>13040050</doc-number>
<date>20110303</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>8301889</doc-number>
</document-id>
</parent-grant-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13658678</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>10406938</doc-number>
<date>20030404</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>7921292</doc-number>
</document-id>
</parent-grant-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13040050</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only" applicant-authority-category="assignee">
<addressbook>
<orgname>Voltage Security, Inc.</orgname>
<address>
<city>Cupertino</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Pauker</last-name>
<first-name>Matthew J.</first-name>
<address>
<city>San Francisco</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Spies</last-name>
<first-name>Terence</first-name>
<address>
<city>Mountain View</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Kacker</last-name>
<first-name>Rishi</first-name>
<address>
<city>Menlo Park</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Appenzeller</last-name>
<first-name>Guido</first-name>
<address>
<city>Palo Alto</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Treyz Law Group</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Treyz</last-name>
<first-name>G. Victor</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Voltage Security, Inc.</orgname>
<role>02</role>
<address>
<city>Cupertino</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Chea</last-name>
<first-name>Philip</first-name>
<department>2436</department>
</primary-examiner>
<assistant-examiner>
<last-name>Hoang</last-name>
<first-name>Daniel</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A system is provided that uses cryptographic techniques to support secure messaging between senders and recipients. A sender may encrypt a message for a recipient using the recipient's public key. The sender may send the encrypted message to the message address of a given recipient. A server may be used to decrypt the encrypted message for the recipient, so that the recipient need not install a decryption engine on the recipient's equipment.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="217.68mm" wi="170.10mm" file="US08627084-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="229.19mm" wi="176.53mm" file="US08627084-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="185.93mm" wi="154.09mm" file="US08627084-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="229.19mm" wi="130.98mm" file="US08627084-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="204.47mm" wi="141.05mm" file="US08627084-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="227.58mm" wi="127.42mm" file="US08627084-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="208.03mm" wi="137.50mm" file="US08627084-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="233.76mm" wi="157.65mm" file="US08627084-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="220.05mm" wi="176.87mm" file="US08627084-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="230.12mm" wi="159.60mm" file="US08627084-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="239.61mm" wi="158.33mm" file="US08627084-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="225.72mm" wi="175.26mm" file="US08627084-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="234.10mm" wi="169.67mm" file="US08627084-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="220.39mm" wi="144.36mm" file="US08627084-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="213.61mm" wi="171.62mm" file="US08627084-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="229.87mm" wi="169.08mm" file="US08627084-20140107-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<p id="p-0002" num="0001">This application is a continuation of patent application Ser. No. 10/406,938, filed Apr. 4, 2003 and patent application Ser. No. 13/040,050, filed Mar. 3, 2011, which are hereby incorporated by reference herein in their entireties.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">This invention relates to messaging systems such as email messaging systems, and more particularly, to ways in which to send secure messages.</p>
<p id="p-0004" num="0003">Cryptographic systems are used to provide secure communications services such as secure email services and secure web browsing.</p>
<p id="p-0005" num="0004">With symmetric key cryptographic systems, the sender of a message uses the same key to encrypt the message that the recipient of the message uses to decrypt the message. Symmetric-key systems require that each sender and recipient exchange a shared key in a secure manner.</p>
<p id="p-0006" num="0005">With public-key cryptographic systems, two types of keys are used&#x2014;public keys and private keys. Senders may encrypt messages using the public keys of the recipients. Each recipient has a private key that is used to decrypt the messages for that recipient.</p>
<p id="p-0007" num="0006">One public-key cryptographic system that is in use is the RSA cryptographic system. Each user in this system has a unique public key and a unique private key. A sender may obtain the public key of a given receiver from a key server over the Internet. To ensure the authenticity of the public key and thereby defeat possible man-in-the-middle attacks, the public key may be provided to the sender with a certificate signed by a trusted certificate authority. The certificate may be used to verify that the public key belongs to the intended recipient of the sender's message. Public key encryption systems based on this type of fairly traditional approach are referred to herein as PKE cryptographic systems.</p>
<p id="p-0008" num="0007">Identity-based-encryption (IBE) arrangements have also been proposed. With IBE encryption systems, a message recipient's email address or other identity-based information may be used as the recipient's public key. With IBE encryption schemes, it is generally not necessary to look up a given recipient's public key as with PKE systems such as the RSA system. Rather, a sender may create the public key based on well-known rules. For example, a sender may create the public key by simply determining the recipient's email address.</p>
<p id="p-0009" num="0008">Public parameter information and private keys are used to support IBE encryption and decryption operations. Each user has a unique private key based on the user's identity for decrypting messages, but the public parameter information that is used during the encryption and decryption processes may be shared by many users. These schemes are said to be &#x201c;identity based,&#x201d; because user-specific identity information such as a particular intended recipient's email address is used as one of the inputs to the IBE encryption algorithm. With one suitable arrangement, a user's email address or a user's email address concatenated with a date stamp may be used to identify each user.</p>
<p id="p-0010" num="0009">When a recipient receives a PKE-encrypted or IBE-encrypted message, the recipient must generally use an appropriate decryption algorithm to decrypt the encrypted message and access its contents. If the recipient does not have the appropriate decryption software installed on their equipment, the recipient may download a plug-in module or otherwise obtain the necessary software for performing the decryption process. This can be difficult for the recipient to do, particularly if the recipient wishes to receive encrypted messages in an organization that places restrictions on user-installed software.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0011" num="0010">In accordance with the present invention, a system is provided that provides secure messaging capabilities. Senders can send secure messages to recipients. PKE and IBE encryption techniques may be used to encrypt the messages. A server such as a third-party server on the Internet or a LAN server can be used to decrypt messages for recipients. Recipients generally need not install and run decryption software on their equipment in order to receive access to the content of the messages.</p>
<p id="p-0012" num="0011">With one suitable approach, encrypted mail is sent to a recipient's email address. A server at the recipient's organization may receive the encrypted mail and may store it in an encrypted mail database. The server may send the recipient a notification message that informs the recipient that a message is awaiting the recipient. The message may include an interactive prompt such as a URL or other link that the recipient can click on to begin accessing the message. When the recipient responds to the notification message from the server, the server may ask the recipient to provide suitable credentials that the server can use to verify the identity of the recipient. After verifying that the recipient is authorized to access the message, the server can use the recipient's credentials to obtain a copy of the recipient's private key. The server can then retrieve the stored version of the encrypted message from the encrypted mail database and can decrypt the message using the recipient's private key and the appropriate decryption algorithm. The server can provide the recipient with access to the decrypted message over a secure link.</p>
<p id="p-0013" num="0012">With another suitable approach, the encrypted message from the sender may include forwarding notification information in the form of instructions for the recipient that direct the recipient to forward the encrypted message to a suitable decryption server for decryption. For example, the sender's messaging program may incorporate forwarding notification information into the message in the form of text stating &#x201c;to view, forward this message to decrypt@xyz.com.&#x201d; When the server receives the forwarded encrypted message from the recipient, the server may respond by sending an interactive message to the recipient. The interactive message may include an interactive message access prompt such as a URL or other link that the recipient can click on to begin accessing the decrypted contents of the message. After the recipient responds to the interactive message, the server may verify the recipient's authorization to access the contents of the encrypted message. If the recipient is authorized, the server may obtain a copy of the recipient's private key and may use the key and a suitable decryption algorithm to decrypt the encrypted message. The server may provide the recipient with access to the decrypted version of the message over a secure communications link.</p>
<p id="p-0014" num="0013">If desired, other equipment (e.g., the sender's equipment or a downstream server) may add an interactive message access prompt (e.g., a URL or other clickable link) that the recipient can respond to in order to initiate message retrieval. With this type of approach, the forwarding notification information (e.g., &#x201c;to view, forward this message to decrypt@xyzcorp.com&#x201d;) may (in unencrypted form) be incorporated into the encrypted message by the sender. The interactive message access prompt (e.g., an unencrypted prompt stating &#x201c;after forwarding message, click here to access: https://decrypt.intranet.xyzcorp.com&#x201d;) may be added to the encrypted message by the sender or by a downstream server. For example, the sender's equipment, a server at the recipient's location, or an intermediate server may add the interactive message access prompt to the original message. When the recipient receives the encrypted message, the recipient may forward the message to the appropriate server for decryption in response to the forwarding notification information. Because both the forwarding notification information and the interactive message access prompt appear in the same message (along with the encrypted payload), it is not necessary for the server to send a separate interactive message to the recipient. After the recipient responds to the interactive message access prompt (e.g., by clicking on the link), the server can verify that the recipient is authorized to access the content of the encrypted message and can obtain a copy of the recipient's private key. The server may use the private key and the appropriate decryption algorithm to decrypt the encrypted message. The server may then provide the recipient with access to the content of the decrypted message over a secure communications link.</p>
<p id="p-0015" num="0014">If desired, the recipient may install software that automatically forwards certain encrypted messages to the server for decryption. The auto-forwarding software may, for example, forward to the server all messages that contain a particular code (e.g., a text or numeric code indicating that decryption by a particular server is required and specifying the address of that server).</p>
<p id="p-0016" num="0015">The software running on the sender's equipment may, if desired, automatically send a copy of an encrypted message to a server when the original encrypted message is sent to the recipient. The server may retain the copy of the encrypted message until contacted by the recipient. Because the server already has a copy of the encrypted message when the system is configured in this way, the recipient need not forward a copy of the message to the server and the message need not contain forwarding notification information or information for supporting automatic forwarding by the recipient. The message may contain an interactive message access prompt such as a clickable URL or other link. When the recipient responds to the prompt, the server may verify that the recipient is authorized to access the message. If the recipient is authorized, the server may obtain a copy of the recipient's private key. The server may decrypt the message using the recipient's private key and using the appropriate decryption algorithm. The server may then provide the recipient with access to the decrypted contents of the message over a secure link.</p>
<p id="p-0017" num="0016">Further features of the invention, its nature and various advantages will be more apparent from the accompanying drawings and the following detailed description of the preferred embodiments.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 1</figref> is a diagram of an illustrative system for supporting secure messaging functions in accordance with the present invention.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 2</figref> is a diagram of illustrative cryptographic system components used to implement PKE cryptographic techniques in accordance with the present invention.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 3</figref> is a flow chart of steps involved in using the PKE-based system components of <figref idref="DRAWINGS">FIG. 2</figref> in accordance with the present invention.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 4</figref> is a diagram of illustrative cryptographic system components used to implement IBE cryptographic techniques in accordance with the present invention.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 5</figref> is a flow chart of illustrative steps involved in using the IBE-based system components of <figref idref="DRAWINGS">FIG. 4</figref> in accordance with the present invention.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 6</figref> is a diagram of an illustrative secure messaging system in accordance with the present invention.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIGS. 7</figref><i>a </i>and <b>7</b><i>b </i>contain a flow chart of illustrative steps involved in using the system of <figref idref="DRAWINGS">FIG. 6</figref> to send secure messages from a sender to a recipient in accordance with the present invention.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 8</figref> shows an illustrative screen that may be displayed to a message recipient when the recipient is accessing the contents of a decrypted message over a secure communications link with a server in accordance with the present invention.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 9</figref> shows an illustrative screen that may be displayed to a message recipient when the recipient is viewing a message in-box that provides access to decrypted messages over a secure communications link with a server in accordance with the present invention.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIGS. 10</figref><i>a </i>and <b>10</b><i>b </i>contain a flow chart of illustrative steps involved in using the system of <figref idref="DRAWINGS">FIG. 6</figref> to send secure messages from a sender to a recipient in accordance with the present invention.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIGS. 11</figref><i>a </i>and <b>11</b><i>b </i>contain a flow chart of other illustrative steps involved in using the system of <figref idref="DRAWINGS">FIG. 6</figref> to send secure messages from a sender to a recipient in accordance with the present invention.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 12</figref> is a diagram of an illustrative system configuration that may be used to provide secure messaging when a sender sends a copy of a message to a server when sending the message to a message recipient in accordance with the present invention.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 13</figref> is a flow chart of illustrative steps involved in using the system of <figref idref="DRAWINGS">FIG. 12</figref> to send secure messages from a sender to a recipient in accordance with the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0031" num="0030">An illustrative system <b>10</b> that may be used to support secure messaging is shown in <figref idref="DRAWINGS">FIG. 1</figref>. In <figref idref="DRAWINGS">FIG. 1</figref> and the other FIGS., a user may send a secure message to one or more other users over a communications network <b>14</b>. The users in the systems described herein may be individuals, organizations, or any other suitable parties or entities. A user who is sending a message is called a sender. Users receiving messages are called recipients. The messages may include any digital information (e.g., text, graphics, audio, video, commands, executable code, data, etc.) that it is desired to convey electronically between senders and recipients in a secure manner.</p>
<p id="p-0032" num="0031">Users may communicate with each other using user equipment devices <b>12</b>. Equipment <b>12</b> may, for example, include computing equipment such as a personal computers, portable computers, mainframe computers, networked computers or terminals, telecommunications equipment, handheld computers or personal digital assistants, or cellular telephones. Multiple users may use the same device. For example, a group of users may share the use of a single computer terminal that is connected to a host computer in a local area network <b>16</b>. These are merely illustrative examples of the type of platforms that the users may use. User equipment <b>12</b> may be based on any suitable electronic equipment if desired.</p>
<p id="p-0033" num="0032">The user equipment devices in the arrangement of <figref idref="DRAWINGS">FIG. 1</figref> and the other FIGS. may be interconnected by communications paths <b>44</b> in communications network <b>14</b>. Network <b>14</b> may be, for example, the Internet, a local area network, a wide area network, the public switched telephone network, a virtual private network, a wired network, a wireless network, dedicated leased lines, a network based on fiber-optic or cable paths <b>44</b> or other wired or wireless paths <b>44</b>, or a network formed using any other suitable network technology or a combination of such networks.</p>
<p id="p-0034" num="0033">Various computing devices may be contained within network <b>14</b> and connected to network <b>14</b> to support secure messaging features. The location of such computing equipment is generally not critical. For example, computing equipment may be used to implement the functions of one or more servers <b>18</b>. One or more of such servers <b>18</b> may be used to implement a cryptographic key directory service (as an example). The server or servers may be co-located with a sender, may be connected to the network <b>14</b> as an independent third party, may be part of what is traditionally considered to be the infrastructure of network <b>14</b>, may be associated with a given recipient's organization, may be co-located with the recipient, or may used at more than one of these locations. These are merely illustrative arrangements and need not be mutually exclusive.</p>
<p id="p-0035" num="0034">The computing equipment that is contained within network <b>14</b> or connected to network <b>14</b> can be used as a server in a client-server architecture. The functions implemented using servers in system <b>10</b> may generally be performed using other computer equipment configurations if desired, but the computing equipment for implementing these functions is generally referred to as a &#x201c;server&#x201d; or &#x201c;servers&#x201d; for clarity. A server may be formed using a single computer or multiple computers. Multiple servers may be implemented on one computer. If desired, the functions of a single server may be provided by computers that are distributed over a number of different physical locations.</p>
<p id="p-0036" num="0035">A sender may send a message to a given recipient over system <b>10</b> using any suitable messaging format. For example, an email message, an instant message, or other electronic messages may be sent. For clarity, the present invention is sometimes described in the context of email messages. This is merely illustrative. Any suitable type of messages may be conveyed between senders and receivers if desired.</p>
<p id="p-0037" num="0036">During delivery of an encrypted message to a recipient, the encrypted message may pass through a number of mail servers and other computer equipment. Operation of system <b>10</b> is often described herein in the context of one server (or a small number of servers) for clarity and without loss of generality, even though messages may be conveyed through multiple mail servers during a typical delivery process. The functions of a given server may generally be implemented using multiple servers (and/or other system components) if desired, but this possibility is not mentioned repeatedly herein to help clarify the discussion.</p>
<p id="p-0038" num="0037">In system <b>10</b>, some recipients (e.g., the recipient labeled as recipient A in <figref idref="DRAWINGS">FIG. 1</figref>) may be communicate with a sender without being part of a local area network, whereas other recipients (e.g., the recipient labeled as recipient B in <figref idref="DRAWINGS">FIG. 1</figref>) may be located within a local area network (LAN) <b>20</b>. In LAN environments, one or more local servers <b>18</b> may be used to distribute messages (e.g., email messages) to users, as illustrated by the server <b>18</b> in LAN <b>20</b> in <figref idref="DRAWINGS">FIG. 1</figref>. Such a local server may, for example, be a server running Microsoft's Exchange email software.</p>
<p id="p-0039" num="0038">If a recipient is associated with a small organization, the recipient's organization may share a mail server with other organizations (i.e., the recipient's primary mail server may be operated by a third-party). If the recipient is associated with a medium-size organization, the recipient's organization may have an in-house mail server for distributing electronic messages to users at a single location. Large organizations may have numerous mail servers some of which may be operated at locations that are remote from the recipient's physical location and one or more of which may be co-located with the recipient. Mail server functions may be implemented on the same equipment that is used to implement other server functions (e.g., LAN support functions) or may be implemented on separate equipment.</p>
<p id="p-0040" num="0039">Some user activities in system <b>10</b>, such as sending person-to-person email messages, involve at least some manual intervention. For example, a person who desires to send a personally-composed text message must type the message before it is encrypted and sent to the appropriate recipient. However, other user activities in system <b>10</b> may be entirely automated so that no human intervention is generally required. As one example, the user at one device <b>12</b> may be a banking institution that desires to use encrypted communications to deliver encrypted bank statements to account holders at other devices <b>12</b> over communications network <b>14</b>. The statement preparation and distribution processes may be automated so that no operator intervention is generally needed at the banking institution's equipment once the system has been properly set up. User receipt of the statements may also be automated. Moreover, system functions involved in presenting on-screen options for humans to respond to (e.g., by clicking on them using a computer mouse) are also automated in that they are implemented using software running on the system components of <figref idref="DRAWINGS">FIG. 1</figref> and the other FIGS. Whether a particular function preferably involves manual intervention or may be implemented by a computer will be clear from context in the following discussion.</p>
<p id="p-0041" num="0040">During certain operations of system <b>10</b>, various entities (e.g., a private key generator, a key escrow service, a certificate authority, a mail server, etc.) may need to verify that a given user has permission to access certain content or to perform certain functions. In general, the entity performing the user authentication may use any suitable manual or automatic authentication technique. For example, the user may be asked to fax or mail a letter to the authenticating entity on the user's official letterhead, which is examined for authenticity by personnel or automated equipment at the authenticating entity. As another example, biometric identification techniques (e.g., fingerprint analysis, eye-scanning, handprint or voiceprint analysis, facial recognition methods, or in-person identification checks) may be used. A user may also provide credentials in the form of a pre-established user name and password.</p>
<p id="p-0042" num="0041">When the authentication process involves electronic communications between the user and the authenticating entity, the communications path between the user and the authenticating entity should be secure. The communications path may be assumed to be secure if it is not available for use by untrusted parties. For example, the network between the user and the authenticating entity's server may be a private line that is controlled by the authenticating entity or another trusted entity. As another example, a secure channel may be supported using a secure web browser link (e.g., using the secure sockets layer protocol).</p>
<p id="p-0043" num="0042">Often web-based authentication processes will be used for user authentication. An advantage of web-based authentication processes is that the most or all of the process of verifying a user's identity and authorization to access particular content or authorization to perform a particular operation may be performed on line using a web browser. With one suitable web-based approach, a user may be asked to provide information such as a username and password through a series of interactive web pages. Authentication approaches based on the use of hardware tokens and cookies may also be used. These are merely illustrative examples of suitable ways in which entities in system <b>10</b> can examine a user's credentials to verify whether users are authorized to access content or perform actions. Any suitable arrangement for authenticating users may be used if desired.</p>
<p id="p-0044" num="0043">The secure messaging systems of the present invention may use public key encryption cryptographic techniques such as used with RSA public-key cryptography. These traditional public key cryptographic techniques are referred to herein as &#x201c;PKE&#x201d; cryptographic techniques. The secure messaging systems of the present invention may also use identity-based encryption (IBE) cryptographic techniques. These cryptographic techniques are referred to herein as &#x201c;IBE&#x201d; cryptographic techniques.</p>
<p id="p-0045" num="0044">PKE and IBE encryption schemes use an asymmetric approach. Some information (so-called public key information) is used to encrypt messages. Other corresponding information (so-called private key information) is used to decrypt the encrypted message.</p>
<p id="p-0046" num="0045">To enhance the efficiency of the decryption and encryption processes, two-step decryption techniques may be used in which a message key (e.g., a symmetric message key) is used to encrypt the contents of a message prior to transmission to the recipient. The PKE or IBE process is then used to encrypt the symmetric message key. The message that is sent from the sender to the recipient contains the PKE-encrypted or IBE-encrypted message key and the message-key-encrypted message contents. At the recipient, the recipient uses the PKE private key or IBE private key to decrypt the message key. The message key may then be used by the recipient to decrypt the rest of the message. These two-step processes may be more efficient than &#x201c;pure&#x201d; or &#x201c;single step&#x201d; PKE and IBE encryption algorithms in which the PKE algorithm or IBE algorithm alone is used to encrypt the entire message. In general, either &#x201c;two-step&#x201d; encryption schemes or &#x201c;single-step&#x201d; schemes may be used. Both types of approaches are referred to herein as simply &#x201c;PKE&#x201d; schemes or &#x201c;IBE&#x201d; schemes for clarity.</p>
<p id="p-0047" num="0046">To understand the PKE and IBE secure messaging features used in system <b>10</b>, the basic principles of PKE and IBE messaging are described in connection with <figref idref="DRAWINGS">FIGS. 2-5</figref>. The principles of PKE-based secure messaging are introduced in connection with <figref idref="DRAWINGS">FIGS. 2 and 3</figref>. The principles of IBE-based secure messaging are introduced in connection with <figref idref="DRAWINGS">FIGS. 4 and 5</figref>. PKE-encrypted messages and IBE-encrypted messages are sent from senders to recipients. In the examples of <figref idref="DRAWINGS">FIGS. 2-5</figref>, the recipients have decryption software that is used to decrypt the encrypted messages. Recipients may not always be able (at least initially) to install decryption software on their equipment. For example, a network administrator may not allow a recipient in an organization to install decryption software on the recipient's equipment. To support secure PKE or IBE messaging in these environments, decryption functions may be implemented on a server that is separate from the recipient, but which the recipient can communicate with over a secure link. These types of server-based decryption arrangements are described in connection with <figref idref="DRAWINGS">FIGS. 6-14</figref>.</p>
<p id="p-0048" num="0047">System components that may be used to support PKE-based secure messaging are shown in <figref idref="DRAWINGS">FIG. 2</figref>. In <figref idref="DRAWINGS">FIG. 2</figref> (and the other FIGS.), users at user equipment devices <b>12</b> may communicate over communications network <b>14</b>. A server or other computing equipment at a PKE public key directory service <b>22</b> may be used to make the PKE public keys of users available to other users. A PKE private key escrow service <b>24</b> may be used to store the private keys of certain users. For example, PKE private key escrow service <b>24</b> may be used to store the private keys of those users in an organization who wish to receive encrypted email but who are not authorized by their system administrators to install their own desk-top decryption software.</p>
<p id="p-0049" num="0048">Illustrative steps involved in sending a message from a sender to a recipient using the PKE-based arrangement of <figref idref="DRAWINGS">FIG. 2</figref> are shown in <figref idref="DRAWINGS">FIG. 3</figref>. In PKE-based cryptographic schemes, key generators implemented at user locations or on remote equipment generate public-key/private-key pairs for users. The PKE public keys may be used by senders to encrypt messages prior to transmission to recipients. The recipients may use their unique PKE private keys to decrypt the encrypted messages.</p>
<p id="p-0050" num="0049">At step <b>23</b>, a recipient who desires to receive encrypted messages may obtain the PKE public-key/private-key pair from the key generator. The recipient may retain the PKE private key on the recipient's equipment for later use in decrypting PKE-encrypted messages. In some environments, the recipient's system administrator will not allow the recipient to install or run third-party software on the recipient's equipment. In such situations, the recipient may provide the recipient's PKE private key to a private key escrow service such as PKE private key escrow service <b>24</b> of <figref idref="DRAWINGS">FIG. 2</figref>. When the recipient's PKE private key is held by a PKE private key escrow service, trusted parties (e.g., a mail server associated with the recipient's organization) may obtain a copy of the recipient's PKE private key from the PKE private key escrow service and may use this copy in decrypting messages for the recipient.</p>
<p id="p-0051" num="0050">The recipient may publish the recipient's PKE public key on a PKE public key directory service such as PKE public key directory service <b>22</b> of <figref idref="DRAWINGS">FIG. 2</figref>. If desired, the recipient can provide the public key directly to interested senders (e.g., on a diskette, over the telephone, by email, by placing the public key on a web site, etc.). Regardless of how the recipient makes the recipient's PKE public key publicly available to other users in the system, a sender must obtain a copy of the PKE public key of the recipient before the sender can encrypt a message for that recipient using PKE encryption.</p>
<p id="p-0052" num="0051">As shown in <figref idref="DRAWINGS">FIG. 3</figref>, the sender may obtain a copy of the PKE public key of an intended message recipient from the PKE public key directory service <b>22</b> electronically over communications network <b>14</b> at step <b>25</b>.</p>
<p id="p-0053" num="0052">The sender may compose a message for the intended recipient using any suitable technique. For example, the sender may compose a message for the intended recipient by personally typing a text message, by cutting-and-pasting from existing documents, by attaching or otherwise incorporating media files into a message, or by using any other suitable technique to create content and select which content is to be part of the message.</p>
<p id="p-0054" num="0053">Once the sender has composed a message and has obtained the PKE public key of the intended message recipient, the sender may encrypt the message using the recipient's PKE public key and using the appropriate PKE encryption algorithm at step <b>26</b>. The resulting encrypted message may only be decrypted using the PKE private key of the intended recipient, so when the sender sends the encrypted message to the recipient over network <b>14</b> at step <b>28</b>, the encrypted message is protected against interception.</p>
<p id="p-0055" num="0054">At step <b>30</b>, after the recipient has received the encrypted message, the recipient may use the appropriate PKE decryption algorithm and the recipient's PKE private key to decrypt the encrypted message and thereby access the contents of the message. If allowed by the recipient's system administrator (if any), the decryption algorithm may be implemented on the recipient's equipment <b>12</b> for the recipient to use in decrypting the encrypted message. If desired, the decryption algorithm may be implemented on a server that is able to communicate securely with the recipient (e.g., over a secure communications link such as a secure sockets layer or SSL link). With this type of configuration (discussed further in connection with <figref idref="DRAWINGS">FIGS. 6-13</figref>), the server decrypts the encrypted message at step <b>30</b>. It may be desirable to perform decryption on a server that is separate from the recipient's equipment, particularly in system environments in which the recipient is not permitted to install third-party software on their equipment.</p>
<p id="p-0056" num="0055">System components that may be used to support IBE-based secure messaging are shown in <figref idref="DRAWINGS">FIG. 4</figref>. A server or other computing equipment at an IBE private key generator <b>32</b> may be used to generate IBE private keys for users (e.g., message recipients) who wish to decrypt encrypted messages that they have received. The IBE private keys may be provided to the recipients by IBE private key generator <b>32</b> electronically (e.g., using a secure communications link over network <b>14</b>).</p>
<p id="p-0057" num="0056">If desired, the key generation functions of private key generator <b>32</b> may be divided among multiple computers at one or more locations (each of which may have only part of the secret information needed to generate the private keys). For clarity, the present discussion will focus primarily on private key generator arrangements in which a private key generator <b>32</b> individually generates its own private keys for its own associated users.</p>
<p id="p-0058" num="0057">IBE encryption schemes can be implemented using a number of different cryptographic algorithms. One such scheme is based on quadratic residues (see, e.g., &#x201c;An Identity Based Encryption Scheme Based on Quadratic Residues,&#x201d; Eighth IMA International Conference on Cryptography and Coding, December 2001, Royal Agricultural College, Cirencester, UK, by Clifford Cocks). Another suitable scheme is based on elliptic curves (see, e.g., &#x201c;Identity-Based Encryption from the Weil Pairing,&#x201d; by Dan Boneh and Matthew Franklin, extended abstract in Advances in Cryptology&#x2014;Crypto 2001, Lecture Notes in Computer Science, Vol. 2139, Springer-Verlag, pp. 231-229, August 2001. See also http://eprint.iacr.org/2001/090 by Dan Boneh and Matthew Franklin). With the approach described in the work of Boneh and Franklin, IBE encryption is based on the properties of bilinear maps such as a Weil Pairing or Tate Paring. For clarity, aspects of the present invention will sometimes be described in the context of an identity-based encryption scheme such as the elliptic curve implementation described by Boneh and Franklin. This is, however, merely illustrative. Any suitable approach for IBE encryption may be used with system <b>10</b> if desired.</p>
<p id="p-0059" num="0058">Initially, when the system is set up, the IBE private key generator (e.g., IBE private key generator <b>32</b> of <figref idref="DRAWINGS">FIG. 4</figref>) obtains or generates a master secret s. For example, the private key generator may create a master secret from a number that is randomly generated at the private key generator by a processor housed inside a tamper-proof enclosure. The master secret may also be produced off-site and delivered to the private key generator <b>32</b>. The master secret (also sometimes referred to as a secret master key or a master key) is secret information that will subsequently be used by the private key generator <b>32</b> to generate private keys for recipients in the system to use in decrypting messages and to generate public parameter information for use by senders in encrypting messages.</p>
<p id="p-0060" num="0059">After the master secret s has been obtained, the private key generator may generate public parameter information. In the identity-based encryption approach of the above-mentioned work of Boneh et al., the public parameter information that is generated includes public parameters P and sP. The parameter P may first be generated by the IBE private key generator (e.g., using a random number generator). The parameter sP may then be generated by the IBE private key generator. The &#x201c;multiplication&#x201d; of s by P in the Boneh and Franklin work is accomplished using the multiplication of integers with points on elliptic curves. While multiplication (calculating sP) is straightforward, the inverse operation (determining s from knowledge of P and sP) is essentially impossible.</p>
<p id="p-0061" num="0060">The public parameter information (e.g., the parameters P and sP in an identity-based encryption process based on elliptic curves) may be numbers. In general, there is an equivalency between numbers, letters, symbols, and other such schemes for representing information. Sometimes certain information (e.g., the master secret or public parameters) will be described as being in number form and sometimes certain information (e.g., a user's identity) may be described as being at least partly in character form (e.g., in the form of an email address). Because of the inherent equivalency between these different representational schemes, the techniques involved in converting letters or symbols into numbers or for representing multiple numbers or strings as a single number or other such operations are not described in detail herein.</p>
<p id="p-0062" num="0061">After the public parameter information (e.g., the public parameters P and sP) has been determined, the IBE private key generator <b>32</b> may publish this information. For example, this information may be made available over the communications network <b>14</b> using computing equipment (e.g., a server) at private key generator <b>32</b>. The public parameter information may be sent to users via email. If desired, the public parameter information may be provided to users on demand (e.g., by downloading from a server, in the form of a message, or using other suitable arrangements). Public parameter information (e.g., the public parameters P and sP) may be distributed as part of a downloadable or preinstalled software module or package. For example, the public parameter information may be incorporated into an email application, web browser, or other communications or Internet application that is distributed with personal computers or other user equipment <b>12</b> or that is downloaded (e.g., in the form of a plug-in or stand-alone package) at a later time.</p>
<p id="p-0063" num="0062">If the public parameter information includes more than one parameter, the parameters may be distributed together or separately. For example, parameters P and sP may be distributed together or separately. If parameters P and sP are distributed separately, each parameter may be distributed using a different distribution mechanism. For example, P may be built into user software and sP may be distributed over the Internet. Moreover, P and sP may be combined to form the equivalent of a single number or parameter or may be subdivided (e.g., to form three or more public parameter sub-parts). If desired, public parameter information (e.g., public parameters P and sP) may be distributed manually (e.g., by printed mail or by distributing a diskette or other computer-readable media to the user).</p>
<p id="p-0064" num="0063">There may be multiple private key generators <b>32</b> in system <b>10</b>. Moreover, private key generators may generate multiple versions of the public parameter information (e.g., based on different P values&#x2014;P<sub>VERSION-1</sub>, P<sub>VERSION-2</sub>, etc.). The public parameter information for each private key generator and for each version may be distributed using any of the above-mentioned distribution techniques or a combination of such techniques. These distribution methods are merely illustrative. Any suitable technique may be used to publish the public parameter information if desired.</p>
<p id="p-0065" num="0064">Once the public parameter information (e.g., public parameters P and sP) has been provided to a user (i.e., a sender) who desires to send an encrypted message to another user (i.e., a recipient), the sender may encrypt and send the message to the recipient. An IBE encryption engine on the sender's equipment may be used to encrypt the message. The IBE encryption engine may use the public parameter information (e.g., P and sP) and the IBE public key associated with the recipient to perform message encryption. When the recipient receives the IBE-encrypted message, or earlier, when the recipient sets up or updates the equipment at the recipient's location, the recipient obtains the recipient's IBE private key from the IBE private key generator to use in decrypting the message.</p>
<p id="p-0066" num="0065">Identity-based encryption (IBE) is so named because the encryption process at the sender uses an IBE public key Q based on the recipient's identity. The identity of a user in an IBE encryption scheme may be represented by any suitable string, number, or symbol. For example, the identity of a message recipient may be represented by that recipient's email address, name, or social security number. An advantage of IBE schemes is that a sender can generally determine the identity (e.g., the email address) of an intended recipient without all of the complexities involved in obtaining the PKE-public key of the intended recipient as would be required with traditional public-key cryptographic schemes such as the RSA cryptographic scheme. For example, the IBE public keys may be the same as (or based on) user email addresses, which are readily obtainable.</p>
<p id="p-0067" num="0066">The IBE private key generator <b>32</b> may generate IBE private keys for each of the multiple users associated with that IBE private key generator based on the IBE public keys (the Q's) of each of these users (i.e., based on the users' identities).</p>
<p id="p-0068" num="0067">The form of IBE public key Q that is used for a given IBE system depends on the security features that are desired. For example, user privileges may be made to automatically expire by automatically concatenating a validity period (e.g., a date or date range such as the current day of the year and year, the current month, starting and ending dates such as Jan. 2, 2003-Jan. 10, 2003, or any other suitable time-related date-stamp information) with each user's email address to form Q values based not only on the users' identities (i.e., email addresses) but also validity period information.</p>
<p id="p-0069" num="0068">As another example, users' privileges may be restricted based on security clearance level, by concatenating or otherwise adding security clearance level information to each user's email address when forming the public keys Q (i.e., Q=joe@navy.com|top_secret, etc.). These approaches are merely illustrative of the ways in which additional criteria may be added to a user identity such as a user email address when forming the IBE public key for each user (e.g., the Q for each user). Any suitable approach for forming the IBE public keys may be used if desired.</p>
<p id="p-0070" num="0069">A sender desiring to send an IBE-encrypted message to a given recipient generally must know the recipient's identity (e.g., the recipient's email address) and, if applicable, must know how to construct the user's IBE public key Q from the additional public key information (e.g., validity period, security level, etc.) The sender must also obtain the public parameter information (e.g., P and sP). Prior to message transmission, the sender may use the IBE encryption process (e.g., the process of the work of Boneh and Franklin described above) to encrypt the message contents for the recipient. The IBE process may be implemented using software at the sender's equipment (e.g., an IBE encryption engine). The IBE encryption engine may take as inputs (1) the message to be encrypted, (2) IBE public parameter information (e.g., P and sP), and (3) the IBE public key Q that is based on the identity of the given recipient to which the message is to be sent. The IBE process implemented using the IBE encryption engine produces an encrypted version of the message as its output.</p>
<p id="p-0071" num="0070">After the sender transmits the IBE-encrypted message to the recipient over communications network <b>14</b>, the recipient may receive and decrypt the received message using an appropriate IBE private key. The IBE private key that is used for decrypting the message is related to the identity-based-encryption public key Q and public parameter information (e.g., P and sP) used when encrypting the message. Only the IBE private key that matches the IBE public key used to encrypt the message may be used to decrypt the message. Generation of the IBE private key requires knowledge of the master secret s, so only the private key generator <b>32</b> can generate the recipient's IBE private key based on the recipient's IBE public key Q.</p>
<p id="p-0072" num="0071">With one suitable approach, the IBE private key for the recipient may be generated from the recipient's identity Q and the master secret s by using an appropriate mathematical function (e.g., the multiplication of integers with points on elliptic curves) to calculate the value of sQ. The recipient's identity may be verified using authentication information (credentials) from the recipient before the IBE private key is issued to the recipient. Any suitable manual or automatic authentication technique (e.g., an authentication technique of the type described in connection with <figref idref="DRAWINGS">FIG. 1</figref>) may be used by the IBE private key generator <b>32</b> to verify that the recipient is authorized to receive the IBE private key prior to issuing the key to the recipient.</p>
<p id="p-0073" num="0072">Regardless of how the IBE private key generator <b>32</b> authenticates the identity of the recipient and generates the recipient's private key, with the basic IBE approach being described in connection with <figref idref="DRAWINGS">FIGS. 4 and 5</figref> the private key should be provided to the recipient for use in decrypting the message. Any suitable technique may be used to provide the IBE private key to the recipient. For example, the private key may be transmitted to the recipient in an email or other suitable message, may be made available for downloading over the Internet (as part of a stand-alone downloadable application or a downloadable plug-in module, as a stand-alone key, etc.). A secure communications channel may be used for electronic communications between the IBE private key generator <b>16</b> and the recipient's equipment <b>12</b>. If desired, the IBE private key may be preinstalled on the recipient's equipment, so that the private key will be available for the recipient when the recipient first uses the equipment. The private key may also be distributed by mail or courier (e.g., on a computer-readable medium such as a computer disk or memory chip).</p>
<p id="p-0074" num="0073">The recipient may, if desired, store the private key locally (e.g., in a database on a storage device such as a memory circuit or hard drive on the recipient's equipment). If the private key is stored locally, the recipient can retrieve it the next time a message needs to be decrypted without needing to contact the IBE private key generator <b>32</b> to obtain a new copy of the IBE private key over the communications network.</p>
<p id="p-0075" num="0074">Illustrative steps involved in using an IBE encryption scheme to convey secure messages from a sender to a recipient using the system configuration of <figref idref="DRAWINGS">FIG. 4</figref> are shown in <figref idref="DRAWINGS">FIG. 5</figref>. At step <b>34</b>, the sender obtains the IBE public key of the intended recipient (e.g., by determining the recipient's email address).</p>
<p id="p-0076" num="0075">Once the sender has composed the message to be encrypted, the sender uses the IBE encryption algorithm (implemented using an IBE encryption engine running on the sender's equipment) to encrypt the message (step <b>36</b>). The IBE encryption engine encrypts the unencrypted version of the message using the identity of the intended recipient (i.e., the intended recipient's IBE public key Q) and the IBE public parameter information (e.g., P and sP).</p>
<p id="p-0077" num="0076">At step <b>38</b>, the sender sends the IBE-encrypted version of the message to the recipient (e.g., by transmitting the encrypted message over network <b>14</b>).</p>
<p id="p-0078" num="0077">At step <b>40</b>, the recipient obtains the recipient's IBE private key. For example, the recipient may obtain the recipient's IBE public key from IBE private key generator <b>32</b> electronically over network <b>14</b>. Step <b>40</b> may be performed during a set-up process (which could take place at any suitable time) or may be performed after the recipient receives the encrypted message and is informed of the need to obtain the IBE private key.</p>
<p id="p-0079" num="0078">At step <b>42</b>, the recipient uses the IBE decryption algorithm (implemented using an IBE decryption engine running on the sender's equipment) to decrypt the encrypted message and to thereby provide the recipient with access to the unencrypted contents of the message. The IBE decryption engine decrypts the encrypted message using the IBE private key of the recipient.</p>
<p id="p-0080" num="0079">The basic PKE and IBE encryption schemes described in connection with <figref idref="DRAWINGS">FIGS. 2-5</figref> are suitable in system environments in which recipients are able to locally run their own decryption software. A message recipient having the appropriate PKE or IBE private key and the appropriate PKE or IBE decryption engine may decrypt incoming messages that the sender encrypted using a corresponding PKE or IBE public key and a PKE or IBE encryption engine.</p>
<p id="p-0081" num="0080">Recipients may not always have the appropriate decryption engine installed on their equipment, at least initially. If desired, recipients may be provided with an opportunity to download an appropriate decryption engine plug-in from a remote server. Sometimes, however, recipients may be reluctant to download and install new software on their equipment or may be restricted from doing so by rules imposed by their system administrator. For example, the network administrator in an organization may have rules preventing the unauthorized installation of software on user terminals. Even though a recipient may be able to obtain permission to install cryptographic software, the process of obtaining this permission may take time or be burdensome.</p>
<p id="p-0082" num="0081">To allow recipients to receive encrypted messages even when it is not desired or not possible to load the decryption engine on their user equipment <b>12</b>, system <b>10</b> may have servers that are able to implement a suitable PKE or IBE decryption engine. When configured in this way, the servers can obtain the necessary PKE or IBE private keys of the recipients to use during message decryption. The resulting decrypted message contents may be provided to the recipients over secure communications links such as secure communications links using the secure sockets layer (SSL) protocol.</p>
<p id="p-0083" num="0082">An illustrative arrangement in which system <b>10</b> has a server <b>18</b> that performs message decryption functions is shown in <figref idref="DRAWINGS">FIG. 6</figref>. The components of system <b>10</b> that are shown in <figref idref="DRAWINGS">FIG. 6</figref> are interconnected by communications paths <b>44</b>. Paths <b>44</b> may be any suitable paths through network <b>14</b> (<figref idref="DRAWINGS">FIG. 1</figref>). Although shown separately in <figref idref="DRAWINGS">FIG. 6</figref>, server <b>18</b> may also be considered to be part of network <b>14</b> (as shown in <figref idref="DRAWINGS">FIG. 1</figref>) and its functions may be implemented using one or more computers at one or more locations. Server <b>18</b> may be associated with a third-party service or the recipient's organization.</p>
<p id="p-0084" num="0083">Server <b>18</b> may be used to implement a decryption engine <b>54</b> for decrypting encrypted messages. The server <b>18</b> may interact with entities or equipment such as PKE private key escrow service <b>46</b> and IBE private key generator <b>48</b> to obtain the appropriate PKE and IBE private keys needed to decrypt messages for various message recipients. Server <b>18</b> may then provide the recipient with access to the decrypted content of the messages over a secure communications link (e.g., over a suitable path <b>44</b> in network <b>14</b>).</p>
<p id="p-0085" num="0084">System configurations in which system <b>10</b> supports both PKE and IBE encryption will be described for generality. This type of system arrangement is, however, merely illustrative. System <b>10</b> may support any suitable encryption schemes. For example, secure messaging may be supported using only PKE-based encryption, using only IBE-based encryption, using both PKE and IBE encryption, etc.</p>
<p id="p-0086" num="0085">As shown in <figref idref="DRAWINGS">FIG. 6</figref>, an encryption engine <b>50</b> is implemented on the sender's equipment <b>12</b>. The encryption engine <b>50</b> is used by the sender to encrypt messages prior to transmission to a desired recipient or recipients over the network <b>14</b> (e.g., paths <b>44</b> in <figref idref="DRAWINGS">FIG. 6</figref>). The encryption software <b>50</b> on the sender's equipment may be preinstalled on the sender's equipment, may be installed from a disk, or may be downloaded onto the sender's equipment from a remote server. The encryption engine software <b>50</b> may include a PKE encryption engine such as an RSA encryption engine and/or an IBE encryption engine such as an IBE encryption engine using an IBE scheme of the type described in the work of Boneh and Franklin.</p>
<p id="p-0087" num="0086">Decryption engine <b>54</b> on server <b>18</b> may be preinstalled on the server <b>18</b>, may be installed on the server <b>18</b> from a disk, or may be downloaded onto the server <b>18</b> from a remote server. The decryption engine software <b>54</b> may include a PKE decryption engine such as an RSA decryption engine and/or an IBE decryption engine such as an IBE decryption engine using an IBE scheme of the type described in the work of Boneh and Franklin or any other suitable IBE scheme. When the sender encrypts messages using PKE, the server <b>18</b> can decrypt those messages using PKE. When the sender encrypts messages using IBE, the server <b>18</b> can decrypt those messages using IBE.</p>
<p id="p-0088" num="0087">Server <b>18</b> may have databases <b>52</b> for supporting secure messaging functions. For example, an encrypted message database may be used to store encrypted messages before (or after) they have been decrypted and a decrypted message database may be used to store messages after they have been decrypted. The encrypted message database may be used to retain messages until the intended recipient of the message can be contacted to determine whether access to the message is desired. The decrypted message database may be used to store decrypted versions of messages before and after they have been provided to the recipient. If desired, a database such as the decrypted message database may be used to support mailbox functions (e.g., to provide a recipient with an electronic &#x201c;in-box&#x201d; and other mailbox lists of messages). Databases <b>52</b> may be operated across multiple computers or servers at multiple locations if desired.</p>
<p id="p-0089" num="0088">When PKE encryption is used to encrypt a message for a given recipient, the server <b>18</b> may obtain an appropriate PKE-private key for that recipient from PKE private key escrow service <b>46</b> (or from the recipient, a PKE private key generator, or other suitable source). Recipients who desire to decrypt messages, but who know that they cannot or do not want to install message decryption engine software on their user equipment <b>12</b>, can provide their PKE private keys to PKE private key escrow service <b>46</b> for later retrieval by authorized parties such as server <b>18</b>.</p>
<p id="p-0090" num="0089">When IBE encryption is used to encrypt a message for a given recipient, the server <b>18</b> may obtain the given recipient's IBE private key from IBE private key generator <b>48</b> (or from the recipient or other suitable source).</p>
<p id="p-0091" num="0090">Illustrative steps involved in sending secure messages from a sender to one or more recipients in system <b>10</b> are shown in <figref idref="DRAWINGS">FIGS. 7</figref><i>a </i>and <b>7</b><i>b</i>. At step <b>56</b> of <figref idref="DRAWINGS">FIG. 7</figref><i>a</i>, a sender at user equipment <b>12</b> (<figref idref="DRAWINGS">FIG. 6</figref>) may compose a message (e.g., a text message, a message containing audio or video content, a message containing executable code, etc.). The sender may compose the message by typing a text message, by cutting-and-pasting from existing documents, by attaching or otherwise incorporating media files into a message, or by using any other suitable technique to create content and select which content is to be part of the message.</p>
<p id="p-0092" num="0091">At step <b>58</b>, the sender may obtain the public key of a given recipient. For example, the sender may obtain the recipient's PKE public key from a PKE directory on which the recipient had previously published the PKE public key. If the sender desires to send an IBE-encrypted message, the sender can generate the IBE public key of the recipient from known rules and from the recipient's known identity. For example, the IBE public key of the recipient may be the recipient's email address or the recipient's email address concatenated with the current date, etc. If desired, the sender may obtain the PKE or IBE public key of the given recipient directly from the recipient (e.g., in an email) or from another suitable source. After the sender has obtained the PKE or IBE public key of the recipient, the sender may use encryption engine <b>50</b> (<figref idref="DRAWINGS">FIG. 6</figref>) to encrypt the message using PKE encryption or IBE encryption as appropriate.</p>
<p id="p-0093" num="0092">The sender may send the encrypted message to the recipient at step <b>60</b>. If, for example, the encrypted message is an email message, the sender may send the encrypted email message by sending it to the known email address of the recipient.</p>
<p id="p-0094" num="0093">During transmission of the encrypted message, the message may be routed through one or more servers (e.g., one or more servers in the Internet and one or more servers in the user's organization). At step <b>62</b>, the message that is destined for the recipient is delivered to server <b>18</b> of <figref idref="DRAWINGS">FIG. 6</figref> on its way to the recipient. Server <b>18</b> of <figref idref="DRAWINGS">FIG. 6</figref> may be a server within the user's organization (e.g., a Microsoft Exchange server on the user's LAN) or a third-party server. Because the recipient (in this example) is not assumed to have appropriate decryption engine software installed on the recipient's user equipment <b>12</b>, the server <b>18</b> may retain the encrypted message rather than immediately passing the encrypted message to the recipient as would be the case for a regular (unencrypted) message delivery. The server <b>18</b> can detect that the message is encrypted by examining the characteristics of the message payload or by checking for a code (e.g., in a particular field in the message) that indicates to the server that the message is encrypted (and that may also identify the type of encryption used).</p>
<p id="p-0095" num="0094">At step <b>64</b>, the server <b>18</b> (which has just received the encrypted message) notifies the recipient of the encrypted message. For example, the server <b>18</b> may notify the recipient that the server <b>18</b> has received an encrypted message addressed to the recipient message and that the encrypted message has been stored in an encrypted message database <b>52</b> operated by the server <b>18</b>. One suitable way in which the server may notify the recipient of the message is to send a notification message (e.g., a notification email message) to the recipient.</p>
<p id="p-0096" num="0095">The notification message may contain informative text such as &#x201c;you have an encrypted message to be viewed.&#x201d; The notification may include information that allows the recipient to initiate the process of securely retrieving the decrypted contents of the message. For example, the notification may include information on a web site (e.g., a web site on the server) that the recipient should visit to obtain the decrypted version of the email or the notification may contain an interactive message prompt (a selectable option) that the user may select to automatically initiate the retrieval process. With one suitable approach, the server may include a URL or other clickable link in the notification email that serves as an interactive message prompt that the recipient can click on to initiate message access. The URL can have associated text that informs the recipient on how to proceed (e.g., &#x201c;click here to view the message&#x201d;).</p>
<p id="p-0097" num="0096">After the server sends the notification message at step <b>64</b> of <figref idref="DRAWINGS">FIG. 7</figref><i>a</i>, the recipient may respond to the notification message from the server <b>18</b> at step <b>66</b> of <figref idref="DRAWINGS">FIG. 7</figref><i>b</i>. For example, the recipient may click on a link in a notification email. The server <b>18</b> monitors the recipient's response (e.g., by awaiting the recipient's request for the web page associated with the clickable link).</p>
<p id="p-0098" num="0097">When the recipient responds to the notification (i.e., by clicking on the link to initiate message retrieval), the server <b>18</b> and recipient's equipment <b>12</b> may establish a secure communications link (e.g., an SSL link or TLS link) between the server <b>18</b> and the recipient's equipment and may authenticate the recipient at step <b>68</b>. If desired, some of the communications between the server and the recipient can be provided over an unsecure link (e.g., the notification message of step <b>64</b>, welcoming web pages or other non-sensitive information provided during the authentication process, and other information can be provided over an unsecure link). During sensitive portions of the recipient authentication process and during the delivery of decrypted message content, the link between server <b>18</b> and the recipient is preferably secure (e.g., the SSL or TLS protocols are being used to support secure communications).</p>
<p id="p-0099" num="0098">During the authentication process of step <b>68</b>, the server <b>18</b> may gather authentication information from the recipient (e.g., the recipient's credentials). The server <b>18</b> may use the information that is gathered from the recipient to demonstrate to the PKE private key escrow service <b>46</b> and the IBE private key generator <b>48</b> that the server <b>18</b> is authorized to obtain a copy of the recipient's private key on the recipient's behalf. The server <b>18</b> may use the raw recipient credential information obtained from the recipient or may use recipient credential information based on this raw information in obtaining the private key. Once the server <b>18</b> has the private key, the server <b>18</b> can decrypt the message and provide access to the decrypted message contents to the recipient. If desired, messages may be provided to the recipient in the form of electronic mail &#x201c;mailboxes,&#x201d; which are groups of messages maintained by server <b>18</b>. The server <b>18</b> may use the recipient's credentials that were gathered from the recipient to determine whether or not to allow a recipient to access a particular mailbox (e.g., to verify the recipient's identity).</p>
<p id="p-0100" num="0099">Any of the manual and electronic authentication techniques described in connection with <figref idref="DRAWINGS">FIG. 1</figref> may be used when the server <b>18</b> authenticates the recipient (e.g., during step <b>68</b>). With one suitable authentication approach, the server <b>18</b> may present the recipient with one or more interactive web pages over an Internet link. The recipient can access and interact with these web pages using a web browser implemented on the recipient's equipment. During the presentation of at least some of these web pages, the web link between the recipient's web browser may be a secure link (e.g., an https://link). This allows the recipient to securely provide the server with recipient credentials such as username and password information or other recipient credentials that serve to establish the recipient's identity.</p>
<p id="p-0101" num="0100">Any suitable recipient credential information may be gathered during the user authentication processes of system <b>10</b>. The recipient credentials that are gathered from the recipient by the server may include a user ID, a password, a personal identification number (PIN), a cryptographic key, a certificate, biometric information (e.g., fingerprint information, retinal scan information, handprint information, voice print information, etc.), a ticket such as a Kerberos ticket, an access ticket, an authentication ticket, hardware-token-generated information, information provided by a &#x201c;single sign-on&#x201d; solution, combinations of such credentials, or recipient credential information based on or derived from such credentials.</p>
<p id="p-0102" num="0101">The recipient credentials may include information such as ticket information that is gathered in part through the use of third-party servers that interact with the user and server <b>18</b> during the authentication process. As an example, the recipient may supply a password to a server that generates a ticket that is then used as that recipient's credentials by server <b>18</b>.</p>
<p id="p-0103" num="0102">The recipient credentials include recipient identity information sufficient to specify which private key is desired when server <b>18</b> requests a recipient's private key. Recipient credentials may also include authentication information such as passwords, tickets, etc. to help establish permission to access the private key. If desired, the server's permission to access the private key of a recipient may be inferred from context. For example, if the server <b>18</b> and private key generator <b>48</b> or key escrow service <b>46</b> trust each other already, any requests that the server <b>18</b> makes to the private key generator <b>48</b> or key escrow service <b>46</b> will be accepted based on this pre-established relationship.</p>
<p id="p-0104" num="0103">Recipient credentials can be obtained from a recipient over a secure link that is later used to deliver content to the recipient or separate secure links or secure transfer mechanisms may be used for these operations. If desired, security between the recipient and the server <b>18</b> may be provided during the process of gathering the recipient's credentials by sending recipient credential information to the server <b>18</b> in a form that is only understood by the server. Recipient credentials may also be encrypted and the encrypted version of the credentials sent to the server <b>18</b>. Combinations of such approaches may be used to ensure security for the recipient credentials. These are merely illustrative techniques that may be used to gather recipient credential information. Any suitable arrangement for obtaining recipient credential information may be used if desired.</p>
<p id="p-0105" num="0104">If the server <b>18</b> received a message at step <b>62</b> that was encrypted using PKE encryption, at step <b>70</b> the server may present the recipient's credentials to the PKE private key escrow service <b>46</b> (<figref idref="DRAWINGS">FIG. 6</figref>) with a request that the PKE private key escrow service <b>46</b> provide that recipient's PKE private key to the server <b>18</b>. (The PKE private key escrow service <b>46</b> may have previously obtained the PKE private keys of users directly from the users, through a user's organization, from a PKE private key generator within escrow service <b>46</b>, or from any other suitable source).</p>
<p id="p-0106" num="0105">The PKE private key escrow service <b>46</b> may examine the recipient's credentials to determine whether they match the credentials associated with one of the PKE private keys maintained by the PKE private key escrow service. If a valid match is located, the PKE private key escrow service <b>46</b> may release the appropriate recipient's requested PKE private key to the server <b>18</b> at step <b>72</b> (e.g., the recipient's PKE private key may be returned to the server <b>18</b> over a communications path <b>44</b>).</p>
<p id="p-0107" num="0106">If the server <b>18</b> received a message at step <b>62</b> that was encrypted using IBE encryption, the server <b>18</b> may present the recipient's credentials to the IBE private key generator <b>48</b> (<figref idref="DRAWINGS">FIG. 6</figref>) at step <b>78</b> with a request that the IBE private key generator <b>48</b> provide the recipient's IBE private key to the server <b>18</b>. The IBE private key generator <b>48</b> can generate IBE private keys in real time based on recipient identity information such as the recipient's email address or the IBE private key generator <b>48</b> can retrieve previously-generated IBE keys from a database.</p>
<p id="p-0108" num="0107">The IBE private key generator <b>48</b> may examine the recipient's credentials provided by the server <b>18</b> to determine whether that recipient is authorized to receive the IBE private key. If the IBE private key generator <b>48</b> determines that the recipient is authorized, the IBE private key generator <b>48</b> may provide that recipient's IBE private key to the server <b>18</b> at step <b>80</b>.</p>
<p id="p-0109" num="0108">After the server <b>18</b> has received the recipient's PKE private key at step <b>72</b> or has received the recipient's IBE private key at step <b>80</b>, at step <b>74</b> the server may use the PKE or IBE private key to decrypt the encrypted message that was received from the sender at step <b>62</b>. The decryption engine <b>54</b> that is implemented on the server <b>18</b> may be used during the decryption process. The server <b>18</b> may retain a copy of the decrypted version of the message in a database <b>52</b> (e.g., a decrypted message database).</p>
<p id="p-0110" num="0109">At step <b>76</b>, the server <b>18</b> may provide the recipient with access to the content of the decrypted message. For example, the decrypted message content may be provided to the recipient by the server <b>18</b> over a secure communications link (e.g., an SSL or TSL link that was established at step <b>68</b>). With one suitable approach, the server <b>18</b> may present the message to the recipient over the secure link in the form of a web page. An illustrative web page <b>79</b> in which a decrypted message <b>81</b> is presented to a recipient by server <b>18</b> over a secure communications link is shown in <figref idref="DRAWINGS">FIG. 8</figref>. In the example of <figref idref="DRAWINGS">FIG. 8</figref>, the recipient may view the message content using a web browser interface.</p>
<p id="p-0111" num="0110">As another example, the server <b>18</b> may provide the recipient with access to decrypted messages using a &#x201c;mailbox&#x201d; interface. With this approach, which is illustrated in the example of <figref idref="DRAWINGS">FIG. 9</figref>, the server <b>18</b> may display one or more lists of available messages for the recipient such as a list of in-box messages <b>82</b>. The list <b>82</b> of available messages that the recipient may access may include the most recently decrypted message (e.g., message <b>84</b> in this example).</p>
<p id="p-0112" num="0111">The recipient may view the content of the listed decrypted messages using any suitable approach. For example, the recipient may click on a listed message to direct the server to retrieve that message and display its contents on a web page. The web page may be delivered to the recipient's web browser over the secure communications link between the server <b>18</b> and the recipient.</p>
<p id="p-0113" num="0112">If a secure communications link does not exist when it is time for the server <b>18</b> to provide the recipient with access to the message (e.g., if the secure connection between the server and recipient that was established when the recipient's credentials were being gathered is not active), the server <b>18</b> and the recipient's equipment may establish such a secure link to use in providing secure message access. An advantage of using protocols such as the SSL protocol to support secure communications between the server and the recipient is that the software used to support this type of protocol is already included in standard web browsers. Accordingly, the secure links between the sever and the recipient may be established without requiring the recipient to install new software. These are merely illustrative arrangements for server <b>18</b> to use to provide the recipient with access to the decrypted message over a secure communications link. Any suitable arrangement that allows the recipient to access the decrypted content of the message may be used if desired.</p>
<p id="p-0114" num="0113">If desired, the recipient can forward encrypted messages to server <b>18</b> for decryption. Illustrative steps involved with one such &#x201c;forwarding&#x201d; approach are shown in <figref idref="DRAWINGS">FIGS. 10</figref><i>a </i>and <b>10</b><i>b. </i></p>
<p id="p-0115" num="0114">At step <b>86</b>, the sender may compose a message (e.g., a message containing text, audio, video, code, etc.).</p>
<p id="p-0116" num="0115">At step <b>88</b>, the sender may obtain the PKE or IBE public key of an intended recipient. For example, the sender may obtain the PKE public key of the recipient from a PKE public key director or from the recipient or other source. The sender may obtain the IBE public key of the recipient by generating it based on known rules (e.g., the IBE public key may be the email address of the recipient concatenated with the current date) or by obtaining it from the recipient or other suitable source. After the PKE or IBE public key of the recipient has been obtained, the sender may use encryption engine <b>50</b> (<figref idref="DRAWINGS">FIG. 6</figref>) and the public key to encrypt the message.</p>
<p id="p-0117" num="0116">The sender may send the encrypted message to the recipient's email address at step <b>90</b>. In this example and the other examples described herein, the sender may send a message to multiple recipient's in parallel if desired. Single-recipient scenarios are discussed to clarify the discussion.</p>
<p id="p-0118" num="0117">Server <b>18</b> (which may be, for example, a third party server in the communications path between the sender's equipment <b>12</b> and the receiver's equipment <b>12</b> or which may be a server associated with the recipient's organization such as the recipient's mail server) may receive (intercept) the encrypted message on its way to the recipient. The server <b>18</b> knows (or may assume) that the recipient in this example does not have the appropriate decryption software installed on the recipient's equipment. The server <b>18</b> may therefore instruct the recipient to forward the encrypted message to an appropriate entity (e.g., the same server <b>18</b> or another suitable decryption server) for decryption. Any suitable technique may be used to notify the recipient of the appropriate server to which the encrypted message should be forwarded.</p>
<p id="p-0119" num="0118">As one example, server <b>18</b> may, upon receipt of the encrypted message at step <b>92</b>, create a new message (or modify the existing message) to produce a corresponding notification message that contains the contents of the original encrypted message and suitable forwarding notification information. The forwarding notification information directs the recipient to forward the message (i.e., the notification message with its encrypted contents) to an appropriate server (e.g., server <b>18</b>). The message may be forwarded by using the forward or reply feature in the recipient's email program or other messaging software. An example of suitable forwarding notification information that server <b>18</b> may include in the notification message is text such as &#x201c;to view, forward this message to decrypt@xyzcorp.com&#x201d; where decrypt@xyzcorp.com is the message address of the server to be used to decrypt the message.</p>
<p id="p-0120" num="0119">If the recipient desires to view the encrypted contents of the notification message, the recipient forwards the message to the server at step <b>94</b>, which receives the forwarded message. The recipient may forward the message back to the same server <b>18</b> that produced the notification message or to a different decryption server such as a third party server or a server in the recipient's organization. For clarity, the present discussion will focus on the scenario where the recipient forwards the message back to the same server <b>18</b>. The received message may be stored in a database <b>54</b> such as an encrypted message database.</p>
<p id="p-0121" num="0120">After the server receives the forwarded message at step <b>94</b> of <figref idref="DRAWINGS">FIG. 10</figref><i>a</i>, the server may send an interactive message to the recipient at step <b>96</b> of <figref idref="DRAWINGS">FIG. 10</figref><i>b</i>. The interactive message may contain an interactive message prompt to which the recipient may respond to initiate the message access process. An example of a suitable interactive message prompt that may be provided in the interactive message is a clickable URL or other link stating &#x201c;click here to access message: https://decrypt.intranet.xyzcorp.com.&#x201d;</p>
<p id="p-0122" num="0121">If the recipient is interested in obtaining access to the decrypted contents of the message, the recipient may respond to the interactive message prompt at step <b>98</b>. The recipient may, for example, click on the URL or other link in the interactive message.</p>
<p id="p-0123" num="0122">If the recipient responds to the interactive message prompt, the server may establish a secure communications link between the server and the recipient and may gather the recipient's credentials over the secure link at step <b>100</b>.</p>
<p id="p-0124" num="0123">At step <b>102</b>, the server may provide the recipient's credentials to the PKE private key escrow service <b>46</b> (<figref idref="DRAWINGS">FIG. 6</figref>) or the IBE private key generator <b>48</b> (<figref idref="DRAWINGS">FIG. 6</figref>) with a request for the recipient's private key to attempt to obtain a copy of the recipient's PKE or IBE private key. If the message from the sender was encrypted using PKE techniques, the server will endeavor to obtain the recipient's PKE private key. If the message from the sender was encrypted using IBE techniques, the server will attempt to obtain the recipient's IBE private key. If the recipient's credentials indicate that the server is authorized to obtain a copy of the appropriate private key, the private key may be provided to the server for use in decrypting the encrypted message.</p>
<p id="p-0125" num="0124">At step <b>104</b>, the server may use the PKE private key of the recipient or the IBE private key of the recipient that was obtained at step <b>102</b> to decrypt the encrypted message. During the decryption process, the server uses the decryption engine <b>54</b> to perform the decryption processes of the appropriate decryption algorithm (i.e., PKE or IBE, depending on which encryption process was used). The decrypted message may be stored in a message database <b>52</b> such as a decrypted message database.</p>
<p id="p-0126" num="0125">At step <b>106</b>, the server may provide the decrypted message from the decryption engine to the recipient. The server may provide the recipient with access to the decrypted content by transferring the decrypted content to the recipient over a secure web link (e.g., using a web browser arrangement of the type shown in <figref idref="DRAWINGS">FIG. 8</figref>). If desired, the recipient may be provided with access to the decrypted message content via a message mailbox format (e.g., using a secure communications link with an approach of the type described in connection with <figref idref="DRAWINGS">FIG. 9</figref>). These are merely illustrative arrangements through which secure access to the decrypted message contents may be provided to the recipient by the server. Any suitable secure message access technique may be provided if desired.</p>
<p id="p-0127" num="0126">With the &#x201c;forwarding&#x201d; approach described in connection with <figref idref="DRAWINGS">FIGS. 10</figref><i>a </i>and <b>10</b><i>b</i>, a notification message and an interactive message are generated. The notification message is generated when the server receives the encrypted message. The notification message may contain forwarding notification information that instructs the recipient to forward the message to an appropriate location for decryption (e.g., the same server acting as a decryption server or a separate decryption server). The interactive message may contain an interactive message prompt and may be sent to the recipient by the decryption server to provide the recipient with an opportunity to initiate the process of retrieving the decrypted version of the message from the decryption server.</p>
<p id="p-0128" num="0127">If desired, the interactive message prompt may be included in an earlier message (e.g., the notification message), rather than being provided by the server as a later, separate message. Illustrative steps involved with this type of approach are shown in <figref idref="DRAWINGS">FIGS. 11</figref><i>a </i>and <b>11</b><i>b. </i></p>
<p id="p-0129" num="0128">At step <b>108</b>, the sender may compose the message to be sent to the recipient.</p>
<p id="p-0130" num="0129">The sender may obtain the recipient's PKE or IBE public key at step <b>110</b>. During step <b>110</b>, the sender may use an appropriate encryption engine <b>50</b> (e.g., a PKE or IBE encryption engine) and the public key to encrypt the message.</p>
<p id="p-0131" num="0130">The sender may send the encrypted message to the recipient's message address (e.g., the recipient's email address) at step <b>112</b>.</p>
<p id="p-0132" num="0131">With the approach described in connection with <figref idref="DRAWINGS">FIGS. 10</figref><i>a </i>and <b>10</b><i>b</i>, the server may intercept the message from the recipient and send a corresponding notification message to the recipient that contains forwarding notification information. If the message is forwarded to the server by the recipient, the server may send another message&#x2014;an &#x201c;interactive&#x201d; message containing an interactive message access prompt&#x2014;to the recipient to which the recipient may respond to obtain access to the decrypted message. With the approach of <figref idref="DRAWINGS">FIGS. 11</figref><i>a </i>and <b>11</b><i>b</i>, the forwarding notification information and the interactive message prompt may be provided to the recipient by the sender (e.g., in a message that also contains the encrypted message contents), by an intermediate mail server (e.g., a server located along a communications path between the sender and the recipient such as a server at the recipient's organization or location), or by a combination of the sender and one or more such servers.</p>
<p id="p-0133" num="0132">For example, at step <b>114</b>, the sender and one or more servers between the sender and the recipient may add forwarding notification information to the encrypted message such as &#x201c;to view, forward this message to decrypt@xyzcorp.com&#x201d; and may add an interactive message access prompt to the encrypted message such as &#x201c;after forwarding message, click here to access: https://decrypt.intranet.xyzcorp.com.&#x201d;</p>
<p id="p-0134" num="0133">The forwarding notification information may be added by the sender or by a downstream server. The interactive message access prompt may also be added by the server or by a downstream server. The forwarding notification information and interactive message access prompt may be &#x201c;added&#x201d; to the message by attaching or appending them to the message or by extracting the encrypted message contents from the original message and resending a &#x201c;new&#x201d; message that incorporates the contents and forwarding notification information and/or the interactive message access prompt.</p>
<p id="p-0135" num="0134">With one suitable approach, the sender may, upon creating the encrypted message, include the forwarding notification information with the encrypted message. An intermediate mail server (e.g., a server downstream from the sender such as a mail server at the recipient's location or organization or a third-party mail server) may recognize that the message is encrypted (based on a code in the message or the message's other characteristics) and may add the interactive message access prompt. With another suitable approach, the sender may include both the forwarding notification information and the interactive message access prompt with the original encrypted message. With yet another suitable approach, an intermediate (downstream) server may incorporate both the forwarding notification information and the interactive message access prompt into the encrypted message. With another suitable approach, a first downstream server may be used to add the forwarding notification information to the encrypted message and a second downstream server may be used to add the interactive message access prompt to the encrypted message. These are merely illustrative ways in which the forwarding notification information and the interactive message access prompt information may be added to or associated with the encrypted message at step <b>114</b>. Any suitable approach may be used if desired.</p>
<p id="p-0136" num="0135">Regardless of how the forwarding notification information and interactive message access prompt information are associated with the encrypted message, the encrypted message with its forwarding notification information and interactive message access prompt may be delivered (via one or more mail servers including one or more servers at the recipient's organization or location) to the recipient (step <b>116</b> of <figref idref="DRAWINGS">FIG. 11</figref><i>a</i>).</p>
<p id="p-0137" num="0136">The recipient, upon receiving the encrypted message and the forwarding notification information and interactive message access prompt contained within the encrypted message at step <b>116</b>, may decide to have the encrypted message contents decrypted. Accordingly, at step <b>116</b>, the recipient may forward the encrypted message to the server identified in the forwarding notification information (e.g., the server at decrypt@xyzcorp.com in this example) for decryption with decryption engine <b>54</b> (<figref idref="DRAWINGS">FIG. 6</figref>). The decryption server receives the forwarded message and may store it in a database <b>52</b> (<figref idref="DRAWINGS">FIG. 6</figref>) such as an encrypted message database.</p>
<p id="p-0138" num="0137">The message received by the recipient includes an interactive message prompt. After the recipient has forwarded the message to the decryption server, the recipient can, at a desired time, respond to this interactive message prompt at step <b>118</b>. For example, the recipient can open the message with the recipient's email program or other suitable application and can click on the URL or other link in the message.</p>
<p id="p-0139" num="0138">In contrast to the approach of <figref idref="DRAWINGS">FIGS. 10</figref><i>a </i>and <b>10</b><i>b</i>, with the approach of <figref idref="DRAWINGS">FIGS. 11</figref><i>a </i>and <b>11</b><i>b</i>, the server need not send a separate interactive message to the recipient to provide the recipient with the interactive message prompt, because the recipient already has access to the interactive message prompt by virtue of having received it with the original encrypted message.</p>
<p id="p-0140" num="0139">The server, having received the forwarded encrypted message from the recipient at step <b>116</b> (<figref idref="DRAWINGS">FIG. 11</figref><i>a</i>) and having received a response from the recipient at step <b>118</b> (<figref idref="DRAWINGS">FIG. 11</figref><i>a</i>), may proceed to decrypt the encrypted message, as shown in <figref idref="DRAWINGS">FIG. 11</figref><i>b. </i></p>
<p id="p-0141" num="0140">When the server <b>18</b> detects that the recipient has clicked on the interactive message access prompt, the server may establish a secure communications link with the recipient and may obtain the recipient's credentials over the secure link at step <b>120</b> (<figref idref="DRAWINGS">FIG. 11</figref><i>b</i>).</p>
<p id="p-0142" num="0141">At step <b>122</b>, the server may the use the recipient's credentials to demonstrate to the PKE private key escrow service <b>46</b> (<figref idref="DRAWINGS">FIG. 6</figref>) or the IBE private key generator <b>48</b> (<figref idref="DRAWINGS">FIG. 6</figref>), as appropriate, that the server is authorized to obtain a copy of the recipient's PKE private key or the recipients IBE private key. In a system using PKE-encrypted communications, the server obtains the recipient's PKE private key by presenting the recipient's credentials to the PKE private key escrow service <b>46</b>. In a system using IBE-encrypted communications, the server obtains the recipient's IBE private key from IBE private key generator <b>48</b>.</p>
<p id="p-0143" num="0142">At step <b>124</b>, the server may, using a PKE or IBE decryption engine <b>54</b> (<figref idref="DRAWINGS">FIG. 6</figref>) and the recipient's private key, decrypt the encrypted message. The decrypted version of the message may be stored in a database <b>52</b> (e.g., a decrypted message database).</p>
<p id="p-0144" num="0143">At step <b>126</b>, when the recipient is communicating with the server over a secure link after responding to the interactive message access prompt at step <b>118</b>, the server may provide the recipient with access to the decrypted message. The server may provide message content access using a web-based approach of the type described in connection with <figref idref="DRAWINGS">FIG. 8</figref>, using a web-based mailbox list approach of the type described in connection with <figref idref="DRAWINGS">FIG. 9</figref>, or using any other suitable approach.</p>
<p id="p-0145" num="0144">The forwarding process of the approaches described in connection with <figref idref="DRAWINGS">FIGS. 10</figref><i>a </i>and <b>10</b><i>b </i>and <figref idref="DRAWINGS">FIGS. 11</figref><i>a </i>and <b>11</b><i>b </i>is not necessary if the sender provides a copy of the encrypted message to the server. As shown in <figref idref="DRAWINGS">FIG. 12</figref>, the sender, after using encryption engine <b>50</b> to encrypt a message with PKE encryption or IBE encryption, can send an original version of the encrypted message to the recipient and can send a copy of the encrypted message to a server <b>18</b>. Server <b>18</b> can retain the message in database <b>52</b> (e.g., in an encrypted message database). When directed by the recipient, the server <b>18</b> can decrypt the message and can provide the recipient with access to the decrypted contents of the message. Because the sender provided the server with a copy of the encrypted message to the server (e.g., as a cc or bcc or equivalent when first sending the message or in a separate transmission), the recipient need not forward a copy of the encrypted message to the server.</p>
<p id="p-0146" num="0145">In the depiction of <figref idref="DRAWINGS">FIG. 12</figref>, an original version of the encrypted message is shown is traveling directly from the sender to the recipient along a network communications path <b>44</b> and a copy of the encrypted message is shown as traveling directly from the sender to the decryption server along another network communications path <b>44</b>. Although this depiction is conceptually correct, it will be appreciated that during delivery the copy and original messages may both initially be transmitted to the same server <b>18</b> (e.g., a mail server at the recipient's location). The server <b>18</b> may retain a version of the encrypted message in database <b>52</b> (&#x201c;the copy&#x201d;) and may pass another version of the encrypted message (the &#x201c;original&#x201d;) to the recipient.</p>
<p id="p-0147" num="0146">Illustrative steps involved in using the arrangement of <figref idref="DRAWINGS">FIG. 12</figref> to support secure messaging between a sender and recipient are shown in <figref idref="DRAWINGS">FIG. 13</figref>. At step <b>128</b>, the sender may compose a message for a recipient.</p>
<p id="p-0148" num="0147">At step <b>130</b>, the sender may obtain the recipient's public key (e.g., the recipient's PKE or IBE public key). Using decryption engine <b>50</b> (<figref idref="DRAWINGS">FIG. 12</figref>) and using the recipient's public key, the sender may encrypt the message for the recipient.</p>
<p id="p-0149" num="0148">At step <b>132</b>, the sender may send the encrypted message to the recipient's email address and to the email address of the decryption server (e.g., server <b>18</b> of <figref idref="DRAWINGS">FIG. 12</figref>). The encrypted messages sent to the recipient's email address and to the email address of the decryption server may be sent by the sender's email program or other messaging software at the same time (e.g., by using the cc or bcc functions of the software) or may be sent at different times. The copy of the message that is addressed to the recipient may be considered to be an &#x201c;original&#x201d; and the copy of the message that is addressed to the server may be considered to be a &#x201c;copy.&#x201d; Because the recipient need not forward the message to the server for decryption, it is not necessary to include forwarding notification information in the message.</p>
<p id="p-0150" num="0149">At step <b>134</b>, an interactive message access prompt may be added to the encrypted message or a separate interactive message may be sent to the recipient that contains an interactive message prompt. The interactive message access prompt may be a clickable link such as a URL or any other suitable selectable link or option to which the recipient may respond to initiate message access. The interactive message access prompt may be added to the encrypted message by the sender (e.g., as part of the original message) or by a downstream server such as the decryption server. If desired, a server (e.g., the decryption server) may generate and send a separate interactive message to the recipient that contains the interactive message access prompt.</p>
<p id="p-0151" num="0150">When the recipient responds to the interactive message prompt (e.g., from within the original encrypted message or from within a separate interactive message), the server may establish a secure communications link with the recipient and may obtain the recipient's credentials (step <b>136</b>). The secure communications link may be, for example, an SSL link formed using a web browser. The recipient's credentials may be, for example, a user name and password.</p>
<p id="p-0152" num="0151">At step <b>138</b>, the server may present the recipient's credentials to the PKE private key escrow service <b>46</b> of <figref idref="DRAWINGS">FIG. 12</figref> (when the encrypted message is a PKE-encrypted message) or may present the recipient's credentials to the IBE private key generator <b>48</b> of <figref idref="DRAWINGS">FIG. 12</figref> (when the encrypted message is a IBE-encrypted message). When the recipient's credentials have been authenticated, the requested PKE or IBE private key of the recipient may be returned to the server.</p>
<p id="p-0153" num="0152">At step <b>140</b>, the server may use the PKE or IBE private key of the recipient and the PKE or IBE decryption engine <b>54</b> that is implemented on the server to decrypt the encrypted message (e.g., to decrypt the copy of the encrypted message that was initially received from the sender and stored in database <b>52</b>). The resulting decrypted version of the encrypted message may be stored in database <b>52</b> (e.g., in a decrypted message database).</p>
<p id="p-0154" num="0153">The server may provide the recipient with access to the decrypted message at step <b>142</b>. Access may be provided using a web browser interface arrangement of the type shown in <figref idref="DRAWINGS">FIG. 8</figref>, a web-based mailbox interface of the type shown in <figref idref="DRAWINGS">FIG. 9</figref>, or using any other suitable access arrangement.</p>
<p id="p-0155" num="0154">The secure messaging arrangement of <figref idref="DRAWINGS">FIGS. 12 and 13</figref> makes it unnecessary for the recipient to forward messages to a server for decryption. If desired, a recipient in system <b>10</b> may install and run software on the recipient's equipment <b>12</b> that automatically forwards encrypted mail to a server <b>18</b> for decryption. Such an auto-forwarding approach may be acceptable to system administrators that are reluctant to grant extensive software installation privileges to users in their network. If an auto-forwarding arrangement is used, it is not necessary to provide recipients with forwarding notification information. It is also not necessary for the sender to directly send a copy of the encrypted message to the server, because a copy of the encrypted message is automatically provided to the server. The sender is able to send the copy of the encrypted message to the server through the use of the recipient's automatic forwarding software without the manual intervention of the recipient (e.g., without requiring the recipient to manually use an email program to forward the encrypted message to the server).</p>
<p id="p-0156" num="0155">The foregoing is merely illustrative of the principles of this invention and various modifications can be made by those skilled in the art without departing from the scope and spirit of the invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for securely conveying a message over a communications network from a sender to a recipient, wherein the recipient has an identity-based-encryption public key and an identity-based-encryption private key for use in encryption and decryption, wherein the message is encrypted using the identity-based-encryption public key of the recipient, wherein forwarding notification information is added to the encrypted message in the form of instructions for the recipient that direct the recipient to forward the encrypted message for decryption, wherein the encrypted message with the added forwarding notification is provided to the recipient, comprising:
<claim-text>at a server, creating an interactive message prompt formed from a universal resource locator in response to receiving the forwarded encrypted message;</claim-text>
<claim-text>using the server to obtain credentials from the recipient in response to the recipient clicking on the universal resource locator;</claim-text>
<claim-text>with a decryption engine on the server, using the recipient's credentials to obtain a copy of the recipient's identity-based-encryption private key; and</claim-text>
<claim-text>with the decryption engine on the server, decrypting the encrypted message using the copy of the recipient's identity-based-encryption private key to produce a decrypted version of the message, wherein the recipient is provided with access to the decrypted version of the message.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method defined in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the server is co-located with the sender, the method further comprising:
<claim-text>at the recipient, forwarding the encrypted message to the server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method defined in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the server is co-located with the sender, further comprising:
<claim-text>at the server, receiving the forwarded encrypted message from the recipient.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method defined in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the server is co-located with the sender, further comprising:
<claim-text>at the server, receiving the forwarded encrypted message from a cellular telephone at the recipient.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method defined in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein using the server to obtain credentials from the recipient in response to the recipient clicking on the universal resource locator comprises using the server to obtain credentials from the recipient over a secure communications link.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method defined in <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>using the server to provide the recipient with access to the decrypted version of the message in the form of a web page provided to the recipient by the server over a secure communications link.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method defined in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein using the server to obtain credentials from the recipient in response to the recipient clicking on the universal resource locator comprises obtaining a username and password from the recipient using the server.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method defined in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein using the recipient's credentials to obtain a copy of the recipient's identity-based-encryption private key comprises using the server to present the recipient's identity-based-encryption public key to an identity-based-encryption private key generator with a request for a copy of the recipient's identity-based-encryption private key.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method defined in <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:
<claim-text>at the server, storing the encrypted message in an encrypted message database.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method defined in <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:
<claim-text>at the server, storing the decrypted message in a decrypted message database. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
