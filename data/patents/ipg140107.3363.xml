<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08624426-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08624426</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13259396</doc-number>
<date>20090610</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<us-term-extension>294</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>B</section>
<class>60</class>
<subclass>L</subclass>
<main-group>1</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>B</section>
<class>60</class>
<subclass>L</subclass>
<main-group>3</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>02</class>
<subclass>G</subclass>
<main-group>3</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>307  91</main-classification>
<further-classification>307 85</further-classification>
<further-classification>307 87</further-classification>
<further-classification>307115</further-classification>
<further-classification>903903</further-classification>
<further-classification>361191</further-classification>
</classification-national>
<invention-title id="d2e53">Power supply system for electrically powered vehicle, electrically powered vehicle, and method for controlling power supply system of electrically powered vehicle</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6137250</doc-number>
<kind>A</kind>
<name>Hirano et al.</name>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>318376</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7933694</doc-number>
<kind>B2</kind>
<name>Kato</name>
<date>20110400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>701 22</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>8072725</doc-number>
<kind>B2</kind>
<name>Kosaki et al.</name>
<date>20111200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>361 931</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>8423210</doc-number>
<kind>B2</kind>
<name>Kato</name>
<date>20130400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>701 22</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>JP</country>
<doc-number>2004-312863</doc-number>
<kind>A</kind>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>JP</country>
<doc-number>2004-359032</doc-number>
<kind>A</kind>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>JP</country>
<doc-number>2008-109840</doc-number>
<kind>A</kind>
<date>20080500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>JP</country>
<doc-number>2008-167620</doc-number>
<kind>A</kind>
<date>20080700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>JP</country>
<doc-number>2008167620</doc-number>
<kind>A</kind>
<date>20080700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>JP</country>
<doc-number>2008-220084</doc-number>
<kind>A</kind>
<date>20080900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00011">
<othercit>International Search Report mailed Sep. 15, 2009 of PCT/JP2009/060590.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>15</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>307  91</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>307115</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>307 85- 87</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>903903</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>13</number-of-drawing-sheets>
<number-of-figures>16</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120013184</doc-number>
<kind>A1</kind>
<date>20120119</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Kato</last-name>
<first-name>Norihiko</first-name>
<address>
<city>Handa</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Kato</last-name>
<first-name>Norihiko</first-name>
<address>
<city>Handa</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Kenyon &#x26; Kenyon LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Toyota Jidosha Kabushiki Kaisha</orgname>
<role>03</role>
<address>
<city>Toyota-Shi</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Barnie</last-name>
<first-name>Rexford</first-name>
<department>2857</department>
</primary-examiner>
<assistant-examiner>
<last-name>Kessie</last-name>
<first-name>Daniel</first-name>
</assistant-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/JP2009/060590</doc-number>
<kind>00</kind>
<date>20090610</date>
</document-id>
<us-371c124-date>
<date>20110923</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO2010/143279</doc-number>
<kind>A </kind>
<date>20101216</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A power supply system includes a main power storage device and a plurality of sub power storage devices. A converter is sequentially connected to one of the sub power storage devices to convert voltage between the selected sub power storage device and an electric power feeding line bidirectionally. The sub power storage device undergoes a connection switching process, and when there is no new sub power storage device remaining for replacement, then, in accordance with that sub power storage device's SOC and the vehicle's state, a request is generated to disconnect the sub power storage device. Here, when a condition regarding a temperature of at least one of the main power storage device and the plurality of sub power storage devices is satisfied, generation of a disconnection request is prohibited, in order to protect the main power storage device.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="176.95mm" wi="248.92mm" file="US08624426-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="255.86mm" wi="179.32mm" orientation="landscape" file="US08624426-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="226.82mm" wi="129.88mm" file="US08624426-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="203.54mm" wi="171.20mm" file="US08624426-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="180.17mm" wi="100.25mm" file="US08624426-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="250.78mm" wi="134.62mm" file="US08624426-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="131.32mm" wi="106.68mm" file="US08624426-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="148.76mm" wi="109.22mm" file="US08624426-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="108.29mm" wi="93.22mm" file="US08624426-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="241.22mm" wi="187.88mm" file="US08624426-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="154.35mm" wi="142.32mm" file="US08624426-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="199.31mm" wi="156.97mm" file="US08624426-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="134.87mm" wi="98.21mm" file="US08624426-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="227.33mm" wi="151.72mm" file="US08624426-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATION</heading>
<p id="p-0002" num="0001">This is a 371 national phase application of PCT/JP2009/060590 filed Jun. 10, 2009, the content of which is incorporated herein by reference in its entirety.</p>
<heading id="h-0002" level="1">TECHNICAL FIELD</heading>
<p id="p-0003" num="0002">The present invention relates to a power supply system for an electrically powered vehicle, an electrically powered vehicle, and a method for controlling a power supply system of an electrically powered vehicle, and more particularly to control for a power supply system of an electrically powered vehicle having a main power storage device and a plurality of sub power storage devices mounted thereon.</p>
<heading id="h-0003" level="1">BACKGROUND ART</heading>
<p id="p-0004" num="0003">In recent years, as an environmentally friendly vehicle, electrically powered vehicles such as electric cars, hybrid cars and fuel cell cars have been developed into practical use. These electrically powered vehicles have mounted thereon an electric motor generating force to drive the vehicle and a power supply system for supplying electric power to drive the motor, that is configured to include a power storage device.</p>
<p id="p-0005" num="0004">In particular for hybrid cars, there has been proposed a configuration charging a vehicle-mounted power storage device by a power supply external to the vehicle (hereinafter also referred to as an &#x201c;external power supply&#x201d;), and accordingly, these electrically powered vehicles require increased distances travelable on electric power stored in the vehicle-mounted power storage device. Hereinafter, charging a vehicle-mounted power storage device by an external power supply will also simply be referred to as &#x201c;external charging&#x201d;.</p>
<p id="p-0006" num="0005">For example, Japanese Patent Laying-Open No. 2008-109840 (Patent Document 1) describes a power supply system having a plurality of power storage devices (batteries) connected in parallel. The power supply system described in Patent Document 1 is provided with a voltage converter (a converter) for each power storage device (battery) as a charging/discharging adjustment mechanism. In contrast, Japanese Patent Laying-Open No. 2008-167620 (Patent Document 2) describes a configuration of a power supply device in a vehicle having a main power storage device and a plurality of sub power storage devices mounted thereon, that provides a converter associated with the main power storage device and a converter shared by the plurality of sub power storage devices. This configuration can achieve a reduced number of elements in the device and also an increased storable amount of energy.</p>
<p id="p-0007" num="0006">In particular, the configuration described in Patent Document 2 has one of the plurality of sub power storage devices selectively connected to the converter to allow the main power storage device and the selected sub power storage device to supply electric power to drive an electric motor for driving a vehicle. In the power supply device, when the sub power storage device in use has a decreased state of charge (SOC), a different sub power storage device is connected to the converter to use the plurality of sub power storage devices sequentially to allow stored electric energy to be used to achieve increased travelable distance (EV (Electric Vehicle) travelable distance).</p>
<heading id="h-0004" level="1">CITATION LIST</heading>
<heading id="h-0005" level="1">Patent Literature</heading>
<p id="p-0008" num="0000">
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0007">PTL 1: Japanese Patent Laying-Open No. 2008-109840</li>
    <li id="ul0001-0002" num="0008">PTL 2: Japanese Patent Laying-Open No. 2008-167620</li>
</ul>
</p>
<heading id="h-0006" level="1">SUMMARY OF INVENTION</heading>
<heading id="h-0007" level="1">Technical Problem</heading>
<p id="p-0009" num="0009">In the power supply system described in Patent Document 2, when all of the sub power storage devices have completely used their stored electricity, positively, electrically disconnecting all of the sub power storage devices from the converter can be expected to allow the power supply system to be subsequently controlled with an increased degree of freedom.</p>
<p id="p-0010" num="0010">On the other hand, as electric power is input/output only to/from the main power storage device, deterioration of the main power storage device may be more likely than in an example where both of the main power storage device and the sub power storage devices can be used. In an example where only the main power storage device is used under a high temperature (or a low temperature), a situation is severe to the main power storage device and deterioration of the main power storage device is further likely.</p>
<p id="p-0011" num="0011">The present invention has been made to overcome such disadvantage and an object of the present invention is to provide a technique for achieving appropriate protection of a main power storage device in a power supply system configured to include a main power storage device and a plurality of sub power storage devices sharing a voltage converter (a converter).</p>
<heading id="h-0008" level="1">Solution to Problem</heading>
<p id="p-0012" num="0012">A power supply system for an electrically powered vehicle according to one aspect of the present invention is a power supply system of an electrically powered vehicle incorporating a motor for generating power to drive the vehicle and an inverter for driving the motor. The power supply system includes a main power storage device, an electric power feeding line for feeding electric power to the inverter, a first voltage converter, a plurality of sub power storage devices provided in parallel to each other, a first voltage converter, a second voltage converter, a connection unit, and a control device. The first voltage converter is provided between the electric power feeding line and the main power storage device and configured to convert voltage therebetween bidirectionally. The second voltage converter is provided between the plurality of sub power storage devices and the electric power feeding line, and configured to convert voltage between a sub power storage device selected from the plurality of sub power storage devices and the electric power feeding line bidirectionally. The connection unit is provided between the plurality of sub power storage devices and the second voltage converter, and configured to connect and disconnect the selected sub power storage device to and from the second voltage converter. The control device is configured to control connection and disconnection of the selected sub power storage device to and from the second voltage converter. The control device includes a disconnection determination unit and a disconnection prohibition unit. The disconnection determination unit is configured to determine whether a disconnection request for disconnecting the selected sub power storage device from the second voltage converter should be generated or not based on a state of charge of the selected sub power storage device, when there is no new sub power storage device allowed to replace the selected sub power storage device. The disconnection prohibition unit is configured to instruct the disconnection determination unit not to generate the disconnection request when a temperature condition regarding a temperature of at least one power storage device of the main power storage device and the plurality of sub power storage devices is satisfied.</p>
<p id="p-0013" num="0013">Preferably, the control device further includes an electric power limiter unit. The electric power limiter unit is configured to limit input electric power and output electric power to/from the main power storage device when a temperature of the main power storage device is out of a predetermined range. At least one power storage device includes the main power storage device. The temperature condition includes a first condition that the temperature of the main power storage device is out of the predetermined range.</p>
<p id="p-0014" num="0014">Preferably, the temperature condition is at least one condition of the first condition and a second condition regarding temperatures of the plurality of sub power storage devices. The second condition is a condition that the temperature of at least one sub power storage device of the plurality of sub power storage devices is lower than a predetermined lower limit value.</p>
<p id="p-0015" num="0015">Preferably, at least one sub power storage device is a remaining sub power storage device except for the selected sub power storage device out of the plurality of sub power storage devices.</p>
<p id="p-0016" num="0016">Preferably, the disconnection prohibition unit is configured to set at least one condition as the temperature condition when the electrically powered vehicle is started, and to set only the first condition as the temperature condition after start of the electrically powered vehicle is completed.</p>
<p id="p-0017" num="0017">An electrically powered vehicle according to another aspect of the present invention includes a motor for generating power to drive the vehicle, a main power storage device, an electric power feeding line for feeding electric power to an inverter, a first voltage converter, a plurality of sub power storage devices provided in parallel to each other, a first voltage converter, a second voltage converter, a connection unit, and a control device. The first voltage converter is provided between the electric power feeding line and the main power storage device and configured to convert voltage therebetween bidirectionally. The second voltage converter is provided between the plurality of sub power storage devices and the electric power feeding line, and configured to convert voltage between a sub power storage device selected from the plurality of sub power storage devices and the electric power feeding line bidirectionally. The connection unit is provided between the plurality of sub power storage devices and the second voltage converter, and configured to connect and disconnect the selected sub power storage device to and from the second voltage converter. The control device is configured to control connection and disconnection of the selected sub power storage device to and from the second voltage converter. The control device includes a disconnection determination unit and a disconnection prohibition unit. The disconnection determination unit is configured to determine whether a disconnection request for disconnecting the selected sub power storage device from the second voltage converter should be generated or not based on a state of charge of the selected sub power storage device, when there is no new sub power storage device allowed to replace the selected sub power storage device. The disconnection prohibition unit is configured to instruct the disconnection determination unit not to generate the disconnection request when a temperature condition regarding a temperature of at least one power storage device of the main power storage device and the plurality of sub power storage devices is satisfied.</p>
<p id="p-0018" num="0018">Preferably, the control device further includes an electric power limiter unit. The electric power limiter unit is configured to limit input electric power and output electric power to/from the main power storage device when a temperature of the main power storage device is out of a predetermined range. At least one power storage device includes the main power storage device. The temperature condition includes a first condition that the temperature of the main power storage device is out of the predetermined range.</p>
<p id="p-0019" num="0019">Preferably, the temperature condition is at least one condition of the first condition and a second condition regarding temperatures of the plurality of sub power storage devices. The second condition is a condition that the temperature of at least one sub power storage device of the plurality of sub power storage devices is lower than a predetermined lower limit value.</p>
<p id="p-0020" num="0020">Preferably, at least one sub power storage device is a remaining sub power storage device except for the selected sub power storage device out of the plurality of sub power storage devices.</p>
<p id="p-0021" num="0021">Preferably, the disconnection prohibition unit is configured to set at least one condition as the temperature condition when the electrically powered vehicle is started, and to set only the first condition as the temperature condition after start of the electrically powered vehicle is completed.</p>
<p id="p-0022" num="0022">A method for controlling a power supply system of an electrically powered vehicle according to yet another aspect of the present invention is a method of controlling a power supply system of an electrically powered vehicle incorporating a motor for generating power to drive the vehicle and an inverter for driving the motor. The power supply system includes a main power storage device, an electric power feeding line for feeding electric power to the inverter, a first voltage converter, a plurality of sub power storage devices provided in parallel to each other, a first voltage converter, a second voltage converter, a connection unit, and a control device. The first voltage converter is provided between the electric power feeding line and the main power storage device and configured to convert voltage therebetween bidirectionally. The second voltage converter is provided between the plurality of sub power storage devices and the electric power feeding line, and configured to convert voltage between a sub power storage device selected from the plurality of sub power storage devices and the electric power feeding line bidirectionally. The connection unit is provided between the plurality of sub power storage devices and the second voltage converter, and configured to connect and disconnect the selected sub power storage device to and from the second voltage converter. The control device is configured to control connection and disconnection of the selected sub power storage device to and from the second voltage converter. The control method includes the steps of determining whether a request for disconnecting the selected sub power storage device from the second voltage converter should be generated or not based on a state of charge of the selected sub power storage device, when there is no new sub power storage device allowed to replace the selected sub power storage device, and prohibiting generation of the request when a temperature condition based on a temperature of at least one power storage device of the power storage device and the plurality of sub power storage devices is satisfied.</p>
<p id="p-0023" num="0023">Preferably, the control device further includes an electric power limiter unit. The electric power limiter unit is configured to limit input electric power and output electric power to/from the main power storage device when a temperature of the main power storage device is out of a predetermined range. At least one power storage device includes the main power storage device. The temperature condition includes a first condition that the temperature of the main power storage device is out of the predetermined range.</p>
<p id="p-0024" num="0024">Preferably, the temperature condition is at least one condition of the first condition and a second condition regarding temperatures of the plurality of sub power storage devices. The second condition is a condition that the temperature of at least one sub power storage device of the plurality of sub power storage devices is lower than a predetermined lower limit value.</p>
<p id="p-0025" num="0025">Preferably, at least one sub power storage device is a remaining sub power storage device except for the selected sub power storage device out of the plurality of sub power storage devices.</p>
<p id="p-0026" num="0026">Preferably, the prohibiting step includes the step of setting the temperature condition. When the electrically powered vehicle is started, at least one condition is set as the temperature condition, whereas after start of the electrically powered vehicle is completed, only the first condition is set as the temperature condition.</p>
<heading id="h-0009" level="1">Advantageous Effects of Invention</heading>
<p id="p-0027" num="0027">According to the present invention, in the power supply system configured to include a main power storage device and sub power storage devices, with a plurality of power storage devices sharing a voltage converter (a converter), the main power storage device can appropriately be protected.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0010" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading>
<p id="p-0028" num="0028"><figref idref="DRAWINGS">FIG. 1</figref> is a diagram showing a main configuration of an electrically powered vehicle incorporating a power supply system according to an embodiment of the present invention.</p>
<p id="p-0029" num="0029"><figref idref="DRAWINGS">FIG. 2</figref> is a circuit diagram showing in detail a configuration of each inverter shown in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0030" num="0030"><figref idref="DRAWINGS">FIG. 3</figref> is a circuit diagram showing in detail a configuration of each converter shown in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0031" num="0031"><figref idref="DRAWINGS">FIG. 4</figref> is a functional block diagram for illustrating how traveling of the electrically powered vehicle is controlled.</p>
<p id="p-0032" num="0032"><figref idref="DRAWINGS">FIG. 5</figref> is a diagram showing an exemplary temperature characteristic of upper limits on electric power input/output to/from a main power storage device.</p>
<p id="p-0033" num="0033"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart of a general procedure of a process performed to disconnect a selected sub power storage device in the power supply system of the electrically powered vehicle according to the embodiment of the present invention.</p>
<p id="p-0034" num="0034"><figref idref="DRAWINGS">FIG. 7</figref> is a flowchart for illustrating in detail a process performed to determine whether a selected sub power storage device should be disconnected or not, as shown in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0035" num="0035"><figref idref="DRAWINGS">FIG. 8</figref> is a flowchart for illustrating in detail a pre-disconnection voltage step-up process shown in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0036" num="0036"><figref idref="DRAWINGS">FIG. 9</figref> is a flowchart for illustrating in detail an electric power limit modification process shown in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0037" num="0037"><figref idref="DRAWINGS">FIG. 10</figref> is a flowchart for illustrating in detail a process for disconnection of a sub power storage device shown in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0038" num="0038"><figref idref="DRAWINGS">FIG. 11</figref> is a flowchart for illustrating in detail a stop-stepping-up-voltage process shown in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0039" num="0039"><figref idref="DRAWINGS">FIG. 12</figref> is a waveform diagram of an operation performed in the process for disconnection of a selected sub power storage device in the power supply system of the electrically powered vehicle according to the embodiment of the present invention.</p>
<p id="p-0040" num="0040"><figref idref="DRAWINGS">FIG. 13</figref> is a flowchart for illustrating a process for prohibiting disconnection at the time of start of the power supply system.</p>
<p id="p-0041" num="0041"><figref idref="DRAWINGS">FIG. 14</figref> is a flowchart for illustrating a process for setting a traveling mode performed at the time of start of a vehicle system.</p>
<p id="p-0042" num="0042"><figref idref="DRAWINGS">FIG. 15</figref> is a flowchart for illustrating a process for prohibiting disconnection after start of the power supply system is completed.</p>
<p id="p-0043" num="0043"><figref idref="DRAWINGS">FIG. 16</figref> is a functional block diagram for illustrating a functional portion for the process for disconnection of a selected sub power storage device, in a configuration for controlling the power supply system according to the embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0011" level="1">DESCRIPTION OF EMBODIMENTS</heading>
<p id="p-0044" num="0044">Hereinafter reference will be made to the drawings to more specifically describe the present invention in embodiments. In the following description, identical or equivalent components are denoted by identical reference characters and will in principle not be described repeatedly.</p>
<p id="p-0045" num="0045"><figref idref="DRAWINGS">FIG. 1</figref> shows a main configuration of an electrically powered vehicle incorporating a power supply system according to an embodiment of the present invention.</p>
<p id="p-0046" num="0046">With reference to <figref idref="DRAWINGS">FIG. 1</figref>, an electrically powered vehicle <b>1</b> includes power storage devices implemented as batteries BA, BB<b>1</b>, BB<b>2</b>, connection units <b>39</b>A, <b>39</b>B, converters <b>12</b>A, <b>12</b>B, smoothing capacitors C<b>1</b>, C<b>2</b>, CH, voltage sensors <b>10</b>A, <b>10</b>B<b>1</b>, <b>10</b>B<b>2</b>, <b>13</b>, <b>21</b>A, <b>21</b>B, temperature sensors <b>11</b>A, <b>11</b>B<b>1</b>, <b>11</b>B<b>2</b>, current sensors <b>9</b>A, <b>9</b>B<b>1</b>, <b>9</b>B<b>2</b>, an electric power feeding line PL<b>2</b>, inverters <b>14</b>, <b>22</b>, motor-generators MG<b>1</b>, MG<b>2</b>, a wheel <b>2</b>, a power split device <b>3</b>, an engine <b>4</b>, and a control device <b>30</b>.</p>
<p id="p-0047" num="0047">The present embodiment provides a power supply system of the electrically powered vehicle including a main power storage device implemented as battery BA, electric power feeding line PL<b>2</b> supplying electric power to inverter <b>14</b> driving motor-generator MG<b>2</b>, converter <b>12</b>A provided between main power storage device (BA) and electric power feeding line PL<b>2</b> to serve as a voltage converter converting voltage bidirectionally, batteries BB<b>1</b>, BB<b>2</b> implementing a plurality of sub power storage devices provided in a manner parallel to each other, and converter <b>12</b>B provided between the plurality of sub power storage devices (BB<b>1</b>, BB<b>2</b>) and electric power feeding line PL<b>2</b> to serve as a voltage converter converting voltage bidirectionally. Voltage converter (<b>12</b>B) is connected selectively to one of the plurality of sub power storage devices (BB<b>1</b>, BB<b>2</b>) to convert voltage between the connected sub power storage device and electric power feeding line PL<b>2</b> bidirectionally.</p>
<p id="p-0048" num="0048">A sub power storage device (one of BB<b>1</b> and BB<b>2</b>) and the main power storage device (BA) have their storable capacity set so that, for example, when they are concurrently used, they can output maximum power tolerated for an electric load (<b>22</b>, MG<b>2</b>) connected to the electric power feeding line. This allows the vehicle without using the engine, i.e., traveling as an EV (Electric Vehicle), to travel with maximum power. If the sub power storage device's state of charge is decreased, the sub power storage device can be exchanged to cause the vehicle to further travel, and if the sub power storage device's electric power has completely been consumed, then, in addition to the main power storage device, the engine can be used to allow the vehicle to travel with maximum power without using the sub power storage device.</p>
<p id="p-0049" num="0049">Furthermore, such a configuration allows converter <b>12</b>B to be shared between the plurality of sub power storage devices. This can eliminate the necessity of increasing the number of converters to be equal to that of power storage devices. For further increased EV travelable distance, an additional battery can be introduced in parallel with batteries BB<b>1</b>, BB<b>2</b>.</p>
<p id="p-0050" num="0050">Preferably, this electrically powered vehicle has mounted thereon a main power storage device and sub power storage devices that are externally chargeable. For this purpose, electrically powered vehicle <b>1</b> further includes a battery charging device (a charging converter) <b>6</b> for connection to an external power supply <b>8</b> which is for example a commercial power supply of AC 100V. Battery charging device (<b>6</b>) converts alternate current to direct current and also adjusts voltage to supply electric power charged to a battery. Note that external charging may be achieved by the above-described configuration and in addition a system connecting a neutral point of a stator coil of motor-generator MG<b>1</b>, MG<b>2</b> to alternate current power supply or a system causing converters <b>12</b>A, <b>12</b>B to together function as an AC/DC conversion device.</p>
<p id="p-0051" num="0051">Smoothing capacitor C<b>1</b> is connected between a power supply line PL<b>1</b>A and a ground line SL<b>2</b>. Voltage sensor <b>21</b>A detects a voltage VLA across ends of smoothing capacitor C<b>1</b> and outputs it to control device <b>30</b>. Converter <b>12</b>A can step up voltage across terminals of smoothing capacitor C<b>1</b> and supply it to electric power feeding line PL<b>2</b>.</p>
<p id="p-0052" num="0052">Smoothing capacitor C<b>2</b> is connected between a power supply line PL<b>1</b>B and ground line SL<b>2</b>. Voltage sensor <b>21</b>B detects a voltage VLB across ends of smoothing capacitor C<b>2</b> and outputs it to control device <b>30</b>. Converter <b>12</b>B can step up voltage across terminals of smoothing capacitor C<b>2</b> and supply it to electric power feeding line PL<b>2</b>.</p>
<p id="p-0053" num="0053">Smoothing capacitor CH smoothes the voltage stepped up by converter <b>12</b>A, <b>12</b>B. Voltage sensor <b>13</b> senses a voltage VH across terminals of smoothing capacitor CH and outputs it to control device <b>30</b>.</p>
<p id="p-0054" num="0054">Alternatively, in an opposite direction, converters <b>12</b>A, <b>12</b>B can step down voltage VH across terminals smoothed by smoothing capacitor CH and supply it to power supply lines PL<b>1</b>A, PL<b>1</b>B.</p>
<p id="p-0055" num="0055">Inverter <b>14</b> receives direct current voltage from converter <b>12</b>B and/or <b>12</b>A, converts it to 3 phase alternate current voltage, and outputs it to motor-generator MG<b>1</b>. Inverter <b>22</b> receives direct current voltage from converter <b>12</b>B and/or <b>12</b>A, converts it to 3 phase alternate current voltage, and outputs it to motor-generator MG<b>2</b>.</p>
<p id="p-0056" num="0056">Power split device <b>3</b> is a mechanism coupled to engine <b>4</b> and motor-generators MG<b>1</b>, MG<b>2</b> to distribute power therebetween. The power split device can for example be a planetary gear mechanism having three shafts of rotation of a sun gear, a planetary carrier, and a ring gear. In the planetary gear mechanism, when two of the three shafts of rotation have their rotation determined, that of the other one shaft of rotation is compulsively determined. These three shafts of rotation are connected to engine <b>4</b> and motor-generators MG<b>1</b>, MG<b>2</b> at their respective shafts of rotation, respectively. Motor-generator MG<b>2</b> has its shaft of rotation coupled to wheel <b>2</b> by a reduction gear, a differential gear or the like (not shown). Furthermore, power split device <b>3</b> may further have a speed reducer incorporated therein for the shaft of rotation of motor-generator MG<b>2</b>.</p>
<p id="p-0057" num="0057">Connection unit <b>39</b>A includes a system main relay SMR<b>2</b> connected between the positive electrode of battery BA and power supply line PL<b>1</b>A, a system main relay SMR<b>1</b> and a limiting resistor R connected in series and connected in parallel with system main relay SMR<b>2</b>, and a system main relay SMR<b>3</b> connected between the negative electrode of battery BA (a ground line SL<b>1</b>) and a node N<b>2</b>.</p>
<p id="p-0058" num="0058">System main relays SMR<b>1</b> to SMR<b>3</b> have their conduction/non-conduction states controlled (or are turned on/off) by relay control signals CONT<b>1</b> to CONT<b>3</b>, respectively, issued from control device <b>30</b>.</p>
<p id="p-0059" num="0059">Voltage sensor <b>10</b>A measures a voltage VBA across terminals of battery BA. Furthermore, temperature sensor <b>11</b>A measures a temperature TA of battery BA, and current sensor <b>9</b>A measures a current IA input/output to/from battery BA. These sensors' measurements are output to control device <b>30</b>. Based on these measurements, control device <b>30</b> monitors a state of battery BA represented by state of charge (SOC).</p>
<p id="p-0060" num="0060">Connection unit <b>39</b>B is provided between power supply line PL<b>1</b>B and ground line SL<b>2</b>, and batteries BB<b>1</b>, BB<b>2</b>. Connection unit <b>39</b>B includes a relay SR<b>1</b> connected between the positive electrode of battery BB<b>1</b> and power supply line PL<b>1</b>B, a relay SR<b>1</b>G connected between the negative electrode of battery BB<b>1</b> and ground line SL<b>2</b>, a relay SR<b>2</b> connected between the positive electrode of battery BB<b>2</b> and power supply line PL<b>1</b>B, and a relay SR<b>2</b>G connected between the negative electrode of battery BB<b>2</b> and ground line SL<b>2</b>.</p>
<p id="p-0061" num="0061">Relays SR<b>1</b>, SR<b>2</b> have their conduction/non-conduction states controlled (or are turned on/off) by relay control signals CONT<b>4</b>, CONT<b>5</b>, respectively, issued from control device <b>30</b>. Relays SR<b>1</b>G, SR<b>2</b>G have their conduction/non-conduction states controlled (or are turned on/off) by relay control signals CONT<b>6</b>, CONT<b>7</b>, respectively, issued from control device <b>30</b>. Ground line SL<b>2</b> extends through converters <b>12</b>A, <b>12</b>B toward inverters <b>14</b> and <b>22</b>, as will be described later.</p>
<p id="p-0062" num="0062">Voltage sensors <b>10</b>B<b>1</b> and <b>10</b>B<b>2</b> measure voltages VBB<b>1</b> and VBB<b>2</b> across terminals of batteries BB<b>1</b> and BB<b>2</b>, respectively. Temperature sensors <b>11</b>B<b>1</b> and <b>11</b>B<b>2</b> measure temperatures TBB<b>1</b> and TBB<b>2</b> of batteries BB<b>1</b> and BB<b>2</b>, respectively. Current sensors <b>9</b>B<b>1</b> and <b>9</b>B<b>2</b> measure currents IB<b>1</b> and IB<b>2</b> input/output to/from batteries BB<b>1</b> and BB<b>2</b>, respectively. These sensors' measurements are output to control device <b>30</b>. Based on these measurements, control device <b>30</b> monitors the states of batteries BB<b>1</b>, BB<b>2</b> represented by SOC.</p>
<p id="p-0063" num="0063">Battery BA, BB<b>1</b>, BB<b>2</b> can for example be a lead-acid battery, a nickel metal hydride battery, a lithium ion battery, or a similar secondary battery, an electric double layer capacitor or a similar capacitor of large capacity, or the like.</p>
<p id="p-0064" num="0064">In addition, a power storage capacity of each power storage device can be determined, for example, based on such a condition as traveling performance required in electrically powered vehicle <b>1</b>. Therefore, the main power storage device may be different in power storage capacity from the sub power storage device. Further, a plurality of sub power storage devices may be different from one another in power storage capacity. It is noted in the embodiment of the present invention that batteries BA, BB<b>1</b> and BB<b>2</b> are identical in power storage capacity (a maximum value of a storable amount of electric power).</p>
<p id="p-0065" num="0065">Inverter <b>14</b> is connected to electric power feeding line PL<b>2</b> and ground line SL<b>2</b>. Inverter <b>14</b> receives a voltage stepped up from converter <b>12</b>A and/or converter <b>12</b>B, and drives motor-generator MG<b>1</b> for example to start engine <b>4</b>. Furthermore, inverter <b>14</b> returns to converters <b>12</b>A and <b>12</b>B the electric power generated by motor-generator MG<b>1</b> by power transmitted from engine <b>4</b>. At this time, converters <b>12</b>A and <b>12</b>B are controlled by control device <b>30</b> to operate as step-down converters.</p>
<p id="p-0066" num="0066">Current sensor <b>24</b> detects a current that flows to motor-generator MG<b>1</b> as a motor current value MCRT<b>1</b>, and outputs motor current value MCRT<b>1</b> to control device <b>30</b>.</p>
<p id="p-0067" num="0067">Inverter <b>22</b> is connected to electric power feeding line PL<b>2</b> and ground line SL<b>2</b> in a manner parallel with inverter <b>14</b>. Inverter <b>22</b> receives direct current voltage from converters <b>12</b>A and <b>12</b>B, converts it to 3 phase alternate current voltage, and outputs it to motor-generator MG<b>2</b> driving wheel <b>2</b>. Furthermore, inverter <b>22</b> returns to converters <b>12</b>A and <b>12</b>B the electric power generated by motor-generator MG<b>2</b> as the vehicle is regeneratively braked. At this time, converters <b>12</b>A and <b>12</b>B are controlled by control device <b>30</b> to operate as step-down converters.</p>
<p id="p-0068" num="0068">Current sensor <b>25</b> detects a current that flows to motor-generator MG<b>2</b> as a motor current value MCRT<b>2</b>, and outputs motor current value MCRT<b>2</b> to control device <b>30</b>.</p>
<p id="p-0069" num="0069">Control device <b>30</b> is constituted of an electronic control unit (ECU) having a central processing unit (CPU) and a memory (not shown) incorporated therein, and in accordance with a map and a program stored in the memory, uses each sensor's measurement to perform operation processing. Note that control device <b>30</b> may have a portion configured to allow an electronic circuit or similar hardware to perform predetermined arithmetic and logical operations.</p>
<p id="p-0070" num="0070">More specifically, control device <b>30</b> receives torque command values for motor-generators MG<b>1</b>, MG<b>2</b>, respectively, the motor-generators' respective speeds, the voltage VBA, VBB<b>1</b>, VBB<b>2</b>, VLA, VLB, VH values, motor current values MCRT<b>1</b>, MCRT<b>2</b>, and a start signal IGON. Then, control device <b>30</b> outputs a control signal PWUA instructing converter <b>12</b>A to step up voltage, a control signal PWDA indicating voltage step-down, a control signal PWFA for fixing an upper arm and a lower arm of converter <b>12</b>A to the ON state and the OFF state respectively, and a shutdown signal prohibiting an operation.</p>
<p id="p-0071" num="0071">Similarly, control device <b>30</b> outputs a control signal PWUB instructing converter <b>12</b>B to step up voltage, a control signal PWDB indicating voltage step-down, a control signal PWFB for fixing an upper arm and a lower arm of converter <b>12</b>B to the ON state and the OFF state respectively, and a shutdown signal prohibiting an operation.</p>
<p id="p-0072" num="0072">Furthermore, control device <b>30</b> outputs a control signal PWMI<b>1</b> instructing inverter <b>14</b> to convert direct current voltage output from converters <b>12</b>A, <b>12</b>B to alternate current voltage for driving motor-generator MG<b>1</b>, and a control signal PWMC<b>1</b> instructing inverter <b>14</b> to convert alternate current voltage generated by motor-generator MG<b>1</b> to direct current voltage and return it toward converters <b>12</b>A, <b>12</b>B for regeneration.</p>
<p id="p-0073" num="0073">Similarly, control device <b>30</b> outputs a control signal PWMI<b>2</b> instructing inverter <b>22</b> to convert direct current voltage to alternate current voltage for driving motor-generator MG<b>2</b>, and a control signal PWMC<b>2</b> instructing inverter <b>22</b> to convert alternate current voltage generated by motor-generator MG<b>2</b> to direct current voltage and return it toward converters <b>12</b>A, <b>12</b>B for regeneration.</p>
<p id="p-0074" num="0074"><figref idref="DRAWINGS">FIG. 2</figref> is a circuit diagram showing in detail a configuration of each inverter shown in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0075" num="0075">With reference to <figref idref="DRAWINGS">FIG. 2</figref>, inverter <b>14</b> includes a U-phase arm <b>15</b>, a V-phase arm <b>16</b>, and a W-phase arm <b>17</b>. U-phase arm <b>15</b>, V-phase arm <b>16</b>, and W-phase arm <b>17</b> are connected between electric power feeding line PL<b>2</b> and ground line SL<b>2</b> in parallel.</p>
<p id="p-0076" num="0076">U-phase arm <b>15</b> includes insulated gate bipolar transistor (IGBT) devices Q<b>3</b>, Q<b>4</b> connected in series between electric power feeding line PL<b>2</b> and ground line SL<b>2</b>, IGBT devices Q<b>3</b>, Q<b>4</b>, and their respective anti-parallel diodes D<b>3</b>, D<b>4</b>. Diode D<b>3</b> has its cathode connected to IGBT device Q<b>3</b> at the collector, and its anode to IGBT device Q<b>3</b> at the emitter. Diode D<b>4</b> has its cathode connected to IGBT device Q<b>4</b> at the collector and its anode to IGBT device Q<b>4</b> at the emitter.</p>
<p id="p-0077" num="0077">V-phase arm <b>16</b> includes IGBT devices Q<b>5</b>, Q<b>6</b> connected in series between electric power feeding line PL<b>2</b> and ground line SL<b>2</b>, and their respective anti-parallel diodes D<b>5</b>, D<b>6</b>. IGBT devices Q<b>5</b>, Q<b>6</b> and anti-parallel diodes D<b>5</b>, D<b>6</b> are connected similarly as in U-phase arm <b>15</b>.</p>
<p id="p-0078" num="0078">W-phase arm <b>17</b> includes IGBT devices Q<b>7</b>, Q<b>8</b> connected in series between electric power feeding line PL<b>2</b> and ground line SL<b>2</b>, and their respective anti-parallel diodes D<b>7</b>, D<b>8</b>. IGBT devices Q<b>7</b>, Q<b>8</b> and anti-parallel diodes D<b>7</b>, D<b>8</b> are also connected similarly as in U-phase arm <b>15</b>.</p>
<p id="p-0079" num="0079">Note that in the present embodiment an IGBT device is indicated as a representative example of a power semiconductor switching element controllable to be turned on/off. In other words, it is also replaceable with a bipolar transistor, a field effect transistor, or a similar power semiconductor switching element.</p>
<p id="p-0080" num="0080">Each phase arm has an intermediate point connected to motor-generator MG<b>1</b> at each phase coil at each phase end. In other words, motor-generator MG<b>1</b> is a 3 phase permanent magnet synchronous motor and the three U-, V-, W-phase coils each have one end connected together to an intermediate point. The U-phase coil has the other end connected to a line UL drawn from a connection node of IGBT devices Q<b>3</b>, Q<b>4</b>. The V-phase coil has the other end connected to a line VL drawn from a connection node of IGBT devices Q<b>5</b>, Q<b>6</b>. The W-phase coil has the other end connected to a line WL drawn from a connection node of IGBT devices Q<b>7</b>, Q<b>8</b>.</p>
<p id="p-0081" num="0081">Inverter <b>22</b> shown in <figref idref="DRAWINGS">FIG. 1</figref> is also different in that it is connected to motor-generator MG<b>2</b>, however, its internal circuit configuration is similar to inverter <b>14</b>. Accordingly, it will not be described repeatedly in detail. Furthermore, <figref idref="DRAWINGS">FIG. 2</figref> shows an inverter receiving control signals PWMI, PWMC. This is to avoid complexity. Specifically, as shown in <figref idref="DRAWINGS">FIG. 1</figref>, different control signals PWMI<b>1</b>, PWMC<b>1</b> and control signals PWMI<b>2</b>, PWMC<b>2</b> are input to inverters <b>14</b>, <b>22</b>, respectively.</p>
<p id="p-0082" num="0082"><figref idref="DRAWINGS">FIG. 3</figref> is a circuit diagram showing in detail a configuration of each converter shown in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0083" num="0083">With reference to <figref idref="DRAWINGS">FIG. 3</figref>, converter <b>12</b>A includes a reactor L<b>1</b> having one end connected to power supply line PL<b>1</b>A, IGBT devices Q<b>1</b>, Q<b>2</b> connected in series between electric power feeding line PL<b>2</b> and ground line SL<b>2</b>, and their respective anti-parallel diodes D<b>1</b>, D<b>2</b>.</p>
<p id="p-0084" num="0084">Reactor L<b>1</b> has the other end connected to IGBT device Q<b>1</b> at the emitter and to IGBT device Q<b>2</b> at the collector. Diode D<b>1</b> has its cathode connected to IGBT device Q<b>1</b> at the collector and its anode to IGBT device Q<b>1</b> at the emitter. Diode D<b>2</b> has its cathode connected to IGBT device Q<b>2</b> at the collector and its anode to IGBT device Q<b>2</b> at the emitter. IGBT devices Q<b>1</b>, Q<b>2</b> correspond to the upper arm and the lower arm, respectively.</p>
<p id="p-0085" num="0085">Converter <b>12</b>B shown in <figref idref="DRAWINGS">FIG. 1</figref> is again different from converter <b>12</b>A in that the former is not connected to power supply line PL<b>1</b>A and instead to power supply line PL<b>1</b>B, however, its internal circuit configuration is similar to converter <b>12</b>A. Accordingly, it will not be described repeatedly in detail. Furthermore, <figref idref="DRAWINGS">FIG. 3</figref> shows a converter receiving control signals PWU, PWD, PWF. This is to avoid complexity. Specifically, as shown in <figref idref="DRAWINGS">FIG. 1</figref>, different control signals PWUA, PWDA, PWFA and control signals PWUB, PWDB, PWFB are input to converters <b>12</b>A and <b>12</b>B, respectively.</p>
<p id="p-0086" num="0086">In the power supply system of electrically powered vehicle <b>1</b>, battery BA (the main power storage device) and a sub power storage device selected from batteries BB<b>1</b>, BB<b>2</b> (hereinafter also referred to as a &#x201c;selected sub power storage device BB&#x201d;) and motor-generators MG<b>1</b>, MG<b>2</b> supply and receive electric power therebetween.</p>
<p id="p-0087" num="0087">Control device <b>30</b> receives values detected by voltage sensor <b>10</b>A, temperature sensor <b>11</b>A and current sensor <b>9</b>A, and in accordance therewith sets an SOC(BA) indicating the main power storage device's residual capacity, an upper limit on electric power input Win(M) indicating an upper limit value of electric power charged thereto, and an upper limit on electric power output Wout(M) indicating an upper limit value of electric power discharged therefrom.</p>
<p id="p-0088" num="0088">Furthermore, control device <b>30</b> receives values detected by voltage sensors <b>10</b>B<b>1</b>, <b>10</b>B<b>2</b>, temperature sensors <b>11</b>B<b>1</b>, <b>11</b>B<b>2</b> and current sensors <b>9</b>B<b>1</b>, <b>9</b>B<b>2</b> and in accordance therewith sets an SOC(BB) of selected sub power storage device BB and upper limits on electric power input and output Win(S) and Wout(S) thereto and therefrom, respectively.</p>
<p id="p-0089" num="0089">Generally, an SOC is indicated by a ratio (%) of each battery's current charged amount to its fully charged state. Furthermore, Win, Wout are indicated as such an upper limit value of electric power that, when that electric power is discharged for a predetermined period of time (e.g., for approximately 10 seconds), the battery of interest (BA, BB<b>1</b>, BB<b>2</b>) is not overcharged/overdischarged.</p>
<p id="p-0090" num="0090"><figref idref="DRAWINGS">FIG. 4</figref> is a functional block diagram for illustrating how control device <b>30</b> controls traveling of electrically powered vehicle <b>1</b>, more specifically, a configuration of power distribution control between engine <b>4</b> and motor-generators MG<b>1</b>, MG<b>2</b>. <figref idref="DRAWINGS">FIG. 4</figref> shows functional blocks, which are implemented by control device <b>30</b> executing a previously stored, predetermined program and/or by processing of an operation by electronic circuitry (hardware) in control device <b>30</b>.</p>
<p id="p-0091" num="0091">With reference to <figref idref="DRAWINGS">FIG. 4</figref>, a total power calculation unit <b>260</b> calculates total power Ptt<b>1</b> required for the entirety of electrically powered vehicle <b>1</b> from a vehicular speed and an operation of a pedal (an accelerator pedal). Note that total required power Ptt<b>1</b> may also include power required (i.e., the engine's output), depending on a vehicle's condition, for generating electric power by motor-generator MG<b>1</b> to charge a battery.</p>
<p id="p-0092" num="0092">A traveling control unit <b>250</b> receives upper limits on electric power input/output Win(M), Wout(M) to/from main power storage device BA, upper limits on electric power input/output Win(S), Wout(S) to/from selected sub power storage device BB, total required power Ptt<b>1</b> from total power calculation unit <b>260</b>, and a regenerative brake request made when the brake pedal is operated. Traveling control unit <b>250</b> generates a control motor command, or torque command values Tqcom<b>1</b> and Tqcom<b>2</b>, to allow motor-generators MG<b>1</b>, MG<b>2</b> to in total receive/output electric power within a charging limit (Win(M)+Win(S)) and a discharging limit (Wout(M)+Wout(S)) in total for main power storage device BA and selected sub power storage device BB. Furthermore, to ensure total required power Ptt<b>1</b>, it is assigned between power provided by motor-generator MG<b>2</b> to drive the vehicle and that provided by engine <b>4</b> to do so. In particular, externally charged battery's electric power is maximally utilized to restrict engine <b>4</b> from operation or the power provided by engine <b>4</b> to drive the vehicle is set to correspond to a range allowing engine <b>4</b> to be highly efficiently operable to control the vehicle to travel to achieve high fuel-efficiency.</p>
<p id="p-0093" num="0093"><figref idref="DRAWINGS">FIG. 5</figref> is a diagram showing an exemplary temperature characteristic of upper limits on electric power input/output to/from the main power storage device. Referring to <figref idref="DRAWINGS">FIG. 5</figref>, in a high-temperature region or in a low-temperature region, upper limit on electric power input Win(M) and upper limit on electric power output Wout(M) are limited, as compared with those in a normal temperature region. Upper limit on electric power input Win(M) and upper limit on electric power output Wout(M) are variably set in accordance with temperature TA and the SOC(SOC(BA)) of main power storage device BA.</p>
<p id="p-0094" num="0094">As the temperature characteristics of upper limit on electric power input Win(S) and upper limit on electric power output Wout(S) of the selected sub power storage device are the same as shown in <figref idref="DRAWINGS">FIG. 5</figref>, detailed description will not be repeated hereinafter. Upper limit on electric power input Win(S) and upper limit on electric power output Wout(S) are variably set in accordance with temperature TBB and the SOC(SOC(BB)) of selected power storage device BB. In addition, for example, by having the characteristics shown in <figref idref="DRAWINGS">FIG. 5</figref> stored in advance as a map, control device <b>30</b> can set Win(M), Wout(M), Win(S), and Wout(S).</p>
<p id="p-0095" num="0095">Referring back to <figref idref="DRAWINGS">FIG. 4</figref>, an inverter control unit <b>270</b> receives torque command value Tqcom<b>1</b> and motor current value MCRT<b>1</b> of motor-generator MG<b>1</b> and therefrom generates control signals PWMI<b>1</b>, PWMC<b>1</b> for inverter <b>14</b>. Similarly, an inverter control unit <b>280</b> receives torque command value Tqcom<b>2</b> and motor current value MCRT<b>2</b> of motor-generator MG<b>2</b> and therefrom generates control signals PWMI<b>2</b>, PWMC<b>2</b> for inverter <b>22</b>. Further, traveling control unit <b>250</b> generates a control engine command in response to a value requested of power provided by the engine to drive the vehicle, as set. Furthermore, a control device (an engine ECU) (not shown) controls the operation of engine <b>4</b> in accordance with the control engine command.</p>
<p id="p-0096" num="0096">When control device <b>30</b> actively uses battery's electric power to travel (i.e., in an EV mode) and total required power Ptt<b>1</b> is equal to or smaller than the batteries' total upper limit on electric power output Wout(M)+Wout(S), engine <b>4</b> is not operated but motor-generator MG<b>2</b> alone provides power to drive the vehicle to travel. When total required power Ptt<b>1</b> exceeds Wout(M)+Wout(S), engine <b>4</b> is started.</p>
<p id="p-0097" num="0097">In contrast, when the EV mode is not selected, i.e., in an HV mode, control device <b>30</b> controls distribution of driving power between engine <b>4</b> and motor-generator MG<b>2</b> to maintain the batteries' SOC at a predetermined target value. In other words, traveling control under which travel with engine <b>4</b> is more actuatable than in the EV mode is carried out.</p>
<p id="p-0098" num="0098">In the present embodiment, control device <b>30</b> determines whether switching of the traveling mode from the EV mode to the HV mode should be made or not, based on an average value of the SOC of main power storage device BA and the SOC of selected sub power storage device BB (hereinafter simply referred to as an &#x201c;average value of SOCs&#x201d;). Specifically, when the average value of the SOCs is lower than a predetermined threshold value, control device <b>30</b> determines that switching from the EV mode to the HV mode should be made.</p>
<p id="p-0099" num="0099">In the EV mode, charging and discharging are controlled to preferentially use the electric power of selected sub power storage device BB rather than that of main power storage device BA. As such, when the vehicle is traveling and currently used, selected sub power storage device BB is decreased in SOC, selected sub power storage device BB needs to be switched. For example, if battery BB<b>1</b> is set as selected sub power storage device BB in starting the vehicle, necessity will arise to subsequently disconnect battery BB<b>1</b> from converter <b>12</b>B and connect battery BB<b>2</b> as new selected sub power storage device BB to converter <b>12</b>B, i.e., to perform connection switching processing.</p>
<p id="p-0100" num="0100">Battery BB<b>2</b> newly set as selected sub power storage device BB is generally higher in output voltage than battery BB<b>1</b> that has been used so far.</p>
<p id="p-0101" num="0101">In addition, prior to switching of selected sub power storage device BB as well, main power storage device BA may be different in output voltage from selected sub power storage device BB in use.</p>
<p id="p-0102" num="0102">In the present embodiment, at least one of converters <b>12</b>A and <b>12</b>B performs a voltage step-up operation such that voltage VH is higher than the voltage of the power storage device (VBA, VBB) when both of the main power storage device and the selected sub power storage device are used and when selected sub power storage device BB is switched. Short-circuit between the main power storage device and the selected sub power storage device can thus be prevented.</p>
<p id="p-0103" num="0103">It is noted that the lower limit value of voltage VH is restricted also from a point of view of control of motor-generator MG<b>1</b>, MG<b>2</b>. Specifically, voltage VH is preferably higher than a voltage induced in motor-generator MG<b>1</b>, MG<b>2</b>. Accordingly, actually, voltage VH is controlled to be higher than any of the lower limit value based on restriction imposed on battery and the lower limit value based on motor control.</p>
<p id="p-0104" num="0104">Thus, in a mode in which both of the main power storage device and the selected sub power storage device can be used, converter <b>12</b>A, <b>12</b>B should perform the voltage step-up operation in order to satisfy the lower limit value based on restriction imposed on battery even in a case where voltage VH can be lowered in terms of motor control, typically in a case where voltage step-up by converter <b>12</b>A, <b>12</b>B is not necessary.</p>
<p id="p-0105" num="0105">Even after electric power in both of batteries BB<b>1</b> and BB<b>2</b>, that is, all sub power storage devices, is totally consumed, a short-circuit path may be formed between battery BA and batteries BB<b>1</b> and BB<b>2</b> through diode D<b>1</b> of converter <b>12</b>B and electric power feeding line PL<b>2</b>, provided that connection through a relay is maintained. Therefore, in the power supply system according to the present embodiment, when there is no usable sub power storage device, all sub power storage devices are electrically disconnected from the power supply system.</p>
<p id="p-0106" num="0106">Necessity of voltage step-up in terms of restriction imposed on battery can thus be eliminated. Therefore, when voltage step-up by converter <b>12</b>A is not necessary in view of motor control, the upper arm of converter <b>12</b>A is fixed to the ON state so that electric power loss in converter <b>12</b>A can be reduced. Therefore, efficiency of the converter, that is, fuel efficiency of electrically powered vehicle <b>1</b>, is relatively improved.</p>
<p id="p-0107" num="0107">A process for disconnecting the selected sub power storage device from converter <b>12</b>B will specifically be described hereinafter.</p>
<p id="p-0108" num="0108"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart of a general procedure of a process performed to disconnect a selected sub power storage device in the power supply system of the electrically powered vehicle according to the embodiment of the present invention. Furthermore, <figref idref="DRAWINGS">FIGS. 7 to 11</figref> are flowcharts for specifically illustrating steps S<b>100</b>, S<b>200</b>, S<b>300</b>, S<b>400</b>, and S<b>500</b> in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0109" num="0109">Control device <b>30</b> can execute a previously stored, predetermined program periodically, as predetermined, to repeatedly perform a control processing procedure in accordance with the flowcharts shown in <figref idref="DRAWINGS">FIGS. 6 to 11</figref>, periodically as predetermined. Processing can thus be implemented for disconnecting a sub power storage device in the power supply system of the electrically powered vehicle according to the embodiment of the present invention.</p>
<p id="p-0110" num="0110">With reference to <figref idref="DRAWINGS">FIG. 6</figref>, in step S<b>100</b>, control device <b>30</b> performs a process for determining disconnection of a selected sub power storage device. If control device <b>30</b> determines that it is necessary to disconnect the selected sub power storage device, the following steps S<b>200</b> to S<b>500</b> are performed. If control device <b>30</b> determines in step S<b>100</b> that it is not necessary to disconnect the selected sub power storage device, steps S<b>200</b> to S<b>500</b> are substantially not performed.</p>
<p id="p-0111" num="0111">In step S<b>200</b>, control device <b>30</b> performs a pre-disconnection voltage step-up process, and in step S<b>300</b>, performs an electric power limit modification process so that a request is not generated to the power supply system to excessively charge/discharge while the sub power storage device is being disconnected. In step S<b>400</b>, control device <b>30</b> performs a process for actually disconnecting selected sub power storage device BB from converter <b>12</b>B. In step S<b>500</b>, control device <b>30</b> performs a stop-stepping-up-voltage process for stopping voltage step-up processing performed in step S<b>200</b>.</p>
<p id="p-0112" num="0112"><figref idref="DRAWINGS">FIG. 7</figref> is a flowchart for illustrating in detail the process performed to determine whether the selected sub power storage device should be disconnected or not (S<b>100</b>), as shown in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0113" num="0113">As will be described hereinafter, a variable ID is introduced to indicate the disconnection process's status. Variable ID is set to any of &#x2212;1 and 0 to 4.</p>
<p id="p-0114" num="0114">ID=0 indicates a status in which no request for disconnecting a sub power storage device is generated. In other words, when ID=0, currently selected sub power storage device BB supplies electric power, while whether selected sub power storage device BB should be disconnected or not is determined periodically as predetermined. Meanwhile, when the main power storage device alone cannot supply electric power sufficient for motor-generator MG<b>1</b>, MG<b>2</b> or when disconnection of selected sub power storage device BB is prohibited such as when connection unit <b>39</b>B failed, it is assumed that ID=&#x2212;1 is set.</p>
<p id="p-0115" num="0115">With reference to <figref idref="DRAWINGS">FIG. 7</figref>, in step S<b>105</b>, control device <b>30</b> determines whether ID=0 or not. If ID=0 (YES in S<b>105</b>), in step S<b>110</b>, control device <b>30</b> makes determination as to whether the selected sub power storage device should be disconnected or not. When the SOC of the sub power storage device in use is lower than a predetermined criterion value (a threshold value) and when there is no new sub power storage device remaining that can replace the selected sub power storage device in use, determination that the selected sub power storage device should be disconnected is made.</p>
<p id="p-0116" num="0116">In step S<b>150</b>, control device <b>30</b> checks a result of determination in step S<b>110</b> as to whether disconnection is necessary or not. When it is determined that disconnection is necessary (YES in step S<b>150</b>), control device <b>30</b> sets ID=1 in order to proceed with the disconnection process in step S<b>180</b>. Namely, ID=1 indicates a status that a request for disconnection of selected sub power storage device BB is generated and the disconnection process is started.</p>
<p id="p-0117" num="0117">On the other hand, when it is determined in step S<b>150</b> that disconnection of the selected sub power storage device is not necessary (NO in S<b>150</b>), control device <b>30</b> maintains ID=0 in step S<b>170</b>. Meanwhile, when the disconnection process has been started as relation of ID&#x2267;1 is once satisfied or when ID=&#x2212;1 is set because disconnection of the sub power storage device is prohibited (NO in S<b>105</b>), processing in steps S<b>110</b> to S<b>180</b> is skipped.</p>
<p id="p-0118" num="0118"><figref idref="DRAWINGS">FIG. 8</figref> is a flowchart for illustrating in detail the pre-disconnection voltage step-up process (S<b>200</b>) shown in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0119" num="0119">With reference to <figref idref="DRAWINGS">FIG. 8</figref>, in the pre-disconnection voltage step-up process, in step S<b>205</b>, control device <b>30</b> confirms whether ID=1 or not. If ID=1, a disconnection request to disconnect selected sub power storage device BB is made and the disconnection process is started (YES in S<b>205</b>), control device <b>30</b> generates in step S<b>210</b>, a command to converter <b>12</b>A to step up voltage VH on electric power feeding line PL<b>2</b> to a predetermined voltage V<b>1</b>. In response to the step-up voltage command, a voltage command value VHref for electric power feeding line PL<b>2</b> is set to be equal to V<b>1</b>, and in order to implement this voltage command value, control signal PWUA for converter <b>12</b>A is generated.</p>
<p id="p-0120" num="0120">Note that predetermined voltage V<b>1</b> is set to be higher than any higher one of respective output voltages of main power storage device BA and selected sub power storage device BB (for example, BB<b>2</b>). For example, predetermined voltage V<b>1</b> set at an upper limit control voltage VHmax that can be stepped up by converter <b>12</b>A can ensure that voltage VH when a step-up voltage command is issued is higher than both of the output voltages of main power storage device BA and selected sub power storage device BB after switching. Alternatively, in view of reducing a loss caused at converter <b>12</b>A, predetermined voltage V<b>1</b> may be determined, as occasion demands, to have a margin, depending on voltages output from main power storage device BA and selected sub power storage device BB at that time.</p>
<p id="p-0121" num="0121">If a step-up voltage command is generated in step S<b>210</b>, in step S<b>220</b>, control device <b>30</b> determines based on a value detected by voltage sensor <b>13</b> whether voltage VH has reached predetermined voltage V<b>1</b> or not. Determination as YES is made in step S<b>220</b>, for example, when VH&#x2267;V<b>1</b> continues for a predetermined period of time.</p>
<p id="p-0122" num="0122">Once voltage VH has reached predetermined voltage V<b>1</b> (YES in S<b>220</b>), control device <b>30</b> furthers the ID from 1 to 2. Until voltage VH reaches V<b>1</b> (NO in S<b>220</b>), ID=1 is held. In other words, ID=2 indicates a status in which the pre-disconnection voltage step-up process ends and the disconnection process can be furthered. If ID&#x2260;1 (NO in S<b>205</b>), processing in subsequent steps S<b>210</b> to S<b>230</b> is skipped.</p>
<p id="p-0123" num="0123">Thus, when the pre-disconnection voltage step-up process (step S<b>200</b>) ends, control device <b>30</b> performs the electric power limit modification process as shown in <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0124" num="0124"><figref idref="DRAWINGS">FIG. 9</figref> is a flowchart for illustrating in detail the electric power limit modification process (S<b>300</b>) shown in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0125" num="0125">With reference to <figref idref="DRAWINGS">FIG. 9</figref>, in the electric power limit modification process, initially in step S<b>305</b>, control device <b>30</b> determines whether ID=2 or not. If ID=2 is not satisfied (NO in S<b>305</b>), processing in subsequent steps S<b>320</b> to S<b>340</b> is skipped.</p>
<p id="p-0126" num="0126">If ID=2 (YES in S<b>305</b>), in step S<b>320</b>, control device <b>30</b> gradually decreases absolute values of upper limits on electric power input/output Win(S), Wout(S) to/from selected sub power storage device BB. For example, Wout(S), Win(S) are decreased gradually toward 0 at a predetermined fixed rate. When Wout(S), Win(S) are decreased in a stepwise fashion, an upper limit value of torque of motor-generator MG<b>2</b> (power running torque and regenerative torque) discontinuously decreases. Namely, the torque of motor-generator MG<b>2</b> may suddenly be limited. If such a behavior of motor-generator MG<b>2</b> is transmitted to a driveshaft, for example, it may affect a behavior of the vehicle such as vibration of the vehicle.</p>
<p id="p-0127" num="0127">In the present embodiment, by gradually decreasing the absolute values of Wout(S), Win(S) at a predetermined fixed rate, the upper limit value of the torque of motor-generator MG<b>2</b> can smoothly be lowered. Therefore, as sudden limitation of the torque of motor-generator MG<b>2</b> can be avoided, influence on the behavior of the vehicle as described above can be avoided.</p>
<p id="p-0128" num="0128">In step S<b>330</b>, control device <b>30</b> determines whether Wout(S), Win(S) have reached 0 or not. Until Wout(S)=Win(S)=0, step S<b>320</b> is repeated to continuously decrease Wout(S) and Win(S).</p>
<p id="p-0129" num="0129">Once Wout(S) and Win(S) have reached 0 (YES in S<b>330</b>), control device <b>30</b> furthers the ID from 2 to 3 in step S<b>340</b>. In other words, ID=3 indicates a status in which the pre-disconnection voltage step-up process and the electric power limit modification process have ended and selected sub power storage device BB can be disconnected from converter <b>12</b>B.</p>
<p id="p-0130" num="0130">When the electric power limit modification process shown in <figref idref="DRAWINGS">FIG. 9</figref> ends, control device <b>30</b> performs the process for disconnecting the sub power storage device in step S<b>400</b>.</p>
<p id="p-0131" num="0131"><figref idref="DRAWINGS">FIG. 10</figref> is a flowchart for illustrating in detail the disconnection process to disconnect the sub power storage device (S<b>400</b>), as shown in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0132" num="0132">With reference to <figref idref="DRAWINGS">FIG. 10</figref>, in the process for disconnecting the sub power storage device, initially in step S<b>405</b>, control device <b>30</b> determines whether ID=3 or not. If ID&#x2260;3 (NO in S<b>405</b>), processing in subsequent steps S<b>410</b> to S<b>450</b> is skipped.</p>
<p id="p-0133" num="0133">If ID=3 (YES in S<b>405</b>), in step S<b>410</b>, control device <b>30</b> stops converter <b>12</b>B as preparation for disconnecting the sub power storage device. More specifically, in converter <b>12</b>B, IGBT devices Q<b>1</b>, Q<b>2</b> are forced to turn off in response to a shutdown command.</p>
<p id="p-0134" num="0134">In step S<b>420</b>, control device <b>30</b> generates a relay control signal for disconnecting the selected sub power storage device from converter <b>12</b>B. For example, in an example where sub power storage device BB<b>2</b> is the selected sub power storage device, control device <b>30</b> generates relay control signals CONT<b>5</b> and CONT<b>7</b> to turn off relays SR<b>2</b> and SR<b>2</b>G.</p>
<p id="p-0135" num="0135">Furthermore, in step S<b>430</b>, control device <b>30</b> determines whether disconnection has been completed or not. When disconnection has been completed (YES in S<b>430</b>), control device <b>30</b> furthers the ID from 3 to 4 in step S<b>450</b>.</p>
<p id="p-0136" num="0136">In other words, ID=4 indicates a status in which disconnection between the sub power storage device and converter <b>12</b>B has been completed.</p>
<p id="p-0137" num="0137">When the disconnection process in step S<b>400</b> ends, control device <b>30</b> performs the stop-stepping-up-voltage process in step S<b>500</b>.</p>
<p id="p-0138" num="0138"><figref idref="DRAWINGS">FIG. 11</figref> is a flowchart for illustrating in detail the stop-stepping-up-voltage process (S<b>500</b>) shown in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0139" num="0139">With reference to <figref idref="DRAWINGS">FIG. 11</figref>, in the stop-stepping-up-voltage process, initially in step S<b>505</b>, control device <b>30</b> determines whether ID=4 or not. If ID&#x2260;4 (NO in S<b>505</b>), processing in step S<b>505</b> and later is skipped.</p>
<p id="p-0140" num="0140">If ID=4 (YES in S<b>505</b>), in step S<b>550</b>, control device <b>30</b> turns off the step-up voltage command generated in step S<b>210</b>. In addition, in step S<b>560</b>, control device <b>30</b> permits stop of voltage step-up by converter <b>12</b>A. For example, when voltage step-up by converter <b>12</b>A is not necessary from a point of view of fuel efficiency or the like of the electrically powered vehicle, voltage step-up by converter <b>12</b>A is stopped. Here, the upper arm of converter <b>12</b>A is fixed to ON and the lower arm of converter <b>12</b>A is fixed to OFF.</p>
<p id="p-0141" num="0141"><figref idref="DRAWINGS">FIG. 12</figref> shows an operation waveform in the disconnection process to disconnect the selected sub power storage device in the power supply system of the electrically powered vehicle according to the embodiment of the present invention described with reference to <figref idref="DRAWINGS">FIGS. 6 to 11</figref>.</p>
<p id="p-0142" num="0142">With reference to <figref idref="DRAWINGS">FIG. 12</figref>, during a period until time t<b>1</b> when ID=0, the disconnection determination process is performed periodically as predetermined, based on the SOC of the currently selected sub power storage device (e.g., battery BB<b>2</b>).</p>
<p id="p-0143" num="0143">At time t<b>1</b>, in response to lowering in the SOC of selected sub power storage device BB, the disconnection determination process (step S<b>100</b>) is performed to issue a disconnection request to disconnect selected sub power storage device BB and ID=1 is also set to start the disconnection process.</p>
<p id="p-0144" num="0144">Thus, the pre-disconnection voltage step-up process (step S<b>200</b>) is performed and converter <b>12</b>A increases voltage VH on electric power feeding line PL<b>2</b> toward predetermined voltage V<b>1</b>. Processing for stepping up voltage on electric power feeding line PL<b>2</b> is completed at time t<b>2</b>, and accordingly, the ID is changed from 1 to 2.</p>
<p id="p-0145" num="0145">When ID=2 is set, the electric power limit modification process (S<b>300</b>) is performed to decrease upper limits on electric power input/output Win(S), Wout(S) to/from selected sub power storage device BB toward 0 gradually at a fixed rate. It is noted that, during this period, converter <b>12</b>B is controlled to stop charging/discharging of the currently selected sub power storage device (battery BB<b>1</b>). Alternatively, converter <b>12</b>B may be shut down from time t<b>1</b>.</p>
<p id="p-0146" num="0146">At time t<b>3</b>, upper limits on electric power input/output Win(S), Wout(S) to/from selected sub power storage device BB are lowered to 0, and in response, the ID is changed from 2 to 3. Once ID=3 is set, the process for disconnecting the sub power storage device starts. More specifically, with converter <b>12</b>B being shut down, relays SR<b>2</b>, SR<b>2</b>G are turned off. By completing this disconnection process, the ID is changed from 3 to 4 at time t<b>4</b>.</p>
<p id="p-0147" num="0147">Once ID=4 is set, at time t<b>5</b>, the voltage step-up process for stepping up voltage VH on electric power feeding line PL<b>2</b> to predetermined voltage V<b>1</b> is stopped. A series of steps in the process to disconnect the selected sub power storage device thus ends. It is noted that upper limits on electric power input/output Win(M) and Wout(M) to/from main power storage device BA are not changed in the process for disconnecting the selected sub power storage device.</p>
<p id="p-0148" num="0148">At time t<b>6</b>, stop of voltage step-up by converter <b>12</b>A is permitted. When voltage step-up by converter <b>12</b>A is not necessary, as shown in <figref idref="DRAWINGS">FIG. 12</figref>, a switching operation of converter <b>12</b>A is stopped at time t<b>6</b> and later. Namely, at time t<b>6</b> and later, the upper arm of converter <b>12</b>A is fixed to ON, whereas the lower arm of converter <b>12</b>A is fixed to OFF. Here, voltage VH is lowered to voltage VBA of main power storage device BA. On the other hand, when voltage step-up by converter <b>12</b>A is necessary, the switching operation of converter <b>12</b>A is continued also at time t<b>6</b> and later.</p>
<p id="p-0149" num="0149">When the disconnection process above is performed, main power storage device BA alone can be used and hence electric power that can be input and output in the power supply system as a whole decreases. As shown in <figref idref="DRAWINGS">FIG. 5</figref>, the upper limit on electric power input and the upper limit on electric power output to/from main power storage device BA are limited in the high-temperature region or in the low-temperature region. When main power storage device BA alone is used in such a state, deterioration of main power storage device BA is likely.</p>
<p id="p-0150" num="0150">Therefore, in the present embodiment, at the time of start of the power supply system, that is, at the time of start of a vehicle system in <figref idref="DRAWINGS">FIG. 1</figref>, whether to prohibit disconnection of the selected sub power storage device or not is determined. Specifically, when a temperature condition based on a temperature of at least one of main power storage device BA, sub power storage device BB<b>1</b> and sub power storage device BB<b>2</b> is satisfied, disconnection of the selected sub power storage device is prohibited.</p>
<p id="p-0151" num="0151"><figref idref="DRAWINGS">FIG. 13</figref> is a flowchart for illustrating a process for prohibiting disconnection at the time of start of the power supply system. Referring to <figref idref="DRAWINGS">FIG. 13</figref>, control device <b>30</b> determines in step S<b>610</b> whether start signal IGON has been input to control device <b>30</b> or not. Input of start signal IGON means start of the power supply system and the vehicle system (see <figref idref="DRAWINGS">FIG. 1</figref>). When start signal IGON has not been input to control device <b>30</b> (NO in S<b>610</b>), processing in steps S<b>620</b> to S<b>660</b> is skipped.</p>
<p id="p-0152" num="0152">On the other hand, when it is determined in step S<b>610</b> that start signal IGON has been input to control device <b>30</b> (YES in S<b>610</b>), control device <b>30</b> sets the temperature condition in step S<b>620</b>. The temperature condition here is at least one condition of a condition that temperature TA of main power storage device BA is out of a range from a temperature T<b>1</b> to a temperature T<b>2</b> and a condition that a temperature of at least one sub power storage device of sub power storage devices BB<b>1</b> and BB<b>2</b> is lower than a lower limit temperature.</p>
<p id="p-0153" num="0153">In step S<b>630</b>, control device <b>30</b> determines whether the condition that temperature TA of main power storage device BA is out of the range from temperature T<b>1</b> to temperature T<b>2</b> is satisfied or not. Specifically, control device <b>30</b> determines whether any one of the condition that temperature TA of main power storage device BA is lower than lower limit temperature T<b>1</b> and the condition that temperature TA is higher than upper limit temperature T<b>2</b> is satisfied or not.</p>
<p id="p-0154" num="0154">Lower limit temperature T<b>1</b> corresponds to the lower limit of the normal temperature region shown in <figref idref="DRAWINGS">FIG. 5</figref>. Upper limit temperature T<b>2</b> corresponds to the upper limit of the normal temperature region. In consideration of a margin, the range from temperature T<b>1</b> to temperature T<b>2</b> may be set narrower than the normal temperature region shown in <figref idref="DRAWINGS">FIG. 5</figref>. Namely, temperature T<b>1</b> may be set higher than the lower limit of the normal temperature region and temperature T<b>2</b> may be set lower than the upper limit of the normal temperature region.</p>
<p id="p-0155" num="0155">When any one of the condition that temperature TA is lower than lower limit value T<b>1</b> and the condition that temperature TA is higher than upper limit value T<b>2</b> is satisfied (YES in step S<b>630</b>), control device <b>30</b> sets ID=&#x2212;1 in step S<b>640</b>.</p>
<p id="p-0156" num="0156">On the other hand, when neither of the condition that temperature TA is lower than lower limit value T<b>1</b> and the condition that temperature TA is higher than upper limit value T<b>2</b> is satisfied (NO in step S<b>630</b>), control device <b>30</b> performs the processing in step S<b>650</b>.</p>
<p id="p-0157" num="0157">In step S<b>650</b>, control device <b>30</b> determines whether a condition that a temperature of a remaining sub power storage device except for the sub power storage device in use (the selected sub power storage device) out of the plurality of sub power storage devices is lower than lower limit temperature T<b>1</b> is satisfied or not. At the time of start of the power supply system, none of the plurality of sub power storage devices is used. Namely, at the time of start of the power supply system, there is no sub power storage device in use. Therefore, control device <b>30</b> determines whether temperature TBB<b>1</b> of sub power storage device BB<b>1</b> is lower than lower limit temperature T<b>1</b> or not and determines whether temperature TBB<b>2</b> of sub power storage device BB<b>2</b> is lower than lower limit temperature T<b>1</b> or not.</p>
<p id="p-0158" num="0158">It is noted that the &#x201c;remaining sub power storage device except for the sub power storage device in use out of the plurality of sub power storage devices&#x201d; is not limited to an unused sub power storage device, but includes also a sub power storage device that has already been disconnected from converter <b>12</b>B.</p>
<p id="p-0159" num="0159">When any of the condition that temperature TBB<b>1</b> is lower than lower limit value T<b>1</b> and the condition that temperature TBB<b>2</b> is higher than lower limit value T<b>1</b> is satisfied (YES in step S<b>650</b>), control device <b>30</b> sets ID=&#x2212;1 in step S<b>640</b>. On the other hand, when neither of the two conditions above is satisfied (NO in step S<b>650</b>), control device <b>30</b> sets ID=0 in step S<b>660</b>.</p>
<p id="p-0160" num="0160">When temperature TA is out of the normal temperature region, upper limit on electric power input Win(M) and upper limit on electric power output Wout(M) are limited. Here, as ID is set to &#x2212;1, disconnection of selected sub power storage device BB is prohibited. Thus, electric power input and output in the power supply system can be allocated to main power storage device BA and selected sub power storage device BB. Thus, as compared with an example where main power storage device BA alone is used, electric power input/output to/from main power storage device BA can be decreased and hence deterioration of the main power storage device can be suppressed.</p>
<p id="p-0161" num="0161">Even when the temperature of the sub power storage device not in use is lower than lower limit temperature T<b>1</b>, disconnection of selected sub power storage device BB is prohibited as ID is set to &#x2212;1. The temperature of the sub power storage device not in use can be estimated to be substantially equal to an atmospheric temperature of the sub power storage device, that is, an outside air temperature. When the temperature of the sub power storage device not in use is lower than lower limit temperature T<b>1</b>, main power storage device BA is cooled by the outside air, which may result in temperature TA of main power storage device BA becoming lower than lower limit temperature T<b>1</b>. In this case as well, upper limit on electric power input Win(M) and upper limit on electric power output Wout(M) are limited. As disconnection of selected sub power storage device BB is prohibited, however, both of main power storage device BA and selected sub power storage device BB can be used. Therefore, deterioration of the main power storage device can be suppressed.</p>
<p id="p-0162" num="0162">Meanwhile, as the sub power storage device in use generates heat, the temperature thereof is likely to be different from the outside air temperature. Therefore, the temperature of the sub power storage device in use is not adopted in the processing in step S<b>650</b>.</p>
<p id="p-0163" num="0163">When temperature TA is in the normal temperature region and when the temperature of the sub power storage device not in use is higher than lower limit temperature T<b>1</b> (NO in step S<b>630</b>), it is less likely that temperature TA of main power storage device BA is lower than lower limit temperature T<b>1</b>. Therefore, in this case, ID=0 is set. Namely, disconnection of the selected sub power storage device from converter <b>12</b>B is not prohibited.</p>
<p id="p-0164" num="0164">It is noted that the processing in step S<b>630</b> and the processing in step S<b>650</b> may be combined as one process.</p>
<p id="p-0165" num="0165">Control device <b>30</b> (specifically, traveling control unit <b>250</b> shown in <figref idref="DRAWINGS">FIG. 4</figref>) sets the traveling mode at the time of start of the vehicle system, based on the result of the process in the flowchart in <figref idref="DRAWINGS">FIG. 13</figref>. <figref idref="DRAWINGS">FIG. 14</figref> is a flowchart for illustrating a process for setting the traveling mode performed at the time of start of the vehicle system.</p>
<p id="p-0166" num="0166">Referring to <figref idref="DRAWINGS">FIG. 14</figref>, in step S<b>710</b>, control device <b>30</b> determines whether ID=&#x2212;1 or not. When ID=&#x2212;1 (YES in step S<b>710</b>), control device <b>30</b> determines in step S<b>720</b> whether an average value of the SOCs of main power storage device BA and selected sub power storage device BB is lower than a threshold value or not.</p>
<p id="p-0167" num="0167">When the average value of the SOCs is lower than the threshold value (YES in step S<b>720</b>), control device <b>30</b> sets the traveling mode to the HV mode in step S<b>730</b>. When the average value of the SOCs is higher than the threshold value (NO in step S<b>720</b>), control device <b>30</b> sets the traveling mode to the EV mode in step S<b>740</b>.</p>
<p id="p-0168" num="0168">As ID=&#x2212;1 in any of steps S<b>730</b> and S<b>740</b>, disconnection of selected sub power storage device BB is prohibited. Namely, the traveling mode in which both of main power storage device BA and selected sub power storage device BB are used is set.</p>
<p id="p-0169" num="0169">When ID is not set to &#x2212;1 (NO in step S<b>710</b>), control device <b>30</b> determines in step S<b>750</b> whether the average value of the SOCs of main power storage device BA and selected sub power storage device BB is lower than the threshold value or not.</p>
<p id="p-0170" num="0170">When the average value of the SOCs is lower than the threshold value (YES in step S<b>750</b>), control device <b>30</b> sets the traveling mode to the HV mode in step S<b>760</b>. When the average value of the SOCs is higher than the threshold value (NO in step S<b>750</b>), control device <b>30</b> sets the traveling mode to the EV mode in step S<b>760</b>.</p>
<p id="p-0171" num="0171">In step S<b>760</b>, the traveling mode in which main power storage device BA alone can be used is set. On the other hand, in step S<b>770</b>, the traveling mode in which both of main power storage device BA and selected sub power storage device BB can be used is set. In the traveling mode set in step S<b>770</b>, when the SOC of the selected sub power storage device in use becomes lower, that sub power storage device is switched to a new sub power storage device. In addition, when there is no sub power storage device that can be used, all sub power storage devices are electrically disconnected from the power supply system.</p>
<p id="p-0172" num="0172"><figref idref="DRAWINGS">FIG. 15</figref> is a flowchart for illustrating a process for prohibiting disconnection after start of the power supply system is completed. Here, a state that start of the power supply system has been completed corresponds to a state that the power supply system is being used, that is, the state that the electrically powered vehicle is traveling.</p>
<p id="p-0173" num="0173">Referring to <figref idref="DRAWINGS">FIG. 15</figref>, control device <b>30</b> determines in step S<b>810</b> whether any of ID=&#x2212;1 and ID=4 is satisfied or not. When ID=&#x2212;1 or ID=4 (YES in step S<b>810</b>), processing in steps S<b>820</b> to S<b>840</b> is skipped.</p>
<p id="p-0174" num="0174">When neither of ID=&#x2212;1 and ID=4 is satisfied (NO in step S<b>810</b>), control device <b>30</b> sets a temperature condition in step S<b>820</b>. The temperature condition here is a condition that temperature TA of main power storage device BA is out of the range from temperature T<b>1</b> to temperature T<b>2</b>.</p>
<p id="p-0175" num="0175">Control device <b>30</b> determines in step S<b>830</b> whether the condition that temperature TA of main power storage device BA is out of the range from temperature T<b>1</b> to temperature T<b>2</b> is satisfied or not. Specifically, control device <b>30</b> determines whether any one of the condition that temperature TA of main power storage device BA is lower than lower limit temperature T<b>1</b> and the condition that temperature TA is higher than upper limit temperature T<b>2</b> is satisfied or not. When relation of TA&#x3c;T<b>1</b> or TA&#x3e;T<b>2</b> is satisfied (YES in step S<b>830</b>), control device <b>30</b> sets ID=&#x2212;1 in step S<b>840</b>.</p>
<p id="p-0176" num="0176">On the other hand, when neither of TA&#x3c;T<b>1</b> and TA&#x3e;T<b>2</b> is satisfied, that is, when temperature TA is within the range from temperature T<b>1</b> to temperature T<b>2</b>, the processing in step S<b>830</b> is skipped. Here, variable ID is not changed.</p>
<p id="p-0177" num="0177">The temperature of the main power storage device (or each of the plurality of sub power storage devices) is considered as lowest at the time of start of the power supply system, that is, at the time of start of the vehicle system. Therefore, at the time of start of the power supply system, whether to prohibit disconnection of the selected sub power storage device or not is determined based on the temperature of each of the main power storage device and the plurality of sub power storage devices.</p>
<p id="p-0178" num="0178">At the time of start of the power supply system, initially, it is determined whether or not the temperature of the main power storage device is within a temperature region (the low-temperature region or the high-temperature region) where electric power input/output to/from the main power storage device is limited. Even though the temperature of the main power storage device is within the normal temperature region, in case that the outside air temperature is low, the main power storage device is cooled and therefore electric power input/output to/from the main power storage device may be limited. Accordingly, at the time of start of the power supply system, the outside air temperature is estimated. As both of sub power storage devices BB<b>1</b> and BB<b>2</b> are unused, any lower one of the temperatures of respective sub power storage devices BB<b>1</b> and BB<b>2</b> is considered as substantially equal to the outside air temperature. Then, whether the temperature of each of sub power storage devices BB<b>1</b> and BB<b>2</b> is lower than lower limit temperature T<b>1</b> or not is determined.</p>
<p id="p-0179" num="0179">On the other hand, while the electrically powered vehicle is traveling, whether to prohibit disconnection of the selected sub power storage device or not is determined based only on temperature TA of main power storage device BA. It is less likely that the outside air temperature suddenly lowers during traveling of the vehicle. Namely, unless the outside air temperature of main power storage device BA is lower than lower limit temperature T<b>1</b> at the time of start of the power supply system, it is also less likely that the outside air temperature of main power storage device BA subsequently becomes lower than lower limit temperature T<b>1</b>. According to the present embodiment, during traveling of the electrically powered vehicle, whether disconnection of the selected sub power storage device should be prohibited or not is determined based only on temperature TA of main power storage device BA. Thus, the processing performed by control device <b>30</b> can be simplified.</p>
<p id="p-0180" num="0180">When temperature TA is included in the normal temperature region, disconnection of the selected sub power storage device is allowed. By disconnecting the selected sub power storage device from converter <b>12</b>B as described above, the voltage step-up operation by converter <b>12</b>A can be stopped. Consequently, as reduction in loss in the power supply system and the inverter can be expected, improvement in fuel efficiency of the electrically powered vehicle (the hybrid vehicle) can be expected. On the other hand, when temperature TA is out of the normal temperature region, disconnection of the selected sub power storage device is prohibited and hence the main power storage device can be protected. Therefore, according to the present embodiment, improvement in fuel efficiency during traveling of the electrically powered vehicle and protection of the main power storage device can both be achieved.</p>
<p id="p-0181" num="0181">A configuration of a functional portion for the process for disconnecting the selected sub power storage device described in connection with <figref idref="DRAWINGS">FIGS. 6 to 13</figref> and <b>15</b>, representing a part of a control configuration of the power supply system according to the embodiment of the present invention will now be described with reference to <figref idref="DRAWINGS">FIG. 16</figref>. <figref idref="DRAWINGS">FIG. 16</figref> shows functional blocks, which are implemented as control device <b>30</b> executing a predetermined program to provide software processing, or by dedicated electronic circuitry (or hardware processing).</p>
<p id="p-0182" num="0182">With reference to <figref idref="DRAWINGS">FIG. 16</figref>, a disconnection determination unit <b>100</b> receives SOC(BB<b>1</b>), SOC(BB<b>2</b>) indicating the states of charge respectively of batteries BB<b>1</b>, BB<b>2</b>. When variable ID shared by the functional blocks is set to 0, disconnection determination unit <b>100</b> determines whether selected sub power storage device BB currently used has an SOC decreased to be lower than a predetermined threshold value or not. In addition, disconnection determination unit <b>100</b> determines whether there is a new sub power storage device remaining that can replace the currently used selected sub power storage device or not, based on SOC(BB<b>1</b>) and SOC(BB<b>2</b>). The determination processing above is performed in a predetermined cycle.</p>
<p id="p-0183" num="0183">Namely, when there is no new sub power storage device remaining that can replace the currently used selected sub power storage device, disconnection determination unit <b>100</b> determines whether selected sub power storage device BB should be disconnected from converter <b>12</b>B or not, based on state of charge SOC(BB) of the selected sub power storage device. Then, when it is necessary to disconnect the selected sub power storage device, disconnection determination unit <b>100</b> changes the ID from 0 to 1. Thus, a request is generated to disconnect the selected sub power storage device. In other words, disconnection determination unit <b>100</b> has a function corresponding to the process in step S<b>100</b> in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0184" num="0184">When a request is generated to disconnect the selected sub power storage device and ID=1 is set, a step-up-voltage instruction unit <b>110</b> outputs a step-up voltage command signal CMBT to a converter control unit <b>200</b> controlling converter <b>12</b>A.</p>
<p id="p-0185" num="0185">Converter control unit <b>200</b> generates control signals PWUA, PWDA for converter <b>12</b>A based on voltages VH, VLA and voltage command value VHref, so that voltage VH on electric power feeding line PL<b>2</b> reaches voltage command value VHref.</p>
<p id="p-0186" num="0186">Furthermore, when step-up-voltage instruction unit <b>110</b> generates step-up voltage command signal CMBT, converter control unit <b>200</b> sets voltage command value VHref=V<b>1</b> and generates control signal PWUA. If voltage sensor <b>13</b> detects voltage VH having reached predetermined voltage V<b>1</b> continuously for at least a predetermined period of time, converter control unit <b>200</b> sets a flag FBT to ON indicating that stepping up voltage is completed.</p>
<p id="p-0187" num="0187">In response to flag FBT set to ON, step-up-voltage instruction unit <b>110</b> sets ID=2 and continues to output step-up voltage command signal CMBT until a disconnection control unit <b>140</b>, which will be described later, completes the disconnection process and ID=4 is set. In other words, step-up-voltage instruction unit <b>110</b> has a function corresponding to step S<b>200</b> in <figref idref="DRAWINGS">FIG. 6</figref> and step S<b>550</b> in <figref idref="DRAWINGS">FIG. 11</figref>.</p>
<p id="p-0188" num="0188">An electric power limiter unit <b>120</b> sets upper limits on electric power input/output Win(S), Wout(S) to/from selected sub power storage device BB. Normally, upper limits on electric power input/output Win(S), Wout(S) are set based on selected sub power storage device BB or battery's SOC(SOC(BB<b>1</b>) or SOC(BB<b>2</b>)), temperature (TBB<b>1</b> or TBB<b>2</b>) and an output voltage (VB<b>1</b> or VB<b>2</b>).</p>
<p id="p-0189" num="0189">In the disconnection process for disconnecting the selected sub power storage device, in contrast, when ID=2 is set, electric power limiter unit <b>120</b> decreases upper limits on electric power input/output Win(S), Wout(S) gradually at a fixed rate toward 0, and when Win(S), Wout(S) have reached 0, electric power limiter unit <b>120</b> changes the ID from 2 to 3. When the ID reaches 3, electric power limiter unit <b>120</b> fixes upper limits on electric power input/output Win(S), Wout(S) to 0. Namely, the function of electric power limiter unit <b>120</b> corresponds to the processing in steps S<b>320</b> to S<b>340</b> in <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0190" num="0190">An electric power limiter unit <b>130</b> sets upper limits on electric power input/output Win(M) and Wout(M) to/from main power storage device BA. Upper limits on electric power input/output Win(M), Wout(M) are set based on main power storage device BA's SOC(BA), temperature TA, and voltage VBA.</p>
<p id="p-0191" num="0191">When electric power limiter unit <b>120</b> sets ID=3, disconnection control unit <b>140</b> in response generates a command to shut down converter <b>12</b>B. Furthermore, disconnection control unit <b>140</b> generates relay control signals CONT<b>4</b> to CONT<b>7</b> such that selected sub power storage device BB is disconnected from converter <b>12</b>B. For example, when battery BB<b>2</b> is selected as selected sub power storage device BB, relay control signals CONT<b>5</b> and CONT<b>7</b> are generated such that relays SR<b>2</b> and SR<b>2</b>G are turned off. Once this disconnection process has been completed, disconnection control unit <b>140</b> ends the shutdown state of converter <b>12</b>B and changes the ID from 3 to 4. Namely, the function of disconnection control unit <b>140</b> corresponds to the process in step S<b>400</b> in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0192" num="0192">When disconnection control unit <b>140</b> sets ID=4, a stop-stepping-up-voltage permission unit <b>150</b> generates a command permitting stop of a voltage step-up operation by converter <b>12</b>A and outputs the command. Namely, the function of stop-stepping-up-voltage permission unit <b>150</b> corresponds to the processing in step S<b>560</b> in <figref idref="DRAWINGS">FIG. 11</figref>. Converter control unit <b>200</b> generates control signal PWFA for fixing the upper arm of converter <b>12</b>A to ON, in response to the command from stop-stepping-up-voltage permission unit <b>150</b>.</p>
<p id="p-0193" num="0193">A disconnection prohibition unit <b>160</b> receives start signal IGON. Here, disconnection prohibition unit <b>160</b> sets ID=0 or ID=&#x2212;1 based on temperature TA of main power storage device BA, temperature TBB<b>1</b> of sub power storage device BB<b>1</b> and temperature TBB<b>2</b> of sub power storage device BB<b>2</b>.</p>
<p id="p-0194" num="0194">In addition, disconnection prohibition unit <b>150</b> receives variable ID during traveling of the electrically powered vehicle. Here, disconnection prohibition unit <b>160</b> does not change variable ID when temperature TA of main power storage device BA is within the normal temperature region. On the other hand, disconnection prohibition unit <b>160</b> sets ID=&#x2212;1 when temperature TA of main power storage device BA is out of the normal temperature region.</p>
<p id="p-0195" num="0195">Namely, the function of disconnection prohibition unit <b>160</b> corresponds to the processing in steps S<b>610</b> to S<b>650</b> in <figref idref="DRAWINGS">FIG. 13</figref> and steps S<b>810</b> to S<b>830</b> in <figref idref="DRAWINGS">FIG. 15</figref>.</p>
<p id="p-0196" num="0196">As described above, according to the power supply system of the electrically powered vehicle in the present embodiment, when a predetermined condition regarding a temperature of each of the main power storage device and the plurality of sub power storage devices is satisfied, disconnection between the selected sub power storage device and converter <b>12</b>B is prohibited. The main power storage device can thus be protected.</p>
<p id="p-0197" num="0197">In the present embodiment, an electrically powered vehicle incorporating a series/parallel hybrid system in which motive power of an engine can be divided for transmission to driving wheels and a generator by means of a power split device has been shown. The present invention, however, is also applicable, for example, to a series hybrid vehicle in which an engine is used only for driving a generator and driving force for an axle shaft is generated only by a motor using electric power generated by the generator, an electric car, and a fuel cell car. As these vehicles all incorporate a motor generating power to drive the vehicle and a power storage device, the present invention is applicable thereto.</p>
<p id="p-0198" num="0198">It should be understood that the embodiments disclosed herein are illustrative and non-restrictive in every respect. The scope of the present invention is defined by the terms of the claims, rather than the description above, and is intended to include any modifications within the scope and meaning equivalent to the terms of the claims.</p>
<heading id="h-0012" level="1">REFERENCE SIGNS LIST</heading>
<p id="p-0199" num="0199"><b>1</b> electrically powered vehicle; <b>2</b> wheel; <b>3</b> power split device; <b>4</b> engine; <b>6</b> battery charging converter (external charging); <b>8</b> external power supply; <b>9</b>A, <b>9</b>B<b>1</b>, <b>9</b>B<b>2</b>, <b>24</b>, <b>25</b> current sensor; <b>10</b>A, <b>10</b>B<b>1</b>, <b>10</b>B<b>2</b>, <b>13</b>, <b>21</b>A, <b>21</b>B voltage sensor; <b>11</b>A, <b>11</b>B<b>1</b>, <b>11</b>B<b>2</b> temperature sensor; <b>12</b>A, <b>12</b>B converter; <b>14</b>, <b>22</b> inverter; <b>15</b> U-phase arm; <b>16</b> V-phase arm; <b>17</b> W-phase arm; <b>30</b> control device; <b>39</b>A, <b>39</b>B connection unit; <b>100</b> disconnection determination unit; <b>110</b> step-up-voltage instruction unit; <b>120</b>, <b>130</b> electric power limiter unit; <b>140</b> disconnection control unit; <b>150</b> stop-stepping-up-voltage permission unit; <b>160</b> disconnection prohibition unit; <b>200</b> converter control unit; <b>250</b> traveling control unit; <b>260</b> total power calculation unit; <b>270</b>, <b>280</b> inverter control unit; BA battery (main power storage device); BB selected sub power storage device; BB<b>1</b>, BB<b>2</b> battery (sub power storage device); C<b>1</b>, C<b>2</b>, CH smoothing capacitor; CMBT step-up voltage command signal; CONT<b>1</b> to CONT<b>7</b> relay control signal; D<b>1</b> to D<b>8</b> parallel diode; FBT flag; IA input/output current; IB current; ID variable; IGON start signal; L<b>1</b> reactor; MCRT<b>1</b>, MCRT<b>2</b> motor current value; MG<b>1</b>, MG<b>2</b> motor-generator; N<b>2</b> node; PL<b>1</b>A, PL<b>1</b>B power supply line; PL<b>2</b> electric power feeding line; Ptt<b>1</b> total required power; PWMI<b>1</b>, PWMI<b>2</b>, PWMC, PWMC<b>1</b>, PWMC<b>2</b> control signal (for inverter); PWU, PWUA, PWDA, PWD, PWDA, PWDB control signal (for converter); Q<b>1</b> to Q<b>8</b> IGBT device; R limiting resistor; SL<b>1</b>, SL<b>2</b> ground line; SMR<b>1</b> to SMR<b>3</b> system main relay; SR<b>1</b>, SR<b>1</b>G, SR<b>2</b>, SR<b>2</b>G relay; TA, TBB, TBB<b>1</b>, TBB<b>2</b> temperature (battery); Tqcom<b>1</b>, Tqcom<b>2</b> torque command value; UL, VL, WL line (3 phase); VBA, VBB<b>1</b>, VBB<b>2</b>, VLA, VLB, VH voltage; VHref voltage command value; Win, Win(M), Win(S) upper limit on electric power input; and Wout, Wout(M), Wout(S) upper limit on electric power output.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A power supply system for an electrically powered vehicle incorporating a motor for generating power to drive the vehicle and an inverter for driving said motor, comprising:
<claim-text>a main power storage device;</claim-text>
<claim-text>an electric power feeding line for feeding electric power to said inverter;</claim-text>
<claim-text>a first voltage converter provided between said electric power feeding line and said main power storage device and configured to convert voltage therebetween bidirectionally;</claim-text>
<claim-text>a plurality of sub power storage devices provided in parallel to each other;</claim-text>
<claim-text>a second voltage converter provided between said plurality of sub power storage devices and said electric power feeding line, and configured to convert voltage between a sub power storage device selected from said plurality of sub power storage devices and said electric power feeding line bidirectionally;</claim-text>
<claim-text>a connection unit provided between said plurality of sub power storage devices and said second voltage converter, and configured to connect and disconnect the selected sub power storage device to and from said second voltage converter; and</claim-text>
<claim-text>a control device configured to control connection and disconnection of said selected sub power storage device to and from said second voltage converter,</claim-text>
<claim-text>said control device including
<claim-text>a disconnection determination unit configured to determine whether a disconnection request for disconnecting said selected sub power storage device from said second voltage converter should be generated based on a state of charge of said selected sub power storage device, when there is no new sub power storage device allowed to replace said selected sub power storage device, and</claim-text>
<claim-text>a disconnection prohibition unit configured to instruct said disconnection determination unit not to generate said disconnection request when a temperature condition regarding a temperature of at least one power storage device of said main power storage device and said plurality of sub power storage devices is satisfied.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The power supply system for an electrically powered vehicle according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein
<claim-text>said control device further includes an electric power limiter unit configured to limit input electric power and output electric power to/from said main power storage device when a temperature of said main power storage device is out of a predetermined range,</claim-text>
<claim-text>said at least one power storage device includes said main power storage device, and</claim-text>
<claim-text>said temperature condition includes a first condition that the temperature of said main power storage device is out of said predetermined range.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The power supply system for an electrically powered vehicle according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein
<claim-text>said temperature condition is at least one condition of said first condition and a second condition regarding temperatures of said plurality of sub power storage devices, and</claim-text>
<claim-text>said second condition is a condition that the temperature of at least one sub power storage device of said plurality of sub power storage devices is lower than a predetermined lower limit value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The power supply system for an electrically powered vehicle according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein
<claim-text>said at least one sub power storage device is a remaining sub power storage device except for said selected sub power storage device out of said plurality of sub power storage devices.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The power supply system for an electrically powered vehicle according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein
<claim-text>said disconnection prohibition unit is configured to set said at least one condition as said temperature condition when said electrically powered vehicle is started, and to set only said first condition as said temperature condition after start of said electrically powered vehicle is completed.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. An electrically powered vehicle, comprising:
<claim-text>a motor for generating power to drive the vehicle;</claim-text>
<claim-text>an inverter (<b>14</b>) for driving said motor;</claim-text>
<claim-text>a main power storage device;</claim-text>
<claim-text>an electric power feeding line for feeding electric power to said inverter;</claim-text>
<claim-text>a first voltage converter provided between said electric power feeding line and said main power storage device and configured to convert voltage therebetween bidirectionally;</claim-text>
<claim-text>a plurality of sub power storage devices provided in parallel to each other;</claim-text>
<claim-text>a second voltage converter (<b>12</b>B) provided between said plurality of sub power storage devices and said electric power feeding line, and configured to convert voltage between a sub power storage device selected from said plurality of sub power storage devices and said electric power feeding line bidirectionally;</claim-text>
<claim-text>a connection unit provided between said plurality of sub power storage devices and said second voltage converter, and configured to connect and disconnect the selected sub power storage device to and from said second voltage converter; and</claim-text>
<claim-text>a control device configured to control connection and disconnection of said selected sub power storage device to and from said second voltage converter,</claim-text>
<claim-text>said control device including
<claim-text>a disconnection determination unit configured to determine whether a disconnection request for disconnecting said selected sub power storage device from said second voltage converter should be generated based on a state of charge of said selected sub power storage device, when there is no new sub power storage device allowed to replace said selected sub power storage device, and</claim-text>
<claim-text>a disconnection prohibition unit configured to instruct said disconnection determination unit not to generate said disconnection request when a temperature condition regarding a temperature of at least one power storage device of said main power storage device and said plurality of sub power storage devices is satisfied.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The electrically powered vehicle according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein
<claim-text>said control device further includes an electric power limiter unit configured to limit input and output electric power to/from said main power storage device when a temperature of said main power storage device is out of a predetermined range,</claim-text>
<claim-text>said at least one power storage device includes said main power storage device, and</claim-text>
<claim-text>said temperature condition includes a first condition that the temperature of said main power storage device is out of said predetermined range.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The electrically powered vehicle according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein
<claim-text>said temperature condition is at least one condition of said first condition and a second condition regarding temperatures of said plurality of sub power storage devices, and</claim-text>
<claim-text>said second condition is a condition that the temperature of at least one sub power storage device of said plurality of sub power storage devices is lower than a predetermined lower limit value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The electrically powered vehicle according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein
<claim-text>said at least one sub power storage device is a remaining sub power storage device except for said selected sub power storage device out of said plurality of sub power storage devices.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The electrically powered vehicle according to <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein
<claim-text>said disconnection prohibition unit is configured to set said at least one condition as said temperature condition when said electrically powered vehicle is started, and to set only said first condition as said temperature condition after start of said electrically powered vehicle is completed.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A method for controlling a power supply system of an electrically powered vehicle incorporating a motor(MG<b>2</b>) for generating power to drive the vehicle and an inverter (<b>14</b>) for driving said motor,
<claim-text>said power supply system including
<claim-text>a main power storage device,</claim-text>
<claim-text>an electric power feeding line for feeding electric power to said inverter,</claim-text>
<claim-text>a first voltage converter provided between said electric power feeding line and said main power storage device and configured to convert voltage therebetween bidirectionally,</claim-text>
<claim-text>a plurality of sub power storage devices provided in parallel to each other,</claim-text>
<claim-text>a second voltage converter provided between said plurality of sub power storage devices and said electric power feeding line, and configured to convert voltage between a sub power storage device selected from said plurality of sub power storage devices and said electric power feeding line bidirectionally,</claim-text>
<claim-text>a connection unit provided between said plurality of sub power storage devices and said second voltage converter, and configured to connect and disconnect the selected sub power storage device to and from said second voltage converter, and</claim-text>
<claim-text>a control device configured to control connection and disconnection of said selected sub power storage device to and from said second voltage converter,</claim-text>
</claim-text>
<claim-text>said method comprising the steps of:</claim-text>
<claim-text>determining whether a request for disconnecting said selected sub power storage device from said second voltage converter should be generated based on a state of charge of said selected sub power storage device, when there is no new sub power storage device allowed to replace said selected sub power storage device; and</claim-text>
<claim-text>prohibiting generation of said request when a temperature condition based on a temperature of at least one power storage device of said main power storage device and said plurality of sub power storage devices is satisfied.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method for controlling a power supply system of an electrically powered vehicle according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein
<claim-text>said control device is configured to limit input electric power and output electric power to/from said main power storage device when a temperature of said main power storage device is out of a predetermined range,</claim-text>
<claim-text>said at least one power storage device includes said main power storage device, and</claim-text>
<claim-text>said temperature condition includes a first condition that the temperature of said main power storage device is out of said predetermined range.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method for controlling a power supply system of an electrically powered vehicle according to <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein
<claim-text>said temperature condition is at least one condition of said first condition and a second condition regarding temperatures of said plurality of sub power storage devices, and</claim-text>
<claim-text>said second condition is a condition that the temperature of at least one sub power storage device of said plurality of sub power storage devices is lower than a predetermined lower limit value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method for controlling a power supply system of an electrically powered vehicle according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein
<claim-text>said at least one sub power storage device is a remaining sub power storage device except for said selected sub power storage device out of said plurality of sub power storage devices.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method for controlling a power supply system of an electrically powered vehicle according to <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein
<claim-text>said prohibiting step includes the step of setting said temperature condition, and</claim-text>
<claim-text>said at least one condition is set as said temperature condition when said electrically powered vehicle is started, and only said first condition is set as said temperature condition after start of said electrically powered vehicle is completed. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
