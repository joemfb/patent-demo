<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625527-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625527</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11649022</doc-number>
<date>20070103</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>CN</country>
<doc-number>2004 1 0101259</doc-number>
<date>20041217</date>
</priority-claim>
<priority-claim sequence="02" kind="national">
<country>CN</country>
<doc-number>2004 1 0082358</doc-number>
<date>20041231</date>
</priority-claim>
<priority-claim sequence="03" kind="national">
<country>CN</country>
<doc-number>2005 1 0033578</doc-number>
<date>20050308</date>
</priority-claim>
<priority-claim sequence="04" kind="national">
<country>CN</country>
<doc-number>2005 1 0063705</doc-number>
<date>20050330</date>
</priority-claim>
<priority-claim sequence="05" kind="national">
<country>CN</country>
<doc-number>2005 1 0035265</doc-number>
<date>20050610</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>1571</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20090101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>W</subclass>
<main-group>80</main-group>
<subgroup>04</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>370331</main-classification>
<further-classification>455442</further-classification>
<further-classification>4554561</further-classification>
<further-classification>4554566</further-classification>
</classification-national>
<invention-title id="d2e144">Method and system for maintaining session continuity when changes occur at the terminal during a session</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6236359</doc-number>
<kind>B1</kind>
<name>Watters et al.</name>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>3423571</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6861980</doc-number>
<kind>B1</kind>
<name>Rowitch et al.</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>34235706</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6975864</doc-number>
<kind>B2</kind>
<name>Singhal et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455438</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7512336</doc-number>
<kind>B1</kind>
<name>Meli et al.</name>
<date>20090300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>398 17</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7583625</doc-number>
<kind>B2</kind>
<name>Bennett</name>
<date>20090900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370313</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2001/0009544</doc-number>
<kind>A1</kind>
<name>Vanttinen et al.</name>
<date>20010700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370338</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2001/0033563</doc-number>
<kind>A1</kind>
<name>Niemela et al.</name>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370349</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2002/0035699</doc-number>
<kind>A1</kind>
<name>Crosbie</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2003/0016654</doc-number>
<kind>A1</kind>
<name>Das et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370351</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2003/0050077</doc-number>
<kind>A1</kind>
<name>Takeuchi et al.</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455456</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2003/0103496</doc-number>
<kind>A1</kind>
<name>Lakshmi Narayanan et al.</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370352</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2004/0242227</doc-number>
<kind>A1</kind>
<name>Huotari et al.</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4554321</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2004/0246990</doc-number>
<kind>A1</kind>
<name>Krishnamurthi et al.</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370466</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2006/0126565</doc-number>
<kind>A1</kind>
<name>Shaheen</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370331</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2007/0104205</doc-number>
<kind>A1</kind>
<name>Baik</name>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>3703953</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2007/0153675</doc-number>
<kind>A1</kind>
<name>Baglin et al.</name>
<date>20070700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370216</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2007/0281699</doc-number>
<kind>A1</kind>
<name>Rasanen</name>
<date>20071200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455436</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>CN</country>
<doc-number>1545818</doc-number>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>CN</country>
<doc-number>1545818</doc-number>
<kind>A</kind>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>WO</country>
<doc-number>WO 02104057</doc-number>
<kind>A1</kind>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>WO</country>
<doc-number>2004/025930</doc-number>
<kind>A1</kind>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>WO</country>
<doc-number>WO 2004/025930</doc-number>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00023">
<othercit>Lucent Technologies White Paper, &#x201c;IP Multimedia Subsystem (IMS) Service Architecture.&#x201d; Jan. 23, 2004. XP-002407116,pp. 1-12.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00024">
<othercit>International Search Report: PCT/CN2005/002240.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00025">
<othercit>3rd Generation Partnership Project; Technical Specification Group Core Network; IP Multimedia (IM) session handling; IM call model; Stage 2, 3GPP TS 23.218 V6.2.0 (Sep. 2004) Technical Specification, Global System for Mobile Communication (56 pgs.).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00026">
<othercit>3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; IP Multimedia Subsystem (IMS); Stage 2 (Release 6), 3GPP TS 23.228 V6.7.0 (Sep. 2004), Technical Specification, Global System for Mobile Communication (180 pgs.).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00027">
<othercit>3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; IP Multimedia Subsystem (IMS); Stage 2 (Release 6), 3GPP TS 23.228 V6.9.0 (Mar. 2005), Technical Specification, Global System for Mobile Communication (179 pgs.).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00028">
<othercit>3rd Generation Partnership Project; Technical Specification Group Core Network; IP Multimedia Call Control Protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3 (Release 6), 3GPP TS 24.229 V6.4.0 (Sep. 2004), Technical Specification, Global System for Mobile Communication (299 pgs.).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00029">
<othercit>3rd Generation Partnership Project; Technical Specification Group Core Network; IP Multimedia Call Control Protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3, 3GPP TS 24.229 V6.6.0 (Mar. 2005) (Release 6), Technical Specification, Global System for Mobile Communication (291 pgs.).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00030">
<othercit>Schulzrinne et al., Application-Layer Mobility Using SIP, XP-000992003, Mobile Computing and Communications Review, vol. 5, No. 3, Jul. 2000 (11 pgs.).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00031">
<othercit>Wong et al., A Multilayered Mobility Management Scheme for Auto-Configured Wireless IP Networks, IEEE Wireless Communications, Oct. 2003 (8 pgs.).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00032">
<othercit>Shacham et al., Session Initiation Protocol (SIP) Session Mobility, Sipping, Internet-Draft, Feb. 14, 2005 (31 pgs.).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00033">
<othercit>Written Opinion of the International Searching Authority (translation) dated (mailed) Mar. 2, 2006, issued in related Application No. PCT/CN2005/002240, filed Dec. 19, 2005, Huawei Technologies Co., Ltd. (3 pgs.).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00034">
<othercit>European Patent Office Communication pursuant to Article 44a EPC, Extended European search report, supplementary European search report (Art. 157(2)(a) EPC) and the European search opinion for Application No. 05820665.7, mailed Nov. 13, 2007, Huawei Technologies C., LTD (8 pgs.).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00035">
<othercit>Sparks, The Session Initiation Protocol (SIP) Refer Method, Network Working Group, Request for Comments: 3515, Category: Standards Track, dated Apr. 2003 (23 pgs.).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00036">
<othercit>Mahy, The Session Initiation Protocol (SIP) &#x201c;Replaces&#x201d; Header, Network Working Group, Request for Comments: 3891, Category: Standards Track, dated Sep. 2004 (16 pgs.).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00037">
<othercit>Rosenberg et al., SIP: The Session Initiation Protocol, Network Working Group, Request for Comments: 3261, Category: Standards Track, Obsoletes: 2543, dated Jun. 2002 (202 pgs.).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>41</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>455422</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370331</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>18</number-of-drawing-sheets>
<number-of-figures>22</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>PCT/CN2005/002240</doc-number>
<date>20051229</date>
</document-id>
<parent-status>PENDING</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>11649022</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20080032695</doc-number>
<kind>A1</kind>
<date>20080207</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Zhu</last-name>
<first-name>Dongming</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Li</last-name>
<first-name>Hui</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Gu</last-name>
<first-name>Jiongjiong</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Zhang</last-name>
<first-name>Baofeng</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
<us-applicant sequence="005" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Huang</last-name>
<first-name>Shibi</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Zhu</last-name>
<first-name>Dongming</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Li</last-name>
<first-name>Hui</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Gu</last-name>
<first-name>Jiongjiong</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Zhang</last-name>
<first-name>Baofeng</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="005" designation="us-only">
<addressbook>
<last-name>Huang</last-name>
<first-name>Shibi</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
</inventors>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Huawei Technologies Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Kincaid</last-name>
<first-name>Lester</first-name>
<department>2646</department>
</primary-examiner>
<assistant-examiner>
<last-name>Herrera</last-name>
<first-name>Diego</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method and a system for maintaining session continuity, in which the system includes a Handover Source Function (HOSF), a Handover Destination Function (HODF), a Handover Anchor Function-Control Plane (HOAF-CP) and a Handover Anchor Function-User Plane (HOAF-UP). The method includes a first user establishing a connection through the HOSF with the HOAF-CP and the HOAF-UP which correspond to a second user, so as to establish a session with the second user. The method further includes that, during session handover, the HODF that corresponds to the HOSF establishing another connection with the HOAF-CP and HOAF-UP though which the first user continues the session with the second user, so as to maintain the session continuity. When access address or access technology of the terminal changes, or even the terminal changes during a session, the method and the system can logically replace the connection before the handover with a new connection to ensure the session continuity.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="43.43mm" wi="98.47mm" file="US08625527-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="191.01mm" wi="164.08mm" file="US08625527-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="170.77mm" wi="127.59mm" file="US08625527-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="173.65mm" wi="148.42mm" file="US08625527-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="156.21mm" wi="159.09mm" file="US08625527-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="141.99mm" wi="180.85mm" file="US08625527-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="179.24mm" wi="160.53mm" file="US08625527-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="225.38mm" wi="156.72mm" file="US08625527-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="149.94mm" wi="163.07mm" file="US08625527-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="163.07mm" wi="157.82mm" file="US08625527-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="187.20mm" wi="171.70mm" file="US08625527-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="165.02mm" wi="160.19mm" file="US08625527-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="195.66mm" wi="160.78mm" file="US08625527-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="181.86mm" wi="157.82mm" file="US08625527-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="186.01mm" wi="159.34mm" file="US08625527-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="212.77mm" wi="160.44mm" file="US08625527-20140107-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="99.82mm" wi="152.99mm" file="US08625527-20140107-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="154.52mm" wi="141.65mm" file="US08625527-20140107-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="80.60mm" wi="79.42mm" file="US08625527-20140107-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCES</heading>
<p id="p-0002" num="0001">This application is a continuation of International Application No. PCT/CN2005/002240, filed on Dec. 19, 2005, which claims priority to Chinese Patent Application No. 200410101259.1, filed on Dec. 17, 2004, Chinese Patent Application No. 200410082358.X, filed on Dec. 31, 2004, Chinese Patent Application No. 200510033578.8, filed on Mar. 8, 2005, Chinese Patent Application No. 200510063705.9, filed on Mar. 30, 2005, and Chinese Patent Application No. 200510035265.6, filed on Jun. 10, 2005.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to communication technologies, more particularly to a method and a system for maintaining session continuity when a user changes access address or access technology of a terminal, or even changes the terminal in a session.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">As communication and information technology rockets now, and along with the maturation of Internet Protocol (IP) technology, the application of the Internet spreads rapidly. People are no longer satisfied with monotonous voice communications. Instead, they demand brand new multimedia communications. At the same time, mobile communication networks and fixed communication networks still serve as the main communication medium. Therefore, it is acknowledged in the industry that it is the trend that the mobile communication network and the fixed communication network will develop towards IP and the Internet will merge with the telecommunication network. In other words, an IP multimedia communication system which supports multiple access technologies is a focus of the future development in the industry. An IP Multimedia Subsystem (IMS) and a Next Generation Network (NGN) are just the kind of networks which support multiple access technologies while implementing IP multimedia applications.</p>
<p id="p-0005" num="0004">The IMS is a network subsystem introduced by the 3<sup>rd </sup>Generation Partnership Project (3GPP) on the basis of a Universal Mobile Telecommunications System (UMTS) Packet Switched (PS) domain to achieve IP multimedia communication control. The IMS supports multiple access technologies, shields user access technology, controls the openness of service capability and provides IP multimedia communication experience based on customized user data. The IMS employs the UMTS PS domain or other IP access networks as a bearer for upper layer control signaling and media transmission. Major functional entities in the IMS include: a Call Session Control Function (CSCF) for controlling user registrations and sessions, an Application Server (AS) for providing various service logic control functions, a Home Subscriber Server (HSS) for centralized administration of subscription data, and a Multimedia Gateway Control Function/IM Multimedia Gateway Function (MGCF/IM-MGW) for interworking with a Circuit Switched (CS) network. In the IMS, a user accesses the IMS through a Proxy-CSCF (P-CSCF), which is a proxy node in a visited network where the user is currently located. While the session and service triggering control and the service control interaction with the AS are performed by a Service-CSCF (S-CSCF), which is a service node in a home network of the user.</p>
<p id="p-0006" num="0005">The IMS provides IMS users with IP multimedia value-added services through various ASs. In the IMS, services are triggered based on an initial Filter Criteria (iFC) evaluation. The iFC is a major part of the user subscription data saved in the HSS and downloaded by the S-CSCF assigned to the user during registration. The iFCs with different priority levels defines different service triggering conditions and corresponding destination ASs. The S-CSCF compares a service request received from or sent to a user it serves with the service triggering conditions in the iFCs one by one according to their priorities. If the service request matches the service triggering condition in an iFC, the service request will be sent to the corresponding AS defined by this iFC. If the service request does not match the service triggering conditions in the iFCs, the S-CSCF continues the evaluation of the next iFC in the descending priority sequence. Or, if the service request matches the service triggering condition in an iFC and is sent to the corresponding AS and the AS returns the service request to the S-CSCF, the S-CSCF also continues the evaluation of the next iFC in the descending priority sequence. After finishing the evaluation of all the iFCs, the S-CSCF sends the service request to a next network node according to a destination identifier in the service request. In this method, services are triggered according to uniform filter criteria which are independent with specific service. Thus the processing model employed by the IMS service node S-CSCF can be shared and reused by various services, so that the IMS architecture is able to provide rich and various customized services through various ASs.</p>
<p id="p-0007" num="0006">The NGN is a convergent network based on packet technologies, mainly adopting packet switched technologies and employing a bearer/control separated architecture. The NGN inherits all the services of the previous fixed network as well as some of the mobile network. The NGN integrates advantages of the fixed network, the mobile network and the IP network so as to allow users, such as analog users, digital users, mobile users, Asymmetrical Digital Subscriber Line (ADSL) users, Integrated Service Digital Network (ISDN) users, IP narrow-band network users, IP broadband network users and even satellite users, to communicate with each other in the NGN.</p>
<p id="p-0008" num="0007">Both the IMS and the NGN adopt a Session Initiation Protocol (SIP) as their session control protocols. The SIP is one of the multimedia communication system frame protocols defined by Internet Engineering Task Force (IETF), and is an application layer protocol for the establishment, modification and termination of a multimedia session. Since the SIP is based on published Internet standards and is innately advantageous with respect to the combination and interworking of a voice service and a data service, it can implement session controls across media and equipment and support varieties of media formats. It should be noted that the SIP supports interaction between two participants of a session to exchange Session Description Protocol (SDP) descriptions of the media streams desired to be exchanged in an offer/answer mode during a session establishment, so as to accomplish a negotiation of the exchanged media streams in the session. In an established session, a participant can also exchange the SDP description to change the media stream desires to be exchanged by re-negotiation, i.e., using the offer/answer mode again, to dynamically add/delete media streams or modify the attribute of the exchanged media streams. In this way, it is easier to present abundant multimedia service features. At the same time, the SIP supports pushing the intelligence towards applications and terminals and so as to relieve the burden of the network. The SIP also supports application layer mobility capability including dynamic registration, location management, and re-direction mechanisms, as well as the Presence capability (determining the specific communication means according to the location and status of the user), Fork capability (an ability to perform serial attempt or parallel forwarding a service request to multiple valid contact address registered to a destination identifier), and Subscribe and Notify mechanism, which makes it facilitated for the deployment of new services. Moreover, the SIP is a simple protocol with recognized extension potential and is thus widely applied in networks including the IMS and the NGN.</p>
<p id="p-0009" num="0008">In the IMS and the NGN, a user can access the network through a multi-mode terminal, or through different terminals, via access networks of different access technologies, and obtain uniform multimedia services according to his/her subscription.</p>
<p id="p-0010" num="0009">In the IMS and the NGN, a user binds his/her current terminal contact address and service identifier (which is the user's IP Multimedia Public identity (IMPU) in the IMS) through registration. Therefore, during a registration period, there should be a unique access address corresponding to the service identifier of the user. In order words, once the access address changes, the user needs a re-registration, and the original access address will be deleted, and the on-going session will be released if no special processing is performed in the service layer. Therefore, when a user in a session needs to change his/her Access Point (AP) or access technology which further result in the change of the access address, or even change the terminal, the problem of maintaining session continuity emerges.</p>
<p id="p-0011" num="0010">On the other hand, a voice call to a peer user (e.g., a subscriber of the IMS or the NGN) can be either established as a Voice over IP (VoIP) call using an end-to-end IP bearer under the control of the IMS/NGN, or directly established as an interworking call between traditional CS domain and the IMS/NGN. Some access technologies through which the terminal accesses the IMS or the NGN belong to hot spot coverage technologies (e.g., Wireless Local Access Network (WLAN)). When a user accesses IMS/NGN through the WLAN to initiate a VoIP call, if the user roams out of the hot spot coverage of the WLAN, the network connection will be lost. At this time, if the user can change to access the CS domain through Wideband Code Division Multiple Access (WCDMA) which usually implemented with wide, continuous coverage to continue the session with the peer user, the session continuity will be well kept. Similarly, a WCDMA system, which is designed to cover wide areas continuously, may fail to provide high quality wireless connection in some buildings due to penetration loss of wireless signals, while hot spot coverage technologies, represented by the WLAN, are able to fill the coverage holes emerged here. In other words, if the user changes a CS voice call to an IMS VoIP session through the WLAN access when he moves into such a coverage hole of WCDMA, the session continuity will be well kept. Considering that the call between the user and the peer IMS/NGN user through the CS domain actually includes a CS call connection from the user to an interworking gateway between the CS domain and the IMS/NGN, and a SIP session from the interworking gateway between the CS domain and the IMS/NGN to the called IMS/NGN user. A CS call, which is converted to an IMS/NGN session through the interworking gateway, can be regarded as a special access means to the IMS/NGN from the point of view of the IMS/NGN. So the problem of maintaining session continuity when a terminal changes access means in an IMS/NGN session should also be taken into consideration to better guarantee the session continuity.</p>
<p id="p-0012" num="0011">There exists a possible solution to guarantee the session continuity, i.e., Unlicensed Mobile Access (UMA).</p>
<p id="p-0013" num="0012">The UMA standards are a set of published specifications jointly developed by a number of leading operators and vendors within the wireless industry. The UMA standards enable a terminal to access a cellular network and acquire services of the cellular network through unlicensed spectrum access technologies such as WLAN and Bluetooth (BT), and eventually enable a dual-mode terminal to roam and handover between the cellular network and the unlicensed spectrum wireless network.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic diagram illustrating a process of maintaining session continuity through the UMA standards according to the prior art. As shown in <figref idref="DRAWINGS">FIG. 1</figref>, a UMA network controller (UNC), whose network location is similar to that of a Base Station Controller (BSC) or a Radio Network Controller (RNC) in the cellular network, is added in advance into the unlicensed spectrum wireless network, e.g., the WLAN. The added UNC is used for providing an interface with the core network just like that provided by the BSC/RNC in cellular network. Therefore the core network may regard the unlicensed spectrum wireless network as a normal cellular access network. When a terminal roams and handovers between the cellular network and the unlicensed spectrum wireless network, handover between the two networks are implemented through the interaction among the core network, the UNC in the unlicensed spectrum wireless networks and a corresponding entity, such as the BSC, in the cellular network.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0015" num="0014">The present invention provides a method and a system for maintaining session continuity, when access address of a terminal is changed as a result of alteration of Access Point (AP), access technology, access means or a terminal used by a user, the method and system provided by the present invention may logically replace an original session connection established before a handover with a new session connection established after the handover to guarantee the session continuity.</p>
<p id="p-0016" num="0015">The present invention provides the following technical schemes:</p>
<p id="p-0017" num="0016">A method for maintaining session continuity, wherein there exists a correlated relationship between a Handover Source Function (HOSF) and a Handover Destination Function (HODF) of a first user, including:</p>
<p id="p-0018" num="0017">Step A: the first user establishing a session with a second user via a first connection through the HOSF, including a control plane first connection with a Handover Anchor Function-Control Plane (HOAF-CP) and a user plane first connection with a Handover Anchor Function-User Plane (HOAF-UP);</p>
<p id="p-0019" num="0018">Step B: when it is detected that a handover condition is satisfied, the HODF that corresponds to the HOSF establishing a second connection, including a control plane second connection and a user plane second connection, respectively with the HOAF-CP and the HOAD-UP;</p>
<p id="p-0020" num="0019">Step C: the first user continuing the session with the second user through the second connection.</p>
<p id="p-0021" num="0020">A system for maintaining session continuity includes: an HOSF, an HODF, an HOAF-CP, an HOAF-UP and a Handover Detection Function; wherein,</p>
<p id="p-0022" num="0021">there exists a corresponding relationship between the HOSF and the HODF; and</p>
<p id="p-0023" num="0022">the HOSF is used for establishing a session control plane first connection with the HOAF-CP and a session user plane first connection with the HOAF-UP when the first user initiates or accepts a session;</p>
<p id="p-0024" num="0023">the HODF is used for establishing a session control plane second connection with the HOAF-CP and a session user plane second connection with the HOAF-UP when the handover condition is satisfied;</p>
<p id="p-0025" num="0024">the HOAF-CP is used for establishing the control plane first connection with the HOSF when the first user initiates or accepts a session; establishing the control plane second connection with the HODF when the handover condition is satisfied; replacing the control plane first connection with the HOSF with the control plane second connection with the HODF, and indicating the HOAF-UP to replace the user plane first connection between the HOAF-UP and the HOSF with the user plane second connection between the HOAF-UP and the HODF;</p>
<p id="p-0026" num="0025">the HOAF-UP is used for establishing the user plane first connection with the HOSF when the first user initiates or accepts a session; establishing the user plane second connection with the HODF when the handover condition is satisfied; and replacing the user plane first connection with the HOSF with the user plane second connection with the HODF according to the indication of the HOAF-CP;</p>
<p id="p-0027" num="0026">the Handover Detection Function is used for detecting whether the handover condition is satisfied.</p>
<p id="p-0028" num="0027">The present invention provides a method and a system on the service layer for maintaining session continuity in a network that supports multiple access technologies. The method, the two connections before and after the handover are swapped logically on the service layer while the connection after the handover is established, therefore the session usability after the handover is guaranteed, the session continuity is kept and the service experience of users is enhanced.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic diagram illustrating a procedure of maintaining session continuity through UMA standards according to the prior art;</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 2A</figref> is a schematic diagram illustrating a system when performing a session handover in a terminal-controlled mode according to an embodiment of the present invention;</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 2B</figref> is a schematic diagram illustrating a system when performing a session handover in a network-controlled mode according to an embodiment of the present invention;</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 3A</figref> is a block diagram logically illustrating a system when performing a session handover in an end-to-end/terminal-controlled mode according to an embodiment of the present invention;</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 3B</figref> is a block diagram logically illustrating a system when performing a session handover in an end-to-end/network-controlled mode according to an embodiment of the present invention;</p>
<p id="p-0034" num="0033">FIG. <b>3</b>C<b>1</b> is a block diagram logically illustrating a system when performing a session handover in a CP-segmented/terminal-controlled mode or a CP-segmented/network-controlled mode according to an embodiment of the present invention;</p>
<p id="p-0035" num="0034">FIG. <b>3</b>C<b>2</b> is a block diagram logically illustrating a system when performing a session handover in a CPandUP-segmented/terminal-controlled mode or a CPandUP-segmented/network-controlled mode according to an embodiment of the present invention;</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 4</figref> is a schematic diagram illustrating connection relationships when an IMS session is transferred to a CS call;</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 5A</figref> is a flowchart illustrating a handover in an end-to-end/terminal-controlled mode according to an embodiment of the present invention, while the HODF initiates the performing of the handover;</p>
<p id="p-0038" num="0037">FIG. <b>5</b>B<b>1</b> is a flowchart illustrating a handover according to the structure of the <figref idref="DRAWINGS">FIG. 3B</figref>;</p>
<p id="p-0039" num="0038">FIG. <b>5</b>B<b>2</b> is a flowchart illustrating a procedure of the handover UE establishing a new connection for the handover under the control of a service control point based on the structure of <figref idref="DRAWINGS">FIG. 3B</figref> according to an embodiment of the present invention;</p>
<p id="p-0040" num="0039">FIG. <b>5</b>B<b>3</b> is a flowchart illustrating a handover in an end-to-end/network-controlled mode while the HODF initiates the performing of the handover according to the structure of <figref idref="DRAWINGS">FIG. 3B</figref>;</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 5C</figref> is a flowchart illustrating a handover in a CP-segmented mode while the HODF initiates the performing of the handover according to an embodiment of the present invention;</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 5D</figref> is a flowchart illustrating a handover in a CPandUP-segmented mode while the HOAF initiates the performing of the handover according to an embodiment of the present invention;</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 6A</figref> is a flowchart illustrating a procedure of delivering a call from a third user to the HODF in the handover UE while an IM Public user identity (IMPU) of the handover user is shared by the HOSF and the HODF according to an embodiment of the present invention;</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 6B</figref> is a flowchart illustrating a procedure of delivering a call from a third user to the HODF in the handover UE while the IMPU of the handover user is not shared by the HOSF and the HODF according to an embodiment of the invention;</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 7A</figref> is a flowchart illustrating a CS-IMS handover in an end-to-end/terminal-controlled mode according to an embodiment of the present invention;</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 7B</figref> is a flowchart illustrating a CS-IMS handover in a CP-segmented/terminal-controlled mode when the peer user also is located in a CS domain according to an embodiment of the invention;</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 7C</figref> is a flowchart illustrating an IMS-CS handover in a CP-segmented/terminal-controlled mode according to an embodiment of the present invention;</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 8</figref> is a schematic diagram illustrating a system implementing an IMS-IMS handover when access networks of the HOSF and HODF are different;</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 9</figref> is a schematic diagram illustrating a system implementing an IMS-CS handover in a CP-segmented mode;</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 10</figref> is a schematic diagram illustrating a structure of a UE in which a Handover Detection Function is configured according to an embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0051" num="0050">The present invention will be described in detail hereinafter with reference to embodiments and accompanying drawings.</p>
<p id="p-0052" num="0051">Inventor of the present invention found that the solution of the existing UMA standards may have the following disadvantages:</p>
<p id="p-0053" num="0052">1. The UMA is just a solution on the access network layer without processes such as IP address allocation, so it is impossible for a terminal to keep a same IP address when it moves. During the movement of the terminal, if the IP address allocated to the terminal changes for some networking factors, it is impossible to avoid new address registration and old address de-registration in the application layer, and session interrupt brought by the registration and de-registration, thus it is impossible to guarantee session continuity.</p>
<p id="p-0054" num="0053">2. The UMA only provides a handover solution on the access network layer; in other words, it assigns new wireless resources to the terminal after the handover to maintain the continuity access to the network. But the UMA does not give consideration to the bandwidth differences of different access technologies, and it has no corresponding necessary process in the application layer, such as necessary media attribute modification, Quality of Service (QoS) guarantee, etc. Therefore, in practical service implementations, it is impossible to guarantee session continuity.</p>
<p id="p-0055" num="0054">3. When the user changes his/her access means to the IMS during a session, i.e., changes between &#x201c;interworking access to the IMS from the CS domain&#x201d; and &#x201c;direct access to the IMS through varieties of IP access networks&#x201d;, since the control signaling between the user and the network are completely different in these two access means, the UMA on access network layer is not able to solve this problem.</p>
<p id="p-0056" num="0055">4. The UNC is a brand new product with brand new technology, the development of the UNC requires much work, and the terminal also needs to include corresponding protocol support. Still under development, the UNC technology and product are immature and some time away from wide application.</p>
<p id="p-0057" num="0056">As described above, both the IMS and the NGN are networks that support multiple access technologies and provide IP multimedia services, and the embodiments of the present invention are applicable to both the IMS and the NGN. However, to simplify the description, the following paragraphs describe the embodiments of the invention in the IMS network only, and the differences in the NGN are explicated at the end of the description to demonstrate the feasibility of the embodiments of the present invention in the NGN.</p>
<p id="p-0058" num="0057">The embodiments of the present invention are applicable to various cases when a handover user accesses to the IMS, including direct access through different IP access networks and interworking access through a CS domain, and provide a handover mechanism to maintain session continuity. The application of the embodiments of the present invention is independent of the network of the peer user. In other words, the peer user can be located in an IMS network or a CS domain/Public Switched Telephone Network (PSTN). When the peer user is located in the CS domain/PSTN, the home IMS network of the handover user selects an interworking gateway according to the standard IMS-CS interworking mechanism to implement an interworking call with the peer user. Therefore, to fit in different cases when the peer user is located in different networks, in embodiments of the present invention, all the descriptions are towards the terminal side of the peer user from the point of view of the IMS/NGN. The &#x201c;terminal side of the peer user&#x201d; has different meanings when the location of the peer user differs: when the peer user accesses to the IMS/NGN via different IP access networks, the terminal side of the peer user refers to the peer User Equipment (UE); when the peer user is located in the CS domain/PSTN, the terminal side of the peer user includes the peer UE, an interworking gateway for interworking with the network where the peer user are located, and a CS connection between the peer UE and the interworking gateway.</p>
<p id="p-0059" num="0058">The session handover of a UE can be controlled by the UE itself. Preferably, the session handover can also be controlled by the network to guarantee the legality and reliability of the session handover.</p>
<p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. 2A</figref> is a schematic diagram illustrating a system when performing a session handover in a terminal-controlled mode according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 2A</figref>, when the session handover is performed in the terminal-controlled mode, the system, which is applicable to a network supporting multiple access technologies, includes at least: an HOSF, an HODF, an HOAF and a Handover Detection Function. The HOSF and the HODF have a correlated relationship with each other. The HOAF includes a control plane and a user plane, i.e., an HOAF-CP and an HOAF-UP. The HOSF and the HODF are directly connected with the HOAF-CP and the HOAF-UP respectively. The connection between the HOSF and the HOAF-CP and the connection between the HOSF and the HOAF-UP respectively correspond to the control plane connection and the user plane connection established before the handover. The two connections are illustrated with dotted lines. The connection between the HODF and the HOAF-CP and the connection between the HODF and the HOAF-UP respectively correspond to the control plane connection and the user plane connection established after the handover, and they are illustrated with solid lines.</p>
<p id="p-0061" num="0060">The connection between the HOSF and the HOAF is referred to as the first connection hereinafter, the connection between the HOSF and the HOAF-CP is referred to as the control plane first connection, and the connection between the HOSF and the HOAF-UP is referred to as the user plane first connection. The connection between the HODF and the HOAF is referred to as the second connection hereinafter, the connection between the HODF and the HOAF-CP is referred to as the control plane second connection, and the connection between the HODF and the HOAF-UP is referred to as the user plane second connection.</p>
<p id="p-0062" num="0061">The HOSF is used for establishing a control plane first connection with the HOAF-CP and a user plane first connection with the HOAF-UP when the first user initiates or accepts a session.</p>
<p id="p-0063" num="0062">The HODF is used for establishing a control plane second connection with the HOAF-CP and a user plane second connection with the HOAF-UP when the handover condition is satisfied.</p>
<p id="p-0064" num="0063">The HOAF-CP is used for establishing a control plane first connection with the HOSF when the first user initiates or accepts a session; establishing a control plane second connection with the HODF when the handover condition is satisfied; replacing the control plane first connection with the HOSF with the control plane second connection with the HODF, and indicating the HOAF-UP to replace the user plane first connection between the HOAF-UP and the HOSF with the user plane second connection between the HOAF-UP and the HODF.</p>
<p id="p-0065" num="0064">The HOAF-UP is used for establishing a user plane first connection with the HOSF when the first user initiates or accepts a session; establishing a user plane second connection with the HODF when the handover condition is satisfied; and replacing the user plane first connection with the HOSF with the user plane second connection with the HODF according to the indication of the HOAF-CP.</p>
<p id="p-0066" num="0065">The Handover Detection Function is used for detecting whether the handover condition is satisfied and triggering a handover when the handover condition is satisfied. The Handover Detection Function can be implemented as an independent physical entity, or as a logical entity in the HOSF or the HODF.</p>
<p id="p-0067" num="0066">When the Handover Detection Function is implemented as a logical entity in the HODF, the working principle of the system is: the HODF detects whether the handover condition is satisfied, if the handover condition is satisfied, the HODF sends a connection establishment request to the HOAF-CP, the HOAF-CP interacts with the HODF after receiving the connection establishment request to establish a new session link, i.e., the second connection.</p>
<p id="p-0068" num="0067">When the Handover Detection Function is implemented as a logical entity in the HOSF, the working principle of the system is: the HOSF detects whether the handover condition is satisfied, when the handover condition is satisfied, the HOSF sends a handover indication to the HODF or the HOAF-CP. If the HOSF sends the handover indication to the HODF, the HODF sends a connection establishment request to the HOAF-CP after receiving the handover indication; the HOAF-CP interacts with the HODF after receiving the connection establishment request to establish a new session link, i.e., the second connection. If the HOSF sends the handover indication to the HOAF-CP, the HOAF-CP sends a connection establishment request to the HODF after receiving the handover indication; the HODF interacts with the HOAF-CP after receiving the connection establishment request to establish a new session link.</p>
<p id="p-0069" num="0068">After establishing the second connection with the HODF, the HOAF-CP and the HOSF release the first connection between them, and the two users can continue the session through the second connection.</p>
<p id="p-0070" num="0069">Moreover, in order to maintain the media exchange continuity better during the handover, the HOAF-UP may also be equipped with media stream duplication and filtering functions, i.e., the HOAF-UP duplicates the media stream to the handover user and sends the media stream to the HOSF and the HODF simultaneously, filters the media streams from the HOSF and the HODF, selects a valid part and send the selected valid part to the terminal side of the peer user or present to the peer user.</p>
<p id="p-0071" num="0070">The functions of the entities in the system shown in <figref idref="DRAWINGS">FIG. 2A</figref> are implemented in the end-to-end/terminal-controlled mode, which is shown in <figref idref="DRAWINGS">FIG. 3A</figref>, and in the segmented/terminal-controlled mode (including the CP-segmented mode shown in FIG. <b>3</b>C<b>1</b> and the CPandUP-segmented mode shown in FIG. <b>3</b>C<b>2</b>).</p>
<p id="p-0072" num="0071"><figref idref="DRAWINGS">FIG. 2B</figref> is a schematic diagram illustrating a system when performing a session handover in a network-controlled mode according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 2B</figref>, when the session handover is performed in the network-controlled mode, the system includes not only the HOSF, HODF, HOAF-CP, HOAF-UP and the Handover Detection Function, which are shown in <figref idref="DRAWINGS">FIG. 2A</figref>, but also an HOCF. The HOSF and the HODF are directly connected with the HOAF-CP and the HOAF-UP respectively, wherein the connection between the HOSF and the HOAF-CP and the connection between the HOSF and the HOAF-UP respectively correspond to the control plane connection and user plane connection established before the handover, and are illustrated with dotted lines. The connection between the HODF and the HOAF-CP and the connection between the HODF and the HOAF-UP respectively correspond to the control plane connection and the user plane connection established after the handover. The two connections are illustrated with solid lines. Meanwhile, the HOCF is respectively connected with the HOSF, the HODF and the HOAF-CP to illustrate the control and interaction relationships between them.</p>
<p id="p-0073" num="0072">In the system shown in <figref idref="DRAWINGS">FIG. 2B</figref>, besides the functions shown <figref idref="DRAWINGS">FIG. 2A</figref>, the HOSF, HODF, HOAF-CP, HOAF-UP and the Handover Detection Function may also have other functions. The function of the HOSF may also include: sending a handover request to the HOCF and processing an authorization result returned from the HOCF. The function of the HODF may also include: sending a handover request to the HOCF and processing an authorization result returned from the HOCF.</p>
<p id="p-0074" num="0073">The HOCF is used for forwarding signal streams between the HOSF and the HOAF, and used for centralized management of handover strategies to perform handover authorization, and further for acquiring relevant information by performing signaling interactions with the handover UE in order to update the handover strategies saved in the HOCF.</p>
<p id="p-0075" num="0074">The functions of the Handover Detection Function in <figref idref="DRAWINGS">FIG. 2B</figref> are the same with those shown in <figref idref="DRAWINGS">FIG. 2A</figref>: when the handover condition is satisfied, the Handover Detection Function triggers the handover. When the Handover Detection Function is a logical entity, it can be set not only in the HOSF or the HODF, but also in the HOCF. When the Handover Detection Function is set in the HOCF, the HOCF is able to perform signaling interactions with the handover UE to update the handover detection condition saved in the HOCF.</p>
<p id="p-0076" num="0075">As shown in the structure illustrated in <figref idref="DRAWINGS">FIG. 2A</figref>, the second connection can be initiated by the HODF or the HOAF. Therefore, based on the structure shown in <figref idref="DRAWINGS">FIG. 2B</figref>, no matter the Handover Detection Function is set in the HOSF, the HODF or the HOCF, as long as a handover indication is sent to either the HODF or the HOAF-CP when the handover condition is satisfied, and the HODF or the HOAF-CP which receives the handover indication sends a second connection establishment request to the peer side, after interactions between the HODF and the HOAF-CP, a new session link, i.e., the second connection, can be established.</p>
<p id="p-0077" num="0076">For example, when the Handover Detection Function is a logical entity in the HOCF, the working principle of the system is: the HOSF establishes a control plane first connection and a user plane first connection respectively with the HOAF-CP and the HOAF-UP. When the HOCF detects that the handover condition is satisfied, it can send a handover indication to the HOAF-CP, the HOSF or the HODF. If the handover indication is sent to the HOAF-CP, the HOAF-CP initiates a connection establishment request to the HODF after receiving the handover indication, and interacts with the HODF to establish a second connection. If the handover indication is sent to the HODF, the HODF initiates a connection establishment request to the HOAF-CP after receiving the handover indication, and interacts with the HOAF-CP to establish a second connection; If the handover indication is sent to the HOSF, the HOSF sends a handover indication message to the HODF after receiving the handover indication, the HODF initiates a connection establishment request to the HOAF-CP after receiving the handover indication message, and interacts with the HOAF-CP to establish a second connection.</p>
<p id="p-0078" num="0077">After establishing the second connection with the HODF, the HOAF-CP and the HOSF release the first connection between them, and the two users can continue their conversation through the second connection.</p>
<p id="p-0079" num="0078">The functions of the entities in the system shown in <figref idref="DRAWINGS">FIG. 2B</figref> are implemented in the end-to-end/network-controlled mode, which is shown in <figref idref="DRAWINGS">FIG. 3B</figref>, and in the segmented/network-controlled mode, which is shown in <figref idref="DRAWINGS">FIG. 3C</figref>.</p>
<p id="p-0080" num="0079">The HOSF and the HODF in the system may be located in a same terminal or different terminals of the handover user (also referred to as the first user herein), and accordingly, they can be different access modules in a same terminal of the handover user, or access modules in different terminals of the handover user. To simplify the description, the HOSF and the HODF are described hereinafter to be in the handover UE, including two situations above.</p>
<p id="p-0081" num="0080">As shown in <figref idref="DRAWINGS">FIG. 10</figref>, as the handover UE used in an embodiment of the present invention, when the HOSF and the HODF are implemented in a same terminal of the handover user and the Handover Detection Function is set as a logical entity in the HOSF, the handover UE may include a Handover Processing Unit and a Handover Detection Function. The Handover Detection Function includes a Handover Trigger Condition Detection Unit and a Handover Request Unit.</p>
<p id="p-0082" num="0081">The Handover Trigger Condition Detection Unit can monitor continuously and trigger a handover according to various conditions. For example, it can continuously check the quality of the received radio signal (e.g., signal intensity). When the quality degrades to a pre-configured handover threshold, it automatically searches whether there is a wireless network of the same type as the current radio coverage. If there is not any network of the same type, it continues to search whether there are other types of wireless networks covering the area, selects a new radio access network and triggers a handover. Thus a radio access network of the same type is a preferable choice, and when there is no such network, other usable access networks are selected based on a pre-configured priority order (usually set in an ascending order according to access charging rate).</p>
<p id="p-0083" num="0082">The Handover Request Unit is used for initiating a handover request to the network. For example, after the HODF newly accesses to the network and obtains a new IP address (the IP address is obtained from different places according to different types of access networks, e.g., in a General Packet Radio Service (GPRS) network, it is obtained from a Gateway GPRS Support Node (GGSN)), registers the new IP address on a register server through the new access network, and initiates a handover request through SIP signaling via the new access network.</p>
<p id="p-0084" num="0083">The Handover Processing Unit, used for supporting special processing on a signaling plane during the session handover, e.g., interacting with the HOAF-CP to establish the second connection, or avoiding ringing (i.e., avoiding responding <b>180</b>), etc.</p>
<p id="p-0085" num="0084">In addition, the HOAF-CP and the HOAF-UP in the system may have different locations: the HOAF-CP and the HOAF-UP may be both located on the terminal side of the peer user (also referred to as the second user herein); or the HOAF-CP may be located on the home network side of the handover user while the HOAF-UP is located on the terminal side of the peer user; or the HOAF-CP and the HOAF-UP may be both located on the home network side of the handover user.</p>
<p id="p-0086" num="0085">When the HOAF-CP and the HOAF-UP are both located on the terminal side of the peer user, the session between the handover user and the peer user is born only by the control plane connection between the HOSF or the HODF in the handover UE and the HOAF-CP and the user plane connection between the HOSF or the HODF in the handover UE and the HOAF-UP respectively. This mode is hereinafter referred to as an end-to-end mode.</p>
<p id="p-0087" num="0086">If the HOAF-CP is located on the home network side of the handover user and the HOAF-UP is located on the terminal side of the peer user, on the control plane, the session between the handover user and the peer user needs to be born by two segments of connections, one is the connection between the HOSF or the HODF and the HOAF-CP, i.e., the control plane first connection or the control plane second connection, and the other is the control plane connection between the HOAF-CP and the terminal side of the peer user. As the HOAF-UP is on the terminal side of the peer user, on the user plane, the session between the handover user and the peer user is still born by the end-to-end user plane first or second connection. This mode is hereinafter referred to as a CP-segmented mode.</p>
<p id="p-0088" num="0087">If the HOAF-CP and the HOAF-UP are both located on the home network side of the handover user, besides the control plane and user plane first connection and the second connection with the HOSF and the HODF of the handover user respectively, the HOAF needs to establish another control plane connection and user plane connection with the terminal side of the peer user. The session between the handover user and the peer user in such a situation is born by two segments of connections on both control plane and user plane. To be specific, one segment is the control plane and user plane first connections or the control plane and user plane second connections, the other segment is the control plane and user plane connections between the HOAF and the terminal side of the peer user. This mode is hereinafter referred to as a CPandUP-segmented mode.</p>
<p id="p-0089" num="0088">The structure of the system will be described in detail hereinafter with reference to the embodiments in the terminal-controlled mode and in the network-controlled mode respectively, wherein the session is born in the end-to-end mode, CP-segmented mode or CPandUP-segmented mode.</p>
<p id="p-0090" num="0089">Corresponding to <figref idref="DRAWINGS">FIG. 2A</figref>, <figref idref="DRAWINGS">FIG. 3A</figref> is a block diagram logically illustrating a system when performing a session handover in an end-to-end/terminal-controlled mode according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 2A</figref> and <figref idref="DRAWINGS">FIG. 3A</figref>, when the session handover is performed in the end-to-end/terminal-controlled mode, the HOSF and the HODF are located in the handover UE; the HOAF-CP and the HOAF-UP are located on the terminal side of the peer user. The service implementation mode corresponding to the system logic shown in <figref idref="DRAWINGS">FIG. 3A</figref> is the end-to-end/terminal-controlled mode.</p>
<p id="p-0091" num="0090">Corresponding to <figref idref="DRAWINGS">FIG. 2B</figref>, <figref idref="DRAWINGS">FIG. 3B</figref> is a block diagram logically illustrating a system when performing a session handover in an end-to-end/network-controlled mode according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 2B</figref> and <figref idref="DRAWINGS">FIG. 3B</figref>, the HOSF and the HODF are located in the handover UE, the HOCF is located on the home network side of the handover user, and the HOAF-CP and the HOAF-UP are both located on the terminal side of the peer user. The service implementation mode corresponding to the system logic shown in <figref idref="DRAWINGS">FIG. 3B</figref> is the end-to-end/network-controlled mode.</p>
<p id="p-0092" num="0091">Corresponding to <figref idref="DRAWINGS">FIG. 2A</figref> or <b>2</b>B, FIG. <b>3</b>C<b>1</b> is a block diagram logically illustrating a system when performing a session handover in a CP-segmented/terminal-controlled mode or a CP-segmented/network-controlled mode according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 2A</figref>, <b>2</b>B and FIG. <b>3</b>C<b>1</b>, the HOSF and the HODF are located in the handover UE, the HOCF and the HOAF-CP are located on the home network side of the handover user, and the HOAF-UP is located on the terminal side of the peer user; besides the control plane first connection and control plane second connection established respectively with the HOSF and the HODF before and after the handover, a control plane connection is also established by the HOAF-CP with the terminal side of the peer user. The service implementation mode corresponding to the system logic shown in FIG. <b>3</b>C<b>1</b> is the CP-segment mode; when the HOCF, shown with dotted lines, is included in the system, the system works in the network-controlled mode, otherwise, the system works in the terminal-controlled mode.</p>
<p id="p-0093" num="0092">Corresponding to the system shown in <figref idref="DRAWINGS">FIGS. 2A and 2B</figref>, FIG. <b>3</b>C<b>2</b> is a block diagram logically illustrating a system when performing a session handover in a CPandUP-segmented mode according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 2A</figref>, <b>2</b>B and FIG. <b>3</b>C<b>2</b>, the HOSF and the HODF are located in the handover UE, the HOCF, HOAF-CP and HOAF-UP are located on the home network side of the handover user; besides the control plane and user plane first connection and second connection established before and after the handover with the HOSF and the HODF respectively, a control plane connection and a user plane connection are also established respectively by the HOAF-CP and the HOAF-UP with the terminal side of the peer user. The service implementation mode corresponding to the system logic as shown in FIG. <b>3</b>C<b>2</b> is the CPandUP-segment mode; when the HOCF, shown with dotted lines, is included in the system, the system works in the network-controlled mode, otherwise, the system works in the terminal-controlled mode.</p>
<p id="p-0094" num="0093">With respect to the segmented/terminal-controlled mode or the segmented/network-controlled mode, as shown in FIG. <b>3</b>C<b>1</b> and FIG. <b>3</b>C<b>2</b>, it may be concluded from the above logical block diagrams that:</p>
<p id="p-0095" num="0094">the functions of the HOAF-CP further include: establishing a control plane connection with the terminal side of the peer user, and performing correlative control over different session connections with the handover UE and the terminal side of the peer user before and after the handover in a 3<sup>rd </sup>Party Call Control (3PCC) mode.</p>
<p id="p-0096" num="0095">Furthermore, with respect to the CPandUP-segmented/terminal-controlled mode or the CPandUP-segmented/network-controlled mode shown in FIG. <b>3</b>C<b>2</b>, it may be concluded that:</p>
<p id="p-0097" num="0096">the functions of the HOAF-CP further include: assigning resources to implement the HOAF-UP in the network, controlling the HOAF-UP to establish media connections with the handover UE and the terminal side of the peer user respectively before and after the handover, and controlling the HOAF-UP to connect these media connections.</p>
<p id="p-0098" num="0097">The functions of the HOAF-UP further include: under the control of the HOAF-CP, establishing a media connection with the terminal side of the peer user, connecting its media connections with the terminal side of the peer user and the HOSF respectively before the handover, and connecting its media connections with the terminal side of the peer user and the HODF respectively after the handover.</p>
<p id="p-0099" num="0098">In the present embodiment, different implementation plans are provided to satisfy different service requirements through above modes. Among the different modes, the end-to-end/terminal-controlled mode is the simplest one without occupying extra network resources, yet in such a mode the network is not able to control the session handover. The end-to-end mode/network-controlled mode provides basic network control mechanism. Unlike the situation in the end-to-end mode, in the CP-segmented mode the complex handling process of new session establishment and session replacement is screened to the terminal side of the peer user through the HOAF-CP set in the network during the session handover, therefore the terminal side of the peer user only needs to support session re-negotiation to implement the media stream redirection required by the session handover as well as necessary media stream adding/deleting or media stream attribute modification. In addition, as the connection between the HOAF-CP and the terminal side of the peer user is unchanged before and after the session handover, the service control over this connection and the charging on this connection in the IMS in which the session handover is performed may continue, so that the session handover is performed more smoothly with respect to the terminal side of the peer user and the IMS in which the session handover is performed. Based on the above, when the HOAF-CP is also set in the network in the CPandUP-segmented mode, the terminal side of the peer user is no longer required to perform the media stream redirection during the handover. Only when the media capabilities of the HOSF and the HODF are different does the terminal side of the peer user need to support session re-negotiation to perform media stream adding/deleting or media stream attribute modification; together with the media stream duplication and filtering functions which are easier to be implemented by the HOAF-UP on the network side, the service is performed more smoothly during the handover.</p>
<p id="p-0100" num="0099">With respect to the network which performs the handover, the HOSF and the HODF are represented by different access addresses or access means. The different access addresses correspond to different access points of the same access technology, or correspond to different access technologies. The different access means refer to direct access to a network that supports multiple access technologies or interworking access through a CS domain. It should be noted that in the present embodiment a CS call which is converted by the CS/IMS interworking gateway into an IMS session is regarded as a special means for a UE to access the IMS. On the handover user side, the HOSF corresponds to an access module of the access point, or the access technology or the access means before the handover, and the HODF corresponds to another access module of the access point, or another access technology or another access means after the handover. When the terminal of the handover user remains the same before and after the handover, then the HOSF and the HODF are located in the same handover UE; when the terminals of the handover user are different before and after the handover, the HOSF is located in the handover UE before the handover, and the HODF is located in the handover UE after the handover.</p>
<p id="p-0101" num="0100">In the present embodiment, the HOSF and the HODF correspond to a same handover user, thus the HOSF and the HODF are correlated with each other, and the correlated relationship is used to identify that the HOSF and the HOSF correspond to a same user.</p>
<p id="p-0102" num="0101">To explain the correlated relationship between the HOSF and the HODF, it is needed to introduce in the first place the existing IM Private Identity (IMPI), IM PUblic identity (IMPU), IMS subscription, and subscription identities of a same user in different network subsystems, e.g., the IMPU in an IMS network and the MSISDN in a CS domain, both of which correspond to a same user.</p>
<p id="p-0103" num="0102">In the IMS, a home network operator assigns one or more IMPIs to a user subscribing IMS services for registration, authorization, management and charging. Usually the IMPIs are kept private. In addition, one or more IMPUs are also assigned to the user subscribing IMS services to identify the user in the sessions of various services. The IMPUs are announced to the public. In the IMS network, there are many-to-many mapping relationships between the IMPIs and IMPUs of user.</p>
<p id="p-0104" num="0103">On the other hand, to satisfy some special application requirements, an IMS subscription corresponding to multiple IMPIs and IMPUs is also allowed in the IMS network. Further more, the subscription identities of a same user in different network subsystems, i.e., the IMPU of the user in an IMS network and the MSISDN of the user in other network subsystems such as a CS domain, are managed and assigned by the home operator of the user, they can be associated with each other.</p>
<p id="p-0105" num="0104">Thus, the HOSF and the HODF in the present embodiment may be correlated with or correspond to each other through various means, e.g., the HOSF and the HODF may respectively correspond to different public identities under a same private identity of an IMS user; or the HOSF and the HODF may respectively correspond to different private identities under a same public identity of the IMS user; or the HOSF and the HODF may correspond to different private identity and public identity respectively, but the private identity and the public identity are under the same subscription of a user in the IMS network; or the HOSF and the HOSF may be associated with each other through the subscriptions of a same user in different subsystems on the operator layer, for example, the HOSF and the HODF may respectively correspond to the public identity/private identity of a user in IMS network and the MSISDN/International Mobile Subscriber Identity (IMSI) of the user in CS domain, etc.</p>
<p id="p-0106" num="0105">As described above, a voice call of a user may be implemented through a Voice over IP (VoIP) born by IP under the control of the IMS, or through a traditional CS domain call, while the access technology through which the UE accesses the IMS may not have continuous coverage like the WCDMA system (e.g., the WLAN adopts hot spot coverage), so when a user accesses the IMS through the WLAN to make a VoIP call and roams out of the hot spot coverage of the WLAN, the network connection will be lost. However, the WCDMA system, which is designed to cover wide areas continuously, has its own disadvantages in some buildings due to penetration loss of radio signals, while hot spot coverage technology, such as the WLAN, is able to fill the coverage holes emerged here. Therefore, the session handover between the IMS and CS domain should also be taken into consideration. In the present embodiment, a CS call which is converted by the CS/IMS interworking gateway into an IMS session is regarded as a special means for a UE to access the IMS. Therefore, the present embodiment covers not only the handover from an IMS to another IMS, but also the handover between an IMS and a CS domain.</p>
<p id="p-0107" num="0106">Firstly, the service interworking between the IMS and the CS domain will be explained.</p>
<p id="p-0108" num="0107">The core network of a Universal Mobile Telecommunications System (UMTS) is divided into a CS domain and a PS domain, which performs CS services (such as voice, circuit data and fax services) and PS services respectively. In UMTS Release <b>5</b>, an IMS domain is introduced, signaling and media streams of the IMS domain are born by the PS domain. According to the IMS architecture definitions, interworking with the CS network, i.e., the PSTN or the PLMN CS is performed through an interworking gateway Media Gateway Control Function/IP Multimedia-Media Gateway (MGCF/IM-MGW). The MGCF is used for performing a control plane interaction between the CS domain and the IMS, supporting protocol interaction and call interworking between ISUP/Bearer Independent Call Control (BICC) and the SIP, controlling the IM-MGW to perform interworking between a Time Division Multiplex (TDM) bearer of the CS network and a user plane broadband/narrow band IP bearer of the IMS domain through H.248, and accomplishing necessary Codec transformations.</p>
<p id="p-0109" num="0108"><figref idref="DRAWINGS">FIG. 4</figref> is a schematic diagram illustrating connection relationships when an IMS session is transferred to a CS call. When a VoIP call controlled by the IMS is transferred to a CS call, the actual connections are shown in <figref idref="DRAWINGS">FIG. 4</figref>. At this time, from the point of view of the IMS network, the CS call which is converted by the CS/IMS gateway into an IMS session may be regarded as a special means for a UE to access the IMS, therefore the IMS-CS handover is equivalent to the IMS-IMS handover between the IMS session <b>1</b> and IMS session <b>2</b> which points to the CS/IMS interworking gateway shown in <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0110" num="0109">It can be concluded from the above that in practical implementations, if both the HOSF and the HODF on the handover user side access the IMS network directly through varieties of IP access networks to establish a session with the terminal side of the peer user, it is an IMS-IMS session handover that is performed in the present embodiment; if the HOSF establishes a session with the terminal side of the peer user through a CS/IMS interworking gateway between the CS domain and the IMS network, while the HODF accesses the IMS network directly through varieties of IP access networks to establish a session with the terminal side of the peer user, it is a CS-IMS session handover that is performed in the present embodiment; and if the HOSF accesses the IMS network directly through varieties of IP access networks to establish a session with the terminal side of the peer user, while the HODF establishes a session with the terminal side of the peer user through a CS/IMS interworking gateway between the CS domain and the IMS network, it is an IMS-CS session handover that is performed in the present embodiment.</p>
<p id="p-0111" num="0110">Several embodiments of different service modes in different session handover circumstances will be described hereinafter.</p>
<p id="p-0112" num="0111">In the flowcharts of the following embodiments, UE A and UE A&#x2032; are terminals of the handover user, in other words, the terminals of the handover user before and after the handover respectively. The UE A corresponds to the HOSF and the UE A&#x2032; corresponds to the HODF. UE B is the terminal of the peer user, in other words, the second UE. UE C is the terminal of a third user; IMS Network (A) includes the home IMS network of the handover user and the IMS network where the handover user is currently located excepting the case that the handover user accesses the IMS through CS interworking; IMS Network (B) includes the home IMS network of the peer user and the IMS network where the peer user is currently located; CS Network (A) is the home CS network of the handover user, or the CS network where the handover user is currently located; CS Network (B) is the home CS network of the peer user, or the CS network where the peer user is currently located.</p>
<p id="p-0113" num="0112">The IMS-IMS session handover is described hereinafter with reference to an embodiment of the present invention.</p>
<p id="p-0114" num="0113"><figref idref="DRAWINGS">FIG. 5A</figref> is a flowchart illustrating when both the handover UE and the peer UE are located in the IMS, a handover is performed in an end-to-end/terminal-controlled mode, while the HODF initiates the performing of the handover, i.e., initiates the establishment of the new connection between the HODF and the HOAF-CP, according to an embodiment of the present invention.</p>
<p id="p-0115" num="0114">This embodiment is an IMS-IMS session handover in the end-to-end/terminal-controlled mode, wherein the HOSF detects whether the handover condition is satisfied and indicates the HODF to perform the handover.</p>
<p id="p-0116" num="0115">As shown in <figref idref="DRAWINGS">FIG. 3A</figref> and <figref idref="DRAWINGS">FIG. 5A</figref>, the IMS-IMS handover in the end-to-end/terminal-controlled mode includes the following steps:</p>
<p id="p-0117" num="0116">Step <b>5101</b>: during the establishment of an initial session, the HOSF in the handover UE establishes an initial session connection with the HOAF on the terminal side of the peer user via the IMS.</p>
<p id="p-0118" num="0117">The initial session connection established by the HOSF and the HOAF includes a control plane connection established between the HOSF and the HOAF-CP, and a user plane connection established between the HOSF and the HOAF-UP; the IMS network includes the IMS network that the handover user involves in, and the IMS network that the peer user involves in, i.e., the home IMS networks of the two users and the IMS networks where the two users are currently located. Since the peer user is also in an IMS network, the terminal side of the peer user herein is referred as the peer UE.</p>
<p id="p-0119" num="0118">Step <b>5102</b>: during the conversation between the handover UE and the peer user through the HOSF, the HODF in the handover UE successfully registers in the IMS network (e.g., as the handover user roams, the HODF finds another IP access network and successfully accesses the IMS).</p>
<p id="p-0120" num="0119">Based on the correlated relationship between the HOSF and the HODF subscribed in the IMS, a same service node is guaranteed to be assigned to the HODF when the HODF accesses the IMS network according to a standard service node distribution way during registration of an IMS network user.</p>
<p id="p-0121" num="0120">Step <b>5103</b>: the HOSF detects a handover-related event.</p>
<p id="p-0122" num="0121">The step of the HOSF detecting a handover-related event includes: the HOSF detects that it will lose the connection to the IMS network, e.g., the radio signal intensity degrades to a pre-configured threshold. Optionally the battery in the local end is about to be used up when the HODF is located in another handover UE. Optionally the HOSF detects that the HODF has successfully accessed the IMS network, e.g., the HOSF learns through interactions of internal modules in the same terminal or through a user indication that the HODF has successfully accessed the network, and the radio signal quality, or the network priority level or the service charging rate of the network that the HODF accesses are better than those of the network that the HOSF accesses, or the HOSF detects that the handover condition pre-configured by the user is satisfied, e.g., the conversation duration reaches a pre-configured handover interval, or the HOSF detects a handover indication from the user, or any combination of the above;</p>
<p id="p-0123" num="0122">Step <b>5104</b>: the HOSF sends a handover indication to the HODF.</p>
<p id="p-0124" num="0123">The handover indication includes a location identifier of the HOAF, and initial session information between the HOSF and the HOAF;</p>
<p id="p-0125" num="0124">Step <b>5105</b>: the HODF acquires the location identifier of the HOAF and the initial session information from the handover indication, and returns a handover indication confirmation to the HOSF;</p>
<p id="p-0126" num="0125">As described above, the HOSF and the HODF can be located in different modules of a same UE or in different UEs, when they are located in different UEs, the interaction between them is performed through the SIP or a Service Location Protocol (SLP) via short distance wireless communication technologies, such as Bluetooth; when they are located in the same UE, they can interact with each other through various internal interaction methods, e.g., interacting through internal messages among internal modules or through visiting a shared internal memory, etc.</p>
<p id="p-0127" num="0126">When the HOSF and the HODF are located in different modules in the same UE, the interaction between them is the interaction among internal modules within a physical entity, the present embodiment is only a preferred embodiment illustrating an interaction requirement; the two modules can interact through any convenient internal interaction method, as long as the method provides equivalent effect and is in accordance with the essence of the present embodiment.</p>
<p id="p-0128" num="0127">The relationship and interaction between the HOSF and the HODF in the following embodiments are identical to the description above. However, in order to simplify the description, the HOSF and the HODF are supposed to be in different modules of the same UE.</p>
<p id="p-0129" num="0128">Step <b>5106</b>: the HODF constructs a session establishment request, which carries initial session information and handover indication information, and sends the session establishment request to the HOAF through the IMS network.</p>
<p id="p-0130" num="0129">The session establishment request includes the location identifier of the HOAF. Network entities in the IMS network decide routing according to the location identifier of the HOAF, and accomplish some special processes according to the handover indication information, including prohibiting the duplicate triggering of service, and/or avoiding influences from other services, and/or special charging processes, etc.</p>
<p id="p-0131" num="0130">In the session establishment request, an indication declaring that the new session is used to replace the original session between the HOSF and the HOAF, and session related information may be carried through the REPLACES header field.</p>
<p id="p-0132" num="0131">Step <b>5107</b>: the HOAF judges whether the session establishment request is legal; if it is legal, execute Step <b>5108</b>; otherwise, the HOAF returns a failure response to the HODF to end the procedure.</p>
<p id="p-0133" num="0132">Since the terminal side of the peer user cannot obtain the subscription data of the handover user in the end-to-end/terminal-control mode, it is hard to perform checking on correlated relationship between the HOSF and the HODF, i.e., it is impossible to determine whether the HOSF and the HODF belong to the same user. Therefore, the step of the HOAF judging whether the session establishment request is legal is performed according to the initial session information carried in the session establishment request.</p>
<p id="p-0134" num="0133">The step of the HOAF judging whether the session establishment request is legal includes: the HOAF judges whether the original session to be replaced and indicated by the initial session information corresponds to the initial session established between the HOAF and the HOSF in the handover UE according to the session information carried by the session establishment request, so as to determine whether the session establishment request used for the handover is legal.</p>
<p id="p-0135" num="0134">In addition, after receiving the session establishment request, the HOAF can further instruct the peer UE to avoid ringing according to the handover indication information.</p>
<p id="p-0136" num="0135">Step <b>5108</b>: the HOAF interacts with the HODF for the information needed in the establishment of the new session, and replaces the initial session with the new session.</p>
<p id="p-0137" num="0136">The step of replacing the initial session with the new session includes: replace the media stream exchanged with the HOSF in the initial session with the media stream exchanged with the HODF; add/delete media streams and modify the attribute of the media stream, such as media type or coding format, etc., required by the change of the media capabilities between the HODF and the HOSF through session media re-negotiation.</p>
<p id="p-0138" num="0137">Step <b>5109</b>: the HOAF returns a session answer response to the HODF.</p>
<p id="p-0139" num="0138">Step <b>5110</b>: the HODF returns a session answer response acknowledgment to the HOAF.</p>
<p id="p-0140" num="0139">Now the new session connection between the HODF and the HOAF is established, and the initial session connection with the HOSF is replaced by the new session connection on the HOAF side.</p>
<p id="p-0141" num="0140">Step <b>5111</b>: the HOAF sends a session release message to the HOSF.</p>
<p id="p-0142" num="0141">Step <b>5112</b>: the HOSF returns a session release success message to the HOAF, the HOSF and the HOAF release the session connection between them.</p>
<p id="p-0143" num="0142">Now the handover user and the peer user continue their conversation through the new connection between the HODF and the HOAF.</p>
<p id="p-0144" num="0143">It should be noted that, although in the present embodiment the peer UE is located in the IMS network, actually the method described in the above embodiment is also applicable to the cases when the peer UE is located in a PLMN CS domain or in the PSTN, so far as the terminal side of the peer user is taken as the combination of the peer UE, the CS/IMS interworking gateway which performs interworking for the peer UE and the CS connection between them. At this time, the call to the terminal side of the peer user is processed according to the standard IMS-CS interworking process, in other words, is directly routed by the home IMS network of the handover user to the network where the peer UE is located and further to the peer UE.</p>
<p id="p-0145" num="0144">That is to say the schemes are independent of the network that the peer UE accesses, therefore in the embodiments described hereinafter, all peer users are supposed to be located in the IMS network, unless there is a special reason that needs to be explained.</p>
<p id="p-0146" num="0145">FIG. <b>5</b>B<b>1</b> is a flowchart illustrating a handover according to the structure of the <figref idref="DRAWINGS">FIG. 3B</figref>.</p>
<p id="p-0147" num="0146">The handover when there is an HOCF is described in detail hereinafter with reference to FIG. <b>5</b>B<b>1</b> and an embodiment.</p>
<p id="p-0148" num="0147">As shown in FIG. <b>5</b>B<b>1</b>, in the present embodiment, a normal session, i.e., the first connection, has already been established between the HOSF which has accessed the network and the peer UE. The session handover in the end-to-end/network-controlled mode according to the embodiment includes the following steps:</p>
<p id="p-0149" num="0148">Step <b>5</b>B<b>101</b>: the handover UE reports a service event to the HOCF.</p>
<p id="p-0150" num="0149">The handover UE includes the HOSF and the HODF, and there are multiple methods for the handover UE to report the service event to the HOCF on the application layer, e.g., a Presence mechanism or directly access a database, etc.</p>
<p id="p-0151" num="0150">The service event includes one of the following cases or any combination of the following:</p>
<p id="p-0152" num="0151">(1) when the session connection of the handover UE changes, report session link change information, e.g., when the HOSF successfully establishes the initial session connection with the peer side, the HOSF reports the address of the peer side and the status of the established connection to the HOCF, the HOCF saves and maintains address of the peer side and the status of the established connection of the HOSF associated with each user, and sends the address of the peer side and the status of the established connection to the HODF during the handover to establish the new session link;</p>
<p id="p-0153" num="0152">(2) when the HODF enters into the coverage area of a new access network, and if the handover UE successfully accesses the new access network and obtains a new access point, the HODF reports the address of the new access point and this event to the HOCF;</p>
<p id="p-0154" num="0153">(3) When the HOSF detects that the signal intensity of the original network degrades to a threshold, the HOSF reports this situation to the HOCF, in other words, it gives a communication quality falling alert, and in such a case a handover may be performed;</p>
<p id="p-0155" num="0154">(4) When the handover user triggers a handover on his own initiative, a handover request is reported by the handover UE to the HOCF; this may happen when the handover user needs to transfer to other mode or adopt services provided by other operators, at this time, the HOCF needs to verify the handover condition;</p>
<p id="p-0156" num="0155">(5) the handover UE may also trigger a handover in follow circumstances: the handover UE moves, or needs to transfer to a new access network due to pre-configured conditions of the user or the network operator. At this time, the handover UE triggers a handover request to the HOCF. There may be many pre-configured conditions, e.g., when the handover UE detects that the signal of the original access network deteriorates, it actively triggers a &#x201c;signal weak handover request&#x201d;, and this kind of request is basically handled completely by the radio access network according to the prior art; or, when the handover UE enters into the coverage area of a new access network, it triggers an access request and makes a connection request attempt, including obtaining address and access verification, etc., if the connection request attempt succeeds, it triggers a &#x201c;handover possibility event&#x201d; to the HOCF for processing.</p>
<p id="p-0157" num="0156">Actually, the handover may be performed in various cases including not only the signal deterioration of a cell caused by roaming, but also conditions pre-configured by the user, e.g., when there are multiple access networks, the user may assign higher priority to a network which provides plenty of services, at this time, a handover is needed. In a word, the handover strategies can be more accurate and flexible, for instance, a handover can be triggered according to signal intensity, operator priority, access network priority, time and location, etc. For example, for a dual-mode cell phone that supports a Global System of Mobile (GSM) and a Wideband Code Division Multiple Access (WCDMA) system, when there is a coverage of the GSM and a coverage of the WCDMA simultaneously and the GSM is the current serving-network, the user usually wants to switch to the WCDMA network to obtain richer services with higher quality.</p>
<p id="p-0158" num="0157">In this embodiment, the system may further perform a handover condition update, i.e., the handover user updates the handover conditions and user handover strategies by interacting with the HOCF through the handover UE. The HOCF maintains the handover conditions and strategies and initiates a handover when receiving a notification of a related event, or performs an authorization when receiving a handover request.</p>
<p id="p-0159" num="0158">Step <b>5</b>B<b>102</b>: after receiving the service event from the handover UE, the HOCF determines whether to initiate a handover according to the pre-configured handover conditions; the handover conditions can be signal intensity, operator preference, charging strategy or user pre-configured strategies, or any combination of the above. The HOCF then informs the handover UE by returning a handover initialization or a handover refuse command; if a handover refuse command is returned, go to Step <b>5</b>B<b>103</b>, otherwise, go to Step <b>5</b>B<b>104</b>.</p>
<p id="p-0160" num="0159">Step <b>5</b>B<b>103</b>: if the handover condition is not satisfied, the HOCF needs to inform the handover UE in some cases, e.g., when the handover user actively triggers a handover request, the HOCF should return a handover refuse message to the handover user, and ends the procedure.</p>
<p id="p-0161" num="0160">Step <b>5</b>B<b>104</b>: the HOCF indicates the HODF to perform the handover and establish a new session link; the HODF also receives other information from the HOCF at the same time along with the handover indication, wherein the most important information is the address of the peer UE, which is reported in Step <b>5</b>B<b>101</b>; the HODF establishes a new session link, i.e., the second connection, on its own with the peer side of the original session link, and the process of the establishment can be implemented without the intervention of the service control layer.</p>
<p id="p-0162" num="0161">Step <b>5</b>B<b>105</b>: after the establishment of the second connection, the HODF reports the result to the HOCF; if the new session link is successfully established, go to Step <b>5</b>B<b>106</b>, otherwise, go to Step <b>5</b>B<b>107</b>.</p>
<p id="p-0163" num="0162">Step <b>5</b>B<b>106</b>: the HOCF informs the HOSF to release the original session link, i.e., the first connection; the HOSF release the original session link with the peer side on its own, thus the service is transferred to the new session link, end the procedure. The step of releasing the original link can be implemented without the intervention of the service control layer.</p>
<p id="p-0164" num="0163">Step <b>5</b>B<b>107</b>: after receiving new session link establishment failure information from the HODF, the HOCF releases the resources used for session link establishment, informs the handover user of the new session link establishment failure information, and end the procedure.</p>
<p id="p-0165" num="0164">When the handover UE is controlled by a service control point, the handover is described hereinafter with reference to FIG. <b>5</b>B<b>2</b>.</p>
<p id="p-0166" num="0165">As shown in FIG. <b>5</b>B<b>2</b>, the HOSF establishes a normal session link with the second UE on the other side through an access network in this embodiment.</p>
<p id="p-0167" num="0166">Step <b>5</b>B<b>201</b>: when the handover UE needs to be switched to a new access network due to movement or pre-configured conditions of the user or the operator, trigger a handover request to the service control point.</p>
<p id="p-0168" num="0167">As the embodiment described above, there can be many handover conditions, which will not be described herein.</p>
<p id="p-0169" num="0168">Step <b>5</b>B<b>202</b>: after receiving a signal weak handover request event or a handover possibility event or other events from the access network, the service control point triggers the event to the corresponding HOCF. In other words, the service control point reports the handover request to the HOCF, which is responsible for centralized handling of handover requests in the entire network.</p>
<p id="p-0170" num="0169">Step <b>5</b>B<b>203</b>: after receiving the trigger event from the service control point, the HOCF determines whether to initiate a handover according to the pre-configured handover conditions; the handover condition may be signal intensity, operator preference, charging strategy or user pre-configured strategies, or any combination of the above. The HOCF then returns a handover indication or handover refuse command to the service control point; if a handover refuse command is returned, go to Step <b>5</b>B<b>204</b>, otherwise, go to Step <b>5</b>B<b>205</b>.</p>
<p id="p-0171" num="0170">Step <b>5</b>B<b>204</b>: after receiving the handover refuse command, the service control point issues a &#x201c;Handover Refuse Command&#x201d; to the handover UE at the original access point. The handover UE at the original access point ends the current handover request procedure, and returns a processing result to the service control point. For instance, the handover UE can modify the pre-configured handover condition due to the handover failure, and return the modification event to the service control point. End the current handover procedure.</p>
<p id="p-0172" num="0171">Step <b>5</b>B<b>205</b>: after receiving the handover indication, the service control point controls the handover UE to establish a new session link with the other end of the session. The step of establishing the new session link includes: issue a command to the handover UE, require the handover UE to call the other end of the session actively following a standard procedure, and establish a new session link, which uses the address and other relevant resources of the handover UE in the new access network, through the service control point of the other end of the session. Optionally, the service control point controls other network components which are able to provide conference resources to establish a conference, and establishes an additional session link for the handover UE and the other end of the session through a standard procedure, and controls them to join the conference.</p>
<p id="p-0173" num="0172">Step <b>5</b>B<b>206</b>: after receiving the control command from the service control point, the handover UE at the new access point calls to establish the new session or joins in the conference cooperating with the command, and returns the processing result to the service control point.</p>
<p id="p-0174" num="0173">Step <b>5</b>B<b>207</b>: the service control point performs corresponding process according to the processing result about the establishment of the new session link returned by the handover UE; if the processing result is that the link is successfully established, sends a command to the handover UE at the original access point to release the first session, go to Step <b>5</b>B<b>208</b>, otherwise, go to Step <b>5</b>B<b>209</b>.</p>
<p id="p-0175" num="0174">Step <b>5</b>B<b>208</b>: after receiving the command of releasing the original session link, the handover UE at the original access point releases the resources occupied by the original session link, transfers the service born by the original session to the new session for subsequent process, and returns a releasing result to the service control point to inform the HOCF that the handover is accomplished; the HOCF continues with the subsequent process, such as recording current access mode and status.</p>
<p id="p-0176" num="0175">Step <b>5</b>B<b>209</b>: the service control point reports handover failure information to the HOCF, and completes the release of the related resources employed in the handover, returns a handover failure information to the handover UE at the same time, maintains the original session link, releases all the resources employed for the establishment of the new session link, ends the procedure.</p>
<p id="p-0177" num="0176">The above two embodiments mainly show the handover initiated by the HOCF according to the detection of the information reported by the handover UE, and also show different establishment methods of the new end-to-end session link during the handover. The embodiment hereinafter shows an IMS-IMS handover in the end-to-end/network-controlled mode, wherein the HOSF detects that the handover condition is satisfied and sends a handover request to the HOCF, which authorizes the request and returns a confirmation to the HOSF. Then the HOSF instructs the HODF to perform the handover.</p>
<p id="p-0178" num="0177">FIG. <b>5</b>B<b>3</b> is a flowchart illustrating a handover in an end-to-end/network-controlled mode while the HODF initiates the performing of the handover according to the structure of <figref idref="DRAWINGS">FIG. 3B</figref>. The IMS-IMS handover in the end-to-end/network-controlled mode will be described hereinafter with reference to accompanying FIG. <b>5</b>B<b>3</b> and <figref idref="DRAWINGS">FIG. 3B</figref>, including:</p>
<p id="p-0179" num="0178">Step <b>5201</b>: the HOSF establishes a session connection with the HOAF on the terminal side of the peer user during the establishment of the initial session, and the HOCF is triggered in the home IMS network of the handover user according to the evaluation of the iFC in the user subscription data;</p>
<p id="p-0180" num="0179">During the establishment of the initial session, the service node S-CSCF, which is currently assigned to the handover user by his/her home IMS network, triggers the current session to a network entity that performs the functions of the HOCF, such as an AS, according to the iFC in the subscription data downloaded from the HSS during the user registration according to the existing service triggering method in the IMS.</p>
<p id="p-0181" num="0180">Step <b>5202</b>: the HODF in the handover UE accesses the IMS network during the session, and the HOSF learns through interactions among internal modules in the handover UE or through a user indication that the HODF has already accessed the network.</p>
<p id="p-0182" num="0181">Step <b>5203</b>: the HOSF detects a handover-related event, e.g., the signal of the local point is weaker than that of the network which the HODF accesses.</p>
<p id="p-0183" num="0182">Step <b>5204</b>: the HOSF sends a handover request to the HOCF.</p>
<p id="p-0184" num="0183">The handover request carries session information, handover reason information and HODF identity information.</p>
<p id="p-0185" num="0184">Step <b>5205</b>: the HOCF performs a handover authorization, i.e., determines whether the handover request is legal; if the handover request is legal, the HOCF returns a handover confirmation to the HOSF, execute Step <b>5206</b>, otherwise, the HOCF returns a handover refuse to end the procedure.</p>
<p id="p-0186" num="0185">The handover authorization performed by the HOCF can be a step of determining whether the HOSF is correlated with the HODF, the detailed process includes: the HOCF determines, according to the information carried in the handover request, e.g., the respective IMPU of the HOSF and the HODF, whether the two IMPUs are different public identities of a same IMS user's private identity; if they are, it is indicated that the HOSF is correlated with the HODF, otherwise, the HOSF is not correlated with the HODF.</p>
<p id="p-0187" num="0186">The steps from Step <b>5206</b> to Step <b>5214</b> are basically identical to the steps from Step <b>5104</b> to Step <b>5112</b>, the only difference lies in Step <b>5104</b>, wherein the HOSF directly sends a handover indication to the HODF after the detection of the handover-related event, while in Step <b>5206</b> the HOSF sends the handover indication to the HODF after receiving a confirmation message from the HOCF when the authorization passes.</p>
<p id="p-0188" num="0187">The handover in segmented mode is described hereinafter with reference to two embodiments of the present invention.</p>
<p id="p-0189" num="0188">This embodiment is an IMS-IMS session handover in the CP-segmented/terminal-controlled mode, wherein the HODF determines whether the handover condition is satisfied and directly performs the handover.</p>
<p id="p-0190" num="0189"><figref idref="DRAWINGS">FIG. 5C</figref> is a flowchart illustrating a handover in a CP-segmented mode while the HODF initiates the performing of the handover according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 5C</figref>, the IMS-IMS handover in the CP-segmented/terminal-controlled mode includes:</p>
<p id="p-0191" num="0190">Step <b>5301</b>: during the establishment of the initial session, the HOSF sends a session establishment request to the home IMS network of the handover user, the IMS network triggers the control function of an AS that performs the functions of the HOAF-CP according to the evaluation of iFC in the user subscription data, the HOAF-CP ends the session establishment request from the HOSF, interacts with the HOSF to establish a first session segment, SEG<b>1</b>, initiates and establishes a second session segment, SEG<b>2</b>, with the terminal side of the peer user.</p>
<p id="p-0192" num="0191">During the establishment of the initial session, the service node S-CSCF, which is currently assigned to the handover user by his/her home IMS network, triggers the current session to the AS that performs the functions of the HOAF-CP according to the iFC in the subscription data downloaded from the HSS during the user registration following the existing service triggering method in the IMS. In order to reduce the influence to other IMS services, the HOAF-CP should be set as close as possible to the HOSF/HODF, i.e., when the HOSF is a calling party during the establishment of the initial session, the priority level of the iFC corresponding to the AS that performs the functions of the HOAF-CP should be set as high as possible; when the HOSF is a called party during the establishment of the initial session, the priority level of the iFC corresponding to the AS that performs the functions of the HOAF-CP should be set as low as possible.</p>
<p id="p-0193" num="0192">The HOAF-CP controls the establishment of the segmented session between the HOSF and the terminal side of the peer user, and performs correlative control over the session segments SEG<b>1</b> and SEG<b>2</b> in the 3PCC mode, so as to implement the end-to-end media exchange between the HOSF and the HOAF-UP on the terminal side of the peer user.</p>
<p id="p-0194" num="0193">Step <b>5302</b>: during the session between the handover user and the peer user through the HOSF, the HODF accomplishes an IMS access, and the HOSF learns that through interactions among internal modules in the handover UE or a user indication;</p>
<p id="p-0195" num="0194">Step <b>5303</b>: the HOSF sends a handover event notification to the HODF when the HOSF detects a handover event.</p>
<p id="p-0196" num="0195">The handover event may include: the HOSF is about to lose the connection to the IMS network, and/or user pre-configured handover strategies, e.g., the conversation duration reaches a pre-configured handover interval. In addition, when the HOSF sends the handover event notification to the HODF, relevant information of the initial session between the HOSF and the HOAF is carried in the handover event notification;</p>
<p id="p-0197" num="0196">Step <b>5304</b>: the HODF determines whether the handover condition is satisfied, if the condition is satisfied, the HODF returns an event notification confirmation to the HOSF, otherwise, do not perform the handover and end the procedure.</p>
<p id="p-0198" num="0197">The handover condition is considered to be satisfied under the following situations: the HODF considers that it has successfully accessed the IMS network, and/or the HODF determines that it can process a session, and/or the access point of the HODF is better than that of the HOSF with respect to signal intensity, network priority or service fee.</p>
<p id="p-0199" num="0198">Step <b>5305</b>: the HODF sends a session establishment request, which carries the session information and the handover indication, to the HOAF-CP through the IMS network.</p>
<p id="p-0200" num="0199">The HODF sends the session establishment request to the HOAF-CP according to the session information in the handover event notification, and the session establishment request carries the location identifier of the network entity that performs the functions of the HOAF-CP; the location identifier can be provided by the HOSF to the HODF in the handover event notification, or be pre-stored as a part of network service settings, or be issued by the network when the HODF registers in the network and then stored in the HODF; In the IMS network, the session establishment request will be routed to the HOAF-CP by relevant entities according to the location identifier.</p>
<p id="p-0201" num="0200">Step <b>5306</b>: the HOAF-CP judges whether the session establishment request is legal; if it is legal, execute Step <b>5307</b>; otherwise, the HOAF-CP returns a failure response to the HODF and ends the procedure.</p>
<p id="p-0202" num="0201">Step <b>5307</b>: based on a media negotiation situation during the establishment of the session between the HOAF-CP and the HODF, the HOAF-CP sends a re-negotiation request to the terminal side of the peer user through the SEG<b>2</b> between itself and the terminal side of the peer user.</p>
<p id="p-0203" num="0202">Step <b>5308</b>: the terminal side of the peer user performs a re-negotiation interaction with the HOAF-CP, and returns a re-negotiation response to the HOAF-CP, which in turn returns a session answer response to the HODF.</p>
<p id="p-0204" num="0203">Step <b>5309</b>: the HODF returns a session answer response acknowledgement to the HOAP-CP, which in turn returns a re-negotiation response acknowledgement to the terminal side of the peer user.</p>
<p id="p-0205" num="0204">From Step <b>5305</b> to Step <b>5309</b>, the HOAF-CP correlatively controls the establishment of the SEG<b>3</b> between itself and the HODF and the re-negotiation on the SEG<b>2</b> between itself and the terminal side of the peer user in the 3PCC mode, so as to make the HOAF-UP on the terminal side of the peer user change to exchange with the HODF finally, and the type of the exchanged media is compatible to the media capability of the HODF.</p>
<p id="p-0206" num="0205">Thus, the new session connection is established between the HOAF and the HODF, and the initial connection with the HOSF is thus replaced by the new session connection; in the following steps the initial session will be released.</p>
<p id="p-0207" num="0206">Step <b>5310</b>: the HOAF sends a session release message to the HOSF through the SEG<b>1</b>.</p>
<p id="p-0208" num="0207">Step <b>5311</b>: the HOSF returns a session release success message to the HOAF through the SEG<b>1</b>, the HOSF and the HOAF release the session connection between them.</p>
<p id="p-0209" num="0208">It should be noted that the CP-segmented mode in this embodiment can also work in the network-controlled mode, wherein, the home IMS network of the handover user triggers not only the control of the HOAF-CP, but also the control of the HOCF for the handover authorization, and the two control functions usually are performed in the same AS. During the handover event detection and handover initiation, when the entity which is in charge of condition detection (e.g., the HODF in this embodiment) detects that the handover condition is satisfied, it needs to send a handover request to the HOCF first, and performs handover only after the request authorization on the HOCF passes.</p>
<p id="p-0210" num="0209">The next embodiment shows an IMS-IMS handover in a CPandUP-segmented/network-controlled mode, wherein the HOSF detects that the handover condition is satisfied and sends a handover request to the HOCF, the HOCF indicates the HOAF to perform the handover after the authorization succeeds.</p>
<p id="p-0211" num="0210"><figref idref="DRAWINGS">FIG. 5D</figref> is a flowchart illustrating a handover initiated in a CPandUP-segmented mode while the HOAF initiates the performing of the handover according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 5D</figref>, the IMS-IMS handover in the CPandUP-segmented/network-controlled mode according to the embodiment of the present invention includes the following steps:</p>
<p id="p-0212" num="0211">Step <b>5401</b>: the HOSF sends a session establishment request to the home IMS network of the handover user during the establishment of the initial session.</p>
<p id="p-0213" num="0212">Step <b>5402</b>: the IMS network triggers, according to the iFC in the user subscription data, the control function of the AS that performs the functions of the HOCF and the HOAF-CP, the HOAF-CP controls the establishment of the segmented session between the HOSF and the terminal side of the peer user, including the SEG<b>1</b> between the HOAF-CP and the HOSF, and the SEG<b>2</b> between the HOAF-CP and the terminal side of the peer user.</p>
<p id="p-0214" num="0213">Step <b>5403</b>: during the establishment of the segmented session, the HOAF-CP assigns corresponding media resources on the network side as the HOAF-UP for the session, and establishes segmented media exchange between the HOSF and the terminal side of the peer user through the HOAF-UP over the two session segments separated by the HOAF-CP.</p>
<p id="p-0215" num="0214">The step of the HOAF-CP assigning media resources as the HOAF-UP for the session includes: assign a corresponding port on an IMS Media Resource Function (MRF), and accomplish the segmented media exchange between the HOSF and the terminal side of the peer user, wherein, the segments include: from the HOSF to an HOAF-UP port <b>1</b>, from the HOAF-UP port <b>1</b> to an HOAF-UP port <b>2</b> and from the HOAF-UP port <b>2</b> to the terminal side of the peer user. Among the segments, the media exchange between the HOSF and the HOAF-UP port <b>1</b> is controlled by the SEG<b>1</b> between the HOSF and the HOAF-CP, the media interaction between the HOAF-UP port <b>2</b> and the terminal side of the peer user is controlled by the SEG<b>2</b> between the HOAF-CP and the terminal side of the peer user, and the connection between the HOAF-UP port <b>1</b> and HOAF-UP port <b>2</b> is controlled by the HOAF-CP.</p>
<p id="p-0216" num="0215">Thus, the initial session connection in the CPandUP-segmented mode is established between the HOSF and the terminal side of the peer user to transmit the session. During the session between the handover user and the peer user through the HOSF, the HODF accesses the network, and the HOSF learns that through interactions among the internal modules in the same terminal of a handover user or a user indication.</p>
<p id="p-0217" num="0216">Step <b>5404</b>: the HOSF detects that the handover condition is satisfied, and then sends a handover request to the HOCF.</p>
<p id="p-0218" num="0217">The handover request carries session information, handover reason information and HODF information.</p>
<p id="p-0219" num="0218">Step <b>5405</b>: the HOCF performs a handover authorization to determine whether the handover is legal; if it is legal, execute Step <b>5406</b>, otherwise, the HOCF returns a handover refuse message to the HOSF and ends the procedure.</p>
<p id="p-0220" num="0219">The step of HOCF performing the handover authorization to determine whether the handover is legal can be implemented by determining whether the HOSF is associated with the HODF, i.e., determining, according to the information, e.g., the IMPI, of the HOSF and the HODF carried in the handover request and in the user subscription data (saved in the HOCF, or saved in the HSS and downloaded to the HOCF when the user registers), whether the IMPIs of the HOSF and the HODF are corresponding IMPIs of a same IMPU; if they are, it indicates that the HOSF is associated with the HODF, otherwise, it indicates that the HOSF is not associated with the HODF.</p>
<p id="p-0221" num="0220">Step <b>5406</b>: the HOCF indicates the HOAF-CP to perform the session handover.</p>
<p id="p-0222" num="0221">When the HOCF indicates the HOAF-CP to perform the session handover, it provides the location identifier of the HODF, obtained from the handover request or the user subscription data, to the HOAF-CP.</p>
<p id="p-0223" num="0222">Since the HOCF and the HOAF-CP are located in the same network entity (implemented in the same AS), the above interaction between the HOCF and the HOAF-CP is also interactions among internal modules, and the foregoing is only a preferred embodiment illustrating an interaction requirement. The interactions between the HOCF and the HOAF-CP can be implemented through any convenient internal interaction process, as long as the process achieves the equivalent effect and is in accordance with the essence of the embodiment of the present invention.</p>
<p id="p-0224" num="0223">Step <b>5407</b>: the HOAF-CP sends a session establishment request to the HODF through each IMS network entity according to the obtained location identifier of the HODF.</p>
<p id="p-0225" num="0224">The session establishment request carries the location identifier of the HODF, the HOAF-CP and each IMS network entity decide the route according to the location identifier of the HODF. Furthermore, the session establishment request can carry a handover indication, and each IMS network entity performs special processes on the session according to the handover indication, including: prohibiting the duplicate triggering of service, and/or shunning influences from other services, and/or special charging, etc.</p>
<p id="p-0226" num="0225">Step <b>5408</b>: the session establishment request can further carry relevant information of the HOSF, and the HODF determines whether the session establishment request is legal according to the relevant information of the HOSF in the session establishment request; if the request is legal, execute Step <b>5409</b>, otherwise, the HODF returns a refuse response to the HOAF-CP and ends the procedure.</p>
<p id="p-0227" num="0226">The step of the HODF determining whether the session establishment request is legal includes: the HODF determines whether the HOSF is the associated HOSF of the HODF. In addition, each IMS network entity can also perform a special process on the session according to the relevant information of the HOSF in the session establishment request (regard the relevant information as a kind of implicit handover indication), including: prohibiting the duplicate triggering of service, and/or shunning influences from other services, and/or special charging treatment, etc.</p>
<p id="p-0228" num="0227">Step <b>5409</b>: the HODF interacts with the HOAF-CP to establish a new session SEG<b>3</b> between them, and during the establishment, the HODF performs a media negotiation with the HOAF-CP according to the media capability of the local end to determine the media type, coding format, address and port or other information of the exchanged media. During the establishment of the SEG<b>3</b>, the HOAF-CP assigns a new port resource, i.e., HOAF-UP port <b>3</b>, on the MRF, and controls the establishment of the media exchange between the HODF and the HOAF-UP port <b>3</b>.</p>
<p id="p-0229" num="0228">The HODF can also perform a special process according to the handover indication (including the relevant information of the HOSF as an implicit handover indication) in the session establishment request, e.g., controls the handover UE to avoid ringing.</p>
<p id="p-0230" num="0229">Step <b>5410</b>: the HODF returns a session answer response to the HOAF-CP. The HOAF-CP determines whether to modify the attribute of the media exchanged with the terminal side of the peer side according to the result of the media negotiation with the HODF. In the present embodiment, the HOAF-CP initiates and interacts to accomplish the re-negotiation through the SEG<b>2</b> with the terminal side of the peer user.</p>
<p id="p-0231" num="0230">During the re-negotiation through the SEG<b>2</b>, the HOAF-CP modifies the attribute of the media exchanged between the HOAF-UP port <b>2</b> and the terminal side of the peer side according to the result of the media negotiation with the HODF. Finally, under the control of the HOAF-CP, replace the connection between the HOAF-UP port <b>1</b> and the HOAF-UP port <b>2</b> by the connection between the HOAF-UP port <b>2</b> and the HOAF-UP port <b>3</b>, and release the HOAF-UP port <b>1</b> during the release of the SEG<b>1</b>.</p>
<p id="p-0232" num="0231">Step <b>5411</b>: the HOAF-CP returns a session answer response acknowledgement to the HODF, and returns a re-negotiation answer response acknowledgement to the terminal side of the peer user.</p>
<p id="p-0233" num="0232">Thus, the session between the HODF and the HOAF is established, and the initial session between the HOSF and the HOAF is replaced.</p>
<p id="p-0234" num="0233">Step <b>5412</b>: the HOAF-CP sends a session release message through the SEBG to the HOSF, the HOSF then releases the connection of the SEG<b>1</b> with the HOAF-CP, and returns a session release success message to the HOAF-CP.</p>
<p id="p-0235" num="0234">Now the handover user and the peer user continue their conversation through the new connection between the HODF and the HOAF.</p>
<p id="p-0236" num="0235">It can be seen from the above embodiment that in the establishment of the new connection between the HODF and the HOAF during the handover, the session establishment request can also be initiated by the HOAF-CP to the HODF (i.e., the HOAF-CP initiates the performing of the handover). However, in the two segmented modes shown in <figref idref="DRAWINGS">FIG. 3C</figref>, since the HOAF-CP is on the network side while the HODF is in the handover UE, the handover with the new connection initiated to establish by the HODF equals to a new session establishment adopting a mobile origination procedure, and the handover with the new connection initiated to establish by the HOAF-CP equals to a new session establishment adopting a mobile termination procedure. The mobile termination procedure includes an additional step of inquiring the current position of the user than the mobile origination procedure. In addition, when the HODF is located in the CS domain, a paging process is further needed. Therefore, the mobile termination procedure is generally slow than mobile origination procedure. Although both the two methods can be adopted, the new connection is established more quickly when the HODF initiates the establishment of the new connection, and therefore better handover effect can be achieved. So, in the following embodiments, new connections initiated to establish by the HODF are taken as examples.</p>
<p id="p-0237" num="0236">The segmented mode in the above two embodiments can be represented by <figref idref="DRAWINGS">FIG. 8</figref>. <figref idref="DRAWINGS">FIG. 8</figref> is a schematic diagram illustrating a system of an IMS-IMS handover when access networks of the HOSF and HODF are different. In <figref idref="DRAWINGS">FIG. 8</figref>, during the establishment of the initial session connection, the connection between the HOAF-CP and the HOSF in the handover UE through the access network <b>1</b> is the control plane first connection, i.e., leg<b>1</b>.</p>
<p id="p-0238" num="0237">The connection between the HOAF-CP and the terminal side of the peer user is leg<b>2</b>, and the handover user implements the conversation with the peer user through the leg<b>1</b> and the leg<b>2</b>. When the handover condition is satisfied, the HODF establishes a second connection, i.e., leg<b>3</b>, with the HOAF-CP. When the handover is accomplished, the handover user continues the conversation with the peer user through the leg<b>3</b> and the leg<b>2</b>.</p>
<p id="p-0239" num="0238">During the IMS-IMS handover in various modes, a third user may initiate a call to the HOSF used by the handover user in the initial connection, wherein the call may be towards the shared IMPU of the HOSF and the HODF or towards the dedicated IMPU of the HOSF. Since in the embodiments of the present invention, the session handover process from the HOSF to the HODF may be invoked by various reasons, such as, the HOSF is about to lose the connection to the network, e.g., when the radio signal deteriorates, or the battery of the handover UE is used up, so proper actions should also be taken in such cases. In other words, the call from the third user to the HOSF should also be delivered to the HODF in the handover UE according to the specific handover reason.</p>
<p id="p-0240" num="0239"><figref idref="DRAWINGS">FIG. 6A</figref> is a flowchart illustrating a procedure of delivering a call from a third user to the HODF in the handover UE while the IMPU of the handover user is shared by the HOSF and the HODF according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 6A</figref>, taking the end-to-end/terminal-controlled mode as an example, when the HOSF and the HODF share the IMPU of the handover user while having different IMPIs, the procedure of delivering a call from a third user to the HODF in the handover UE during the session handover includes the following steps:</p>
<p id="p-0241" num="0240">Step <b>6101</b>: the HOSF in the handover UE establishes a connection with the HOAF on the terminal side of the peer user to implement the conversation.</p>
<p id="p-0242" num="0241">Step <b>6102</b>: during the session handover, the home IMS network of the handover user receives a session establishment request from a third user, and the request is towards the shared IMPU of the HOSF and the HODF of the handover user.</p>
<p id="p-0243" num="0242">Step <b>6103</b>: the home IMS network of the handover user performs a forking process to the session establishment request following a standard procedure, and sends the session establishment request to the HOSF and the HODF respectively.</p>
<p id="p-0244" num="0243">The forking process includes: according to corresponding legal contact addresses of the IMPU, synchronously send or serially attempt to send the received session establishment request to multiple addresses based on a preference settings of the user.</p>
<p id="p-0245" num="0244">Step <b>6104</b>: the HOSF returns a session refuse message to the home IMS network of the handover user, the home IMS network of the handover user then returns a session refuse acknowledgement to the HOSF.</p>
<p id="p-0246" num="0245">Step <b>6105</b>: the HODF determines a processing strategy for the two sessions, i.e., the handover session with the peer user and the new session of the third user, according to pre-set local configurations and a user indication.</p>
<p id="p-0247" num="0246">For example, the processing strategy of the HODF is to accept the new session from the third user while holding the handover session. Then the HODF holds the handover session with the terminal side of the peer user after the session handover, the HOAF releases the session between the HOAF and the HOSF. After that, the handover user establishes a new session with the third user through the HODF and performs a media negotiation interaction, and finally establishes the new session with the third user.</p>
<p id="p-0248" num="0247">Step <b>6106</b>: after completing the session handover and holding the handover session, the HOAF sends a session release message to the HOSF.</p>
<p id="p-0249" num="0248">Step <b>6107</b>: the HOSF sends a session release success message to the HOAF.</p>
<p id="p-0250" num="0249">Thus the session between the HOSF and the HOAF is released.</p>
<p id="p-0251" num="0250">Step <b>6108</b>: at the same time, the HODF establishes a session and performs a media negotiation interaction with the third user, and finally sends a session answer response to the third UE.</p>
<p id="p-0252" num="0251">Step <b>6109</b>: the third UE returns a session answer response acknowledgement to the HODF, and the handover user establishes a session connection with the third user through the HODF.</p>
<p id="p-0253" num="0252"><figref idref="DRAWINGS">FIG. 6B</figref> is a flowchart illustrating a procedure of delivering a call from a third user to the HODF in the handover UE while the IMPU of the handover user is not shared by the HOSF and the HODF according to an embodiment of the invention. As the HOSF and the HODF have different IMPUs, a number modification process by a network control entity is required to deliver the call originally destined to the HOSF to the HODF. The network control entity can be the HOCF in the network-controlled mode or the HOAF-CP in the segmented mode. In the present embodiment, the HOCF is taken as the network control entity. As shown in <figref idref="DRAWINGS">FIG. 6B</figref>, taking the CP-segmented/network-controlled mode as an example, when the HOSF and the HODF employ different IMPUs of the handover user, the procedure of delivering a call from a third user to the HODF in the handover UE during the session handover includes the following steps:</p>
<p id="p-0254" num="0253">Step <b>6201</b>: during the establishment of the initial session, the HOSF in the handover UE triggers the control function of the AS which performs the functions of the HOCF/HOAF-CP in the home IMS network of the handover user, and establishes the CP-segmented connections under the control of the HOAF-CP to implement the conversation.</p>
<p id="p-0255" num="0254">Step <b>6202</b>: during the session handover, the home IMS network of the handover user receives a session establishment request from a third user, wherein, the session establishment request is towards the IMPU of the HOSF of the handover user.</p>
<p id="p-0256" num="0255">Step <b>6203</b>: the HOCF in the home IMS network of the handover user learns that the new session from the third user should be delivered to the HODF in the handover UE according to the handover status and relevant service logic.</p>
<p id="p-0257" num="0256">The handover status and the relevant service logic include: the HOCF learns that the HOSF is about to lose the network connection according to the handover request sent by the HOSF.</p>
<p id="p-0258" num="0257">Step <b>6204</b>: the HOCF indicates to modify the destination identifier in the session establishment request from pointing to the IMPU of the HOSF to the IMPU of the HODF, and then sends the modified session establishment request to the HODF.</p>
<p id="p-0259" num="0258">Step <b>6205</b>: the HODF determines a processing strategy for the handover session with the peer user and the new session of the third user according to the pre-set local configuration and the user indication.</p>
<p id="p-0260" num="0259">For example, the processing strategy of the HODF is to refuse the new session of the third user. Then the HODF returns a session refuse message to the third user through the home IMS network of the handover user, the third user returns a session refuse confirmation to complete the release of the new session. And then the HODF continues with the subsequent process of the handover session, e.g., establishment of the session between the HODF and the HOAF-CP, the session re-negotiation between the HOAF and the terminal side of the peer user, and the final release of the session between the HOAF-CP and the HOSF by the HOAF-CP, as illustrated in following steps.</p>
<p id="p-0261" num="0260">Step <b>6206</b>: the HODF sends a session refuse message to the third UE through the IMS network, and the third user returns a session refuse confirmation to the HODF.</p>
<p id="p-0262" num="0261">Step <b>6207</b>: the HODF continues with the handover of the session with the terminal side of the peer user, establishes a session connection between the HODF and the HOAF to continue the conversation.</p>
<p id="p-0263" num="0262">Step <b>6208</b>: the HOAF-CP sends a session release message to the HOSF, the HOSF then returns a session release success message to the HOAF-UP.</p>
<p id="p-0264" num="0263">The CS-IMS handover is described hereinafter.</p>
<p id="p-0265" num="0264">At this time, the correlated relationship between the HOSF and the HODF is the subscription identities of the same user in different network subsystems, i.e., the MSISDN and the IMPU corresponding to the same user.</p>
<p id="p-0266" num="0265">The CS-IMS handover can be accomplished in various service modes, as shown in <figref idref="DRAWINGS">FIGS. 3A</figref>, <b>3</b>B and <b>3</b>C, and the new connection can be initiated to establish by the HODF or by the HOAF-CP. Only some typical embodiments are described hereinafter.</p>
<p id="p-0267" num="0266"><figref idref="DRAWINGS">FIG. 7A</figref> is a flowchart illustrating a CS-IMS handover in an end-to-end/terminal-controlled mode according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 7A</figref>, taking the handover in the end-to-end/terminal-controlled mode while the new connection is initiated to establish by the HODF as an example, the CS-IMS handover in the embodiment of the present invention includes:</p>
<p id="p-0268" num="0267">Step <b>7101</b>: the HOSF in the handover UE initiates a call establishment request in the CS domain to the terminal side of the peer user, and the call establishment request is routed in the CS domain to the CS/IMS interworking gateway MGCF/IM-MGW.</p>
<p id="p-0269" num="0268">In the present embodiment, the peer UE is located in an IMS network. Therefore, the call establishment request is routed in the CS domain to the CS/IMS interworking gateway MGCF/IM-MGW so as to enter the IMS network of the peer user according to the existing called party analysis procedure. However, when the peer UE is located in a CS/PSTN, in order to implement the IMS based handover in various modes, the CS domain where the handover user is currently located needs to route the call to the home IMS network of the handover user. Wherein, the CS domain can determine the route to the MGCF/IM-MGW and further to the home IMS network of the handover user according to the information including: CS routing strategies (e.g., according to local static routing configuration, or triggering CAMEL for dynamic control by intelligent platform according to various conditions), or Number Portability (NP) mechanisms, or analysis of the called party number, i.e., the number of the peer user side (the handover UE provides a called party number with a special prefix in the initiated CS call establishment request, and the CS domain where the handover user currently is located performs a special routing control according to the prefix).</p>
<p id="p-0270" num="0269">Step <b>7102</b>: the CS/IMS interworking gateway performs a CS/IMS interworking process, sends an IMS session establishment request to the terminal side of the peer user through relevant nodes of the home IMS network of the handover user, the home IMS network of the peer user and the IMS network the peer user currently located;</p>
<p id="p-0271" num="0270">Step <b>7103</b>: perform a media negotiation and establish an IMS session between the terminal side of the peer user and the CS/IMS interworking gateway.</p>
<p id="p-0272" num="0271">Step <b>7104</b>: the terminal side of the peer user returns an IMS session answer response, the CS/IMS interworking gateway converts the IMS session answer response into a CS call answer response and sent the CS call answer response to the HOSF; at the same time, the CS/IMS interworking gateway returns an IMS session answer response acknowledgement to the terminal side of the peer user, and establishes a CS/IMS interworking session between the HOSF and the terminal side of the peer user.</p>
<p id="p-0273" num="0272">Step <b>7105</b>: the HODF completes an IMS registration and sends a handover event notification to the HOSF, and then the HOSF returns an event notification confirmation to the HODF.</p>
<p id="p-0274" num="0273">Step <b>7106</b>: the HOSF determines whether the session handover condition is currently satisfied; if it is satisfied, the HOSF sends a handover indication carrying session information to the HODF, then the HODF returns a handover indication confirmation to the HOSF and executes Step <b>7107</b>, otherwise, the HOSF continues with the session and ends the current procedure.</p>
<p id="p-0275" num="0274">Step <b>7107</b>: the HODF sends a session establishment request carrying the session information and the handover indication to the HOAF-CP.</p>
<p id="p-0276" num="0275">Step <b>7108</b>: the HOAF-CP determines whether the session establishment request is legal; if the request is legal, execute Step <b>7109</b>; otherwise, end the current procedure.</p>
<p id="p-0277" num="0276">Step <b>7109</b>: the HOAF and the HODF perform the establishment of the new session and the media negotiation during the session establishment.</p>
<p id="p-0278" num="0277">Step <b>7110</b>: the HOAF returns a session answer response to the HODF.</p>
<p id="p-0279" num="0278">Step <b>7111</b>: the HODF returns a session answer response acknowledgement to the HOAF.</p>
<p id="p-0280" num="0279">Thus, the new session connection between the HODF and the HOAF is established.</p>
<p id="p-0281" num="0280">Step <b>7112</b>: the HOAF sends a session release message in the IMS network to the CS/IMS interworking gateway MGCF/IM-MGW.</p>
<p id="p-0282" num="0281">Step <b>7113</b>: the CS/IMS interworking gateway performs a CS/IMS interworking process and sends a call release message in the CS domain to the HOSF.</p>
<p id="p-0283" num="0282">Step <b>7114</b>: the HOSF sends a call release complete message to the CS/IMS interworking gateway MGCF/IM-MGW.</p>
<p id="p-0284" num="0283">Step <b>7115</b>: the interworking gateway MGCF/IM-MGW performs a CS/IMS interworking process and sends a call release confirmation to the HOAF.</p>
<p id="p-0285" num="0284">Thus, the end-to-end session handover is complete, the handover user and the peer user continue their conversation through the new session connection between the HODF and the HOAF.</p>
<p id="p-0286" num="0285">To further illustrate the effectiveness of the scheme of the present embodiment in a CS-IMS handover when the peer user is in the CS/PSTN, an embodiment of the present invention is described hereinafter, wherein the handover is in the CP-segmented/terminal-controlled mode and the HODF initiates the performing of the handover, and the peer UE is currently located in a CS network.</p>
<p id="p-0287" num="0286"><figref idref="DRAWINGS">FIG. 7B</figref> is a flowchart illustrating a CS-IMS handover in a CP-segmented/terminal-controlled mode when a peer user is also located in a CS domain according to an embodiment of the invention. As shown in <figref idref="DRAWINGS">FIG. 7B</figref>, taking the handover in the CP-segmented/terminal-controlled mode and the performing of the handover initiated by the HODF as an example, the CS-IMS handover in the embodiment of the present invention includes:</p>
<p id="p-0288" num="0287">Step <b>7201</b>: the HOSF in the handover UE initiates a call establishment request in the CS domain to the terminal side of the peer user; the call establishment request is routed by the CS domain where the handover user is currently located to the CS/IMS interworking gateway MGCF/IM-MGW interworking with the home IMS network of the handover user.</p>
<p id="p-0289" num="0288">Step <b>7202</b>: the CS/IMS interworking gateway performs a CS/IMS interworking process, the control function in the AS which performs the functions of the HOAF-CP is triggered in the home IMS network of the handover user, and the HOAF-CP controls the establishment of the segmented connection. Then after an interworking processing and CS domain routing, the CS call establishment request which is used to establish the SEG<b>2</b> between the HOAF-CP and the terminal side of the peer user is sent to the terminal of the peer side according to the standard interworking procedure and through an interworking gateway, which is selected by the IMS network and interworking with the CS domain where the peer UE is currently located.</p>
<p id="p-0290" num="0289">The home IMS network of the handover user may trigger the control function in the AS that performs the functions of the HOAF-CP following the current IMS standards according to an E.164 number or a special prefix of the E.164 number modified in the routing control of the CS domain where the handover user is currently located, e.g., taking a special E.164 number or a prefix as an IMS domain Public Service Identity (PSI).</p>
<p id="p-0291" num="0290">As described above, in the present embodiment, the peer UE is currently in the CS domain, so the terminal side mentioned herein actually includes the peer UE, the interworking gateway interworking for the peer UE, and the CS connection between the interworking gateway and the peer UE.</p>
<p id="p-0292" num="0291">Step <b>7203</b>: the HOAF-CP establishes the segmented IMS session and performs a media negotiation during the session establishment respectively with the terminal side of the peer user (actually the interworking gateway interworking with the CS domain where the peer UE is currently located) and the interworking gateway interworking with the CS domain where the handover user is currently located.</p>
<p id="p-0293" num="0292">Step <b>7204</b>: the peer UE returns a CS call answer response, an interworking gateway corresponding to the peer UE converts the CS call answer response into an IMS session answer response and sends the IMS session answer response to the HOAF-CP; the HOAF-CP then returns the IMS session answer response to the CS/IMS interworking gateway, the CS/IMS interworking gateway converts the IMS session answer response into a CS call answer response and sends the CS call answer response to the HOSF; meanwhile, the CS/IMS interworking gateway sends an IMS session answer response acknowledgement to the HOAF-CP, which in turn sends the IMS session answer response acknowledgement to the terminal side of the peer user, thus the two segments of the CS/IMS interworking sessions are established respectively from the HOSF to the HOAF-CP and from the HOAF-CP to the terminal side of the peer user; then the handover user and the peer user implements conversation through the session segments.</p>
<p id="p-0294" num="0293">Step <b>7205</b>: the HODF completes an IMS registration.</p>
<p id="p-0295" num="0294">Step <b>7206</b>: the HODF performs an internal interaction with the HOSF to complete handover condition detection, and indicates to initiate a handover.</p>
<p id="p-0296" num="0295">Step <b>7207</b>: the HODF sends a session establishment request carrying session information and a handover indication to the HOAF-CP.</p>
<p id="p-0297" num="0296">Step <b>7208</b>: the HOAF-CP judges whether the session establishment request is legal; if it is legal, execute Step <b>7209</b>, otherwise, end the current procedure.</p>
<p id="p-0298" num="0297">Step <b>7209</b>: the HOAF-CP sends a re-negotiation request to the terminal side of the peer user, and indicates the terminal side of the peer user to re-direct the media streams to the HODF.</p>
<p id="p-0299" num="0298">Step <b>7210</b>: the terminal side of the peer user returns a re-negotiation response to the HOAF-CP, which in turn returns a session answer response to the HODF.</p>
<p id="p-0300" num="0299">Step <b>7211</b>: the HODF returns a session answer response acknowledgement to the HOAP-CP, which in turn returns a re-negotiation response acknowledgement to the terminal side of the peer user.</p>
<p id="p-0301" num="0300">Thus the new session connection between the HODF and the HOAF-CP is established, and the media streams are re-directed through the re-negotiation between the HOAF-CP and the terminal side of the peer user; the peer user and the handover user are transferred to the new connection to continue their conversation.</p>
<p id="p-0302" num="0301">Step <b>7212</b>: the HOAF sends a session release message in the IMS network to the CS/IMS interworking gateway MGCF/IM-MGW.</p>
<p id="p-0303" num="0302">Step <b>7213</b>: the CS/IMS interworking gateway performs a CS/IMS interworking process and sends a call release message in the CS domain to the HOSF.</p>
<p id="p-0304" num="0303">Step <b>7214</b>: the HOSF sends a call release complete message to the CS/IMS interworking gateway MGCF/IM-MGW.</p>
<p id="p-0305" num="0304">Step <b>7215</b>: the interworking gateway MGCF/IM-MGW performs a CS/IMS interworking process and sends a session release confirmation to the HOAF.</p>
<p id="p-0306" num="0305">Then, the handover from IMS to CS domain is described hereinafter.</p>
<p id="p-0307" num="0306">Similarly, the IMS-CS handover can be accomplished in various service modes, as shown in <figref idref="DRAWINGS">FIGS. 3A</figref>, <b>3</b>B and <b>3</b>C, wherein, the new connection established during the handover procedure can be initiated to establish by the HODF or by the HOAF-CP. The embodiment hereinafter shows only the performing of the handover initiated by the HODF in the CP-segmented/network-controlled mode.</p>
<p id="p-0308" num="0307"><figref idref="DRAWINGS">FIG. 9</figref> is a schematic diagram illustrating a system implementing an IMS-CS handover in a CP-segmented mode.</p>
<p id="p-0309" num="0308">In <figref idref="DRAWINGS">FIG. 9</figref>, during the establishment of the initial session connection, the connection between the HOSF in the handover UE and the HOAF-CP is the control plane first connection, i.e., leg<b>1</b>, the connection between the HOAF-CP and the terminal side of the peer user is leg<b>2</b>, and the handover user performs a conversation with the peer user through the leg<b>1</b> and the leg<b>2</b>. When the handover condition is satisfied, the HODF in the handover UE establishes a second connection, i.e., leg<b>3</b>, with the HOAF-CP through the CS domain and the interworking gateway. When the handover is accomplished, the handover user continues to perform conversation with the peer user through the leg<b>3</b> and the leg<b>2</b>.</p>
<p id="p-0310" num="0309"><figref idref="DRAWINGS">FIG. 7C</figref> is a flowchart illustrating an IMS-CS handover in a CP-segmented/network-controlled mode according to an embodiment of the present invention.</p>
<p id="p-0311" num="0310">As shown in <figref idref="DRAWINGS">FIG. 7C</figref> and <figref idref="DRAWINGS">FIG. 9</figref>, taking the handover in the CP-segmented/network-controlled mode and the performing of the handover initiated by the HODF as an example, the IMS-CS handover according to the embodiment of the present invention includes:</p>
<p id="p-0312" num="0311">Steps from Step <b>7301</b> to Step <b>7304</b> are basically identical to Step <b>5301</b>, wherein the AS that performs the function of the HOAF-CP also performs the function of the HOCF.</p>
<p id="p-0313" num="0312">Step <b>7305</b>: the HOCF detects that the handover condition is satisfied, and sends a handover indication to the HOSF.</p>
<p id="p-0314" num="0313">The HOCF may judge whether the handover condition is satisfied according to the user pre-configured strategies and related conditions, or after receiving a notification that the HOSF is about to lose the network connection or a notification that the HODF is successfully connected to the network, or according to the user indication from the HOSF/HODF. At the same time, the HOCF may initiate the handover through directly instructing the HOAF to initiate the performing of the handover, or through directly instructing the HODF to initiate the performing of the handover, or through sending a notification to the HOSF and the HOSF instructing the HOAF/HODF to initiate the performing of the handover. In the present embodiment, the HOCF judges according to the user pre-configured strategies and related conditions, and instructs the HODF through the HOSF to initiate the handover.</p>
<p id="p-0315" num="0314">As described above, the handover may also be detected and initiated by the HOSF or the HODF.</p>
<p id="p-0316" num="0315">Step <b>7306</b>: the HOSF instructs the HODF through the internal interaction to initiate a handover, and provides original session information to the HODF, the HODF sends a CS call establishment request in the CS domain where the HODF is located to the HOAF-CP, wherein, the CS call establishment request is routed by the CS domain to the CS/IMS interworking gateway interworking with the home IMS network of the handover user, converted into an IMS session establishment request by the CS/IMS interworking gateway, and routed by the home IMS network of the handover user to the AS that performs the functions of the HOAF-CP.</p>
<p id="p-0317" num="0316">Since it is the HODF who initiates the performing of the handover, the call establishment request needs to carry a handover indication, original session information and a location identifier of the HOAF-CP. In the present embodiment, since the HOAF-CP is located on the home network side of the handover user, so the HODF can obtain the location identifier of the HOAF-CP from manual settings pre-set by the user or from network settings issued to and saved in the HODF. At the same time, the HODF obtains the original session information from the HOSF. Therefore the HODF can combine the location identifier and the session information according to a pre-configured rule to form a special E.164 number. What is pointing to the AS that performs the function of the HOAF-CP can be a wildcarded IMS domain PSI, i.e., a PSI allowable with an extended part. The PSI with any value in the extended part, i.e., distinct PSI, matches the wildcarded PSI, and this extended part can be used to carry information to be transmitted. Therefore the IMS network can restore a distinct PSI from the special E.164 number through the standard procedure, and routes the session establishment request to the AS corresponding to the PSI (i.e., the AS that performs the function of the HOAF-CP), the AS compares this distinct PSI with the wildcarded PSI and obtains the information corresponding to the extended part, i.e., the original session information. In addition, the PSI itself may serve as a handover indication.</p>
<p id="p-0318" num="0317">The call establishment request may also use an ISUP special IE, e.g., a user-to-user information IE, or a call reference number IE, or a sub-address IE, to carry the original session information. At this time, the interworking gateway needs to convert the special IE to an indication in the IMS session establishment request to transmit to the HOAF-CP.</p>
<p id="p-0319" num="0318">When the HOAF-CP initiates the performing of the handover, the HOAF-CP can uses an E.164 number pointing to the HODF, such as the MSISDN of the HODF, as a destination identifier in the session establishment request, and sends the session establishment request to the HODF through the IMS network, the CS/IMS interworking gateway MGCF/IM-MGW and each entity in the CS domain.</p>
<p id="p-0320" num="0319">The E.164 number pointing to the HODF may be the MSISDN of the user or the E.164 number with a special prefix. And the E.164 number can be provided by the HOSF or the HODF in the handover indication to the HOAF-CP, or be obtained through deduction by the HOAF-CP from the identifier of the HOSF according to the network numbering plan.</p>
<p id="p-0321" num="0320">Step <b>7307</b>: the HOAF-CP verifies whether the session establishment request carries a handover indication, and further verifies whether the session establishment request is legal according to the session information in the request; if it is legal, execute Step <b>7308</b>, otherwise, end the current procedure.</p>
<p id="p-0322" num="0321">Step <b>7308</b>: the HOAF-CP sends a re-negotiation request through the SEG<b>2</b> between the HOAF-CP and the terminal side of the peer user to initiate the re-negotiation, implements the media re-direction and modifies the media attribute of the SEG<b>2</b> according to the media negotiation result on the SEG<b>3</b> between the HOAF-CP and the HODF.</p>
<p id="p-0323" num="0322">Step <b>7309</b>: the peer UE returns a re-negotiation response, the HOAF-CP then returns an IMS session answer response to the CS/IMS interworking gateway, the CS/IMS interworking gateway converts the IMS session answer response into a CS call answer response and sent the CS call answer response to the HODF through the CS domain.</p>
<p id="p-0324" num="0323">Step <b>7310</b>: the CS/IMS interworking gateway returns an IMS session answer response acknowledgement to the HOAF-CP, which in turn returns a re-negotiation response acknowledgement to the terminal side of the peer user.</p>
<p id="p-0325" num="0324">The new connection between the HODF and the HOAF-CP is thus established, and the media streams on the terminal side of the peer side is re-directed to the HODF through the re-negotiation initiated under the control of the HOAF-CP; therefore the handover user and the peer user continues their conversation through the new connection.</p>
<p id="p-0326" num="0325">Step <b>7311</b>: the HOAF-CP sends a session release message to the HODF through the IMS network.</p>
<p id="p-0327" num="0326">Step <b>7312</b>: the HOSF returns a session release confirmation message to the HOAF-CP, and the HOSF and the HOAF release the session connection between them.</p>
<p id="p-0328" num="0327">In the above embodiments, in order to keep the continuity of the media exchange during the handover better, the HOAF-UP can be equipped with media stream duplication and filtering functions. The HOAF-UP duplicates the media stream to the terminal side of the handover user and sends the duplicated media streams to the HOSF and the HODF simultaneously during the handover, and selects a valid part from the media streams from the HOSF and the HODF to send to the terminal side of the peer user (in case that the HOAF-UP is located on the home network side of the handover user in the CPandUP-segmented mode) or to present to the user (in case that the HOAF-UP is located on the terminal side of the peer user in a mode other than the CPandUP-segmented mode).</p>
<p id="p-0329" num="0328">To conclude, the method for maintaining session continuity in a network that supports multiple access technologies includes the following key points:</p>
<p id="p-0330" num="0329">1. The trigger of the HOCF function in the network-controlled mode and/or the trigger of HOAF-CP function in the segmented mode during the session establishment:</p>
<p id="p-0331" num="0330">(1) during the initial session establishment, according to the general service triggering method in the IMS, the service node S-CSCF assigned to the handover user by his/her home IMS network triggers the session to the AS that performs the functions of the HOCF/HOAF-CP according to the iFC in the subscription data downloaded from the HSS during the user registration. Wherein, in the segmented/network-controlled mode, the HOAF-CP and the HOCF are implemented in the same AS. At this time, in order to reduce the influence to other IMS services, the HOAF-CP should be set as close as possible to the HOSF/HODF, in other words:</p>
<p id="p-0332" num="0331">when the HOSF is the calling party in the initial session establishment, the priority level of the iFC corresponding to the AS that performs the function of the HOCF/HOAF-CP should be set as high as possible;</p>
<p id="p-0333" num="0332">when the HOSF is the called party in the initial session establishment, the priority level of the iFC corresponding to the AS that performs the function of the HOCF/HOAF-CP should be set as low as possible;</p>
<p id="p-0334" num="0333">(2) when the HOSF and the HODF correlated with each other through sharing an IMPU, since the IMS user subscription data is identified only through the user public identity, and the services have been triggered on the connection between the HOAF-CP and the terminal side of the peer user as much as possible in the segmented mode, duplicate triggering of other ASs on the new session between the HOAF and the HODF should be avoided. Besides the iFC priority level settings, other adoptable methods include the following: identifying the new session established during the handover when the IMS service node (S-CSCF) assigned to the handover user performing the iFC evaluation, and so as avoid the service triggering. Wherein, the method for identifying the new session may include, but is not limited to, the following: identifying the new session according to the handover indication in the session establish information, or according to special calling party information and/or called party information (e.g., the called party information pointing to the HOAF when the HODF initiates the operation of the handover, the calling party information that represents the HOAF when the HOAF initiates the performing of the handover) in the session establish information.</p>
<p id="p-0335" num="0334">2. The handover condition detection:</p>
<p id="p-0336" num="0335">(1) the handover condition detection can be performed by the HOSF, according to the conditions including the following cases and any combination of them: it is detected that the local end is about to lose the connection to the IMS network due to the problem of the access network or local equipment; a notification indicating that the HODF has successfully connected to the IMS is received; judgment based on user pre-configured conditions or related conditions; judgment based on the user indication; it is detected that the communication quality of the current access point of the HODF is higher than that of the local end; the priority level of the operator of the HODF is higher than that of the local end; the charging rate of the current access method of the HODF is lower than that of the local end;</p>
<p id="p-0337" num="0336">(2) the handover condition detection can also be performed by the HODF, according to the conditions including the following cases and any combination of them: the local end has successfully connected to the IMS; a notification indicating that the HOSF is about to lose the connection to the IMS network is received; judgment based on user pre-configured strategies and related conditions; judgment based on the user indication; the communication quality of the local end is higher than that of the HOSF; the priority level of the operator of the local end is higher than that of the HOSF; the charging rate of the current access method of the local end is lower than that of the HOSF;</p>
<p id="p-0338" num="0337">(3) the handover condition detection can also be performed by the HOCF, according to the conditions including the following cases and any combination of them: judgment based on user pre-configured strategies and related conditions; a notification indicating that the HOSF is about to lose the connection to the IMS network is received; a notification indicating that the HODF has successfully connected to the IMS is received; judgment based on the user indication from the HOSF/HODF; the communication quality of the access point of the HODF is higher than that of the HOSF; the priority level of the operator of the HODF is higher than that of the HOSF; the charging rate of the current access method of the HODF is lower than that of the HOSF.</p>
<p id="p-0339" num="0338">3. the handover authorization by the HOCF, can be performed according to the conditions including the following items and any combination of them: the legality of the HODF; the subscription capability of the HODF; the correlated relationship between the HOSF and the HODF; user pre-configured strategies and related conditions; network pre-configured strategies and related conditions; the current status and attribute of the session between the HOSF and the HOAF.</p>
<p id="p-0340" num="0339">4. the handover initiation, including the handover request and the handover authorization, which can summarized as:</p>
<p id="p-0341" num="0340">(1) the handover condition detection and the handover initiation are performed by the HOSF, including: the HOSF directly instructs the HOAF to initiate the performing of the handover; or the HOSF directly instructs the HODF to initiate the performing of the handover; or the HOSF sends a request to the HOCF, which sends an indication after the authorization succeeds to indicate the HOAF to initiate the performing of the handover; or the HOSF sends a request to the HOCF, which sends a indication after the authorization succeeds to indicate the HODF to initiate the performing of the handover; or the HOSF sends a request to the HOCF, and instructs the HOAF to initiate the performing of the handover after the HOCF returns a confirmation when the authorization succeeds; or the HOSF sends a request to the HOCF, and instructs the HODF to initiate the performing of the handover after the HOCF returns a confirmation when the authorization succeeds;</p>
<p id="p-0342" num="0341">(2) the handover condition detection and the handover initiation are performed by the HODF, including: the HODF directly initiates the performing of the handover; or the HODF sends a request to the HOCF, which sends an indication after the authorization succeeds to indicate the HOAF to initiate the performing of the handover; or the HODF sends a request to the HOCF, which returns a confirmation after the authorization succeeds to indicate the HODF to initiate the performing of the handover;</p>
<p id="p-0343" num="0342">(3) the handover condition detection and the handover initiation are performed by the HOCF, including: the HOCF directly instructs the HOAF to initiate the performing of the handover; or HOCF directly instructs the HODF to initiate the performing of the handover; or the HOCF informs the HOSF, which instructs the HOAF to initiate the performing of the handover; or the HOCF informs the HOSF, which instructs the HODF to initiate the performing of the handover;</p>
<p id="p-0344" num="0343">(4) during the handover initiation, when an entity sends a handover event notification or initiates a handover request to another entity, the interaction between them includs, but is no limited to, the following: when the two entities (e.g., the HOSF and HODF, or the HOCF and the HOAF-CP) are co-located in the same entity, internal customized interactions can be adopted, e.g., interactions through internal messages, or through a shared internal memory; otherwise, the interaction can be performed through SIP INFO and SIP NOTIFY message; or though service location means such as SLP;</p>
<p id="p-0345" num="0344">(5) during the handover initiation, when an entity instructs another entity to perform the handover, the interaction between them includes, but no limited to, the following: when the two entities (e.g., the HOSF and HODF, or the HOCF and the HOAF-CP) are co-located in the same entity, internal customized interactions can be adopted, e.g., interactions through internal messages, or through a shared internal memory; otherwise, the interaction can be performed through SIP INFO or SIP NOTIFY message, with the information of the other entity in the message; or through SIP REFER message, with the information of the other entity in a REFER-TO header.</p>
<p id="p-0346" num="0345">5, the handover execution:</p>
<p id="p-0347" num="0346">(1) the performing of the handover is initiated by the HODF:</p>
<p id="p-0348" num="0347">The HODF initiates a session establishment request to the HOAF-CP and instructs the HOAF-CP to replace the original session connection to the HOSF when the new session is established; the session establishment request carries the information of the session to be replaced between the HOSF and the HOAF and a handover indication; the handover indication can also be implicitly represented by other specific handover-related information.</p>
<p id="p-0349" num="0348">In the session establishment request, the new session can be indicated to be a replacement of the original session between the HOSF and the HOAF and session related information may be carried in the session establishment request through the REPLACES header field or special destination identifier;</p>
<p id="p-0350" num="0349">the session establishment request is pointing to the HOAF-CP, and the location identifier pointing to the HOAF-CP is obtained from the following: the information carried by the handover indication of the HOCF/HOSF during the handover initiation; the information carried in the handover or handover-related event notification from the HOCFIHOSF during the handover condition detection; wherein, the last two means, i.e., local pre-configured settings or locally stored settings issued by the network, is applicable in the CP-segmented mode and the CPandUP-segmented mode.</p>
<p id="p-0351" num="0350">The network entities involved between the HOAF and HODF can perform special processes according to the handover indication carried in the session establishment request, the special processes include: avoiding duplicate triggering of service or avoiding the influence from other services, or special charging process, etc.</p>
<p id="p-0352" num="0351">The HOAF verifies the legality of the session establish request according to the handover indication and initial session information in the session establishment request, establishes the new session, replaces the original session with the new session, and releases the original session; wherein, the replacement of the original session includes, but is not limited to: re-directe the media streams exchanged with the HOSF in the original session to exchanged with the HODF and accomplish the modification of the media streams required by the difference of the media capabilities between the HODF and the HOSF through the session media negotiation.</p>
<p id="p-0353" num="0352">The HOAF may perform some special processes according to the handover indication in the session establishment request, including avoid ringing.</p>
<p id="p-0354" num="0353">(2) the performing of the handover is initiated by the HOAF-CP:</p>
<p id="p-0355" num="0354">The HOAF initiates a session establishment request to the HODF and replaces the original session connection to the HOSF when the new session is established; the session establishment request can further carry a handover indication and HOSF-related information; wherein, the handover indication can also be implicitly carried by other specific handover-related information.</p>
<p id="p-0356" num="0355">After receiving the session establishment request, the HODF interacts with the HOAF-CP to establish the new session, and during the session establishment, the HODF performs a media negotiation with the HOAF-CP according to the media capability of the local end.</p>
<p id="p-0357" num="0356">The session establishment request is pointting to the HODF, and the location identifier pointing to the HODF can be obtained from items including: the information carried by the handover indication of the HOCF/HOSF during the handover initiation.</p>
<p id="p-0358" num="0357">The HODF can verifies the legality of the session establishment request according to the HOSF-related information in the request.</p>
<p id="p-0359" num="0358">The HODF can perform some special processes according to the handover indication or the HOSF-related information in the session establishment request, including avoid ringing.</p>
<p id="p-0360" num="0359">The network entities involved between the HOAF and the HODF can perform special processes according to the handover indication and the HOSF-related information carried in the session establishment request, the special processes include avoid duplicate triggering of service, or avoid the influence from other services, or special charging process, etc.</p>
<p id="p-0361" num="0360">It should be noted that when both the HOSF and the HODF register in the IMS (in other words, there is no such cases that access the IMS through a CS call), based on the IMS subscribed association between the HOSF and the HODF, a same service node is guaranteed to be assigned to the two entities according to the standard service node assignment process during the IMS network user registration.</p>
<p id="p-0362" num="0361">6. Special processes correlated with the CS domain:</p>
<p id="p-0363" num="0362">The CS call, which is converted into an IMS session by the CS/IMS network, is regarded as a special IMS access method, and when the HODF/HOSF adopts such access method, the IMS-CS handover will be accomplished through the above IMS-IMS handover method, including:</p>
<p id="p-0364" num="0363">(1) the HODF and the HOSF correspond respectively to the subscription identities of the same user in different network subsystems, in other words, they correspond respectively to the MSISDN and the IMPU of the same user;</p>
<p id="p-0365" num="0364">(2) when the HOSF corresponds to the above CS-IMS call, the CS domain routes the call to the CS/IMS interworking gateway MGCF/IM-MGW, and establishes a CS-IMS interworking call after the conversion performed by the MGCF/IM-MGW; the CS domain can decide the route according to the conditions including:CS routing strategies, NP mechanism and the called party number analysis;</p>
<p id="p-0366" num="0365">(3) when the HODF corresponds to the above CS-IMS call, during the session establishment between the HODF and the HOAF-CP, the CS-IMS interworking call converted by the MGCF/IM-MGW is established through the following process:</p>
<p id="p-0367" num="0366">when the performing of the handover is initiated by the HODF, the HODF takes the E.164 number which points to the HOAF-CP as the called party number; prefix may be added to distinguish the E.164 number from other E.164 numbers, or the E.164 number can be a special E.164 number.</p>
<p id="p-0368" num="0367">In the end-to-end mode, the number is provided by the HOSF or the HOCF; the number can be the MSISDN of the peer user, or the E.164 number in the IMPU of the peer user in the Tel-URI format, or the E.164 number in the IMPU of the peer user in the Tel-URI format with a special prefix;</p>
<p id="p-0369" num="0368">in the segmented mode, the number is provided by the HOSF or the HOCF, or set as a uniform service access number in the UE, or issued by the network and stored in the UE at any prior time (e.g., when the user registers in the IMS or updates the location in the CS domain); and the special E.164 number or the prefix of the E.164 number may correspond to a PSI, therefore the session can be routed to the AS that performs the function of the HOAF-CP in a standard termination routing method for the PSI.</p>
<p id="p-0370" num="0369">Moreover, the CS call establishment request from the HODF further needs to carry the original session information, the HODF may use the called party number to carry the original session information, e.g., in the segmented mode, the identifier pointing to the AS that performs the functions of the HOAF-CP can be a wildcarded PSI, the HODF combines the identifier pointing to the AS and the original session information to form a special E.164 number according to pre-configured rules. Thus the IMS network can recover a distinct PSI from the E.164 number, and then route the session establishment request to the AS, which compares the distinct PSI with the wildcarded PSI and to obtain the original session information.</p>
<p id="p-0371" num="0370">the original session information can also be carried by a special IE in the ISUP, e.g., a use-to-user information IE, or a call reference number IE, or a sub-address IE, at this time, the CS/IMS interworking gateway MGCF/IM-MGW needs to recover the original session information from the received CS call establishment request, and sends the original session information to the HOAF-CP through the converted IMS session establishment request.</p>
<p id="p-0372" num="0371">The CS domain is responsible for routing a CS call to the CS/IMS interworking gateway MGCF/IM-MGW according to the E.164 number, and further establishes a CS-IMS interworking call converted by the MGCF/IM-MGW; the CS domain can decide the route according to the conditions including:CS routing strategies, NP mechanism and the called party number analysis.</p>
<p id="p-0373" num="0372">The CS domain can perform, according to the E.164 number or the prefix of the E.164 number, some special processes including: avoid influences of the supplementary services on the CS originating side, avoid Customized Application for Mobile network Enhanced Logic (CAMEL) triggering, special charging process, including routing control for routing the call to the CS/IMS interworking gateway.</p>
<p id="p-0374" num="0373">The IMS network routes the session to the HOAF-CP according to the special E.164 number or the prefix of the E.164 number cooperating with the MGCF, ENUM server and the data settings of the IMS network, wherein, the HOAF-CP includes the peer UE that performs the functions of the HOAF in the end-to-end mode and the AS that performs the function of the HOCF/HOAF-CP in the segmented mode.</p>
<p id="p-0375" num="0374">When the performing of the handover is initiated by the HOAF-CP, the HOAF-CP may take the MSISDN of the handover user or the MSISDN number with a special prefix as the called party number, wherein, the MSISDN number is provided by the HOSFIHOCF in the handover indication, or deduced from the identity of the HOSF according to the network numbering plan.</p>
<p id="p-0376" num="0375">The IMS network routes the session to the selected MGCF according to the number in combination with the data settings of the ENUM and IMS network, the CS network accomplishes a standard number analysis and the called party addressing to route the call request to the HODF, and further establishes an IMS-CS interworking call converted by the MGCF/IM-MGW.</p>
<p id="p-0377" num="0376">If the called party number is the MSISDN with a special prefix, the gateway can remove the prefix and uses the MSISDN to complete the interaction with the CS network;</p>
<p id="p-0378" num="0377">if the called party number is the MSISDN with a special prefix, the gateway can further recognize the call as an IMS-CS handover call according to the prefix after removing the prefix, so that a special indication can be added into the CS call control signaling to enable the CS network or the peer user to perform a special process on the IMS-CS handover call;</p>
<p id="p-0379" num="0378">The CS network can perform some special processes according to the above special indication or prefix, including:</p>
<p id="p-0380" num="0379">special charging process, e.g., reduce a part of CS call fee according to the indication, which needs corresponding function extension of the charging system;</p>
<p id="p-0381" num="0380">service conflict process, e.g., avoid the invocation of a part of CS domain supplementary services according to the indication, such as call forwarding, call barring and intelligent triggering, which needs corresponding function extension of the CS network.</p>
<p id="p-0382" num="0381">The HODF can perform some special processes according to the special indication, including: identify the call as an IMS-CS handover call to prompt the user through a pop-up menu or special ringing, or avoid ringing.</p>
<p id="p-0383" num="0382">7. the processing of the session establishment request towards the IMPU of the HOSF from a third user:</p>
<p id="p-0384" num="0383">(1) when the HOSF and the HODF are correlated through a shared IMPU which is used for the terminating addressing:</p>
<p id="p-0385" num="0384">the IMS network performs a forking process on the corresponding addresses of the HOSF and the HODF according to the IMPU;</p>
<p id="p-0386" num="0385">the HOSF receives the forking session establishment request, and refuses the request;</p>
<p id="p-0387" num="0386">the HODF receives the forking session establishment request, regards the request as a legal new session establishment request, and accepts or refuses the request according to the new session processing principles of the user/local end.</p>
<p id="p-0388" num="0387">(2) when the HOSF and the HODF have different IMPUs which are used for the terminating addressing in the network-controlled mode (including the end-to-end mode and segmented mode) or the segmented mode (including the CP-segmented mode and the CPandUP segmented mode), since all the terminating procedures towards the user will be triggered to the AS that performs the function of the HOCF/HOAF-CP, the AS can control the re-direction of the session that originally destined to the IMPU of the HOSF to the IMPU of the HODF according to the handover status and the user subscription. The above control can be implemented through returning a 3XX (SIP re-direction indication) or directly modifying a forwarding SIP message Request-URI (Universal Resource Identity, also referred to as a destination identifier or a destination address herein).</p>
<p id="p-0389" num="0388">The fore-going are the implementations of the present invention in the IMS network, and when implemented in the NGN, the principles are basically identical to those in the IMS network, and the differences in the NGN are:</p>
<p id="p-0390" num="0389">(1) the correlated relationship between the HOSF and the HODF:</p>
<p id="p-0391" num="0390">in the NGN, a user does not have a clear definition of the IMPI and the IMPU, therefore in the NGN, the correlated relationship between the HOSF and the HODF is generally represented by a subscription association between them on the service layer, or represented by an association between other user identites similar as the IMPI and the IMPU.</p>
<p id="p-0392" num="0391">(2) when the HOCF and the HOAF-CP are located on the network side of the handover user, the mapping of their functions in the network and the trigger of their functions during the initial session establishment:</p>
<p id="p-0393" num="0392">in the NGN, there is no clear definition similar as the open service architecture and service triggering control mechanism in the IMS network. Therefore, in the NGN, the entities that performs the functions of the HOCF/HOAF-CP on the network side in the network-controlled and/or segmented mode can be a soft switching entity in the NGN, or an AS implemented using the service architecture in the IMS for reference. If the AS is adopted, the triggering of the AS can be performed through a customized service triggering method defined in the NGN, or through a mechanism similar to the IMS network triggering mechanism.</p>
<p id="p-0394" num="0393">Despite of the above differences, the present invention is totally applicable to the NGN that supports multiple access technologies and adopts the SIP as the session control protocol.</p>
<p id="p-0395" num="0394">To sum up, the foregoing are only the preferred embodiments of the present invention and are not for use for confining the protection scope of the present invention. Any modification, equivalent substitution, improvement within the spirit and principle of the present invention should be covered in the protection scope of the present invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for maintaining session continuity, comprising:
<claim-text>triggering a Handover Anchor Function-Control Plane (HOAF-CP) on a home network side of a first user, and establishing a first connection, wherein the first connection comprises a control plane first connection between a Handover Source Function (HOSF) of the first user and the HOAF-CP and a user plane first connection between the HOSF and a Handover Anchor Function-User Plane (HOAF-UP) of a second user; establishing a control plane connection between the HOAF-CP and a terminal side of the second user, and establishing a session between the first user and the second user through the user plane first connection, the control plane first connection and the control plane connection between the HOAF-CP and a terminal side of the second user;</claim-text>
<claim-text>determining that a handover condition is satisfied, and establishing a second connection, wherein the second connection comprises a control plane second connection between a Handover Destination Function (HODF) of the first user and the HOAF-CP and a user plane second connection between the HODF and the HOAF-UP; and</claim-text>
<claim-text>continuing the session between the first user and the second user through the user plane second connection between the HODF and the HOAF-UP, the control plane second connection between the HODF and the HOAF-CP, and the control plane connection, which is already established between the HOAF-CP and the terminal side of the second user before the handover condition is satisfied.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>configuring a Handover Control Function (HOCF) on the home network side of the first user, wherein the first connection and the second connection are established under control of the HOCF.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein if it is the HOSF that detects the handover condition is satisfied, the method comprising at least one of:
<claim-text>the HOSF sending a handover request to the HOCF, the HOCF performing an authorization and notifying the HOSF after the authorization succeeds; after receiving an authorization pass message from the HOCF, the HOSF sending a handover indication message to the HODF or the HOAF-CP, and the HODF or the HOAF-CP which receives the handover indication message initiating to establish the second connection; or,</claim-text>
<claim-text>the HOSF sending a handover request to the HOCF, the HOCF performing an authorization and sending a handover indication message to the HODF or the HOAF-CP if the authorization succeeds, and the HODF or the HOAF-CP which receives the handover indication message initiating to establish the second connection.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein if it is the HODF that detects that the handover condition is satisfied, the method comprising at least one of:
<claim-text>the HODF sending a handover request to the HOCF, the HOCF performing an authorization and if the authorization succeeds, the HOCF sending a handover indication message to the HODF or the HOAF-CP, and the HODF or the HOAF-CP, which receives the handover indication message, initiating to establish the second connection; or</claim-text>
<claim-text>the HODF sending a handover request to the HOCF, the HOCF sending a handover indication message to the HOSF and the HOSF sending the handover indication message to the HODF or the HOAF-CP; and the HODF or the HOAF-CP, which receives the handover indication message, initiating to establish the second connection.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein if it is the HOCF that detects the handover condition is satisfied, the method comprising at least one of:
<claim-text>the HOCF sending a handover indication message to the HODF or the HOAF-CP, and the HODF or the HOAF-CP, which receives the handover indication message, initiating to establish the second connection; or</claim-text>
<claim-text>the HOCF sending a handover indication message to the HOSF and the HOSF sending the handover indication message to the HODF or the HOAF-CP, and the HODF or the HOAF-CP, which receives the handover indication message, initiating to establish the second connection.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the HOSF and the HODF of the first user have different IP Multimedia public identities (IMPUs), and
<claim-text>the method comprises:</claim-text>
<claim-text>a home network of the first user receiving a session establishment request to the HOSF of the first user from a third user;</claim-text>
<claim-text>the HOCF or the HOAF-CP on the home network side of the first user modifying a destination identifier pointing to the HOSF in the session establishment request to the one pointing to the HODF, and then the home network of the first user sending the session establishment request to the HODF;</claim-text>
<claim-text>the HODF determining whether to accept the session establishment request from the third user.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the HOCF is implemented in a same Application Server (AS) with the HOAF-CP.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising:
<claim-text>the HOCF updating the handover condition correlated with a terminal and pre-stored in the HOCF through signaling interaction between the HOCF and the terminal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the HODF initiates to establish the second connection and the method further comprises: the HODF acquiring an identifier pointing to the HOAF-CP and initiating a connection establishment request according to the identifier pointing to the HOAF-CP; wherein the identifier pointing to the HOAF-CP is obtained by the HOSF during the establishment of the first connection and sent to the HODF by the HOSF, or the identifier pointing to the HOAF-CP is obtained by the HOCF during the control of the establishment of the first connection and sent to the HODF by the HOCF.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the HODF initiates to establish the second connection and the method further comprises: the HODF obtaining session information of the first connection and initiating a connection establishment request to the HOAF-CP carrying the session information of the first connection;
<claim-text>wherein the session information of the first connection is obtained by the HOCF during the control of the establishment of the first connection and sent to the HODF by the HOCF.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the HOAF-CP initiates to establish the second connection and the method further comprises: the HOAF-CP obtaining an HODF identifier pointing to the HODF and initiating a connection establishment request to the HODF according to the HODF identifier; wherein the HODF identifier is sent to the HOAF-CP by the HOSF or the HODF identifier is obtained by the HOCF during the control of the establishment of the first connection and sent to the HOAF-CP by the HOCF.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein if it is the HOSF that detects the handover condition is satisfied, the HOSF sending a handover indication message to the HODF, and the HODF initiating to establish the second connection; or the HOSF sending a handover indication message to the HOAF-CP, and the HOAF-CP initiating to establish the second connection; or
<claim-text>if it is the HODF that detects the handover condition is satisfied, the HODF initiating to establish the second connection.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method according to <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein if it is the HOSF that detects the handover condition is satisfied, the HOSF detecting that a communication quality by using the HODF is higher than a communication quality by using the HOSF.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the step of establishing the second connection comprises:
<claim-text>the HODF obtaining session information of the first connection and initiating a connection establishment request to the HOAF-CP, wherein the connection establishment request carries the session information of the first connection and a handover indication;</claim-text>
<claim-text>after receiving the connection establishment request, the HOAF-CP interacting with the HODF to establish the control plane second connection between the HODF and the HOAF-CP, and the user plane second connection between the HODF and the HOAF-UP.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method according to <claim-ref idref="CLM-00014">claim 14</claim-ref>, further comprising:
<claim-text>before the HOAF-CP interacts with the HODF, the HOAF-CP checking whether the connection establishment request carries the handover indication; if the connection establishment request carries the handover indication, the HOAF-CP checking whether the connection establishment request is legal according to the session information carried in the connection establishment request; if the connection establishment request is legal, the HOAF-CP executing the step of interacting with the HODF to establish the control plane second connection and the user plane second connection, if the connection establishment request is illegal, the HOAF-CP sending a message to the HODF to reject the connection establishment request, keeping the session with the HOSF.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method according to <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the handover indication is represented by a REPLACES header field, and the session information is carried by the REPLACES header field; or, the handover indication is represented by an address pre-configured as a destination address of the connection establishment request.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method according to <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the connection establishment request is transmitted through an IP Multimedia Subsystem (IMS) network or a Next Generation Network (NGN) from the HODF to the HOAF-CP;
<claim-text>the method further comprises: network entities in the IMS network or the NGN providing the handover indication to a charging system to indicate whether a connection is the second connection to perforin charging reduction.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method according to <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the session information of the first connection is obtained by the HOSF during the establishment of the first connection and sent to the HODF by the HOSF; or,
<claim-text>a Handover Control Function (HOCF) is configured on the home network side of the first user, the session information of the first connection is obtained by the HOCF during the establishment of the first connection and sent to the HODF by the HOCF.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the HODF initiates to establish the second connection, the HODF is located in a Circuit Switched (CS) domain, and the HOAF-CP is located in an IP Multimedia Subsystem (IMS) domain, the method comprising:
<claim-text>the HODF initiating in the CS domain a CS call establishment request carrying a called party number; and the CS domain sending the CS call establishment request to an interworking gateway between the CS domain and the IMS domain; wherein the called party number is at least one of: a Mobile Station Integrated Service Digital Network (MSISDN) number of the second user, an E.164 number in a Public User Identity of the second user in a Tel-Uniform Resource Identifier (Tel-URI) format, an MSISDN number with a prefix, an E.164 number with a prefix, and an E.164 number composed according to an identifier pointing to the HOAF-CP obtained by the HODF;</claim-text>
<claim-text>after receiving the CS call establishment request, the interworking gateway between the CS domain and the IMS domain converting the CS call establishment request into an IMS session establishment request, and sending the IMS session establishment request to the HOAF-CP.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the HOAF-CP initiates to establish the second connection, and the method comprises:
<claim-text>the HOAF-CP obtaining an HODF identifier pointing to the HODF, and initiating a connection establishment request to the HODF according to the HODF identifier;</claim-text>
<claim-text>after receiving the connection establishment request, the HODF interacting with the HOAF-CP to establish the control plane second connection with the HOAF-CP, and the user plane second connection with the HOAF-UP.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The method according to <claim-ref idref="CLM-00020">claim 20</claim-ref>, wherein the connection establishment request is sent by the HOAF-CP to the HODF through an IP Multimedia Subsystem (IMS) network or a Next Generation Network (NGN), and the connection establishment request carries information of the HOSF or a handover indication, the method further comprises:
<claim-text>network entities in the IMS network or the NGN providing the handover indication or the information of the HOSF to a charging system to indicate whether a connection is the second connection to perform charging reduction.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The method according to <claim-ref idref="CLM-00020">claim 20</claim-ref>, wherein
<claim-text>the HODF identifier is sent to the HOAF-CP by the HOSF;</claim-text>
<claim-text>or, a Handover Control Function (HOCF) is configured on the home network side of the first user, the HODF identifier is obtained by the HOCF during the establishment of the first connection and sent to the HOAF-CP by the HOCF.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The method according to <claim-ref idref="CLM-00020">claim 20</claim-ref>, wherein the connection establishment request carries information of the HOSF;
<claim-text>before the HODF interacts with the HOAF-CP, the method further comprises:</claim-text>
<claim-text>the HODF checking whether the connection establishment request carries the information of the HOSF; if the connection establishment request carries the information of the HOSF, checking whether the connection establishment request is legal according to a pre-configured association between the HOSF and the HODF.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the HODF or the HOAF-CP initiates to establish the second connection the method further comprising:
<claim-text>the HOAF-CP sending a session establishment request to an interworking gateway, wherein the session establishment request carries a called party number, and the called party number is a Mobile Station Integrated Service Digital Network (MSISDN) number of the first user pointing to the HODF or a Mobile Station Integrated Service Digital Network (MSISDN) number with a prefix;</claim-text>
<claim-text>after receiving the session establishment request, the interworking gateway converting the session establishment request into a CS call establishment request, and sending the CS call establishment request to the HODF in the CS domain according to the called party number; and</claim-text>
<claim-text>after receiving the CS call establishment request, the HODF interacting with the HOAF-CP to establish the control plane second connection, and the user plane second connection is established between the HODF and HOAF-UP.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The method according to <claim-ref idref="CLM-00024">claim 24</claim-ref>, further comprising:
<claim-text>after the CS domain receiving the CS call establishment request, the CS domain adding an identifier in a Call Detailed Record (CDR) according to the prefix or an indication carried in the CS call establishment request.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the HOSF and the HODF are respectively corresponding to different IP Multimedia public identities (IMPUs) of a same IP Multimedia private identity (IMPI) of the first user; or respectively corresponding to different IMPIs of a same IMPU of the first user; or respectively corresponding to different IMPUs and IMPIs belonging to a same subscription of the first user in an IMS network; or associated with each other through the first user subscription relationship between different subsystems on an operator layer.</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the HODF initiates to establish the second connection and the method comprises:
<claim-text>the HODF obtaining an identifier pointing to the HOAF-CP and initiating a connection establishment request according to the identifier pointing to the HOAF-CP, wherein the identifier pointing to the HOAF-CP is obtained by the HOSF during the establishment of the first connection and sent to the HODF by the HOSF, or the identifier pointing to the HOAF-CP is obtained by the HODF according to an advance configuration of the HODF.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text>28. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the HOSF and the HODF of the first user have different IP Multimedia public identities (IMPUs), and
<claim-text>the method comprises:</claim-text>
<claim-text>a home network of the first user receiving a session establishment request to the HOSF of the first user from a third user;</claim-text>
<claim-text>the HOAF-CP on the home network side of the first user modifying a destination identifier pointing to the HOSF in the session establishment request to the one pointing to the HODF, and then the home network of the first user sending the session establishment request to the HODF; and</claim-text>
<claim-text>the HODF determining whether to accept the session establishment request from the third user.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00029" num="00029">
<claim-text>29. A system for maintaining session continuity, comprising: a Handover Source Function (HOSF), a Handover Destination Function (HODF), a Handover Anchor Function-Control Plane (HOAF-CP), a Handover Anchor Function-User Plane (HOAF-UP) and a Handover Detection Function; wherein the HOSF and the HODF are located in a same terminal of a first user or different terminals of the first user, the HOAF-CP is located on a home network side of the first user, the HOAF-UP is located on a terminal side of a second user, and the HOAF-CP is a control resource;
<claim-text>the HOSF is configured to establish a first connection comprising a control plane first connection between the HOSF and the HOAF-CP and a user plane first connection between the HOSF and the HOAF-UP when the first user initiates or accepts a session;</claim-text>
<claim-text>the HODF is configured to establish a second connection comprising a control plane second connection between the HODF and the HOAF-CP and a user plane second connection between the HODF and the HOAF-UP when a handover condition is satisfied;</claim-text>
<claim-text>the HOAF-CP is configured to establish the control plane first connection between the HOSF and the HOAF-CP when the first user initiates or accepts the session; establish a control plane connection between the terminal side of the second user and the HOAF-CP; establish the control plane second connection between the HODF and the HOAF-CP when the handover condition is satisfied; the HOAF-CP is further configured to perform control over the control plane first connection, the control plane second connection and the control plane connection with the terminal side of the second user, and replace the control plane first connection between the HOSF and the HOAF-CP with the control plane second connection between the HODF and the HOAF-CP;</claim-text>
<claim-text>the HOAF-UP is configured to establish the user plane first connection between the HOSF and the HOAF-UP during the establishment of the control plan first connection and the control plane connection between the HOAF-CP and the terminal side of the second user; establish the user plane second connection between the HODF and the HOAF-UP during the establishment of the control plan second connection; and replace the user plane first connection with the user plane second connection; and</claim-text>
<claim-text>the Handover Detection Function is configured to detect whether the handover condition is satisfied.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00030" num="00030">
<claim-text>30. The system according to <claim-ref idref="CLM-00029">claim 29</claim-ref>, wherein the HOAF-CP is configured to perform control over the establishment of the control plane first connection and the control plane connection between the HOAF-CP and the terminal side of the second user, control to establish the user plane first connection between the HOSF and the HOAF-UP on the terminal side of the second user; and
<claim-text>during the establishment of the control plane second connection, initiate a re-negotiation on the control plane connection between the HOAF-CP and the terminal side of the second user and accomplishing the re-negotiation by interacting with the terminal side of the second user, control to establish the user plane second connection between the HODF and the HOAF-UP and indicating the HOAF-UP to replace the user plane first connection with the user plane second connection, and when media capabilities of the HODF and the HOSF are different from each other, add or delete media stream or modify attribute of exchanged media stream according to the media capability of the HODF.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00031" num="00031">
<claim-text>31. The system according to <claim-ref idref="CLM-00029">claim 29</claim-ref>, further comprising: an HOCF on the home network side of the first user, configured to control the establishments of the first connection and the second connection by sending signal streams between the HOSF and the HOAF-CP, or between the HODF and the HOAF-CP.</claim-text>
</claim>
<claim id="CLM-00032" num="00032">
<claim-text>32. The system according to <claim-ref idref="CLM-00031">claim 31</claim-ref>, wherein the Handover Detection Function is a logic unit in the HOCF, and the HOCF is further configured to send to the HODF or the HOAF-CP, or send a handover indication to the HODF through the HOSF when detecting that the handover condition is satisfied.</claim-text>
</claim>
<claim id="CLM-00033" num="00033">
<claim-text>33. The system according to <claim-ref idref="CLM-00031">claim 31</claim-ref>, wherein the Handover Detection Function is further configured to send a handover request message to the HOCF when detecting that the handover condition is satisfied, and send a handover indication to the HODF or the HOAF-CP after receiving an authorization pass notification from the HOCF; and
<claim-text>the HOCF is further configured to perform an authorization when receiving the handover request message, and send the authorization pass notification to the Handover Detection Function after authorization succeeds.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00034" num="00034">
<claim-text>34. The system according to <claim-ref idref="CLM-00032">claim 32</claim-ref>, wherein the HODF is further configured to initiate a second connection establishment request to the HOAF-CP after receiving the handover indication.</claim-text>
</claim>
<claim id="CLM-00035" num="00035">
<claim-text>35. The system according to <claim-ref idref="CLM-00032">claim 32</claim-ref>, wherein the HOAF-CP is further configured to initiate a second connection establishment request to the HODF after receiving the handover indication.</claim-text>
</claim>
<claim id="CLM-00036" num="00036">
<claim-text>36. The system according to <claim-ref idref="CLM-00029">claim 29</claim-ref>, wherein the Handover Detection Function is further configured to send a handover indication to the HODF or the HOAF-CP when detecting that the handover condition is satisfied.</claim-text>
</claim>
<claim id="CLM-00037" num="00037">
<claim-text>37. The system according to <claim-ref idref="CLM-00029">claim 29</claim-ref>, wherein the Handover Detection Function is a logic unit in the HODF, the HODF is further configured to initiate a second connection establishment request to the HOAF-CP when-the handover condition is satisfied.</claim-text>
</claim>
<claim id="CLM-00038" num="00038">
<claim-text>38. The system according to <claim-ref idref="CLM-00029">claim 29</claim-ref>, wherein when receiving a connection establishment request from a third user to the HOSF of the first user, the HOCF or the HOAF-CP located on the home network side of the first user is configured to send a new session from the third user to the HODF of the first user.</claim-text>
</claim>
<claim id="CLM-00039" num="00039">
<claim-text>39. A system for maintaining session continuity, comprising: a Handover Source Function (HOSF), a Handover Destination Function (HODF), a Handover Anchor Function-Control Plane (HOAF-CP), a Handover Anchor Function-User Plane (HOAF-UP) and a Handover Detection Function; wherein the HOSF and the HODF are located in a same terminal or different terminals of a first user, the HOAF-CP and HOAF-UP are located on a home network side of the first user, the HOAF-CP is control resource, the HOAF-UP is media resource;
<claim-text>the HOSF is configured to establish a first connection comprising a control plane first connection between the HOSF and the HOAF-CP and a user plane first connection between the HOSF and the HOAF-UP when the first user initiates or accepts a session;</claim-text>
<claim-text>the HODF is configured to establish a second connection comprising a control plane second connection between the HODF and the HOAF-CP and a user plane second connection between the HODF and the HOAF-UP when a handover condition is satisfied;</claim-text>
<claim-text>the HOAF-CP is configured to establish the control plane first connection between the HOSF and the HOAF-CP when the first user initiates or accepts the session; establish a control plane connection between a terminal side of a second user and the HOAF-CP; establish the control plane second connection between the HODF and the HOAF-CP when the handover condition is satisfied; the HOAF-CP is further configured to perform control over the control plane first connection, the control plane second connection and the control plane connection between the terminal side of the second user and the HOAF-CP, replace the control plane first connection between the HOSF and the HOAF-CP with the control plane second connection between the HODF and the HOAF-CP;</claim-text>
<claim-text>the HOAF-UP is configured to establish the user plane first connection between the HOSF and the HOAF-UP; establish a user plane connection between the terminal side of the second user and the HOAF-UP, and connect the user plane connection between the HOAF-UP and the terminal side of the second user with the user plane first connection; establish the user plane second connection between the HODF and the HOAF-UP; and connect the user plane connection between the HOAF-UP and the terminal side of the second user with the user plane second connection instead of the user plane first connection; and</claim-text>
<claim-text>the Handover Detection Function is configured to detect whether the handover condition is satisfied.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00040" num="00040">
<claim-text>40. The system according to <claim-ref idref="CLM-00039">claim 39</claim-ref>, wherein the HOAF-CP is configured to:
<claim-text>perform control over the establishments of the control plane first connection and the control plane connection between the terminal side of the second user and the HOAF-CP, control to establish the user plane first connection between the HOAF-UP and the HOSF and the user plane connection between the terminal side of the second user and the HOAF-UP, and control the HOAF-UP to connect the user plane first connection and the user plane second connection; and</claim-text>
<claim-text>during the establishment of the control plane second connection between the HOAF-CP and the HODF, control to establish the user plane second connection between the HOAF-UP and the HODF, control the HOAF-UP to connect the user plane connection between the HOAF-UP and the terminal side of the second user, with the user plane second connection instead of the user plane first connection, and</claim-text>
<claim-text>when media capabilities of the HODF and the HOSF are different from each other, during the establishment of the control plane second connection, initiate a re-negotiation on the control plane connection with the terminal side of the second user and accomplishing the re-negotiation by interacting with the terminal side of the second user, add or delete media stream or modifying attribute of exchanged media stream between the HOAF-UP and the terminal side of the second user according to the media capability of the HODF.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00041" num="00041">
<claim-text>41. A method for maintaining session continuity, comprising:
<claim-text>triggering a Handover Anchor Function-Control Plane (HOAF-CP) on a home network side of a first user, and establishing a first connection comprising a control plane first connection between a Handover Source Function (HOSF) of the first user and the HOAF-CP and a user plane first connection between the HOSF and a Handover Anchor Function-User Plane (HOAF-UP) on the home network side of the first user, establishing a control plane connection between the HOAF-CP and a terminal side of a second user and a user plane connection between the HOAF-UP and the terminal side of the second user, and establishing a session between the first user and the second user through the control plane first connection, the control plane connection between the HOAF-CP and the terminal side of the second user, the user plane first connection, and the user plane connection between the HOAF-UP and the terminal side of the second user;</claim-text>
<claim-text>determining that a handover condition is satisfied, establishing a second connection, wherein the second connection comprises a control plane second connection between a Handover Destination Function (HODF) of the first user and the HOAF-CP and a user plane second connection between the HODF and the HOAF-UP;</claim-text>
<claim-text>continuing the session between the first user and the second user through the control plane second connection between the HODF of the first user and the HOAF-CP and the control plane connection between the HOAF-CP and the terminal side of the second user, and the user plane second connection between the HODF of the first user and the HOAF-UP and the user plane connection between the HOAF-UP and the terminal side of the second user.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
