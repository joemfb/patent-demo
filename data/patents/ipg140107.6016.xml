<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08627139-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08627139</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13112729</doc-number>
<date>20110520</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>CN</country>
<doc-number>2008 1 0226739</doc-number>
<date>20081121</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>199</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>11</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>714  61</main-classification>
<further-classification>714 43</further-classification>
<further-classification>714746</further-classification>
</classification-national>
<invention-title id="d2e71">Method, recording terminal, server, and system for repairing media file recording errors</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6640145</doc-number>
<kind>B2</kind>
<name>Hoffberg et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>700 83</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7065212</doc-number>
<kind>B1</kind>
<name>Yu et al.</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380205</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7742429</doc-number>
<kind>B1</kind>
<name>Huang et al.</name>
<date>20100600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370254</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7826527</doc-number>
<kind>B2</kind>
<name>Wang</name>
<date>20101100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375240</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>8279726</doc-number>
<kind>B2</kind>
<name>Utsumi et al.</name>
<date>20121000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>369 4712</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2002/0152440</doc-number>
<kind>A1</kind>
<name>Yona et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714746</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2002/0165791</doc-number>
<kind>A1</kind>
<name>Segawa et al.</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 26</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2003/0236905</doc-number>
<kind>A1</kind>
<name>Choi et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709231</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2004/0073916</doc-number>
<kind>A1</kind>
<name>Petrovic et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>725 18</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2005/0160308</doc-number>
<kind>A1</kind>
<name>Elcock et al.</name>
<date>20050700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2005/0182842</doc-number>
<kind>A1</kind>
<name>Walsh et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2005/0249231</doc-number>
<kind>A1</kind>
<name>Khan</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370428</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2006/0023652</doc-number>
<kind>A1</kind>
<name>Vedantham et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2006/0026295</doc-number>
<kind>A1</kind>
<name>Iwamura</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709233</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2006/0179154</doc-number>
<kind>A1</kind>
<name>Sitaraman et al.</name>
<date>20060800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709231</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2006/0285501</doc-number>
<kind>A1</kind>
<name>Damm</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370252</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2008/0052404</doc-number>
<kind>A1</kind>
<name>Leighton et al.</name>
<date>20080200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709231</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2008/0141309</doc-number>
<kind>A1</kind>
<name>Barsness</name>
<date>20080600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2009/0144596</doc-number>
<kind>A1</kind>
<name>Mohan</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714746</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2009/0144769</doc-number>
<kind>A1</kind>
<name>Liebhold et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>2009/0158096</doc-number>
<kind>A1</kind>
<name>Ali et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714 43</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>2009/0257512</doc-number>
<kind>A1</kind>
<name>Demas et al.</name>
<date>20091000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>37524027</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2010/0046634</doc-number>
<kind>A1</kind>
<name>Dai et al.</name>
<date>20100200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>37524025</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>2010/0050225</doc-number>
<kind>A1</kind>
<name>Bennett</name>
<date>20100200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>725144</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>2010/0100528</doc-number>
<kind>A1</kind>
<name>Brockway et al.</name>
<date>20100400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707610</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>2010/0125768</doc-number>
<kind>A1</kind>
<name>Mauchly et al.</name>
<date>20100500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714749</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>2010/0128595</doc-number>
<kind>A1</kind>
<name>Karaoguz et al.</name>
<date>20100500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370216</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>2010/0228857</doc-number>
<kind>A1</kind>
<name>Petrovic et al.</name>
<date>20100900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709224</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00029">
<document-id>
<country>US</country>
<doc-number>2011/0083037</doc-number>
<kind>A1</kind>
<name>Bocharov et al.</name>
<date>20110400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714  411</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00030">
<document-id>
<country>US</country>
<doc-number>2011/0219258</doc-number>
<kind>A1</kind>
<name>Cooper et al.</name>
<date>20110900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714  2</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00031">
<document-id>
<country>US</country>
<doc-number>2011/0246621</doc-number>
<kind>A1</kind>
<name>May et al.</name>
<date>20111000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709219</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00032">
<document-id>
<country>US</country>
<doc-number>2011/0268175</doc-number>
<kind>A1</kind>
<name>Tan et al.</name>
<date>20111100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>37524001</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00033">
<document-id>
<country>US</country>
<doc-number>2012/0023239</doc-number>
<kind>A1</kind>
<name>Fan et al.</name>
<date>20120100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709227</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00034">
<document-id>
<country>US</country>
<doc-number>2012/0026393</doc-number>
<kind>A1</kind>
<name>Petrovic et al.</name>
<date>20120200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>348462</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00035">
<document-id>
<country>US</country>
<doc-number>2012/0060052</doc-number>
<kind>A1</kind>
<name>White et al.</name>
<date>20120300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714  63</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00036">
<document-id>
<country>US</country>
<doc-number>2012/0060053</doc-number>
<kind>A1</kind>
<name>White et al.</name>
<date>20120300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714  63</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00037">
<document-id>
<country>CN</country>
<doc-number>1969528</doc-number>
<kind>A</kind>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00038">
<document-id>
<country>CN</country>
<doc-number>101202908</doc-number>
<kind>A</kind>
<date>20080600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00039">
<document-id>
<country>CN</country>
<doc-number>101212618</doc-number>
<kind>A</kind>
<date>20080700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00040">
<document-id>
<country>CN</country>
<doc-number>101267524</doc-number>
<kind>A</kind>
<date>20080900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00041">
<document-id>
<country>CN</country>
<doc-number>101300834</doc-number>
<kind>A</kind>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00042">
<document-id>
<country>CN</country>
<doc-number>101420317</doc-number>
<kind>A</kind>
<date>20090400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00043">
<document-id>
<country>CN</country>
<doc-number>101420317</doc-number>
<kind>B</kind>
<date>20111000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00044">
<document-id>
<country>JP</country>
<doc-number>2006352264</doc-number>
<kind>A</kind>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00045">
<document-id>
<country>WO</country>
<doc-number>WO 2008/012488</doc-number>
<kind>A2</kind>
<date>20080100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00046">
<othercit>Office Action issued in corresponding Chinese Patent Application No. 200810226739.9, mailed Aug. 11, 2010.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00047">
<othercit>Extended European Search Report issued in corresponding European Patent Application No. 09827149.7, mailed Jul. 20, 2011.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00048">
<othercit>Written Opinion of the International Searching Authority issued in corresponding PCT Patent Application No. PCT/CN2009/074368, mailed Jan. 21, 2010.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00049">
<othercit>International Search Report issued in corresponding PCT Patent Application No. PCT/CN2009/074368, mailed Jan. 21, 2010.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>21</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>714  61</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>9</number-of-drawing-sheets>
<number-of-figures>11</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>PCT/CN2009/074368</doc-number>
<date>20091009</date>
</document-id>
<parent-status>PENDING</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13112729</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110225454</doc-number>
<kind>A1</kind>
<date>20110915</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Fan</last-name>
<first-name>Yunsong</first-name>
<address>
<city>Chengdu</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Fan</last-name>
<first-name>Yunsong</first-name>
<address>
<city>Chengdu</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Brinks Gilson &#x26; Lione</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Huawei Device Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Patel</last-name>
<first-name>Kamini</first-name>
<department>2114</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method, a recording terminal, a server, and a system for repairing media file recording errors are disclosed in embodiments of the present invention. The method includes: generating description information about a recording error when a recording terminal identifies the recording error in live recording of a media file; sending a recording error repair request that carries the description information to a network device; and repairing the media file recorded by the recording terminal according to repair information when receiving the repair information sent by the network device according to the description information. With the present invention, the recording errors are repaired through a bidirectional network between the recording terminal and the network device, and reliability of repairing the recording errors is ensured.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="102.87mm" wi="148.51mm" file="US08627139-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="117.60mm" wi="161.12mm" file="US08627139-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="210.90mm" wi="156.80mm" file="US08627139-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="232.58mm" wi="167.72mm" file="US08627139-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="117.26mm" wi="161.12mm" file="US08627139-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="212.17mm" wi="124.88mm" orientation="landscape" file="US08627139-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="177.55mm" wi="163.24mm" file="US08627139-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="213.19mm" wi="143.34mm" orientation="landscape" file="US08627139-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="178.22mm" wi="179.58mm" file="US08627139-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="210.90mm" wi="176.95mm" file="US08627139-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is a continuation of International Application No. PCT/CN2009/074368, filed on Oct. 9, 2009, which claims priority to Chinese Patent Application No. 200810226739.9, filed on Nov. 21, 2008, both of which are hereby incorporated by reference in their entireties.</p>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to a network communication technology, and in particular, to a method, a recording terminal, a server, and a system for repairing media file recording errors.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">In the research and standardization process of Internet Protocol Television (IPTV), the video recording service in the IPTV draws a lot of attention. When live television signals are transmitted through a cable network, a terrestrial transmission network, a satellite live network, or an IP network, the video recording service stores the live television content on a local storage device connected to the terminal or on a network storage space for future use. Video recording implements core functions such as receiving, descrambling, re-encrypting, and storing compressed code streams. Many mitigation measures may be taken to reduce recording errors. Such measures include: enhancing the network transmission quality, identifying and correcting transmission errors based on a specific algorithm, using a reliable transmission protocol to ensure transmission quality, improving stability of a recording terminal (primarily ensuring stability of the storing unit) or correcting errors through automatic frame skipping in the playing process. Although the recording errors of live videos may be reduced through the mitigation measures, the transmission link is not absolutely reliable, and therefore recording errors are not completely evitable.</p>
<p id="p-0005" num="0004">When a live video recording error occurs, the live video with the recording error needs to be repaired. A prior art that repairs recording errors include: When a live video recording error occurs, searching an Electronic Program Guide (EPG) to check whether the same program exists in the subsequent time segments, and, if the same program exists in the subsequent time segments, triggering a new recording task automatically.</p>
<p id="p-0006" num="0005">In the process of implementing the present invention, the inventor finds that in the prior art which repairs an program with a recording error by recording the same program in a subsequent time segment, the repair depends on existence of the same program in different time segments, and that the reliability of repairing the recording error is low.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0007" num="0006">The embodiments of the present invention provide a method, a recording terminal, a server, and a system for repairing media file recording errors so as to improve reliability of repairing recording errors and reduce line bandwidth consumed by the repair.</p>
<p id="p-0008" num="0007">A method for repairing media file recording errors provided in an embodiment of the present invention includes:</p>
<p id="p-0009" num="0008">generating description information about a recording error when a recording terminal identifies the recording error in live recording of a media file;</p>
<p id="p-0010" num="0009">sending a recording error repair request that carries the description information to a network device; and</p>
<p id="p-0011" num="0010">repairing the media file recorded by the recording terminal according to repair information when receiving the repair information sent by the network device according to the description information.</p>
<p id="p-0012" num="0011">In the method provided in the foregoing embodiment, when the recording terminal records the media file erroneously, the recording terminal sends a recording error repair request that carries description information about the recording error to the network device through a bidirectional network between the recording terminal and the network device, and repairs the recorded media file according to the repair information sent by the network device, ensuring reliability of repairing the media file recording error.</p>
<p id="p-0013" num="0012">A recording terminal provided in an embodiment of the present invention includes a recording module and further includes:</p>
<p id="p-0014" num="0013">a generating module, configured to generate description information about a recording error when identifying the recording error in live recording of a media file;</p>
<p id="p-0015" num="0014">a repair requesting module, configured to send a recording error repair request that carries the description information to a network device; and</p>
<p id="p-0016" num="0015">a repairing module, configured to repair the media file recorded by the recording terminal according to repair information when receiving the repair information sent by the network device according to the description information.</p>
<p id="p-0017" num="0016">In the embodiment above, when the recording terminal identifies a recording error in the live recording of a media file, the repair requesting module sends a recording error repair request that carries description information about the recording error to the network device through a bidirectional network between the recording terminal and the network device, and the repairing module repairs the recorded media file according to the repair information sent by the network device, ensuring reliability of repairing the media file recording error.</p>
<p id="p-0018" num="0017">A network server provided in an embodiment of the present invention includes:</p>
<p id="p-0019" num="0018">a network recording module, configured to record a media file live;</p>
<p id="p-0020" num="0019">a storing module, configured to store data recorded by the recording module; and</p>
<p id="p-0021" num="0020">a recording managing module, configured to: receive a recording error repair request that carries description information about a recording error identified by a recording terminal in live recording of the media file; and obtain recording data that matches the description information from the storing module, and send the recording data to the recording terminal.</p>
<p id="p-0022" num="0021">In the embodiment above, the network server receives a recording error repair request from a recording terminal through a bidirectional network between the recording terminal and the network server, and sends recording data that matches the request to the recording terminal. In this way, the recording terminal can repair the recorded media file, and the reliability of repairing the media file recording error is ensured.</p>
<p id="p-0023" num="0022">Another network server provided in an embodiment of the present invention includes:</p>
<p id="p-0024" num="0023">a repair request receiving module, configured to receive a recording error repair request that carries description information about a recording error identified by a recording terminal in live recording of a media file;</p>
<p id="p-0025" num="0024">a broadcasting module, configured to broadcast a query request that carries the description information; and</p>
<p id="p-0026" num="0025">a repair request responding module, configured to send information about another recording terminal to the recording terminal when receiving a query response sent by the another recording terminal which stores recording data that matches the description information to a second network server.</p>
<p id="p-0027" num="0026">In the embodiment above, the network server receives a recording error repair request from a recording terminal through a bidirectional network between the recording terminal and the network server, and sends information about another recording terminal to the recording terminal, where the another recording terminal stores the recording data that matches the request. In this way, the recording terminal that sends the recording error repair request can obtain correct recording data from the another recording terminal to repair the recorded media file, ensuring reliability of repairing the media file recording error.</p>
<p id="p-0028" num="0027">A system for repairing media file recording errors in an embodiment of the present invention includes a live system head-end, a network device, and a recording terminal.</p>
<p id="p-0029" num="0028">The recording terminal is configured to: generate description information about a recording error when identifying the recording error in live recording of a media file of the live system head-end; send a recording error repair request that carries the description information to the network device; and repair the media file recorded by the recording terminal according to repair information when receiving the repair information sent by the network device according to the description information.</p>
<p id="p-0030" num="0029">The network device is configured to send the repair information that matches the description information to the recording terminal when receiving the recording error repair request.</p>
<p id="p-0031" num="0030">In the system provided in the foregoing embodiment, when the recording terminal records the media file of the live system head-end erroneously, the system sends a recording error repair request that carries description information about the recording error to the network device through a bidirectional network between the recording terminal and the network device, and repairs the recorded media file according to the repair information sent by the network device, ensuring reliability of repairing the media file recording error.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0032" num="0031">To describe the technical solution under the present invention more clearly, the following briefly describes the accompanying drawings involved in the embodiments of the present invention. Apparently, the accompanying drawings below are not exhaustive, and persons of ordinary skill in the art can derive other drawings from such accompanying drawings without any creative effort.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 1</figref> is a flow chart of a method for repairing media file recording errors according to a first embodiment of the present invention;</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 2</figref> is a flow chart of a method for repairing media file recording errors according to a second embodiment of the present invention;</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 3</figref> is a flow chart of a method for repairing media file recording errors according to a third embodiment of the present invention;</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 4</figref> is a flow chart of a method for repairing media file recording errors according to a fourth embodiment of the present invention;</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 5</figref> shows a structure schematic diagram of a recording terminal according to an embodiment of the present invention;</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 6</figref> shows a structure schematic diagram of a network server according to an embodiment of the present invention;</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 7</figref> shows a structure schematic diagram of another network server according to an embodiment of the present invention;</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 8</figref> shows a structure schematic diagram of a system for repairing media file recording errors according to a first embodiment of the present invention;</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 9</figref> shows a structure schematic diagram of a system for repairing media file recording errors according to a second embodiment of the present invention;</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 10</figref> shows a structure schematic diagram of a system for repairing media file recording errors according to a third embodiment of the present invention; and</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 11</figref> shows a structure schematic diagram of a system for repairing media file recording errors according to a fourth embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE EMBODIMENTS</heading>
<p id="p-0044" num="0043">The technical solution under the present invention is described below with reference to accompanying drawings and exemplary embodiments.</p>
<p id="p-0045" num="0044">In the following detailed embodiments, &#x201c;live recording&#x201d; means that a recording terminal or a network device records a media file played by a live system head-end through a live network; and &#x201c;recording error&#x201d; means that data recorded by the recording terminal is different from the original data of the live system head-end due to faults of network transmission, faults of the recording terminal, or other faults.</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 1</figref> is a flow chart of a method for repairing media file recording errors according to a first embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 1</figref>, the method in this embodiment includes the following steps:</p>
<p id="p-0047" num="0046">Step <b>101</b>: Generate description information about a recording error when the recording terminal identifies the recording error in live recording of a media file.</p>
<p id="p-0048" num="0047">Step <b>103</b>: Send a recording error repair request that carries the description information to the network device, where the description information is generated in step <b>101</b> mentioned above.</p>
<p id="p-0049" num="0048">Step <b>105</b>: Repair the media file recorded by the recording terminal according to repair information when receiving the repair information sent by the network device according to the description information.</p>
<p id="p-0050" num="0049">In the embodiment above, when the recording terminal records the media file erroneously, the recording terminal sends a recording error repair request that carries description information about the recording error to the network device through a bidirectional network between the recording terminal and the network device, and repairs the recorded media file according to the repair information sent by the network device, ensuring reliability of repairing the media file recording error.</p>
<p id="p-0051" num="0050">In the process of implementing the present invention, the inventor finds that many methods for mitigating recording errors are available, as exemplified below:</p>
<p id="p-0052" num="0051">Enhancing network transmission quality: The essence of this method is to enhance the quality of physical links. Major factors related to the quality of the physical links include transmission loss, transmission interference, and multi-path effect, which are generally overcome by link negotiation and line shielding. However, the satellite and terrestrial live television transmission networks are vulnerable to external interference because the transmission medium is air, and the transmission of such networks is never errorless. Even worse, interference from strong signals may deteriorate the signal quality drastically.</p>
<p id="p-0053" num="0052">Correcting network transmission errors: Link transmission errors are identified and corrected according to redundant information such as linear packet codes, cyclical codes, and convolutional codes. However, the use of the redundant information is unable to eliminate network transmission errors thoroughly. In satellite and terrestrial transmission, data fragments may not be normally receivable due to continuous interference.</p>
<p id="p-0054" num="0053">Improving stability of the recording terminal: The recording terminal is a mechanical and electronic apparatus, and is vulnerable to vibration interference, electromagnetic interference, and network collision. The structure of the recording terminal may be designed as vibration-proof and the hardware of the recording terminal may be designed as electromagnetic compatible to minimize the external interference, but the interference cannot be eliminated completely.</p>
<p id="p-0055" num="0054">Reliable transmission protocol: A reliable transmission protocol is an error recovery solution based on a bidirectional communication mechanism, and is applicable when the live service is provided based on a bidirectional communication network, for example, over the Transmission Control Protocol (TCP) based on an IP network; if a packet is transmitted erroneously, the reliable transmission protocol may require retransmission of the packet. However, due to delay requirements of live broadcast, this mitigation method is limited to be implemented within the time range when the live service is cached on the terminal.</p>
<p id="p-0056" num="0055">Correcting playing errors on the recording terminal: The correction of playing errors is popular. Its conception is frame skipping, which makes the recorded file be played normally. The correction of playing errors improves the user experience to some extent, but it does not repair the data essentially.</p>
<p id="p-0057" num="0056">Evidently, the foregoing methods reduce recording errors in the live recording of the media file, but the recording errors are still inevitable. Therefore, it is necessary to repair recording errors that occur in the live recording. In the prior art, the method for repairing the recording errors on the recording terminal is based on a unidirectional network where the media file is broadcast live. That is, the live system head-end can send downlink data to the recording terminal, but the recording terminal cannot send uplink data to the live system head-end. Different from the recording error repair method based on a unidirectional network in the prior art, the embodiments of the present invention support a recording terminal and a network device of the live system; when a recording error occurs during network transmission or the recording process of the recording terminal, the recording terminal sends a recording error repair request that carries description information about the recording error to the network device through a bidirectional communication network between the recording terminal and the network device, and repairs the recorded media file according to the repair information sent by the network device. This ensures reliability of repairing the media file recording error.</p>
<p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. 2</figref> is a flow chart of a method for repairing media file recording errors according to a second embodiment of the present invention. In this embodiment, the bidirectional network where the recording terminal and the network device are located adopts a Client/Server (C/S) architecture. In this embodiment, the network device is a first network server, and both the first network server and the recording terminal support the live recording service on the network. As shown in <figref idref="DRAWINGS">FIG. 2</figref>, the method according to this embodiment includes the following steps:</p>
<p id="p-0059" num="0058">Step <b>201</b>: The recording terminal records a media file broadcast live by the live system head-end through a live network, and checks whether any recording error occurs in the recorded media file.</p>
<p id="p-0060" num="0059">A recording error may be identified in the following ways:</p>
<p id="p-0061" num="0060">In the live recording of the media file, the recording terminal keeps monitoring the live media file while receiving the media file from the live system head-end through a live network. If any frame is lost or damaged due to packet loss, disorder or packet error in the data receiving process, the recording terminal determines that a recording error occurs.</p>
<p id="p-0062" num="0061">If the recording terminal cannot identify or record the recording error in real time due to faults of network transmission or faults of the recording terminal in the process of receiving the media file, the recording error may be identified when the recording terminal decodes the recorded media file. When the recording terminal finds that the recorded media file cannot be decoded correctly, the recording terminal determines that a recording error occurs.</p>
<p id="p-0063" num="0062">A recording error may also be identified manually. If the recording terminal fails to identify the recording error in real time when receiving the media file and finds no exception when decoding the recorded media file, but a partial area of the screen is messed or mosaic in the process of playing the recorded media file, the recording error may be identified manually.</p>
<p id="p-0064" num="0063">Step <b>203</b>: When identifying a recording error, the recording terminal records information about the recording error, and generates description information about the recording error.</p>
<p id="p-0065" num="0064">When identifying a recording error, the recording terminal may generate description information about the recording error according to the type of the recording error. The generated description information includes the type of the recording error. For example, when the media file broadcast by the live system head-end is transmitted on the network in the form of video frames, the recording terminal may record the recording error in the following ways:</p>
<p id="p-0066" num="0065">When the recording error is loss of a frame (namely, data of a video frame is lost), the recording terminal may set the type value of the recording error to 1. In this case, the recording terminal needs to record information about the lost frame, including identification information and time information of the correct video frame adjacent to the lost video frame. Accordingly, the generated description information about the error type may include: type of the recording error (the type value is 1), and identification information and time information of the correct video frame adjacent to the lost video frame. If the live media file is transmitted in the format of bit streams in the network, the identification information of the correct video frame adjacent to the lost video frame may include the start code prefix of the correct video frame adjacent to the lost video frame. The start code prefix may be a start_code_prefix parameter defined in the Network Abstraction Layer (NAL) in the H.264 video coding standard. If the live media file is transmitted in the format of packets in the network, the identification information about the correct video frame adjacent to the lost video frame may include a transmission protocol index and partial bytes of the video frame; and the time information may include a Decoding Time Stamp (DTS) or calendar time.</p>
<p id="p-0067" num="0066">When the recording error is damage of a frame (namely, a video frame is partially damaged), the recording terminal may set the type value of the recording error to 2. In this case, the recording terminal needs to record information about the damaged frame, including identification information of the damaged video frame, and identification information and time information of the correct video frame adjacent to the damaged video frame. Accordingly, the generated description information about the error type may include: type of the recording error (the type value is 2), and identification information and time information of the correct video frame adjacent to the damaged video frame.</p>
<p id="p-0068" num="0067">If the recording error is identified manually, the type value of the recording error may be set to 3. In this case, the recording terminal needs to record the start time point and the end time point within which a partial area of the screen is messed or mosaic, and record the duration. When the recording error is identified manually, because a reaction time is generally needed for manual identification, a preset response period needs to be added before and after the recorded start time point and the end time point. Preferably, the response period is 300 ms.</p>
<p id="p-0069" num="0068">Step <b>205</b>: The recording terminal sends a recording error repair request that carries the description information about the recording error to the first network server.</p>
<p id="p-0070" num="0069">Step <b>207</b>: The first network server receives and parses the recording error repair request, searches the media file recorded by the first network server to find recording data that matches the description information about the recording error, and sends the recording data as repair information to the recording terminal.</p>
<p id="p-0071" num="0070">Step <b>209</b>: The recording terminal repairs the recorded media file according to the recording data sent by the first network server.</p>
<p id="p-0072" num="0071">When receiving the repair information from the first network server, the recording terminal may initiate repair of the media file recording error in flexible ways. For example, the recording terminal starts a procedure for repairing the recording error automatically when receiving the repair information from the first network server; or starts a procedure for repairing the recording error automatically when preset conditions are fulfilled; or starts a procedure for repairing the recording error as triggered by external factors such as manual start by the user.</p>
<p id="p-0073" num="0072">In another prior art that repairs recording errors, the recording terminal can correct and repair the recorded content based on a program transmitted after a delay. After the delay, the same program is transmitted on another channel. In the process of implementing the present invention, the inventor finds that in the prior art which transmits the same program on another channel later after the program is broadcast live, the repair of the recording error requires replacement of the entire media file recorded by the recording terminal, and needs to occupy the channel for a long time, which reduces the utilization of the line bandwidth.</p>
<p id="p-0074" num="0073">Different from the prior art above, the recording terminal according to an embodiment of the present invention repairs the specific data fragment recorded erroneously in the media file in view of the type of the recording error according to recording data sent by the first network server. This reduces the line bandwidth occupied by the repair and improves the utilization of the line bandwidth.</p>
<p id="p-0075" num="0074">For example, if the recording error is loss of a frame, the recording terminal inserts the repair information from the first network server into a corresponding location of the lost video frame in the media file recorded by the recording terminal.</p>
<p id="p-0076" num="0075">If the recording error is damage of a frame, the recording terminal uses the repair information from the first network server to replace the corresponding data of the damaged video frame in the media file recorded by the recording terminal.</p>
<p id="p-0077" num="0076">If the recording error is another type of error, the recording terminal uses the repair information from the first network server to replace the corresponding data that needs repair in the media file recorded by the recording terminal.</p>
<p id="p-0078" num="0077">Step <b>211</b>: After repairing the recorded media file, the recording terminal performs a decoding test on the repaired fragment.</p>
<p id="p-0079" num="0078">To reduce the line bandwidth occupied by the repair of the media file recording error, the recording terminal may start the decoding test on the repaired fragment automatically when the recording terminal is idle. For example, when the user is not using the recording terminal, the recording terminal starts the decoding test on the repaired fragment automatically, and outputs no video in the process of the decoding test.</p>
<p id="p-0080" num="0079">If the repaired fragment passes the decoding test, the process for repairing the recording error is ended. If the repaired fragment fails to pass the decoding test, the recording terminal generates description information about the recording error again, sends a recording error repair request to the first network server again, and repeats steps <b>207</b> to <b>211</b> until success of repairing the recording error. Therefore, the decoding test performed on the repaired fragment ensures that the repaired data is normally decodable, and ensures accuracy and reliability of the recording error repair.</p>
<p id="p-0081" num="0080">In a C/S network architecture in this embodiment, the recording error in the media file recorded by the recording terminal is repaired through a bidirectional communication network between the recording terminal of the live recording service and the first network server, and the reliability of repairing the media file recording error is ensured. The recording error description information generated by the recording terminal includes the details of the recording error, which helps the first network server obtain the matched repair information accurately according to the description information, and improves the accuracy of repairing the recording error. When receiving the repair information from the first network server, the recording terminal repairs the recording error according to the actual requirements flexibly. For example, the recording terminal inserts the correct data into the locations of the specific data fragment recorded erroneously, or replaces the specific data fragment in the media file recorded by the recording terminal instead of replacing the entire media file recorded by the recording terminal. This reduces the line bandwidth occupied by the repair of the recording error, and improves the utilization of the line bandwidth. Further, after the recording error is repaired, the recording terminal tests the repaired fragments, and the repair procedure is not ended until the fragments pass the test successfully, improving reliability and accuracy of repairing the recording error.</p>
<p id="p-0082" num="0081"><figref idref="DRAWINGS">FIG. 3</figref> is a flow chart of a method for repairing media file recording errors according to a third embodiment of the present invention. In this embodiment, the network devices include a Point to Point (P2P) node server and other recording terminals which are connected with the P2P node server, where the P2P node server is a second network server, and the recording terminal and other recording terminals are based on a P2P network architecture. As shown in <figref idref="DRAWINGS">FIG. 3</figref>, the method in this embodiment includes the following steps:</p>
<p id="p-0083" num="0082">Step <b>301</b>: The recording terminal records a media file broadcast live by the live system head-end through a live network, and checks whether any recording error occurs in the recorded media file.</p>
<p id="p-0084" num="0083">The methods for identifying a recording error are the same as those described in the embodiment shown in <figref idref="DRAWINGS">FIG. 2</figref> above.</p>
<p id="p-0085" num="0084">Step <b>303</b>: When identifying a recording error, the recording terminal generates description information about the recording error.</p>
<p id="p-0086" num="0085">When identifying a recording error, the recording terminal may generate the description information about the recording error according to the type of the recording error. The generated description information includes the type of the recording error. For example, when the media file broadcast by the live system head-end is transmitted on the network in the form of data fragments, the recording terminal may record the recording error in the following ways:</p>
<p id="p-0087" num="0086">When the recording error is loss of an intra-fragment frame (namely, the data fragment is not lost but incomplete, and one or more video frames are lost), the recording terminal sets the type value of the recording error to 4. In this case, the recording terminal needs to record the information about the lost intra-fragment frame, including information about the data fragment where the lost video frame is located, and identification information and time information of the correct video frame adjacent to the lost video frame. Accordingly, the generated description information about the error type may include: type of the recording error (the type value is 4), the information about the data fragment where the lost video frame is located, and the identification information and the time information of the correct video frame adjacent to the lost video frame. If the live media file is transmitted in the format of bit streams in the network, the identification information of the correct video frame adjacent to the lost video frame may include the start code prefix of the correct video frame adjacent to the lost video frame. The start code prefix may be a start_code_prefix parameter defined in the NAL in the H.264 video coding standard. If the live media file is transmitted in the format of packets in the network, the identification information of the correct video frame adjacent to the lost video frame may include a transmission protocol index and partial bytes of the video frame. The time information may include a DTS or calendar time.</p>
<p id="p-0088" num="0087">When the recording error is loss of a fragment (namely, a data fragment is lost), the recording terminal may set the type value of the recording error to 5. In this case, the recording terminal needs to record the information about the lost fragment, including the information about the correct data fragment adjacent to the lost data fragment. Accordingly, the generated description information about the error type may include: type of the recording error (the type value is 5), and the information about the correct data fragment adjacent to the lost data fragment. When the recording error indicates that certain data fragments are lost and that information in other data fragments is incomplete, the data fragments with incomplete information may be processed as lost data fragments, and the type of the recording error is regarded as damage of a fragment (the type value is 5).</p>
<p id="p-0089" num="0088">When the recording error is damage of an intra-fragment frame (namely, some video frames in a data fragment are damaged), the recording terminal may set the type value of the recording error to 6. In this case, the recording terminal needs to record the information about the damaged intra-fragment frame, including information about the data fragment where the damaged video frame is located, and identification information and time information of the correct video frame adjacent to the damaged video frame. Accordingly, the generated description information about the error type may include: type of the recording error (the type value is 6), the information about the data fragment where the damaged video frame is located, and the identification information and the time information of the correct video frame adjacent to the damaged video frame.</p>
<p id="p-0090" num="0089">When the recording error is damage of a fragment (namely, the data of a data fragment is damaged), the recording terminal may set the type value of the recording error to 7. In this case, the recording terminal needs to record the information about the damaged fragment, including information about the damaged data fragment, and identification information and time information of the correct data fragment adjacent to the damaged data fragment. Accordingly, the generated description information about the error type may include: type of the recording error (the type value is 7), the information about the damaged data fragment, and the identification information and the time information of the correct data fragment adjacent to the damaged data fragment.</p>
<p id="p-0091" num="0090">If the recording error is identified manually, the type of the recording error is set to another value such as 3. In this case, the recording terminal needs to record the start time point and the end time point within which a partial area of the screen is messed or mosaic, and record the duration. When the recording error is identified manually, because a reaction time is generally needed for manual identification, a preset response period needs to be added before and after the recorded start time point and the end time point. Preferably, the response period is 300 ms.</p>
<p id="p-0092" num="0091">Step <b>305</b>: The recording terminal sends a recording error repair request that carries the description information about the recording error to a P2P node server (a second network server).</p>
<p id="p-0093" num="0092">Step <b>307</b>: The P2P node server (the second network server) parses the received recording error repair request, and broadcasts a query request that carries the description information about the recording error to other recording terminals.</p>
<p id="p-0094" num="0093">Step <b>309</b>: Another recording terminal which stores recording data that matches the description information about the recording error sends a query response to the P2P node server (the second network server).</p>
<p id="p-0095" num="0094">Step <b>311</b>: The P2P node server (the second network server) sends information about the another recording terminal to the recording terminal which sends the recording error repair request.</p>
<p id="p-0096" num="0095">Step <b>313</b>: The recording terminal obtains the recording data that matches the description information about the recording error from the another recording terminal according to the information about the another recording terminal. The recording data is used by the recording terminal as repair information for repairing the recording error.</p>
<p id="p-0097" num="0096">Step <b>315</b>: The recording terminal repairs the media file recorded by itself.</p>
<p id="p-0098" num="0097">When receiving the repair information from another recording terminal, the recording terminal may initiate repair of the media file recording error in flexible ways. For example, the recording terminal starts a procedure for repairing the recording error automatically when receiving the repair information; or starts a procedure for repairing the recording error automatically when preset conditions are fulfilled; or starts a procedure for repairing the recording error as triggered by external factors such as manual start by the user. When the recording terminal initiates repair of the recording error, the recording terminal may use the recording data of another recording terminal to repair the recording error in the recorded media file in view of the type of the recording error.</p>
<p id="p-0099" num="0098">For example, if the recording error is loss of an intra-fragment frame or loss of a fragment, the recording terminal inserts the repair information from another recording terminal into the corresponding location of the lost video frame in the media file recorded by the recording terminal, or the corresponding location of the lost data fragment.</p>
<p id="p-0100" num="0099">If the recording error is damage of an intra-fragment frame or damage of a fragment, the recording terminal uses the repair information from another recording terminal to replace the corresponding data of the damaged video frame in the media file recorded by the recording terminal, or the corresponding data of the damaged data fragment.</p>
<p id="p-0101" num="0100">If the recording error is another type of error, the recording terminal uses the repair information from the first network server to replace the corresponding data that needs repair in the media file recorded by the recording terminal.</p>
<p id="p-0102" num="0101">Step <b>317</b>: After repairing the recorded media file, the recording terminal performs a decoding test on the repaired fragment.</p>
<p id="p-0103" num="0102">To reduce the line bandwidth occupied by the repair of the media file recording error, the recording terminal may start the decoding test on the repaired fragment automatically when the recording terminal is idle. For example, when the user is not using the recording terminal, the recording terminal starts the decoding test on the repaired fragment automatically, and outputs no video in the process of the decoding test.</p>
<p id="p-0104" num="0103">If the repaired fragment passes the decoding test, the procedure for repairing the recording error is ended. If the repaired fragment fails to pass the decoding test, the recording terminal generates description information about the recording error again, sends a recording error repair request to the second network server again, and repeats steps <b>307</b> to <b>317</b> until success of repairing the recording error. Therefore, the decoding test performed on the repaired fragment ensures that the repaired data is normally decodable, and ensures accuracy and reliability of the recording error repair.</p>
<p id="p-0105" num="0104">In the embodiment above, while the recording terminal records the media file live through a live network, the recording terminal can repair the recording error in the media file based on the P2P communication technology, where the media file is recorded by the recording terminal, and the repair is performed through a bidirectional communication network between the recording terminal of the live recording service and another recording terminal. In this way, the reliability of repairing the media file recording error is ensured. The recording error description information generated by the recording terminal includes the details of the recording error, which helps other recording terminals obtain the matched repair information accurately according to the description information, and improves the accuracy of repairing the recording error. When receiving the repair information from another recording terminal, the recording terminal can repair the recording error according to actual requirements flexibly, reducing the line bandwidth occupied by the repair of the recording error. Further, after the recording error is repaired, the recording terminal tests the repaired fragments, and the repair procedure is not ended until the fragments pass the test successfully, improving reliability and accuracy of repairing the recording error.</p>
<p id="p-0106" num="0105"><figref idref="DRAWINGS">FIG. 4</figref> is a flow chart of a method for repairing media file recording errors according to a fourth embodiment of the present invention. When a recording error occurs in a media file recorded by a recording terminal, the recording error may be repaired through multiple heterogeneous networks. In this embodiment, the architecture of the bidirectional network connected to the recording terminal may be a C/S network architecture or a P2P network architecture. The server that supports the live recording service in the C/S network architecture is a first network server; and the P2P node server in the P2P network is a second network server in this embodiment. The P2P network may include many other recording terminals. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, the method in this embodiment includes the following steps:</p>
<p id="p-0107" num="0106">Step <b>401</b>: The recording terminal records a media file broadcast live by the live system head-end through a live network, and checks whether any recording error occurs in the recorded media file.</p>
<p id="p-0108" num="0107">Step <b>403</b>: When identifying a recording error, the recording terminal generates description information about the recording error.</p>
<p id="p-0109" num="0108">Step <b>405</b>: The recording terminal sends a recording error repair request that carries the description information about the recording error to a first network server and a P2P node server (a second network server).</p>
<p id="p-0110" num="0109">The recording terminal may send the recording error repair request to the first network server and the P2P node server (the second network server) one by one or simultaneously.</p>
<p id="p-0111" num="0110">In the case that the recording error repair request is sent to the two network servers one by one, if the recording terminal sends a recording error repair request to either network server first and receives a correct response from this network server, the recording terminal may give up sending the recording error repair request to the other network server; if the recording terminal does not receive a correct response from this network server, the recording terminal sends the recording error repair request to the other network server.</p>
<p id="p-0112" num="0111">In the case that the recording error repair request is sent to the first network server and the second network server simultaneously, when the recording terminal receives a correct response from either of the network servers, the recording terminal may send a recording error repair cancelation request to the other network server.</p>
<p id="p-0113" num="0112">In this embodiment, the recording error is repaired through a heterogeneous bidirectional network associated with the recording terminal. When the recording terminal fails to obtain the repair information in the interactive communication with one network server, the recording terminal can obtain the record information required for repairing the recording error through the other network server, improving reliability of repairing the recording error.</p>
<p id="p-0114" num="0113"><figref idref="DRAWINGS">FIG. 5</figref> shows a structure schematic diagram of a recording terminal according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 5</figref>, the recording terminal in this embodiment includes:</p>
<p id="p-0115" num="0114">a recording module <b>51</b>, configured to record a media file through a live network, where the media file is played by a live system head-end;</p>
<p id="p-0116" num="0115">a generating module <b>52</b>, configured to generate description information about a recording error when identifying the recording error in live recording of the media file;</p>
<p id="p-0117" num="0116">a repair requesting module <b>53</b>, configured to send a recording error repair request to a network device, where the recording error repair request carries the description information generated by the generating module <b>52</b>; and</p>
<p id="p-0118" num="0117">a repairing module <b>54</b>, configured to repair the media file recorded by the recording module <b>51</b> according to repair information when receiving the repair information sent by the network device according to the description information.</p>
<p id="p-0119" num="0118">On the basis of the foregoing technical solution, when the description information about the recording error includes the type of the recording error, the repairing module <b>54</b> may further include:</p>
<p id="p-0120" num="0119">a receiving unit <b>541</b>, configured to receive the repair information sent by the network device according to the description information about the recording error;</p>
<p id="p-0121" num="0120">an inserting unit <b>542</b>, configured to insert repair information into a corresponding location of a lost video frame in the media file recorded by the recording terminal if the recording error is loss of a frame, or into a corresponding location of a lost data fragment if the recording error is loss of a fragment; and</p>
<p id="p-0122" num="0121">a replacing unit <b>543</b>, configured to use the repair information to replace the corresponding data in a damaged video frame in the media file recorded by the recording terminal if the recording error is damage of a frame, or replace the corresponding data in a damaged data fragment if the recording error is damage of a fragment.</p>
<p id="p-0123" num="0122">On the basis of the foregoing technical solution, when the network devices include the first network server and the second network server, the repair requesting module <b>53</b> may further include a first repair requesting unit <b>531</b> and a second repair requesting unit <b>532</b>.</p>
<p id="p-0124" num="0123">The first repair requesting unit <b>531</b> is configured to send a recording error repair request to the first network server.</p>
<p id="p-0125" num="0124">The second repair requesting unit <b>532</b> is configured to send a recording error repair request to the second network server.</p>
<p id="p-0126" num="0125">The repair requesting module <b>53</b> may send the recording error repair request to the first network server and the second network server one by one or send the recording error repair request to the first network server and the second network server simultaneously.</p>
<p id="p-0127" num="0126">If the repair requesting module <b>53</b> sends the recording error repair request to the first network server and the second network server one by one, the recording terminal may further include a timing module <b>55</b>.</p>
<p id="p-0128" num="0127">The timing module <b>55</b> is configured to: activate the first repair requesting unit <b>531</b> to send the recording error repair request to the first network server and start a timer, and activate the second repair requesting unit <b>532</b> to send the recording error repair request to the second network server if the repairing module <b>54</b> receives no correct response from the first network server within a preset time.</p>
<p id="p-0129" num="0128">Alternatively, the timing module <b>55</b> is configured to: activate the second repair requesting unit <b>532</b> to send the recording error repair request to the second network server and start a timer, and activate the first repair requesting module <b>531</b> to send the recording error repair request to the first network server if the repairing module <b>54</b> receives no correct response from the second network server within a preset time.</p>
<p id="p-0130" num="0129">If the repair requesting module <b>53</b> sends the recording error repair request to the first network server and the second network server simultaneously, the recording terminal may further include a repair request cancelling module <b>56</b>.</p>
<p id="p-0131" num="0130">The repair request cancelling module <b>56</b> is configured to send a recording error repair cancellation request to the second network server when the repairing module <b>54</b> receives a response from the first network server; or send a recording error repair cancellation request to the first network server when the repairing module <b>54</b> receives a response from the second network server. In the embodiment above, the repair requesting module sends a recording error repair request that carries the description information about the recording error to the network device through a bidirectional network between the recording terminal and the network device, and the repairing module repairs the recorded media file according to the repair information sent by the network device, ensuring reliability of repairing the media file recording error. Meanwhile, in this embodiment, because the recording error is repaired based on a bidirectional channel of the bidirectional network, the line bandwidth occupied by the repair of the recording error is reduced, and the utilization of the line bandwidth is improved. <figref idref="DRAWINGS">FIG. 6</figref> shows a structure schematic view of a network server according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 6</figref>, the network server in this embodiment includes:</p>
<p id="p-0132" num="0131">a network recording module <b>61</b>, configured to record a media file live;</p>
<p id="p-0133" num="0132">a storing module <b>62</b>, configured to store data recorded by the recording module; and</p>
<p id="p-0134" num="0133">a recording managing module <b>63</b>, configured to: receive a recording error repair request that carries description information about a recording error identified by a recording terminal in live recording of the media file; and obtain recording data that matches the description information from the storing module, and send the recording data to the recording terminal.</p>
<p id="p-0135" num="0134">In the embodiment above, the network server receives a recording error repair request from the recording terminal through a bidirectional network between the recording terminal and the network server, and sends recording data that matches the request to the recording terminal. In this way, the recording terminal can repair the recorded media file, and the reliability of repairing the media file recording error is ensured. Further, the repairing module in this embodiment can repair the media file recorded by the recording terminal by inserting correct data into a location of the specific data fragment recorded erroneously or replacing the erroneous data fragment according to the received repair information, reducing the line bandwidth occupied by the repair of the recording error, and improving the utilization of the line bandwidth.</p>
<p id="p-0136" num="0135"><figref idref="DRAWINGS">FIG. 7</figref> shows a structure schematic diagram of another network server according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 7</figref>, the network server in this embodiment includes:</p>
<p id="p-0137" num="0136">a repair request receiving module <b>71</b>, configured to receive a recording error repair request that carries description information about a recording error identified by a recording terminal in live recording of a media file;</p>
<p id="p-0138" num="0137">a broadcasting module <b>72</b>, configured to broadcast a query request that carries the description information; and</p>
<p id="p-0139" num="0138">a repair request responding module <b>73</b>, configured to send information about another recording terminal which stores recording data that matches the description information to the recording terminal when receiving a query response sent by the another recording terminal.</p>
<p id="p-0140" num="0139">In the embodiment above, the network server receives a recording error repair request from the recording terminal through a bidirectional network between the recording terminal and the network server, and sends the information about the another recording terminal that stores the recording data that matches the request to the recording terminal. In this way, the recording terminal that sends the recording error repair request can obtain correct recording data from the another recording terminal to repair the recorded media file, ensuring reliability of repairing the media file recording error.</p>
<p id="p-0141" num="0140"><figref idref="DRAWINGS">FIG. 8</figref> shows a structure schematic view of a system for repairing media file recording errors according to a first embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 8</figref>, the system for repairing media file recording errors includes: a live system head-end <b>81</b>, a recording terminal <b>82</b>, and a network device <b>83</b>. The live system head-end <b>81</b> is connected with the recording terminal <b>82</b> and the network device <b>83</b> through the unidirectional communication network (such as a live network). The recording terminal <b>82</b> is connected with the network device <b>83</b> through a bidirectional communication network.</p>
<p id="p-0142" num="0141">The live system head-end <b>81</b> is configured to broadcast a media file live through a unidirectional communication network.</p>
<p id="p-0143" num="0142">The recording terminal <b>82</b> is configured to: generate description information about a recording error when identifying the recording error in live recording of the media file of the live system head-end <b>81</b>; send a recording error repair request that carries the description information to the network device <b>83</b>; and repair the media file recorded by the recording terminal according to repair information when receiving the repair information sent by the network device <b>83</b> according to the description information.</p>
<p id="p-0144" num="0143">The network device <b>83</b> is configured to send the repair information that matches the description information about the recording error to the recording terminal <b>82</b> when receiving the recording error repair request sent by the recording terminal <b>82</b>.</p>
<p id="p-0145" num="0144">In the system provided in the foregoing embodiment, when the recording terminal records the media file of the live system head-end erroneously, the system sends a recording error repair request that carries description information about the recording error to the network device through a bidirectional network between the recording terminal and the network device, and repairs the recorded media file according to the repair information sent by the network device, ensuring reliability of repairing the media file recording error.</p>
<p id="p-0146" num="0145"><figref idref="DRAWINGS">FIG. 9</figref> shows a structure schematic diagram of a system for repairing media file recording errors according to a second embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 9</figref>, this embodiment differs from the embodiment shown in <figref idref="DRAWINGS">FIG. 8</figref> in that: In this embodiment, the network devices include a first network server <b>831</b>; the repair information sent by the network device to the recording terminal includes the recording data that is recorded by the first network server <b>831</b> and matches the description information about the recording error. The first network server <b>831</b> includes:</p>
<p id="p-0147" num="0146">a network recording module <b>8311</b>, configured to record the media file of a live system head-end <b>81</b> live;</p>
<p id="p-0148" num="0147">a storing module <b>8312</b>, configured to store data recorded by the network recording module <b>8311</b>; and</p>
<p id="p-0149" num="0148">a recording managing module <b>8313</b>, configured to: receive a recording error repair request sent by the recording terminal <b>82</b>, where the recording error repair request carries description information about the recording error identified by the recording terminal <b>82</b> in live recording of the media file, obtain recording data that matches the description information from the storing module <b>8312</b>, and send the recording data to the recording terminal <b>82</b>.</p>
<p id="p-0150" num="0149">In the embodiment above, when the recording terminal identifies a recording error, the recording terminal obtains repair information from the first network server through a bidirectional communication network (C/S network architecture) between the recording terminal of the live recording service and the first network server, and repairs the recording error in the media file recorded by the recording terminal, ensuring reliability of repairing the media file recording error.</p>
<p id="p-0151" num="0150"><figref idref="DRAWINGS">FIG. 10</figref> shows a structure schematic diagram of a system for repairing media file recording errors according to a third embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 10</figref>, this embodiment differs from the embodiment shown in <figref idref="DRAWINGS">FIG. 8</figref> in that: In this embodiment, the network devices include a second network server <b>832</b> and another recording terminal <b>833</b>; the repair information sent by the network device to the recording terminal includes the recording data that is recorded by the another recording terminal <b>833</b> and matches the description information. The second network server <b>832</b> includes:</p>
<p id="p-0152" num="0151">a repair request receiving module <b>8321</b>, configured to receive a recording error repair request that carries description information about a recording error identified by a recording terminal <b>82</b> in live recording of a media file;</p>
<p id="p-0153" num="0152">a broadcasting module <b>8322</b>, configured to broadcast a query request that carries the description information; and</p>
<p id="p-0154" num="0153">a repair request responding module <b>8323</b>, configured to send information about another recording terminal <b>833</b> which stores recording data that matches the description information to the recording terminal <b>82</b> when receiving a query response sent by the another recording terminal <b>833</b> to the second network server <b>832</b>.</p>
<p id="p-0155" num="0154">The another recording terminal <b>833</b> is configured to determine whether itself stores the recording data that matches the description information according to the description information carried in the query request when receiving the query request from the second network server <b>832</b>, and if itself stores the recording data that matches the description information, send a query response to the second network server <b>832</b>.</p>
<p id="p-0156" num="0155">In the embodiment above, when the recording terminal identifies a recording error, the recording terminal sends a recording error repair request to the second network server through a bidirectional communication network (P2P network architecture) between the recording terminal of the live recording service, the second network server and the another recording terminal, and obtains repair information from the another recording terminal according to information about the another recording terminal that stores the recording data that matches the description information about the recording error when receiving the information about the another recording terminal from the second network server. In this way, the recording error in the media file recorded by the recording terminal is repaired, and the reliability of repairing the recording error is ensured.</p>
<p id="p-0157" num="0156"><figref idref="DRAWINGS">FIG. 11</figref> shows a structure schematic diagram of a system for repairing media file recording errors according to a fourth embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 11</figref>, this embodiment differs from the embodiment shown in <figref idref="DRAWINGS">FIG. 8</figref> in that: In this embodiment, the recording error of the recording terminal is repaired based on a heterogeneous bidirectional network. In this embodiment, the network devices may include a first network server <b>831</b> in a first bidirectional network architecture (such as a C/S network architecture), and a second network server <b>832</b> and another recording terminal <b>833</b> in a second bidirectional network architecture (such as a P2P network architecture).</p>
<p id="p-0158" num="0157">The recording terminal <b>82</b> is further configured to send a recording error repair request to the first network server <b>831</b> and the second network server <b>832</b>.</p>
<p id="p-0159" num="0158">The recording terminal <b>82</b> may send the recording error repair request to the first network server <b>831</b> and the second network server <b>832</b> one by one or simultaneously.</p>
<p id="p-0160" num="0159">In the case that the recording error repair request is sent to the first network server <b>831</b> and the second network server <b>832</b> on e by one, if the recording terminal <b>82</b> sends the recording error repair request to either network server first and receives a correct response from this network server, the recording terminal may give up sending the recording error repair request to the other network server; if the recording terminal <b>82</b> does not receive a correct response from this network server, the recording terminal sends the recording error repair request to the other network server.</p>
<p id="p-0161" num="0160">In the case that the recording error repair request is sent to the first network server <b>831</b> and the second network server <b>832</b> simultaneously, when the recording terminal <b>82</b> receives a correct response from either of the network servers, the recording terminal <b>82</b> may send a recording error repair cancelation request to the other network server.</p>
<p id="p-0162" num="0161">The detailed functional modules of the first network server <b>831</b> are illustrated in <figref idref="DRAWINGS">FIG. 9</figref>, and the method for repairing the recording error based on the first bidirectional communication network between the recording terminal <b>82</b> and the first network server <b>831</b> is described in the embodiment shown in <figref idref="DRAWINGS">FIG. 2</figref>, and therefore is not described herein again; the detailed functional modules of the second network server <b>832</b> are illustrated in <figref idref="DRAWINGS">FIG. 10</figref>, and the method for repairing the recording error based on the second bidirectional communication network between the recording terminal <b>82</b>, the second network server <b>832</b> and another network server <b>833</b> is described in the embodiment shown in <figref idref="DRAWINGS">FIG. 3</figref>, and therefore is not described herein again.</p>
<p id="p-0163" num="0162">In this embodiment, the recording error is repaired through the heterogeneous bidirectional network associated with the recording terminal. When the recording terminal fails to obtain the repair information in the interactive communication with one network server, the recording terminal can obtain the record information required for repairing the recording error through the other network server, improving reliability of repairing the recording error.</p>
<p id="p-0164" num="0163">It is understandable to those skilled in the art that the accompanying drawings are only schematic diagrams of the preferred embodiments, and the modules or processes in the accompanying drawings are not mandatory for implementing the present invention.</p>
<p id="p-0165" num="0164">It is understandable to those skilled in the art that the modules in an apparatus according to an embodiment of the present invention may be distributed in the apparatus described herein, or may be located in one or more apparatuses different from the apparatus described herein. The modules may be combined into one module, or split into multiple submodules.</p>
<p id="p-0166" num="0165">The sequence numbers of the embodiments above are intended to facilitate description only, and do not represent the priority of each embodiment.</p>
<p id="p-0167" num="0166">Persons of ordinary skill in the art should understand that all or a part of the steps of the method according to the embodiments of the present invention may be implemented by a program instructing relevant hardware. The program may be stored in a computer readable storage medium. When the program runs, the steps of the method according to the embodiments of the present invention are performed. The storage medium may be any medium that is capable of storing program codes, such as a Read Only Memory (ROM), a Random Access Memory (RAM), a magnetic disk, or a compact disk.</p>
<p id="p-0168" num="0167">Finally, it should be noted that the above embodiments are merely provided for describing the technical solution of the present invention, but not intended to limit the present invention. It is apparent that persons skilled in the art can make various modifications and variations to the invention without departing from the spirit and scope of the invention. The present invention is intended to cover the modifications and variations provided that they fall within the scope of protection defined by the following claims or their equivalents.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for repairing media file recording errors, comprising:
<claim-text>generating description information about a recording error when a recording terminal identifies the recording error in live recording of a media file, wherein the live media file is transmitted in data fragments on a network, and the description information comprises one or more types of the recording error identified by the recording terminal, the one or more types of the recording error comprise: a loss of an intra-fragment frame, a loss of a fragment, damage of an intra-fragment frame, and damage of a fragment;</claim-text>
<claim-text>sending a recording error repair request that carries the description information to a network device via the network; and</claim-text>
<claim-text>repairing the media file recorded by the recording terminal according to repair information when receiving the repair information sent via the network by the network device according to the description information,</claim-text>
<claim-text>wherein:</claim-text>
<claim-text>if the type of the recording error is loss of an intra-fragment frame, the description information further comprises information about a data fragment where a lost video frame is located, and identification information and time information of a correct video frame adjacent to the lost video frame;</claim-text>
<claim-text>if the type of the recording error is loss of a fragment, the description information further comprises information about a correct data fragment adjacent to a lost data fragment;</claim-text>
<claim-text>if the type of the recording error is damage of an intra-fragment frame, the description information further comprises information about a data fragment where a damaged video frame is located, and identification information and time information of a correct video frame adjacent to the damaged video frame; and</claim-text>
<claim-text>if the type of the recording error is damage of a fragment, the description information further comprises information about a damaged data fragment, and identification information and time information of a correct data fragment adjacent to the damaged data fragment.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method for repairing media file recording errors according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>the network device comprises a first network server; and the repair information comprises recording data that is recorded by the first network server and matches the description information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method for repairing media file recording errors according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>the network device comprises a second network server and another recording terminal; and</claim-text>
<claim-text>the repair information comprises recording data that is recorded by the another recording terminal and matches the description information;</claim-text>
<claim-text>the sending of the recording error repair request to the network device comprises: sending the recording error repair request to the second network server; and</claim-text>
<claim-text>the repairing of the media file recorded by the recording terminal according to the repair information when receiving the repair information sent by the network device according to the description information comprises: obtaining the recording data that matches the description information from the another recording terminal when receiving information about the another recording terminal that stores the recording data which matches the description information, wherein the information about the another recording terminal is delivered by the second network server according to the description information; and repairing the media file recorded by the recording terminal according to the recording data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method for repairing media file recording errors according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein:
<claim-text>when the second network server receives the description information, the method further comprises:</claim-text>
<claim-text>receiving, by the recording terminal, the information about the another recording terminal from the second network server;</claim-text>
<claim-text>the information about the another recording terminal is information about the another recording terminal which sends a query response to the second network server and stores the recording data that matches the description information; and</claim-text>
<claim-text>the query response corresponds to a the query request broadcast by the second network server to other recording terminals, and carries the description information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method for repairing media file recording errors according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>the network device comprises a first network server and a second network server;</claim-text>
<claim-text>the sending of the recording error repair request to the network device comprises:</claim-text>
<claim-text>sending the recording error repair request to the first network server, and sending the recording error repair request to the second network server if no correct response is received from the first network server within a preset time; or</claim-text>
<claim-text>sending the recording error repair request to the second network server, and sending the recording error repair request to the first network server if no correct response is received from the second network server within a preset time.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method for repairing media file recording errors according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>the network device comprises a first network server and a second network server; and</claim-text>
<claim-text>the sending of the recording error repair request to the network device comprises: sending the recording error repair request to the first network server and the second network server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method for repairing media file recording errors according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein:
<claim-text>after sending the recording error repair request to the first network server and the second network server, the method further comprises:</claim-text>
<claim-text>sending a recording error repair cancellation request to the second network server when receiving a response from the first network server; or</claim-text>
<claim-text>sending a recording error repair cancellation request to the first network server when receiving a response from the second network server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method for repairing media file recording errors according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>the description information comprises a type of the recording error; when the live media file is transmitted in video frames on a network, the type of the recording error identified by the recording terminal may be loss of a frame or damage of a frame;</claim-text>
<claim-text>if the type of the recording error is loss of a frame, the description information further comprises identification information and time information of a correct video frame adjacent to a lost video frame; and</claim-text>
<claim-text>if the type of the recording error is damage of a frame, the description information further comprises identification information of a damaged video frame, and identification information and time information of a correct video frame adjacent to the damaged video frame.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method for repairing media file recording errors according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein:
<claim-text>the repairing of the media file recorded by the recording terminal according to the repair information comprises:</claim-text>
<claim-text>repairing the media file recorded by the recording terminal according to the repair information and the type of the recording error.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method for repairing media file recording errors according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>the repairing of the media file recorded by the recording terminal according to the repair information comprises:</claim-text>
<claim-text>repairing the media file recorded by the recording terminal according to the repair information and the type of the recording error.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method for repairing media file recording errors according to <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein:
<claim-text>the repairing of the media file recorded by the recording terminal according to the repair information and the type of the recording error comprises:</claim-text>
<claim-text>inserting the repair information into a corresponding location of the lost video frame in the media file recorded by the recording terminal if the recording error is loss of a frame or loss of an intra-fragment frame, or into a corresponding location of the lost data fragment if the recording error is loss of a fragment; and</claim-text>
<claim-text>using the repair information to replace corresponding data in the damaged video frame in the media file recorded by the recording terminal if the recording error is damage of a frame or damage of an intra-fragment frame, or to replace corresponding data in the damaged data fragment if the recording error is damage of a fragment.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method for repairing media file recording errors according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein:
<claim-text>the repairing of the media file recorded by the recording terminal according to the repair information and the type of the recording error comprises:</claim-text>
<claim-text>inserting the repair information into a corresponding location of the lost video frame in the media file recorded by the recording terminal if the recording error is loss of a frame or loss of an intra-fragment frame, or into a corresponding location of the lost data fragment if the recording error is loss of a fragment; and</claim-text>
<claim-text>using the repair information to replace corresponding data in the damaged video frame in the media file recorded by the recording terminal if the recording error is damage of a frame or damage of an intra-fragment frame, or to replace corresponding data in the damaged data fragment if the recording error is damage of a fragment.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A recording terminal, comprising a recorder and further comprising:
<claim-text>a processor, configured to generate description information about a recording error when identifying the recording error in live recording of a media file, wherein the live media file is transmitted in data fragments on a network, and the description information comprises one or more types of the recording error identified by the recording terminal the one or more types of the recording error comprise: a loss of an intra-fragment frame, a loss of a fragment, damage of an intra-fragment frame, and damage of a fragment;</claim-text>
<claim-text>a transmitter, configured to send a recording error repair request that carries the description information via a network to a network device; and</claim-text>
<claim-text>a receiver, configured to receive repair information sent via the network by the network device according to the description information,</claim-text>
<claim-text>wherein the processor is configured to repair the media file recorded by the recording terminal according to the repair information when the receiver has received the repair information, and to activate the first transmitter and start a timer, and activate the second transmitter if the receiver receives no correct response from the first network server within a preset time; or activate the second transmitter and start a timer, and activate the first transmitter if the receiver receives no correct response from the second network server within a preset time.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The recording terminal according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein if the network device comprises a first network server and a second network server, the transmitter comprises:
<claim-text>a first transmitter, configured to send the recording error repair request to the first network server; and</claim-text>
<claim-text>a second transmitter, configured to send the recording error repair request to the second network server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The recording terminal according to <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein:
<claim-text>the transmitter is further configured to send a recording error repair cancellation request to the second network server when the receiver has received a response from the first network server; or send a recording error repair cancellation request to the first network server when the receiver has received a response from the second network server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The recording terminal according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the receiver is configured to receive the repair information sent by the network device according to the description information;
<claim-text>the processor is configured to insert the repair information into a corresponding location of a lost video frame in the media file recorded by the recording terminal if the recording error is loss of a frame, or into a corresponding location of a lost data fragment if the recording error is loss of a fragment; and</claim-text>
<claim-text>the processor is configured to use the repair information to replace corresponding data in a damaged video frame in the media file recorded by the recording terminal if the recording error is damage of a frame, or replace corresponding data in a damaged data fragment if the recording error is damage of a fragment.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. A network server, comprising:
<claim-text>a receiver, configured to receive a recording error repair request that carries description information about a recording error identified by a recording terminal in live recording of a media file, wherein the live media file is transmitted in data fragments on a network, and the description information comprises one or more types of the recording error identified by the recording terminal, the one or more type of the recording error comprise: a loss of an intra-fragment frame, a loss of a fragment, damage of an intra-fragment frame, and damage of a fragment;</claim-text>
<claim-text>a broadcaster, configured to broadcast a query request that carries the description information; and</claim-text>
<claim-text>a transmitter, configured to send information about another recording terminal which stores recording data that matches the description information to the recording terminal when receiving a query response sent by the another recording terminal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. A system for repairing media file recording errors, comprising a live system head-end, a network device, and a recording terminal, wherein:
<claim-text>the recording terminal is configured to: generate description information about a recording error when identifying the recording error in live recording of a media file of the live system head-end, wherein the live media file is transmitted in data fragments on a network, and the description information comprises one or more types of the recording error identified by the recording terminal, the one or more types of the recording error comprise: a loss of an intra-fragment frame, a loss of a fragment, damage of an intra-fragment frame, and damage of a fragment; send a recording error repair request that carries the description information via the network to the network device; and repair the media file recorded by the recording terminal according to repair information when receiving the repair information sent via the network by the network device according to the description information; and</claim-text>
<claim-text>the network device is configured to send via the network the repair information that matches the description information to the recording terminal when receiving the recording error repair request,</claim-text>
<claim-text>wherein:</claim-text>
<claim-text>the network device comprises a second network server and another recording terminal;</claim-text>
<claim-text>the repair information comprises recording data that is recorded by the another recording terminal and matches the description information;</claim-text>
<claim-text>the second network server comprises:</claim-text>
<claim-text>a repair request receiving module, configured to receive the recording error repair request that carries the description information about the recording error identified by the recording terminal in live recording of the media file;</claim-text>
<claim-text>a broadcasting module, configured to broadcast a query request that carries the description information; and</claim-text>
<claim-text>a repair request responding module, configured to send information about the another recording terminal which stores recording data that matches the description information to the recording terminal when receiving a query response sent by the another recording terminal to the second network server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The system for repairing media file recording errors according to <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein:
<claim-text>the network device comprises a first network server; and the repair information comprises recording data that is recorded by the first network server and matches the description information; and the first network server comprises:</claim-text>
<claim-text>a network recording module, configured to record the media file of the live system head-end live;</claim-text>
<claim-text>a storing module, configured to store data recorded by the network recording module; and</claim-text>
<claim-text>a recording managing module, configured to: receive the recording error repair request that carries the description information about the recording error identified by the recording terminal in live recording of the media file; and obtain recording data that matches the description information from the storing module, and send the recording data to the recording terminal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The system for repairing media file recording errors according to <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein:
<claim-text>the network device comprises a first network server and a second network server; and</claim-text>
<claim-text>the recording terminal is further configured to send the recording error repair request to the first network server, and send the recording error repair request to the second network server if no response is received from the first network server within a preset time; or configured to send the recording error repair request to the second network server, and send the recording error repair request to the first network server if no response is received from the second network server within a preset time.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The system for repairing media file recording errors according to <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein:
<claim-text>the network device comprises a first network server and a second network server; and</claim-text>
<claim-text>the recording terminal is further configured to: send the recording error repair request to the first network server and the second network server; and send a recording error repair cancellation request to the second network server when receiving a response from the first network server, or send a recording error repair cancellation request to the first network server when receiving a response from the second network server. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
