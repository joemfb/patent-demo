<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625610-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625610</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11871508</doc-number>
<date>20071012</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<us-term-extension>1259</us-term-extension>
<disclaimer>
<text>This patent is subject to a terminal disclaimer.</text>
</disclaimer>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>12</main-group>
<subgroup>28</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>370401</main-classification>
<further-classification>370389</further-classification>
<further-classification>370255</further-classification>
<further-classification>713153</further-classification>
</classification-national>
<invention-title id="d2e55">System and method for improving spoke to spoke communication in a computer network</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5627892</doc-number>
<kind>A</kind>
<name>Kauffmann</name>
<date>19970500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7046662</doc-number>
<kind>B1</kind>
<name>Saluja et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370389</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7184437</doc-number>
<kind>B1</kind>
<name>Cole et al.</name>
<date>20070200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7234063</doc-number>
<kind>B1</kind>
<name>Baugher et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7298839</doc-number>
<kind>B2</kind>
<name>Eisentraeger et al.</name>
<date>20071100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7308706</doc-number>
<kind>B2</kind>
<name>Markham et al.</name>
<date>20071200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7366894</doc-number>
<kind>B1</kind>
<name>Kalimuthu et al.</name>
<date>20080400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713153</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>7447901</doc-number>
<kind>B1</kind>
<name>Sullenberger et al.</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>7486795</doc-number>
<kind>B2</kind>
<name>Eschenauer et al.</name>
<date>20090200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>7536715</doc-number>
<kind>B2</kind>
<name>Markham</name>
<date>20090500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>7558877</doc-number>
<kind>B1</kind>
<name>Fedyk et al.</name>
<date>20090700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709242</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>7594262</doc-number>
<kind>B2</kind>
<name>Hanzlik et al.</name>
<date>20090900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>7596690</doc-number>
<kind>B2</kind>
<name>Singh</name>
<date>20090900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>7602737</doc-number>
<kind>B2</kind>
<name>Asati et al.</name>
<date>20091000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>7657036</doc-number>
<kind>B2</kind>
<name>Hsu et al.</name>
<date>20100200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>7720995</doc-number>
<kind>B2</kind>
<name>Wainner et al.</name>
<date>20100500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>7801030</doc-number>
<kind>B1</kind>
<name>Aggarwal et al.</name>
<date>20100900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>7840810</doc-number>
<kind>B2</kind>
<name>Eastham</name>
<date>20101100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>7848335</doc-number>
<kind>B1</kind>
<name>Kang et al.</name>
<date>20101200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>7957320</doc-number>
<kind>B2</kind>
<name>Konig et al.</name>
<date>20110600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>7962743</doc-number>
<kind>B2</kind>
<name>Fluhrer</name>
<date>20110600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713153</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>2003/0126265</doc-number>
<kind>A1</kind>
<name>Aziz et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709227</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2003/0191937</doc-number>
<kind>A1</kind>
<name>Balissat et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>2003/0211842</doc-number>
<kind>A1</kind>
<name>Kempf et al.</name>
<date>20031100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>2004/0103283</doc-number>
<kind>A1</kind>
<name>Hornak</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>2005/0114663</doc-number>
<kind>A1</kind>
<name>Cornell et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>2006/0253556</doc-number>
<kind>A1</kind>
<name>Wallis et al.</name>
<date>20061100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>2006/0253703</doc-number>
<kind>A1</kind>
<name>Eronen et al.</name>
<date>20061100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00029">
<document-id>
<country>US</country>
<doc-number>2007/0016663</doc-number>
<kind>A1</kind>
<name>Weis</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709223</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00030">
<document-id>
<country>US</country>
<doc-number>2007/0248225</doc-number>
<kind>A1</kind>
<name>Fluhrer</name>
<date>20071000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00031">
<document-id>
<country>US</country>
<doc-number>2007/0271451</doc-number>
<kind>A1</kind>
<name>Fluhrer</name>
<date>20071100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713150</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00032">
<document-id>
<country>US</country>
<doc-number>2008/0320303</doc-number>
<kind>A1</kind>
<name>Khalid et al.</name>
<date>20081200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713163</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00033">
<document-id>
<country>US</country>
<doc-number>2009/0157901</doc-number>
<kind>A1</kind>
<name>Asati et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00034">
<document-id>
<country>US</country>
<doc-number>2009/0304004</doc-number>
<kind>A1</kind>
<name>Huynh et al.</name>
<date>20091200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00035">
<document-id>
<country>US</country>
<doc-number>2010/0223458</doc-number>
<kind>A1</kind>
<name>Mcgrew et al.</name>
<date>20100900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00036">
<document-id>
<country>US</country>
<doc-number>2011/0013641</doc-number>
<kind>A1</kind>
<name>Kolhi et al.</name>
<date>20110100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00037">
<othercit>Rekhter, Y., et al., <i>A Border Gateway Protocol 4 </i>(<i>BGP-4</i>), RFC 4271, [retrieved Mar. 2010], IETF, &#x3c;http://tools.ietf.org/html/rfc4271&#x3e;, (Jan. 2006), 105 pgs.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00038">
<othercit><i>Dynamic Multipoint VPN </i>(<i>DMVPN</i>) <i>Design Guide</i>, [online]. Cisco Systems, Inc., San Jose, CA, [retrieved on Sep. 7, 2009]. Retrieved from the internet: &#x3c;URL: http://www.archive.org/web/*/www.cisco.com/&#x3e; &#x3e;, (2006), 101 pgs.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00039">
<othercit>Luciani, J., et al., &#x201c;NBMA Next Hop Resolution Protocol (NHRP)&#x201d;, <i>Network Working Group, Request for Comments</i>: 2332, (Apr. 1998), 53 pgs.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00040">
<othercit><i>Configuring Dynamic Multipoint VPN Spoke Router in Full Mesh IPsec VPN Using Security Device Manager</i>, White Paper, Cisco Systems, Inc., (2004), 26 pgs.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00041">
<othercit>Frey, G., et al., &#x201c;The Tate Pairing and the Discrete Logarithm Applied to Elliptic Curve Cryptosystems&#x201d;, [online]. Oct. 7, 1998. [retrieved on Sep. 29, 2010]. Retrieved from the Internet: &#x3c;URL: www-rcf.usc.edu/&#x2dc;mdhuang/cs599/frey98tate.pdf&#x3e;, 5 pgs.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00042">
<othercit>Menezes, A., et al., &#x201c;Diffie-Hellman Key Exchange&#x201d;, In: <i>Handbook of Applied Cryptography</i>, CRC Press LLC, (1997), 4 pgs.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00043">
<othercit>&#x201c;U.S. Appl. No. 11/379,920, Response filed Sep. 29, 2010 to Non Final Office Action mailed Apr. 29, 2010&#x201d;, 14 pgs.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00044">
<othercit>&#x201c;U.S. Appl. No. 11/419,583, Notice of Allowance mailed Feb. 8, 2011&#x201d;, 7 pgs.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00045">
<othercit>&#x201c;U.S. Appl. No. 11/954,831, Response filed Aug. 16, 2010 to Final Office Action mailed Mar. 25, 2010&#x201d;, 7 pgs.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>24</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>709223</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709224</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709238-243</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713150-153</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713162</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713163</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370389</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370255</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370401</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>37039531</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20090097417</doc-number>
<kind>A1</kind>
<date>20090416</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Asati</last-name>
<first-name>Rajiv</first-name>
<address>
<city>Morrisville</city>
<state>NC</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Khalid</last-name>
<first-name>Mohamed</first-name>
<address>
<city>Cary</city>
<state>NC</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Weis</last-name>
<first-name>Brian E.</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Sethi</last-name>
<first-name>Pratima Pramod</first-name>
<address>
<city>Maharashtra</city>
<country>IN</country>
</address>
</addressbook>
<residence>
<country>IN</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Asati</last-name>
<first-name>Rajiv</first-name>
<address>
<city>Morrisville</city>
<state>NC</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Khalid</last-name>
<first-name>Mohamed</first-name>
<address>
<city>Cary</city>
<state>NC</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Weis</last-name>
<first-name>Brian E.</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Sethi</last-name>
<first-name>Pratima Pramod</first-name>
<address>
<city>Maharashtra</city>
<country>IN</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Schwegman Lundberg &#x26; Woessner, P.A.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Cisco Technology, Inc.</orgname>
<role>02</role>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Ton</last-name>
<first-name>Dang</first-name>
<department>2475</department>
</primary-examiner>
<assistant-examiner>
<last-name>Randhawa</last-name>
<first-name>Mandish</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Various embodiments of the disclosed subject matter provide methods and systems for improved efficiency in spoke-to-spoke network communication. Embodiments provide systems and methods for registering a spoke with a hub, updating at least one database with spoke registration information at the hub, and advertising the spoke registration information to other spokes using a single control plane that includes transport security, peer discovery, and unicast routing information.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="162.22mm" wi="137.92mm" file="US08625610-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="160.36mm" wi="183.90mm" file="US08625610-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="68.41mm" wi="168.23mm" file="US08625610-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="178.31mm" wi="158.50mm" file="US08625610-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="263.06mm" wi="194.56mm" orientation="landscape" file="US08625610-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="233.51mm" wi="195.50mm" orientation="landscape" file="US08625610-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is related to U.S. patent application Ser. No. 11/954,831, entitled &#x201c;SYSTEM AND METHOD FOR USING ROUTING PROTOCOL EXTENSIONS FOR IMPROVING SPOKE TO SPOKE COMMUNICATION IN A COMPUTER NETWORK&#x201d;, filed on Dec. 12, 2007, and assigned to Cisco Technology, Inc.</p>
<heading id="h-0002" level="1">TECHNICAL FIELD</heading>
<p id="p-0003" num="0002">The disclosed subject matter relates to the field of computer network communications, and more particularly to methods and systems for improving spoke to spoke communication in a computer network.</p>
<heading id="h-0003" level="1">COPYRIGHT</heading>
<p id="p-0004" num="0003">A portion of the disclosure of this patent document contains material that is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by anyone of the patent document or the patent disclosure, as it appears in the Patent and Trademark Office patent files or records, but otherwise reserves all copyright rights whatsoever. The following notice applies to the software and data as described below and in the drawings that form a part of this document: Copyright 2006-2007 Cisco Systems, Inc. All Rights Reserved.</p>
<heading id="h-0004" level="1">BACKGROUND</heading>
<p id="p-0005" num="0004">A Virtual Private Network (VPN) is a logical network that uses non-secure public telecommunications, such as the Internet, to provide secure communications to members of the VPN. A VPN seeks to provide the security associated with dedicated communication lines without requiring the requisite hardware and at a fraction of the cost typically associated with dedicated communication lines.</p>
<p id="p-0006" num="0005">A VPN works by using shared public infrastructure while simultaneously maintaining privacy through agreed upon security procedures and protocols. Essentially, a VPN uses custom encryption to encrypt messages communicated via the VPN. The encryption and decryption of messages rely upon keys that are securely held by participants of the VPN.</p>
<p id="p-0007" num="0006">Dynamic Multipoint VPN (DMVPN) is an enhancement of the virtual private network configuration process of conventional network routers. DMVPN prevents the need for pre-configured (static) IPsec (IP security) peers in the network. IPsec is a standard for securing Internet Protocol (IP) communications by encrypting and/or authenticating all IP packets communicated among the network peers. IPsec provides security at the network layer. The DMVPN functionality of conventional network routers allows greater scalability over previous IPsec configurations. An IPsec tunnel between two conventional network routers may be created on an as-needed basis. Tunnels may be created between a spoke router and a hub router (VPN headend) or between spokes. This greatly alleviates the need for the hub to route data between spoke networks, as was common in a non-fully meshed frame relay topology.</p>
<p id="p-0008" num="0007">In DMVPN, network traffic can traverse from one spoke to another. Initially, the network traffic is routed from a first spoke (e.g., spoke A) to the hub and then from the hub to a second spoke (e.g., spoke B). At the same time, DMVPN establishes a tunnel from spoke A to spoke B. Once the tunnel from spoke A to spoke B is created, traffic will be routed via the tunnel. Unfortunately, conventional DMVPN causes a significant reduction in the tunnel latency several seconds after the tunnel has been established. This sudden reduction in tunnel latency can cause problems in servicing delay-sensitive network traffic.</p>
<p id="p-0009" num="0008">Thus, a system and method for improved efficiency in spoke-to-spoke network communication is needed.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 1</figref> illustrates the typical network environment of various embodiments.</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 2</figref> illustrates an example of the hub registration table of one embodiment.</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 3</figref> is a processing flow diagram that illustrates the processing flow in accordance with one example embodiment of the disclosed subject matter.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a network environment in which an example embodiment may operate.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIGS. 5 and 6</figref> show an exemplary computer system in which the features of an example embodiment may be implemented.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0015" num="0014">In the following detailed description, reference is made to the accompanying drawings that form a part hereof, and in which are shown by way of illustration specific embodiments in which the disclosed subject matter can be practiced. It is understood that other embodiments may be utilized and structural changes may be made without departing from the scope of the disclosed subject matter. The leading digit(s) of reference numbers appearing in the Figures generally corresponds to the Figure number in which that component is first introduced, such that the same reference number is used throughout to refer to an identical component that appears in multiple Figures. Signals and connections may be referred to by the same reference number or label, and the actual meaning will be clear from the use of these terms in the context of the description.</p>
<p id="p-0016" num="0015">As described further below, according to various example embodiments of the disclosed subject matter described herein, there is provided a system and method for improved efficiency in spoke-to-spoke network communication.</p>
<p id="p-0017" num="0016">A DMVPN spoke is typically configured with enough information, such as one or more IP addresses, to communicate with a hub. DMVPN hub IP addresses are typically static. DMVPN spoke IP addresses may be static or dynamic. An example would be a DMVPN spoke router acting as a DHCP (Dynamic Host Configuration Protocol) client on a DSL (digital subscriber loop) or cable provider's network. The spoke router is configured with the hub's IP address, allowing the spoke to connect with the hub when online. The hub router does not need to be configured with the IP addresses of the spoke routers. This allows many spoke VPN routers to be deployed without the need to configure additional peers on the hub(s). In the past, the configuration of the hub grew whenever a spoke VPN router was added to the IPsec network.</p>
<p id="p-0018" num="0017">To avoid routing through the hub router for spoke-to-spoke traffic, NHRP (next hop resolution protocol) is often also used for spoke discovery. A key use of NHRP is for next hop resolution. A DMVPN spoke router may learn of the static or dynamic IP address of other spoke routers, using at least one routing protocol adjacency, and may resolve the corresponding next hops using NHRP. Additional IPsec tunnels are created as needed for spoke-to-spoke traffic. To conserve resources, these tunnels are torn down after they are no longer needed. Having spoke-to-spoke tunnels is a great benefit to delay-sensitive traffic, such as IP telephony and other real-time applications. The delay of the spoke router's progress through the hub to other spokes can be avoided after the latency incurred during the initial set-up. For redundancy, a spoke router can be mapped to one or more DMVPN hubs.</p>
<p id="p-0019" num="0018">Particular embodiments described herein use Diffie-Hellman key generation as a cryptographic methodology. Such methodologies are well known to those of ordinary skill in the art. These methods can be used to generate an encryption/decryption key from a pair of values, one value being a public value and the other value of the pair being a private value. In the description that follows, these values are denoted as Diffie-Hellman (DH) public values or private values. These values can be generated for each spoke. It will be apparent to those of ordinary skill in the art that other equivalent cryptographic methodologies may also be employed.</p>
<p id="p-0020" num="0019">Internet Key Exchange (IKE) uses a Diffie-Hellman key exchange to set up a shared session secret, from which cryptographic keys are derived. Public key techniques or, alternatively, a pre-shared key, are used to mutually authenticate the communicating parties.</p>
<p id="p-0021" num="0020">IPsec provides services and semantics for IPsec Security Associations (SA's) that are shared between two IPsec devices. A Group Controller Key Server (GCKS) is a Group Key Management (GKM) protocol server that manages the IPsec state for a group. A GCKS authenticates and provides the IPsec SA policy and keying material to GKM group members. A GKM Protocol (GKMP), such as the Group Domain of Interpretation (GDOI), is a key management protocol used by a GCKS to distribute IPsec SA policy and keying material. A GKM protocol is used when a group of IPsec devices require the same SA's. For example, when an IPsec SA describes an IP multicast destination, the sender and all receivers can have the group SA. A Group Key Management Subsystem is a subsystem in an IPsec device implementing a GKM protocol. The GKM subsystem provides IPsec SA's to the IPsec subsystem on the IPsec device. A Group Member (GM) as used herein is an IPsec device that belongs to a group. A GM is authorized to be a Group Speaker and/or a Group Receiver.</p>
<p id="p-0022" num="0021">Using DMVPN, router resources are only claimed when needed. However, this may introduce variable forwarding delays during the time in which resources are being claimed. In these configurations, the spoke typically acts as a NHRP client (NHC) and the hub acts as the NHRP server (NHS). The use of NHRP introduces latency into the routing. Some DMVPN implementations mandate the use of NHRP to resolve the next hop. As part of the next hop resolution, address mappings (e.g., mappings from a first address to a second address) are maintained at the spokes and hubs. In particular, NHRP mapping information maintained at the spokes may include physical and tunnel addresses of the hub and adjacent spokes. NHRP mapping information maintained at the hub may include physical and tunnel addresses of the adjacent spokes. In addition to NHRP adjacency information, each spoke may maintain a routing protocol adjacency with each hub to exchange the routing information to help with any-to-any connectivity.</p>
<p id="p-0023" num="0022">As described herein in reference to example embodiments, a DMVPN framework that doesn't require the use of NHRP is disclosed. The functionality previously provided by NHRP is incorporated into a key management protocol without introducing any additional latency. Additionally, such frameworks may also imbibe the functionality previously provided by the unicast routing protocol into a key management protocol. In a particular embodiment, one such key management protocol is GDOI. It will be apparent to those of ordinary skill in the art that other conventional key management protocols can similarly be used with the techniques described herein. In this manner, a VPN system can be implemented in which a single control plane is utilized to integrate transport security, peer discovery, and unicast routing.</p>
<p id="p-0024" num="0023">As described in more detail below, extensions to the key management protocol are provided to enable the encoding of next hop information and prefix reachability information into the key management protocol. In an example embodiment, the GDOI protocol is extended such that, a spoke can pass a first IP address in the GDOI registration message, and the GCKS can store IP address mapping information (e.g., a mapping from the first IP address to a second IP address) and simply reflect the mapping without performing any analysis. In other words, the GCKS can advertise any received routes to other spoke routers without changing the next-hop attribute. If there is a change in mapping or a change in prefix announcement, then the GCKS sends an update to all GMs. The timing of this update (e.g., whether it is performed immediately after the change or at a regular interval) is determined by the local network policy.</p>
<p id="p-0025" num="0024">The hub/key server (GCKS) only advertises the prefixes that are received within the registration message. In this manner, a VPN system can be implemented in which a single control plane is utilized to integrate transport security, peer discovery and unicast routing.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 1</figref> illustrates an exemplary network environment. As shown, a hub <b>105</b> is logically connected to three spokes <b>110</b>, <b>120</b>, and <b>130</b> of an Internet Protocol (IP) network <b>100</b>, such as the Internet. The hub <b>105</b> and spokes <b>110</b>, <b>120</b>, and <b>130</b> can be implemented as network routers, hubs, or gateways. Hub <b>105</b> can be an NHRP Server, a GCKS, and/or a hub (generally denoted herein as the hub).</p>
<p id="p-0027" num="0026">Spokes <b>110</b>, <b>120</b>, and <b>130</b> can be gateways that each control access to a corresponding subnet <b>112</b>, <b>122</b>, and <b>132</b>, respectively. The subnets, or other nodes connected through the subnets, can represent the destination for a particular data packet. It will be apparent to those of ordinary skill in the art that many other gateways (generally denoted herein as spokes) and subnets will be interconnected in a typical network configuration. Additionally, well-known network routing and data transfer protocols can be used to transfer data between the hub and the spokes and between the spokes themselves via the network <b>100</b>. In the manner described in more detail below, protected data communication between spokes can be accomplished via the unprotected IP network <b>100</b> without incurring the latency common in conventional systems.</p>
<p id="p-0028" num="0027">In accordance with the various embodiments described herein, each spoke <b>110</b>, <b>120</b>, and <b>130</b> initially registers itself with hub <b>105</b> by sending a spoke registration message to the hub <b>105</b> via a hub/spoke interface. When a spoke registers with the hub <b>105</b>, the spoke can register its IP address, next hop mapping information, and local prefix reachability information. In an example embodiment, the spoke may register with a hub using an enhanced GDOI protocol such that a spoke can pass a first IP address in the GDOI registration message, a spoke can pass next hop mapping information in the GDOI registration message, a spoke can pass local prefix reachability information in the GDOI registration message, and the GCKS can store the first IP address, next hop mapping information, and local prefix reachability information without necessarily performing any analysis or other processing on the information.</p>
<p id="p-0029" num="0028">Optionally, the spoke may also register a spoke DH public value as part of a set of spoke registration information. For example, when spoke <b>110</b> registers with hub <b>105</b>, spoke <b>110</b> may configure a GDOI registration message to include spoke <b>110</b>'s own IP address, spoke <b>110</b>'s next hop mapping information, the identity of subnet <b>112</b> (e.g., local prefix reachability information), and optionally the DH public value previously computed for spoke <b>110</b>.</p>
<p id="p-0030" num="0029">When spoke <b>120</b> registers with hub <b>105</b>, spoke <b>120</b> may generate a GDOI registration message to include spoke <b>120</b>'s own IP address, spoke <b>120</b>'s next hop mapping information, the identity of subnet <b>122</b> (e.g., local prefix reachability information), and optionally the DH public value previously computed for spoke <b>120</b>. The hub <b>105</b> may store the spoke registration information received via GDOI in a hub registration table <b>107</b> (also denoted NHRP table) or in one or more databases accessible to hub <b>105</b>. Hub <b>105</b> thereby updates the hub registration table <b>107</b> or one or more databases. In one embodiment, the hub <b>105</b> then sends the updated hub registration table <b>107</b>, or updated portions thereof, to all registered spokes via GDOI, and the spokes then update their respective copies of the hub registration table <b>107</b> or one or more databases accessible to the spoke.</p>
<p id="p-0031" num="0030">As additional updates are made to the hub registration table <b>107</b> and/or databases, a hub updater of the hub <b>105</b> can send the entire database or just the portions of the database related to the new/updated information to the registered spokes via GDOI. In this manner, hub <b>105</b> updates all the currently-registered spokes with a copy of the current updated hub registration table <b>107</b> or only the portions of the updated hub registration table <b>107</b> or related databases that have changed (optionally including DH public values for each registered spoke).</p>
<p id="p-0032" num="0031">Referring to <figref idref="DRAWINGS">FIG. 2</figref>, an example embodiment of hub registration table <b>107</b> or one or more databases accessible to hub <b>105</b> is illustrated. As shown, the example embodiment of hub registration table <b>107</b> or related databases includes a record with a set of spoke registration information for each registered spoke. The record for each registered spoke includes the IP address of the spoke, the next hop mapping information (e.g., public address) for the spoke, the local prefix reachability information for the spoke (e.g., subnet addresses), and optionally the DH public value or public key value for the spoke. In a particular embodiment, a separate record specific to each registered spoke, including the spoke registration information detailed above, can be stored in hub registration table <b>107</b>.</p>
<p id="p-0033" num="0032">As each spoke registers with hub <b>105</b>, a record for the newly registered spoke is created in hub registration table <b>107</b> and the data items illustrated in <figref idref="DRAWINGS">FIG. 2</figref>, along with other optional items, are updated for the newly registered spoke. Hub <b>105</b> thereby updates the hub registration table <b>107</b>. In one embodiment, the hub <b>105</b> then sends the updated hub registration table <b>107</b>, or only the portions of the updated hub registration table <b>107</b> that have changed, to all registered spokes via GDOI, and the spokes then update their respective copies of the hub registration table <b>107</b>. In this manner, hub <b>105</b> updates all the spokes that are currently registered with an updated copy of the current hub registration table <b>107</b>.</p>
<p id="p-0034" num="0033">Referring again to <figref idref="DRAWINGS">FIG. 1</figref>, when a spoke needs to forward data traffic to another spoke, the sender spoke first checks to determine if it has a tunnel established with the receiver spoke. Such a tunnel <b>115</b> is represented in <figref idref="DRAWINGS">FIG. 1</figref> as a dashed line from sender spoke <b>110</b> to receiver spoke <b>120</b>. It will be apparent to those of ordinary skill in the art that data transfer between a sender spoke and a receiver spoke through a tunnel may occur via unprotected network <b>100</b>. If no tunnel was previously established, the sender spoke checks its copy of the hub registration table <b>107</b>. If the sender spoke <b>110</b> finds the receiver spoke <b>120</b> address or receiver spoke subnet <b>122</b> within the hub registration table <b>107</b>, the sender spoke <b>110</b> can use the information in the hub registration table <b>107</b> stored in the sender spoke <b>110</b> to open a tunnel <b>115</b> to the receiver spoke <b>120</b>. Next, the sender spoke <b>110</b> can send a data packet to the receiver spoke <b>120</b> or to subnet <b>122</b> via the tunnel <b>115</b>. When the optional DH public keys are not distributed, shared secret keys distributed by the GCKS can be used.</p>
<p id="p-0035" num="0034">When the receiver spoke <b>120</b> receives a data packet for which the receiver spoke <b>120</b> does not have a tunnel <b>115</b> established with the sender spoke <b>110</b>, the receiver spoke <b>120</b> can scan its copy of the hub registration table <b>107</b> for the source IP address of the sender spoke <b>110</b> identified in the received data packet. If the receiver spoke <b>120</b> finds the source IP address of the sender spoke <b>110</b> in the hub registration table <b>107</b>, receiver spoke <b>120</b> can use the information in the hub registration table <b>107</b> stored in the receiver spoke <b>120</b> to open a tunnel <b>115</b> to the sender spoke <b>110</b>. Next, the receiver spoke <b>120</b> can receive additional data packets from the sender spoke <b>110</b> via the tunnel <b>115</b>.</p>
<p id="p-0036" num="0035">In a particular embodiment, the sender spoke <b>110</b> can use secret keying material distributed by the GCKS to form encryption keys. The receiver spoke <b>120</b> then creates a tunnel <b>115</b> using the shared secret keys distributed by the GCKS to generate a set of decryption keys. Receiver spoke <b>120</b> can use the decryption keys to decrypt the data packet sent from the sender spoke <b>110</b> via the tunnel <b>115</b>. It will be apparent to those of ordinary skill in the art that the generated decryption keys can also be used to check the integrity of the data traffic as well as decrypting the traffic.</p>
<p id="p-0037" num="0036">In one embodiment, a full hub registration table <b>107</b>, as shown in <figref idref="DRAWINGS">FIG. 2</figref>, can be maintained on each registered spoke. In addition, as shown in <figref idref="DRAWINGS">FIG. 2</figref>, optional public DH key values (e.g., spoke public keying values) for each registered spoke can also be maintained within the hub registration table <b>107</b> on each registered spoke.</p>
<p id="p-0038" num="0037">In an example embodiment, when a spoke (e.g., spoke <b>110</b>, <b>120</b>, or <b>130</b>) registers with the hub <b>105</b>, the spoke can register its IP address, next hop mapping information, and local prefix reachability information by encoding this information in a GDOI registration message to the hub <b>105</b>. Following the registration of a spoke with the hub <b>105</b>, the hub <b>105</b> can forward the new/updated spoke registration information to other registered spokes using GDOI. In one embodiment, the hub <b>105</b> sends the updated hub registration table <b>107</b>, or a portion thereof, to all registered spokes, and the spokes then update their respective local copies of the hub registration table <b>107</b>. In this manner, hub <b>105</b> updates all the spokes that are currently registered with an updated copy of the current hub registration table <b>107</b>.</p>
<p id="p-0039" num="0038">In one embodiment, the hub <b>105</b> sends the updated hub registration information to other spokes using GDOI. GDOI is a GKM Protocol (GKMP) used by a GCKS to distribute IPsec SA policy and keying material. Note that the hub <b>105</b> does not need to analyze the updated hub registration information prior to sending the information to other registered spokes.</p>
<p id="p-0040" num="0039">Each registered spoke that receives the updated hub registration information in a GDOI message from the hub <b>105</b> can store the updated hub registration information in a local spoke data store. In particular, each spoke can store the IP address of the spoke, the next hop mapping information (e.g., public address) for the spoke, the local prefix reachability information for the spoke (e.g., subnet addresses), and optionally the DH public value or public key value for the spoke in a local spoke database. Further, each spoke may install the associated prefix in a spoke routing table (RIB) as shown in <figref idref="DRAWINGS">FIG. 1</figref>. In this manner, spoke prefix information can be stored locally in the spoke (e.g., spoke <b>1</b> RIB <b>114</b>, spoke <b>2</b> RIB <b>124</b>, and spoke <b>3</b> RIB <b>134</b>) and used in next hop resolution. Further, GDOI can be used as a transport mechanism for the updated hub registration information. The hub can use the information from the updated hub registration information in a local hub data store to update the IP routing or forwarding table entries in the hub. Further, a spoke can use the information from the updated hub registration information in a local spoke data store to update the IP routing or forwarding table entries in the spoke.</p>
<p id="p-0041" num="0040">In one embodiment, when a spoke (e.g., spoke <b>110</b>, <b>120</b>, or <b>130</b>) registers with the hub <b>105</b>, the spoke does not need to check the availability of the prefix in the routing table (RIB) while including the prefix in the GDOI message sent to the hub <b>105</b>. In another embodiment, when a spoke (e.g., spoke <b>110</b>, <b>120</b>, or <b>130</b>) registers with the hub <b>105</b>, the spoke can check the availability of the prefix in the routing table (RIB) prior to including the prefix in the GDOI message sent to the hub <b>105</b>.</p>
<p id="p-0042" num="0041">Referring now to <figref idref="DRAWINGS">FIG. 3</figref>, a flow diagram illustrates the processing logic used in a sample embodiment. <figref idref="DRAWINGS">FIG. 3</figref> shows a sequence of initialization tasks performed to set up the hub <b>105</b>, the hub registration table <b>107</b>, and registering spokes. In processing block <b>310</b>, a registering spoke generates or obtains its own IP address, next hop mapping information, and local prefix reachability information and it encodes this information into a GDOI message. Next, in processing block <b>312</b>, the spoke registers with the hub and provides the following updated spoke registration information in a GDOI message to the hub: spoke IP address, next hop mapping information, and local prefix reachability information. In processing block <b>314</b>, the hub updates its hub Registration Table with the updated spoke registration information. In processing block <b>316</b>, the hub uses GDOI to update all other registered spokes with current updated hub Registration Table information associated with the newly registered or newly modified spoke.</p>
<p id="p-0043" num="0042">Referring now to <figref idref="DRAWINGS">FIG. 4</figref>, a diagram illustrates the network environment in which an example embodiment may operate. In this conventional network architecture, a server computer system <b>250</b> is coupled to a wide-area network <b>260</b>. Wide-area network <b>260</b> includes the Internet, or other proprietary networks, which are well known to those of ordinary skill in the art. Wide-area network <b>260</b> may include conventional network backbones, long-haul telephone lines, Internet service providers, various levels of network routers, and other conventional means for routing data between computers. Using conventional network protocols, server <b>250</b> may communicate through wide-area network <b>260</b> to a plurality of client computer systems <b>262</b>, <b>263</b>, and <b>264</b> connected through wide-area network <b>260</b> in various ways. For example, client <b>264</b> is connected directly to wide-area network <b>260</b> through direct or dial-up telephone or other network transmission line. Alternatively, clients <b>263</b> may be connected through wide-area network <b>260</b> using a modem pool <b>265</b>. A conventional modem pool <b>265</b> allows a plurality of client systems to connect with a smaller set of modems in modem pool <b>265</b> for connection through wide-area network <b>260</b>. In another alternative network topology, wide-area network <b>260</b> is connected to a gateway computer <b>270</b>. Gateway computer <b>270</b> is used to route data to clients <b>262</b> through a subnet and local area network (LAN) <b>272</b>. In this manner, clients <b>262</b> can communicate with each other through local area network <b>272</b> or with server <b>250</b> through gateway <b>270</b> and wide-area network <b>260</b>.</p>
<p id="p-0044" num="0043">Using one of a variety of network connection means, server computer system <b>250</b> can communicate with client computers <b>280</b> using conventional means. In a particular implementation of this network configuration, a server computer system <b>250</b> may operate as a web server if the Internet's World-Wide Web (WWW) is used for wide-area network <b>260</b>. Using the HTTP protocol and the HTML coding language across wide-area network <b>260</b>, server computer system <b>250</b> may communicate across the World-Wide Web with clients <b>280</b>. In this configuration, clients <b>280</b> use a client application program known as a web browser such as Internet Explorer&#x2122; published by Microsoft Corporation of Redmond, Wash., the user interface of America On-Line&#x2122;, or the web browser or HTML renderer of any other supplier. Using such conventional browsers and the World-Wide Web, clients <b>280</b> may access image, graphical, and textual data provided by server computer system <b>250</b> or they may run Web application software. Conventional means exist by which clients <b>280</b> may supply information to server computer system <b>250</b> through the World Wide Web (wide-area network <b>260</b>) and the server computer system <b>250</b> may return processed data to clients <b>280</b>.</p>
<p id="p-0045" num="0044">Having briefly described one embodiment of the network environment in which an example embodiment may operate, <figref idref="DRAWINGS">FIGS. 5 and 6</figref> show an example of a computer system <b>200</b> illustrating an exemplary client <b>280</b> or server computer system <b>250</b>, in which the features of an example embodiment may be implemented. Computer system <b>200</b> is comprised of a bus or other communications means <b>214</b> and <b>216</b> for communicating information, and a processing means such as processor <b>220</b>, coupled with bus <b>214</b>, for processing information. Computer system <b>200</b> further comprises a random access memory (RAM) or other dynamic storage device <b>222</b> (commonly referred to as main memory), coupled to bus <b>214</b>, for storing information and instructions to be executed by processor <b>220</b>. Main memory <b>222</b> may also be used for storing temporary variables or other intermediate information during execution of instructions by processor <b>220</b>. Computer system <b>200</b> also comprises a read only memory (ROM) and/or other static storage device <b>224</b>, coupled to bus <b>214</b>, for storing static information and instructions for processor <b>220</b>. Computer system <b>200</b> may also include a machine-readable medium <b>212</b>, such as a magnetic or optical disk, on which data and processor instructions may to stored and retrieved by processor <b>220</b>.</p>
<p id="p-0046" num="0045">An optional data storage device <b>228</b> such as a magnetic disk or optical disk and its corresponding drive may also be coupled to computer system <b>200</b> for storing information and instructions. Computer system <b>200</b> can also be coupled via bus <b>216</b> to a display device <b>204</b>, such as a cathode ray tube (CRT) or a liquid crystal display (LCD), for displaying information to a computer user. For example, image, textual, video, or graphical depictions of information may be presented to the user on display device <b>204</b>. Typically, an alphanumeric input device <b>208</b> (e.g. a keyboard), including alphanumeric and other keys, is coupled to bus <b>216</b> for communicating information and/or command selections to processor <b>220</b>. Another type of user input device is cursor control device <b>206</b>, such as a conventional mouse, trackball, or other type of cursor direction keys for communicating direction information and command selection to processor <b>220</b> and for controlling cursor movement on display device <b>204</b>.</p>
<p id="p-0047" num="0046">Alternatively, the client <b>280</b> can be implemented as a network computer or thin client device. Client <b>280</b> may also be a laptop or palm-top computing device, such as the Palm Pilot&#x2122;. Client <b>280</b> could also be implemented in a robust cellular telephone, where such devices are currently being used with Internet micro-browsers. Such a network computer or thin client device does not necessarily include all of the devices and features of the above-described exemplary computer system; however, the functionality of an example embodiment or a subset thereof may nevertheless be implemented with such devices.</p>
<p id="p-0048" num="0047">A communication device <b>226</b> is also coupled to bus <b>216</b> for accessing remote computers or servers, such as server computer system <b>250</b> or other servers, via the Internet, for example. The communication device <b>226</b> may include a modem, a network interface card, or other well-known interface devices, such as those used for interfacing with Ethernet, Token-ring, or other types of networks. In any event, in this manner, the computer system <b>200</b> may be coupled to a number of server computer systems <b>250</b> via a conventional network infrastructure such as the infrastructure illustrated in <figref idref="DRAWINGS">FIG. 4</figref> and described above.</p>
<p id="p-0049" num="0048">The system of an example embodiment includes software, information processing hardware, and various processing steps, which are described above. The features and process steps of example embodiments may be embodied in machine- or computer-executable instructions. The instructions can be used to cause a general purpose or special purpose processor, which is programmed with the instructions, to perform the steps of an example embodiment. Alternatively, the features or steps may be performed by specific hardware components that contain hard-wired logic for performing the steps, or by any combination of programmed computer components and custom hardware components. While embodiments are described with reference to the Internet, the method and apparatus described herein is equally applicable to other network infrastructures or other data communications systems.</p>
<p id="p-0050" num="0049">The use of particular embodiments with various types and formats of data structures may be described. It will be apparent to those of ordinary skill in the art that alternative embodiments of the implementations described herein can be employed and still fall within the scope of the claimed embodiments In the detail herein, various embodiments are described as being implemented in computer-implemented processing logic denoted sometimes herein as the &#x201c;software&#x201d;. As described above, however, the claimed invention is not limited to a purely software implementation.</p>
<p id="p-0051" num="0050">The software and/embodiments or data described herein may further be transmitted or received over a wide-area network <b>260</b> via the communication device <b>226</b> utilizing any one of a number of well-known transfer protocols, for example, the hyper-text transfer protocol (HTTP). While the machine-readable medium <b>212</b> is shown in an example embodiment to be a single medium, the term &#x201c;machine-readable medium&#x201d; should be taken to include a single medium or multiple media (e.g., a centralized or distributed database, and/or associated caches and servers) that store data and one or more sets of instructions. The term &#x201c;machine-readable medium&#x201d; shall also be taken to include any medium that is capable of storing, encoding, or carrying a set of instructions for execution by the machine and that cause the machine to perform any one or more of the methodologies of the disclosed subject matter, or that is capable of storing, encoding, or carrying data structures utilized by or associated with such a set of instructions. The term &#x201c;machine-readable medium&#x201d; shall accordingly be taken to include, but not be limited to, solid-state memories, optical and magnetic media, and carrier wave signals.</p>
<p id="p-0052" num="0051">Although the present specification describes components and functions implemented in the embodiments with reference to particular standards and protocols, the disclosed subject matter may be not limited to such standards and protocols. Each of the standards for Internet and other packet switched network transmission (e.g., TCP/IP, UDP/IP, HTML, and HTTP) represent examples of the state of the art. Such standards are periodically superseded by faster or more efficient equivalents having essentially the same functions. Accordingly, replacement standards and protocols having the same functions are considered equivalents.</p>
<p id="p-0053" num="0052">Thus, as described above, a system and method for improved efficiency in spoke-to-spoke network communication is disclosed. Although the disclosed subject matter has been described with reference to several example embodiments, it may be understood that the words that have been used are words of description and illustration, rather than words of limitation. Changes may be made within the purview of the appended claims, as presently stated and as amended, without departing from the scope and spirit of the disclosed subject matter in all its aspects. Although the disclosed subject matter has been described with reference to particular means, materials, and embodiments, the disclosed subject matter is not intended to be limited to the particulars disclosed; rather, the subject matter extends to all functionally equivalent structures, methods, and uses such as are within the scope of the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>We claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method comprising:
<claim-text>registering a spoke with a hub;</claim-text>
<claim-text>updating at least one database with spoke registration information at the hub;</claim-text>
<claim-text>encoding into the spoke registration information next hop information and prefix reachability information within extensions of a group key management protocol thereby eliminating a need for use of a next hop routing protocol; and</claim-text>
<claim-text>advertising the spoke registration information to other spokes using a single control plane provided by the extensions of the group key management protocol to integrate transport security, peer discovery, and unicast routing information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref> including sending information corresponding to at least a portion of the at least one database to a plurality of registered spokes via a Group Key Management Protocol (GKMP).</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method as claimed in <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein the GKMP includes a set of GKMP extensions.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref> wherein the set of GKMP extensions carry information pertaining to the single control plane.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref> wherein the set of GKMP extensions carry information pertaining to the single control plane, the information including next-hop mapping information.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref> wherein the set of GKMP extensions carry information pertaining to the single control plane, the information including prefix reachability information.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A method comprising:
<claim-text>registering a spoke with a hub via a Group Key Management Protocol (GKMP);</claim-text>
<claim-text>updating at least one database with spoke registration information;</claim-text>
<claim-text>encoding into the spoke registration information next hop information and prefix reachability information within extensions of the Group Key Management Protocol (GKMP) thereby eliminating a need for use of a next hop routing protocol; and</claim-text>
<claim-text>sending information corresponding to at least a portion of the at least one database to a plurality of registered spokes via a single control plane provided by the extensions of the Group Key Management Protocol (GKMP).</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein the GKMP includes a set of GKMP extensions.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein registering a spoke with a hub includes providing, in a GKMP message for the hub, spoke registration information including an IP address, and next hop mapping information corresponding to the registering spoke.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein registering a spoke with a hub includes providing, in a GKMP message for the hub, spoke registration information including an IP address, next hop mapping information, and local prefix reachability information corresponding to the registering spoke.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method as claimed in <claim-ref idref="CLM-00009">claim 9</claim-ref> wherein the next hop mapping information corresponds to an association of one or more next-hop IP addresses with one or more IP addresses.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref> including obtaining next hop mapping information and local prefix reachability information from the at least one database.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref> including obtaining next hop mapping information and local prefix reachability information in either an aggregated manner or an individual manner.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein the hub maintains the at least one database.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein the spoke maintains a local spoke database which includes information corresponding to at least a portion of the at least one database.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method as claimed in <claim-ref idref="CLM-00015">claim 15</claim-ref> wherein the spoke uses the information from the local spoke database to update IP routing or forwarding table entries in the spoke.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein the hub uses the information from the at least one database to update IP routing or forwarding table entries in the hub.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. A method comprising:
<claim-text>registering a spoke with a hub using extensions of a Group Key Management Protocol (GKMP) message to provide spoke registration information including an IP address, next hop mapping information, and local prefix reachability information corresponding to the registering spoke thereby eliminating a need for use of a next hop routing protocol;</claim-text>
<claim-text>updating at least one database with the spoke registration information; and</claim-text>
<claim-text>sending information corresponding to at least a portion of the at least one database to a plurality of registered spokes via a single control plane provided by the extensions of the Group Key Management Protocol (GKMP) message, the information having encoded therein next hop information and prefix reachability information within the extensions of the Group Key Management Protocol (GKMP) thereby eliminating a need for use of the next hop routing protocol.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method as claimed in <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein the hub maintains the at least one database.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The method as claimed in <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein the spoke maintains a local spoke data store which includes information corresponding to at least a portion of the at least one database.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. An apparatus comprising:
<claim-text>means for registering a spoke with a hub via a Group Key Management Protocol (GKMP);</claim-text>
<claim-text>means for updating at least one database with spoke registration information;</claim-text>
<claim-text>encoding into the spoke registration information next hop information and prefix reachability information within extensions of the Group Key Management Protocol (GKMP) thereby eliminating a need for use of a next hop routing protocol; and</claim-text>
<claim-text>means for sending information corresponding to at least a portion of the at least one database to a plurality of registered spokes via a single control plane provided by the extensions of the Group Key Management Protocol (GKMP).</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The apparatus as claimed in <claim-ref idref="CLM-00021">claim 21</claim-ref> wherein the GKMP includes a set of GKMP extensions.</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. A hub apparatus comprising:
<claim-text>a hub/spoke interface to receive a spoke registration message from a spoke via a Group Key Management Protocol (GKMP);</claim-text>
<claim-text>a hub database for storage of spoke registration information from the spoke registration message; and</claim-text>
<claim-text>a hub updater to encode into the spoke registration information next hop information and prefix reachability information within extensions of the Group Key Management Protocol (GKMP) thereby eliminating a need for use of a next hop routing protocol, the hub updater further to send information corresponding to at least a portion of the hub database to a plurality of registered spokes via a single control plane provided by the extensions of the Group Key Management Protocol (GKMP).</claim-text>
</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The hub apparatus as claimed in <claim-ref idref="CLM-00023">claim 23</claim-ref> wherein the spoke registration message includes an IP address, next hop mapping information, and local prefix reachability information corresponding to the registering spoke. </claim-text>
</claim>
</claims>
</us-patent-grant>
