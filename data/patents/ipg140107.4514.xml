<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625597-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625597</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12987057</doc-number>
<date>20110107</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>114</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>12</main-group>
<subgroup>28</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20110101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>12</main-group>
<subgroup>56</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>370392</main-classification>
</classification-national>
<invention-title id="d2e53">Methods, systems and apparatus for the interconnection of fibre channel over ethernet devices</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>7149214</doc-number>
<kind>B2</kind>
<name>Wu et al.</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7155494</doc-number>
<kind>B2</kind>
<name>Czeiger et al.</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7573916</doc-number>
<kind>B1</kind>
<name>Bechtolsheim et al.</name>
<date>20090800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7586915</doc-number>
<kind>B1</kind>
<name>Indiresan et al.</name>
<date>20090900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7606886</doc-number>
<kind>B1</kind>
<name>Bechtolsheim et al.</name>
<date>20091000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7616637</doc-number>
<kind>B1</kind>
<name>Lee et al.</name>
<date>20091100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7720997</doc-number>
<kind>B1</kind>
<name>Gourlay et al.</name>
<date>20100500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>7792148</doc-number>
<kind>B2</kind>
<name>Carlson et al.</name>
<date>20100900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>7944812</doc-number>
<kind>B2</kind>
<name>Carlson et al.</name>
<date>20110500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>7969989</doc-number>
<kind>B2</kind>
<name>Hirata</name>
<date>20110600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>7991907</doc-number>
<kind>B2</kind>
<name>Parnafes et al.</name>
<date>20110800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>8006063</doc-number>
<kind>B2</kind>
<name>Mimatsu et al.</name>
<date>20110800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>8060587</doc-number>
<kind>B2</kind>
<name>Ahmad et al.</name>
<date>20111100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>8108454</doc-number>
<kind>B2</kind>
<name>Snively et al.</name>
<date>20120100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>8175539</doc-number>
<kind>B2</kind>
<name>Diener et al.</name>
<date>20120500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>8214528</doc-number>
<kind>B2</kind>
<name>Hirata et al.</name>
<date>20120700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>8238347</doc-number>
<kind>B2</kind>
<name>DeSanti et al.</name>
<date>20120800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>8243746</doc-number>
<kind>B2</kind>
<name>DiBenedetto</name>
<date>20120800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>8264985</doc-number>
<kind>B2</kind>
<name>DeSanti</name>
<date>20120900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370254</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>8270420</doc-number>
<kind>B2</kind>
<name>Wang et al.</name>
<date>20120900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>8284785</doc-number>
<kind>B2</kind>
<name>Hirata</name>
<date>20121000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>8369347</doc-number>
<kind>B2</kind>
<name>Xiong et al.</name>
<date>20130200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2008/0072305</doc-number>
<kind>A1</kind>
<name>Casado et al.</name>
<date>20080300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>2008/0189769</doc-number>
<kind>A1</kind>
<name>Casado et al.</name>
<date>20080800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>2008/0195756</doc-number>
<kind>A1</kind>
<name>Galles</name>
<date>20080800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>2008/0201455</doc-number>
<kind>A1</kind>
<name>Husain</name>
<date>20080800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>2009/0037977</doc-number>
<kind>A1</kind>
<name>Gai et al.</name>
<date>20090200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>2009/0046734</doc-number>
<kind>A1</kind>
<name>Cheriton et al.</name>
<date>20090200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00029">
<document-id>
<country>US</country>
<doc-number>2009/0052461</doc-number>
<kind>A1</kind>
<name>Brown et al.</name>
<date>20090200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00030">
<document-id>
<country>US</country>
<doc-number>2009/0132701</doc-number>
<kind>A1</kind>
<name>Snively</name>
<date>20090500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00031">
<document-id>
<country>US</country>
<doc-number>2009/0138577</doc-number>
<kind>A1</kind>
<name>Casado et al.</name>
<date>20090500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00032">
<document-id>
<country>US</country>
<doc-number>2009/0161692</doc-number>
<kind>A1</kind>
<name>Hirata et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00033">
<document-id>
<country>US</country>
<doc-number>2009/0245791</doc-number>
<kind>A1</kind>
<name>Thaler et al.</name>
<date>20091000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00034">
<document-id>
<country>US</country>
<doc-number>2009/0252181</doc-number>
<kind>A1</kind>
<name>Desanti</name>
<date>20091000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00035">
<document-id>
<country>US</country>
<doc-number>2009/0276526</doc-number>
<kind>A1</kind>
<name>Carlson et al.</name>
<date>20091100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00036">
<document-id>
<country>US</country>
<doc-number>2009/0296726</doc-number>
<kind>A1</kind>
<name>Snively et al.</name>
<date>20091200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00037">
<document-id>
<country>US</country>
<doc-number>2010/0011114</doc-number>
<kind>A1</kind>
<name>Thomas et al.</name>
<date>20100100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00038">
<document-id>
<country>US</country>
<doc-number>2010/0017497</doc-number>
<kind>A1</kind>
<name>Brown et al.</name>
<date>20100100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00039">
<document-id>
<country>US</country>
<doc-number>2010/0115132</doc-number>
<kind>A1</kind>
<name>Hirata et al.</name>
<date>20100500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00040">
<document-id>
<country>US</country>
<doc-number>2010/0232419</doc-number>
<kind>A1</kind>
<name>Rivers</name>
<date>20100900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00041">
<document-id>
<country>US</country>
<doc-number>2010/0232793</doc-number>
<kind>A1</kind>
<name>Atkinson</name>
<date>20100900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00042">
<document-id>
<country>US</country>
<doc-number>2010/0246388</doc-number>
<kind>A1</kind>
<name>Gupta et al.</name>
<date>20100900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00043">
<document-id>
<country>US</country>
<doc-number>2010/0257263</doc-number>
<kind>A1</kind>
<name>Casado et al.</name>
<date>20101000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00044">
<document-id>
<country>US</country>
<doc-number>2012/0079104</doc-number>
<kind>A1</kind>
<name>Casado et al.</name>
<date>20120300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00045">
<document-id>
<country>US</country>
<doc-number>2012/0177039</doc-number>
<kind>A1</kind>
<name>Berman</name>
<date>20120700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00046">
<document-id>
<country>US</country>
<doc-number>2012/0177042</doc-number>
<kind>A1</kind>
<name>Berman</name>
<date>20120700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00047">
<document-id>
<country>US</country>
<doc-number>2012/0177043</doc-number>
<kind>A1</kind>
<name>Berman</name>
<date>20120700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00048">
<document-id>
<country>US</country>
<doc-number>2012/0177044</doc-number>
<kind>A1</kind>
<name>Berman</name>
<date>20120700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00049">
<document-id>
<country>US</country>
<doc-number>2012/0177045</doc-number>
<kind>A1</kind>
<name>Berman</name>
<date>20120700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00050">
<document-id>
<country>US</country>
<doc-number>2012/0177370</doc-number>
<kind>A1</kind>
<name>Berman</name>
<date>20120700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00051">
<document-id>
<country>US</country>
<doc-number>2012/0195188</doc-number>
<kind>A1</kind>
<name>Zhang</name>
<date>20120800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00052">
<document-id>
<country>US</country>
<doc-number>2013/0028135</doc-number>
<kind>A1</kind>
<name>Berman</name>
<date>20130100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00053">
<othercit>Das, et al., Unifying Packet and Circuit Switched Networks with OpenFlow, OPENFLOW-TR-2009-4, Dec. 7, 2009, http://OpenFlowSwitch.org/downloads/technicalreports/openflow-tr-2009-4-unification.pdf, abstract, pp. 1-9.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00054">
<othercit>Eastlake 3<sup>rd</sup>, et al., &#x201c;RBridges: Support of IEEE 802.1Qbb, 802.1Qaz, and 802.1Qau &#x3c;draft-eastlake-trill-rbridge-dcb-00.txt&#x3e;&#x201d;, Aug. 17, 2010, 23 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00055">
<othercit>Guttman, et al., &#x201c;RFC 2608 Service Location Protocol (SLP), Version 2&#x201d;, Jun. 1999, 51 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00056">
<othercit>IEEE Computer Society, &#x201c;IEEE Std 802.1Q&#x2014;2005, IEEE Standards for Local and Metropolitan Area Networks&#x2014;Virtual Bridged Local Area Networks&#x201d;, May 16, 2006, 303 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00057">
<othercit>IEEE Computer Society, &#x201c;IEEE Standard for Local and metropolitan area networks, Media Access Control (MAC) Security&#x201d;, IEEE Std 802.1AE-2006, Aug. 18, 2006. 154 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00058">
<othercit>IEEE Computer Society, 802.1D, IEEE Standard for Local and metropolitan area networks, Media Access Control (MAC) Bridges, SH95213, Jun. 9, 2004, 281 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00059">
<othercit>IEEE Computer Society, &#x201c;IEEE Standard for Local and metropolitan area networks&#x2014;Virtual Bridged Local Area Networks Amendment 10: Provider Backbone Bridge Traffic Engineering&#x201d;, IEEE Std. 802.1 Qay-2009, Aug. 5, 2009, 145 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00060">
<othercit>IEEE Computer Society, &#x201c;IEEE Standard for Local and metropolitan area networks&#x2014;Port-Based Network Access Control&#x201d;, LAN/MAN Standards Committee, IEEE Std 802.1X-2001, Jun. 14, 2001 2001, 142 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00061">
<othercit>International Search Report and Written Opinion for PCT/US2011/067643, Mar. 20, 2012, 14 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00062">
<othercit>McKeown et al., &#x201c;OpenFlow: Enabling Innovation in Campus Networks&#x201d;, Mar. 14, 2008, 6 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00063">
<othercit>Monia et al., &#x201c;RFC 4172 Ifcp&#x2014;A Protocol for Internet Fibre Channel Storage Networking&#x201d;, Sep. 2005, 85 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00064">
<othercit>Nicira, &#x201c;Network Virtualization Platform&#x201d; http://nicira.com/en/netwOrk-virtualization-platform, printed Jun. 6, 2012, 2 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00065">
<othercit>Nicira, &#x201c;Nicira Network Virtualization Platform (NVP), Visualize the Network&#x201d;, Product Data Sheet, printed Jun. 6, 2012, pp. 1-2.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00066">
<othercit>Nicira, &#x201c;It's Time to Virtualize the Network, Network Virtualization for Cloud Data Centers&#x201d;, White Paper, 2012, printed Jun. 6, 2012, 8 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00067">
<othercit>Open Networking Foundation, &#x201c;Testing-Interop Working Group&#x201d;, Interoperability Event White Paper, Mar. 2012, Version 1.0, pp. 1-20.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00068">
<othercit>Open Networking Foundation, &#x201c;Software-Defined Networking: The New Norm for Networks&#x201d;, ONF White Paper, Apr. 13, 2012, pp. 1-12.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00069">
<othercit>Open Networking Foundation, &#x201c;OpenFlow 1.2&#x201d;, Dec. 2011, title page, pp. 1-82.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00070">
<othercit>Open Networking Foundation, &#x201c;OpenFlow Switch Specification&#x201d;, Version 1.3.0 (Wire Protocol 0x04), Apr. 16, 2012, pp. 1-105.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00071">
<othercit>Open Networking Foundation, &#x201c;OF-Config 1.1, OpenFlow Management and Configuration Protocol&#x201d;, Document Version .15, 2012, title page, pp. 1-117.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00072">
<othercit>Open Networking Foundation, &#x201c;OpenFlow Configuration and Management Protocol, OF-Config 1.0&#x201d;, 2012, printed Jun. 6, 2012, pp. 1-73.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00073">
<othercit>Sherwood, et al., &#x201c;FlowVisor. A Network Virtualization Layer&#x201d;, OPENFLOW-TR-2009-1, Oct. 14, 2009, http://OpenFlowSwitch.org/downloads/technicalreports/openflow-tr-2009-1-flowvisor.pdf., abstract, pp. 1-14.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00074">
<othercit>Simpson, &#x201c;RFC 1661 The Point-to-Point Protocol (PPP)&#x201d;, Jul. 1994, 54 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00075">
<othercit>Touch, et al., &#x201c;RFC 5556 RBridges: Base Protocol Specification &#x3c;draft-ietf-trill-rbridge-protocol-16.txt&#x3e;&#x201d;, Mar. 3, 2010, 117 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00076">
<othercit>Tseng, et al., &#x201c;RFC 4171 Internet Storage Name Service (iSNS)&#x201d;, Sep. 2005, 124 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00077">
<othercit>Weber, et al., &#x201c;RFC 3643 Fibre Channel (FC) Frame Encapsulation&#x201d;, Dec. 2003, 21 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00078">
<othercit>Yap, et al. &#x201c;Blueprint for Introducing Innovation into the Wireless Networks we use every day&#x201d;, OPENFLOW-TR-2009-3, Oct. 12, 2009, http://OpenFlowSwitch.org/downloads/technicalreports/openflow-tr-2009-3-openflow-wireless.pdf , abstract, pp. 1-7.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00079">
<othercit>Yap, et al., &#x201c;Separating Authentication, Access and Accounting: A Case Study with Open WiFi&#x201d;, OPENFLOW-TR-2011-1, Jul. 2011, last updated: Sep. 2011, abstract and 6 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>19</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>48</number-of-drawing-sheets>
<number-of-figures>48</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120177041</doc-number>
<kind>A1</kind>
<date>20120712</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Berman</last-name>
<first-name>Stuart B.</first-name>
<address>
<city>Newport Coast</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Berman</last-name>
<first-name>Stuart B.</first-name>
<address>
<city>Newport Coast</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Murphy</last-name>
<first-name>David B.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<orgname>O'Melveny &#x26; Myers LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Jeda Networks, Inc.</orgname>
<role>02</role>
<address>
<city>Newport Beach</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Sheikh</last-name>
<first-name>Ayaz</first-name>
<department>2476</department>
</primary-examiner>
<assistant-examiner>
<last-name>Wong</last-name>
<first-name>Blanche</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Methods, apparatus and systems are provided for forwarding Fibre Channel Initialization Protocol (FIP) frames and Fibre Channel over Ethernet (FCoE) frames by a FCoE device interconnection apparatus (FIA) and with a Fibre Channel over Ethernet device interconnection apparatus controller (FIAC). An FCoE frame received by the FIA from the FCoE device includes at least destination and source Ethernet MAC address fields which are replaced, such as where the destination Ethernet MAC address is replaced by the MAC address assigned to a remote FCoE device, such as the desired end port. The frame is forwarded to the destination FCoE device. Preferably, first and second ports are coupled to the connectivity apparatus, which are then coupled to first and second FCoE devices.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="161.29mm" wi="239.86mm" file="US08625597-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="210.57mm" wi="154.52mm" orientation="landscape" file="US08625597-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="197.36mm" wi="161.80mm" orientation="landscape" file="US08625597-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="173.99mm" wi="166.71mm" orientation="landscape" file="US08625597-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="232.58mm" wi="148.93mm" orientation="landscape" file="US08625597-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="230.29mm" wi="171.37mm" orientation="landscape" file="US08625597-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="215.14mm" wi="185.50mm" orientation="landscape" file="US08625597-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="207.26mm" wi="150.28mm" orientation="landscape" file="US08625597-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="242.99mm" wi="162.05mm" orientation="landscape" file="US08625597-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="243.84mm" wi="158.83mm" orientation="landscape" file="US08625597-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="218.78mm" wi="171.37mm" orientation="landscape" file="US08625597-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="228.35mm" wi="169.33mm" orientation="landscape" file="US08625597-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="232.92mm" wi="156.21mm" orientation="landscape" file="US08625597-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="255.69mm" wi="177.88mm" orientation="landscape" file="US08625597-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="239.52mm" wi="154.18mm" orientation="landscape" file="US08625597-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="214.46mm" wi="168.99mm" orientation="landscape" file="US08625597-20140107-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="249.43mm" wi="159.17mm" orientation="landscape" file="US08625597-20140107-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="232.58mm" wi="167.05mm" orientation="landscape" file="US08625597-20140107-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="233.93mm" wi="150.54mm" orientation="landscape" file="US08625597-20140107-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00019" num="00019">
<img id="EMI-D00019" he="261.62mm" wi="201.00mm" orientation="landscape" file="US08625597-20140107-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00020" num="00020">
<img id="EMI-D00020" he="229.28mm" wi="170.01mm" orientation="landscape" file="US08625597-20140107-D00020.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00021" num="00021">
<img id="EMI-D00021" he="236.56mm" wi="184.49mm" orientation="landscape" file="US08625597-20140107-D00021.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00022" num="00022">
<img id="EMI-D00022" he="228.01mm" wi="181.53mm" orientation="landscape" file="US08625597-20140107-D00022.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00023" num="00023">
<img id="EMI-D00023" he="238.25mm" wi="159.77mm" orientation="landscape" file="US08625597-20140107-D00023.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00024" num="00024">
<img id="EMI-D00024" he="244.52mm" wi="160.10mm" orientation="landscape" file="US08625597-20140107-D00024.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00025" num="00025">
<img id="EMI-D00025" he="260.27mm" wi="160.44mm" orientation="landscape" file="US08625597-20140107-D00025.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00026" num="00026">
<img id="EMI-D00026" he="238.25mm" wi="164.42mm" orientation="landscape" file="US08625597-20140107-D00026.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00027" num="00027">
<img id="EMI-D00027" he="250.44mm" wi="179.58mm" orientation="landscape" file="US08625597-20140107-D00027.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00028" num="00028">
<img id="EMI-D00028" he="236.90mm" wi="167.64mm" orientation="landscape" file="US08625597-20140107-D00028.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00029" num="00029">
<img id="EMI-D00029" he="246.13mm" wi="173.65mm" orientation="landscape" file="US08625597-20140107-D00029.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00030" num="00030">
<img id="EMI-D00030" he="250.44mm" wi="157.82mm" orientation="landscape" file="US08625597-20140107-D00030.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00031" num="00031">
<img id="EMI-D00031" he="252.81mm" wi="185.08mm" orientation="landscape" file="US08625597-20140107-D00031.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00032" num="00032">
<img id="EMI-D00032" he="256.37mm" wi="184.49mm" orientation="landscape" file="US08625597-20140107-D00032.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00033" num="00033">
<img id="EMI-D00033" he="238.84mm" wi="173.99mm" orientation="landscape" file="US08625597-20140107-D00033.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00034" num="00034">
<img id="EMI-D00034" he="225.04mm" wi="149.94mm" orientation="landscape" file="US08625597-20140107-D00034.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00035" num="00035">
<img id="EMI-D00035" he="260.94mm" wi="186.18mm" orientation="landscape" file="US08625597-20140107-D00035.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00036" num="00036">
<img id="EMI-D00036" he="225.72mm" wi="164.42mm" orientation="landscape" file="US08625597-20140107-D00036.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00037" num="00037">
<img id="EMI-D00037" he="239.86mm" wi="195.41mm" orientation="landscape" file="US08625597-20140107-D00037.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00038" num="00038">
<img id="EMI-D00038" he="253.66mm" wi="189.15mm" orientation="landscape" file="US08625597-20140107-D00038.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00039" num="00039">
<img id="EMI-D00039" he="219.46mm" wi="115.99mm" orientation="landscape" file="US08625597-20140107-D00039.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00040" num="00040">
<img id="EMI-D00040" he="254.00mm" wi="137.75mm" orientation="landscape" file="US08625597-20140107-D00040.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00041" num="00041">
<img id="EMI-D00041" he="234.95mm" wi="175.94mm" orientation="landscape" file="US08625597-20140107-D00041.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00042" num="00042">
<img id="EMI-D00042" he="232.92mm" wi="181.19mm" orientation="landscape" file="US08625597-20140107-D00042.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00043" num="00043">
<img id="EMI-D00043" he="228.35mm" wi="179.24mm" orientation="landscape" file="US08625597-20140107-D00043.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00044" num="00044">
<img id="EMI-D00044" he="222.76mm" wi="174.33mm" orientation="landscape" file="US08625597-20140107-D00044.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00045" num="00045">
<img id="EMI-D00045" he="226.65mm" wi="173.31mm" orientation="landscape" file="US08625597-20140107-D00045.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00046" num="00046">
<img id="EMI-D00046" he="243.50mm" wi="172.97mm" orientation="landscape" file="US08625597-20140107-D00046.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00047" num="00047">
<img id="EMI-D00047" he="195.07mm" wi="182.88mm" orientation="landscape" file="US08625597-20140107-D00047.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00048" num="00048">
<img id="EMI-D00048" he="262.30mm" wi="167.72mm" orientation="landscape" file="US08625597-20140107-D00048.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATION INFORMATION</heading>
<p id="p-0002" num="0001">This patent application is related in subject matter to United States patent application entitled &#x201c;Methods, Systems and Apparatus for the Interconnection of Fibre Channel Over Ethernet Devices Using a Fibre Channel Over Ethernet Interconnection Apparatus Controller&#x201d;, filed on even date herewith; United States patent application entitled &#x201c;Methods, Systems, and Apparatus for the Servicing of Fibre Channel Fabric Login Frames&#x201d;, filed on even date herewith; United States patent application entitled &#x201c;Methods, Systems and Apparatus for Utilizing an iSNS Server in a Network of Fibre Channel Over Ethernet Devices&#x201d;, filed on even date herewith; United States patent application entitled &#x201c;Methods, Systems and Apparatus for the Interconnection of Fibre Channel Over Ethernet Devices Using a TRILL Network&#x201d;, filed on even date herewith; United States patent application entitled &#x201c;Methods, Systems and Apparatus for Converged Network Adapters&#x201d;, filed on even date herewith; and United States patent application entitled &#x201c;Methods, Systems and Apparatus for the Interconnection of Fibre Channel Over Ethernet Devices Using Shortest Path Bridging&#x201d;, filed on even date herewith; which are all incorporated herein by reference as if fully set forth herein.</p>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The disclosures and embodiments of the invention relate to network systems and communications networks, more particularly, certain embodiments of the invention relate to a method and system for Fibre Channel over Ethernet networking, Fibre Channel networking, and IEEE 802.2 frame forwarding.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">Today they are at least two separate networks found in Data Centers. The more ubiquitous of the networks, the Local Area Network (LAN), is based on the Ethernet protocol and is mainly used for server to server and server to Internet communications. The other network, the Storage Area Network (SAN), is specialized to carry server to storage communications. The Data Center SAN is mainly based on the Fibre Channel protocol and has the following characteristics: low latency, high bandwidth, and a loss-less network. Recently there have been innovations to merge the SAN with the LAN. The promised benefits include a savings from the reduced equipment needs and the resulting savings on the amount of equipment real estate, power, and cooling required. Newly created standards comprising this LAN/SAN convergence define how SAN frames, namely Fibre Channel protocol frames, are mapped over the Ethernet network. These new frames are called Fibre Channel over Ethernet (FCoE) frames. Additional standards define how to make the Ethernet network lossless, i.e., to add flow control at the network level to prevent Ethernet frames from being dropped due to congestion. Still other standards define how to segment the transmission line into classes that virtually separate the communications over the transmission line.</p>
<p id="p-0005" num="0004">Converging the LAN and SAN networks has created additional complexity in the management, control, and data switching areas. Singly, the Fibre Channel switch fabric protocols are very complex and have shown to be not very interoperable between the small number of vendors who build products that support them. Mapping the Fibre Channel switch fabric protocols over Ethernet has resulted in a dizzying amount of new standards that have inhibited the market acceptance of the Fibre Channel over Ethernet (FCoE) mapping over this new converged network. New switches have been defined called Fibre Channel Forwarders (FCFs) and Fibre Channel Data Forwarders (FDFs), which add Fibre Channel over Ethernet and Ethernet elements to the already complex Fibre Channel switch architecture. FCFs and FDFs interconnect ENodes, which are Fibre Channel or devices nodes that are able to transmit Fibre Channel over Ethernet frames. There have been some standards and innovations applied to ENodes, and their embedded Virtual N_Ports (VN_Ports), to connect without using FCFs or FDFs. One of these efforts defines an ENode to ENode connection method, called VN_Port to VN_Port (VN<b>2</b>VN) whereby ENodes can connect to each other over a Lossless Ethernet network without an FCF or FDF. Other methods have been suggested to move some of the FCF/FDF intelligence to the ENode. Both the emerging VN<b>2</b>VN standard and the emerging direct ENode direct connect methods have many significant disadvantages. These disadvantages include but are not limited to: the requirement for the ENode to choose a unique Media Access Control (MAC) address for each VN_Port, the requirement for the ENode to choose a unique Fibre Channel address identifier for each VN_Port, the lack of visibility into the network's supported maximum frame size or other capabilities, the lack of standardized discovery of specific ENode types such as Storage targets, the lack of the ability to automatically and dynamically create Fibre Channel zones or access control lists (ACLs) for intermediate Ethernet bridges, the lack of visibility to load balance across several paths from a source ENode to a destination ENode based on FCIDs, and the increased complexity to scale to hundreds of ENodes which requires error prone manual configuration. Due to the lack of Fibre Channel fabric control, these emerging ideas and standards target smaller networks of ENodes, which are impractical in today's Data Center.</p>
<p id="p-0006" num="0005">In parallel with the innovations around converging the LAN and SAN, there have also been a trend to virtualize servers, i.e., consolidate a corporation's many underutilized servers onto fewer more utilized servers. The server virtualization trend has many advantages, including more utilization of existing underutilized servers, lower equipment space, power, and cooling requirements since there are fewer servers. This trend results in fewer and higher utilized servers which have changed the traffic characteristics of the LAN that interconnects them. The traffic requirements which used to be flowing from Internet to Server have changed to an any-to-any server flow. This migration in traffic patterns has produced a trend to &#x201c;flatten&#x201d; LANs, i.e., consolidate the normally three layers (core, distribution, and access) of switches commonly found in a Data Center to two layers (core and access). In parallel with this physical flattening trend is the trend towards utilizing layer <b>2</b> forwarding methods to keep the network in a single broadcast domain, which helps support any-to-any connection requirements of virtualized servers and their hypervisors. New link level protocols have been defined to accelerate the ability for any to any server based virtual machine communications. Many of these new link level protocols need new switch hardware and new ways to manage the resulting network.</p>
<p id="p-0007" num="0006">What is needed is a simpler way to converge the LAN and SAN in a scalable and less complex method than the trajectory of both the standards committees and emerging ENode to ENode inventions. What is also needed is have this simpler method be more compatible with the trend towards flattening the large Data Center networks. Both simpler methods need to be easily managed, scalable, and interoperable. Accomplishing this would accelerate the LAN/SAN network convergence trend and accelerate the flattening of the LAN to more easily attain the benefits of virtualization, convergence, and consolidation.</p>
<heading id="h-0004" level="1">BRIEF SUMMARY OF THE INVENTION</heading>
<p id="p-0008" num="0007">Methods, apparatus and systems are provided for forwarding Fibre Channel Initialization Protocol (FIP) frames and Fibre Channel over Ethernet (FCoE) frames by a FCoE device interconnection apparatus (FIA) and with a Fibre Channel over Ethernet device interconnection apparatus controller (FIAC). In one aspect, a FIP frame is received from a FCoE device by a FIA. The FIP frame includes at least a destination and source Ethernet Media Access Control (MAC) address fields. The received FIP frame is forwarded to a FCoE device interconnection apparatus controller (FIAC) over an Ethernet link. The FCoE frame received by the FIA from the FCoE device includes at least destination and source Ethernet MAC address fields. The destination and source Ethernet MAC addresses are replaced, such as where the destination Ethernet MAC address is replaced by the MAC address assigned to a remote FCoE device, such as the desired end port. Finally, the frame is forwarded to the destination FCoE device. Preferably, first and second ports are coupled to the connectivity apparatus, which are then coupled to first and second FCoE devices.</p>
<p id="p-0009" num="0008">Methods, apparatus and systems are provided for forwarding Fibre Channel Initialization Protocol (PIP) and Fibre Channel over Ethernet (FCoE) frames by a FCoE device interconnection apparatus (FIA) and a Fibre Channel over Ethernet device interconnection apparatus controller (FIAC). In one aspect of the invention, a command is sent from a FIAC to the FIA to set the frame processing apparatus to identify received FIP frames, which are forwarded with the original destination and source Ethernet Media Access Control (MAC) addresses. A PIP frame received by the FIA is identified and forwarded by the frame processing apparatus. A command is sent from the FIAC to the FIA to identify received FCoE frames, and to have the source and destination Ethernet MAC addresses in said received FCoE frame replaced. When a FCoE frame is received by the FIA, the source and destination Ethernet MAC addresses are replaced, such as where the destination Ethernet MAC address of the received matched FCoE frame is replaced by the MAC address assigned to the desired end port. The FCoE frame is forwarded to a destination FCoE device.</p>
<p id="p-0010" num="0009">Methods, apparatus and systems are provided for processing Fibre Channel Fabric Login frames by a FCoE device interconnection apparatus (FIA) and a FCoE device interconnection apparatus controller (FIAC). A Fabric Login (FLOGI) Fibre Channel frame is received from a Fibre Channel device at a Fibre Channel device interconnection apparatus (FIA). The FLOGI Fibre Channel frame is encapsulated into a Fibre Channel over Ethernet (FCoE) FIP FLOGI frame at the FIA. The encapsulated frame is transmitted from the FIA to a FCoE device interconnection apparatus controller (PAC). At the FIAC, the FIP FLOGI frame is received and processed. Thereafter, a FIP link service accept (LS_ACC) frame is transmitted by the FIAC to the FIA, and the FIP LS_ACC frame is received by the FIA. The FIP frame is decapsulated into a Fibre Channel LS_ACC frame at the FIA. The Fibre Channel LS_ACC frame is transmitted back to the said Fibre Channel device. Preferably, first and second ports are coupled to the connectivity apparatus and adapted to receive FCoE and FIP frames, which are then coupled to first and second FCoE devices.</p>
<p id="p-0011" num="0010">Methods, apparatus and systems are provided for assigning Fibre Channel Domain identifiers with an iSNS Server, a Fibre Channel over Ethernet device interconnection apparatus controller (FIAC), and a Fibre Channel over Ethernet device interconnection apparatus (FIA). A Request Domain Identifier iSNS protocol message is sent from a FCoE device interconnection apparatus controller (FIAC) to a iSNS Server. A Request Domain Identifier iSNS protocol message reply is received from the iSNS Server by the FIAC A Fibre Channel Initialization Protocol (FIP) Fabric Login (FLOGI) frame is received from a Fibre Channel over Ethernet (FCoE) device by a FCoE device interconnection apparatus (FIA). The FIP FLOGI frame is forwarded by the FIA. At the FIAC, a new Fibre Channel address identifier is assigned, using the Domain Identifier assigned from the Request Domain Identifier response message. At the FIAC, a FIP link service accept (LS_ACC) response is transmitted to the FIP FLOGI comprising the newly assigned Fibre Channel address identifier at the FIAC. At the FIA, the FIP LS_ACC is received and forwards the FIP LS_ACC frame to the FCoE device that transmitted the FIP FLOGI frame.</p>
<p id="p-0012" num="0011">Methods, apparatus and systems are provided for forwarding Fibre Channel over Ethernet (FCoE) frames over a TRILL network by a FCoE device interconnection apparatus (FIA). A FCoE frame is received from a FCoE device at the FIA. The frame includes at least destination Ethernet MAC address and source Ethernet MAC address fields. The destination Ethernet MAC address of the incoming frame is replaced with the MAC address of the remote FCoE device as determined by the Fibre Channel destination address identifier in the received. FCoE frame. The source Ethernet MAC address of the incoming frame is replaced. The frame is encapsulated in a TRILL header. The frame is forwarded to an egress FCoE device interconnection apparatus (FIA). The frame is then decapsulated into a FCoE frame, which is forwarded to an attached FCoE device with the original destination and source Ethernet MAC addresses.</p>
<p id="p-0013" num="0012">Methods, apparatus and systems are provided for creating virtual links between Fibre Channel over Ethernet (FCoE) nodes. FIP Discovery Advertisement frames are received from multiple FCoE device interconnection apparatus (FIA). The FIP Discovery Advertisement frames preferably includes source Ethernet MAC addresses, a destination Ethernet MAC address of All-ENode-MACs, Fabric FP descriptor, and a Priority FIP descriptor. A list is stored of one or more of the source Ethernet MAC address, FIP Priority descriptor, and FIP Fabric descriptor for each unique FIP Discovery Advertisement frame received as indicated by the Fabric descriptor. The Name Server is queried for each source Ethernet MAC address in said storage. For all FCoE devices that match in more that one Name Server, connect to those FCoE devices using the highest priority Ethernet MAC address from matching list items.</p>
<p id="p-0014" num="0013">Methods, apparatus and systems are provided for forwarding Fibre Channel over Ethernet (FCoE) frames over a Shortest Path Bridged network with a FCoE device interconnection apparatus (FIA). A FCoE frame is received from a FCoE device, the frame including at least destination Ethernet MAC address and source Ethernet MAC address fields. The destination Ethernet MAC address of the incoming frame is replaced with the MAC address of the remote FCoE device as determined by the Fibre Channel destination address identifier in the received FCoE frame. The source Ethernet MAC address of the incoming frame is replaced. The frame is encapsulated in a MAC header. The frame is forwarded to an egress FCoE device interconnection apparatus (FIA). Thereafter, the outer MAC header of the received frame is decapsulated into a FCoE frame. The decapsulated frame is forwarded to an attached FCoE device with the original destination and source Ethernet MAC addresses.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0015" num="0014">The drawings illustrate only exemplary embodiments of the invention and therefore do not limit its scope because the inventive concepts lend themselves to other equally effective embodiments.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 1</figref> illustrates the prior art FC-BB_E mapping of Fibre Channel levels and sublevels over IEEE 802.3 layers.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2</figref> shows the prior art FC-BB_E definition of end devices, an ENode and a FCoE Forwarder (FCF).</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram showing the prior art FCoE frame format.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 4</figref> illustrates the prior art FTP frame PDU format.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 5</figref> is a diagram illustrating the prior art ENode and FCF connection model.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 6</figref> is a diagram of a prior art FCF functional model.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 7</figref> is a diagram of a prior art ENode functional model.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 8</figref> is a diagram of a FIA and FIAC Functional Model.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 9</figref> is a diagram of a FIA.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 10</figref> is a detailed diagram of a bridge adapted to implement a FR with FCoE frame connectivity.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 11</figref> is a detailed diagram of an FIA adapted to connect to Fibre Channel links and devices.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 12</figref> is a diagram showing a network of FIA Controllers and FIAs.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 13</figref> is a diagram showing a FIA Controller controlling a number of FIAs.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 14</figref> is a diagram of a Converged Network Adapter.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 15</figref> is a diagram showing the FIA Switch Client in more detail.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 16</figref> is a diagram showing the FIA Controller in more detail.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 17</figref> is a diagram showing a policy applied to two FCoE devices.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 18</figref> is a diagram showing the Discovery Domain model.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 19</figref> is a diagram showing the FIA connection model.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 20</figref> is a diagram showing the interconnection of two ENodes through a network of FIAs.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 21</figref> is a diagram showing the interconnection of two Fibre Channel devices through a network of FIAs.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 22</figref> is a ladder or sequence diagram showing a FIA Controller setting Frame Matching Entries (FMEs) in a FIA.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 23</figref> is a ladder or sequence diagram of the FIP Discovery frame exchange protocol between a FIA Controller and a FIA.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 24</figref> is a ladder or sequence diagram showing a FIP FLOGI Request, FIP FLOGI LS_ACC frame exchange.</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 25</figref> is a ladder or sequence diagram showing the exchange of a FIP NPIV FDISC/FIP LS_ACC message exchange between an ENode and a FIA Controller.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 26</figref> is a ladder or sequence diagram showing the exchange of a FCoE State Change Registration request and LS_ACC response message exchange in addition to a Name Server query request and response message exchange.</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 27</figref> is a ladder or sequence diagram showing a PLOGI exchange between ENodes.</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 28</figref> is a ladder or sequence diagram showing an ENode and a VN_Port transmitting a FIP Keep Alive frames.</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 29</figref> is a sequence or ladder diagram showing the initialization of a FIA utilizing an iSNS Server for State Change Notification, Discovery Domain, and Name Services.</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 30</figref> is a ladder or sequence diagram showing the interaction between an ENode, a FIA Controller, an iSNS Server, and a remote ENode upon the exchange of FLOGI/LS_ACC FCoE frames.</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 31</figref> is a ladder or sequence diagram showing the initialization and discovery between two ENodes using the FIA Controller and iSNS Server.</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 32</figref> is a ladder or sequence diagram showing the interconnection of two native Fibre Channel devices through FIAs with ports adapted to connect to Fibre Channel devices.</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 33</figref> is a ladder or sequence diagram showing the communication between a ENode and a Fibre Channel Device through FIAs.</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 34</figref> is a diagram showing multiple virtual connections between ENodes, FIA, and FCFs.</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 35</figref> is a ladder or sequence diagram showing the FIP Discovery protocol exchange between an ENode, a FIA Controller, and a FCF.</p>
<p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. 36</figref> is a diagram showing an ENode determining the path to a remote device.</p>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 37</figref> is a diagram showing the generation of FMEs upon the receipt of a FIP FLOGI or FIP NPIV FDISC frame.</p>
<p id="p-0053" num="0052"><figref idref="DRAWINGS">FIG. 38</figref> is a diagram showing the removal of FMEs upon the receipt of a FIP FLOGO frame.</p>
<p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. 39</figref> is a prior art network diagram showing the interconnection of Router Bridges (RBridges).</p>
<p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. 40</figref> is a diagram showing the prior art frame format for an Ethernet and PPP encapsulated Transparent Interconnection of Lots of Links (TRILL) frame.</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. 41</figref> shows a representative prior art RBridge Port Model in more detail.</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 42</figref> is a diagram of a TRILL RBridge with the addition of FIA Process and FIA Switch Client capability.</p>
<p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. 43</figref> is a diagram showing the interconnection of ENodes over a TRILL Ethernet network.</p>
<p id="p-0059" num="0058"><figref idref="DRAWINGS">FIG. 11</figref> is a diagram showing the interconnection of Fibre Channel nodes over a TRILL Ethernet Network.</p>
<p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. 45</figref> is a diagram showing the interconnection of ENodes over a Shortest Path Bridging MAC-in-MAC (SPBM) Network.</p>
<p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. 46</figref> is a diagram showing a source and destination Ethernet MAC address replacement logic.</p>
<p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. 47</figref> is a diagram showing the migration of a Virtual Machine from a server connected to a FIA to another server connected to another FIA.</p>
<p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. 48</figref> is a diagram showing a distributed FIAC deployment.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">ACRONYMS</heading>
<p id="p-0064" num="0000">
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0063">ACE Access Control Entry</li>
        <li id="ul0002-0002" num="0064">ACL Access Control List</li>
        <li id="ul0002-0003" num="0065">ACLE Access Control List Entry</li>
        <li id="ul0002-0004" num="0066">BPDU Bridge PDU</li>
        <li id="ul0002-0005" num="0067">CNA Converged Network Adapter</li>
        <li id="ul0002-0006" num="0068">DA Destination Address</li>
        <li id="ul0002-0007" num="0069">DCB Data Center Bridging</li>
        <li id="ul0002-0008" num="0070">DCBX DCB Exchange protocol</li>
        <li id="ul0002-0009" num="0071">EISS Extended Internal Sublayer Service</li>
        <li id="ul0002-0010" num="0072">ENode FCoE Node</li>
        <li id="ul0002-0011" num="0073">ETS Enhanced Transmission Selection (IEEE 802.1Qaz)</li>
        <li id="ul0002-0012" num="0074">FC-MAP FCoE Mapped Address Prefix</li>
        <li id="ul0002-0013" num="0075">FCF FCoE Forwarder</li>
        <li id="ul0002-0014" num="0076">FIA FCoE device and Fibre Channel node interconnection Apparatus</li>
        <li id="ul0002-0015" num="0077">FCF-MAC FCoE Forwarder Media Access Control</li>
        <li id="ul0002-0016" num="0078">FCID Fibre Channel address or port identifier</li>
        <li id="ul0002-0017" num="0079">FCoE Fibre Channel over Ethernet</li>
        <li id="ul0002-0018" num="0080">FCoE Device Another term for ENode</li>
        <li id="ul0002-0019" num="0081">FCoE_LEP FCoE Link Endpoint</li>
        <li id="ul0002-0020" num="0082">FDF FCoE Data Forwarder</li>
        <li id="ul0002-0021" num="0083">Fibre Channel device Another term for Fibre Channel node</li>
        <li id="ul0002-0022" num="0084">FIP FCoE Initialization Protocol</li>
        <li id="ul0002-0023" num="0085">FME Frame Match Entry</li>
        <li id="ul0002-0024" num="0086">FPMA Fabric Provided MAC Address</li>
        <li id="ul0002-0025" num="0087">IEEE Institute of Electrical and Electronics Engineers</li>
        <li id="ul0002-0026" num="0088">IP Internet Protocol</li>
        <li id="ul0002-0027" num="0089">IS-IS Intermediate System to Intermediate System</li>
        <li id="ul0002-0028" num="0090">ISS Internal Sublayer Service</li>
        <li id="ul0002-0029" num="0091">LAN Local Area Network</li>
        <li id="ul0002-0030" num="0092">MAC Media Access Control</li>
        <li id="ul0002-0031" num="0093">PDU Protocol Data Unit</li>
        <li id="ul0002-0032" num="0094">PRY Physical Layer</li>
        <li id="ul0002-0033" num="0095">PPP Point-to-Point Protocol</li>
        <li id="ul0002-0034" num="0096">PFC Priority-based Flow Control (IEEE 802.1Qbb, 802.3bd)</li>
        <li id="ul0002-0035" num="0097">RBridge Routing Bridge</li>
        <li id="ul0002-0036" num="0098">SA Source Address</li>
        <li id="ul0002-0037" num="0099">SNMP Simple Network Management Protocol</li>
        <li id="ul0002-0038" num="0100">SPBM Shortest Path Bridging MAC-in-MAC</li>
        <li id="ul0002-0039" num="0101">SPBV Shortest Path Bridging VLAN</li>
        <li id="ul0002-0040" num="0102">SPF Shortest Path First</li>
        <li id="ul0002-0041" num="0103">SPMA Server Provided MAC Address</li>
        <li id="ul0002-0042" num="0104">TRILL Transparent Interconnection of Lots of Links</li>
        <li id="ul0002-0043" num="0105">VE_Port Virtual E_Port</li>
        <li id="ul0002-0044" num="0106">VF_Port Virtual F_Port</li>
        <li id="ul0002-0045" num="0107">VID VLAN Identifier</li>
        <li id="ul0002-0046" num="0108">VLAN Virtual Local Area Network</li>
        <li id="ul0002-0047" num="0109">VN_Port Virtual N_Port</li>
        <li id="ul0002-0048" num="0110">VRP VLAN Registration Protocol</li>
        <li id="ul0002-0049" num="0111">vSwitch Virtual Switch</li>
    </ul>
    </li>
</ul>
</p>
<heading id="h-0007" level="1">CONSTANTS</heading>
<p id="p-0065" num="0000">
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0112">FIP_TYPE: 8914h The value specified in the Ethernet TYPE field for a FIP PDU</li>
        <li id="ul0004-0002" num="0113">FCoE_TYPE: 8906h The value specified in the Ethernet TYPE field for an FCoE PDU</li>
        <li id="ul0004-0003" num="0114">All-FCoE-MACs: 01-10-18-01-00-00 The group address for all FCoE devices.</li>
        <li id="ul0004-0004" num="0115">All-ENode-MACs: 01-10-18-01-00-01 The group address for all ENodes</li>
        <li id="ul0004-0005" num="0116">DEFAULT_FC-MAP: 0EFC00h The default value for the FC-MAP field in a FIP FC-MAP descriptor
<br/>
Definitions
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0066" num="0117">Access control lists (ACL): are comprised of Access Control Entries (ACE), allow network managers to define classification actions and rules for specific ports. Frames entering the port, with an active ACL, are either admitted or denied entry.</p>
<p id="p-0067" num="0118">Address or Port identifier: An address value used to identify source (S_ID) or destination (D_ID) of a frame.</p>
<p id="p-0068" num="0119">Converged Network Adapter (CNA): is a technology that supports data networking (TCP/IP) and storage networking (Fibre Channel) traffic on a single I/O adapter. CNAs support both Enhanced Ethernet and Fibre Channel over Ethernet (FCoE).</p>
<p id="p-0069" num="0120">Discovery Domains (DD): are a security and management mechanism used to administer access and connectivity to devices.</p>
<p id="p-0070" num="0121">Discovery Domain Set (DDS): is a container object for Discovery Domains (DDs). DDSs may contain one or more DDs. Similarly, each DD can be a member of one or more DDSs. DDSs are a mechanism to store coordinated sets of DD mappings.</p>
<p id="p-0071" num="0122">Domain Identifier: Bits <b>23</b> through <b>16</b> of an address identifier.</p>
<p id="p-0072" num="0123">E_Port: A Fabric &#x201c;Expansion&#x201d; Port that attaches to another Interconnect_Port to create an Inter-Switch Link. An E_Port is the combination of one PE_Port and one VE_Port operating together</p>
<p id="p-0073" num="0124">Encapsulated FC frame: An SOF/EOF delimited FC frame prefixed with a 28-byte FC frame Encapsulation Header (see RFC 3643).</p>
<p id="p-0074" num="0125">ENode: An FCoE Node, a Fiber Channel node (see FC-FS-3) that is able to transmit FCoE frames using one or more ENode MACs. The term ENode and FCoE device is used interchangeably.</p>
<p id="p-0075" num="0126">ENode MAC: A Lossless Ethernet MAC coupled with an FCoE Controller in an ENode.</p>
<p id="p-0076" num="0127">ENode MAC address: The MAC address used by the FCoE Controller on an ENode MAC for the FCoE Initialization Protocol (FIP).</p>
<p id="p-0077" num="0128">Fabric: As defined in FC-FS-3 an entity that interconnects various Nx_Ports attached to it, and is capable of routing frames using only the D_ID information in an FC-2 frame header.</p>
<p id="p-0078" num="0129">Fabric_Name: the Fabric_Name (see FC-FS-3) identifying the Fabric.</p>
<p id="p-0079" num="0130">Fabric Provided MAC Address (FPMA): A MAC address that is assigned by an FCF to a single ENode MAC, and is not assigned to any other MAC within the same Ethernet VLAN. A Fabric Provided MAC Address is associated with a single VN_Port at that ENode MAC.</p>
<p id="p-0080" num="0131">FC-BB_E: a protocol mapping defined in order to transport Fibre Channel over a Lossless Ethernet network.</p>
<p id="p-0081" num="0132">FCF (FCoE Forwarder): A Fibre Channel Switching Element (see FC-SW-5) that is able to forward FCoE frames across one or more FCF-MACs, and that optionally includes one or more Lossless Ethernet bridging elements and/or a Fibre Channel Fabric interface.</p>
<p id="p-0082" num="0133">FCF-MAC: A Lossless Ethernet MAC coupled with an FCoE Controller in an FCF. In the context of the invention, FCF-MAC also refers to a Lossless Ethernet MAC coupled to a modified FCoE Controller in a FCoE device interconnection apparatus controller (FIAC),</p>
<p id="p-0083" num="0134">FCF-MAC address: The MAC address of an FCF-MAC.</p>
<p id="p-0084" num="0135">FC-MAP (Mapped Address Prefix): In a Fabric Provided MAC Address, the required value for the upper 24 bits of a MAC address assigned to a VN_Port.</p>
<p id="p-0085" num="0136">FCoE Controller: A functional entity, coupled with a Lossless Ethernet MAC, instantiating and de-instantiating VE_Ports, VF_Ports, VN_Ports, and/or FCoE_LEPs.</p>
<p id="p-0086" num="0137">FCoE Device: a term used interchangeable with an ENode</p>
<p id="p-0087" num="0138">FCoE Device Interconnection Apparatus (FIA): an apparatus that interconnects one or more of the following: ENodes, Fibre Channel nodes, FCF, and FDF's. A FIA is capable of substituting source and destination Ethernet addresses and capable of inspecting the Fibre Channel destination address identifier in received FCoE frames. A FIA is also capable of communicating with one or more FIACs. The FCoE Device Interconnection Apparatus (FIA) is a term used interchangeably with ENode and Fibre Channel node interconnection apparatus and FCoE Device and Fibre Channel node interconnection apparatus.</p>
<p id="p-0088" num="0139">FCoE Device Interconnection Apparatus Controller (FIAC): An ENode and Fibre Channel interconnection apparatus controller. The FIAC includes a modified FCoE Controller and a FCF-MAC. The modified FCoE controller is capable of receiving and processing certain FIP and FCoE frames from ENodes and Fibre Channel Nodes and capable of transmitting certain FIP and FCoE frames to ENodes and Fibre Channel Nodes. The FIAC communicates with FIA's and optionally other FIACs.</p>
<p id="p-0089" num="0140">FCoE Entity: The interface, containing one or more FCoE_LEPs, between a VN_Port, a VF_Port, or a VE_Port, and a Lossless Ethernet MAC.</p>
<p id="p-0090" num="0141">FCoE frame: An Ethernet frame (see IEEE 802.3-2008) that contains an FCoE PDU</p>
<p id="p-0091" num="0142">FCoE_LEP (FCoE Link End-Point): The data forwarding component of an FCoE Entity that handles FC frame encapsulation/decapsulation, and transmission/reception of encapsulated frames through a single Virtual Link.</p>
<p id="p-0092" num="0143">FCoE PDU: A PDU identified by the FCoE Ethernet Type that encapsulates a byte-encoded FC frame.</p>
<p id="p-0093" num="0144">FDF (FCoE Data Forwarder): a Fibre Channel Switching Element (see FC-SW-5) that is able to forward FCoE frames across on or more FCF-MACs, and that optionally includes one or more Lossless Ethernet bridging elements. A FDF includes a subset of FCF features, most notably routing and zoning. A FDF is controlled by a FCF.</p>
<p id="p-0094" num="0145">FIP frame: An Ethernet frame (see IEEE 802.3-2008) containing a FCoE initialization Protocol (FIP) PDU.</p>
<p id="p-0095" num="0146">FIP PDU: A PDU identified by the FIP Ethernet Type that encapsulates one or more FIP operations</p>
<p id="p-0096" num="0147">FLOGI: Fabric Login ELS (see FC-LS-2).</p>
<p id="p-0097" num="0148">Frame Match Entry (FME): A FME is send from a FIAC Controller to a FIA. The FME consists of match fields, counters, and actions. The match fields are applied against an incoming frame. The match fields consist of the ingress port and frame headers. The actions include instructions on how to handle the incoming frame and the counters are statistics tables.</p>
<p id="p-0098" num="0149">F_Port: A port by which non-loop N_Ports are attached to a Fabric. Does not include FL_Ports (see FC-SW-5 and FC-FS-3).</p>
<p id="p-0099" num="0150">F_Port_Name: A Name_Identifier that identifies an F_Port Inter-Switch Link (ISL): A Link directly connecting the E_Port of one Switch to the E_Port of another Switch.</p>
<p id="p-0100" num="0151">Lossless Ethernet bridging element: An Ethernet bridging function operating across Lossless Ethernet MACs.</p>
<p id="p-0101" num="0152">Lossless Ethernet MAC: A full duplex Ethernet MAC implementing extensions to avoid Ethernet frame loss due to congestion (e.g., the PAUSE mechanism (see IEEE 802.3-2008) or the Priority-based Flow Control mechanism (see IEEE 802.1Qbb).</p>
<p id="p-0102" num="0153">LS_ACC: Link Service Accept (see FC-LS-2).</p>
<p id="p-0103" num="0154">Lossless Ethernet network: An Ethernet network composed only of full duplex links, Lossless Ethernet MACs, and Lossless Ethernet bridging elements.</p>
<p id="p-0104" num="0155">LS_RJT: Link Service Reject (see FC-LS-2).</p>
<p id="p-0105" num="0156">Name_Identifier: is used to identify entities in Fibre Channel such as a VN_Port, N_Port, node, VF_Port, F_Port, Fabric or other Fibre Channel objects, The Name_Identifier for an entity shall be unique within the Fibre Channel interaction space.</p>
<p id="p-0106" num="0157">Multicast MAC address: A MAC address associated with a group of logically related Ethernet stations on an Ethernet network and called a Multicast-Group Address in IEEE 802.3-2008.</p>
<p id="p-0107" num="0158">PE_Port (Physical E_Port): The LCF within the Fabric that attaches to another PE_Port through a native FC link (see FC-SW-5).</p>
<p id="p-0108" num="0159">PF_Port (Physical F_Port): The LCF within the Fabric that attaches to a PN_Port through a native FC link (see FC-SW-5).</p>
<p id="p-0109" num="0160">PN_Port (Physical N_Port): An LCF that supports only VN_Ports (see FC-FS-3)</p>
<p id="p-0110" num="0161">Name_Identifier: A value with a specified size and format used to identify a Fibre Channel Entity.</p>
<p id="p-0111" num="0162">Node Name: A Name_Identifier associated with a node (see FC-FS-3).</p>
<p id="p-0112" num="0163">N_Port: A device port that generates/terminates FC-4 channel traffic.</p>
<p id="p-0113" num="0164">N_Port_Name: A Name_Identifier that identifies an N_Port.</p>
<p id="p-0114" num="0165">Path selection: Path Selection is the process by which a Switch determines the best path from a source domain to a destination domain. These paths may then be used in any appropriate manner by the Switch to move frames to their destinations. This path selection process does not require nor preclude the use of static or dynamic load-balancing. The standard defines the Fabric Shortest Path First (FSPF) protocol.</p>
<p id="p-0115" num="0166">PLOGI: N_Port Login (see FC-LS-2).</p>
<p id="p-0116" num="0167">Router: a device that performs forwarding of IP (L3) packets, based on L3 addressing and forwarding information. Routers forward packets from one L2 broadcast domain to another (one, or more in the IP multicast case)&#x2014;distinct&#x2014;L2 broadcast domain(s). A router terminates an L2 broadcast domain.</p>
<p id="p-0117" num="0168">Server Provided MAC Address (SPMA): A MAC address that is assigned by an ENode to a single one of its ENode MACs, and is not assigned to any other MAC within the same Ethernet VLAN. A Server Provided MAC Address may be associated with more than one VN_Port at that ENode MAC.</p>
<p id="p-0118" num="0169">Switch_Name: A Name_Identifier that identifies a Switch or a Bridge device. The format of the name is specified in FC-FS-3. Each Switch and Bridge device shall provide a unique Switch_Name within the Fabric.</p>
<p id="p-0119" num="0170">Unicast MAC address: A MAC address associated with a particular Ethernet station on an Ethernet network and called an Individual Address in IEEE 802.3-2008.</p>
<p id="p-0120" num="0171">Virtual Switch: is a software program that allows one virtual machine (VM) to communicate with another virtual machine (VM). A virtual machine can intelligently direct communication on the network by inspecting packets before passing them on.</p>
<p id="p-0121" num="0172">VF_ID: the VF_ID (see FC-FS-3) associated with a Fabric.</p>
<p id="p-0122" num="0173">VF_Port (Virtual F_Port): An instance of the FC-2V sublevel of Fibre Channel that communicates with one or more VN_Ports (see FC-SW-5) and that is dynamically instantiated on successful completion of a FIP FLOGI Exchange.</p>
<p id="p-0123" num="0174">VF_Port/FCoE_LEP pair: A VF_Port and one of its associated FCoE_LEPs.</p>
<p id="p-0124" num="0175">VF_Port/FCoE_LEP pair: A VN_Port and its associated FCoE_LEP.</p>
<p id="p-0125" num="0176">Virtual Link: The logical link connecting two FCoE_LEPs.</p>
<p id="p-0126" num="0177">VN_Port (Virtual N_Port): An instance of the FC-2V sublevel of Fibre Channel that operates as an N_Port (see FC-FS-3) and is dynamically instantiated on successful completion of a FIP FLOGI or FIP NPIV FDISC Exchange.</p>
<p id="p-0127" num="0178">VN_Port MAC address: The MAC address used by an ENode for a particular VN_Port.</p>
<p id="p-0128" num="0179">Zone: A group of Zone Members. Members of a Zone are made aware of each other, but not made aware of Zone Members outside the Zone.</p>
<p id="p-0129" num="0180">Zone Definition: The parameters that define a Zone.</p>
<p id="p-0130" num="0181">Zone Member: The specification of a device to be included in a Zone.</p>
<heading id="h-0008" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0131" num="0182"><figref idref="DRAWINGS">FIGS. 1 through 7</figref> and <b>39</b> through <b>41</b> describe prior art designs, the understanding of which are useful to understand the inventions disclosed and claimed herein. The FC-BB_E model defines the structured operation by which Fibre Channel frames are transported over a Lossless Ethernet network. FC-BB_E protocol mapping is referred to as Fibre Channel over Ethernet (FCoE). <figref idref="DRAWINGS">FIG. 1</figref> illustrates the FC-BB_E mapping <b>8</b> of Fibre Channel levels and sublevels over IEEE 802.3 layers <b>9</b>. Fibre Channel FC-2 1 sublevels, FC-2M 3 and FC-2P 4, are mapped into the FCoE Entity <b>6</b> which is defined by the FC_BB_E mapping <b>8</b>. Higher Fibre Channel levels <b>7</b> remain unchanged. <figref idref="DRAWINGS">FIG. 2</figref> shows FC-BB_E definition of end devices, an ENode <b>17</b> and a FCoE Forwarder (FCF) <b>10</b>. ENodes <b>17</b> are Fibre Channel nodes (see FC-FS-3) that are able to transport Fibre Channel over Lossless Ethernet <b>19</b>. FCFs <b>10</b> are Fibre Channel. Switching Elements (see FC-SW-5) that are able to transport Fibre Channel over Lossless Ethernet <b>13</b>.</p>
<p id="p-0132" num="0183"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram showing the FCoE frame format. FCoE is encapsulated over Ethernet with the use of a dedicated Ethertype 0x8906 referred in <figref idref="DRAWINGS">FIG. 3</figref> as FCoE_TYPE <b>28</b>. The Ethernet header includes a source <b>26</b> and destination <b>25</b> MAC address (6 bytes each) and an optional IEEE 802.1Q Virtual LAN (VLAN) tag <b>27</b>. A single 4-bit field (version <b>29</b>) satisfies the IEEE sub-type requirements. The SOF (start of frame) <b>34</b> and EOF (end of frame) <b>36</b> are encoded as specified in RFC 3643. Reserved bits <b>30</b> <b>31</b> <b>32</b> <b>33</b> <b>37</b> are present to guarantee that the FCoE frame meets the minimum length requirement of Ethernet. Inside the encapsulated Fibre Channel frame <b>35</b>, the frame header is retained so as to allow connecting to a storage network by passing on the Fibre Channel frame directly after de-encapsulation. An Ethernet trailer <b>38</b> consists of a Frame Check Sequence (FCS). This is where the Cyclic Redundancy Check (CRC) value is held that will be used to confirm that the frame has not been corrupted when it reaches its destination.</p>
<p id="p-0133" num="0184">The FCoE Initialization Protocol (FIP) is used to perform the functions of FC-BB_E device discovery, initialization, and maintenance. A new Ethernet TYPE frame is specified, different from the FCoE Ethernet TYPE to enable the distinction of discovery, initialization, and maintenance traffic from other FCoE traffic. <figref idref="DRAWINGS">FIG. 4</figref> illustrates the FIP frame PDU format <b>50</b> <b>51</b> <b>52</b>, which consists of the FIP_TYPE <b>53</b> Ethernet TYPE, Version <b>54</b>, and the rest of the encapsulated frame <b>56</b>. <figref idref="DRAWINGS">FIG. 5</figref> is a diagram illustrating the ENode and FCF connection model. The model illustrates FCoE VN_Port to VF_Port <b>88</b> <b>89</b>, VE_Port to VE_Port <b>97</b>, VE_Port <b>94</b> to E_Port <b>102</b>, and FCF F_Port <b>101</b> to N_Port <b>108</b> virtual links. Physical links numbered <b>84</b> <b>87</b> <b>91</b> and <b>92</b> are Ethernet links, physical links numbered <b>103</b> and <b>107</b> are Fibre Channel links. The VE_Port to VE_Port virtual connection <b>97</b> is an instance of the FC-2V sublevel, see <figref idref="DRAWINGS">FIG. 6</figref> <b>118</b> of Fibre Channel that operates as an E_Port in accordance with FC-SW-5 (T<b>11</b> Fibre Channel Switch) and is dynamically instantiated together with its FCoE_LEP, see <figref idref="DRAWINGS">FIG. 6</figref> <b>119</b> on successful completion of a FIP ELP Exchange. Inter-Switch Links (ISLs) <b>97</b> are used by FCFs to transmit and receive frames with other FCFs or switches or Bridge devices. An ISL always connects exactly one E_Port or VE_Port on a Switch to exactly one E_port or VE_Port on another Switch or exactly one B_Port on a Bridge device. ENode H<b>1</b> <b>81</b> and ENode H<b>2</b> <b>85</b> have a single physical Ethernet connection <b>84</b> <b>87</b> to the Lossless Ethernet network <b>90</b>, while Fibre Channel Device <b>1</b> <b>105</b> has a single physical Fibre Channel connection <b>107</b> to the FCF F_Port <b>101</b> in FCF B <b>98</b>. FCF A <b>93</b> and FCF B <b>98</b> also have single physical Ethernet connections <b>91</b> <b>92</b> to the Lossless Ethernet network <b>90</b>. Each ENode <b>81</b> <b>85</b> may instantiate multiple VN_Ports <b>80</b> <b>82</b> <b>83</b>. As illustrated, the FCF inherits much of the functions and complexity of a Fibre Channel switch (i.e., from FC-SW and FC-GS). FCF A <b>93</b> VE_Port <b>96</b> to FCF B <b>98</b> VE_Port <b>99</b> Interswitch Link (ISL) <b>97</b> and FCF E_Port <b>94</b> to Switch Fabric <b>104</b> E_Port <b>109</b> Interswitch link (ISL) <b>109</b> are still preserved. VE_Port operation specifies the tools and methods for interconnection and initialization of FCFs <b>93</b> <b>98</b> to create a multi-Switch Fabric. FCF VE_Port operation defines how ports discover and self-configure for their appropriate operating mode. Once a port establishes connection to another FCF and/or Fibre Channel Switch and is operating as a VE_Port <b>94</b> <b>96</b> <b>99</b>, an address assignment algorithm is executed to allocate port addresses throughout the Fabric and the FSPF Fibre Channel based routing algorithm is executed.</p>
<p id="p-0134" num="0185"><figref idref="DRAWINGS">FIG. 6</figref> is a diagram of a FCF functional model. The bracketed function components <b>134</b> <b>137</b>, the Lossless Ethernet Bridging Element <b>125</b>, and the FC Fabric interface <b>110</b> are optional. An FCF <b>136</b> is functionally composed of a Fibre Channel (FC) Switching Element <b>115</b> (see FC-SW-5) with at least one Lossless Ethernet MAC <b>123</b> (FCF-MAC address). The FC Switching Element <b>115</b> is composed of the following: Path Selector, Router, Switch Construct, Address Manager, and the Fabric Controller. The Router is a logical entity that performs the routing of Class F, Class 2, and Class 3 frames to their final destination. The Path Selector is a logical entity that establishes frame routing paths. Path Selection is the process by which a Switch determines the best path from a source domain to a destination domain using all or part of Fibre Channel address identifiers. The FC-SW-5 standard defines the Fabric Shortest Path First (FSPF) protocol for Path Selection. Each FCF-MAC <b>123</b> is coupled with an FCoE Controller <b>122</b> function. Each FCF-MAC may be optionally coupled with a Fibre Channel Fabric interface <b>110</b>, providing native E_Port <b>111</b> <b>112</b> or F_Port <b>113</b> <b>114</b> connectivity. An FCF <b>136</b> forwards FCoE frames addressed to one of its FCF-MACs based on the D_ID of the encapsulated FC frames. When an FCF includes Lossless Ethernet bridging elements <b>125</b>, an FCF-MAC address may be used by multiple Ethernet ports <b>126</b> <b>128</b> of the FCF. The FCoE Controller <b>122</b> associated with an FCF-MAC shall support the instantiation of VE_Port/FCoE_LEP pairs <b>117</b> <b>119</b> or VF_Port/FCoE_LEP pairs <b>129</b> <b>131</b>. An FCF-MAC supporting the instantiation of VF_Port/FCoE_LEP pairs is referred to as a VF_Port <b>129</b> capable FCF-MAC. A VE_Port <b>117</b> receives FC frames from the FC Switching Element <b>115</b> and sends them to its FCoE_LEP <b>119</b> for encapsulation and transmission over the Lossless Ethernet network. In a similar way, a VE_Port <b>117</b> sends FC frames received from its FCoE_LEP <b>119</b> to the FC Switching element <b>115</b>. A VE_Port <b>117</b> is uniquely identified by an E_Port_Name Name_Identifier and is addressed by the Fabric Controller address identifier (i.e., FFFFFDh). The VE_Port <b>117</b> behavior is specified in FC-SW-5, with the exception that a VE_Port is instantiated on successful completion of a FIP ELP Exchange, ignoring the buffer-to-buffer flow control parameters, rather than on completion of a native ELP Exchange. Similarly, a VF_Port <b>129</b> is an instance of the FC-2V <b>130</b> sublevel of Fibre Channel that operates as an F_Port in accordance with PC-SW-5 and is dynamically instantiated together with its FCoE_LEP <b>131</b> on successful completion of a FIP FLOGI Exchange. A VF_Port <b>129</b> receives FC frames from the FC Switching Element <b>115</b> and sends them to the proper FCoE_LEP <b>131</b> for encapsulation and transmission over the Lossless Ethernet network. In a similar way, a VF_Port sends FC frames received from one of its FCoE_LEPs <b>131</b> to the Fibre Channel Switching element <b>115</b>. A VF_Port <b>129</b> is uniquely identified by an F_Port_Name Name_Identifier and is addressed by the F_Port Controller address identifier (i.e., FFFFFEh). The VF_Port behavior is be specified in FC-LS-2 and FC-LS-3, with the exception that a VF_Port is instantiated on successful completion of a FIP FLOGI Exchange, ignoring the buffer-to-buffer flow control parameters, rather than on completion of a native FLOGI Exchange.</p>
<p id="p-0135" num="0186">The FC/FCoE Data Forwarder (FDF) is in the process of being defined by the T11 standards committee. The FDF is fully controlled by a controlling FCF and operates according to the information that FCFs sends to FDFs. The controlling FCF assigns addresses, computes the routes, and distributes addresses and routes to its FDFs. A FDF does not need to compute routes. FDFs instantiate VF_Ports and VA_Ports, VA_Ports being the FCF to FDF or FDF to FCF links. FDFs have a similar architecture to FCFs, VF Ports and VE_Ports interconnected by a Fibre Channel switching element <b>115</b>.</p>
<p id="p-0136" num="0187"><figref idref="DRAWINGS">FIG. 7</figref> is a diagram of an ENode functional model <b>200</b>. An ENode is functionally composed of at least one Lossless Ethernet MAC <b>215</b> (i.e., the ENode MAC), and an FCoE Controller function for each Enode MAC <b>214</b>. The FCoE Controller <b>214</b> associated with an ENode MAC <b>215</b> supports the instantiation of VN_Port/FCoE_LEP pairs <b>204</b> <b>206</b> <b>210</b> <b>212</b>. The FCoE Controller <b>214</b> is the functional entity that performs the FCoE Initialization Protocol (FIP) and instantiates or de-instantiates VN_Port/FCoE_LEP <b>204</b> <b>206</b> <b>210</b> <b>212</b> pairs as needed. The FCoE_LEP <b>206</b> <b>212</b> is the functional entity performing the encapsulation of FC frames into FCoE frames in transmission and the decapsulation of FCoE frames into FC frames in reception. When encapsulating FC frames into FCoE frames, the MAC address of the local link end-point is used as source address and the MAC address of the remote link end-point is used as destination address of the generated FCoE frame. For an FCoE_LEP <b>206</b> <b>212</b> of an ENode MAC, the MAC address of the local link end-point is the MAC address associated with its VN_Port and the remote link end-point address is the FCF-MAC address associated with the remote VF_Port. A VN_Port receives FC frames from the upper FC levels and sends them to its FCoE_LEP <b>206</b> <b>212</b> for encapsulation and transmission over the Lossless Ethernet network. In a similar way, a VN_Port sends FC frames received from its FCoE_LEP to the upper FC levels. A VN_Port is uniquely identified by an N_Port_Name Name_Identifier and is addressed by the address identifier the Fabric assigned to it.</p>
<p id="p-0137" num="0188"><figref idref="DRAWINGS">FIG. 8</figref> is a diagram of a FCoE Device and Fibre Channel Node Interconnection Apparatus (FIA) and Controller (FIAC) Functional Model. The model shows a FIAC <b>251</b> comprising a modified FCoE Controller <b>253</b> coupled to a Lossless Ethernet MAC <b>254</b> which contains at least one Ethernet Port <b>255</b> coupled to an Ethernet link <b>257</b>. The FIAC Ethernet_Port <b>255</b> contains a FCF-MAC. Other FIAC Modules <b>252</b> are represented by a single box. The other FIAC Modules <b>252</b> are described in <figref idref="DRAWINGS">FIG. 16</figref>. The Other FIAC Modules <b>252</b> may be coupled to the Lossless Ethernet MAC <b>254</b> and the modified FCoE Controller <b>253</b>. There can be one or more FCoE device and Fibre Channel Node Interconnection Apparatus (FIA) <b>264</b> in a network all under the control of a single FIAC <b>251</b>. The FIA <b>264</b> includes a plurality of Port logic <b>266</b> <b>267</b> <b>268</b> <b>269</b> coupled to a Frame Forwarding Switch <b>265</b> and a Frame Processing Apparatus <b>285</b>. The Frame Forwarding Switch is capable of forwarding frames between ports <b>266</b> <b>267</b> <b>268</b> <b>269</b> by using several methods comprising one or more of the following: STP, RSTP, MSTP, TRILL, Shortest Path Bridging, MPLS, VPLS, OSPF, RIP, and BGP. The Frame Processing Apparatus <b>285</b> includes but is not limited to one more <b>278</b> Frame Match entries (FME) <b>270</b> <b>271</b>, one or more <b>298</b> access control list entries (ACLE) <b>290</b> <b>291</b>, and one or more <b>287</b> Policy entries <b>284</b> <b>286</b>. Both FMEs and optionally ACLEs are sent from the FIAC <b>251</b> to the FIA <b>264</b> upon instantiation and de-instantiation of VN_Ports and N_Ports. Policy entries <b>284</b> are sent to the FIAs <b>264</b> by the FIAC <b>251</b> at any time as they are typically configured asynchronously with VN_Port and N_Port instantiation. Policy entries configure the flow metering capability in the Frame Processing Apparatus <b>285</b> to assign different flow quality of services to a specified VN_Port pair, N_Port pair, or VN_Port to N_Port pair. Each ACLE <b>290</b> <b>291</b> preferably includes an ingress port, source and destination Ethernet MAC address fields, a Ethernet TYPE field, a action which permits the frame to be forwarded or deny, which discards the frame, and optionally a Fibre Channel address identifier field. When multiple ACLEs <b>290</b> <b>291</b> describe the same incoming frame, the Frame Processing Apparatus <b>285</b> matches the first ACLE in it's Access Control List. Each FME <b>270</b> <b>271</b> preferably includes an ingress port, a priority, frame match fields, counters, and actions. If two FMEs match an incoming frame, the highest priority FMEs actions are executed. The frame match fields are applied to incoming frames and comprise the ingress port, frame headers, and select encapsulated frame fields such as the Fibre Channel Destination Address Identifier (DID) field. The frame match fields can match exactly or utilize wild cards to mask certain subfields of the incoming frame. FME counters are updated for matched frames. FME counters may comprise the following: transmitted and received frames and bytes, transmitted and receive errors, and frame type transmitted and received. FME actions are instructions to perform upon frame matches comprising but not be limited to: forward the frame, flood the frame, replace certain frame fields or subfields, add certain frame fields, subfields, or headers such as the MAC header (MAC-in-MAC), a VLAN header (QinQ), and tag frames, the tags comprising a MPLS header and a VPLS header. The Ethernet_Ports contained in the Port Logic are connected to Ethernet Links <b>275</b> <b>276</b>. The FCF-MACs <b>272</b> contained in the FIA Port logic <b>266</b> <b>267</b> <b>268</b> <b>269</b> in addition to the FCF-MACs contained in other FIAs and FIACs <b>256</b> may contain the same FCF-MAC address value. The FIA Port Logic <b>262</b> may be adapted to connect to a Fibre Channel node or fabric <b>263</b>. A Fibre Channel adapted FIA Port Logic <b>262</b> includes Fibre Channel FC0 and FC1 layer support <b>261</b>, a FCoE_LEP <b>2</b>.<b>59</b>, a connection to the frame forwarding switch <b>2</b>.<b>58</b>, and a connection to the Frame Processing Apparatus <b>285</b>. The FCoE_LEP <b>259</b> encapsulates Fibre Channel frames received from the Fibre Channel link <b>263</b> and decapsulates FCoE and FIP frames received from the Frame Forwarding switch <b>258</b>. Received FLOGI, NPIV FDISC, and LOGO frames are encapsulated <b>259</b> into FTP frames by the FIA with the destination Ethernet MAC address equal to the FCF_MAC address of the FIAC. A MAC address, a FME, and optionally a ACLE are assigned to each N_Port by the FIAC to identify that N_Port within the Lossless Ethernet network. The FIAC <b>251</b> receives and processes the FIP FLOGI, FIP NPIV FDISC, and FIP LOGO frames encapsulated by a FIA Fibre Channel adapted port <b>262</b> and responds with FTP responses. The FIP responses are decapsulated <b>259</b> by the FIA Fibre Channel adapted port <b>262</b> into Fibre Channel frames and transmitted out the link <b>263</b>. The modified FCoE Controller <b>253</b> in a FIAC <b>251</b> sends commands to all FIAs, the commands comprising add, delete, or modify FMEs, get and clear counters, and add, delete, or modify ACLEs. The modified FCoE Controller <b>253</b> contained in the FIAC <b>251</b> preferably includes, but is not limited to, the following capabilities: (1) participates in the FIP VLAN discovery protocol initiated by an ENode MAC, (2) participates in the FIP discovery protocol initiated by an ENode MAC, (3) sends add FME commands and add ACLE commands to FIAs upon successful completion of each FTP FLOGI Exchange initiated by an ENode MAC, (4) sends add FME commands and add ACLE commands to on successful completion of each FLOGI initiated by a Fibre Channel Node, (5) sends add FME commands and add ACLE commands to FIAs on successful completion of each FIP NPIV FDISC Exchange initiated by an already logged in ENode MAC, (6) sends add FME commands and add ACLE commands on successful completion of each NPIV FDISC Exchange initiated by an already logged in Fibre Channel Node, (7) when a VN_Port is logged out, sends a delete FME command, the FME associated with that VN_Port and a delete ACLE command, the ACLE associated with that VN_Port, (8) when a N_Port is logged out, sends a delete FME command, the FME associated with that VN_Port and sends a delete ACLE command, the ACLE associated with that VN_Port, (9) initiates FIP Clear Virtual Link request as needed to terminate Virtual Links to VN_Ports, (10) monitors that status of the instantiated VN_Ports and N_Ports, (11) transmits periodic FIP Discovery Advertisements to the All-ENode-MACs address every FKA_ADV_PERIOD, (12) monitors that status of the logged in ENode MACs by verifying that periodic FIP Keep Alive frames are received within FKA_ADV_PERIOD, unless the D bit is set to one in received Discovery Advertisements, and (13) monitors that status of the logged in VN_Ports by maintaining timers and verifying that periodic FIP Keep Alive frames are received within FKA_VN_PERIOD, unless the D bit is set to one in received Discovery Advertisements. In addition to FMEs for VN_Ports and N_Ports, the FIAC sends add FME commands to all FIAs comprising the following: to match FIP frames with the destination Ethernet MAC address of All-ENode-MACs, All-FCF-MACs, and FCF-MAC of the FIAC, to match FIP frames with a source Ethernet MAC address of the FCF-MAC of the FIAC, to match FCoE frames with a source Ethernet MAC address of the FCF-MAC of the FIAC, and to match FCoE frames with a destination Ethernet MAC address of the FCF-MAC of the FIAC. In addition to ACLEs for VN_Ports and N_Ports, the FIAC may send add ACLE commands to all FIAs comprising the following: to match and permit FIP frames with the destination Ethernet MAC address of All-ENode-MACs, All-FCF-MACs, and FCF-MAC of the FIAC, to match and permit FIP frames with a source Ethernet MAC address of the FCF-MAC of the FIAC, to and permit FCoE frames with a source Ethernet MAC address of the FCF-MAC of the FIAC, and to match and permit FCoE frames with a destination Ethernet MAC address of the FCF-MAC of the FIAC, Frames with the well known Fabric services addresses in the Fibre Channel destination address identifier are forwarded to the FIAC <b>251</b> for processing. FMEs <b>270</b> <b>271</b> may replace source and destination Ethernet MAC addresses in received FCoE frames when identifying and matching the embedded Fibre Channel destination address identifier (DID).</p>
<p id="p-0138" num="0189">As will be appreciated by those skilled in the art, the functionality and structures of the inventions may be functionally and physically as described herein, or may be arranged and organized into multiple components or sub-components, and may be grouped differently into a more consolidated or more distributed grouping or groupings. For example, the processes may be implemented in software, firmware or hardware, or any combination thereof. By way of further example, the functionality or structure may be implemented in software and reside in a physical server, in a virtual machine in a virtual server, in a communication switch, or in a storage array. Each component may comprise one or more physical components. The components may be located at a single geographic location or may be distributed geographically. The flexibility in the nature of the invention applies to all of the inventions described and claimed, herein.</p>
<p id="p-0139" num="0190"><figref idref="DRAWINGS">FIG. 9</figref> is a diagram of a FIA <b>300</b>. The FIA may include but is not limited to one or more <b>315</b> Receive (Rx) Port Logic <b>314</b> <b>316</b>, one or more <b>319</b> Transmit (Tx) Port Logic <b>318</b> <b>320</b>, a Switch Apparatus <b>317</b>, a Frame Processing Apparatus <b>306</b>, Core Logic <b>304</b>, an Embedded Processor <b>301</b>, Memory <b>302</b>, and several Peripherals <b>303</b> <b>305</b>. The Transmit and Receive Port Logic <b>314</b> <b>316</b> <b>318</b> <b>320</b> may include but is not limited to the following frames, mappers, and or MACs: Ethernet, Lossless Ethernet, Fibre Channel, SONET/SDH, ATM, and Wave Division Multiplexing. The Switch Apparatus allows frames to be transferred between the Rx Port Logic <b>314</b> <b>316</b> and the Tx Port Logic <b>318</b> <b>320</b>. The Frame Processing Apparatus <b>306</b> may inspect and operate on frame headers and body, and may forward frames to the Core Logic <b>304</b>. Frames forwarded to the Core Logic <b>304</b> may be stored in the memory <b>302</b> and may be operated on by the Embedded Processor <b>301</b>. The Ingress <b>307</b> apparatus may contain frame matching rules and actions that are applied to received frames. The frame matching rules may match fields from the incoming frames comprising but not be limited to: the source and destination Ethernet MAC addresses, the VLAN identifier, the VLAN priority, the IP source address, the IP destination address, the IP protocol, the TCP/UDP source and destination ports, the Fibre Channel source and destination address identifier, the Fibre Channel OXID/RXID, R_CTL, and TYPE fields. The frame actions may include replacing or substituting the source Ethernet MAC address, replacing or substituting the destination Ethernet MAC address, adding or removing a MAC header (MAC-in-MAC), adding or removing a VLAN field (QinQ), and adding or removing a TRILL header. An example Ethernet MAC address replacement apparatus is illustrated in <figref idref="DRAWINGS">FIG. 46</figref>. The frame matching rules may be configured by a FIAC. The Frame Filtering <b>308</b> apparatus may forward frames based on but not limited to the following frame fields: VLAN identifier, VLAN priority, destination Ethernet MAC address, and source Ethernet MAC address. The Frame Filtering <b>308</b> apparatus may implement a number of frame forwarding methods including but not limited to Rapid Spanning Tree Protocol (RSTP), Spanning Tree Protocol (STP), Multiple Spanning Tree Protocol (MSTP), Per-VLAN Spanning Tree (PVST), Rapid Per-VLAN Spanning Tree (R-PVST), Shortest Path Bridging (SPB), TRILL, Open Short Path First (OSPF), and Border Gateway Protocol (BGP). The Ingress <b>307</b> apparatus may act in parallel and independent from the Frame Filtering <b>308</b> apparatus. For example, an incoming frame is modified by the Ingress <b>307</b> apparatus and &#x201c;forwarded&#x201d; to the Frame Filtering <b>308</b> apparatus which applies a forwarding method based on the modified frame. The example illustrates the independent actions of the frame modification with frame forwarding. The Flow Metering <b>310</b> apparatus may apply flow classification and metering to frames received. Flow classification identifies a subset of traffic (frames) that may be subject to the same treatment in terms of metering and forwarding. Flow classification rules may be based on but not limited to the destination MAC address, the VID, and the frame class (see Priority Flow Control IEEE 802.1Qbb). The Queuing Frame <b>311</b> apparatus manages the transmission of frames and may implement Priority Flow Control (PFC), Enhanced Transmission Selection (ETS), and other priority frame transmission methods. Together the modules <b>307</b> <b>308</b> <b>309</b> <b>310</b> <b>311</b> comprising the Frame Processing Apparatus <b>306</b> allow fine-grained control of frame forwarding, which can support QoS, tunneling, and filter rules. Further, the Embedded Processor <b>301</b> is capable configuring the Frame Processing Apparatus <b>306</b>, setting the fine-grain frame matching and field replacement modification actions. The Embedded Processor is also adapted to communicate with a FIAC to receive commands comprising but not limited to add, delete, modify FME and ACLEs, get and clear counters, heartbeat, and configure flow metering. The FME and ACLEs may be implemented in the Ingress apparatus <b>307</b>. Some of the FME actions may also be implemented in the Frame Filtering apparatus <b>308</b>, such as tunneling and tagging actions associated with forwarding methods such as Shortest Path Bridging (SPB). Many variations can be applied to <figref idref="DRAWINGS">FIG. 9</figref> without changing the functions including distributing the Frame Processing Apparatus <b>306</b> over several ports and or physical chassis, adding additional Embedded processors <b>301</b> and core logic <b>304</b>, and adding more functions to the Frame Processing Apparatus <b>306</b>.</p>
<p id="p-0140" num="0191"><figref idref="DRAWINGS">FIG. 10</figref> is a detailed diagram of a bridge adapted to implement a FIA. Each port <b>420</b> <b>421</b> coupled to an ENode may contain a FIA Process <b>444</b> <b>407</b>. The FIA Process <b>444</b> <b>407</b> delivers and accepts frames to and from the Bridge Port Transmit and Receive Process <b>415</b> <b>408</b>, MAC Relay Entity or Forwarding Process <b>402</b> and LLC Entities <b>442</b> <b>413</b> that may include but are not limited to Higher Layer Entities such as the FIA Switch Client <b>416</b>, Rapid Spanning Tree Protocol Entity <b>415</b> (and/or other layer <b>2</b> forwarding methods), Bridge Management Entity, Generic Attribute Registration Protocol (GARP) Entity. The Rapid Spanning Tree Protocol Higher Layer Entity <b>415</b> is connected to all port LLCs <b>112</b> <b>413</b> including connection to the Port State <b>400</b> <b>405</b>, the Filtering Database <b>403</b>, and the FIA <b>444</b> <b>407</b> processes. The FIA Switch Client <b>416</b> is also connected to each Port LLC <b>442</b> <b>413</b> and can exchange information and frames with the FIA Process <b>114</b> <b>407</b>. The FIA Switch Client <b>416</b> manages communications from the FIA to a FIA Controller. The Filtering Database <b>403</b> supports the addition, modification, and deletion of static filtering information by the FIA Switch Client <b>416</b>. Although the adapted bridge in <figref idref="DRAWINGS">FIG. 10</figref> is shown with only two ports <b>420</b> <b>421</b>, a plurality of ports can be defined.</p>
<p id="p-0141" num="0192"><figref idref="DRAWINGS">FIG. 11</figref> is a detailed diagram of an FIA adapted to connect to Fibre Channel links and Fibre Channel devices. The apparatus of <figref idref="DRAWINGS">FIG. 11</figref> is adapted <b>453</b> <b>465</b> <b>454</b> <b>455</b> <b>467</b> <b>468</b> to communicate with Fibre Channel links <b>456</b> <b>469</b>. The FIA Process <b>453</b> <b>465</b> is also modified to couple with the Fibre Channel Links <b>456</b> <b>469</b>. The FIA FC Process <b>453</b> <b>465</b> receives and transmits frames from and to the FC <b>1</b> blocks <b>454</b> <b>467</b>, MAC Relay or Forwarding Process <b>459</b> and LLC Entities <b>452</b> <b>464</b> that may support Higher Layer Entities which may include but not be limited to: an FIA Switch Client <b>471</b>, a Rapid Spanning Tree Protocol Entity <b>451</b>, a Bridge Management Entity, a Generic Attribute Registration Protocol (GARP) Entity. The Rapid Spanning Tree Protocol Higher Layer Entity <b>451</b> is connected to all port. LLCs <b>452</b> <b>464</b> which may include but not be limited to connection to the Port State <b>457</b> <b>463</b> and Filtering Database <b>461</b> processes. The FIA Switch Client <b>471</b> is also connected to each Port LLC <b>452</b> <b>464</b> and can exchange information and frames with the FIA FC Process <b>453</b> <b>465</b>.</p>
<p id="p-0142" num="0193"><figref idref="DRAWINGS">FIG. 12</figref> is a diagram showing a network of FIA Controllers and FIAs. The diagram shows a primary FIA Controller <b>500</b> and a backup FIA Controller <b>501</b>. The FIA Controllers access FIA <b>1</b> <b>503</b> and FIA <b>2</b> <b>504</b> over a communications network <b>502</b>, which may comprise but not be limited to an Ethernet network, a SONET network, a TRILL network, a Shortest Path Bridging network. The FIA Controller <b>500</b> <b>501</b> can be located anywhere in the network and be coupled to the network over multiple paths. The FIA includes a FIA Switch Client <b>505</b> <b>507</b> and Switching Hardware <b>506</b> <b>508</b>, The FIA Controller <b>509</b> sends and receives commands to the FIA Switch Client <b>511</b>. The FIA Controller <b>509</b> commands may be send using but not limited to the following protocols: SNMP, Command Line Protocol (CLP), OpenFlow, and proprietary protocols <b>510</b>. The FIA Controller <b>500</b> and FIA Controller Backup <b>501</b> may utilize a virtual FCF-MAC address. The virtual FCF-MAC address would be assigned to the FIA Controller <b>500</b> until the FIA Controller <b>500</b> fails, The FIA Controller Backup <b>501</b> would then claim the FCF-MAC address, receive frames destined to the FCF-MAC address, and transmit frames using the FCF-MAC address as the source Ethernet MAC address. FIA Controller failure may be detected by the exchange of a heartbeat message between the FIA Controllers. If the heartbeat message is not received within predetermined parameters such as time and retries, then the FIA Controller backup would assume communications using the virtual FCF-MAC address. Further, the FIA Controller and the FIA Controller backup may synchronize it's data structures, i.e., list of instantiated VN_Ports and N_Ports comprising their WWN's. MAC addresses, and Fibre Channel address identifiers.</p>
<p id="p-0143" num="0194"><figref idref="DRAWINGS">FIG. 13</figref> is a diagram showing a FIA Controller <b>567</b> controlling <b>565</b> <b>566</b> <b>569</b> a number of FIAs <b>555</b> <b>558</b> <b>570</b>. FIA capabilities can be embedded in Hypervisor virtual switches <b>555</b> to control the virtual software switch <b>575</b> embedded in the virtual switch. FIA capabilities can be embedded in Converged Network Adapters <b>558</b>, controlling the embedded switch <b>560</b> which switches frames between PCIe bus queues <b>557</b>, between the PCIe bus queues <b>557</b> and the Ethernet links <b>561</b> <b>562</b>, and between the Ethernet links <b>561</b> <b>562</b>. FIA capabilities in a CNA <b>558</b> control <b>580</b> the embedded switch by adding, modifying, and removing switch entries upon commands from the FIA Controller <b>567</b>. FIA capabilities can also be embedded in Ethernet Switches or Bridges <b>570</b>, controlling the switching hardware or fabric <b>572</b>. To embed FIA capabilities, a small FIA Switch Client, <figref idref="DRAWINGS">FIG. 14</figref>, is embedded in the target apparatus <b>556</b> <b>559</b> <b>571</b>. The FIA Switch Client may configure the local device Frame Processing Apparatus or equivalent apparatus under the control of the FIA Controller <b>567</b>. The FIA Controller <b>567</b> can control <b>565</b> <b>566</b> <b>569</b> the switching apparatus in the targeted apparatus <b>560</b> <b>575</b> <b>572</b> either through a direct connection or through a communications network <b>564</b>.</p>
<p id="p-0144" num="0195"><figref idref="DRAWINGS">FIG. 14</figref> is a diagram of a Converged Network Adapter (CNA). <figref idref="DRAWINGS">FIG. 14</figref> is simplified for clarity purposes. The CNA <b>592</b> interfaces with a server or storage subsystem over a PCIe interface <b>581</b>. The PCIe Interface transmits both data and control frames to the CNA <b>592</b>. The CNA <b>592</b> may comprise a Embedded bridge or switch <b>582</b> to forward frames between but not limited to the following: Ethernet Ports <b>589</b>, PCIe functions or queues <b>581</b>, FIA Switch Client <b>583</b>, FCoE_LEP <b>584</b>, Fabric Services Frame Handler <b>585</b>, FCF-List Storage <b>586</b>, PLOGI Frame Handler <b>587</b>, Name Services and the Query Handler <b>588</b>. Note that one or more of the aforementioned blocks <b>583</b> <b>584</b> <b>585</b> <b>586</b> <b>587</b> <b>588</b> may be located in software external to the CNA <b>592</b>. The FCoE_LEP <b>584</b> encapsulates and de-encapsulates Fibre Channel frames to either FIP or FCoE frames. The Fabric Services Frame Hander <b>585</b> processes frames from the fabric to the CNA <b>592</b>. The FCF-list storage includes at least FCF-MAC addresses, VIDs, Priority attributes, and Fabric attributes. The PLOGI frame handler <b>587</b> may transmit PLOGI frames to Fabric Servers, VF_Ports, F_Ports, VN_Ports, and N_Ports. The Name Services Query Handler <b>588</b> signals the PLOGI Frame Handler <b>587</b> to send PLOGI frames.</p>
<p id="p-0145" num="0196"><figref idref="DRAWINGS">FIG. 15</figref> is a diagram showing the FIA Switch Client in more detail. The FIA Switch Client <b>600</b> is designed to interface with a host switch <figref idref="DRAWINGS">FIG. 13</figref> <b>555</b> <b>558</b> <b>570</b> utilizing a number of methods. Each FIA Switch Client <b>600</b> can utilize one or more concurrent methods. The FIA Switch Client <b>600</b> may be comprised but not limited to a Switch CLI Handler <b>601</b>, a Switch SNMP Frame Handler <b>602</b>, a FIA Controller Client <b>603</b>, a FIA Switch Client Main apparatus <b>604</b>. The FIA Switch Client Main apparatus <b>604</b> may interface with the Switch Core Logic <figref idref="DRAWINGS">FIG. 9</figref> <b>304</b> to transmit to and receive from the host switch communications ports. The FIA Switch Client Main <b>604</b> apparatus may also interface with the Switch Frame Processing Apparatus <b>606</b> to add, modify, or delete FMEs and ACLEs, get and clear statistics counters, and add, modify, or delete Policies upon receipt of commands from a FIAC. The Switch CLI Handler <b>601</b> translates control frames from the ETA Controller to the switch supported CLI. The Switch SNMP Frame Handler <b>602</b> translates SNMP frames from the FIA Controller to commands to and from the Switch Frame Processing Apparatus API <b>606</b>. The FIA Controller Client <b>603</b> may implement different protocols from the FIA Controller to control the switch including but not limited to a vendor specific CLI over IP protocol, TCP/IP, OpenFlow Switch protocol, or a proprietary protocol. Further, the FIA Controller to Client protocols can be encrypted.</p>
<p id="p-0146" num="0197"><figref idref="DRAWINGS">FIG. 16</figref> is a diagram showing the FIA Controller (FIAC) in more detail. The FIA Controller <b>650</b> may comprise the following modules: a Fabrics Services Handler <b>651</b>, a ACE &#x26; Frame Matching Filter Server <b>652</b>, a FTP Frame Handler <b>653</b>, a FIA Management Control Server <b>654</b>, a FIA Policy Service <b>655</b>, a Discovery Domain and Login Control Service <b>657</b>, a FIA Controller a SNMP Handler <b>658</b>, a State Change Notification Service <b>659</b>, a FIA Web Server <b>660</b>, a Name Service <b>661</b>, an optional iSNS Client <b>665</b>, a modified FCoE Controller <b>667</b>, a FIA Controller Main <b>662</b>, a FIAC Datastore <b>680</b>, and the FIA Network Interface <b>663</b>. The FIA Controller <b>650</b> may be implemented in software and reside in a physical server, in a virtual machine in a virtual server, in a communications switch, or in a storage array. The FIA Controller <b>650</b> can also be distributed over a number of processors and servers. The FIA Network Interface <b>663</b> is the path to the network over which FIA communication takes place <b>664</b>. The Fabric Services Handler <b>651</b> receives frames destined for the well known Fabric Services Fibre Channel address identifiers. The Fabric Services Handler <b>651</b> operates on and responds to Fabric Services directed commands which may include but not be limited to messages to the Name Service and messages to the State Change Notification Service. The FIA Controller ACE &#x26; Frame Matching Filter Server <b>652</b> communicates with FIAs to add, modify, and remove both FMEs and ACLEs. The FTP Frame Handler <b>653</b> operates on and responds to FIP frames in addition to originates transmission of FIP frames. The FIP frames may include but not be limited to FIP FLOGI Request, FIP FLOGI LS_ACC, FIP FLOGI LS_RJT, FTP NPIV FDISC Request, FTP NPIV FDISC LS_ACC, FIP NPIV FDISC LS_RJT, FIP Fabric LOGO, EP Fabric LOGO LS_ACC, FIP Fabric LOGO LS_RJT, FIP Keep Alive, FIP Clear Virtual Links, FIP VLAN Request, FIP VLAN Notification, and FIP Vendor Specific frames. The FIA Management Controller Server <b>654</b> may communicate with a FIA using a number of protocols, which may include but not be limited to encapsulated CLI, SNMP, or proprietary transport protocols. These protocols can further be encrypted. The FIA Policy Service <b>655</b> binds certain Quality of Service elements to a logical link between two FCoE endpoints, two Fibre Channel endpoints, or FCoE and Fibre Channel endpoints. Since the FIA Controller manages the Frame Matching Filter entries, the ETA Controller can identify specific FCoE and/or Fibre Channel logical links and assign special forwarding paths which contain specific flow priorities through PFC and ETS capabilities. The Discovery Domain and Login Control Service <b>657</b> implements a mechanism to expose selected views of the Name Server information to client devices or control frame delivery between devices. There are many methods to implement this capability, including Fibre Channel zoning, Discovery Domains, and iSNS based Discovery Domains. The FIA Controller SNMP Handler <b>658</b> operates on and responds to SNMP frames. These frames can be used to manage a FIA Controller or to communicate with and control a FTA from the FIA Controller. The State Change Notification Service <b>659</b> operates on, responds, and generates messages when a state affecting a FCoE, Fibre Channel device, or FIA occurs. The FIAC Web Server <b>660</b> provides external management capability to the ETA Controller <b>650</b>. The Name Service <b>661</b> implements a Name Server that provides a way for FCoE and Fibre Channel device to register and discover Fibre Channel attributes. Once registered, the attributes are made available to other FCoE and Fibre Channel devices within their same Discovery Domain or zone. The FIAC Datastore <b>680</b> may store the Name Server table, the Discovery Domain tables, the FIA and FIAC configuration tables, and other information. The FIAC Datastore <b>680</b> may be local to the FIAC or resident on another external CPU reachable through TCP/IP, SSH or another communications protocol. The FIAC Datastore <b>680</b> may be comprised but not limited to a relational database, an object store database, in memory datastructures, or a flat file system. The FIAC Datastore <b>680</b> may be coupled to a directory-enabled entity that may store client attributes in a Lightweight Directory Access Protocol (LDAP) directory infrastructure, an Active Directory (AD) infrastructure, or in a distributed database. The iSNS Client <b>665</b> is optional and is only present when an iSNS Server is used. When present, the iSNS Client <b>665</b> implements the iSNS Protocol and communicates with the iSNS Server. The FIAC <b>650</b> contains storage comprising a FCF-MAC <b>668</b> used to receive FTP and certain FCoE frames from ENodes through FIAs.</p>
<p id="p-0147" num="0198"><figref idref="DRAWINGS">FIG. 17</figref> is a diagram showing a policy applied to two FCoE devices. A VN_Port, VN_Port<b>1</b> <b>701</b>, instantiated in ENode<b>1</b> <b>700</b> is connected through the communications network <b>717</b> to VN_Port<b>2</b> <b>704</b>, instantiated in ENode<b>2</b> <b>703</b>. The FIA Controller can add a Frame Matching entry to FIA Switch <b>1</b> <b>707</b> and FIA Switch <b>4</b> <b>710</b> to tunnel <b>711</b> or <b>712</b> the communications between the VN_Port's <b>701</b> <b>702</b> as identified by the source and destination Ethernet MAC addresses and optionally the Fibre Channel address identifiers. The tunnel can be assigned certain quality of service elements such as Enhance Transmission service groups, priorities within Per Flow Control, a TRILL or a SPB path. Tagging can be used in lieu of tunneling, tagging a frame comprising a VPLS, or a MPLS identifier. A sample Frame Matching Entry (FME) <b>718</b> added to FIA Switch <b>1</b> <b>707</b> by a FIA Controller would match the incoming frame from ENode<b>1</b> <b>705</b> based on the Fibre Channel destination address identifier, in case the symbolic VN_Port<b>2</b>FCID. The resulting match action is to replace the source Ethernet MAC address with the FCF-MAC address, FIACntrlMAC, and add a tunnel that can be based on a number of methods which may comprise but not be limited to VID replacement, MAC header addition (MAC-in-MAC), VLAN addition (QinQ), TRILL, Shortest Path Bridging, VPLS, MPLS, or a special MAC replacement.</p>
<p id="p-0148" num="0199"><figref idref="DRAWINGS">FIG. 18</figref> is a diagram showing the Discovery Domain model. At the highest level are Discovery Domain Sets <b>750</b> <b>751</b>. Discovery Domain Sets <b>750</b> <b>751</b> are comprised of Discovery Domains <b>752</b> <b>753</b> <b>754</b> <b>755</b>. Discovery Domains are themselves comprised of Discovery Domain Members <b>756</b> <b>757</b> <b>758</b> <b>759</b> <b>760</b>. Discovery Domain sets are uniquely identified, as are Discovery Domains. In the example in <figref idref="DRAWINGS">FIG. 18</figref>, Discovery Domain <b>1</b> <b>752</b> is comprised of WWN<b>1</b> (Initiator <b>1</b>) <b>756</b> and WWN<b>2</b> (Target <b>1</b>) <b>757</b>. Discovery Domain <b>2</b> <b>753</b> is comprised of WWN<b>3</b> (Initiator <b>2</b>) <b>758</b> and WWN<b>2</b> (Target <b>1</b>) <b>757</b>. Discovery Domain <b>3</b> <b>754</b> is comprised of WWN<b>2</b> (Target <b>2</b>) <b>757</b> and WWN<b>5</b> (initiator <b>3</b>) <b>759</b>. Discovery Domain <b>4</b> <b>755</b> is comprised of WWN<b>5</b> (Initiator <b>3</b>) <b>759</b> and WWN<b>4</b> (Target <b>2</b>) <b>760</b>. <figref idref="DRAWINGS">FIG. 18</figref> illustrates a best practice of allocating a zone or group to each Initiator/Target pair, i.e., Initiator <b>1</b>/Target <b>1</b>, Initiator <b>2</b>/Target <b>1</b>, Initiator <b>3</b>/Target <b>1</b>, Initiator <b>3</b>/Target <b>2</b> as each are in a separate Discovery Domain and each target is contained in a separate Discovery Domain Set. Further, Discovery Domains are assigned a Quality of Service metric, Platinum <b>752</b>, Gold <b>753</b>, Silver <b>754</b>, Best Effort <b>755</b>. The Quality of Service metric may be applied to Lossless Ethernet based PFC classes, ETS groups, network tunnels, network tags, or other methods. Configuring the Quality of Service metric may be done through the FIAC policy method. The Discovery Domain Sets <b>750</b> <b>751</b> in <figref idref="DRAWINGS">FIG. 18</figref> are each comprised of Discovery Domains comprising a specific target.</p>
<p id="p-0149" num="0200"><figref idref="DRAWINGS">FIG. 19</figref> is a diagram showing the FIA connection model. The diagram shows the coupling of two FIA interconnection apparatus, FIA<b>1</b> <b>835</b> and FIA<b>2</b> <b>814</b> with two ENodes, ENode H<b>1</b> <b>800</b> and ENode H<b>2</b> <b>811</b>, two Fibre Channel Devices, Fibre Channel Device <b>1</b> <b>843</b> and Fibre Channel Device <b>2</b> <b>819</b>, two FCoE Forwarding Devices (FCF) <b>804</b> <b>840</b>, and a FIAC <b>811</b>. Physical links <b>831</b> <b>805</b> <b>810</b> <b>827</b> <b>841</b> <b>827</b> are Ethernet links and physical links <b>825</b> <b>818</b> are Fibre Channel links. Note the FCF<b>1</b> <b>804</b> and FCF<b>2</b> <b>840</b> can also be FCoE Data Forwarder's (FDF) in this example. The Frame Processing Apparatus (FPA) in FIA <b>1</b> <b>825</b> and FIA<b>2</b> <b>925</b> comprise a list of Frame Match Entries (FMEs) <b>832</b> <b>815</b> <b>816</b> <b>818</b> <b>819</b> <b>820</b> <b>960</b> <b>961</b> <b>962</b> <b>963</b> <b>964</b> <b>965</b> <b>932</b> <b>915</b> <b>916</b> <b>918</b> <b>919</b> <b>920</b> <b>970</b> <b>971</b> <b>972</b> <b>973</b> <b>974</b> <b>975</b>, all previously configured by an add FME command received from the FIAC <b>811</b> by the FIAs <b>835</b> <b>814</b>. Note that ACLE and Policy entries are not shown in <figref idref="DRAWINGS">FIG. 19</figref> for simplicity purposes. FME<b>2</b> <b>832</b> <b>932</b> matches the FCID of VN_Port<b>2</b> <b>801</b>, FME<b>3</b> <b>815</b> <b>915</b> matches the FCID of VN_Port<b>3</b>, FME<b>4</b> <b>816</b> <b>916</b> matches the FCID of VN_Port<b>4</b> <b>812</b>, FME<b>5</b> <b>818</b> <b>918</b> matches the RID of VN_Port<b>5</b>, FME<b>6</b> <b>819</b> <b>919</b> matches the FCID of N_Port<b>6</b> <b>844</b>, and FME<b>7</b> <b>820</b> <b>920</b> matches the FCID of N_Port<b>7</b> <b>820</b>. FME<b>8</b> <b>960</b> <b>970</b> matches FIP frames with a destination Ethernet MAC address of All-ENode-MACs MAC address. FME<b>9</b> <b>961</b> <b>971</b> matches FIP frames with the destination Ethernet MAC address of All-FCF-MACs. FME<b>10</b> <b>962</b> <b>972</b> matches FIP frames with the destination Ethernet MAC address of the FIAC <b>811</b> FCF-MAC address <b>841</b>. FME<b>11</b> <b>963</b> <b>973</b> matches FIP frames with a source Ethernet MAC address of the FIAC <b>811</b> FCF-MAC address <b>841</b>. FME<b>12</b> <b>964</b> <b>974</b> matches FCoE frames with a destination Ethernet MAC address of the FIAC <b>811</b> FCF-MAC address <b>841</b>. FME<b>12</b> <b>964</b> <b>974</b> match entry is of a lower priority than the rest of the FME's meaning if another higher priority match occurs, FME<b>12</b>'s action(s) will not be executed. FME<b>13</b> <b>965</b> <b>975</b> matches FCoE frames with a source Ethernet MAC address of the FIAC <b>811</b> FCF-MAC address <b>841</b>. FME<b>13</b> <b>965</b> <b>975</b> is of a higher priority than the other FMEs meaning that if this FME matches an incoming frame, it's actions will be executed in place of other lower priority FME matches. FME<b>13</b> <b>965</b> <b>975</b> matches FCoE frames that have already had their source and destination Ethernet MAC addresses substituted by the ingress FIA, i.e., the rule matches frames in transit in intermediate and egress FIA's. For example for frames originating from VN_Port<b>3</b> <b>802</b> in ENode H<b>1</b> <b>800</b> destined to VN_Port<b>4</b> <b>812</b> in ENode H<b>2</b> <b>811</b> they will match the FME<b>4</b> <b>816</b> entry, i.e., the embedded Fibre Channel destination address identifier will be the Fibre Channel address identifier of VN_Port<b>4</b> <b>812</b>. FME<b>4</b> <b>816</b> actions will replace the destination Ethernet MAC address by VN_Port<b>4</b>'s <b>812</b> Ethernet MAC address and the source address with the FIAC <b>811</b> FCF-MAC address <b>841</b>. The frame will be forwarded over the inter-FIA link <b>829</b> based on the forwarding method used by the FIA's which could comprise RSTP, MSTP, OSPF, BGP, or any other layer <b>2</b> or layer <b>3</b> forwarding method. The forwarding method may be independent of the FME actions. Upon receipt of the frame by FIA <b>2</b> <b>814</b>, the entry FME<b>13</b> <b>975</b> will match the frame, i.e., a high priority FME entry matching a FCoE frame with a source Ethernet MAC address of the FIAC <b>811</b> FCF-MAC address <b>841</b>. The action is to forward the frame.</p>
<p id="p-0150" num="0201">Since the logical link <b>838</b> from VN_Port<b>1</b> <b>845</b> to VF_Port <b>850</b> utilizes FIA<b>1</b> <b>835</b> as a Lossless Ethernet Bridge, a FME for VN_Port<b>1</b> is not created, FIA<b>1</b> <b>835</b> uses the Frame Filtering <figref idref="DRAWINGS">FIG. 9</figref> <b>308</b> table created by it's current method of frame forwarding, for example by RSTP, MSTP, etc. to forward the frame. FIA<b>1</b> <b>835</b> further functions as a Lossless Ethernet bridge to the logical link <b>837</b> created by the VE_Port <b>846</b> in FCF<b>2</b> <b>840</b> and VE_Port <b>830</b> in FCF<b>1</b> <b>804</b>. Fibre Channel N_Port<b>7</b> <b>820</b> in Fibre Channel Device <b>2</b> <b>819</b> has a logical connection <b>809</b> with VN_Port<b>5</b> <b>806</b> in ENode H<b>2</b> <b>811</b>. The logical connection includes a Lossless Ethernet Port <b>808</b> on FIA <b>2</b> <b>814</b> and a Fibre Channel port <b>813</b> on FLU <b>814</b>. FCoE frames transmitted from VN_Port <b>5</b> <b>806</b> to N_Port<b>7</b> <b>820</b> are identified by FME<b>7</b> <b>920</b> in FIA <b>2</b> <b>814</b>. Fibre Channel frames transmitted from VN_Port <b>7</b> <b>820</b> to VN_Port <b>5</b> <b>806</b> are identified by FME<b>5</b> <b>918</b>. FCoE frames transmitted from VN_Port<b>3</b> <b>802</b> to VN_Port <b>4</b> <b>812</b> are identified by FME<b>4</b> <b>816</b>. FCoE frames transmitted from VN_Port <b>4</b> <b>812</b> to VN_Port <b>3</b> <b>802</b> are identifier by FME<b>3</b> <b>915</b>. FCoE frames transmitted from VN_Port<b>2</b> <b>801</b> to N_Port<b>6</b> <b>844</b> are identified by FME<b>6</b> <b>819</b> and Fibre Channel frames transmitted by N_Port<b>6</b> <b>844</b> to VN_Port<b>2</b> <b>801</b> are identified by FME<b>2</b> <b>832</b>. FIAC <b>811</b> includes a modified FCoE Controller <b>812</b> and a FCF-MAC address <b>841</b>. The modified FCoE Controller <b>812</b> is adapted to receive and process FIP frames from ENodes, transmit FIP frames to ENodes, received and process certain FCoE frames from ENodes, VN_Ports, and N_Ports destined for well known Fibre Channel Fabric Services, and receive and process and transmit State Change Notification FCoE frames. The link <b>829</b> between FIA<b>1</b> <b>835</b> and FIA<b>2</b> <b>814</b> is a Lossless Ethernet link in which frames are forwarded by the Frame Processing Apparatus in FIA <b>1</b> <b>835</b> and FIA<b>2</b> <b>814</b> respectively. Frames transmitted and received between the FIAs <b>829</b> may be forwarded comprising but not limited to the following methods: RSTP, MSTP, TRILL, Shortest Path Bridging, OSPF, RIPng, and BGP. The virtual link <b>837</b> between FCF<b>1</b> <b>804</b> and FCF<b>2</b> <b>840</b> is a VE_Port <b>846</b> to VE_Port <b>830</b> inter-switch link and connects through FIA<b>1</b> <b>835</b>. The virtual link <b>838</b> between VN_Port <b>845</b> in ENode <b>1</b> <b>800</b> and the VF_Port <b>850</b> in FCF<b>2</b> <b>840</b> is a VN_Port to VF_Port link. The VN_Port <b>845</b> to VF_Port <b>850</b> link <b>838</b> also connects through FIA<b>1</b> <b>835</b>, FIA<b>1</b> <b>835</b> behaves as a Lossless Ethernet Bridge for those specific virtual links <b>837</b> <b>838</b>. Further note that there are no VE_Ports or E_Ports contained, in the FIAs <b>835</b> <b>814</b>. The FIA connection forwarding is based on a different method than the FC-SW required Fibre Channel FSPF routing method for FCF and FDF's.</p>
<p id="p-0151" num="0202"><figref idref="DRAWINGS">FIG. 20</figref> is a diagram showing the interconnection of two ENodes through a network of FIAs. <figref idref="DRAWINGS">FIG. 20</figref> assumes the FIP Discovery and Login phases have occurred. Instantiated VN_Port<b>1</b> <b>1052</b> in ENode<b>1</b> <b>1029</b> transmits a FCoE frame <b>1020</b> to FIA <b>1</b> <b>1028</b>. The FCoE frame <b>1020</b> includes the destination Ethernet FCF-MAC address FIACntlrMAC <b>1025</b>, the source Ethernet MAC address, VN_Port<b>1</b>MAC <b>1024</b>, the VLAN identifier VLAN<b>1</b> <b>1023</b>, Data <b>1022</b>, and a Frame Checksum <b>1021</b>. The FCoE frame is received by FIA <b>1</b> <b>1028</b>. FIA <b>1</b> <b>1028</b> replaces the destination Ethernet MAC address with the MAC address of VN_Port<b>2</b> <b>1015</b>, the source Ethernet MAC address with FCF-MAC address FIACntlrMAC <b>1014</b> and calculates a new FCS <b>1011</b>. The modified FCoE frame <b>1010</b> is transmitted to FIA <b>2</b> <b>1027</b>. Upon receipt of the frame, FIA <b>2</b> <b>1027</b> may forward the frame based on any number of forwarding methods to FIA <b>3</b> <b>1030</b>. FIA <b>3</b> <b>1030</b> receives the frame and forwards the frame to the destination VN_Port, VN_Port<b>2</b> <b>1053</b> with the original source and destination Ethernet MAC addresses from the frame received from FIA <b>2</b> <b>1027</b>.</p>
<p id="p-0152" num="0203"><figref idref="DRAWINGS">FIG. 21</figref> is a diagram showing the interconnection of two Fibre Channel devices through a network of FIAs. Fibre Channel Device<b>1</b> <b>1181</b> is connected to FIA <b>1</b> <b>1178</b> over a Fibre Channel connection <b>1180</b>. Fibre Channel Device<b>2</b> <b>1182</b> is connected to FIA <b>3</b> <b>1179</b> over a Fibre Channel connection <b>1180</b>. FIA <b>1</b> is connected to FIA<b>2</b> <b>1177</b> over an Ethernet network <b>1176</b>. FIA<b>2</b> <b>1177</b> is connected to FIA<b>3</b> <b>1179</b> over an Ethernet network <b>1176</b>. <figref idref="DRAWINGS">FIG. 21</figref> assumes the FLOGI request and response interchange has occurred. N_Port <b>1</b> <b>1191</b> contained in Fibre Channel Device<b>1</b> <b>1181</b> transmits a Fibre Channel frame <b>1170</b> addressed <b>1174</b> to N_Port <b>2</b> <b>1192</b> contained in Fibre Channel Device<b>2</b> <b>1182</b>. FIA<b>1</b> <b>1178</b> receives the Fibre Channel frame, encapsulates it into a FCoE frame <b>1160</b>, comprising a source Ethernet MAC address of the internal MAC address of N_Port <b>1</b> NP<b>1</b>MAC <b>1164</b> <b>1187</b> previously assigned by the FIA Controller and comprising a destination Ethernet MAC address of the internal MAC address of N_Port <b>2</b> NP<b>2</b>MAC <b>1165</b> <b>1188</b> previously assigned by the FIA Controller (not shown). FIA <b>1</b> <b>1178</b> then forwards the FCoE frame <b>1160</b> to FIA<b>2</b> <b>1177</b>. FIA<b>2</b> <b>1177</b> receives the frame and forwards the FCoE frame <b>1183</b> to FIA<b>3</b> <b>1179</b>. FIA<b>3</b> <b>1179</b> receives the frame, decapsulates the frame into a Fibre Channel frame <b>1193</b> and transmits it to Fibre Channel Device<b>2</b> <b>1182</b>.</p>
<p id="p-0153" num="0204"><figref idref="DRAWINGS">FIG. 22</figref> is a ladder or sequence diagram showing a FR Controller sending Frame Matching Entries (FMEs) to a FIA. <figref idref="DRAWINGS">FIG. 22</figref> assumes that the FIA Controller and FIA discovered and connected <b>1203</b>. FIA and FIAC pair discovery can utilize any methods including but not limited to the Link Level Discovery Protocol, Service Level Protocol, DHCP, monitoring FIA Controller FIP Discovery Advertisements. The FR Controller sends FME's to FIA's to receive initialization and control frames from a network of FIAs. The FIA Controller <b>1202</b> sends a FME <b>1204</b> frame comprising the following match attributes: any source Ethernet MAC address, All-ENode-MACs destination Ethernet MAC address, Ethernet Type of FIP (FCoE Initialization Protocol). The action is to forward the frame. This FME allows FIP frames addressed to the address All-ENode-MACs to be forwarded to all connected ENodes. The FIA Controller <b>1202</b> sends a FME <b>1205</b> frame comprising the following match attributes: any source Ethernet MAC address, All-FCF-MACs destination Ethernet MAC address, Ethernet Type of FIP, with an action to forward the frame. This FME allows FIP frames addressed to the address All-FCF-MACs to be forwarded to all connected FCFs. The FIA Controller <b>1202</b> is configured to receive frames with the destination Ethernet MAC address of All-FCF-MACs <b>1210</b>. The FR Controller <b>1202</b> sends a FME <b>1206</b> frame comprising the following matching attributes: any source Ethernet MAC address, a destination Ethernet MAC address of the FCF-MAC address FIACntlrMAC <b>1209</b> (FIA Controller MAC), Ethernet Type of FIP with an action to forward the frame. This FME allows frames addressed <b>1209</b> to the FIA Controller <b>1202</b> to be forwarded to the FIA Controller <b>1202</b>. The FIA Controller <b>1202</b> then sends a FME to FIA <b>1</b> <b>1201</b> comprising the following match attributes: source Ethernet. MAC address of any, destination Ethernet MAC address of FIA Controller FCF-MAC (FIACntlrMAC), an Ethernet Type of FCoE, a low priority and an action to forward the frame. This FME forwards FCoE frames from the FIA Controller if no other medium or high priority matches occur. The FIA Controller <b>1202</b> sends a FME to FIA <b>1</b> <b>1201</b> comprising the following match attributes: source Ethernet MAC address of FIACntlrMAC FCF-MAC address, destination Ethernet MAC address of any, Ethernet Type of FIP, a medium priority for this FME with an action to forward the frame. This FME is for FIP frames sent by the FIA Controller <b>1202</b> to ENodes and Fibre Channel devices. The FIAC sends a FME <b>1208</b> to FIA <b>1</b> <b>1201</b> includes the following match attributes: source Ethernet MAC address of FIACntlrMAC FCF-MAC address, destination Ethernet MAC address of any, Ethernet Type of FCoE, a higher priority for this FME with an action to forward the frame. This FME is for FCoE frames sent by the FIA Controller <b>1202</b> to attached ENodes and Fibre Channel devices.</p>
<p id="p-0154" num="0205"><figref idref="DRAWINGS">FIG. 23</figref> is a ladder or sequence diagram of the FIP Discovery frame exchange protocol between a FIA Controller and a FIA. ENode<b>1</b> <b>1225</b> sends a FIP VLAN Request <b>1228</b> with the destination Ethernet MAC address of All-FCF-MACs to the connected FIA <b>1226</b>. FIA <b>1</b> <b>1226</b> forwards the frame based on a FME entry <figref idref="DRAWINGS">FIG. 22</figref> <b>1205</b> that was previously received from the FIA Controller <b>122</b>.<b>7</b>. The FIA Controller <b>1227</b> responds with a FIP VLAN Notification <b>1230</b> message with the destination MAC address of ENode<b>1</b> <b>1225</b> and a source Ethernet MAC address of the FIA Controller. The frame is forwarded by FIA <b>1</b> <b>1226</b> using a previously set FME, <figref idref="DRAWINGS">FIG. 22</figref> <b>121</b>.<b>1</b>, to the destination ENode<b>1</b> <b>1225</b>. The FIA Controller <b>1227</b> transmits a FIP Discovery Advertisement frame <b>1231</b> with the destination Ethernet MAC address of All-ENode-MACs and the source Ethernet MAC address of the FIA Controller (FIACntrlMAC). The frame is forwarded by FIA <b>1</b> <b>1226</b> to ENode<b>1</b> <b>1225</b>. ENode<b>1</b> <b>1225</b> transmits a unicast FIP Discovery Solicitation frame <b>1232</b> with the destination Ethernet MAC address of the FIA Controller and the source Ethernet MAC address of the ENode <b>1</b> <b>1225</b> (ENode<b>1</b>MAC). FIA <b>1</b> <b>1226</b> forwards the frame to the FIA Controller <b>1227</b> which responds with a unicast FIP Discovery Solicitation frame <b>1234</b> with the destination Ethernet MAC address of ENode<b>1</b> <b>1225</b> (ENode<b>1</b>MAC) and the source Ethernet MAC address of the FIA Controller FCF-MAC address <b>1227</b> (FIACntlrMAC).</p>
<p id="p-0155" num="0206"><figref idref="DRAWINGS">FIG. 24</figref> is a ladder or sequence diagram showing a FTP FLOGI Request, FIP FLOGI LS_ACC frame exchange. ENode<b>1</b> <b>1250</b> transmits a FIP FLOGI Request frame <b>1253</b> comprising a destination Ethernet FCF-MAC address of the FIA Controller (FIACntrlMAC) and a source Ethernet MAC address of the ENode<b>1</b> FCoE Controller (ENode<b>1</b>MAC), <figref idref="DRAWINGS">FIG. 7</figref> <b>214</b>, FIA <b>1</b> <b>1251</b> receives the FIP FLOGI Request and forwards the frame based on a previously assigned FME, <figref idref="DRAWINGS">FIG. 22</figref> <b>1206</b>, that matches the frame destination Ethernet MAC address of the FIACntlrMAC FCF-MAC address and the Ethernet Type of FIP. The FIA Controller <b>1252</b> assigns a MAC address and a Fibre Channel address identifier for the newly instantiated VN_Port <b>1250</b>. The FIA Controller <b>1252</b> adds a FME <b>1255</b> to all FIAs in the Discovery Domain of the VN_Port, including the local FIA switch <b>1251</b>. The FME includes the following match fields: source Ethernet MAC address of any, destination Ethernet MAC address of any, Ethernet Type of FCoE, the Fibre Channel Destination Address Identifier (DID) in the embedded FCoE frame is the newly assigned Fibre Channel address identifier, in this case the symbolic VN<b>1</b>FCID, with an action to replace the destination Ethernet MAC address with the newly assigned VN_Port MAC, in this case the symbolic VN<b>1</b>MAC, replace the source Ethernet MAC address with the FIA Controller FCF-MAC address (FIACntlrMAC), and forward the frame.</p>
<p id="p-0156" num="0207"><figref idref="DRAWINGS">FIG. 25</figref> is a ladder or sequence diagram showing the exchange of a FIP NPIV FDISC/FIP LS_ACC message exchange between an ENode and a FIA Controller. The ENode <b>1300</b> transmits a FIP NPIV FDISC frame <b>1305</b> with the destination Ethernet MAC address of the FIA Controller FCF-MAC address (FIACntlrMAC) and a source Ethernet MAC address of the FCoE_Controller (ENode<b>1</b>MAC). FIA <b>1</b> <b>1301</b> forwards the frame based on the previously assigned FME, <figref idref="DRAWINGS">FIG. 22</figref> <b>1206</b>, that matches the frame destination Ethernet MAC address of the FIACntlrMAC FCF-MAC address and the Ethernet Type of FIP. The FIA Controller <b>1302</b> assigns a MAC address and a Fibre Channel address identifier for the newly instantiated VN_Port <b>1300</b>. The FIA Controller <b>1302</b> adds a FME entry <b>1306</b> to all FIAs in the Discovery Domain of the VN_Port, including the local FIA switch <b>1301</b>. The FME includes the following match fields: source Ethernet MAC address of any, destination Ethernet MAC address of any, Ethernet. Type of FCoE, the Fibre Channel Destination Address Identifier (DID) in the embedded FCoE frame is the newly assigned Fibre Channel address identifier, in this case the symbolic VN<b>2</b>FCID. The action upon frame match is to replace the destination Ethernet MAC address with the newly assigned VN_Port MAC, in this case the symbolic VN<b>2</b>MAC, replace the source Ethernet MAC address with the FIA Controller FCF-MAC address (FIACntlrMAC), and forward the frame.</p>
<p id="p-0157" num="0208"><figref idref="DRAWINGS">FIG. 26</figref> is a ladder or sequence diagram showing the exchange of a FCoE State Change Registration request and LS_ACC response message exchange in addition to a Name Server query request and response message exchange. VN_Port<b>1</b> of ENode<b>1</b> <b>1400</b> transmits a FCoE SCR Request message <b>1402</b> with a destination Ethernet MAC address of the FIA Controller FCF-MAC address (FIACntlrMAC), a source Ethernet MAC address of the transmitting VN_Port (VN<b>1</b>MAC), a Fibre Channel destination address identifier (DID) of the well known Fabric Controller (FFFFFDh) and the Fibre Channel source address identifier (SID) of the VN_Port<b>1</b> (VN<b>1</b>FCID). The State Change Registration ELS Request (SCR) requests the Fabric Controller to add the VN_Port that is sending the SCR Request to the list of VN_Port/Nx_Ports registered to receive the RSCN (Register State Change Notification) ELS frames. FIA <b>1</b> receives the FCoE SCR frame and forwards it to the FIA Controller <b>1401</b>. The FIA Controller Fabric Services Frame Handler, <figref idref="DRAWINGS">FIG. 15</figref> <b>651</b>, services the frame and transmits a FCoE LS_ACC Response <b>1404</b> comprising a destination Ethernet MAC address of the VN_Port (VN<b>1</b>MAC) and a source Ethernet MAC address of the FIA Controller FCF-MAC address <b>1401</b> (FIACntlrMAC). VN_Port<b>1</b> of ENode<b>1</b> <b>1400</b> transmits a Name Server query, Get Port Identifiers (GID_FT) request <b>1405</b> to return all Port Identifiers having registered support for the specified FC-4 TYPE. The FIA Controller <b>1401</b> queries the internal Name Server for all registered FC-4 TYPEs visible, i.e., in the same Discovery Domains, as querying VN_Port<b>1</b>. The FIA Controller <b>1401</b> returns a FCoE LS_ACC <b>1408</b> to VN_Port<b>1</b> <b>1400</b> which may comprise a list of Fibre Channel Port Identifiers.</p>
<p id="p-0158" num="0209"><figref idref="DRAWINGS">FIG. 27</figref> is a ladder or sequence diagram showing a PLOGI exchange between ENodes. VN_Port<b>1</b> of ENode<b>1</b> <b>1500</b> transmits a FCoE PLOGI request <b>1505</b> with a source Ethernet MAC address of the VN_Port<b>1</b> (VN<b>1</b>MAC), a destination Ethernet MAC address of the FIA Controller <b>1502</b>, a Fibre Channel source address identifier (SID) of VN_Port<b>1</b> (VN<b>1</b>FCID), and a Fibre Channel destination address identifier (DID) of VN_Port<b>100</b> (VN<b>100</b>FCID) contained in ENode<b>2</b> <b>1504</b>. FIA <b>1</b> <b>1501</b> matches the frame with the FME <b>1508</b> match fields comprising the source and destination Ethernet MAC addresses of any, the Ethernet Type of FCoE, the Fibre Channel destination address identifier (DID) of VN_Port<b>100</b> (VN<b>100</b>FCID). The action is to replace the destination Ethernet MAC address with VN_Port<b>100</b>'s MAC address (VN<b>100</b>MAC), the source Ethernet MAC address with the FIA Controller FCF-MAC address (FIACntlrMAC), and to forward the frame. The frame is forwarded to FIA <b>7</b> <b>1503</b>, Note that once the FIP sequence is complete and the frames are not destined for Fabric Services well known addresses, the FIA Controller <b>1502</b> is not involved in processing the frames, i.e., receiving the frame and forwarding the frame. FIA <b>7</b> <b>1503</b> receives the FCoE PLOGI frame and forwards the frame based on the previously assigned FME comprising the matching fields of source Ethernet MAC address of the FIA Controller FCF-MAC address <b>1502</b> (FIACntlrMAC), a destination Ethernet MAC address of any, an Ethernet Type of FCoE, and action is forward the frame. VN_Port<b>100</b> of ENode<b>2</b> <b>1504</b> receives the FCoE PLOGI and responds with a FCoE LS_ACC to the PLOGI <b>1515</b>. The FCoE LS_ACC includes a destination Ethernet MAC address of the FIA Controller FCF-MAC address (FIACntlrMAC), a source Ethernet MAC address of VN_Port<b>100</b> (VN<b>100</b>MAC), a Fibre Channel destination address identifier (DID) of VN_Port<b>1</b> (VN<b>1</b>FCID), and a Fibre Channel source address identifier if VN_Port<b>100</b> (VN<b>100</b>FCID). FIA <b>7</b> <b>1503</b> uses the previously assigned FME <b>1517</b> comprising the match fields of source and destination Ethernet MAC address of any, the destination Fibre Channel address identifier (DID) of VN_Port<b>1</b> (VN<b>1</b>FCID), and the Ethernet Type of FCoE, and with an action to replace the destination Ethernet MAC address with VN_Port<b>1</b>'s MAC address (VN<b>1</b>MAC), replace the source Ethernet MAC address with the FIA Controller <b>1502</b> FCF-MAC address (FIACntlrMAC), and forward the frame. The frame is forwarded <b>1514</b> to FIA <b>1</b> <b>1501</b> which matches the frame with the FME <b>1516</b> comprising the match fields of the source Ethernet MAC address of the FIA Controller <b>1502</b> FCF-MAC address (FIACntlrMAC), the destination Ethernet MAC address of any, the Ethernet Type of FCoE, with an action to forward the frame to VN_Port<b>1</b> in ENode<b>1</b> <b>1500</b>.</p>
<p id="p-0159" num="0210"><figref idref="DRAWINGS">FIG. 28</figref> is a ladder or sequence diagram showing an ENode and a VN_Port transmitting a FIP Keep Alive frames. <figref idref="DRAWINGS">FIG. 28</figref> further shows the FIA Controller <b>1552</b> transmitting a FIP Discovery Advertisement frame <b>1556</b>. ENodes and VN_Ports transmit FIP Keep Alive frames on specified intervals to signal the FCF, in this example the FIA Controller that they are still reachable. FIA <b>1</b> <b>1551</b> forwards the frames based on a previously assigned FME to forward frames with the destination Ethernet MAC address of the FIA Controller FCF-MAC address (FIACntlrMAC) and the Ethernet Type of a FIP frame. The FIA Controller <b>1552</b> transmits FIP Discovery Advertisement frames <b>1556</b> addressed to All-ENode-MACs to advertise the MAC address and the reachability of the FIA Controller <b>1552</b>. FIA <b>1</b> <b>1551</b> forwards the FIP Discovery Advertisement frames based on a previously assigned FME forwarding based on the destination Ethernet MAC address of All-ENode-MACs and the Ethernet frame Type of FIP.</p>
<p id="p-0160" num="0211"><figref idref="DRAWINGS">FIG. 29</figref> is a sequence or ladder diagram showing the initialization of a FIA Controller utilizing an iSNS Server for State Change Notification, Discovery Domain, and Name Services. The Internet Storage Name Service (iSNS) Protocol (iSNSP) is used for interaction between iSNS Server <b>1602</b> and the FIA Controller <b>1601</b>. In this exemplary invention, the iSNS Server <b>1602</b> has been adapted to facilitate automated discovery, management, and configuration of FCoE and Fibre Channel devices in a network of FIAs. An iSNS Server provides intelligent storage discovery and management services comparable to those found in Fibre Channel networks. Since an iSNS Server is currently adapted to only discovery and manage iSCSI and iFCP devices, in the current exemplary invention, the FIAC translates and adapts the messages to and from the iSNS Server to make it useful for a repository of currently active FCoE and Fibre Channel nodes and related attributes. The FCoE and Fibre Channel nodes communicate to a FIA Controller <b>1601</b> which in turn may communicate to the iSNS Server <b>1602</b>. In the exemplary invention, the FIA may translate certain FIP, FCoE, and Fibre Channel commands that are directed to Fibre Channel Fabric Services into iSNS commands and responses, i.e., there is not direct communication between ENodes, Fibre Channel nodes, FIAs and the iSNS Server. By translating the commands and responses, this allows an iSNS Server to manage a dynamic database of the FCoE and Fibre Channel devices, through a FIA Controller, and related information that are currently available on the network. The database helps provide FCoE and Fibre Channel target discovery functionality for the FCoE and Fibre Channel initiators on the network, through a FIA and a FIAC. The database is kept dynamic by using the Registration Period and Entity Status Inquiry features of iSNS, Registration Period allows the server to automatically deregister stale entries, Entity Status Inquiry provides the server a capability similar to ping to determine whether registered clients, i.e., FIA and the ENodes they are connected to, are still present on the network, and allows the server to automatically deregister those clients which are no longer present. The iSNS Server also supports a State Change Notification Service, allowing registered clients to be made aware of changes to the database in the iSNS server. The iSNS Server database is the information repository for iSNS Servers. It maintains information about iSNS client attributes. A directory-enabled implementation of iSNS may store client attributes in a Lightweight Directory Access Protocol (LDAP) directory infrastructure. The iSNS Server provides a name registration service function to allow all entities through a FIA Controller in a storage network to register and query the iSNS database. Both targets and initiators can register, translated by a FIA Controller, in the iSNS database, as well as query for information about other initiators and targets. This allows, for example, a client initiator to obtain information about target devices from the iSNS server. This service is modeled on the Fibre Channel Generic Services Name Server described in Internet Engineering Task Force (IETF) request for comment (RFC) documents, with extensions, operating within the context of an IP network. The iSNS Server provides a Discovery Domain (DD) service, similar to zones in a Fibre Channel fabric, facilitating the partitioning of FCoE and Fibre Channel devices into manageable groupings for administrative and logon control purposes. It allows the administrator to limit the logon process of each FCoE and Fibre Channel host through a FIA Controller to the more appropriate subset of targets registered in the iSNS Server. Devices can be members of multiple DDs. Logon control allows targets to delegate their access control or authorization policy to the iSNS server. The target node or device downloads, through a FIA, the list of authorized initiators from iSNS. Each node or device is uniquely identified. Only initiators that match the required identification and authorization provided by the iSNS will be allowed access by that target node during session establishment. DDs can be managed offline by using a separate management computer that is using the iSNS Protocol or SNMP or communicates to a FIA Controller which in turn communicates with the iSNS Server. Valid and active discovery domains belong to at least one active DDS. Discovery domains that do not belong to an activated DDS are not enabled. The iSNS server maintains the state of DD membership for all FCoE and Fibre Channel devices, even for those devices that have been deregistered. DD membership is persistent regardless of whether a FCoE or Fibre Channel device is actively registered in the iSNS database. The State Change Notification (SCN) service allows the iSNS Server to issue notifications to FIA Controllers about network events that affect the operational state of storage nodes. FIA Controllers may translate the iSNS Server State Change Notification messages into FCoE and Fibre Channel based State Change Notification messages. A FCoE or Fibre Channel initiator sends name server queries to a FIA Controller, which may translate the messages and query the iSNS Server to discover FCoE and Fibre Channel target devices. A management station may use iSNS to monitor storage devices and enable or disable storage sessions by configuring discovery domains. A management station usually interacts with the iSNS Server as a control node with access to all iSNS database records and privileges to modify discovery domains. Through manipulation of discovery domains, the management station controls the scope of device discovery for FCoE and Fibre Channel devices that query the iSNS server through a FIA Controller.</p>
<p id="p-0161" num="0212">Referring to <figref idref="DRAWINGS">FIG. 29</figref>, the FIA Controller <b>1601</b> discovers the presence <b>1603</b> of the iSNS Server <b>1602</b>. There are several methods of discovery that the FIA Controller <b>1601</b> can utilize. They include using the Service Location Protocol (SLP, see RFC 2608) that provides a flexible and scalable framework for providing FIA Controllers with access to information about the existence, location, and configuration of networked services, including the iSNS Server. Another method of iSNS Server IP address discovery can be through the stored value in a DHCP server, where it can be downloaded by FIA Controller. A further method of iSNS Server discovery is to monitor by the FIA Controller for iSNS Server heartbeat broadcasts. This can also notify FIA Controllers of the existence of more than one iSNS Server, for example for backup iSNS Servers. Upon discovery of the iSNS Server, a FIA Controller transmits a Device Attribute Registration Request (DevAttrReg) <b>1604</b> to the iSNS Server which may register new objects which may include but not be limited to it's Portal IP address, TCP/UDP Port, Entity Status Inquiry (ESI) Interval and Port, Fibre Channel Port Name of the FIA Port, Fibre Channel address identifier. The iSNS Server <b>1602</b> receives the DevAttrReg Request <b>1604</b>, updates the iSNS database for this FIA Controller and responds with a Device Attribute Registration Response (DevAttrRegRsp) <b>1605</b> message. One of the attributes of the DevAttrRegRsp <b>1605</b> message is the Entity Identifier (EID) that uniquely identifies each Network Entity registered in the iSNS Server. The FIA Controller <b>1601</b> transmits a SCN Register Request (SCNReg) <b>1609</b> message to the iSNS Server <b>1602</b> to allow the FIA Controller <b>1601</b> to register to receive State Change Notification (SCN) messages. The SCN message notifies a FIA of changes to any other remote FIA attached devices (i.e., ENodes or Fibre Channel Devices) within any Discovery Domain of which it is a member. The Discovery Domain (DD) facilitates the partitioning of FIA attached devices (ENodes and Fibre Channel Devices) into more manageable groupings for administrative and login control purposes. It allows the administrator to limit the login process of each ENode or Fibre Channel Device to the more appropriate subset of devices registered in the iSNS Server Database. The devices are usually storage targets. This service is similar to Fibre Channel zoning, where zones are created composed of related devices, such as initiator target pairs, providing security to exclude non-administratively configured devices. A Request FC_DOMAIN_ID (RqstDomId) message <b>1612</b> is sent from the FIA Controller <b>1601</b> to the iSNS Server <b>1602</b>. The RqstDomId message <b>1612</b> is used to allocate non-overlapping FC_DOMAIN_ID values. The FC_DOMAIN ID value is stored FIA Controller <b>1601</b> resident storage. The iSNS Server <b>1602</b> becomes the address assignment authority for the entire FIA fabric. After receipt of the Request FC_DOMAIN_ID Response (RqstDomIdRsp) <b>1613</b> from the iSNS Server <b>1602</b>, the FIA Controller <b>1601</b> then sends a FIP Discovery Advertisement frame <b>1617</b> to start the discovery protocol to find attached ENodes. The FIP Discovery Advertisement frame <b>1617</b> is received by the FIA <b>1617</b> which forwards the frame to ENode<b>1</b> <b>1600</b>. Further in <figref idref="DRAWINGS">FIG. 28</figref>, The DevAttrReg <b>1604</b>, DevAttrRegRsp <b>1605</b>, SCNReg <b>1609</b>, SCNReg Rsp <b>1611</b>, RqstDomID <b>1612</b>, and RqstDomID Rsp <b>1613</b> messages are all IP <b>1610</b> encapsulated iSNS messages.</p>
<p id="p-0162" num="0213"><figref idref="DRAWINGS">FIG. 30</figref> is a ladder or sequence diagram showing the interaction between an ENode, a FIA Controller, an iSNS Server, and a remote ENode upon the exchange of FLOGI/LS_ACC FCoE frames. ENodel <b>1650</b> transmits a FIP FLOGI Request frame <b>1654</b> to the FIA <b>1666</b>. The FIA <b>1666</b> forwards the frame to the FIA Controller <b>1651</b>. The FIA Controller <b>1651</b> allocates a new MAC address and a new Fibre Channel address identifier. The FIA Controller <b>1651</b> then transmits a DevAttrReg request <b>1655</b> comprising the new MAC address and the new Fibre Channel address identifier to the iSNS Server <b>1652</b>. The iSNS Server <b>1652</b> updates its internal database with the new information. <figref idref="DRAWINGS">FIG. 30</figref> assumes that VN_Port<b>2</b> in ENode<b>2</b> <b>1653</b> has previously initialized, registered into the name server table, and is in the same Discovery Domain as VN_Port<b>1</b> <b>1650</b>. The iSNS Server <b>1652</b> sends a State Change Notification message to the FIA Controller <b>1651</b> which in turn translates the message into a Fibre Channel State Change Notification message and transmits it to the FIA <b>1617</b> which forwards the frame to ENode<b>2</b> <b>1662</b>, ENode<b>2</b> <b>1662</b> transmits the RSCN response message <b>1665</b> back to the FIA Controller <b>1651</b>, The FIA Controller <b>1651</b> transmits a LS_ACC FIP frame <b>1659</b> to the FIA <b>1666</b> in response to the FIP FLOGI request frame, which in turn forwards the frame to the ENodel <b>1650</b>, completing the FIP FLOGI/LS_ACC frame exchange.</p>
<p id="p-0163" num="0214"><figref idref="DRAWINGS">FIG. 31</figref> is a ladder or sequence diagram showing the initialization and discovery between two ENodes using the FIA Controller and iSNS Server, VN_Port<b>1</b> <b>1700</b> transmits a FCoE PLOGI frame <b>1705</b> to login to the Fabric Directory Servicer, FIA <b>1701</b> forwards the frame to the FIA Controller <b>1702</b>. The FIA Controller <b>1702</b> transmits a FCoE LS_ACC response <b>1706</b>. VN_Port<b>1</b> <b>1700</b> transmits a FCoE GID_FT name services query <b>1708</b> to the Name Server. FIA <b>1701</b> receives the frame and forwards it to the FIA Controller <b>1702</b> based on a previously assigned FME. The FIA Controller <b>1702</b> transmits a DevAttrReg request <b>1711</b> to the iSNS Server <b>1703</b> requesting information about a FC4-TYPEs of FCP which are in the Discovery Domain of VN_Port<b>1</b> <b>1700</b>. The iSNS Server <b>1703</b> returns a DevAttrReg response with a list of Fibre Channel port or address identifiers identifying which VN_Ports with the same FCP-TYPE are visible to VN_Port<b>1</b> <b>1700</b>. The FIA Controller <b>1702</b> translates the DevAttrReg response message <b>1713</b> into a FCoE LS_ACC message <b>1714</b> and transmits the message to the FIA <b>1701</b>. The FIA <b>1701</b> receives the message and forwards it to the VN_Port<b>1</b> <b>1700</b>. In this example, the FCoE LS_ACC response message <b>17</b> <b>14</b> contains the Fibre Channel address identifier for VN_Port<b>2</b> <b>1704</b>, VN_Port<b>1</b> <b>1700</b> transmits a FCoE PLOGI request message <b>1716</b> comprising the source Ethernet MAC address of VN_Port<b>1</b> (VN<b>1</b>MAC) <b>1716</b>, the destination Ethernet MAC address of the FIA Controller FCF-MAC address (FIACntlrMAC) <b>1702</b>, a destination Fibre Channel address identifier (DID) of VN_Port<b>2</b> (VN<b>2</b>FCID), and a source Fibre Channel address identifier (SID) of VN_Port<b>1</b> (VN<b>1</b>FCID) <b>1700</b>. FIA <b>1701</b> receives the FCoE PLOGI, substitutes the destination Ethernet. MAC address of VN_Port<b>2</b> (VN<b>2</b>MAC) <b>1704</b> and substitutes the source Ethernet MAC address of the FIA Controller FCF-MAC address (FIACntlrMAC) <b>1702</b> and forwards the frame to VN_Port<b>2</b> <b>1704</b>.</p>
<p id="p-0164" num="0215"><figref idref="DRAWINGS">FIG. 32</figref> is a ladder or sequence diagram showing the interconnection of two native Fibre Channel devices through FIAs with ports adapted to connect to Fibre Channel devices. FIA <b>1</b> <b>1801</b> and FIA <b>2</b> <b>1803</b> comprise ports adapted to connect to Fibre Channel devices <b>1805</b> <b>1807</b>. FIA <b>1</b> <b>1801</b> and FIA <b>2</b> <b>1803</b> also comprise ports adapted to connect to Ethernet <b>1806</b>. Fibre Channel Device <b>1</b> <b>1800</b> transmits a Fibre Channel FLOGI request frame <b>1808</b> to FIA<b>1</b> <b>1801</b>. The Fibre Channel FLOGI frame includes a destination Fibre Channel address identifier of the Directory Service (FFFFFCh), which is implemented within the FIA Controller <b>1802</b>. FIA <b>1</b> <b>1801</b> receives the Fibre Channel FLOGI frame, encapsulates it into a FCoE frame comprising a source Ethernet MAC address of the Fibre Channel Device (FCD<b>1</b>MAC) and destination Ethernet MAC address of the FIA Controller FCF-MAC address (FIACntlrMAC) <b>1802</b>. The Fibre Channel Device MAC address is assigned to the Fibre Channel Device <b>1800</b> and represents a virtual FCoE_Controller MAC address. This MAC address is only used internally for frames between FIAs and between FIA and FIA Controllers and is not used for FIA to Fibre Channel Device communications over a Fibre Channel link <b>1805</b> <b>1807</b>. FIA <b>1</b> <b>1801</b> forwards the FCoE encapsulated Fibre Channel FLOGI frame to the FIA Controller <b>1802</b>. The FIA Controller <b>1802</b> services the frame and returns a FIP LS_ACC response frame <b>1812</b> comprising the source Ethernet FCF-MAC address of the FIA Controller (FIACntrlMAC) <b>1802</b>, the destination Ethernet MAC address of the Fibre Channel Device (FCD<b>1</b>MAC), the source Fibre Channel address identifier of the Directory Service (FFFFFCh), and the newly assigned destination Fibre Channel address identifier of the Fibre Channel Device N_Port<b>1</b> (VN<b>1</b>FCID). FIA <b>1</b> <b>1801</b> receives the LS_ACC FCoE frame, decapsulates the frame into a Fibre Channel frame and transmits the Fibre Channel frame <b>1811</b> to Fibre Channel Device <b>1</b> <b>1800</b>. NPort<b>1</b> in Fibre Channel Device <b>1</b> <b>1800</b> transmits a Fibre Channel PLOGI request frame <b>1816</b>, addressed to N_Port<b>2</b> (FCD<b>2</b>FCID) <b>1804</b>. FIA <b>1</b> <b>1801</b> receives the Fibre Channel PLOGI frame, encapsulates the frame into a FCoE PLOGI frame <b>1818</b> comprising a source Ethernet MAC address of N_Port<b>1</b> (NP<b>1</b>MAC) <b>1800</b> and a destination Ethernet MAC address of N_Port<b>2</b> (NP<b>2</b>MAC) <b>1804</b>. FIA <b>1</b> <b>1801</b> then forwards the frame <b>1818</b> to FIA <b>2</b> <b>1803</b>. FIA <b>2</b> <b>1803</b> receives the frame, decapsulates the frame into a Fibre Channel frame and transmits the resulting frame <b>1820</b> to N_Port<b>2</b> in Fibre Channel Device <b>2</b> <b>1804</b>. N_Port<b>2</b> in Fibre Channel Device <b>2</b> <b>1804</b> transmits a Fibre Channel LS_ACC response frame <b>1821</b> to the Fibre Channel PLOGI frame. FIA <b>2</b> <b>1803</b> receives the frame, encapsulates the frame into a FCoE frame, comprising a source Ethernet MAC address of N_Port<b>2</b> (NP<b>2</b>MAC), a destination Ethernet MAC address of N_Port<b>1</b> (NP<b>1</b>MAC). FIA <b>2</b> <b>1803</b> transmits the frame to FIA <b>1</b> <b>1801</b>. FIA <b>1</b> <b>1801</b> decapsulates the FCoE frame into a Fibre Channel frame and transmits the Fibre Channel frame <b>1817</b> to N Port<b>1</b> in Fibre Channel Device <b>1</b> <b>1800</b>.</p>
<p id="p-0165" num="0216"><figref idref="DRAWINGS">FIG. 33</figref> is a ladder or sequence diagram showing the communication between a ENode and a Fibre Channel Device through FIAs. The connections between the ENode<b>1</b> <b>1850</b>, the FIA <b>1</b> <b>1851</b>, the FIA Controller <b>1852</b>, and at least one port in FIA <b>2</b> <b>1853</b> are Ethernet connections <b>1855</b>. The connection between FIA <b>2</b> <b>1853</b> and the Fibre Channel Device <b>1854</b> is a Fibre Channel connection <b>1856</b>, VN_Port<b>1</b> in ENode<b>1</b> <b>1850</b> transmits a FCoE PLOGI request <b>1857</b> frame comprising the source Ethernet MAC address of VN_Port<b>1</b> (VN<b>1</b>MAC) <b>1850</b>, destination Ethernet MAC address of N_Port<b>1</b> (NP<b>1</b>MAC, not used over Fibre Channel links), a destination Fibre Channel address identifier (DID) of N_Port<b>1</b> (NP<b>1</b>FCID), and a source Fibre Channel address identifier (SID) of VN_Port<b>1</b> (VN<b>1</b>FCID). FIA <b>1</b> <b>1851</b> receives the frame, replaces the source Ethernet MAC address with the FIA Controller FCF-MAC address (FIACntlrMAC) <b>1852</b> and replaces the destination Ethernet MAC address with N_Port<b>1</b>'s MAC address (NP<b>1</b>MAC), then transmits the frame <b>1858</b> to FIA <b>2</b> <b>1852</b>. FIA <b>2</b> <b>1852</b> receives the frame, decapsulates the frame into a Fibre Channel frame <b>1860</b> and transmits the Fibre Channel PLOGI frame to N_Port<b>1</b> in Fibre Channel Device <b>1</b> <b>1854</b>. N_Port<b>1</b> <b>1854</b> transmits a Fibre Channel LS_ACC frame to the PLOGI frame <b>1861</b>. FIA <b>2</b> <b>1852</b> receives the frame and encapsulates it into a FCoE LS_ACC frame, then transmits the frame <b>1864</b> to FIA <b>1</b> <b>1851</b>. FIA <b>1</b> <b>1851</b> receives the frame from FIA <b>2</b> <b>1852</b>, then forwards the frame to VN_Port<b>1</b> in ENode<b>1</b> <b>1850</b>.</p>
<p id="p-0166" num="0217"><figref idref="DRAWINGS">FIG. 34</figref> is a diagram showing multiple virtual connections between a ENodes, FIA, and FCFs. ENode<b>1</b> <b>1919</b> includes three VN_Ports, VN_Port<b>1</b> <b>1916</b>, VN_Port<b>2</b> <b>1917</b>, and VN_Port<b>3</b> <b>1918</b>. ENode<b>2</b> <b>1904</b> includes VN_Port<b>2</b> <b>1941</b>. VN_Port<b>2</b> <b>1917</b> is in a virtual connection over VID <b>20</b> <b>1914</b> with VN_Port<b>2</b> <b>1941</b> in ENode<b>2</b> <b>1904</b> connected through FIA <b>1903</b>. VN_Port<b>1</b> <b>1916</b> is in a virtual connection over VID <b>10</b> <b>1915</b> with VF_Port <b>1901</b> in FCF<b>1</b> <b>1900</b>. VN_Port<b>3</b> <b>1918</b> is in a virtual connection over VID <b>30</b> <b>1912</b> with VF_Port <b>1907</b> in FCF<b>2</b> <b>1906</b>. FCF<b>2</b> <b>1906</b> is connected to a Fibre Channel Switch <b>1908</b> which is in turn connected to <b>1910</b> FC Device<b>3</b> <b>1911</b>. VN_Port<b>3</b> <b>1918</b> communicates with FC Device<b>3</b> <b>1911</b> through the VF_Port <b>1907</b> in FCF<b>2</b> <b>1096</b>. Both VN_Port<b>1</b> <b>1916</b> and VN_Port<b>3</b> <b>1918</b> in ENode<b>1</b> <b>1919</b> communicate to FCF<b>1</b> <b>1900</b> and FCF<b>2</b> <b>1906</b> through the FIA <b>1903</b>. <figref idref="DRAWINGS">FIG. 34</figref> illustrates the capability of an FIA to forward FIP and FCoE frames in separate VID's between ENodes and FCF/FDFs. Further FIA <b>1903</b> can also restrict FIP discovery from select FCF/FDFs and from ENodes by a number of methods comprising but not limited to: filtering FIP Discovery Advertisements and FIP Discovery Solicitations by the source Ethernet MAC address or specific descriptors within the frame comprising: the priority, MAC address. Name_Identifier, and Fabric descriptors. FIA <b>1903</b> can also restrict FIP discovery to and from ENodes by selectively filtering FIP Discovery Advertisements and FIP Discovery Solicitations transmitted to and received from ENodes by a FIA.</p>
<p id="p-0167" num="0218"><figref idref="DRAWINGS">FIG. 35</figref> is a ladder or sequence diagram showing the FIP Discovery protocol exchange between an ENode, a FIA Controller, and a FCF. FIA Controller <b>2001</b> transmits a FIP Discovery Advertisement frame <b>2005</b> comprising the source Ethernet MAC address of the FIA Controller FCF-MAC address (FIACntlrMAC) <b>2006</b>, the destination Ethernet MAC address of All-ENode-MACs <b>2007</b>, a VID of <b>10</b> <b>2008</b>, a priority of <b>10</b> <b>2015</b> and a symbolic Name_Identifier of JedaNetworks. FIA <b>1</b> <b>2003</b> receives the frame and forwards it to ENode<b>1</b> <b>2000</b>. Enode<b>1</b> <b>2000</b> uses the information from the FIP Discovery Advertisement frame <b>2005</b> to build a list of available FCF-MACs <b>2034</b>. The list includes but is not limited to the FIA Controller FCF-MAC address (FIACntlrMAC), the priority, the VID <b>2035</b>. FCF<b>1</b> <b>2002</b> transmits a FIP Discovery Advertisement frame <b>2010</b> comprising the source Ethernet MAC address of the FCF (FCFMAC) <b>2011</b>, the destination Ethernet MAC address of All-ENode-MACs <b>2012</b>, a VID of <b>20</b> <b>2013</b>, a symbolic Name_Identifier of Sisco <b>2014</b> and a priority value of <b>12</b> <b>2017</b>. FIA <b>1</b> <b>2003</b> receives the frame and forwards it to ENode<b>1</b> <b>2000</b>. FIA <b>1</b> may also be configured to not forward the frame. Not forwarding the frame will isolate FCF<b>1</b> <b>2002</b> with ENode<b>1</b> <b>2000</b> which may be desirable. ENode<b>1</b> <b>2000</b> receives the forwarded FIP Discovery Advertisement frame <b>2010</b> and adds another entry into the ENode<b>1</b> FCF List <b>2028</b>. The entry <b>2037</b> includes but is not limited to the FCF MAC (FCFMAC), the priority <b>12</b>, and the VID <b>20</b>. ENode <b>1</b> <b>2000</b> responds to the first FIP Discovery Advertisement frame <b>2005</b> with a unicast FIP Solicitation frame <b>2020</b> comprising a destination Ethernet MAC address of the FIA Controller FCF-MAC address (FIACntlrMAC), a source Ethernet MAC address of the ENode<b>1</b> FCF-Controller MAC (ENode<b>1</b>MAC), and a VID of <b>10</b>. The frame is received by FIA <b>1</b> <b>2003</b> and forwarded to the FIA Controller <b>2001</b>. ENode <b>1</b> <b>2000</b> responds to the second FIP Discovery Advertisement frame <b>2010</b> with a unicast FIP Solicitation frame <b>2024</b> comprising a destination Ethernet MAC address of the FCF-MAC (FCFMAC), a source Ethernet. MAC address of the ENode<b>1</b> FCF Controller MAC (ENode<b>1</b> MAC), and a VID of <b>10</b>. The frame is received by FIA <b>1</b> <b>2003</b> and forwarded to the FIA Controller <b>2001</b>. A FIP Discover Advertisement frame <b>2015</b> with a VID <b>100</b> and a Name_Identifier of Saturn is transmitted from FCF<b>2</b> <b>2</b> <b>2004</b>. The FIP Discovery Advertisement is discarded <b>2039</b> by FIA<b>1</b> <b>2003</b> by a FME that identifies the specific FIP Discovery Advertisement frame. Discarding the FIP Discovery Advertisement will prevent the frame from reaching ENode<b>1</b> <b>2000</b> thereby isolating FCF<b>2</b> <b>2004</b> from ENode<b>1</b> <b>2000</b>. The resulting ENode<b>1</b> FCF List <b>2028</b> includes entries for all <b>2036</b> <b>2037</b> of the FCF-MACs, including the FCF<b>1</b> <b>2002</b> and FIA Controller <b>2001</b>. ENode<b>1</b> <b>2000</b> may login to all FCF-MACs including the FR Controller <b>2001</b> and the FCF <b>2002</b> and query the Name Servers. It is possible that the same device (ENode or Fibre Channel device) is in multiple Name Server tables in multiple Fabrics. ENode<b>1</b> <b>2000</b> may choose to login (PLOGI) to the device through the FCF or FIA Controller with the highest priority. This method allows for a single connection to a device that's resident in multiple Name Server tables. ENode<b>1</b> <b>2000</b> may also choose to login (PLOGI) to the device through lower priority FCF or FIA Controllers if the primary connection fails.</p>
<p id="p-0168" num="0219"><figref idref="DRAWINGS">FIG. 36</figref> is a diagram showing an ENode determining the path to a remote device. The ENode discovers that multiple FCF and/or FIA Controller's are reachable <b>2041</b>. The ENode logs into and queries all Name Servers <b>2042</b> coupled to the FCF-MACs. If a remove device (ENode) is reachable through a single FCF-MAC the ENode transmits a PLOGI to the remote device through the single FCF-MAC <b>2046</b>. If the target is reachable through more than one FCF-MAC the ENode sends a PLOGI to the FCF-MAC having the highest priority <b>2047</b> attribute from the previously received FIP Discovery Advertisement frame.</p>
<p id="p-0169" num="0220"><figref idref="DRAWINGS">FIG. 37</figref> is a diagram showing the generation of FMEs upon the receipt of a FIP FLOGI or FTP NPIV FDISC frame. The FIA Controller receives a FIP FLOGI or a FIP NPIV FDISC frame <b>2051</b>. The FIA Controller assigns a new MAC address and a new Fibre Channel address identifier <b>2052</b>. If the address assignment is not successful <b>2053</b>, a FIP LS_RJT response frame is transmitted <b>2056</b>. If the address assignment is successful <b>2054</b>, the FIA Controller sends a Frame Match Entry (FME) to all connected FIAs with a medium priority, the match fields comprising a source and destination Ethernet MAC address of any, a Ethernet Type of FCoE, a Fibre Channel destination address identifier (DID) of the newly assigned Fibre Channel address identifier (newFCID), and with an action comprising, substitute the source Ethernet MAC address with the FIA Controller FCF-MAC address (FIACntlrMAC), substitute the destination Ethernet MAC address with the newly assigned Fibre Channel MAC address (newMAC), and forward the frame. The Name Server is updated with the newly assigned addresses and any devices within the same Discovery Domains are notified of a change by transmitting a RSCN <b>2058</b>. The Access Control List Entries for the FIAs are updated <b>2059</b> and a FIP LS_ACC response frame is then transmitted <b>2057</b>.</p>
<p id="p-0170" num="0221"><figref idref="DRAWINGS">FIG. 38</figref> is a diagram showing the removal of FMEs upon the receipt of a FIP FLOGO frame. The FIA Controller receives a FIP FLOGO frame <b>2076</b>. The FIA Controller deassigns the specified MAC address and specified Fibre Channel address identifier <b>2077</b>. If the address de-assignment is not successful <b>2078</b>, a FIP LS_RJT response frame is transmitted <b>2081</b>. If the address de-assignment is successful <b>2078</b>, the FIA Controller sends a message to remove the Frame Match Entry (FME) to all connected FIAs that matches the priority, match fields, and actions of the specified FME <b>2080</b>. The Name Server is updated and RSCNs are transmitted for all devices in the same Discovery Domain <b>2107</b>. The access control list entries for all FIAs are updated <b>2108</b>. A FIP LS_ACC response frame is then transmitted <b>2082</b>.</p>
<p id="p-0171" num="0222">A myriad of frame forwarding methods can be used within FIAs. Since the forwarding function is separated from other FIA Controller functions any network available forwarding method can be used. This is different from FCF routing which uses the FSPF routing method. The forwarding and/or routing methods that a FIA can utilize includes but is not limited to STP, RSTP, MSTP, Shortest Path Bridging, MPLS, VPLS, TRILL, OSPF, BGP, RIP. IEEE 802.1aq Shortest Path Bridging and the IETF effort called Transparent Interconnection of Lots of Links (TRILL) have been created that mitigate the disadvantages of the Spanning Tree Protocol based forwarding methods.</p>
<p id="p-0172" num="0223">Routing Bridges or RBridges, have been created to implement the TRILL protocol. <figref idref="DRAWINGS">FIG. 39</figref> is a network diagram showing the interconnection of Router Bridges (RBridges) <b>2210</b> <b>2214</b>. The diagram shows a first RBridge, RBridge <b>1</b> <b>2210</b> connected <b>2211</b> to an Ethernet Cloud or network <b>2212</b> that is connected <b>2213</b> to a second RBridge, RBridge <b>2</b> <b>2214</b>. RBridges can be interconnected using any layer <b>2</b> technology such as IEEE 802.3, shown in <figref idref="DRAWINGS">FIG. 40</figref> or some other link technology such as PPP, see RFC1661. The Ethernet Cloud or network <b>2212</b> may include but not be limited to hubs, point-to-point or shared media, IEEE 802.1D bridges, 802.1Q bridges, or metropolitan area networks such as those described by the Provider Backbone Bridge Traffic Engineering (PB B-TE) networking standard, IEEE 802.1Qay-2009 or Provider Backbone Bridges (PBB), IEEE 802.1ah, RBridge ports make use of IEEE 802.1Q port VLAN and priority processing. In addition, the Ethernet Cloud <b>2212</b> may implement other lower level 802.1 protocols as well as protocols for the link in use, such as PAUSE, Priority Based Flow control, port based access control (802.1X), MAC security (802.1AE), or link aggregation (802.1AX),</p>
<p id="p-0173" num="0224"><figref idref="DRAWINGS">FIG. 40</figref> is a diagram showing the frame format for an Ethernet <b>2230</b> and PPP <b>2236</b> encapsulated Transparent Interconnection of Lots of Links (TRILL) frame. Although description and examples provided here will describe the Ethernet encapsulation <b>2230</b>, those in the art will easily see the implementation over PPP <b>2236</b> and other communications protocols. The Inner Ethernet Header <b>2233</b> and the Ethernet Payload <b>2234</b> come from the original frame and are encapsulated with a TRILL Header <b>2232</b> and an outer Ethernet header <b>2231</b> they travel between RBridges. Use of the TRILL header <b>2232</b> addresses many disadvantages of spanning tree and other forwarding methods by mitigating loops through the use of a hop count field, eliminates the need for end station VLAN and MAC address learning in transit RBridges, directs unicast frames towards the egress RBridge which enables unicast forwarding tables of transit RBridges to be sized with the number of RBridges rather than the total number of end nodes, and finally provides a separate VLAN tag for forwarding traffic between Midges, independent of the VLAN of the native frame. When forwarding unicast frames between RBridges, the outer header <b>2231</b> has the MAC destination address of the next hop RBridge, to avoid frame duplication if the inter-RBridge link is multi-access. This also enables multipathing of unicast frames since the transmitting RBridge can specify the next hop. Having the outer Ethernet header <b>2231</b> specify the transmitting RBridge as the source address ensures that any bridges inside the Ethernet cloud will not get confused, as they might be if multipathing is in use and they were to see the original source or ingress RBridge in the outer header.</p>
<p id="p-0174" num="0225"><figref idref="DRAWINGS">FIG. 41</figref> shows a representative RBridge Port Model <b>2457</b> in more detail. The RBridge Port Model <b>2457</b> assumes connection to an IEEE 802.3 Link <b>2464</b>. An RBridge port can be modeled as having a lower level structure similar to that of an IEEE 802.1Q-2005 bridge port. An actual RBridge port implementation may be structured in any way that provides the correct behavior. Low level control frames are handled in the lower level port/link control logic <b>2462</b> in the same way as in an 802.1Q-2005 bridge port. This may include but not be limited to a variety of 802.1 or link specific protocols such as PAUSE (Annex 31B of 802.3), FTC (802.1Qbb, 802.3bd), link layer discovery (802.1AB), link aggregation (802.1AX), MAC security (802.1AE), or port based access control (802.1X). While handled at a low level, these frames may affect higher level processing. Higher-level control frames such as BPDUs and, if supported, VRP frames are not VLAN tagged and are handled by the RBridge BPDU Processing <b>2460</b> and RBridge VRP Processing <b>2461</b> blocks. The upper interface <b>2470</b> to the 802.1/802.3 Low Level Control Frame Processing, Port/Link Control Logic block <b>2462</b> corresponds to the Internal Sublayer Service (ISS) in IEEE 802.1Q. The upper interface <b>2469</b> to the 802.1Q-2005 Port VLAN &#x26; Priority Processing block <b>2466</b> corresponds to the Extended Internal Sublayer Service (EISS) in IEEE 802.1Q. The dotted lines indicate control only traffic <b>2474</b><i>a </i><b>2474</b><i>b </i><b>2474</b><i>c </i><b>2474</b><i>d</i>. The Higher Layer Entities <b>2467</b> may include but not be limited to the inter-port forwarding process, the IS-IS link state protocol, the RBridge manager.</p>
<p id="p-0175" num="0226"><figref idref="DRAWINGS">FIG. 42</figref> is a diagram of a TRILL RBridge with the addition of FIA Process and FIA Switch Client capability. The RBridge Model in <figref idref="DRAWINGS">FIG. 41</figref> has been modified <b>2595</b> <b>2500</b> to result in a FIA RBridge Port <b>2590</b>, which combines the advantages of bridges and routers and is the application of link state routing to the VLAN-aware customer-bridging problem. Each RBridge port <b>2592</b> can be coupled to one or more ENodes. The FIA Process delivers and accepts frames to and from the 802.1Q Port VLAN &#x26; Priority Processing block <b>3194</b>, the RBridge Appointed Forwarder and Inhibition Logic <b>2584</b>, the RBridge Relay Entity and Higher Layer Entities which may include but be limited to the FIA Manager <b>3202</b>, the System manager, link state protocol, RBridge manager <b>2580</b>. Further, <figref idref="DRAWINGS">FIG. 42</figref> is only one example of an implementation.</p>
<p id="p-0176" num="0227"><figref idref="DRAWINGS">FIG. 43</figref> is a diagram showing a FCoE frame <b>2620</b> sent from an Ethernet connected ENode <b>2629</b> through a network of RBridge FIAs <b>2628</b> <b>2627</b> <b>2630</b> to a destination Ethernet connected ENode <b>2631</b> over a TRILL Ethernet network <b>2626</b>. FIA<b>1</b> <b>2628</b>, FIA<b>2</b> <b>2627</b>, and FIA<b>3</b> <b>2630</b> form an Ethernet TRILL network <b>2626</b>. The links from FIA<b>1</b> <b>2628</b> to ENode <b>1</b> <b>2629</b> and from FIA<b>3</b> to ENode<b>2</b> <b>2631</b> are Ethernet links <b>2652</b>. The FCoE frame transmitted <b>2620</b> from VN_Port<b>1</b> <b>2650</b> in ENode<b>1</b> <b>2629</b> includes the following values: Ethernet destination MAC address of the FIA Controller FCF_MAC address (FIACntlrMAC) <b>2625</b>, Ethernet source MAC address of VN_Port<b>1</b> (VN_Port<b>1</b>MAC) <b>2650</b>, a VID <b>2623</b>, data <b>2622</b>, and an FCS <b>2621</b>. FIA<b>1</b> <b>2628</b> substitutes the destination MAC address with VN_Port<b>2</b>s MAC address (VN_Port<b>2</b>MAC) <b>2615</b> and substitutes the source MAC address with the FIA Controller FCF-MAC address (FIACntlrMAC) <b>2614</b>. After substituting the destination Ethernet address <b>2615</b>, FIA<b>1</b> <b>2628</b> encapsulates the frame in a TRILL frame. The outer destination Ethernet MAC <b>2619</b> address contains the value of the next hop FIA MAC address, in this case the symbolic MAC address FIA<b>2</b>MAC <b>2619</b>. The outer source Ethernet MAC address <b>2618</b> contains the value of the current FIA MAC address, in this case the symbolic MAC address FIA<b>1</b>MAC. The frame is received by FIA<b>2</b> <b>2627</b> and the outer destination Ethernet MAC address <b>2641</b> is changed to be the next hop, in this case FIA<b>3</b> <b>2630</b> and its symbolic Ethernet MAC address FIA<b>3</b>MAC <b>2641</b>. The outer source Ethernet MAC address <b>2640</b> is changed to be FIA<b>2</b>s MAC address, in this case FIA<b>2</b>MAC <b>2640</b>. The frame <b>2632</b> is then received by FIA<b>3</b> <b>2630</b>, the TRILL header is removed and transmitted to VN_Port<b>2</b> <b>2651</b> in ENode<b>2</b> <b>2631</b>.</p>
<p id="p-0177" num="0228"><figref idref="DRAWINGS">FIG. 44</figref> is a diagram showing a Fibre Channel frame sent from a Fibre Channel connected device through a network of FIAs to a destination Fibre Channel connected device. FIA<b>1</b> <b>2788</b>, FIA<b>2</b> <b>2787</b>, and FIA<b>3</b> <b>2789</b> form a TRILL Ethernet network. The links between FIA<b>1</b> <b>2788</b> and Fibre Channel Device<b>1</b> <b>2791</b> and between FIA<b>3</b> <b>2789</b> and Fibre Channel Device<b>2</b> <b>2792</b> are Fibre Channel links, The Fibre Channel frame transmitted <b>2780</b> from Fibre Channel Device<b>1</b> <b>2791</b> to FIA<b>1</b> <b>2788</b> contains Fibre Channel Device<b>2</b>'s <b>2792</b> address identifier <b>2710</b> of 02.02.02 as the destination address identifier <b>2784</b> and as the source address identifier 01.01.01 2783 that of Fibre Channel Device<b>1</b>'s <b>2791</b> N_Port<b>1</b> ID <b>2709</b>. FIA<b>1</b> <b>2788</b> encapsulates the frame <b>2780</b> in a FCoE header and a TRILL encapsulation over Ethernet frame <b>2779</b> <b>2778</b> <b>2777</b> <b>2776</b>. The resulting frame <b>2770</b> includes an inner destination Ethernet MAC address <b>2775</b> that is the MAC address of given by the FIA Controller to N_Port<b>2</b> <b>2710</b> in Fibre Channel Device<b>2</b> <b>2792</b>. Note that this MAC address is only valid internally to the FIAs. The inner source Ethernet MAC address <b>2774</b> is the Ethernet MAC address of the FIA Controller FCF-MAC address (FIACntlrMAC). The outer destination Ethernet MAC address <b>2779</b> is the Ethernet MAC address of FIA<b>2</b> <b>2787</b>, the outer source Ethernet MAC address <b>2778</b> is the Ethernet MAC address of FIA<b>1</b> <b>2788</b>. The outer Ethernet addresses <b>2778</b> <b>2779</b> follows the TRILL method of using RBridge hop to RBridge hop forwarding. When the frame is received from FIA<b>2</b> <b>2787</b> it is forwarded to FIA<b>3</b> <b>2789</b> after the following modifications. The outer Ethernet destination MAC address <b>2702</b> is changed to FIA<b>3</b>s <b>2789</b> MAC address, the outer Ethernet source MAC address <b>2701</b> is changed to FIA<b>2</b>s <b>2787</b> MAC address. When the frame arrives at FIA<b>3</b> <b>2789</b>, the TRILL frame is decapsulated into a FCoE frame <b>2703</b>, which is also decapsulated into the native Fibre Channel frame. The resulting Fibre Channel frame is transmitted to N_Port<b>2</b> <b>2710</b> in Fibre Channel Device<b>2</b> <b>2792</b>, Note for each hop through a TRILL network a new FCS is calculated <b>2771</b> <b>2794</b>.</p>
<p id="p-0178" num="0229">Shortest Path Bridging (SPB) is an IEEE draft (802.1aq) that may be included in the 802.1Q standard. There are two SPB models for multipath bridging: Shortest Path Bridging VLAN (SPBV) and Shortest Path Bridging MAC-in-MAC (SPBM). <figref idref="DRAWINGS">FIG. 45</figref> is a diagram showing the interconnection of ENodes through a Shortest Path Bridging MAC-in-MAC (SPBM) network <b>2814</b>. A FCoE frame <b>2820</b> sent from an Ethernet connected ENode <b>2818</b> through a network of FIA adapted to implement Shortest Path Bridging <b>2816</b> <b>2815</b> <b>2817</b> to a destination Ethernet connected ENode <b>282</b>.<b>1</b> over a SPBM network <b>2814</b>. FIA <b>1</b> <b>2816</b>, FIA<b>2</b> <b>2815</b>, and FIA<b>3</b> <b>2817</b> form a SPBM <b>2814</b>. The links from FIA<b>1</b> <b>2816</b> to ENode<b>1</b> <b>2818</b> and from FIA<b>3</b> <b>2817</b> to ENode<b>2</b> <b>2821</b> are Ethernet links <b>2820</b>. The FCoE frame transmitted <b>2808</b> from VN_Port<b>1</b> <b>2819</b> in ENode<b>1</b> <b>2818</b> includes the following values: Ethernet destination FCF-MAC address of the FIA Controller (FIACntlrMAC) <b>2813</b>, Ethernet source MAC address of VN_Port<b>1</b> (VN_Port<b>1</b>MAC) <b>2812</b>, a VID <b>2811</b>, data <b>2810</b>, and an FCS <b>2809</b>. FIA<b>1</b> <b>2816</b> substitutes the destination MAC address with VN_Port<b>2</b>'s MAC address (VN_Port<b>2</b>MAC) <b>2805</b> and substitutes the source MAC address with the FIA Controller FCF-MAC address (FIACntlrMAC) <b>2804</b>. After substituting the destination Ethernet address <b>2807</b>, FIA<b>1</b> <b>2816</b> encapsulates the frame in a SPBM frame, i.e., adds a MAC-in-MAC header. The outer destination Ethernet MAC <b>2619</b> address contains the value of the egress FIA MAC address, in this case the symbolic MAC address FIA<b>3</b>MAC <b>2817</b>. The outer source Ethernet. MAC address <b>2806</b> contains the value of the current FIA MAC address, in this case the symbolic MAC address FIA<b>1</b>MAC. The frame is received by FIA<b>2</b> <b>2815</b> and forwarded to the egress FIA, FIA<b>3</b> <b>2817</b>. FIA<b>3</b> <b>2817</b> removes the outer MAC header and forwards the frame to VN_Port<b>2</b> <b>2651</b> in ENode<b>2</b> <b>2631</b> with the inner source and destination Ethernet MAC addresses unchanged. The Shortest Path Bridging network in <figref idref="DRAWINGS">FIG. 44</figref> can be adapted to use Shortest Path Bridging VLAN (SPBV) in lieu of SPBM by using the Shortest Path VLAN ID (SPVID) to designate nodal reachability.</p>
<p id="p-0179" num="0230"><figref idref="DRAWINGS">FIG. 46</figref> is a diagram showing a source and destination Ethernet MAC address replacement logic. Certain fields from the incoming frame are loaded into received frame registers <b>3000</b>. The fields include the source Ethernet MAC address <b>3001</b>, the Ethernet TYPE <b>3002</b>, the Fibre Channel destination address identifier (FC DID) <b>3003</b>, and the destination Ethernet MAC address (Ethernet DA) <b>3005</b>. The Ethernet TYPE field <b>3002</b> is compared to <b>3011</b> the FCoE_TYPE <b>3010</b> value in the Ethernet TYPE Register <b>3009</b>. If the values are equal a Read EN signal <b>3012</b> is asserted and used as a buffer enable to the data output <b>3007</b> of the FCID to MAC Lookup Table <b>3004</b> and an input into the Source MAC Substitution FSM <b>3014</b>. The Source MAC Substitution FSM <b>3014</b> takes another signal, the entry_found signal from the MAC lookup table <b>3015</b> to select <b>3020</b> by a multiplexer <b>3023</b> either the FIA Controller MAC <b>3013</b> or the received source Ethernet MAC address for insertion into the source Ethernet MAC address in the outgoing frame <b>3022</b>. The FC DID field in the received frame is used as an address <b>3008</b> to lookup the assigned VN_Port MAC address <b>3006</b> in the FCID to MAC Lookup Table <b>3004</b>. If an entry is found, the entry_found signal <b>3015</b> is asserted, and the VN_Port MAC buffer <b>3016</b> contains the matched VN_Port MAC address that corresponds to the Fibre Channel address identifier. The Destination MAC Substitution FSM <b>3019</b> selects which MAC address to use <b>3017</b>, either the received Ethernet DA or the matched VN_Port MAC address, to insert into the Destination Ethernet MAC address register <b>3018</b>.</p>
<p id="p-0180" num="0231"><figref idref="DRAWINGS">FIG. 47</figref> is a diagram showing the migration of a Virtual Machine from a server connected to a FIA to another server connected to another FIA. Virtual Machine <b>1</b> (VM<b>1</b>) <b>4004</b> in Server<b>1</b> <b>4005</b> is migrated <b>4008</b> to Server<b>2</b> <b>4007</b>. Server<b>1</b> <b>4005</b> is connected to FIA<b>1</b> <b>4001</b>. FIA<b>1</b> <b>4001</b> is connected to the FIA Controller <b>4000</b>, FIA<b>1</b> is also connected to FIA<b>2</b> <b>4002</b>. FIA<b>2</b> <b>4002</b> is connected to FIA<b>3</b> <b>4003</b>. FIA<b>3</b> is connected to Server<b>2</b> <b>4007</b>. The steps involved in migrating VM<b>1</b> <b>4004</b> are further described. The hypervisor control apparatus in Server<b>1</b> <b>4005</b> signals the FIA Controller <b>4000</b> of the impending migration and that VM<b>1</b> <b>4004</b> has been temporarily suspended. Since both the MAC and Fibre Channel address identifier assignments for VN_Ports are centrally assigned and managed by the FIA Controller <b>4000</b>, no address reassignment needs to be accomplished. After signaled by the hypervisor control apparatus in Server<b>1</b> <b>4005</b>, the FIA Controller <b>4000</b> sends messages to all FIAs <b>4001</b> <b>4002</b> <b>4003</b> to remove the MAC address assigned to VM<b>1</b> <b>4005</b> from its forwarding tables. Clearing the forwarding tables cause the forwarding paths or routes to be recalculated. If the FIA is an Ethernet Bridge, the forwarding table is the Filtering Database, <figref idref="DRAWINGS">FIG. 10</figref> <b>403</b>. The FIA Controller <b>4000</b> then responds to the hypervisor control apparatus that VM<b>1</b> <b>4004</b> migration <b>4008</b> to Server<b>2</b> <b>4007</b> is clear to proceed.</p>
<p id="p-0181" num="0232"><figref idref="DRAWINGS">FIG. 48</figref> is a diagram showing a distributed MAC deployment. The diagram shows four FIACs, <b>4100</b> <b>4101</b> <b>4103</b> <b>4104</b> and a central FIAC Datastore <b>4102</b>. The FIAC Central Datastore <b>4102</b> is the central storage for certain FIAC information. The diagram also shows two core FIA's, FIA<b>51</b> <b>4105</b> and FIA<b>52</b> <b>4106</b>, which interconnect all FIAC's <b>4100</b> <b>4101</b> <b>4103</b> <b>4104</b>, the FIAC Central Datastore <b>4102</b>, and the forty FIA's which include FIA<b>1</b> <b>4107</b> through <b>4026</b> FIA<b>20</b> <b>4108</b> and FIA<b>21</b> <b>4109</b> through <b>4027</b> FIA<b>40</b> <b>4110</b>. There are also redundant connections <b>4019</b> between FIA<b>51</b> <b>4105</b> and FIA<b>52</b> <b>4106</b>. Links <b>4020</b> <b>4021</b> <b>4022</b> <b>4023</b> <b>4024</b> <b>4025</b> and <b>4019</b> may be Ethernet links. Each FIA connects a plurality of ENodes. For example, FIA<b>1</b> <b>4107</b> connects <b>4022</b> to ENode<b>1</b> <b>4111</b> through ENode<b>20</b> <b>4112</b>, ENode<b>2</b> through ENode<b>19</b> are not shown. FIA<b>20</b> <b>4108</b> connects <b>4023</b> to ENode<b>1000</b> <b>4113</b> through ENode<b>1050</b> <b>4114</b>, ENode<b>1001</b> through ENode<b>1049</b> are not shown. FIA<b>21</b> <b>4109</b> connects <b>4024</b> to ENode<b>1051</b> <b>4115</b> through ENode<b>1</b>.<b>100</b> <b>4116</b>, ENode<b>1052</b> through ENode<b>1099</b> are not shown. FIA<b>40</b> <b>4110</b> connects <b>4025</b> to ENode<b>2000</b> <b>4117</b> through ENode<b>2050</b> <b>4118</b>, ENode<b>2001</b> through ENode<b>2049</b> are not shown. The FIAC's divide management of the FIAs. FIAC<b>1</b> <b>4100</b> manages FIA<b>1</b> <b>4107</b> through FIA<b>10</b> (not shown). FIAC<b>2</b> <b>4101</b> manages FIA<b>11</b> (not shown) through FIA<b>20</b> <b>4108</b>. FIAC<b>3</b> <b>4103</b> manages FIA<b>21</b> <b>4109</b> through FIA<b>30</b> (not shown). FIAC<b>4</b> <b>4104</b> manages FIA<b>31</b> (not shown) through FIA<b>40</b> <b>4110</b>. An FIAC manages a subset of FIA's, which allows a network to scale to a large number of supported ENodes by adding FIAC's. FIA management may include but not be limited to controlling the FIA FME and ACLE tables and responding to FIP and certain FCoE frames. For example, the FIA's forward FIP FLOGI frames to the FCF-MAC of the controlling FIAC. The FIAC's synchronize with each other through the FIAC Central Datastore <b>4102</b>. the FIAC Central Datastore <b>4102</b> may be implemented by the following: a relational database, an object store database, in memory storage, and a filesystem. If the FIAC Central Datastore <b>4102</b> is implemented by a relational database then access to the database can support Structured Query Language (SQL), which supports data insert, query, update, delete, schema creation and modification, and data access control.</p>
<p id="p-0182" num="0233">Although the foregoing invention has been described in some detail by way of illustration and example for purposes of clarity and understanding, it may be readily apparent to those of ordinary skill in the art in light of the teachings of this invention that certain changes and modifications may be made thereto without departing from the spirit or scope of the appended</p>
<p id="p-0183" num="0234">All publications and patents cited in this specification are herein incorporated by reference as if each individual publication or patent were specifically and individually indicated to be incorporated by reference in their entirety.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for forwarding Fibre Channel Initialization Protocol (FIP) and Fibre Channel over Ethernet (FCoE) frames with a FCoE device interconnection apparatus (FIA) from a source FCoE device to a destination FCoE device, the method comprising:
<claim-text>receiving the FIP frame from the source FCoE device by the FIA, the FIP frame including destination Ethernet MAC address and source Ethernet MAC addresses, the FIA being capable of substituting destination and source Ethernet MAC addresses,</claim-text>
<claim-text>forwarding the received FIP frame to a FCoE device interconnection apparatus controller (FIAC) over an Ethernet link, whereby the FIAC processes the FIP Frame and the FIAC returns a FIP link service accept (LS_ACC) or a FIP link service reject (LS_RJT) frame,</claim-text>
<claim-text>receiving the FCoE frame by the FIA from the source FCoE device, the FCoE frame including destination Ethernet MAC address and source Ethernet MAC addresses,</claim-text>
<claim-text>replacing the destination Ethernet MAC address and source Ethernet MAC addresses of the received FCoE frame and maintaining the contents of the encapsulated Fibre Channel Frame within the received FCoE frame, and</claim-text>
<claim-text>forwarding the received FCoE frame with the replaced destination Ethernet MAC address and the replaced source Ethernet MAC address to the destination FCoE device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the destination Ethernet MAC address of the received FCoE frame is replaced by the MAC address assigned to the remote FCoE device VN_Port, the remote FCoE device VN_Port identified by the Fibre Channel destination address identifier in the embedded Fibre Channel Frame of the received FCoE frame.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the replaced source Ethernet MAC address of the received FCoE frame is the FCoE Forwarder MAC (FCF-MAC) address of the FIAC.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the destination Ethernet MAC address in the received FCoE frame is the FCF-MAC address of the FIAC.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the FIA comprises one or more of the following: an Ethernet Switch, an Ethernet Bridge, a Virtual Switch, a switch embedded in a Server, a switch embedded in a Storage System, and a switch embedded in a Converged Network Adapter (CNA).</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. An apparatus for interconnecting a plurality of ports for forwarding received Fibre Channel Initialization (FIP) and Fibre Channel over Ethernet (FCoE) frames between the ports, the apparatus comprising:
<claim-text>a first port adapted to transmit and receive FIP and FCoE frames,</claim-text>
<claim-text>a second port adapted to transmit and receive FIP and FCoE frames,</claim-text>
<claim-text>a connectivity apparatus, the connectivity apparatus disposed between and coupled to the first port and the second port, the connectivity apparatus forwarding frames between the first and second ports,</claim-text>
<claim-text>a destination Ethernet MAC address replacement apparatus,</claim-text>
<claim-text>a source Ethernet MAC address replacement apparatus,</claim-text>
<claim-text>a Ethernet Type field match apparatus,</claim-text>
<claim-text>storage, the storage containing the FCoE Forwarder MAC (FCF-MAC) address from a FCoE device interconnection apparatus controller (FIAC), and</claim-text>
<claim-text>a frame processing apparatus, the frame processing apparatus configured to identify one or more FCoE frames and signal the destination and source Ethernet MAC address replacement apparatus to replace the source and destination Ethernet MAC addresses in an incoming frame but maintaining the contents of the encapsulated Fibre Channel frame within the received FCoE frame, the frame processing apparatus further configured to identify FIP frames and forward the FIP frames and FCoE frames to the connectivity apparatus to be forwarded out an egress port.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The apparatus of <claim-ref idref="CLM-00006">claim 6</claim-ref> further including incoming frame field matching storage.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The apparatus of <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein the incoming field matching storage utilizes one or more of the following; Fibre Channel address identifiers, MAC addresses, Virtual Local Area Network Identifiers, egress port and egress port group.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The apparatus of <claim-ref idref="CLM-00006">claim 6</claim-ref> wherein the source Ethernet MAC address replacement apparatus replaces an incoming frame source Ethernet MAC address with the MAC address in storage.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The apparatus of <claim-ref idref="CLM-00006">claim 6</claim-ref> wherein the frame processing apparatus is configured to forward the FCoE frames containing Fibre Channel Fabric Services destination address identifiers to the connectivity apparatus with the original source and destination Ethernet MAC addresses in a received FCoE frame.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The apparatus of <claim-ref idref="CLM-00006">claim 6</claim-ref> wherein the frame processing apparatus forwards the FIP frames with the destination Ethernet MAC address including one or more of the following: the group address for all ENodes (All-ENode MACs) and the group address for all FCoE devices (All-FCF-MAC) MAC addresses.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The apparatus of <claim-ref idref="CLM-00006">claim 6</claim-ref> further including a third port, the third port adapted to transmit and receive Fibre Channel frames, encapsulate Fibre Channel frames into FCoE frames before forwarding from the third port to the connectivity apparatus and decapsulate from FCoE frames into Fibre Channel frames for frames received from the connectivity apparatus.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A system for interconnecting Fibre Channel over Ethernet (FCoE) devices, comprising:
<claim-text>a first FCoE device,</claim-text>
<claim-text>a second FCoE device,</claim-text>
<claim-text>a FCoE device interconnection apparatus (FIA) including;
<claim-text>a first port adapted to transmit and receive Fibre Channel Initialization Protocol (FIP) and FCoE frames, the first FCoE device being coupled to the first port of the FIA,</claim-text>
<claim-text>a second port adapted to transmit and receive FIP and FCoE frames, the second FCoE device being coupled to the second port of the FIA,</claim-text>
<claim-text>a third port adapted to transmit and receive FIP, FCoE, and IP frames,</claim-text>
<claim-text>a connectivity apparatus, the connectivity apparatus disposed between and coupled to the first, second and third ports, the connectivity apparatus forwarding Ethernet frames,</claim-text>
<claim-text>a source Ethernet MAC address replacement apparatus,</claim-text>
<claim-text>a destination Ethernet MAC address replacement apparatus, and</claim-text>
</claim-text>
<claim-text>a frame processing apparatus, the frame processing apparatus configured to identify FIP frames and forward the FIP frames to the connectivity apparatus with the original source and destination Ethernet MAC addresses, identify FCoE frames and signal the source and destination Ethernet MAC address replacement apparatus to replace the source and destination Ethernet MAC addresses but maintaining the contents of the encapsulated Fibre Channel frame within the received FCoE frame, and</claim-text>
<claim-text>a FCoE device interconnection apparatus controller (FIAC) including a first port adapted to transmit and receive FIP, FCoE and IP frames, and the first port of the FIAC being coupled to the third port of the FIA.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The system of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein the source Ethernet MAC address replacement apparatus replaces the source Ethernet MAC address of incoming FCoE frames from a port with the Ethernet FCoE Forwarder MAC (FCF-MAC) address of the FIAC.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The system of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein a FIP frame is identified by the frame processing apparatus in the FIA, forwarded to the FIAC with the original source and destination Ethernet MAC addresses, the FIAC receiving and processing the FIP frame.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The system of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein a FCoE frame with an embedded Fibre Channel destination identifier of a Fabric Controller is identified by the frame processing apparatus in the FIA, the FCoE frame being forwarded to the FIAC with the original source and destination Ethernet MAC addresses, the FIAC receiving and processing the FCoE frame.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The system of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein a FCoE frame is identified by the frame processing apparatus in the FIA, the source Ethernet MAC address being replaced by the source Ethernet MAC address replacement apparatus, the destination Ethernet MAC address replaced by the destination Ethernet MAC address replacement apparatus, the resulting FCoE frame being transmitted out the second port to the second FCoE device.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The system of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein the FIA further includes a fourth port, the fourth port adapted to transmit and receive Fibre Channel frames, the fourth port coupled to the connectivity apparatus, a Fibre Channel device, the Fibre Channel device coupled to the fourth port.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The system of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein the FIA further includes a fourth and fifth port, the fourth and fifth ports adapted to transmit and receive Fibre Channel frames and coupled to the connectivity apparatus.</claim-text>
</claim>
</claims>
</us-patent-grant>
