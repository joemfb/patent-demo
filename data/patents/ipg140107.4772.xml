<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625865-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625865</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12937717</doc-number>
<date>20080417</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>260</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>382128</main-classification>
</classification-national>
<invention-title id="d2e53">Method and apparatus for navigating a therapeutic device to a location</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>7010080</doc-number>
<kind>B2</kind>
<name>Mitschke</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2003/0197734</doc-number>
<kind>A1</kind>
<name>Binkert et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345771</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2005/0107688</doc-number>
<kind>A1</kind>
<name>Strommer</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2005/0182319</doc-number>
<kind>A1</kind>
<name>Glossop</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2008/0095421</doc-number>
<kind>A1</kind>
<name>Sun et al.</name>
<date>20080400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382131</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>DE</country>
<doc-number>10 2005 059804</doc-number>
<date>20070700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00007">
<othercit>Michael Zarkh, Moshe Klaiman. &#x201c;Guide wire navigation and therapeutic device localization for catheterization procedure,&#x201d; International Congress Series, vol. 1281, May 2005, pp. 311-316.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
</us-references-cited>
<number-of-claims>19</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>10</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110033094</doc-number>
<kind>A1</kind>
<date>20110210</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Zarkh</last-name>
<first-name>Michael</first-name>
<address>
<city>Giv'at Shmuel</city>
<country>IL</country>
</address>
</addressbook>
<residence>
<country>IL</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Blumenfeld</last-name>
<first-name>Amir</first-name>
<address>
<city>Tel Aviv</city>
<country>IL</country>
</address>
</addressbook>
<residence>
<country>IL</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Klaiman</last-name>
<first-name>Moshe</first-name>
<address>
<city>Gadera</city>
<country>IL</country>
</address>
</addressbook>
<residence>
<country>IL</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Zarkh</last-name>
<first-name>Michael</first-name>
<address>
<city>Giv'at Shmuel</city>
<country>IL</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Blumenfeld</last-name>
<first-name>Amir</first-name>
<address>
<city>Tel Aviv</city>
<country>IL</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Klaiman</last-name>
<first-name>Moshe</first-name>
<address>
<city>Gadera</city>
<country>IL</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Soroker-Agmon</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Paieon Inc.</orgname>
<role>02</role>
<address>
<city>New York</city>
<state>NY</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Patel</last-name>
<first-name>Nirav G</first-name>
<department>2665</department>
</primary-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/IL2008/000526</doc-number>
<kind>00</kind>
<date>20080417</date>
</document-id>
<us-371c124-date>
<date>20101014</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO2009/144697</doc-number>
<kind>A </kind>
<date>20091203</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method and apparatus for navigating a therapeutic device to a location in a moving organ. A feature is identified in one reference image, such as a calcified spot. Then the target location for the device is determined. If the feature and the target location are not shown on the same frame, registration is performed, and the geometric relation between the feature and the target location is determined. On the positioning stage, the feature is identified in a positioning image, then the target location is indicated on the image. The user then manipulates the device, also visible on the positioning image to the target location. If the feature is not identified automatically in the positioning image, the target location is assumed at the current location, and the feature is marked, which assists the user in identifying the real location of the feature, and manipulating the device to the target location.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="231.99mm" wi="164.51mm" file="US08625865-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="268.56mm" wi="186.61mm" file="US08625865-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="251.80mm" wi="145.29mm" file="US08625865-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="264.75mm" wi="180.34mm" file="US08625865-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="258.91mm" wi="164.25mm" file="US08625865-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="234.95mm" wi="177.21mm" file="US08625865-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">TECHNICAL FIELD</heading>
<p id="p-0002" num="0001">The present disclosure relates to medical imaging in general, and to a method and apparatus for navigating a therapeutic device to a location, in particular.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">Intravascular device positioning, including navigating the device to its target location and deploying the device at the target location is generally performed under imaging by one of several imaging modalities. A modality commonly used for this purpose is X-ray angiography. The target location for positioning the device is usually seen well when contrast material is injected into the vessel, making the vessels clearly distinguishable. However, each contrast injection exposes the target for only a few seconds, and repeated injections are considered damaging as contrast material is harmful for the kidneys, and excessive radiation is unsafe for the whole body. Moreover, on some procedures and for some kinds of therapeutic devices, the contrast material hides the therapeutic device, making assessment of the device location and thus navigating the device to the required location difficult.</p>
<p id="p-0004" num="0003">The positioning task is especially difficult for moving organs. For example the heart is subject to its own cyclic motion, breathing, and patient or bed movements. These movements make positioning even more difficult.</p>
<p id="p-0005" num="0004">Several positioning solutions have been introduced for positioning a device. Some systems, such as International Patent Application published as US2006/0058647, use dedicated equipment based on optical, electromagnetic, or ultrasonic principles for localizing the device. These methods, when applicable, require a complicated calibration procedure. An added modality considerably increases the overall complexity and cost of the procedure. International patent application publication WO 06/103644 discloses a method for registration between an image showing a device using X-Ray and a reference image showing the vessel and the target location, and presenting the device on this reference image. This method is computationally expensive and may provide inaccurate results under conditions of complex motion of the organ. This method is limited since high level of similarity is required between positioning images taken during the therapeutic stage showing the device, and images taken during the reference state showing the organ.</p>
<p id="p-0006" num="0005">International patent application publication WO 05/020148 discloses a method for overcoming the motion artifact by using data banks containing static vascular maps relating to different phases of the cardiac/respiratory cycles. The positioning image is associated with the corresponding image in the bank by ECG and measured respiration phase. The suggested method requires additional equipment, is not accurate, and does not relate to all the motions, including for example patient movements.</p>
<p id="p-0007" num="0006">International patent application titled PCT/IL2006/000793 discloses a method for positioning a device in a tubular organ using a guidewire with special markings. Navigation of the device to the target location is carried out using the relation between the markings and the target, the relation extracted by analyzing a reference sequence of images. In addition to the necessity to use a special guidewire, the approach suffers from a number of additional drawbacks. Additional markers on the guidewire make the task of detecting and tracking the device markers much harder. In addition, the method assumes that the guidewire is fixed relatively to the artery throughout the heart motion cycle, which is not always valid. In such cases. shifts of the guidewire inside the vessel introduce inaccuracies.</p>
<p id="p-0008" num="0007">Thus there is a need in the art for a method for guiding a therapeutic device to an invisible target location in a moving organ. The method should be accurate under typical motions, and reduce the navigation time of the device to the location, as yell as the need for contrast injections.</p>
<heading id="h-0003" level="1">SUMMARY</heading>
<p id="p-0009" num="0008">A method and apparatus for navigating a therapeutic device to a target location at a target area of a moving organ of a subject. The method and apparatus use a reference image or a reference run in which the target location is determined according to a first feature, and then locate a second feature in a positioning run, upon which the target location or an indication to the location is presented to a user.</p>
<p id="p-0010" num="0009">In a preferred embodiment of the disclosure there is thus provided a method for navigating a device to a target location in a target area of a moving organ of a subject, the method comprising the steps of: acquiring one or more reference images under a first set of geometric conditions, the reference images showing the target area and one or more first features attached to the moving organ; defining the target location for the device on the reference image; determining a geometric relation between any of the first features and the target location; acquiring one or more positioning images; detecting a second feature in the positioning images; and indicating to a user a discrepancy between the target location and a current location of the device, using the second feature and the geometric relation. Within the method, detecting the second feature optionally comprises the steps of: identifying the second feature in the one of the positioning images and tracking the second feature in one or more second positioning image.</p>
<p id="p-0011" num="0010">Within the method, the positioning images are optionally acquired in geometric conditions substantially similar to the first set of geometric conditions. Within the method, the reference images optionally comprise an X-ray run, wherein one or more images are captured free of contrast material, showing the first feature, and one or more images are captured after injecting contrast material, showing the target area. Within the method, the first feature is optionally an anatomic feature or a deployed device. Within the method, the first feature is optionally a calcification spot. Within the method the geometric relation between any of the first features and the target location is determined by sequential registration of pairs of frames. The method optionally comprises a step of selecting the first set of geometric conditions. Within the method, the moving organ optionally has an elongated shape and the target location is defined as a cross section orthogonal to a main axis of the moving organ. Within the method, the first set of geometric conditions is chosen such that the target location is projected substantially as a line on the reference image or on the positioning image. Within the method, the first set of geometric conditions is optionally determined by acquiring two or more projections, determining two or more two-dimensional directions from the projections, and reconstructing a three-dimensional axis from the two-dimensional directions. Within the method, the geometric relation between the first feature and the target location is optionally a distance between the first feature and the target location. Within the method, the first set of geometric conditions is optionally selected by a user from a plurality of sets. The plurality of sets is optionally presented to the user as a line in a coordinate system of two rotation angles of the imaging device. Within the method, the discrepancy between the target location and a current location of the device is optionally indicated by showing the target location and the current location if the device, or by drawing a feature outline in a location relative to the current location of the device. Within the method, the second feature is optionally detected in a neighborhood of a location of the device. Within the method, detecting the second feature is optionally performed by correlating one or more parts of the positioning image with a template of the first feature. Optionally, correlating the template of the first feature and the second feature is enhanced by integrating a sequence of locally co-registered frames. Within the method, co-registering is optionally performed by tracking a device element, the device element selected from the group consisting of: the device; a pre-deployed device; and an additional device in the vicinity of the second feature. The device element is optionally a device marker or a device corner. Within the method, the additional device is optionally a deflated parked balloon. The method can further comprise a step of selecting a device size based on a three-dimensional distance between two anatomical features measured on two or more projections of the organs. Within the method, the second feature is optionally selected from the group consisting of: the first feature; a feature visible on the positioning image; and the device.</p>
<p id="p-0012" num="0011">Another aspect of the disclosure relates to a computerized apparatus for navigating a device to a target location within a moving organ of a subject, the apparatus comprising: a communication component for communicating with an imaging device capturing a reference image and a positioning image; a feature identification component for identifying a first feature in the reference image and a second feature in the positioning image; a component for determining geometric relations between two features appearing in one image or in two images; and a component for marking an indication of the first feature on the positioning image.</p>
<p id="p-0013" num="0012">Yet another aspect of the disclosure relates to a computer readable storage medium containing a set of instructions for a general purpose computer, the set of instructions comprising: acquiring one or more reference images under a first set of geometric conditions, the reference images showing the target area and one or more first features attached to a moving organ; defining the target location for the device on the reference image; determining a geometric relation between the first feature and the target location; acquiring one or more positioning images; detecting a second feature in the positioning images; and indicating to a user a discrepancy between the target location and a current location of the device, using the second feature and the geometric relation.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0014" num="0013">Exemplary non-limited embodiments of the disclosed subject matter will be described, with reference to the following description of the embodiments, in conjunction with the figures. The figures are generally not shown to scale and any sizes are only meant to be exemplary and not necessarily limiting. Corresponding or like elements are designated by the same numerals or letters.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic illustration of a set of reference images used during the diagnostic phase, in accordance with a preferred embodiment of the disclosure;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 2A</figref> is a schematic illustration an image used during the therapeutic stage, in accordance with a preferred embodiment of the disclosure;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2B</figref> is a schematic illustration another image used during the therapeutic stage, in accordance with another preferred embodiment of the disclosure;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIGS. 3A and 3B</figref> are illustration of images showing the organs during the diagnostic stage;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 3C</figref> shows a graphic representation enabling a physician to select an imaging direction, in accordance with a preferred embodiment of the disclosure</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart of the main steps in a preferred embodiment of a method of the disclosure; and</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of the main components in an apparatus for carrying out the method of <figref idref="DRAWINGS">FIG. 4</figref>, in accordance with the disclosure.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0022" num="0021">A method and apparatus for guiding a therapeutic device to a location within a moving organ, the location being externally invisible without imaging equipment. For example, it is sometimes required to position a trans-catheter heart valve (THV) in the aortic annulus which is subject to the heartbeat cycle, breathing and patient moves. In accordance with the disclosure, a diagnostic stage, a reference image or sequence of images is obtained in which the target location and some anatomical or artificial feature attached to the moving organ are observable. The reference sequence is preferably an X-ray run, i.e., an X-ray sequence of images showing the aortic annulus. One or more frames of the run are captured without contrast agent, thus showing distinguishable objects such as artificial devices or calcified areas. Other frames are captured after contrast material is injected, thus showing the aorta, and there may also be intermediates frames showing the organ and the distinguishable objects, but less clearly. Alternatively, a single source such as a Computerized Tomography (CT) scan may show the organ as well as the distinguishable object. Using one of the frames captured with contrast material, the target location for positioning a device is designated, manually or automatically. For example, the line of &#x201c;hinge-to-hinge&#x201d; connection of the annulus is designated for a THV. The system detects a calcium spot or another distinguishable object on one of the frames captured without contrast material. Then sequential registration is performed between pairs of frames, optionally using further intermediate frames. Once the images are registered, a combined image showing the distinguishable object and the designated location for the device is generated, and the geometric relation, i.e., the distance vector between the designated location and the distinguishable object can be determined. Since the designated location and the distinguishable object are attached to the organ, such as the aorta, the distance vector is constant regardless of motions of various types.</p>
<p id="p-0023" num="0022">On a therapeutic stage following the diagnostic stage, the device such as the THV is inserted and navigated, usually using a guidewire, to the designated location. During the therapeutic stage, additional images are captured, preferably without contrast material, showing the distinguishable object. The object is identified, and knowing the distance and direction between the object and the designated location, the location is marked on the image, thus enabling the physician to navigate the device.</p>
<p id="p-0024" num="0023">The distinguishable object can be a calcified area or another distinguishable anatomic object, but also an artificial object, such as a previously deployed therapeutic device. In such cases, the target location for the second device can be established either as detailed above, or without injecting contrast material, at the known distance and direction from the first device. On the therapeutic stage of placing the second device (balloon, stent and the like) the first device is detected and the target location for the second device is indicated relatively to the location of the previously deployed device.</p>
<p id="p-0025" num="0024">In case the organ is tubular or elongated, then in order for the images captured during the therapeutic stage to be useful, they should be captured from an angle perpendicular to the organ, so that the distinguishable object as well as the target location can be shown. In order to determine the three-dimensional direction of the organ, two or more two-dimensional images are captured from different perspectives. The direction of the organ is determined using the known geometry of the imaging device, and identifying the organ and its direction within the two or more images.</p>
<p id="p-0026" num="0025">The resulting set of views orthogonal to the direction of the organ can then be presented to user as a line in a coordinate system consisting of the two rotation angles of an imaging device (a C-arm), together with the projection angles used for capturing the two or more two-dimensional images. If any of these two projections is acceptable to the user as close enough to being perpendicular to the organ, this projection can he suggested as the capturing angle for the diagnostic stage as well as the therapeutic stage. It will be appreciated that the projection angles used during the diagnostic stage and during the therapeutic stage should be substantially the same. The deviation between the projection angles can not exceed a few degrees in any direction. If none of the two projections is sufficiently close to perpendicularity, the user can select any orthogonal projection, and in particular projections close to any of the two projections.</p>
<p id="p-0027" num="0026">In order to determine the exact size of the device to be deployed within the organ, a physician can mark two points in each of the two images, such as two hinges of the aortic annulus, and knowing the imaging geometry, the real distance between the hinges in the three-dimensional space, and thus the required valve size can be determined.</p>
<p id="p-0028" num="0027">The general environment in which the disclosure is used is in an operating room wherein a subject is lying on an operation bed, and an imaging device is capturing images of the patient from different perspectives. The images are transferred to a computing platform which performs operations such as image analysis operations on the images, providing a user such as a physician tools including graphic tools for manipulating the images, and others. In preferred embodiment the computing platform, or another computing platform in communication with the first computing platform is adapted to control the imaging device and determine the capturing perspective utilized by the imaging device. The computing platform can be any general purpose computer, such as a desktop computer, a laptop computer, a mainframe computer, or the like. The computing platform is in communication with a display device, such as a CRT, touch screen or any other display device, which can display the captured images, manipulated images, and interface enabling the user to perform computerized operations. The methods of the disclosure are preferably implemented as sets of interrelated computer instructions, arranged as software units such as executables, static libraries, dynamic libraries or other components. Alternatively, the methods or parts thereof can be implemented as firmware ported for a specific processor such as digital signal processor (DSP) or microcontrollers, or can be implemented as hardware or configurable hardware such as field programmable gate array (FPGA) or application specific integrated circuit (ASIC).</p>
<p id="p-0029" num="0028">Referring now to <figref idref="DRAWINGS">FIGS. 1A</figref>, <b>1</b>B, and <b>1</b>C, showing schematic illustrations of an exemplary set of reference images captured during the diagnostic phase, and markings thereof <figref idref="DRAWINGS">FIGS. 1A</figref>, <b>1</b>B, and <b>1</b>C illustrate exemplary images selected from a reference run, i.e., a series of images taken during a short time interval typically between about 4 and about 10 seconds. The reference run preferably comprises between about 10 and about 200 frames, and preferably contains frames free of contrast material taken at the beginning of the run and frames captured with contrast material.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 1A</figref> is an illustration of an X-Ray of aortic area <b>100</b>, taken without contrast material. Lines <b>104</b> illustrate the boundaries of the aorta and leaflets and spot <b>108</b> is a calcified spot. Unlike lines <b>104</b> which are not seen in X-ray images taken without contrast material, spot <b>108</b> is clearly distinguishable.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 1B</figref> is a schematic illustration of an exemplary X-ray image taken with some delay after the injection of contrast material to aortic area <b>100</b>, after some of the contrast material, but not all of the contrast material has arrived. In <figref idref="DRAWINGS">FIG. 1B</figref>, the boundaries of the aorta and the leaflets, indicated as lines <b>104</b>&#x2032; are more distinguishable than in <figref idref="DRAWINGS">FIG. 1A</figref>, but not clearly distinguishable. Calcified spot <b>108</b>&#x2032; is less distinguishable than calcified spot <b>108</b> of <figref idref="DRAWINGS">FIG. 1</figref>, but is still distinguishable from its surrounding.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 1C</figref> is a schematic illustration of an exemplary X-ray image taken when the aorta is fully opaque due to the contrast material. Lines <b>104</b>&#x2033; indicating aorta <b>100</b> and the boundaries of the leaflets are clearly seen, but the calcified spot indicated <b>108</b> in FIGS. <b>1</b> and <b>108</b>&#x2032; in <figref idref="DRAWINGS">FIG. 1B</figref> is indistinguishable from its environment. Using <figref idref="DRAWINGS">FIG. 1C</figref> which shows clearly the boundaries of the aorta and two out of the three leaflets, being leaflets <b>116</b> and <b>120</b>, the destination location for a therapeutic device can be determined. For example, a location for a THV can he determined along line <b>124</b> connecting leaflet hinges <b>116</b> and <b>120</b>. Then, using image processing techniques such as successive correlation between pairs of neighboring frames, and applying the obtained chain of transformations or shifts, i.e. summing up the shifts between consecutive frames it is possible to register <figref idref="DRAWINGS">FIG. 1C</figref> with <figref idref="DRAWINGS">FIG. 1A</figref>. The registration between <figref idref="DRAWINGS">FIG. 1C</figref> and <figref idref="DRAWINGS">FIG. 1A</figref> enables the marking of line <b>124</b>&#x2032; on <figref idref="DRAWINGS">FIG. 1A</figref>, which corresponds to line <b>124</b> on <figref idref="DRAWINGS">FIG. 1C</figref>. Indicating line <b>124</b>&#x2032; and spot <b>108</b> on the same image enables to determine the distance between line <b>124</b>&#x2032; and spot <b>108</b>, i.e. the relative displacement between the designated location of the THV and the calcified spot. It will be appreciated that the frame shown in <figref idref="DRAWINGS">FIG. 1B</figref>, as well as substantially all other frames within the run are used only for registration between a frame showing the target area and the frame showing the calcified spot or another feature. It will be further appreciated that registration is not required if the target location and the calcified spot are shown in the same source, such as a CT scan.</p>
<p id="p-0033" num="0032">Referring now to <figref idref="DRAWINGS">FIG. 2A</figref>, showing a schematic illustration of an image shown to a physician during the therapeutic stage, at which the device is to be positioned at its designated location, i.e. navigated to and deployed at the location. <figref idref="DRAWINGS">FIG. 2A</figref> shows an X-Ray image taken during the therapeutic stage, without contrast material injection, with an additional mark <b>208</b>. <figref idref="DRAWINGS">FIG. 2A</figref> is preferably captured after the device is in the general vicinity of the aortic annulus, so that the aortic annulus and the device can be captured in one image. <figref idref="DRAWINGS">FIG. 2A</figref> shows clearly calcified spot <b>108</b>, and does not show the aorta and leaflets boundaries <b>200</b>. Knowing the displacement vector between spot <b>108</b> and the designated location for the device, location <b>208</b> is marked on the image. <figref idref="DRAWINGS">FIG. 2A</figref>, captured without contrast material, further shows opaque indicators on the device <b>212</b>. Thus, a physician can navigate device <b>212</b> until it is placed exactly on the designated location. For example, the designated location can relate to the distal or proximal end of the device, or to a particular ratio between distal and proximal ends of the device.</p>
<p id="p-0034" num="0033">Referring now to <figref idref="DRAWINGS">FIG. 2B</figref>, showing a schematic illustration of another image shown to a physician during the therapeutic stage, used when spot <b>108</b> is seen but can not be identified automatically. Like <figref idref="DRAWINGS">FIG. 2A</figref>, <figref idref="DRAWINGS">FIG. 2B</figref> is also shown when the device is in the vicinity of the designated location. When <figref idref="DRAWINGS">FIG. 2B</figref> is shown, line <b>208</b> indicating the designated location is marked at the current position of the device, as if the device is indeed positioned in the designated location. Then boundaries <b>216</b> having the shape of the boundaries of spot <b>108</b> are marked according to the known distance between the spot and the designated location. Since the image is shown when the device is in the vicinity of the designated location, marked boundaries <b>216</b> are in the vicinity of spot <b>108</b>. Boundaries <b>216</b> help the physician focus on the area and identify spot <b>108</b> in the image. The physician then positions device <b>212</b> so as to make boundaries <b>216</b> and spot <b>108</b> coincide. When boundaries <b>216</b> and spot <b>108</b> coincide, device <b>212</b> is located on its designated location.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIGS. 2A</figref> or <b>2</b>B are preferably selected from a run, i.e. a series of images taken during a short time interval, preferably between about 1 second and about 10 seconds, using substantially the same perspective as used when the reference run was captured.</p>
<p id="p-0036" num="0035">It will be appreciated that instead of an anatomical feature such as a calcified spot, an artificial feature can be used, as long as the feature or object is attached to the organ and is therefore subject to the same movements as the organ. In exemplary embodiments, the feature can be an opaque marker pre-attached to a first device already placed at the location, an opaque marker attached to the first device at the location by parking a deflated balloon used for the first device deployment and inflating a balloon carrying the marker within the first device, an opaque marker attached to the device to he placed which assists the user in focusing on the relevant area, or the like.</p>
<p id="p-0037" num="0036">Referring now to <figref idref="DRAWINGS">FIGS. 3A</figref>, <b>3</b>B and <b>3</b>C, illustrating a method for identifying projection angles to be used by the imaging device during the diagnostic stage and during the therapeutic stage.</p>
<p id="p-0038" num="0037">Referring now to <figref idref="DRAWINGS">FIGS. 3A and 3B</figref>, showing X-ray images of the aorta and leaflets during the diagnostic stage. <figref idref="DRAWINGS">FIGS. 3A and 3B</figref> are captured using different projection angles. <figref idref="DRAWINGS">FIG. 3A</figref> shows the aorta, referenced <b>300</b> and its main axis <b>304</b> as captured with contrast material from one perspective, and <figref idref="DRAWINGS">FIG. 3B</figref> shows the aorta, referenced <b>300</b>&#x2032; and the main axis <b>304</b>&#x2032;, as captured from another perspective. Since the projection angles at which <figref idref="DRAWINGS">FIGS. 3A and 3B</figref> were captured are known, the real direction of the main axis can thus be determined. Then, all directions orthogonal to the main axis can be determined as well.</p>
<p id="p-0039" num="0038">Referring now to <figref idref="DRAWINGS">FIG. 3C</figref>, showing a coordinate system <b>316</b> in which each point corresponds to a combination of two rotation angles of the C-arm, and thus to a specific perspective of the X-Ray imaging device. Line <b>320</b> comprises of all angle combinations, corresponding to imaging perspectives perpendicular to the main axis of the aorta adjacent to the annulus. Further shown are point <b>1</b> (<b>324</b>) and point <b>2</b> (<b>328</b>) which corresponds to the angle combinations at which <figref idref="DRAWINGS">FIG. 3A</figref> and <figref idref="DRAWINGS">FIG. 3B</figref> were captured, respectively.</p>
<p id="p-0040" num="0039">If any of these two projections is acceptable to the user as close enough to being perpendicular to the organ, this projection can be suggested as the capturing angle for the diagnostic stage as well as the therapeutic stage. If none of the two projections is sufficiently close to perpendicularity, the user can select any orthogonal projection, and in particular projections as close as possible to any of the two projections, such as point <b>332</b> or point <b>336</b>.</p>
<p id="p-0041" num="0040">Referring now to <figref idref="DRAWINGS">FIG. 4</figref>, showing a flowchart of the main steps in a preferred method for navigating a therapeutic device to a location within or near an organ, the organ being externally invisible.</p>
<p id="p-0042" num="0041">On optional step <b>404</b>, a preferred projection perspective for the reference run or reference image and for the positioning image or positioning run is determined, particularly when the relevant organ is tubular or otherwise elongated, and the target location is defined in terms of cross section of the organ. In a preferred embodiment, determining the angle requires the capturing of two images of the organ from two different perspectives. Then the two-dimensional main axis of the organ at the area at which the therapeutic device is to be positioned is determined for each image. Since the capturing perspectives for the two images are known, the three-dimensional direction of the main axis of the organ can be determined from the two two-dimensional directions, for the particular position of the patient. Once the direction of the main axis is determined, all orthogonal directions are known as well, and one of them is preferably chosen so that the captured images show the organ longitudinally, and the target location appears as a line. If a perspective close to perpendicular is selected, then the target location is substantially similar to a line. An angular coordinate system is shown to a user, indicating the capturing perspectives of the two images and a line comprising all directions orthogonal to the organ. The user, such as a physician can choose any point, preferably a point belonging to the line detailed above, associated with a perspective orthogonal to the main axis of the organ. The chosen perspective is preferably used in the reference run during the diagnostic stage, and on the positioning stage.</p>
<p id="p-0043" num="0042">On optional step <b>406</b>, the required size or other parameters of the device are determined by the user, for example by marking two points on at least two images, the distance between the points representing the projection of the required size on each of the at least two images, and determining the size using the known geometries of the images. Thus, the device size is selected based on a three-dimensional distance between two anatomical features measured using at least two projections of the organ.</p>
<p id="p-0044" num="0043">On step <b>408</b>, one or more reference images are acquired, showing the general area, or the target area of the target location for the device and a first feature attached to the organ. The first feature can be an anatomical feature such as a calcified spot or any other feature visible without injecting contrast material. Alternatively, the feature can be an artificial feature, such as the edge of a device positioned in the general area, a marker attached to such device, a marker attached to a deflated balloon, or the like. The feature can he detected manually by a physician, automatically by the apparatus of the disclosure, or a combination thereof wherein the feature is identified automatically and enhanced manually, or vise versa. If there are multiple reference images, such as images acquired as a reference set, then at least one image from the set should show the organ clearly enough for a user to determine the target location, and at least one image from the set should show the feature.</p>
<p id="p-0045" num="0044">On step <b>412</b>, the user, such as a physician determines and marks on the reference image, or on a reference image showing the organ, the target location at which the device is to be positioned.</p>
<p id="p-0046" num="0045">On step <b>416</b>, if a single reference image was captured showing the organ and the feature, then the geometric relation between the target location and the feature is determined. If the reference run comprises multiple reference images, then a chain of registrations is performed between pairs of images in the reference run. The registrations are then composed, so as to generate a registration between an image showing the target location and an image showing the feature. Then, the geometric relation between the target location and the feature is determined.</p>
<p id="p-0047" num="0046">On step <b>420</b>, which is preferably performed during the therapeutic stage of positioning the therapeutic device, a positioning image or frame, or a positioning run comprising multiple images or frames is acquired. The positioning image shows the general area of the target location and the therapeutic device. Therefore, the positioning image is preferably captured when the therapeutic device is already in the general area of the target location.</p>
<p id="p-0048" num="0047">On step <b>424</b>, a second feature is identified in the positioning image, or one or more images of the positioning run. The second feature can be the same as the first feature, such as the calcified spot, or another feature such as the therapeutic device in its current location. The second feature is preferably identified in the neighborhood of the device in its current location device. Step <b>424</b> is thus preferably performed when the device is in the general area of the target location, for example between about 0.5 cm away from the target location and about 5 cm away from the target location. If the second feature is the first feature, detecting the first feature is preferably performed by correlating parts of the positioning image with a template of the first feature. Correlating the template of the first feature within an area of the positioning image is optionally enhanced by integrating a sequence of locally co-registered frames of the positioning run. Co-registration of the frames can be performed by using a device element, such as an end or a corner of a device or a marker attached to device. The device may be any device appearing in the positioning image, including the device to be positioned, a previously positioned device or another device such as a deflated parked balloon carrying a marker.</p>
<p id="p-0049" num="0048">In a preferable embodiment, the detection of the first feature in frames of the positioning run, consists of two phases: identification of the first feature in one of the positioning frames, and tracking the feature in subsequent frames.</p>
<p id="p-0050" num="0049">Generally, during the identification stage, the template of the first feature is searched for within each relevant sub-area of an area of interest of each positioning frame. The frame at which the template is most likely to be shown is the identified frame. The template is a part of the reference image, the part including the first feature, and a neighborhood of pixels around the first feature. The region of interest is a part of a positioning image adjacent to where the device to be positioned is shown. Both the template and the region of interest arc rectangular areas, one dimension of which is parallel to the target line, and the other dimension orthogonal to the first one. Since the appearance of the feature can change periodically in accordance with the heart beat, the template is preferably compared to the region of interest of the positioning image taken at the same phase of the cycle, using ECG. In order to reveal the matched phase without the use of ECG gating or any other external signal, identification may be performed by repeating the correlations of the template as taken from the reference image with regions of interest from sequential frames of the positioning run. Each correlation consists of multiple comparisons between the pixel values in the template, and the pixel value in a sub-area of the area of interest. The highest similarity obtained for the particular frame is the score of the frame. The frame having the highest score among all frames taken throughout a full heart beat cycle is preferably selected as the frame for identification. The identification frame can alternatively be selected as the first frame for which the correlation score exceeds a predetermined value.</p>
<p id="p-0051" num="0050">Then, during the tracking stage, the template as found in the identified frame is searched for within the next frame. Being found in the next frame the feature in the next frame becomes a template for search in a further following frame, and so on. Since the motion of the device is slow relatively to the anatomical motions, the template is assumed to move insignificantly between two consecutive frames. Therefore, the region of interest at which the template is searched for during the tracking phase can be significantly smaller than the region of interest used during the identification stage.</p>
<p id="p-0052" num="0051">On step <b>428</b>, an indication to the discrepancy between the current location of the device and the target location is provided. The indication differs according to the second feature detected on step <b>424</b>. If the detected feature is the first feature as detected on the reference image or the reference run, such as a calcified spot or a previously positioned device, then the target location can be determined according to the geometric relation determined on step <b>416</b>, and the target location is then marked on the positioning image. The user then sees the difference between the current location of the device and the target location, and moves the device accordingly.</p>
<p id="p-0053" num="0052">Another situation is when the second feature is not the feature detected in the reference run or in the reference image. The situation generally occurs when the first feature is not identified in the positioning run. In these cases, it is assumed that the current location of the device is the target location. Then, using the geometric relation between the target location and the first feature, the assumed location of the first feature is marked. Having the assumed mark of the first feature helps the user notice the real location of the first feature. Then, the displacement between the real location of the first feature and the assumed location is the same as the displacement between the real target location and the assumed target location (which is equal to the current location of the device). Thus, moving the device so that the real location of the first feature coincides with the assumed location, will position the device at the real target location.</p>
<p id="p-0054" num="0053">Referring now to <figref idref="DRAWINGS">FIG. 5</figref>, showing a block diagram of the main components in an apparatus designed to carry out the disclosed methods. The components are software components executed by a general purpose computer, or firmware ported for a specific processor. The executing computing platform is provisioned with a display device for displaying the images and manipulations thereof, and for enabling the user to make selections when required. The computing platform is in communication with the imaging device, the computing platform receiving captured images from the imaging device and optionally providing instructions such as capturing perspectives to the imaging device. The apparatus comprises control component <b>504</b> for controlling the order of activation and data flow between other components. Imaging device communication component <b>508</b> is responsible For communication between the apparatus and the imaging device, the communication preferably being two-way, wherein images are received from the imaging device, and control commands relating to the imaging perspective, intensity and other factors are optionally provided to the imaging device. Component <b>512</b> is designed to receive two or more images of the organ under discussion, and determine the direction of the organ, if the organ is tubular or elongated. Component <b>512</b> is in communication with component <b>516</b>, designed to enable a user to select, based on the direction of the organ, a preferred imaging perspective. Component <b>516</b> is a part of, or in communication with user interface component <b>520</b>, designed to convey information to, and receive instructions and indications from a user, such as a physician. The apparatus further comprises feature identification component <b>524</b> for identifying one or more features in an image, based on image processing techniques, and possibly on data received from a user, such as an indication to the general location of a feature, or the like. Feature identification component <b>524</b> provides data to registration component <b>528</b>, which according to common features detects the similarities between images. Component <b>528</b> thus determines the geometric operations which when activated on the coordinate system of one image will yield the coordinate system of the other image. Having the registration parameters between images, component <b>532</b> determines the geometric relations between features appearing in different images. Component <b>536</b>, receiving the geometric locations from component <b>532</b>, and communicating with user interface component <b>520</b> is functional in marking indications on images, for example marking target locations on images showing features attached to the organs, marking the target location on an image showing the current location of a device, and the like.</p>
<p id="p-0055" num="0054">It will be appreciated by a person skilled in the art that the disclosed methods and apparatus can he used with multiple types of imaging devices taking images of body areas from a point external to the body, such as CT, or MRI. It will also he appreciated that additional embodiments can he designed without deviating from the spirit of the disclosure. For example, other embodiments can be designed for generating relations between Features attached to the organs, or features whose relation to the organ is otherwise known and other features or locations.</p>
<p id="p-0056" num="0055">It will he appreciated by a person skilled in the art that multiple variations and options can be designed along the guidelines of the disclosed method.</p>
<p id="p-0057" num="0056">While the disclosure has been described with reference to exemplary embodiments, it will be understood by those skilled in the art that various changes may he made and equivalents may be substituted for elements thereof without departing from the scope of the disclosure. In addition, many modifications may be made to adapt a particular situation, material, step of component to the teachings without departing from the essential scope thereof. Therefore, it is intended that the disclosed subject matter not be limited to the particular embodiment disclosed as the best mode contemplated for carrying out this invention, but only by the claims that follow.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for navigating a device to a target location in a target area of a moving organ of a subject, the method comprises the steps of:
<claim-text>acquiring at least one reference image under a first set of geometric conditions, the at least one reference image showing the target area and at least one first feature attached to the moving organ;</claim-text>
<claim-text>defining the target location for the device on the reference image;</claim-text>
<claim-text>determining a geometric relation between the at least one first feature and the target location by employing a relative location of said target area and said at least one first feature detected in said reference image;</claim-text>
<claim-text>acquiring at least one positioning image;</claim-text>
<claim-text>detecting a second feature in the at least one positioning image,</claim-text>
<claim-text>indicating to a user a discrepancy between the target location and a current location of the device, using the second feature and the geometric relation, and</claim-text>
<claim-text>wherein said at least one reference image comprises an X-ray run during which at least one first set of images is captured free of contrast material, showing said at least one first feature, and at least one second set of images is captured after injecting contrast material, showing said target area.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the positioning image is acquired under geometric conditions similar to the first set of geometric conditions.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the at least one first feature is an anatomic feature, a calcification spot or a deployed device.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the geometric relation between the at least one first feature and the target location is determined by sequential registration of pairs of frames.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the moving organ has an elongated shape and the target location is defined as a cross section orthogonal to a main axis of the moving organ.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein the first set of geometric conditions is chosen such that the target location is projected as a line on the at least one reference image or on the at least one positioning image.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref> wherein the first set of geometric conditions is determined by acquiring at least two projections, determining at least two two-dimensional directions from the at least two projections, and reconstructing a three-dimensional axis from the at least two two-dimensional directions.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the geometric relation between the at least one first feature and the target location is a distance between the at least one first feature and the target location.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the first set of geometric conditions is selected by a user from a plurality of sets and wherein the plurality of sets is presented to the user as a line in a coordinate system of two rotation angles of the imaging device.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein detecting the second feature comprises the steps of:
<claim-text>identifying the second feature in the at least one positioning image; and</claim-text>
<claim-text>tracking the second feature in at least one second positioning image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the discrepancy between the target location and a current location of the device is indicated by showing the target location and the current location of the device.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the discrepancy between the target location and a current location of the device is indicated by drawing a feature outline in a location relative to the current location of the device.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein said detecting the second feature is performed by correlating at least one part of the positioning image with a template of the at least one first feature.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein said correlating the template of the at least one first feature and the second feature is enhanced by integrating a sequence of locally co-registered frames.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein co-registering is performed by tracking a device element, the device element selected from the group consisting of: the device; a pre-deployed deployed device; and an additional device in the vicinity of the second feature.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising a step of selecting a device size based on a three-dimensional distance between two anatomical features measured using at least two projections of the organ.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the second feature is selected from the group consisting of: the at least one first feature; a feature visible in the at least one positioning image; and the device.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. An apparatus for navigating a device to a target location within a moving organ of a subject, the apparatus comprises:
<claim-text>a communication component for communicating with an imaging device capturing a reference image and a positioning image;</claim-text>
<claim-text>a feature identification component for identifying a first feature in the reference image and a second feature in the positioning image;</claim-text>
<claim-text>a component for determining a geometric relation between said first feature appearing in said reference image and a target area appearing in said reference image, and</claim-text>
<claim-text>a component for marking an indication of the first feature on the positioning image,</claim-text>
<claim-text>wherein at least one component is executed by a computing platform, and</claim-text>
<claim-text>wherein said reference image comprises an X-ray run during which a first set of images is captured free of contrast material, showing said first feature and a second set of images is captured after injecting contrast material, showing said target area.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. A non-transient computer readable storage medium containing a set of instructions for a general purpose computer, the set of instructions comprising:
<claim-text>acquiring at least one reference image under a first set of geometric conditions, the reference image showing the target area and at least one first feature attached to a moving organ;</claim-text>
<claim-text>defining the target location for the device on the reference image;</claim-text>
<claim-text>determining a geometric relation between the first feature and the target location by employing a relative location of said target area and said at least one first feature detected in said reference image;</claim-text>
<claim-text>acquiring at least one positioning image;</claim-text>
<claim-text>detecting a second feature in the at least one positioning image; and</claim-text>
<claim-text>indicating to a user a discrepancy between the target location and a current location of the device, using the second feature and the geometric relation,</claim-text>
<claim-text>wherein said at least one reference image comprises an X-ray run during which at least one first set of images is captured free of contrast material, showing said at least one first feature, and at least one second set of images is captured after injecting contrast material, showing said target area. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
