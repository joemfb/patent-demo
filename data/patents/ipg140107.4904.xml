<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08626000-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08626000</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13505199</doc-number>
<date>20110902</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2011-019612</doc-number>
<date>20110201</date>
</priority-claim>
</priority-claims>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20130101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>B</subclass>
<main-group>10</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20130101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>B</subclass>
<main-group>10</main-group>
<subgroup>61</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classifications-cpc>
<main-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>H</section>
<class>04</class>
<subclass>B</subclass>
<main-group>10</main-group>
<subgroup>6165</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
</main-cpc>
</classifications-cpc>
<classification-national>
<country>US</country>
<main-classification>398203</main-classification>
<further-classification>398204</further-classification>
<further-classification>398208</further-classification>
</classification-national>
<invention-title id="d2e61">Coherent optical receiver, apparatus and method for detecting inter-channel skew in coherent optical receiver</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>2010/0209121</doc-number>
<kind>A1</kind>
<name>Tanimura</name>
<date>20100800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>398202</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2011/0002689</doc-number>
<kind>A1</kind>
<name>Sano et al.</name>
<date>20110100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>398 44</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2012/0219302</doc-number>
<kind>A1</kind>
<name>Sun et al.</name>
<date>20120800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>398208</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2012/0237202</doc-number>
<kind>A1</kind>
<name>Abe et al.</name>
<date>20120900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>398 16</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2012/0263481</doc-number>
<kind>A1</kind>
<name>Ip et al.</name>
<date>20121000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>398193</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2013/0051790</doc-number>
<kind>A1</kind>
<name>Yasuda et al.</name>
<date>20130200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>398 16</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>JP</country>
<doc-number>2010-028470</doc-number>
<kind>A</kind>
<date>20100200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>JP</country>
<doc-number>2010-226254</doc-number>
<kind>A</kind>
<date>20101000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>JP</country>
<doc-number>2011-199687</doc-number>
<kind>A</kind>
<date>20111000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00010">
<othercit>Taylor, M. G., &#x201c;Coherent Detection Method Using DSP for Demodulation of Signal and Subsequent Equalization of Propagation Impairments&#x201d;, Photonics Technology Letters, IEEE, 2004, pp. 674-676, vol. 16, Issue 2.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>7</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>398203</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>398204</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>398208</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>17</number-of-drawing-sheets>
<number-of-figures>19</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120237202</doc-number>
<kind>A1</kind>
<date>20120920</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Abe</last-name>
<first-name>Junichi</first-name>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Yasuda</last-name>
<first-name>Wakako</first-name>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Fukuchi</last-name>
<first-name>Kiyoshi</first-name>
<address>
<city>Minato-ku</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Abe</last-name>
<first-name>Junichi</first-name>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Yasuda</last-name>
<first-name>Wakako</first-name>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Fukuchi</last-name>
<first-name>Kiyoshi</first-name>
<address>
<city>Minato-ku</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Sughrue Mion, PLLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>NEC Corporation</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Leung</last-name>
<first-name>Danny</first-name>
<department>2637</department>
</primary-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/JP2011/070541</doc-number>
<kind>00</kind>
<date>20110902</date>
</document-id>
<us-371c124-date>
<date>20120430</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO2012/105081</doc-number>
<kind>A </kind>
<date>20120809</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">In a coherent optical receiver, sufficient demodulation becomes impossible and consequently receiving performance deteriorates if an inter-channel skew arises, therefore, a coherent optical receiver according to an exemplary aspect of the invention includes a local light source, a 90&#xb0; hybrid circuit, an optoelectronic converter, an analog to digital converter, and a digital signal processing unit; wherein the 90&#xb0; hybrid circuit makes multiplexed signal light interfere with local light from the local light source, and outputs a plurality of optical signals separated into a plurality of signal components; the optoelectronic converter detects the optical signals and outputs detected electrical signals; the analog to digital converter quantizes the detected electrical signals and outputs quantized signals; the digital signal processing unit includes a skew compensation unit for compensating a difference in propagation delay between the plurality of signal components, and an FFT operation unit for performing a fast Fourier transform process on the quantized signals; and wherein the difference in propagation delay is calculated on the basis of a plurality of peak values with a central focus on one peak value in the results of performing the fast Fourier transform process.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="180.34mm" wi="177.80mm" file="US08626000-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="139.95mm" wi="181.53mm" file="US08626000-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="197.87mm" wi="194.90mm" file="US08626000-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="241.13mm" wi="184.07mm" file="US08626000-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="268.90mm" wi="188.30mm" file="US08626000-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="237.57mm" wi="145.03mm" file="US08626000-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="155.28mm" wi="180.68mm" file="US08626000-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="207.01mm" wi="207.01mm" file="US08626000-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="152.99mm" wi="171.70mm" file="US08626000-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="214.80mm" wi="195.24mm" file="US08626000-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="218.02mm" wi="178.14mm" file="US08626000-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="214.12mm" wi="194.48mm" file="US08626000-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="271.70mm" wi="178.05mm" file="US08626000-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="228.52mm" wi="194.39mm" file="US08626000-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="124.88mm" wi="184.49mm" file="US08626000-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="169.08mm" wi="180.93mm" file="US08626000-20140107-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="147.57mm" wi="173.91mm" file="US08626000-20140107-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="174.92mm" wi="185.17mm" file="US08626000-20140107-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is a National Stage of International Application No. PCT/JP2011/070541 filed Sep. 2, 2011, claiming priority based on Japanese Patent Application No. 2011-019612 filed Feb. 1, 2011, the contents of all of which are incorporated herein by reference in their entirety.</p>
<heading id="h-0002" level="1">TECHNICAL FIELD</heading>
<p id="p-0003" num="0002">The present invention relates to coherent optical receivers, apparatuses and methods for detecting inter-channel skew in coherent optical receivers and, in particular, to a coherent optical receiver which receives optical polarization multiplexing signals by means of coherent detection and digital signal processing, and to an apparatus and a method for detecting inter-channel skew in the coherent optical receiver.</p>
<heading id="h-0003" level="1">BACKGROUND ART</heading>
<p id="p-0004" num="0003">The data capacity in the network has been increasing year by year due to the wide spread of the Internet. In the trunk line connecting metropolitan areas, the optical transmission link whose transmission capacity per one channel is 10 Gb/s or 40 Gb/s has already been introduced. On-Off-Keying (OOK) is employed as a modulation scheme in 10 Gb/s transmission. Although the OOK scheme is used also in 40 Gb/s transmission systems, it is unsuitable for long-haul transmission because the transmission characteristics are greatly influenced by the chromatic dispersion due to the narrow optical pulse width of 25 ps. Therefore, a multilevel modulation scheme using phase modulation and a polarization multiplexing scheme have been adopted, and a Dual Polarization Quadrature Phase Shift Keying (DP-QPSK) scheme is mainly employed for 100 Gb/s class transmission systems.</p>
<p id="p-0005" num="0004">A light signal modulated by using DP-QPSK scheme in a transmitter is received and demodulated by a coherent optical receiver (refer to non patent literature 1, for example). An example of the configuration of a related coherent optical receiver is shown in <figref idref="DRAWINGS">FIG. 18</figref>. The related coherent optical receiver <b>700</b> includes a local light source <b>710</b>, a 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>720</b>, optoelectronic converters (O/E) <b>730</b>, analog to digital converters (ADC) <b>740</b>, and a digital signal processing unit (DSP) <b>750</b>.</p>
<p id="p-0006" num="0005">Signal light and local light can be expressed as single polarization signals by the following formulae respectively.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i>(<i>t</i>)=exp[<i>j&#x3c9;t]</i>&#x2003;&#x2003;(1)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>L</i>(<i>t</i>)=exp[<i>j</i>(&#x3c9;+&#x394;&#x3c9;)<i>t]</i>&#x2003;&#x2003;(2)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where &#x394;&#x3c9; represents a frequency offset between the signal light and the local light. The signal light and the local light are inputted to the 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>720</b>, and after passing through an optical interference system, they are converted into electrical signals by the optoelectronic converters (O/E) <b>730</b> which are made up of a differentially configured set of photodiodes. At that time, outputs expressed by the following formulae (3) and (4) are obtained from port I<sub>X </sub>and port Q<sub>X </sub>respectively.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>I</i><sub>X</sub>(<i>t</i>)=cos(&#x394;&#x3c9;<i>t</i>)&#x2003;&#x2003;(3)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Q</i><sub>X</sub>(<i>t</i>)=sin(&#x394;&#x3c9;<i>t</i>)&#x2003;&#x2003;(4)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0007" num="0006">In a case of a polarization multiplexed signal, S(t) is expressed as S(t)=E<sub>X</sub>+E<sub>Y</sub>, and a cosine component of the mixed signal E<sub>X</sub>+E<sub>Y </sub>is outputted at I<sub>X </sub>and I<sub>Y </sub>ports and a sine component of the mixed signal E<sub>X</sub>+E<sub>Y </sub>is outputted at Q<sub>X </sub>and Q<sub>Y </sub>ports.</p>
<p id="p-0008" num="0007">The signals outputted from the respective ports are inputted into the digital signal processing unit (DSP) <b>750</b>, after being AD converted by the analog to digital converters (ADC) <b>740</b>. In the digital signal processing unit (DSP) <b>750</b>, E<sub>X </sub>and E<sub>Y </sub>signals are separated by a polarization demultiplexing process, and then demodulated in 4-levels by a phase estimation process.</p>
<p id="p-0009" num="0008">In this way, DP-QPSK signals can be demodulated using a coherent optical receiver.
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0009">Non Patent Literature 1: M. G. Taylor, &#x201c;Coherent Detection Method Using DSP for Demodulation of Signal and Subsequent Equalization of Propagation Impairments&#x201d;, IEEE Photonics Technology Letters, vol. 16, No. 2, February 2004, pp 674-676.</li>
</ul>
</p>
<heading id="h-0004" level="1">DISCLOSURE OF INVENTION</heading>
<heading id="h-0005" level="1">Problem to be Solved by the Invention</heading>
<p id="p-0010" num="0010">The signals expressed in the above-described formulae (3) and (4) are true only if, in the coherent optical receiver <b>700</b>, all lengths of four signal lines from the outputs of the 90&#xb0; hybrid circuit <b>720</b> to the inputs of the analog to digital converters <b>740</b> are equal. However, it is difficult to make precisely equal the length between those four channels, that is, the length of optical fiber cables from the outputs of the 90&#xb0; hybrid circuit <b>720</b> to the inputs of the optoelectronic converters <b>730</b>, and the length of coaxial wires from the outputs of the optoelectronic converters <b>730</b> to the inputs of the analog to digital converters <b>740</b>.</p>
<p id="p-0011" num="0011">If the lengths of the lines are not equal between those four channels, there arises a delay in signal transmission, that is, a skew. The influence of the skew will be described referring to <figref idref="DRAWINGS">FIG. 19</figref>. <figref idref="DRAWINGS">FIG. 19</figref> is a block diagram showing the configuration of related 90&#xb0; hybrid circuits <b>720</b> and their peripherals. In this figure, &#x201c;PBS&#x201d; represents a polarization beam splitter, &#x201c;CPL&#x201d; a optical coupler, &#x201c;&#x3c4;&#x201d; a 90&#xb0; phase difference unit, and &#x201c;BR&#x201d; represents a balanced photodetector as the optoelectronic converter (O/E) <b>630</b>, respectively.</p>
<p id="p-0012" num="0012">If there exists a skew T in the channel <b>2</b> (CH<b>2</b>) against the channel <b>1</b> (CH<b>1</b>), the above-described formula (4) is changed into the following formula (5).
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Q</i><sub>X</sub>(<i>t</i>)=sin(&#x394;&#x3c9;(<i>t+T</i>))&#x2003;&#x2003;(5)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0013" num="0013">In the absence of the above-described skew T, polarization demultiplexing and phase estimation can be performed by digital signal processing using the above-described formulae (3) and (4), and demodulation can be achieved perfectly. However, if there exists an inter-channel skew, the output signal from port Q<sub>X </sub>expressed by the formula (4) changes into the output signal expressed by the formula (5), and demodulation becomes imperfect even though digital signal processing is performed, and thus sufficient performance can not be achieved. As mentioned above, in a coherent optical receiver, there is a problem that sufficient demodulation becomes impossible and consequently receiving performance deteriorates if an inter-channel skew arises.</p>
<p id="p-0014" num="0014">The object of the present invention is to provide a coherent optical receiver, and an apparatus and a method for detecting inter-channel skew in the coherent optical receiver which solve the problem mentioned above that in a coherent optical receiver, sufficient demodulation becomes impossible and consequently receiving performance deteriorates if an inter-channel skew arises.</p>
<heading id="h-0006" level="1">Means for Solving a Problem</heading>
<p id="p-0015" num="0015">A coherent optical receiver according to an exemplary aspect of the invention includes a local light source, a 90&#xb0; hybrid circuit, an optoelectronic converter, an analog to digital converter, and a digital signal processing unit; wherein the 90&#xb0; hybrid circuit makes multiplexed signal light interfere with local light from the local light source, and outputs a plurality of optical signals separated into a plurality of signal components; the optoelectronic converter detects the optical signals and, outputs detected electrical signals; the analog to digital converter quantizes the detected electrical signals and outputs quantized signals; the digital signal processing unit includes a skew compensation unit for compensating a difference in propagation delay between the plurality of signal components, and an FFT operation unit for performing a fast Fourier transform process on the quantized signals; and wherein the difference in propagation delay is calculated on the basis of a plurality of peak values with a central focus on one peak value in the results of performing the fast Fourier transform process.</p>
<p id="p-0016" num="0016">An apparatus for detecting inter-channel skew in a coherent optical receiver according to an exemplary aspect of the invention includes a coherent optical receiver, a test light source, an analog to digital converter, an FFT operation unit, and a control block; wherein the coherent optical receiver includes a local light source, a 90&#xb0; hybrid circuit, and an optoelectronic converter; wherein the 90&#xb0; hybrid circuit makes multiplexed signal light interfere with local light from the local light source, and outputs a plurality of optical signals separated into a plurality of signal components; the optoelectronic converter detects the optical signals and outputs detected electrical signals; the analog to digital converter quantizes the detected electrical signals and outputs quantized signals; the FFT operation unit performs a fast Fourier transform process on the quantized signals; and the control block calculates a difference in propagation delay between the plurality of signal components on the basis of a plurality of peak values with a central focus on one peak value in the results of performing the fast Fourier transform process.</p>
<p id="p-0017" num="0017">An optical transmitter/receiver according to an exemplary aspect of the invention includes a coherent optical receiver and an optical transmitter including a phase-modulation light source transmitting a modulated light which is modulated by phase modulation; wherein the coherent optical receiver includes a local light source, a 90&#xb0; hybrid circuit, an optoelectronic converter, an analog to digital converter, and a digital signal processing unit; wherein the 90&#xb0; hybrid circuit makes multiplexed signal light interfere with local light from the local light source, and outputs a plurality of optical signals separated into a plurality of signal components; the optoelectronic converter detects the optical signals and outputs detected electrical signals; the analog to digital converter quantizes the detected electrical signals and outputs quantized signals; the digital signal processing unit includes a skew compensation unit for compensating a difference in propagation delay between the plurality of signal components, and an FFT operation unit for performing a fast Fourier transform process on the quantized signals; and wherein the difference in propagation delay is calculated on the basis of a plurality of peak values with a central focus on one peak value in the results of performing the fast Fourier transform process in cases where the modulated light is inputted from the phase-modulation light source into the 90&#xb0; hybrid circuit and is made to interfere with the local light.</p>
<p id="p-0018" num="0018">A method for detecting inter-channel skew in a coherent optical receiver according to an exemplary aspect of the invention includes the steps of: outputting a plurality of optical signals separated into a plurality of signal components by making a test light from a test light source interfere with a local light from a local light source; detecting the optical signals and outputting detected electrical signals; quantizing the detected electrical signals and outputting quantized signals; performing a fast Fourier transform process on the quantized signals; and calculating a difference in propagation delay between the plurality of signal components on the basis of a plurality of peak values with a central focus on one peak value in the results of performing the fast Fourier transform process.</p>
<heading id="h-0007" level="1">Effect of the Invention</heading>
<p id="p-0019" num="0019">According to the coherent optical receiver by the present invention, even if a skew arises between the channels, it becomes possible to achieve sufficient demodulation and thus to suppress deterioration of reception performance.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0008" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0020" num="0020"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram showing the configuration of a coherent optical receiver in accordance with the first exemplary embodiment of the present invention.</p>
<p id="p-0021" num="0021"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram showing the configuration of an apparatus for detecting inter-channel skew in the coherent optical receiver in accordance with the first exemplary embodiment of the present invention.</p>
<p id="p-0022" num="0022"><figref idref="DRAWINGS">FIG. 3</figref> is a flowchart illustrating a method for detecting inter-channel skew in the coherent optical receiver in accordance with the first exemplary embodiment of the present invention.</p>
<p id="p-0023" num="0023"><figref idref="DRAWINGS">FIG. 4</figref> is a diagrammatic illustration where FFT data are plotted against point number, which are derived by an FFT operation unit in the coherent optical receiver in accordance with the first exemplary embodiment of the present invention.</p>
<p id="p-0024" num="0024"><figref idref="DRAWINGS">FIG. 5</figref> is a diagrammatic illustration plotting the relations between phase difference and angular frequency at Q<sub>x </sub>port and I<sub>y </sub>port of the coherent optical receiver in accordance with the first exemplary embodiment of the present invention.</p>
<p id="p-0025" num="0025"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart illustrating another method for detecting inter-channel skew in the coherent optical receiver in accordance with the first exemplary embodiment of the present invention.</p>
<p id="p-0026" num="0026"><figref idref="DRAWINGS">FIG. 7</figref> is a diagrammatic illustration plotting another set of the relations between phase difference and angular frequency at Q<sub>x </sub>port and I<sub>y </sub>port of the coherent optical receiver in accordance with the first exemplary embodiment of the present invention.</p>
<p id="p-0027" num="0027"><figref idref="DRAWINGS">FIG. 8</figref> is a block diagram showing the configuration of an apparatus for detecting inter-channel skew in the coherent optical receiver in accordance with the second exemplary embodiment of the present invention.</p>
<p id="p-0028" num="0028"><figref idref="DRAWINGS">FIG. 9</figref> is a diagrammatic illustration where FFT data are plotted against point number, which are derived by an FFT operation unit in the coherent optical receiver in accordance with the second exemplary embodiment of the present invention.</p>
<p id="p-0029" num="0029"><figref idref="DRAWINGS">FIG. 10</figref> is a block diagram showing the configuration of an apparatus for detecting inter-channel skew in the coherent optical receiver in accordance with the third exemplary embodiment of the present invention.</p>
<p id="p-0030" num="0030"><figref idref="DRAWINGS">FIG. 11</figref> is a flowchart illustrating a method for detecting inter-channel skew in the coherent optical receiver in accordance with the third exemplary embodiment of the present invention.</p>
<p id="p-0031" num="0031"><figref idref="DRAWINGS">FIG. 12</figref> is a block diagram showing the configuration of an apparatus for detecting inter-channel skew in the coherent optical receiver in accordance with the fourth exemplary embodiment of the present invention.</p>
<p id="p-0032" num="0032"><figref idref="DRAWINGS">FIG. 13</figref> is a diagrammatic illustration of FFT signal spectra for explaining the operation of an apparatus for detecting inter-channel skew in the coherent optical receiver in accordance with the fourth exemplary embodiment of the present invention.</p>
<p id="p-0033" num="0033"><figref idref="DRAWINGS">FIG. 14</figref> is a diagram showing simulation results produced by application of an apparatus for detecting inter-channel skew in the coherent optical receiver in accordance with the fourth exemplary embodiment of the present invention.</p>
<p id="p-0034" num="0034"><figref idref="DRAWINGS">FIG. 15</figref> is a block diagram showing the configuration of an apparatus for detecting inter-channel skew in the coherent optical receiver in accordance with the fifth exemplary embodiment of the present invention.</p>
<p id="p-0035" num="0035"><figref idref="DRAWINGS">FIG. 16</figref> is an output waveform chart of a phase modulation light source in the apparatus for detecting inter-channel skew in the coherent optical receiver in accordance with the fifth exemplary embodiment of the present invention.</p>
<p id="p-0036" num="0036"><figref idref="DRAWINGS">FIG. 17</figref> is a block diagram showing the configuration of an optical transceiver in accordance with the sixth exemplary embodiment of the present invention.</p>
<p id="p-0037" num="0037"><figref idref="DRAWINGS">FIG. 18</figref> is a block diagram showing the configuration of a related coherent optical receiver.</p>
<p id="p-0038" num="0038"><figref idref="DRAWINGS">FIG. 19</figref> is a block diagram showing the configuration of related 90&#xb0; hybrid circuits and their peripherals.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0009" level="1">DESCRIPTION OF EMBODIMENTS</heading>
<p id="p-0039" num="0039">The exemplary embodiments of the present invention will be described with reference to drawings below.</p>
<heading id="h-0010" level="1">The First Exemplary Embodiment</heading>
<p id="p-0040" num="0040"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram showing the configuration of a coherent optical receiver <b>100</b> in accordance with the first exemplary embodiment of the present invention. The coherent optical receiver <b>100</b> has a local light source <b>110</b>, a 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>120</b>, optoelectronic converters (O/E) <b>130</b>, analog to digital converters (ADC) <b>140</b>, and a digital signal processing unit (DSP) <b>150</b>.</p>
<p id="p-0041" num="0041">The 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>120</b> makes multiplexed signal light (SIGNAL) interfere with the local light from the local light source <b>110</b>, and outputs a plurality of optical signals separated into respective signal components. In the present exemplary embodiment, the cases will be described in which DP-QPSK modulation scheme is used. Accordingly, the 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>120</b> outputs four-wave light signals including four-channel signal components respectively which are composed of in-phase components (I<sub>X</sub>, I<sub>Y</sub>) and quadrature-phase components (Q<sub>X</sub>, Q<sub>Y</sub>) for each of two polarizations (X polarization and Y polarization).</p>
<p id="p-0042" num="0042">The optoelectronic converter (O/E) <b>130</b> detects the respective light signals outputted by the 90&#xb0; hybrid circuit <b>120</b>, and outputs the detected electrical signals. The analog to digital converter (ADC) <b>140</b> quantizes the detected electrical signals, and outputs the quantized signals.</p>
<p id="p-0043" num="0043">The digital signal processing unit (DSP) <b>150</b> is provided with a skew compensation unit <b>151</b> which compensates the difference in propagation delay between a plurality of signal components (hereinafter, also referred to as &#x201c;skew&#x201d;), and a demodulation unit <b>152</b>. The skew compensation unit <b>151</b> can be configured by using an FIR (Finite Impulse Response) filter, for example; and in such a case, it holds filter coefficients which are determined on the basis of a skew value. The demodulation unit <b>152</b> separates quantized signals into X polarization signals and Y polarization signals by the polarization demultiplexing process, and then demodulates each of the four-channel signal components by the phase estimation process.</p>
<p id="p-0044" num="0044">Next, a method for detecting inter-channel skew in the coherent optical receiver <b>100</b> will be described, referring to <figref idref="DRAWINGS">FIG. 2</figref>. In the following, the case will be described in which the digital signal processing unit (DSP) <b>150</b> in the coherent optical receiver <b>100</b> is provided with a buffer unit (BUF) <b>153</b> and an FFT operation unit (FFT) <b>154</b>. Here, the FFT operation unit <b>154</b> performs a fast Fourier transform (referred to as &#x201c;FFT&#x201d;, hereinafter) process on the quantized signals outputted by analog to digital converters <b>140</b>. In <figref idref="DRAWINGS">FIG. 2</figref>, illustrations of the skew compensation unit <b>151</b> and the demodulation unit <b>152</b> are omitted.</p>
<p id="p-0045" num="0045">In the following, first, the case will be described in which there is a 90&#xb0; error between I port and Q port in the 90&#xb0; hybrid circuit. That is, although there is a delay corresponding to the signal cycle of 90&#xb0; between I port and Q port in the 90&#xb0; hybrid circuit, the phase difference does not necessarily correspond to 90&#xb0; exactly due to the variability in the manufacturing process of the 90&#xb0; hybrid circuit. Taking into account a delay &#x394;&#x3c4; due to the error in the 90&#xb0; phase difference, the formula (5) described above is changed into the following formula (6).
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Q</i><sub>X</sub>(<i>t</i>)=sin(&#x394;&#x3c9;(<i>t+T</i>)+&#x394;&#x3c4;)&#x2003;&#x2003;(6)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
When there exists this 90&#xb0; error, the output signal from port Q<sub>X </sub>expressed by the formula (4) changes into the output signal expressed by the formula (6), and also in this case, demodulation becomes insufficient even though digital signal processing is performed, and thus sufficient performance cannot be achieved.
</p>
<p id="p-0046" num="0046">As shown in <figref idref="DRAWINGS">FIG. 2</figref>, a test light source <b>170</b> and a control block <b>180</b> are connected to the coherent optical receiver <b>100</b>, and thereby an apparatus for detecting inter-channel skew in the coherent optical receiver <b>1000</b> is configured. The control block <b>180</b> includes a control unit <b>181</b>, a memory unit <b>182</b> and an operational processing unit <b>183</b>. The operational processing unit <b>183</b> is provided with a peak detection unit <b>184</b> and a skew calculation unit <b>185</b>, and calculates a skew value from FFT processed results. Here, the peak detection unit <b>184</b> and the skew calculation unit <b>185</b> can be configured by specific signal processing circuits, and may also be configured by a central processing unit (CPU) and programs for enabling the CPU to execute a process.</p>
<p id="p-0047" num="0047">The test light source (TEST) <b>170</b> is connected to a signal port <b>121</b> of the 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>120</b>, and the local light source <b>110</b> to a local port <b>122</b>. Light components outputted from the I<sub>X</sub>, Q<sub>X</sub>, I<sub>Y</sub>, and Q<sub>Y </sub>ports, which are output ports of the 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>120</b>, are inputted into the optoelectronic converters (O/E) <b>130</b>, respectively.</p>
<p id="p-0048" num="0048">In detecting inter-channel skew in the coherent optical receiver <b>100</b>, first, a continuous wave (CW) light as a test light with a frequency f<sub>S </sub>(its wavelength is equal to &#x3bb;<sub>s</sub>) is inputted from the test light source <b>170</b> into the signal port <b>121</b>. Here, a wavelength tunable light source can be used for the test light source <b>170</b>. On the other hand, a CW light as a local light of a frequency f<sub>0 </sub>(its wavelength is equal to &#x3bb;<sub>0</sub>) is inputted from the local light source <b>110</b> into the local port <b>122</b>. The test light of frequency f<sub>S </sub>and the local light of frequency f<sub>0 </sub>interfere in the 90&#xb0; hybrid circuit <b>120</b>, and beat signals of a frequency f<sub>IF</sub>=|f<sub>S</sub>&#x2212;f<sub>0</sub>| are outputted. Here, the beat signals outputted from the I<sub>X</sub>, Q<sub>X</sub>, I<sub>Y</sub>, and Q<sub>Y </sub>ports are represented by the following formulae from (7) to (10), respectively.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>I</i><sub>X</sub>=cos(2<i>&#x3c0;f</i><sub>IF</sub><i>t+&#x3c6;</i><sub>IX</sub>)&#x2003;&#x2003;(7)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Q</i><sub>X</sub>=sin(2<i>&#x3c0;f</i><sub>IF</sub><i>t+&#x3c6;</i><sub>QX</sub>)&#x2003;&#x2003;(8)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>I</i><sub>Y</sub>=cos(2<i>&#x3c0;f</i><sub>IF</sub><i>t+&#x3c6;</i><sub>IY</sub>)&#x2003;&#x2003;(9)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Q</i><sub>Y</sub>=sin(2<i>&#x3c0;f</i><sub>IF</sub><i>t+&#x3c6;</i><sub>QY</sub>)&#x2003;&#x2003;(10)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0049" num="0049">These beat signals are converted into electrical signals by the optoelectronic converters (O/E) <b>130</b>, quantized by the analog to digital converters (ADC) <b>140</b>, and then inputted into the digital signal processing unit (DSP) <b>150</b>, respectively. In the digital signal processing unit (DSP) <b>150</b>, the signals are divided into blocks with respect to each predetermined processing unit (4096 bits, for example) by buffer units <b>153</b>, and subjected to an FFT process in the FFT operation unit (FFT) <b>154</b>. As a result, each of matrices I^<sub>x</sub>(N), Q^<sub>x</sub>(N), I^<sub>y</sub>(N), and Q^<sub>y</sub>(N) is obtained as each output of the FFT operation unit <b>154</b>. Here, &#x201c;N&#x201d; represents a point number of FFT and it is equal to a value from 0 to 4095, for example.</p>
<p id="p-0050" num="0050">Next, the method for detecting inter-channel skew in the coherent optical receiver in accordance with the present exemplary embodiment will be described referring to the flowchart shown in <figref idref="DRAWINGS">FIG. 3</figref>. First, a frequency of the test light source <b>170</b> is set at a frequency f<sub>S1 </sub>(its wavelength is equal to &#x3bb;<sub>S1</sub>) (step S<b>1</b>). Accordingly, a beat signal of a frequency f<sub>IF</sub>=|f<sub>S1</sub>&#x2212;f<sub>0</sub>| is outputted from each output port of the 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>120</b>.</p>
<p id="p-0051" num="0051">Next, data capturing process is started (step S<b>2</b>). At that time, the control unit <b>181</b> in the control block <b>180</b> transmits a data-capture signal to the digital signal processing unit (DSP) <b>150</b> (step S<b>3</b>). The FFT operation unit <b>154</b> receives the data-capture signal, triggered by the signal, it performs an FFT process on the data stored in the buffer units (BUF) <b>153</b> at that time (step S<b>4</b>), and returns FFT data I^<sub>x</sub>(N) Q^<sub>x</sub>(N), I^<sub>y</sub>(N), and Q^<sub>y</sub>(N) to the control unit <b>181</b>. The control unit <b>181</b> stores the acquired FFT data in the memory unit <b>182</b> (step S<b>5</b>).</p>
<p id="p-0052" num="0052">By an instruction from the control unit <b>181</b>, the peak detection unit <b>184</b> in the operational processing unit <b>183</b> extracts the data I^<sub>x</sub>(N<sub>max</sub>) having the maximum magnitude from 4096 points of the FFT data I^<sub>x</sub>(N). The frequency (peak frequency) f<sub>max </sub>and the phase (peak phase) &#x3c6;<sub>max </sub>at that point are derived by calculation (step S<b>6</b>). In <figref idref="DRAWINGS">FIG. 4</figref>, a diagrammatic illustration is shown where I^<sub>x</sub>(N) are plotted against point number N. Here, since the FFT data I^<sub>x</sub>(N) are composed of complex numbers, the vertical axis of the figure represents the magnitude of I^<sub>x</sub>(N), |I^<sub>x</sub>(N)|, and the horizontal axis represents the point number N in the FFT data. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, if |I^<sub>x</sub>(N)| has a peak value at the point number N<sub>max </sub>the peak detection unit <b>184</b> detects the I^<sub>x</sub>(N<sub>max</sub>). Here, f<sub>T </sub>representing a sampling frequency in the analog to digital converters (ADC) <b>140</b>, a frequency interval of the FFT process is equal to f<sub>T</sub>/4096. Therefore, the peak frequency f<sub>max </sub>at the peak of I^<sub>x</sub>(N) is equal to N<sub>max</sub>f<sub>T</sub>/4096. And then, peak phase information &#x3c6;<sub>max</sub>=&#x2220;(I^<sub>x</sub>(N<sub>max</sub>)) is calculated by using the FFT data I^<sub>x</sub>(N<sub>max</sub>) at the peak frequency f<sub>max</sub>.</p>
<p id="p-0053" num="0053">In this way, the peak detection unit <b>184</b> derives the peak frequency f<sub>max </sub>and the peak phase &#x3c6;<sub>max </sub>at the peak of the magnitude of the FFT data I^<sub>x</sub>(N), and the control unit <b>181</b> stores them in the memory unit <b>182</b> as a frequency f<sub>IX(1,1) </sub>and a phase &#x3c6;<sub>IX(1,1) </sub>(step S<b>7</b>). At that time, the other data of the FFT data I^<sub>x</sub>(N) can be eliminated.</p>
<p id="p-0054" num="0054">In order to reduce the influence of a measurement error, the processes from step <b>3</b> to step <b>7</b> are repeated n times, and frequencies f<sub>IX(1,n) </sub>and phases &#x3c6;<sub>IX(1,n) </sub>are stored in the memory unit <b>182</b>, respectively (feedback loop FB<b>1</b>). When the n-th loop has completed, an ending flag is set (step <b>8</b>).</p>
<p id="p-0055" num="0055">Next, after changing a frequency of the test light source <b>170</b> into a frequency f<sub>S2 </sub>(step S<b>9</b>), the processes from step <b>2</b> to step <b>7</b> are repeated again, and then frequencies f<sub>IX(2,n) </sub>and phases &#x3c6;<sub>IX(2,n) </sub>are stored in the memory unit <b>182</b> (step S<b>7</b>). When detecting an ending flag (step S<b>8</b>), a frequency of the test light source <b>170</b> is further swept (step S<b>9</b>), and then the processes from step <b>2</b> to step <b>8</b> are repeated again (feedback loop FB<b>2</b>). By repeating the feedback loop FB<b>2</b> m times, frequencies f<sub>IX(m,n) </sub>and phases &#x3c6;<sub>IX(m,n) </sub>are stored in the memory unit <b>182</b>, respectively. By performing similar processes for Q^<sub>x</sub>(N), I^<sub>y</sub>(N), and Q^<sub>y</sub>(N), frequencies f<sub>QX(m,n)</sub>, f<sub>IY(m,n)</sub>, and f<sub>QY(m,n)</sub>, and phases &#x3c6;<sub>QX(m,n)</sub>, &#x3c6;<sub>IY(m,n)</sub>, and &#x3c6;<sub>QY(m,n) </sub>are stored in the memory unit <b>182</b>, respectively.</p>
<p id="p-0056" num="0056">When the above-mentioned processes have completed, by an instruction from the control unit <b>181</b>, the skew calculation unit <b>185</b> in the operational processing unit <b>183</b> calculates skews (step S<b>10</b>). For example, using the I<sub>x </sub>port as a reference, a skew in the I<sub>x </sub>port becomes zero, and a skew in each of the ports Q<sub>x</sub>, I<sub>y</sub>, and Q<sub>y </sub>is represented by phase lead or phase lag against the I<sub>x </sub>port. Specifically, first, the phase differences in the respective ports are obtained for a measurement cycle number n and a measurement frequency m by calculating the following quantities, respectively.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>IX(m,n)</sub>=0<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>QX(m,n)</sub>&#x2212;&#x3c6;<sub>IX(m,n) </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>IY(m,n)</sub>&#x2212;&#x3c6;<sub>IX(m,n) </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>QY(m,n)</sub>&#x2212;&#x3c6;<sub>IX(m,n) </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0057" num="0057"><figref idref="DRAWINGS">FIG. 5</figref> shows a diagrammatic illustration plotting the relations between each phase difference of &#x3c6;<sub>QX-IX </sub>and &#x3c6;<sub>IY-IX </sub>in the Q<sub>X </sub>port and I<sub>Y </sub>port using the I<sub>X </sub>port as a reference and the angular frequency 2&#x3c0;f<sub>max</sub>. By using this figure, approximation formulae represented by linear functions are derived for the Q<sub>X </sub>port and I<sub>Y </sub>port respectively, as follows.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>QX-IX</sub><i>=T</i><sub>1</sub>(2<i>&#x3c0;f</i>)+&#x3c6;<sub>1 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>IY-IX</sub><i>=T</i><sub>2</sub>(2<i>&#x3c0;f</i>)+&#x3c6;<sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
An approximation formula is similarly derived for the Q<sub>Y </sub>port as follows.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>QY-IX</sub><i>=T</i><sub>3</sub>(2<i>&#x3c0;f</i>)+&#x3c6;<sub>3 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0058" num="0058">Each gradient of T<sub>1</sub>, T<sub>2</sub>, and T<sub>3 </sub>obtained here represents a skew against the I<sub>x </sub>port. Here, the accuracy in the skew detection is obtained by the relation between the point number N of the FFT process and f<sub>IF</sub>. For example, since a period is equal to 1 ns (=1000 ps) with f<sub>IF </sub>being equal to 1 GHz, the accuracy of the skew detection becomes equal to 0.24 ps (=1000/4096) when N is equal to 4096. That is, it is found that the detection accuracy deteriorates with f<sub>IF </sub>decreasing.</p>
<p id="p-0059" num="0059">On the other hand, a phase difference in the Q<sub>Y </sub>port against the I<sub>Y </sub>port is represented as follows.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>QY(m,n)</sub>&#x2212;&#x3c6;<sub>IY(m,n) </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Here, the relation to the angular frequency 2&#x3c0;f<sub>max </sub>is approximately represented by the following linear function, as is the case mentioned above.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>QY-IY</sub><i>=T</i><sub>4</sub>(2<i>&#x3c0;f</i>)+&#x3c6;<sub>4 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0060" num="0060">Since each of the phase differences &#x3c6;<sub>QX-IX </sub>and &#x3c6;<sub>QY-IY </sub>is equal to &#x3c0;/2 without frequency offset, each of &#x3c6;<sub>1 </sub>and &#x3c6;<sub>4 </sub>should become &#x3c0;/2. Therefore, the 90&#xb0; error between the I<sub>X </sub>port and the Q<sub>X </sub>port, and that between the I<sub>Y </sub>port and the Q<sub>Y </sub>ports become &#x3c6;<sub>1</sub>&#x2212;&#x3c0;/2 and &#x3c6;<sub>4</sub>&#x2212;&#x3c0;/2, respectively. Accordingly, by deriving &#x3c6;<sub>1 </sub>and &#x3c6;<sub>4 </sub>from the y-intercepts of the linear functions shown in <figref idref="DRAWINGS">FIG. 5</figref>, 90&#xb0; errors in the I<sub>Y </sub>port and the Q<sub>Y </sub>port are obtained.</p>
<p id="p-0061" num="0061">As mentioned above, according to the apparatus and the method for detecting inter-channel skew in the coherent optical receiver of this exemplary embodiment, it becomes possible to calculate skews between the output ports and 90&#xb0; errors between I port and Q port. That is to say, it is possible to input test light into the signal port of the 90&#xb0; hybrid circuit, observe beat signals between the test light and the local light by means of analog to digital converters, and calculate the skews and the 90&#xb0; errors by using the phase information obtained by performing an FFT operation. Further, according to the coherent optical receiver <b>100</b> of the present exemplary embodiment, by compensating the skew values obtained above in the skew compensation unit <b>151</b> of the digital signal processing unit <b>150</b>, it becomes possible to demodulate sufficiently even though there arises a skew between the channels, and suppress the degradation of receiving performance.</p>
<p id="p-0062" num="0062">In the above-mentioned exemplary embodiment, the 90&#xb0; error between I port and Q port is calculated by obtaining the difference in peak phase between the channels at each of the frequencies with sweeping the frequency of the test light source as shown by the feedback loop FB<b>2</b> in <figref idref="DRAWINGS">FIG. 3</figref>. However, if the 90&#xb0; error can be neglected, it is possible to detect an inter-channel skew more simply.</p>
<p id="p-0063" num="0063"><figref idref="DRAWINGS">FIG. 6</figref> shows a flowchart of the method for detecting inter-channel skew for this case. First, a frequency of the test light source <b>170</b> is set at a frequency f<sub>S1 </sub>(its wavelength is equal to &#x3bb;<sub>1</sub>) (step S<b>1</b>). Accordingly, the beat signal of the frequency f<sub>IF</sub>=|f<sub>S1</sub>&#x2212;f<sub>0</sub>| is outputted from each output port of the 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>120</b>.</p>
<p id="p-0064" num="0064">Next, data capturing process is started (step S<b>2</b>). At that time, the control unit <b>181</b> in the control block <b>180</b> transmits a data-capture signal to the digital signal processing unit (DSP) <b>150</b> (step S<b>3</b>). The FFT operation unit <b>154</b> receives the data-capture signal, triggered by the signal, it performs an FFT process on the data stored in the buffer units (BUF) <b>153</b> at that time (step S<b>4</b>), and returns FFT data I^<sub>x</sub>(N), Q^<sub>x</sub>(N), I^<sub>y</sub>(N), and Q^<sub>y</sub>(N) to the control unit <b>181</b>. The control unit <b>181</b> stores the acquired FFT data in the memory unit <b>182</b> (step S<b>5</b>).</p>
<p id="p-0065" num="0065">By an instruction from the control unit <b>181</b>, the peak detection unit <b>184</b> in the operational processing unit <b>183</b> extracts the data I^<sub>x</sub>(N<sub>max</sub>) having the maximum magnitude from 4096 points of the FFT data I^<sub>x</sub>(N). The frequency (peak frequency) f<sub>max </sub>and the phase (peak phase) &#x3c6;<sub>max </sub>at that point are derived by calculation (step S<b>6</b>). The control unit <b>181</b> stores this peak frequency and this peak phase in the memory unit <b>182</b> as a frequency f<sub>IX(1) </sub>and a phase &#x3c6;<sub>IX(1) </sub>(step S<b>7</b>).</p>
<p id="p-0066" num="0066">In order to reduce the influence of a measurement error, the processes from step <b>3</b> to step <b>7</b> are repeated n times, and frequencies f<sub>IX(n) </sub>and phases &#x3c6;<sub>IX(n) </sub>are stored in the memory unit <b>182</b>, respectively (feedback loop FB<b>1</b>). When the n-th loop has completed, an ending flag is set (step <b>8</b>).</p>
<p id="p-0067" num="0067">When detecting the end flag, by an instruction from the control unit <b>181</b>, the skew calculation unit <b>185</b> in the operational processing unit <b>183</b> calculates skews (step S<b>9</b>). For example, phase differences of the Q<sub>X</sub>, I<sub>Y</sub>, and Q<sub>Y </sub>ports are obtained using the I<sub>X </sub>port as a reference for number of measurements n respectively, as follows.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>IX(n)</sub>=0<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>QX(n)</sub>&#x2212;&#x3c6;<sub>IX(n) </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>IY(n)</sub>&#x2212;&#x3c6;<sub>IX(n) </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>QY(n)</sub>&#x2212;&#x3c6;<sub>IX(n) </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0068" num="0068"><figref idref="DRAWINGS">FIG. 7</figref> shows a diagrammatic illustration plotting the relations between each phase difference of &#x3c6;<sub>QX-IX </sub>and &#x3c6;<sub>IY-IX </sub>in the Q<sub>X </sub>port and I<sub>Y </sub>port using the I<sub>X </sub>port as a reference and the angular frequency 2&#x3c0;f<sub>max</sub>. Here, if a 90&#xb0; error between the I port and the Q port can be neglected, approximation formulae represented by linear functions are derived for the Q<sub>X </sub>port and I<sub>Y </sub>port respectively, as follows.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>QX-IX</sub><i>=a</i><sub>1</sub>(2<i>&#x3c0;f</i>)+&#x3c0;/2<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>IY-IX</sub><i>=a</i><sub>2</sub>(2<i>&#x3c0;f</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
An approximation formula can be similarly derived for the Q<sub>Y </sub>port as follows.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>QY-IX</sub><i>=a</i><sub>3</sub>(2<i>&#x3c0;f</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Each gradient of a<sub>1</sub>, a<sub>2</sub>, and a<sub>3 </sub>obtained here represents a skew against the I<sub>X </sub>port.
</p>
<p id="p-0069" num="0069">In this way, if a 90&#xb0; error can be neglected, an inter-channel skew can be detected more simply.</p>
<heading id="h-0011" level="1">The Second Exemplary Embodiment</heading>
<p id="p-0070" num="0070">Next, the second exemplary embodiment of the present invention will be described. <figref idref="DRAWINGS">FIG. 8</figref> is a block diagram showing the configuration of an apparatus for detecting inter-channel skew in the coherent optical receiver <b>2000</b> in accordance with the second exemplary embodiment of the present invention. The apparatus for detecting inter-channel skew in the coherent optical receiver <b>2000</b> has a coherent optical receiver <b>200</b>, a test light source <b>270</b>, and a control block <b>280</b> connected to the coherent optical receiver <b>200</b>.</p>
<p id="p-0071" num="0071">The coherent optical receiver <b>200</b> includes a local light source <b>210</b>, a 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>220</b>, optoelectronic converters (O/E) <b>230</b>, analog to digital converters (ADC) <b>240</b>, and a digital signal processing unit (DSP) <b>250</b>. The control block <b>280</b> includes a control unit <b>281</b>, a memory unit <b>282</b>, and an operational processing unit <b>283</b>, where the operational processing unit <b>283</b> is provided with a peak detection unit <b>284</b> and a skew calculation unit <b>285</b>.</p>
<p id="p-0072" num="0072">In the coherent optical receiver <b>200</b> of the present exemplary embodiment, the configuration of the digital signal processing unit (DSP) <b>250</b> is different from that of the digital signal processing unit (DSP) <b>150</b> in accordance with the first exemplary embodiment. The digital signal processing unit (DSP) <b>250</b> is provided with a complex signal generator <b>252</b>, buffer units (BUF) <b>253</b>, and an FFT operation unit (FFT) <b>254</b>.</p>
<p id="p-0073" num="0073">The test light source (TEST) <b>270</b> is connected to a signal port <b>221</b> of the 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>220</b>, and the local light source <b>210</b> to a local port <b>222</b>. Light components outputted from the I<sub>X</sub>, Q<sub>X</sub>, I<sub>Y</sub>, and Q<sub>Y </sub>ports, which are output ports of the 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>220</b>, are inputted into the optoelectronic converters (O/E) <b>230</b>, respectively. In detecting inter-channel skew in the coherent optical receiver <b>200</b>, first, a continuous wave (CW) light as a test light of a frequency f<sub>S </sub>(its wavelength is equal to &#x3bb;<sub>s</sub>) is inputted from the test light source <b>270</b> into the signal port <b>221</b>. Here, a wavelength tunable light source can be used for the test light source <b>270</b>. On the other hand, a CW light as a local light of a frequency f<sub>0 </sub>(its wavelength is equal to &#x3bb;<sub>0</sub>) is inputted from the local light source <b>210</b> into the local port <b>222</b>. The test light of frequency f<sub>S </sub>and the local light of frequency f<sub>0 </sub>interfere in the 90&#xb0; hybrid circuit <b>220</b>, and beat signals of a frequency f<sub>IF</sub>=|f<sub>S</sub>&#x2212;f<sub>0</sub>| are outputted. Here, the beat signals outputted from the I<sub>X</sub>, Q<sub>X</sub>, I<sub>Y</sub>, and Q<sub>Y </sub>ports are represented by the above-mentioned formulae from (7) to (10) as is the case in the first exemplary embodiment.</p>
<p id="p-0074" num="0074">These beat signals are converted into electrical signals by the optoelectronic converters (O/E) <b>230</b>, quantized by the analog to digital converters (ADC) <b>240</b>, and then inputted into the digital signal processing unit (DSP) <b>250</b>, respectively. In the digital signal processing unit (DSP) <b>250</b>, the signals from the I port and the Q port are synthesized, and then processed as complex signals. That is, the complex signal generator <b>252</b> receives I<sub>x </sub>and Q<sub>x</sub>, and outputs a complex signal of E<sub>x</sub>=I<sub>x</sub>+jQ<sub>x</sub>. Similarly, it receives I<sub>y </sub>and Q<sub>y </sub>and outputs a complex signal of E<sub>y</sub>=I<sub>y</sub>+jQ<sub>y</sub>.</p>
<p id="p-0075" num="0075">These complex signals E<sub>x </sub>and E<sub>y </sub>are divided into blocks with respect to each predetermined processing unit (4096 bits, for example) by buffer units <b>253</b>, and subjected to an FFT process in the FFT operation unit (FFT) <b>254</b>. As a result, each of matrices E^<sub>x</sub>(N) and E^<sub>y</sub>(N) is obtained as each output of the FFT operation unit <b>254</b>. Here, &#x201c;N&#x201d; represents a point number of FFT and it is equal to a value from 0 to 4095, for example.</p>
<p id="p-0076" num="0076">In this case, E^<sub>x</sub>(N) is represented by the following formulae.</p>
<p id="p-0077" num="0077">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>cos</mi>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>[</mo>
        <mrow>
          <mi>&#x394;&#x3c9;</mi>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>t</mi>
              <mo>-</mo>
              <msub>
                <mi>T</mi>
                <mn>1</mn>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>]</mo>
      </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
      <mi>j</mi>
      <mo>&#x2062;</mo>
      <mstyle>
        <mspace width="0.3em" height="0.3ex"/>
      </mstyle>
      <mo>&#x2062;</mo>
      <mrow>
        <mi>sin</mi>
        <mo>&#x2061;</mo>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mi>&#x394;&#x3c9;</mi>
            <mo>&#x2061;</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mi>t</mi>
                <mo>-</mo>
                <msub>
                  <mi>T</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>]</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mrow>
        <mfrac>
          <mn>1</mn>
          <mn>2</mn>
        </mfrac>
        <mo>&#x2062;</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msup>
              <mi>&#x2147;</mi>
              <mrow>
                <mi>j&#x394;&#x3c9;</mi>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>t</mi>
                    <mo>-</mo>
                    <msub>
                      <mi>T</mi>
                      <mn>1</mn>
                    </msub>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </msup>
            <mo>+</mo>
            <msup>
              <mi>&#x2147;</mi>
              <mrow>
                <mrow>
                  <mo>-</mo>
                  <mi>j&#x394;</mi>
                </mrow>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mrow>
                  <mi>&#x3c9;</mi>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>t</mi>
                      <mo>-</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>1</mn>
                      </msub>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </msup>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
        <mfrac>
          <mn>1</mn>
          <mn>2</mn>
        </mfrac>
        <mo>&#x2062;</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msup>
              <mi>&#x2147;</mi>
              <mrow>
                <mi>j&#x394;&#x3c9;</mi>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>t</mi>
                    <mo>-</mo>
                    <msub>
                      <mi>T</mi>
                      <mn>2</mn>
                    </msub>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </msup>
            <mo>-</mo>
            <msup>
              <mi>&#x2147;</mi>
              <mrow>
                <mrow>
                  <mo>-</mo>
                  <mi>j&#x394;</mi>
                </mrow>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mrow>
                  <mi>&#x3c9;</mi>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>t</mi>
                      <mo>-</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>2</mn>
                      </msub>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </msup>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mfrac>
          <mn>1</mn>
          <mn>2</mn>
        </mfrac>
        <mo>&#x2062;</mo>
        <mrow>
          <mo>{</mo>
          <mrow>
            <mrow>
              <msup>
                <mi>&#x2147;</mi>
                <mrow>
                  <mi>j&#x394;&#x3c9;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>t</mi>
                </mrow>
              </msup>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msup>
                    <mi>&#x2147;</mi>
                    <mrow>
                      <mrow>
                        <mo>-</mo>
                        <mi>j&#x394;</mi>
                      </mrow>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>&#x3c9;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>1</mn>
                      </msub>
                    </mrow>
                  </msup>
                  <mo>+</mo>
                  <msup>
                    <mi>&#x2147;</mi>
                    <mrow>
                      <mrow>
                        <mo>-</mo>
                        <mi>j&#x394;</mi>
                      </mrow>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>&#x3c9;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>2</mn>
                      </msub>
                    </mrow>
                  </msup>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>+</mo>
            <mrow>
              <msup>
                <mi>&#x2147;</mi>
                <mrow>
                  <mrow>
                    <mo>-</mo>
                    <mi>j&#x394;&#x3c9;</mi>
                  </mrow>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>t</mi>
                </mrow>
              </msup>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msup>
                    <mi>&#x2147;</mi>
                    <mrow>
                      <mi>j&#x394;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>&#x3c9;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>1</mn>
                      </msub>
                    </mrow>
                  </msup>
                  <mo>-</mo>
                  <msup>
                    <mi>&#x2147;</mi>
                    <mrow>
                      <mi>j&#x394;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>&#x3c9;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>2</mn>
                      </msub>
                    </mrow>
                  </msup>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>}</mo>
        </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
        <mfrac>
          <mn>1</mn>
          <mn>2</mn>
        </mfrac>
        <mo>&#x2062;</mo>
        <mrow>
          <mo>{</mo>
          <mrow>
            <mrow>
              <msup>
                <mi>&#x2147;</mi>
                <mrow>
                  <mi>j&#x394;&#x3c9;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>t</mi>
                </mrow>
              </msup>
              <mo>&#x2062;</mo>
              <msub>
                <mi>P</mi>
                <mn>1</mn>
              </msub>
            </mrow>
            <mo>+</mo>
            <mrow>
              <msup>
                <mi>&#x2147;</mi>
                <mrow>
                  <mrow>
                    <mo>-</mo>
                    <mi>j&#x394;</mi>
                  </mrow>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>&#x3c9;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>t</mi>
                </mrow>
              </msup>
              <mo>&#x2062;</mo>
              <msub>
                <mi>P</mi>
                <mn>2</mn>
              </msub>
            </mrow>
          </mrow>
          <mo>}</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
where P<sub>1</sub>, P<sub>2</sub>, and &#x394;&#x3c9; are represented by the following formulae.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>P</i><sub>1</sub><i>=e</i><sup>&#x2212;j&#x394;&#x3c9;T</sup><sup><sub2>1</sub2></sup><i>+e</i><sup>&#x2212;j&#x394;&#x3c9;T</sup><sup><sub2>2 </sub2></sup><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>P</i><sub>2</sub><i>=e</i><sup>j&#x394;&#x3c9;T</sup><sup><sub2>1</sub2></sup><i>&#x2212;e</i><sup>j&#x394;&#x3c9;T</sup><sup><sub2>2 </sub2></sup><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;&#x3c9;=2&#x3c0;<i>f</i><sub>IF </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0078" num="0078">Next, the method for detecting inter-channel skew in the coherent optical receiver in accordance with the present exemplary embodiment will be described. The flow of its process is similar to that in the first exemplary embodiment, and therefore the following description will be given also referring to the flowchart shown in <figref idref="DRAWINGS">FIG. 3</figref>. First, a frequency of the test light source <b>270</b> is set at a frequency f<sub>S1 </sub>(its wavelength is equal to &#x3bb;<sub>S1</sub>) (step S<b>1</b>). Accordingly, a beat signal of a frequency f<sub>IF</sub>=|f<sub>S1</sub>&#x2212;f<sub>0</sub>| is outputted from each output port of the 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>220</b>.</p>
<p id="p-0079" num="0079">Next, data capturing process is started (step S<b>2</b>). At that time, the control unit <b>281</b> in the control block <b>280</b> transmits a data-capture signal to the digital signal processing unit (DSP) <b>250</b> (step S<b>3</b>). The FFT operation unit <b>254</b> receives the data-capture signal, triggered by the signal, it performs an FFT process on the data stored in the buffer units (BUF) <b>253</b> at that time, and returns FFT data E^<sub>x</sub>(N) and E^<sub>y</sub>(N) to the control unit <b>281</b> (step S<b>4</b>). The control unit <b>281</b> stores the acquired FFT data in the memory unit <b>282</b> (step S<b>5</b>).</p>
<p id="p-0080" num="0080">By an instruction from the control unit <b>281</b>, the peak detection unit <b>284</b> in the operational processing unit <b>283</b> extracts two peak values of P<sub>1</sub>=|E^<sub>x</sub>(N<sub>peak1</sub>)| and P<sub>2</sub>=|E^<sub>x</sub>(N<sub>peak2</sub>)| from 4096 points of the FFT data E^<sub>x</sub>(N). And then, the frequencies of &#xb1;2&#x3c0;f<sub>IF </sub>at that point are derived by calculation (step S<b>6</b>). In <figref idref="DRAWINGS">FIG. 9</figref>, a diagrammatic illustration is shown where E^<sub>x</sub>(N) are plotted against point number N. Here, since the FFT data E^<sub>x</sub>(N) are composed of complex numbers, the vertical axis of the figure represents the magnitude of E^<sub>x</sub>(N), |E^<sub>x</sub>(N)|, and the horizontal axis represents the point number N in the FFT data. As shown in <figref idref="DRAWINGS">FIG. 9</figref>, if |E^<sub>x</sub>(N)| has peak values at the point numbers N<sub>peak1 </sub>and N<sub>peak2</sub>, the peak detection unit <b>284</b> detects P<sub>1 </sub>and P<sub>2</sub>. Here, f<sub>T </sub>representing a sampling frequency in the analog to digital converter (ADC) <b>240</b>, a frequency interval of the FFT process is equal to f<sub>T</sub>/4096. Therefore, the peak frequencies at the peaks of E^<sub>x</sub>(N) are equal to f<sub>peak1</sub>=N<sub>peak1</sub>f<sub>T</sub>/4096 and f<sub>peak2</sub>=&#x2212;(4096&#x2212;N<sub>peak2</sub>)f<sub>T</sub>/4096, respectively.</p>
<p id="p-0081" num="0081">Next, phase information of &#x3c6;<sub>IX </sub>and &#x3c6;<sub>QX </sub>are derived by calculation. First, the peak value P<sub>1 </sub>is given by the following formula.</p>
<p id="p-0082" num="0082">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>P</mi>
          <mn>1</mn>
        </msub>
        <mo>=</mo>
        <mi/>
        <mo>&#x2062;</mo>
        <mrow>
          <msup>
            <mi>&#x2147;</mi>
            <mrow>
              <mrow>
                <mo>-</mo>
                <mi>j</mi>
              </mrow>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mi>&#x394;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mi>&#x3c9;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <msub>
                <mi>T</mi>
                <mn>1</mn>
              </msub>
            </mrow>
          </msup>
          <mo>+</mo>
          <msup>
            <mi>&#x2147;</mi>
            <mrow>
              <mrow>
                <mo>-</mo>
                <mi>j&#x394;</mi>
              </mrow>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mi>&#x3c9;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <msub>
                <mi>T</mi>
                <mn>2</mn>
              </msub>
            </mrow>
          </msup>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mo>=</mo>
        <mi/>
        <mo>&#x2062;</mo>
        <mrow>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mrow>
                <mi>cos</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>&#x394;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>&#x3c9;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <msub>
                  <mi>T</mi>
                  <mn>1</mn>
                </msub>
              </mrow>
              <mo>+</mo>
              <mrow>
                <mi>cos</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>&#x394;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>&#x3c9;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <msub>
                  <mi>T</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <mrow>
            <mi>j</mi>
            <mo>&#x2061;</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mrow>
                    <mo>-</mo>
                    <mi>sin</mi>
                  </mrow>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>&#x394;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>&#x3c9;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <msub>
                    <mi>T</mi>
                    <mn>1</mn>
                  </msub>
                </mrow>
                <mo>-</mo>
                <mrow>
                  <mi>sin</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>&#x394;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>&#x3c9;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <msub>
                    <mi>T</mi>
                    <mn>2</mn>
                  </msub>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mo>=</mo>
        <mi/>
        <mo>&#x2062;</mo>
        <mrow>
          <msub>
            <mi>R</mi>
            <mn>1</mn>
          </msub>
          <mo>+</mo>
          <mrow>
            <mi>j</mi>
            <mo>&#x2062;</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <msub>
              <mi>I</mi>
              <mn>1</mn>
            </msub>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where R<sub>1 </sub>and I<sub>1 </sub>are represented by the following formulae.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i><sub>1</sub>=cos &#x394;&#x3c9;<i>T</i><sub>1</sub>+cos &#x394;&#x3c9;<i>T</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>I</i><sub>1</sub>=&#x2212;sin &#x394;&#x3c9;<i>T</i><sub>1</sub>&#x2212;sin &#x394;&#x3c9;<i>T</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0083" num="0083">Further, the peak value P<sub>2 </sub>is given by the following formula.</p>
<p id="p-0084" num="0084">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>P</mi>
          <mn>2</mn>
        </msub>
        <mo>=</mo>
        <mi/>
        <mo>&#x2062;</mo>
        <mrow>
          <msup>
            <mi>&#x2147;</mi>
            <mrow>
              <mi>j</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mi>&#x394;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mi>&#x3c9;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <msub>
                <mi>T</mi>
                <mn>1</mn>
              </msub>
            </mrow>
          </msup>
          <mo>-</mo>
          <msup>
            <mi>&#x2147;</mi>
            <mrow>
              <mi>j&#x394;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mi>&#x3c9;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <msub>
                <mi>T</mi>
                <mn>2</mn>
              </msub>
            </mrow>
          </msup>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mo>=</mo>
        <mi/>
        <mo>&#x2062;</mo>
        <mrow>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mrow>
                <mi>cos</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>&#x394;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>&#x3c9;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <msub>
                  <mi>T</mi>
                  <mn>1</mn>
                </msub>
              </mrow>
              <mo>-</mo>
              <mrow>
                <mi>cos</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>&#x394;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>&#x3c9;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <msub>
                  <mi>T</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <mrow>
            <mi>j</mi>
            <mo>&#x2061;</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mi>sin</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>&#x394;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>&#x3c9;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <msub>
                    <mi>T</mi>
                    <mn>1</mn>
                  </msub>
                </mrow>
                <mo>-</mo>
                <mrow>
                  <mi>sin</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>&#x394;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>&#x3c9;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <msub>
                    <mi>T</mi>
                    <mn>2</mn>
                  </msub>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mo>=</mo>
        <mi/>
        <mo>&#x2062;</mo>
        <mrow>
          <msub>
            <mi>R</mi>
            <mn>2</mn>
          </msub>
          <mo>+</mo>
          <mrow>
            <mi>j</mi>
            <mo>&#x2062;</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <msub>
              <mi>I</mi>
              <mn>2</mn>
            </msub>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where R<sub>2 </sub>and I<sub>2 </sub>are represented by the following formulae.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i><sub>2</sub>=cos &#x394;&#x3c9;<i>T</i><sub>1</sub>&#x2212;cos &#x394;&#x3c9;<i>T</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>I</i><sub>2</sub>=sin &#x394;&#x3c9;<i>T</i><sub>1</sub>&#x2212;sin &#x394;&#x3c9;<i>T</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0085" num="0085">By those formulae mentioned above, the following relational expressions are obtained.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i><sub>1</sub><i>+R</i><sub>2</sub>=2 cos &#x394;&#x3c9;<i>T</i><sub>1 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i><sub>1</sub><i>&#x2212;R</i><sub>2</sub>=2 cos &#x394;&#x3c9;<i>T</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>I</i><sub>1</sub><i>+I</i><sub>2</sub>=2 sin &#x394;&#x3c9;<i>T</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>I</i><sub>1</sub><i>&#x2212;I</i><sub>2</sub>=&#x2212;2 sin &#x394;&#x3c9;<i>T</i><sub>1 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0086" num="0086">By solving these relational expressions, the phase information of &#x3c6;<sub>IX </sub>and &#x3c6;<sub>QX </sub>are obtained respectively, as follows.</p>
<p id="p-0087" num="0087">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
  <mrow>
    <msub>
      <mi>&#x3d5;</mi>
      <mi>IX</mi>
    </msub>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mi>&#x394;</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mi>&#x3c9;</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <msub>
          <mi>T</mi>
          <mn>1</mn>
        </msub>
      </mrow>
      <mo>=</mo>
      <mrow>
        <msup>
          <mi>tan</mi>
          <mrow>
            <mo>-</mo>
            <mn>1</mn>
          </mrow>
        </msup>
        <mo>&#x2061;</mo>
        <mrow>
          <mo>(</mo>
          <mfrac>
            <mrow>
              <mo>-</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>I</mi>
                    <mn>1</mn>
                  </msub>
                  <mo>-</mo>
                  <msub>
                    <mi>I</mi>
                    <mn>2</mn>
                  </msub>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mrow>
              <msub>
                <mi>R</mi>
                <mn>1</mn>
              </msub>
              <mo>+</mo>
              <msub>
                <mi>R</mi>
                <mn>2</mn>
              </msub>
            </mrow>
          </mfrac>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00004-2" num="00004.2">
<math overflow="scroll">
  <mrow>
    <msub>
      <mi>&#x3d5;</mi>
      <mi>QX</mi>
    </msub>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mi>&#x394;</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mi>&#x3c9;</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <msub>
          <mi>T</mi>
          <mn>2</mn>
        </msub>
      </mrow>
      <mo>=</mo>
      <mrow>
        <msup>
          <mi>tan</mi>
          <mrow>
            <mo>-</mo>
            <mn>1</mn>
          </mrow>
        </msup>
        <mo>&#x2061;</mo>
        <mrow>
          <mo>(</mo>
          <mfrac>
            <mrow>
              <mo>-</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>I</mi>
                    <mn>1</mn>
                  </msub>
                  <mo>+</mo>
                  <msub>
                    <mi>I</mi>
                    <mn>2</mn>
                  </msub>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mrow>
              <msub>
                <mi>R</mi>
                <mn>1</mn>
              </msub>
              <mo>-</mo>
              <msub>
                <mi>R</mi>
                <mn>2</mn>
              </msub>
            </mrow>
          </mfrac>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
</math>
</maths>
</p>
<p id="p-0088" num="0088">In this way, the peak detection unit <b>284</b> derives the frequency f<sub>peak1 </sub>and the peak phases &#x3c6;<sub>IX </sub>and &#x3c6;<sub>QX </sub>at the peak of the magnitude of the FFT data E^<sub>x</sub>(N), and the control unit <b>281</b> stores them in the memory unit <b>182</b> as a frequency f<sub>X(1,1)</sub>, and phases &#x3c6;<sub>IX(1,1) </sub>and &#x3c6;<sub>QX(1,1)</sub>, respectively (step S<b>7</b>). At that time, the other data of the FFT data E^<sub>x</sub>(N) can be eliminated.</p>
<p id="p-0089" num="0089">In order to reduce the influence of a measurement error, the processes from step <b>3</b> to step <b>7</b> are repeated n times, and frequencies f<sub>X(1,n)</sub>, and phases &#x3c6;<sub>IX(1,n) </sub>and &#x3c6;<sub>QX(1,n) </sub>are stored in the memory unit <b>282</b>, respectively (feedback loop FB<b>1</b>). When the n-th loop has completed, an ending flag is set (step S<b>8</b>).</p>
<p id="p-0090" num="0090">Next, after changing a frequency of the test light source <b>270</b> into a frequency f<sub>S2 </sub>(step S<b>9</b>), the processes from step <b>2</b> to step <b>8</b> are repeated again, and then frequencies f<sub>X(2,n) </sub>and phases &#x3c6;<sub>IX(2,n) </sub>and &#x3c6;<sub>QX(2,n) </sub>are stored in the memory unit <b>282</b> and (step S<b>7</b>). When detecting an ending flag (step S<b>8</b>), a frequency of the test light source <b>270</b> is further swept (step S<b>9</b>), and then the processes from step <b>2</b> to step <b>8</b> are repeated again (feedback loop FB<b>2</b>). By repeating the feedback loop FB<b>2</b> m times, frequencies f<sub>X(m,n) </sub>and phases &#x3c6;<sub>IX(m,n) </sub>and &#x3c6;<sub>QX(m,n) </sub>are stored in the memory unit <b>282</b>, respectively. By performing similar processes for E^<sub>y</sub>(N), frequencies f<sub>Y(m,n) </sub>and phases &#x3c6;<sub>IY(m,n) </sub>and &#x3c6;<sub>QY(m,n) </sub>are stored in the memory unit <b>282</b>, respectively.</p>
<p id="p-0091" num="0091">When the above-mentioned processes have completed, by an instruction from the control unit <b>281</b>, the skew calculation unit <b>285</b> in the operational processing unit <b>283</b> calculates skews by a similar method to that in the first exemplary embodiment (step <b>10</b>).</p>
<p id="p-0092" num="0092">As mentioned above, according to the apparatus and the method for detecting inter-channel skew in the coherent optical receiver of this exemplary embodiment, it becomes possible to calculate skews between the output ports and 90&#xb0; errors between I port and Q port. Further, by compensating the skew values obtained above in the skew compensation unit of the digital signal processing unit, with which the coherent optical receiver in accordance with the first exemplary embodiment is provided, it becomes possible to demodulate sufficiently even though there arises a skew between the channels, and suppress the degradation of receiving performance.</p>
<heading id="h-0012" level="1">The Third Exemplary Embodiment</heading>
<p id="p-0093" num="0093">Next, the third exemplary embodiment of the present invention will be described. <figref idref="DRAWINGS">FIG. 10</figref> is a block diagram showing the configuration of an apparatus for detecting inter-channel skew in the coherent optical receiver <b>3000</b> in accordance with the third exemplary embodiment of the present invention. The apparatus for detecting inter-channel skew in the coherent optical receiver <b>3000</b> has a coherent optical receiver <b>300</b>, and a test light source <b>370</b>, a control block <b>380</b>, and a sampling oscilloscope <b>390</b> which are connected to the coherent optical receiver <b>300</b></p>
<p id="p-0094" num="0094">The coherent optical receiver <b>300</b> includes a local light source <b>310</b>, a 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>320</b>, and optoelectronic converters (O/E) <b>330</b>. The control block <b>380</b> includes a control unit <b>381</b>, a memory unit <b>382</b>, and an operational processing unit <b>383</b>, where the operational processing unit <b>383</b> is provided with a peak detection unit <b>384</b>, a skew calculation unit <b>385</b>, and an FFT operation unit (FFT) <b>386</b>.</p>
<p id="p-0095" num="0095">In the present exemplary embodiment, the configuration is different from each of the first and the second exemplary embodiments in that it includes the sampling oscilloscope <b>390</b> instead of a digital signal processing unit (DSP) and the control block <b>380</b> is provided with the FFT operation unit (FFT) <b>386</b>. The sampling oscilloscope <b>390</b> is provided with 4-channel analog to digital converters (ADC) <b>391</b> and memory units <b>392</b>.</p>
<p id="p-0096" num="0096">The test light source (TEST) <b>370</b> is connected to a signal port <b>321</b> of the 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>320</b>, and the local light source <b>310</b> to a local port <b>322</b>. The beat signals outputted from the output ports of the 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>320</b>, that is, I<sub>x </sub>port, Q<sub>x </sub>port, I<sub>y </sub>port, and Q<sub>y </sub>port, are represented by the above-mentioned formulae from (7) to (10) as is the case in the first exemplary embodiment.</p>
<p id="p-0097" num="0097">These beat signals are converted into electrical signals by the optoelectronic converters (O/E) <b>330</b>, quantized by the analog to digital converters (ADC) <b>391</b> in the sampling oscilloscope <b>390</b>, and then waveform data of I<sub>x</sub>(N), Q<sub>x</sub>(N), I<sub>y</sub>(N), and Q<sub>y</sub>(N) are stored in the memory unit <b>392</b>. Here, &#x201c;N&#x201d; represents the number of the data and takes the values from 0 to 4095, for example.</p>
<p id="p-0098" num="0098">Next, referring to a flowchart shown in <figref idref="DRAWINGS">FIG. 11</figref>, the method for detecting inter-channel skew in the coherent optical receiver in accordance with the present exemplary embodiment will be described. First, a frequency of the test light source <b>370</b> is set at a frequency f<sub>S1 </sub>(its wavelength is equal to &#x3bb;<sub>S1</sub>) (step S<b>1</b>). Accordingly, a beat signal of a frequency f<sub>IF</sub>=|f<sub>S1</sub>&#x2212;f<sub>0</sub>| is outputted from each output port of the 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>320</b>.</p>
<p id="p-0099" num="0099">Next, waveform data is captured in the sampling oscilloscope <b>390</b> (step S<b>2</b>). At that time, the control unit <b>381</b> in the control block <b>380</b> transmits a waveform-reading signal to the sampling oscilloscope <b>390</b> (step S<b>3</b>). And then, the waveform data stored at that time in the memory unit <b>392</b> in the sampling oscilloscope <b>390</b> are stored in the memory unit <b>382</b> in the control block <b>380</b> (step S<b>4</b>).</p>
<p id="p-0100" num="0100">The FFT operation unit (FFT) <b>386</b> in the control block <b>380</b> performs an FFT process on waveform data I<sub>x</sub>(N), Q<sub>x</sub>(N), I<sub>y</sub>(N), and Q<sub>y</sub>(N) stored in the memory unit <b>382</b> (step S<b>5</b>). And then, it returns the processed results of FFT data I^<sub>x</sub>(N), Q^<sub>x</sub>(N), I^<sub>y</sub>(N), and Q^<sub>y</sub>(N) to the control unit <b>381</b>. The control unit <b>381</b> stores the acquired FFT data in the memory unit <b>382</b> (step S<b>6</b>).</p>
<p id="p-0101" num="0101">By an instruction from the control unit <b>381</b>, the peak detection unit <b>384</b> in the operational processing unit <b>383</b> extracts the data I^<sub>x</sub>(N<sub>max</sub>) having the maximum magnitude from 4096 points of the FFT data I^<sub>x</sub>(N). Then, the frequency f<sub>max </sub>and the phase &#x3c6;<sub>max </sub>at that point are derived by calculation (step S<b>7</b>).</p>
<p id="p-0102" num="0102">In order to reduce the influence of a measurement error, the processes from step <b>2</b> to step <b>7</b> are repeated n times, and frequencies f<sub>IX(1,n) </sub>and phases &#x3c6;<sub>IX(1,n) </sub>are stored in the memory unit <b>382</b>, respectively (feedback loop FB<b>1</b>). When the n-th loop has completed, a frequency of the test light source <b>370</b> is changed into a frequency f<sub>S2 </sub>(step S<b>8</b>), the processes from step <b>2</b> to step <b>7</b> are repeated again, and then frequencies f<sub>IX(2,n) </sub>and phases &#x3c6;<sub>IX(2,n) </sub>are stored in the memory unit <b>382</b> (feedback loop FB<b>2</b>). By further sweeping the frequency of the test light source <b>370</b> and repeating the feedback loop FB<b>2</b> m times, frequencies f<sub>IX(m,n) </sub>and phases &#x3c6;<sub>IX(m,n) </sub>are stored in the memory unit <b>382</b>, respectively. By performing similar processes for Q^<sub>x</sub>(N), I^<sub>y</sub>(N), and Q^<sub>y</sub>(N), frequencies f<sub>QX(m,n)</sub>, f<sub>IY(m,n)</sub>, f<sub>QY(m,n) </sub>and phases &#x3c6;<sub>QX(m,n)</sub>, &#x3c6;<sub>IY(m,n)</sub>, and &#x3c6;<sub>QY(m,n) </sub>are stored in the memory unit <b>382</b>, respectively.</p>
<p id="p-0103" num="0103">When the above-mentioned processes have completed, by an instruction from the control unit <b>381</b>, the skew calculation unit <b>385</b> in the operational processing unit <b>383</b> calculates skews by a similar method to that in the first exemplary embodiment (step S<b>9</b>).</p>
<p id="p-0104" num="0104">As mentioned above, according to the apparatus and the method for detecting inter-channel skew in the coherent optical receiver of this exemplary embodiment, it becomes possible to calculate skews between the output ports and 90&#xb0; errors between I port and Q port. Further, by compensating the skew values obtained above in the skew compensation unit of the digital signal processing unit, with which the coherent optical receiver in accordance with the first exemplary embodiment is provided, it becomes possible to demodulate sufficiently even though there arises a skew between the channels, and suppress the degradation of receiving performance.</p>
<p id="p-0105" num="0105">In the above-mentioned exemplary embodiments, the coherent optical receiver is provided with the polarization diversity type of 90&#xb0; hybrid circuit. However, the 90&#xb0; hybrid circuit is not limited to that, a single polarization type of 90&#xb0; hybrid circuit or its combination can be used.</p>
<p id="p-0106" num="0106">In addition, although the test light source is connected to the signal port of the 90&#xb0; hybrid circuit and sweeps frequencies in the above-mentioned exemplary embodiments, but not limited to this, by using a wavelength tunable laser as the local light source, the wavelength of the local light source can be swept with the wavelength of the test light source constant.</p>
<heading id="h-0013" level="1">The Fourth Exemplary Embodiment</heading>
<p id="p-0107" num="0107">Next, the fourth exemplary embodiment of the present invention will be described. <figref idref="DRAWINGS">FIG. 12</figref> is a block diagram showing the configuration of an apparatus for detecting inter-channel skew in the coherent optical receiver <b>4000</b> in accordance with the fourth exemplary embodiment of the present invention. The apparatus for detecting inter-channel skew in the coherent optical receiver <b>4000</b> has a coherent optical receiver <b>400</b>, a test light source <b>270</b>, and a control block <b>480</b> connected to the coherent optical receiver <b>400</b>.</p>
<p id="p-0108" num="0108">The coherent optical receiver <b>400</b> includes a local light source <b>210</b>, a 90&#xb0; hybrid circuit (90&#xb0; HYBRID) <b>220</b>, optoelectronic converters (O/E) <b>230</b>, analog to digital converters (ADC) <b>240</b>, and a digital signal processing unit (DSP) <b>450</b>. The control block <b>480</b> includes a control unit <b>281</b>, a memory unit <b>282</b>, and an operational processing unit <b>283</b>, where the operational processing unit <b>283</b> is provided with a multiple peak detection unit <b>484</b> and a skew calculation unit <b>285</b>.</p>
<p id="p-0109" num="0109">In the coherent optical receiver <b>400</b> of the present exemplary embodiment, the configurations of the digital signal processing unit (DSP) <b>450</b> and the control block <b>480</b> are different from those in the second exemplary embodiment. That is to say, the digital signal processing unit (DSP) <b>450</b> includes a skew compensation unit <b>451</b> and a signal processing unit <b>455</b>, and the control block <b>480</b> includes the multiple peak detection unit <b>484</b>. Here, the signal processing unit <b>455</b> performs various kinds of signal processing in digital coherent receiving, such as a clock extraction process, a polarization tracking process, and a compensation process for carrier frequency offset. In <figref idref="DRAWINGS">FIG. 12</figref>, the same components, as those of the apparatus for detecting inter-channel skew in the coherent optical receiver <b>2000</b> in accordance with the second exemplary embodiment shown in <figref idref="DRAWINGS">FIG. 8</figref>, are represented by the same codes and the descriptions about them are omitted.</p>
<p id="p-0110" num="0110">In detecting an inter-channel skew in the coherent optical receiver <b>400</b>, a continuous wave (CW) light as a test light of a frequency f<sub>S </sub>(its wavelength is equal to &#x3bb;<sub>S</sub>) is inputted from the test light source <b>270</b> into the signal port <b>221</b> as is the case in the second exemplary embodiment. Here, a wavelength tunable light source can be used for the test light source <b>270</b>. On the other hand, a CW light as a local light of a frequency f<sub>0 </sub>(its wavelength is equal to &#x3bb;<sub>0</sub>) is inputted from the local light source <b>210</b> into the local port <b>222</b>. The test light of frequency f<sub>S </sub>and the local light of frequency f<sub>0 </sub>interfere in the 90&#xb0; hybrid circuit <b>220</b>, and beat signals of a frequency f<sub>IF</sub>=|f<sub>S</sub>&#x2212;f<sub>0</sub>| are outputted. Here, the beat signals outputted respectively from I<sub>X</sub>, Q<sub>X</sub>, I<sub>Y</sub>, and Q<sub>Y </sub>ports are represented by the above-mentioned formulae from (7) to (10) as is the case in the first exemplary embodiment.</p>
<p id="p-0111" num="0111">These beat signals are converted into electrical signals by the optoelectronic converters (O/E) <b>230</b>, quantized by the analog to digital converters (ADC) <b>240</b>, and then inputted into the digital signal processing unit (DSP) <b>450</b>, respectively. In the digital signal processing unit (DSP) <b>450</b>, after the difference in propagation delay (skew) is compensated by the skew compensation unit <b>451</b>, the signals from the I port and the Q port are synthesized, and then processed as complex signals. That is, the complex signal generator <b>252</b> receives I<sub>x </sub>and Q<sub>x</sub>, and outputs a complex signal of E<sub>x</sub>=I<sub>x</sub>+jQ<sub>x</sub>. Similarly, it receives I<sub>y </sub>and Q<sub>y</sub>, and outputs a complex signal of E<sub>y</sub>=I<sub>y</sub>+jQ<sub>y</sub>.</p>
<p id="p-0112" num="0112">In this case, E<sub>X </sub>is represented by the following formulae.</p>
<p id="p-0113" num="0113">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>cos</mi>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>[</mo>
        <mrow>
          <mi>&#x394;&#x3c9;</mi>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>t</mi>
              <mo>-</mo>
              <msub>
                <mi>T</mi>
                <mn>1</mn>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>]</mo>
      </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
      <mi>j</mi>
      <mo>&#x2062;</mo>
      <mstyle>
        <mspace width="0.3em" height="0.3ex"/>
      </mstyle>
      <mo>&#x2062;</mo>
      <mrow>
        <mi>sin</mi>
        <mo>&#x2061;</mo>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mi>&#x394;&#x3c9;</mi>
            <mo>&#x2061;</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mi>t</mi>
                <mo>-</mo>
                <msub>
                  <mi>T</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>]</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mrow>
        <mfrac>
          <mn>1</mn>
          <mn>2</mn>
        </mfrac>
        <mo>&#x2062;</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msup>
              <mi>&#x2147;</mi>
              <mrow>
                <mi>j&#x394;&#x3c9;</mi>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>t</mi>
                    <mo>-</mo>
                    <msub>
                      <mi>T</mi>
                      <mn>1</mn>
                    </msub>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </msup>
            <mo>+</mo>
            <msup>
              <mi>&#x2147;</mi>
              <mrow>
                <mrow>
                  <mo>-</mo>
                  <mi>j&#x394;</mi>
                </mrow>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mrow>
                  <mi>&#x3c9;</mi>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>t</mi>
                      <mo>-</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>1</mn>
                      </msub>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </msup>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
        <mi>j</mi>
        <mo>&#x2062;</mo>
        <mfrac>
          <mn>1</mn>
          <mrow>
            <mn>2</mn>
            <mo>&#x2062;</mo>
            <mi>j</mi>
          </mrow>
        </mfrac>
        <mo>&#x2062;</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msup>
              <mi>&#x2147;</mi>
              <mrow>
                <mi>j&#x394;&#x3c9;</mi>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>t</mi>
                    <mo>-</mo>
                    <msub>
                      <mi>T</mi>
                      <mn>2</mn>
                    </msub>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </msup>
            <mo>-</mo>
            <msup>
              <mi>&#x2147;</mi>
              <mrow>
                <mrow>
                  <mo>-</mo>
                  <mi>j&#x394;</mi>
                </mrow>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mrow>
                  <mi>&#x3c9;</mi>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>t</mi>
                      <mo>-</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>2</mn>
                      </msub>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </msup>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mfrac>
          <mn>1</mn>
          <mn>2</mn>
        </mfrac>
        <mo>&#x2061;</mo>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mrow>
              <msup>
                <mi>&#x2147;</mi>
                <mrow>
                  <mi>j&#x394;&#x3c9;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>t</mi>
                </mrow>
              </msup>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msup>
                    <mi>&#x2147;</mi>
                    <mrow>
                      <mrow>
                        <mo>-</mo>
                        <mi>j&#x394;</mi>
                      </mrow>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>&#x3c9;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>1</mn>
                      </msub>
                    </mrow>
                  </msup>
                  <mo>+</mo>
                  <msup>
                    <mi>&#x2147;</mi>
                    <mrow>
                      <mrow>
                        <mo>-</mo>
                        <mi>j&#x394;</mi>
                      </mrow>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>&#x3c9;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>2</mn>
                      </msub>
                    </mrow>
                  </msup>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>+</mo>
            <mrow>
              <msup>
                <mi>&#x2147;</mi>
                <mrow>
                  <mrow>
                    <mo>-</mo>
                    <mi>j&#x394;&#x3c9;</mi>
                  </mrow>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>t</mi>
                </mrow>
              </msup>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msup>
                    <mi>&#x2147;</mi>
                    <mrow>
                      <mi>j&#x394;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>&#x3c9;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>1</mn>
                      </msub>
                    </mrow>
                  </msup>
                  <mo>-</mo>
                  <msup>
                    <mi>&#x2147;</mi>
                    <mrow>
                      <mi>j&#x394;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>&#x3c9;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>2</mn>
                      </msub>
                    </mrow>
                  </msup>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>]</mo>
        </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
        <mfrac>
          <mn>1</mn>
          <mn>2</mn>
        </mfrac>
        <mo>&#x2061;</mo>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mrow>
              <msup>
                <mi>&#x2147;</mi>
                <mrow>
                  <mi>j&#x394;&#x3c9;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>t</mi>
                </mrow>
              </msup>
              <mo>&#x2062;</mo>
              <msub>
                <mi>P</mi>
                <mn>0</mn>
              </msub>
            </mrow>
            <mo>+</mo>
            <mrow>
              <msup>
                <mi>&#x2147;</mi>
                <mrow>
                  <mrow>
                    <mo>-</mo>
                    <mi>j&#x394;</mi>
                  </mrow>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>&#x3c9;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>t</mi>
                </mrow>
              </msup>
              <mo>&#x2062;</mo>
              <msubsup>
                <mi>P</mi>
                <mn>0</mn>
                <mi>&#x2032;</mi>
              </msubsup>
            </mrow>
          </mrow>
          <mo>]</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
where P<sub>0</sub>, P&#x2032;<sub>0</sub>, and &#x394;&#x3c9; are represented by the following formulae.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>P</i><sub>0</sub><i>=e</i><sup>&#x2212;j&#x394;&#x3c9;T</sup><sup><sub2>1</sub2></sup><i>+e</i><sup>&#x2212;j&#x394;&#x3c9;T</sup><sup><sub2>2 </sub2></sup><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>P&#x2032;</i><sub>0</sub><i>=e</i><sup>j&#x394;&#x3c9;T</sup><sup><sub2>1</sub2></sup><i>&#x2212;e</i><sup>j&#x394;&#x3c9;T</sup><sup><sub2>2 </sub2></sup><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;&#x3c9;=2&#x3c0;<i>f</i><sub>IF </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where P<sub>0 </sub>represents the spectral component at the beat frequency f<sub>IF</sub>(=&#x394;&#x3c9;/2&#x3c0;) when the Fourier transform is performed with a sampling frequency f<sub>sample </sub>and P&#x2032;<sub>0 </sub>represents the spectral component of its mirror image (folding component).
</p>
<p id="p-0114" num="0114">Next, P<sub>0 </sub>and P&#x2032;<sub>0 </sub>are expressed as follows by separating into a real part and an imaginary part, respectively.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>P</i><sub>0</sub><i>=R</i><sub>0</sub><i>+jI</i><sub>0 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>P&#x2032;</i><sub>0</sub><i>=R&#x2032;</i><sub>0</sub><i>+jI&#x2032;</i><sub>0 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where R<sub>0</sub>, I<sub>0</sub>, R&#x2032;<sub>0</sub>, and I&#x2032;<sub>0 </sub>are expressed by the following formulae respectively.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i><sub>0</sub>=cos &#x394;&#x3c9;<i>T</i><sub>1</sub>+cos &#x394;&#x3c9;<i>T</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>I</i><sub>0</sub>=&#x2212;sin &#x394;&#x3c9;<i>T</i><sub>1</sub>&#x2212;sin &#x394;&#x3c9;<i>T</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R&#x2032;</i><sub>0</sub>=cos &#x394;&#x3c9;<i>T</i><sub>1</sub>&#x2212;cos &#x394;&#x3c9;<i>T</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>I&#x2032;</i><sub>0</sub>=sin &#x394;&#x3c9;<i>T</i><sub>1</sub>&#x2212;sin &#x394;&#x3c9;<i>T</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
From the above formulae, the following relational expressions are derived.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i><sub>0</sub><i>+R&#x2032;</i><sub>0</sub>=2 cos &#x394;&#x3c9;<i>T</i><sub>1 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i><sub>0</sub><i>&#x2212;R&#x2032;</i><sub>0</sub>=2 cos &#x394;&#x3c9;<i>T</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>I</i><sub>0</sub><i>+I&#x2032;</i><sub>0</sub>=&#x2212;2 sin &#x394;&#x3c9;<i>T</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>I</i><sub>0</sub><i>&#x2212;I&#x2032;</i><sub>0</sub>=&#x2212;2 sin &#x394;&#x3c9;<i>T</i><sub>1 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
By solving these relational expressions, amounts of propagation delay T<sub>1 </sub>and T<sub>2 </sub>are derived as follows.
</p>
<p id="p-0115" num="0115">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>1</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mn>1</mn>
              <mrow>
                <mrow>
                  <mi>&#x394;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>&#x3c9;</mi>
                </mrow>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
              </mrow>
            </mfrac>
            <mo>&#x2062;</mo>
            <mrow>
              <msup>
                <mi>tan</mi>
                <mrow>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
              </msup>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mfrac>
                  <mrow>
                    <mo>-</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>I</mi>
                          <mn>0</mn>
                        </msub>
                        <mo>-</mo>
                        <msubsup>
                          <mi>I</mi>
                          <mn>0</mn>
                          <mi>&#x2032;</mi>
                        </msubsup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mrow>
                    <msub>
                      <mi>R</mi>
                      <mn>0</mn>
                    </msub>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mn>0</mn>
                      <mi>&#x2032;</mi>
                    </msubsup>
                  </mrow>
                </mfrac>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>&#x2062;</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>2</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mrow>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mn>1</mn>
              </mrow>
              <mrow>
                <mi>&#x394;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>&#x3c9;</mi>
              </mrow>
            </mfrac>
            <mo>&#x2062;</mo>
            <mrow>
              <msup>
                <mi>tan</mi>
                <mrow>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
              </msup>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mfrac>
                  <mrow>
                    <mo>-</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>I</mi>
                          <mn>0</mn>
                        </msub>
                        <mo>+</mo>
                        <msubsup>
                          <mi>I</mi>
                          <mn>0</mn>
                          <mi>&#x2032;</mi>
                        </msubsup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mrow>
                    <msub>
                      <mi>R</mi>
                      <mn>0</mn>
                    </msub>
                    <mo>-</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mn>0</mn>
                      <mi>&#x2032;</mi>
                    </msubsup>
                  </mrow>
                </mfrac>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>11</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where &#x201c;tan<sup>&#x2212;1</sup>&#x201d; represents the inverse function of tan(tangent).
</p>
<p id="p-0116" num="0116">The following relational expressions are also derived as another expression.</p>
<p id="p-0117" num="0117">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
  <mrow>
    <mrow>
      <mi>tan</mi>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>&#x394;</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mi>&#x3c9;</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <msub>
            <mi>T</mi>
            <mn>1</mn>
          </msub>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mrow>
          <mo>-</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>I</mi>
                <mn>0</mn>
              </msub>
              <mo>-</mo>
              <msubsup>
                <mi>I</mi>
                <mn>0</mn>
                <mi>&#x2032;</mi>
              </msubsup>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mrow>
          <msub>
            <mi>R</mi>
            <mn>0</mn>
          </msub>
          <mo>+</mo>
          <msubsup>
            <mi>R</mi>
            <mn>0</mn>
            <mi>&#x2032;</mi>
          </msubsup>
        </mrow>
      </mfrac>
      <mo>=</mo>
      <mi>&#x3b1;</mi>
    </mrow>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00007-2" num="00007.2">
<math overflow="scroll">
  <mrow>
    <mrow>
      <mi>tan</mi>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>&#x394;</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mi>&#x3c9;</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <msub>
            <mi>T</mi>
            <mn>2</mn>
          </msub>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mrow>
          <mo>-</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>I</mi>
                <mn>0</mn>
              </msub>
              <mo>+</mo>
              <msubsup>
                <mi>I</mi>
                <mn>0</mn>
                <mi>&#x2032;</mi>
              </msubsup>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mrow>
          <msub>
            <mi>R</mi>
            <mn>0</mn>
          </msub>
          <mo>-</mo>
          <msubsup>
            <mi>R</mi>
            <mn>0</mn>
            <mi>&#x2032;</mi>
          </msubsup>
        </mrow>
      </mfrac>
      <mo>=</mo>
      <mi>&#x3b2;</mi>
    </mrow>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00007-3" num="00007.3">
<math overflow="scroll">
  <mrow>
    <mrow>
      <mi>tan</mi>
      <mo>&#x2062;</mo>
      <mstyle>
        <mspace width="0.3em" height="0.3ex"/>
      </mstyle>
      <mo>&#x2062;</mo>
      <mi>&#x394;</mi>
      <mo>&#x2062;</mo>
      <mstyle>
        <mspace width="0.3em" height="0.3ex"/>
      </mstyle>
      <mo>&#x2062;</mo>
      <mi>&#x3c9;</mi>
      <mo>&#x2062;</mo>
      <mstyle>
        <mspace width="0.3em" height="0.3ex"/>
      </mstyle>
      <mo>&#x2062;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>2</mn>
          </msub>
          <mo>-</mo>
          <msub>
            <mi>T</mi>
            <mn>1</mn>
          </msub>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mi>&#x3b2;</mi>
        <mo>-</mo>
        <mi>&#x3b1;</mi>
      </mrow>
      <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>&#x3b1;&#x3b2;</mi>
      </mrow>
    </mfrac>
  </mrow>
</math>
</maths>
<br/>
Accordingly, the difference in propagation delay T<sub>2</sub>&#x2212;T<sub>1 </sub>can be directly derived from R<sub>0</sub>, I<sub>0</sub>, R&#x2032;<sub>0</sub>, and I&#x2032;<sub>0 </sub>by the following relational expression.
</p>
<p id="p-0118" num="0118">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>2</mn>
          </msub>
          <mo>-</mo>
          <msub>
            <mi>T</mi>
            <mn>1</mn>
          </msub>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <mrow>
              <mi>&#x394;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mi>&#x3c9;</mi>
            </mrow>
          </mfrac>
          <mo>&#x2062;</mo>
          <mrow>
            <msup>
              <mi>tan</mi>
              <mrow>
                <mo>-</mo>
                <mn>1</mn>
              </mrow>
            </msup>
            <mo>&#x2061;</mo>
            <mrow>
              <mo>(</mo>
              <mfrac>
                <mrow>
                  <mi>&#x3b2;</mi>
                  <mo>-</mo>
                  <mi>&#x3b1;</mi>
                </mrow>
                <mrow>
                  <mn>1</mn>
                  <mo>+</mo>
                  <mi>&#x3b1;&#x3b2;</mi>
                </mrow>
              </mfrac>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>12</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0119" num="0119">According to the above description, it is found possible to derive the difference in propagation delay regarding the beat frequency f<sub>IF </sub>by using either formula (11) or (12) from spectral components (R<sub>0</sub>, I<sub>0</sub>) in Fourier transform signals of the complex signal E<sub>x </sub>at the frequency f<sub>IF</sub>(=&#x394;&#x3c9;/2&#x3c0;) and the component of the mirror image (R&#x2032;<sub>0</sub>, I&#x2032;<sub>0</sub>) which is a pair to the spectral component.</p>
<p id="p-0120" num="0120">However, since either formula (11) or (12) is the relational expression derived by performing Fourier transform ideally, an error arises due to the difference from the ideal state if a discrete Fourier transform circuit such as FFT is used. For example, FFT signals shown in <figref idref="DRAWINGS">FIG. 9</figref> represents the spectra which appear in cases where the beat frequency f<sub>IF </sub>between the test light and the local light is equal to the k-th grid frequency of FFT, k X f<sub>sample</sub>/2<sup>n</sup>. Here, 2<sup>n </sup>is the point number of FFT, k is an integer satisfying 0&#x2266;k&#x2266;2<sup>n</sup>&#x2212;1, and n is a positive integer. However, in actual measurements, since the frequency stability of the test light source and the local light source is not sufficient, a beat frequency f<sub>IF </sub>often deviates from a grid frequency of FFT. In this case, as shown in <figref idref="DRAWINGS">FIG. 13</figref>, the spectrum spreads to adjacent grids of the peak signals in <figref idref="DRAWINGS">FIG. 9</figref>, and a plurality of sidelobe spectra appear. Here, the vertical axis of <figref idref="DRAWINGS">FIG. 13</figref> represents the magnitude of E^<sub>x</sub>(N), |E^<sub>x</sub>(N)|, and the horizontal axis represents the grid frequency of FFT.</p>
<p id="p-0121" num="0121">When such sidelobes appear, in the apparatus for detecting inter-channel skew in the coherent optical receiver <b>4000</b> in accordance with the present exemplary embodiment, the multiple peak detection unit <b>484</b> detects a plurality of peak values with a central focus on one of peak values, in which spectral amplitudes of FFT signals have effective values. For example, in <figref idref="DRAWINGS">FIG. 13</figref>, P<sub>0 </sub>as one of peak values, P<sub>&#x2212;1 </sub>and P<sub>+1 </sub>with a central focus on P<sub>0</sub>, and their mirror images P&#x2032;<sub>0</sub>, P&#x2032;<sub>&#x2212;1 </sub>and P&#x2032;<sub>+1 </sub>are detected. Here, as the range where spectral amplitudes of FFT signals have effective values, for example, a plurality of peaks having higher-ranking magnitudes of the amplitude level can be selected. Alternatively, with a certain threshold level set in advance, the peaks can be adopted whose amplitude level is equal to or higher than the threshold level. Without limited to this, it is possible to select a combination in which the accuracy of measurements of the difference in propagation delay T<sub>2</sub>&#x2212;T<sub>1 </sub>is optimized according to measurement conditions.</p>
<p id="p-0122" num="0122">In the apparatus for detecting inter-channel skew in the coherent optical receiver <b>4000</b> in accordance with the present exemplary embodiment, as mentioned above, the multiple peak detection unit <b>484</b> detects a plurality of peak values. And then, the difference in propagation delay T<sub>2</sub>&#x2212;T<sub>1 </sub>is calculated by using either formulae (11) or (12) from each spectral component and the mirror image component which is a pair to the spectral component, and a weighted average proportional to spectral amplitude values is calculated respectively. Accordingly, the accuracy of measurements of the difference in propagation delay T<sub>2</sub>&#x2212;T<sub>1 </sub>can be improved. For example, in <figref idref="DRAWINGS">FIG. 13</figref>, from P<sub>0</sub>, P<sub>&#x2212;1</sub>, and P<sub>+1 </sub>corresponding to the first, second, and third highest peak in the magnitude of the spectral amplitude and their mirror images of P&#x2032;<sub>0</sub>, P&#x2032;<sub>&#x2212;1</sub>, and P&#x2032;<sub>+1</sub>, the differences in propagation delay &#x394;T<sub>0</sub>, &#x394;T<sub>&#x2212;1</sub>, and &#x394;T<sub>+1 </sub>are calculated respectively. Here, as the difference in propagation delay T<sub>2</sub>&#x2212;T<sub>1</sub>, a weighted average of them is used. That is to say, the difference in propagation delay T<sub>2</sub>&#x2212;T<sub>1 </sub>is calculated by the following formula.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>T</i><sub>2</sub><i>&#x2212;T</i><sub>1</sub>=(|<i>P</i><sub>&#x2212;1</sub><i>|&#x394;T</i><sub>&#x2212;1</sub><i>+|P</i><sub>0</sub><i>|&#x394;T</i><sub>0</sub><i>+|P</i><sub>&#x2212;1</sub><i>|&#x394;T</i><sub>&#x2212;1</sub>)/(|<i>P</i><sub>&#x2212;1</sub><i>|+|P</i><sub>0</sub><i>|+|P</i><sub>+1</sub>|)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Further, if the number of adopted peaks is increased to m, the difference in propagation delay T<sub>2</sub>&#x2212;T<sub>1 </sub>can be similarly calculated by the following formula.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>T</i><sub>2</sub><i>&#x2212;T</i><sub>1</sub>=(|<i>P</i><sub>0</sub><i>|&#x394;T</i><sub>0</sub><i>+ . . . +|P</i><sub>m</sub><i>|&#x394;T</i><sub>m</sub>)/(|<i>P</i><sub>0</sub><i>|+ . . . +|P</i><sub>m</sub>|)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0123" num="0123">In <figref idref="DRAWINGS">FIG. 14</figref>, the results of a simulation are shown in which the apparatus for detecting inter-channel skew in the coherent optical receiver <b>4000</b> in accordance with the present exemplary embodiment is applied to the case where sidelobes appear in a spectrum of FFT signals. In the figure, the results of a simulation are shown for a case where adding an amount of propagation delay T<sub>2</sub>&#x2212;T<sub>1</sub>=25 psec, an FFT circuit is used which has the number of FFT points of 4096 and a sampling rate of 64 GS/s (Giga samples per second). The vertical axis of <figref idref="DRAWINGS">FIG. 14</figref> represents the amount of propagation delay T<sub>2</sub>&#x2212;T<sub>1</sub>, and the horizontal axis represents the beat frequency f<sub>IF </sub>expressed in a unit of the grid interval of FFT frequency. In the conditions of the present simulation, the unit of the grid interval of FFT frequency is equal to 64 GS/s/4096, and f<sub>IF </sub>corresponds to an FFT grid frequency of 1 GHz (=64&#xd7;64 GS/s/4096) when the number of the grid interval of FFT frequency (FFT bin. no.) is equal to an integer number of 64.</p>
<p id="p-0124" num="0124">As will be noted from <figref idref="DRAWINGS">FIG. 14</figref>, when the difference in propagation delay T<sub>2</sub>&#x2212;T<sub>1 </sub>is calculated by using only a single peak P<sub>0 </sub>and its mirror image P&#x2032;<sub>0 </sub>shown in <figref idref="DRAWINGS">FIG. 13</figref> (symbol &#x201c;&#x25ef;&#x201d; in <figref idref="DRAWINGS">FIG. 14</figref>), an error of up to &#xb1;1 psec approximately arises providing that f<sub>IF </sub>deviates from 64 (integer value). In contrast, when the difference in propagation delay T<sub>2</sub>&#x2212;T<sub>1 </sub>is calculated by using a weighted average of a plurality of amplitude values (symbol &#x201c;&#x25a1;&#x201d; in <figref idref="DRAWINGS">FIG. 14</figref>), it is noted that the measurement with an error of almost zero becomes possible even if f<sub>IF </sub>deviates from 64. Here, P<sub>0 </sub>and P<sub>&#x2212;1 </sub>(or P<sub>+1</sub>) corresponding to the first and second largest peaks in amplitude values in <figref idref="DRAWINGS">FIG. 13</figref> and their respective mirror images of P&#x2032;<sub>0 </sub>and P&#x2032;<sub>&#x2212;1 </sub>(or P&#x2032;<sub>+1</sub>), are used. A skew detection can be also performed by a similar method using a discrete Fourier transform (DFT) instead of FFT. In this case, positive integers can be used as the number of points shown in <figref idref="DRAWINGS">FIG. 13</figref> not limited to powers of 2 (2<sup>n</sup>).</p>
<p id="p-0125" num="0125">In this way, according to the apparatus for detecting inter-channel skew in the coherent optical receiver <b>4000</b> in accordance with the present exemplary embodiment, the multiple peak detection unit <b>484</b> detects a plurality of peak values and calculates the difference in propagation delay from the spectrum for each peak, respectively. Then, by calculating a weighted average proportional to the spectral amplitude values, the accuracy of measurements of the difference in propagation delay can be improved.</p>
<p id="p-0126" num="0126">As mentioned above, according to the apparatus and the method for detecting inter-channel skew in the coherent optical receiver of this exemplary embodiment, it becomes possible to calculate the difference in propagation delay (skew) between the output ports with a higher degree of accuracy. Further, the amount of propagation delay (skew value) obtained above are compensated in the skew compensation unit <b>451</b> of the digital signal processing unit <b>450</b>, with which the coherent optical receiver <b>400</b> is provided. By this way, it becomes possible to demodulate sufficiently even though the difference in propagation delay (skew) arises between the channels, and suppress the degradation of receiving performance.</p>
<heading id="h-0014" level="1">The Fifth Exemplary Embodiment</heading>
<p id="p-0127" num="0127">Next, the fifth exemplary embodiment of the present invention will be described. <figref idref="DRAWINGS">FIG. 15</figref> is a block diagram showing the configuration of an apparatus for detecting inter-channel skew in the coherent optical receiver <b>5000</b> in accordance with the fifth exemplary embodiment of the present invention. The apparatus for detecting inter-channel skew in the coherent optical receiver <b>5000</b> is different from the apparatus for detecting inter-channel skew in the coherent optical receiver <b>4000</b> in accordance with the fourth exemplary embodiment in that it includes a phase-modulation light source <b>570</b> as the test light source <b>270</b> and further includes a polarization controller <b>580</b>. In <figref idref="DRAWINGS">FIG. 15</figref>, the same components, as those of the apparatus for detecting inter-channel skew in the coherent optical receiver <b>4000</b> shown in <figref idref="DRAWINGS">FIG. 12</figref>, are represented by the same codes and the descriptions about them are omitted.</p>
<p id="p-0128" num="0128">The phase-modulation light source <b>570</b> transmits a modulated light as a test light, for example, a modulated light modulated by phase modulation with the four levels (0, &#x3c0;/2, &#x3c0;, and 3&#x3c0;/2), that is, a quadrature phase-shift keying (QPSK). In <figref idref="DRAWINGS">FIG. 16</figref>, as an example of an output waveform of the phase-modulation light source <b>570</b>, the waveform of a modulated light is shown which is produced by repeating a phase modulation with a saw-toothed phase-shift. The vertical axis represents the phase (&#x3c6;) of the light signal, and the horizontal axis represents the time (t). Those modulated lights generate a frequency shift corresponding to &#x394;&#x3c9;=2&#x3c0;f=d&#x3c6;/dt (digital serrodyne modulation), where &#x3c6; represents a phase of the light signal. Accordingly, the phase-modulation light source <b>570</b> is able to control the frequency shift &#x394;&#x3c9; very stably and with a high degree of accuracy by changing a period of the saw-toothed phase modulation. As a result, it is unnecessary to use a wavelength tunable light source emitting CW light with unstable frequency as the test light source <b>270</b>, though it is used in the apparatus for detecting inter-channel skew in the coherent optical receiver <b>2000</b>, <b>4000</b> according to the second or the fourth exemplary embodiments. Accordingly, it is possible to detect a skew with a higher degree of accuracy.</p>
<p id="p-0129" num="0129">The polarization controller <b>580</b> sets a polarization angle for approximate 45&#xb0; (or an angle corresponding to 45&#xb0;) if the test light transmitted from the phase-modulation light source <b>570</b> has a single polarization. And it adjusts the polarization state so that the light power outputted from I<sub>X</sub>, Q<sub>X</sub>, I<sub>Y</sub>, and Q<sub>Y </sub>ports will be made equal approximately. Accordingly, in cases where the signals transmitted from the phase-modulation light source <b>570</b> undergo polarization scrambling or polarization multiplexing (for example, DP-QPSK modulation and so on), it is possible to detect a skew even though the polarization controller <b>580</b> is not used.</p>
<p id="p-0130" num="0130">In the apparatus for detecting inter-channel skew in the coherent optical receiver <b>5000</b> in accordance with the present exemplary embodiment, skew detection is performed by a technique similar to that in the second or the fourth exemplary embodiment by using the above-mentioned test light with its frequency stable and controllable with a high degree of accuracy. As a result, it becomes possible to detect a skew with a higher degree of accuracy. And then, the skew values detected above are compensated in the skew compensation unit of the digital signal processing unit, with which the coherent optical receiver is provided. By this way, it becomes possible to demodulate sufficiently even though a skew arises between the channels, and suppress the degradation of receiving performance.</p>
<p id="p-0131" num="0131">In the present exemplary embodiment, the case has been described as an example where the phase-modulation light source <b>570</b> transmits the modulated light generated by QPSK modulation as a test light. However, not limited to that, it is obvious that the present exemplary embodiment is applicable to the cases where the phase-modulation light source <b>570</b> transmits the modulated light generated by other phase-modulation schemes such as QAM (Quadrature Amplitude Modulation) or analog serrodyne modulation.</p>
<heading id="h-0015" level="1">The Sixth Exemplary Embodiment</heading>
<p id="p-0132" num="0132">Next, the sixth exemplary embodiment of the present invention will be described. <figref idref="DRAWINGS">FIG. 17</figref> is a block diagram showing the configuration of an optical transmitter/receiver <b>6000</b> in accordance with the sixth exemplary embodiment of the present invention. The optical transmitter/receiver <b>6000</b> includes a coherent optical receiver (Rx) <b>600</b>, an optical transmitter (Tx) <b>610</b>, a polarization controller <b>620</b>, a mode switching device <b>630</b>, and a control unit <b>640</b>. In the optical transmitter/receiver <b>6000</b> in accordance with the present exemplary embodiment, the optical transmitter <b>610</b> is provided with a phase modulator such as a QPSK modulator. As the phase modulator, it is possible to use a modulator similar to the phase-modulation light source <b>570</b>, with which the apparatus for detecting inter-channel skew in the coherent optical receiver in accordance with the fifth exemplary embodiment is provided.</p>
<p id="p-0133" num="0133">The mode switching device <b>630</b> instructs the control unit <b>640</b> to switch between the skew detection mode of detecting an inter-channel skew and the normal operation mode of performing normal communication activity in an inspection process of the optical transmitter/receiver <b>6000</b> at the time of its manufacture and so on.</p>
<p id="p-0134" num="0134">In the skew detection mode, the control unit <b>640</b> controls the optical transmitter <b>610</b> so that the optical transmitter <b>610</b> will transmit the transmission light with a saw-toothed phase-modulated waveform. This saw-toothed phase-modulated waveform can be made the waveform similar to that transmitted by the phase-modulation light source <b>570</b> in the apparatus for detecting inter-channel skew in the coherent optical receiver <b>5000</b> in accordance with the fifth exemplary embodiment (<figref idref="DRAWINGS">FIG. 16</figref>). Further, the control unit <b>640</b> controls the coherent optical receiver <b>600</b> so that the coherent optical receiver <b>600</b> will perform the process for detecting the inter-channel skew in the apparatus for detecting inter-channel skew in the coherent optical receiver <b>5000</b> in accordance with the fifth exemplary embodiment. At that time, the control unit <b>640</b> controls the coherent optical receiver <b>600</b> to use the transmission light from the optical transmitter <b>610</b> as a test light.</p>
<p id="p-0135" num="0135">Here, the polarization controller <b>620</b> adjusts a polarization state of the test light transmitted from the optical transmitter <b>610</b> so that the light power outputted from I<sub>X</sub>, Q<sub>X</sub>, I<sub>Y</sub>, and Q<sub>Y </sub>ports in the coherent optical receiver <b>600</b> will be made equal approximately. Accordingly, in cases where the signals transmitted from the optical transmitter <b>610</b> undergo polarization scrambling or polarization multiplexing (for example, DP-QPSK modulation and so on), it is possible to detect a skew even though the polarization controller <b>620</b> is not used.</p>
<p id="p-0136" num="0136">On the other hand, in the normal operation mode, the control unit <b>640</b> controls the optical transmitter <b>610</b> so that normal optical transmission signals will be transmitted from the optical transmitter <b>610</b>.</p>
<p id="p-0137" num="0137">In this way, the optical transmitter <b>610</b> of the optical transmitter/receiver <b>6000</b> can be used as a light source for transmitting phase-modulated test light. This enables the optical transmitter/receiver, including the apparatus for detecting inter-channel skew in the coherent optical receiver <b>5000</b> in accordance with the fifth exemplary embodiment, to have a simpler configuration. Therefore, according to the present exemplary embodiment, it is possible to obtain a small optical transmitter/receiver which can detect a skew between the ports in a coherent optical receiver with a high degree of accuracy.</p>
<p id="p-0138" num="0138">The present invention is not limited to the above-mentioned exemplary embodiments and can be variously modified within the scope of the invention described in the claims. It goes without saying that these modifications are also included in the scope of the invention.</p>
<p id="p-0139" num="0139">This application is based upon and claims the benefit of priority from Japanese patent application No. 2011-019612, filed on Feb. 1, 2011, the disclosure of which is incorporated herein in its entirety by reference.</p>
<p id="p-0140" num="0140">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>DESCRIPTION OF THE CODES</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="77pt" align="left"/>
<colspec colname="2" colwidth="126pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>100, 200, 300, 400</entry>
<entry>coherent optical receiver</entry>
</row>
<row>
<entry/>
<entry>110, 210, 310</entry>
<entry>local light source</entry>
</row>
<row>
<entry/>
<entry>120, 220, 320</entry>
<entry>90&#xb0; hybrid circuit (90&#xb0; HYBRID)</entry>
</row>
<row>
<entry/>
<entry>121, 221, 321</entry>
<entry>signal port</entry>
</row>
<row>
<entry/>
<entry>122, 222, 322</entry>
<entry>local port</entry>
</row>
<row>
<entry/>
<entry>130, 230, 330</entry>
<entry>optoelectronic converter (O/E)</entry>
</row>
<row>
<entry/>
<entry>140, 240</entry>
<entry>analog to digital converter (ADC)</entry>
</row>
<row>
<entry/>
<entry>150, 250, 450</entry>
<entry>digital signal processing unit (DSP)</entry>
</row>
<row>
<entry/>
<entry>151, 451</entry>
<entry>skew compensation unit</entry>
</row>
<row>
<entry/>
<entry>152</entry>
<entry>demodulation unit</entry>
</row>
<row>
<entry/>
<entry>153, 253</entry>
<entry>buffer unit (BUF)</entry>
</row>
<row>
<entry/>
<entry>154, 254, 386</entry>
<entry>FFT operation unit (FFT)</entry>
</row>
<row>
<entry/>
<entry>170, 270, 370</entry>
<entry>test light source</entry>
</row>
<row>
<entry/>
<entry>180, 280, 380, 480</entry>
<entry>control block</entry>
</row>
<row>
<entry/>
<entry>181, 281, 381</entry>
<entry>control unit</entry>
</row>
<row>
<entry/>
<entry>182, 282, 382, 392</entry>
<entry>memory unit</entry>
</row>
<row>
<entry/>
<entry>183, 283, 383</entry>
<entry>operational processing unit</entry>
</row>
<row>
<entry/>
<entry>184, 284, 384</entry>
<entry>peak detection unit</entry>
</row>
<row>
<entry/>
<entry>185, 285, 385</entry>
<entry>skew calculation unit</entry>
</row>
<row>
<entry/>
<entry>252</entry>
<entry>complex signal generator</entry>
</row>
<row>
<entry/>
<entry>390</entry>
<entry>sampling oscilloscope</entry>
</row>
<row>
<entry/>
<entry>455</entry>
<entry>signal processing unit</entry>
</row>
<row>
<entry/>
<entry>484</entry>
<entry>multiple peak detection unit</entry>
</row>
<row>
<entry/>
<entry>570</entry>
<entry>phase-modulated light source</entry>
</row>
<row>
<entry/>
<entry>580, 620</entry>
<entry>polarization controller</entry>
</row>
<row>
<entry/>
<entry>600</entry>
<entry>coherent optical receiver (Rx)</entry>
</row>
<row>
<entry/>
<entry>610</entry>
<entry>optical transmitter (Tx)</entry>
</row>
<row>
<entry/>
<entry>630</entry>
<entry>mode switching device</entry>
</row>
<row>
<entry/>
<entry>640</entry>
<entry>control unit</entry>
</row>
<row>
<entry/>
<entry>700</entry>
<entry>related coherent optical receiver</entry>
</row>
<row>
<entry/>
<entry>710</entry>
<entry>local light source</entry>
</row>
<row>
<entry/>
<entry>720</entry>
<entry>90&#xb0; hybrid circuit (90&#xb0; HYBRID)</entry>
</row>
<row>
<entry/>
<entry>730</entry>
<entry>optoelectronic converter (O/E)</entry>
</row>
<row>
<entry/>
<entry>740</entry>
<entry>analog to digital converter (ADC)</entry>
</row>
<row>
<entry/>
<entry>750</entry>
<entry>digital signal processing unit (DSP)</entry>
</row>
<row>
<entry/>
<entry>1000, 2000, 3000,</entry>
<entry>apparatus for detecting inter-channel </entry>
</row>
<row>
<entry/>
<entry>4000, 5000</entry>
<entry>skew in the coherent optical receiver</entry>
</row>
<row>
<entry/>
<entry>6000</entry>
<entry>optical transmitter/receiver</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08626000-20140107-M00001.NB">
<img id="EMI-M00001" he="23.62mm" wi="76.20mm" file="US08626000-20140107-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08626000-20140107-M00002.NB">
<img id="EMI-M00002" he="12.02mm" wi="76.20mm" file="US08626000-20140107-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08626000-20140107-M00003.NB">
<img id="EMI-M00003" he="12.02mm" wi="76.20mm" file="US08626000-20140107-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004 MATH-US-00004-2" nb-file="US08626000-20140107-M00004.NB">
<img id="EMI-M00004" he="13.38mm" wi="76.20mm" file="US08626000-20140107-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US08626000-20140107-M00005.NB">
<img id="EMI-M00005" he="23.96mm" wi="76.20mm" file="US08626000-20140107-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US08626000-20140107-M00006.NB">
<img id="EMI-M00006" he="14.48mm" wi="76.20mm" file="US08626000-20140107-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007 MATH-US-00007-2 MATH-US-00007-3" nb-file="US08626000-20140107-M00007.NB">
<img id="EMI-M00007" he="21.84mm" wi="76.20mm" file="US08626000-20140107-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US08626000-20140107-M00008.NB">
<img id="EMI-M00008" he="7.03mm" wi="76.20mm" file="US08626000-20140107-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A coherent optical receiver, comprising:
<claim-text>a local light source, a 90&#xb0; hybrid circuit, an optoelectronic converter, an analog to digital converter, and a digital signal processing unit;</claim-text>
<claim-text>wherein the 90&#xb0; hybrid circuit makes multiplexed signal light interfere with local light from the local light source, and outputs a plurality of optical signals separated into a plurality of signal components;</claim-text>
<claim-text>the optoelectronic converter detects the optical signals and outputs detected electrical signals;</claim-text>
<claim-text>the analog to digital converter quantizes the detected electrical signals and outputs quantized signals;</claim-text>
<claim-text>the digital signal processing unit comprises a skew compensation unit for compensating a difference in propagation delay between the plurality of signal components, and an FFT operation unit for performing a fast Fourier transform process on the quantized signals; and</claim-text>
<claim-text>wherein the difference in propagation delay is calculated on the basis of a plurality of peak values with a central focus on one peak value in the results of performing the fast Fourier transform process.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The coherent optical receiver according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the difference in propagation delay is calculated by obtaining a weighted average for each difference in propagation delay respectively calculated on the basis of the plurality of peak values,
<claim-text>wherein the weighted average is proportional to amplitude value of each of the plurality of peak values.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. An apparatus for detecting inter-channel skew in a coherent optical receiver, comprising:
<claim-text>a coherent optical receiver, a test light source, an analog to digital converter, an FFT operation unit, and a control block;</claim-text>
<claim-text>wherein the coherent optical receiver comprises a local light source, a 90&#xb0; hybrid circuit, and an optoelectronic converter;</claim-text>
<claim-text>wherein the 90&#xb0; hybrid circuit makes multiplexed signal light interfere with local light from the local light source, and outputs a plurality of optical signals separated into a plurality of signal components;</claim-text>
<claim-text>the optoelectronic converter detects the optical signals and outputs detected electrical signals;</claim-text>
<claim-text>the analog to digital converter quantizes the detected electrical signals and outputs quantized signals;</claim-text>
<claim-text>the FFT operation unit performs a fast Fourier transform process on the quantized signals; and</claim-text>
<claim-text>the control block calculates a difference in propagation delay between the plurality of signal components on the basis of a plurality of peak values with a central focus on one peak value in the results of performing the fast Fourier transform process.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The apparatus for detecting inter-channel skew in a coherent optical receiver according to <claim-ref idref="CLM-00003">claim 3</claim-ref>,
<claim-text>wherein the control block comprises a multiple peak detection unit and a skew calculation unit;</claim-text>
<claim-text>the multiple peak detection unit detects peak values whose amplitude values are equal to or larger than a predetermined value as the plurality of peak values, and calculates a peak frequency and a peak phase at each of the peak values with respect to each of the plurality of signal components; and</claim-text>
<claim-text>the skew calculation unit calculates the difference in propagation delay by obtaining a weighted average for each difference in propagation delay respectively calculated by the peak frequency and the peak phase,</claim-text>
<claim-text>wherein the weighted average is proportional to amplitude value of each of the plurality of peak values.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The apparatus for detecting inter-channel skew in a coherent optical receiver according to <claim-ref idref="CLM-00004">claim 4</claim-ref>,
<claim-text>wherein the skew calculation unit calculates the difference in propagation delay from the peak frequency and the peak phase at one of the peak values and its mirror image component in the results of performing the fast Fourier transform process.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The apparatus for detecting inter-channel skew in a coherent optical receiver according to <claim-ref idref="CLM-00003">claim 3</claim-ref>,
<claim-text>wherein the test light source is a phase-modulation light source transmitting a modulated light which is modulated by phase modulation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. An optical transmitter/receiver, comprising:
<claim-text>a coherent optical receiver and an optical transmitter comprising a phase-modulation light source transmitting a modulated light which is modulated by phase modulation;</claim-text>
<claim-text>wherein the coherent optical receiver comprises a local light source, a 90&#xb0; hybrid circuit, an optoelectronic converter, an analog to digital converter, and a digital signal processing unit;</claim-text>
<claim-text>wherein the 90&#xb0; hybrid circuit makes multiplexed signal light interfere with local light from the local light source, and outputs a plurality of optical signals separated into a plurality of signal components;</claim-text>
<claim-text>the optoelectronic converter detects the optical signals and outputs detected electrical signals;</claim-text>
<claim-text>the analog to digital converter quantizes the detected electrical signals and outputs quantized signals;</claim-text>
<claim-text>the digital signal processing unit comprises a skew compensation unit for compensating a difference in propagation delay between the plurality of signal components, and an FFT operation unit for performing a fast Fourier transform process on the quantized signals; and</claim-text>
<claim-text>wherein the difference in propagation delay is calculated on the basis of a plurality of peak values with a central focus on one peak value in the results of performing the fast Fourier transform process in cases where the modulated light is inputted from the phase-modulation light source into the 90&#xb0; hybrid circuit and is made to interfere with the local light.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
