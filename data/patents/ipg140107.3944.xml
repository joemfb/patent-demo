<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625012-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625012</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12697061</doc-number>
<date>20100129</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>306</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>3</main-group>
<subgroup>14</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20110101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>5</main-group>
<subgroup>335</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>01</class>
<subclass>L</subclass>
<main-group>27</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>348296</main-classification>
<further-classification>348297</further-classification>
<further-classification>348308</further-classification>
<further-classification>2502081</further-classification>
</classification-national>
<invention-title id="d2e53">Apparatus and method for improving dynamic range and linearity of CMOS image sensor</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5272535</doc-number>
<kind>A</kind>
<name>Elabd</name>
<date>19931200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6069377</doc-number>
<kind>A</kind>
<name>Prentice et al.</name>
<date>20000500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>257292</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6175383</doc-number>
<kind>B1</kind>
<name>Yadid-Pecht et al.</name>
<date>20010100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6355965</doc-number>
<kind>B1</kind>
<name>He et al.</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>257431</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6570617</doc-number>
<kind>B2</kind>
<name>Fossum et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6606122</doc-number>
<kind>B1</kind>
<name>Shaw et al.</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6678039</doc-number>
<kind>B2</kind>
<name>Charbon</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>356  501</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6741198</doc-number>
<kind>B2</kind>
<name>McIlrath</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6927796</doc-number>
<kind>B2</kind>
<name>Liu et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6963370</doc-number>
<kind>B2</kind>
<name>DiCarlo et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>348297</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6975355</doc-number>
<kind>B1</kind>
<name>Yang et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>7202463</doc-number>
<kind>B1</kind>
<name>Cox</name>
<date>20070400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>250214 R</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>7397509</doc-number>
<kind>B2</kind>
<name>Krymski</name>
<date>20080700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>7443427</doc-number>
<kind>B2</kind>
<name>Takayanagi</name>
<date>20081000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>7804537</doc-number>
<kind>B2</kind>
<name>Storm et al.</name>
<date>20100900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>348302</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>7990451</doc-number>
<kind>B2</kind>
<name>Belenky et al.</name>
<date>20110800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>348297</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>8144228</doc-number>
<kind>B2</kind>
<name>Gelfand</name>
<date>20120300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>348308</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2002/0024605</doc-number>
<kind>A1</kind>
<name>Merrill et al.</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>348296</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2003/0112351</doc-number>
<kind>A1</kind>
<name>Clark</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>348307</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2006/0027730</doc-number>
<kind>A1</kind>
<name>Bamji et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>2502081</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>2007/0132867</doc-number>
<kind>A1</kind>
<name>Rhee et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>348302</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>2008/0001736</doc-number>
<kind>A1</kind>
<name>Steadman et al.</name>
<date>20080100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2008/0036888</doc-number>
<kind>A1</kind>
<name>Sugawa et al.</name>
<date>20080200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00024">
<othercit>Chan et al., &#x201c;A low-distortion and wide dynamic range CMOS imager for wireless capsule endoscopy,&#x201d; IEEE International Symposium on Circuits and Systems 2008 (ISCAS 2008), 2945-2948 (May 8-21, 2008).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00025">
<othercit>State Intellectual Property Office of the People'S Republic of China, International Search Report in International Patent Application No. PCT/CN2008/000313 (May 15, 2008).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00026">
<othercit>Yuan et al., &#x201c;Digital calibration technique for highly linear wide dynamic range CMOS imaging sensor,&#x201d; Electronics Letters, 45 (9): 449-451 (Apr. 23, 2009).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00027">
<othercit>Yuan et al., &#x201c;An activity-triggered 95.3 dB DR 75.6 dB THD CMOS imaging sensor with digital calibration,&#x201d; IEEE journal of Solid-State Circuits, 44 (10): 2834-2843 (Oct. 2009).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00028">
<othercit>Snoeij et al., &#x201c;A CMOS Imager with Column-Level ADC Using Dynamic Column Fixed-Pattern Noise Reduction,&#x201d; <i>IEEE J. of Solid-State Circuits</i>, vol. 41, No. 12, Dec. 2006.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00029">
<othercit>Wang et al., &#x201c;Design and Implementation of a Switched-Current Memory Cell for Low-Power and Weak-Current Operations,&#x201d; <i>IEEE J. of Solid-State Circuits</i>, vol. 26, No. 2, Feb. 2001.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00030">
<othercit>Yoshihara et al., &#x201c;A 1/1.8-inch 6.4 MPixel 60 frames/s CMOS Image Sensor with Seamless Mode Change,&#x201d; <i>IEEE J. of Solid-State Circuits</i>, Vo. 41, No. 12, Dec. 2006.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00031">
<othercit>Yuan et al, &#x201c;Power Analysis and Design of Wide Dynamic Range CMOS Imaging Sensors,&#x201d; <i>Microelectronics Journal</i>, vol. 41, pp. 585-593, Sep. 2010.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00032">
<othercit>Gamal et al., &#x201c;CMOS Image Sensors,&#x201d; <i>IEEE Circuits &#x26; Devices Magazine</i>, pp. 6-20, May/Jun. 2005.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>10</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>348294</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>348296</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>348297</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>348302</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>348308</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>2502081</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>18</number-of-drawing-sheets>
<number-of-figures>26</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61202196</doc-number>
<date>20090205</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20100194956</doc-number>
<kind>A1</kind>
<date>20100805</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Yuan</last-name>
<first-name>Jie</first-name>
<address>
<city>Hong Kong</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Chan</last-name>
<first-name>Ho Yeung</first-name>
<address>
<city>Hong Kong</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Yuan</last-name>
<first-name>Jie</first-name>
<address>
<city>Hong Kong</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Chan</last-name>
<first-name>Ho Yeung</first-name>
<address>
<city>Hong Kong</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Leydig, Voit &#x26; Mayer, Ltd.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>The Hong Kong University of Science and Technology</orgname>
<role>03</role>
<address>
<city>Hong Kong</city>
<country>CN</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Pasiewicz</last-name>
<first-name>Daniel M</first-name>
<department>2661</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Described herein is a circuit and related method for improving the dynamic range and the linearity characteristic of a CMOS image sensor. In various embodiments of the CMOS image sensor, a current sampler, a comparator, and a 1-bit memory are incorporated in each pixel circuit. In the image sensor, pixels are arranged in columns and a column slice is used to read the digital and analog singles from each column. In addition, a calibration circuit is incorporated in the sensor circuit for providing calibration current, which is used to generate calibration parameter. The image sensor operates in three non-overlapping modes: the difference mode, the WDR mode, and the calibration mode. The image sensor is switched among the three modes by control signals, which are provided to the image sensor by various control circuits. The image sensor normally operates in the difference mode and switches to the WDR mode when the difference between consecutive frames is over a threshold. The calibration mode allows the image sensor generate calibration parameters which are used to improve the linearity of the sensor through a interpolation method.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="103.97mm" wi="139.53mm" file="US08625012-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="192.11mm" wi="119.80mm" file="US08625012-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="213.95mm" wi="144.36mm" file="US08625012-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="152.48mm" wi="155.96mm" file="US08625012-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="235.12mm" wi="181.19mm" file="US08625012-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="247.14mm" wi="193.80mm" file="US08625012-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="205.82mm" wi="181.78mm" file="US08625012-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="227.08mm" wi="129.03mm" file="US08625012-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="139.87mm" wi="169.16mm" file="US08625012-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="127.85mm" wi="156.55mm" file="US08625012-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="170.26mm" wi="166.88mm" file="US08625012-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="117.52mm" wi="153.67mm" file="US08625012-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="111.84mm" wi="170.26mm" file="US08625012-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="173.74mm" wi="153.67mm" file="US08625012-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="216.15mm" wi="136.48mm" file="US08625012-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="127.25mm" wi="129.62mm" file="US08625012-20140107-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="144.53mm" wi="112.35mm" file="US08625012-20140107-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="172.55mm" wi="124.46mm" file="US08625012-20140107-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="144.53mm" wi="175.43mm" file="US08625012-20140107-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATION</heading>
<p id="p-0002" num="0001">This patent application claims the benefit of U.S. Provisional Patent Application No. 61/202,196, filed Feb. 5, 2009, which is incorporated by reference in its entirety.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">TECHNICAL FIELD</heading>
<p id="p-0003" num="0002">The present invention relates in general to semiconductor image sensing and in particular to a new CMOS image sensing architecture with calibration and activity detection to achieve wide dynamic range, large signal-to-noise ratio, high linearity, low fixed-pattern noise, high fill factor, and low output data rate.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<heading id="h-0004" level="1">Definition of Terms</heading>
<p id="p-0004" num="0003">Fill factor: the fill factor of a CMOS image sensor indicates the size of the light sensitive photodiode relative to the surface of the pixel.</p>
<p id="h-0005" num="0000">Introduction</p>
<p id="p-0005" num="0004">The continuous improvement of complementary metal-oxide-semiconductor (CMOS) imaging sensors in recent years has opened up new application areas in scientific research and bio-medical diagnostics, such as space telescope, DNA microarray, bioluminescence detection, and computed tomography. An imaging sensor serves as a data acquisition system in these applications, which require wide dynamic range (WDR) and high linearity over the full range. Charge-coupled devices (CCD) have been mainly used for these applications. However, powerful on-chip processing capabilities make CMOS imaging sensors more attractive than CCD sensors.</p>
<p id="p-0006" num="0005">Compared to CCD, CMOS image sensor is able to process images on the same chip so that it offers more imaging functionality and provides better performance, while the cost of a CMOS image sensor is considerably lower. An exemplary teaching can be found in U.S. Pat. No. 6,570,617, titled &#x201c;CMOS active pixel sensor type imaging system on a chip,&#x201d; issued to Fossum of La Crescenta, Calif., and assigned to California Institute of Technology, Pasadena, Calif., May 2003.</p>
<p id="p-0007" num="0006">A common single-chip CMOS image sensor design includes a regular array of pixel circuits, column-wise processing circuits and a digital parallel-to-serial conversion circuit. The pixel circuit includes a photodiode and pixel-level processing circuits, which can sense and process the light signal. The column-wise processing circuits periodically read out the accumulated photo voltages of all pixels in the column and quantize them into digital values. The parallel-to-serial conversion circuit shifts digital values from all columns off the chip sequentially. An exemplary teaching of a single-chip CMOS image sensor design can be found in &#x201c;A 1/1.8-inch 6.4 MPixel 60 frames/s CMOS image sensor with seamless mode change,&#x201d; IEEE Journal of Solid-State Circuits, pp. 2998-3006, December 2006 by S. Yoshihara et al.</p>
<p id="p-0008" num="0007">The pixel circuit of a conventional CMOS active pixel sensor (APS) is shown in <figref idref="DRAWINGS">FIG. 1</figref>. After the shutter signal resets shutter transistor <b>101</b>, the photocurrent (I<sub>ph</sub>) discharges the capacitance (C<sub>int</sub>) at the floating drain (V<sub>n</sub>). The accumulated photo voltage (V<sub>ph</sub>) after integration duration (T<sub>int</sub>) is read out. V<sub>ph </sub>is directly proportional to the photocurrent level, and can be expressed as</p>
<p id="p-0009" num="0008">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>V</mi>
    <mi>ph</mi>
  </msub>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <msub>
        <mi>T</mi>
        <mi>int</mi>
      </msub>
      <msub>
        <mi>C</mi>
        <mi>int</mi>
      </msub>
    </mfrac>
    <mo>&#x2062;</mo>
    <mrow>
      <msub>
        <mi>I</mi>
        <mi>ph</mi>
      </msub>
      <mo>.</mo>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0010" num="0009">The largest V<sub>ph </sub>that a pixel can handle defines the maximal photocurrent that the pixel can process. If T<sub>int </sub>and C<sub>int </sub>remain constant, the maximal V<sub>ph </sub>is limited by the well capacity, which defines the amount an individual pixel can hold before saturating. The well capacity (V<sub>w</sub>) in the CMOS pixel is the voltage space between the pixel reset voltage and the lowest float drain voltage.</p>
<p id="p-0011" num="0010">One of the major application areas for CMOS image sensors is wide dynamic range (WDR) sensing. An exemplary teaching on dynamic range can be found in &#x201c;CMOS image sensors,&#x201d; <i>IEEE Circuits and Devices Magazine</i>, pp. 6-20, May/June 2005 by A. Gamal.</p>
<p id="p-0012" num="0011">One group of WDR CMOS image sensor designs expands the DR by compressing the photo voltage logarithmically using a MOS transistor in weak inversion. An exemplary teaching can be found in U.S. Pat. No. 7,443,427, titled &#x201c;Wide dynamic range linear-and-log active pixel,&#x201d; issued to Takayanagi of Tokyo, JP, and assigned to Micro Technology Inc., Boise, Id., October 2008.</p>
<p id="p-0013" num="0012">Another major group of WDR CMOS image sensor designs scales the integration time for different photocurrent levels. For large photocurrents, shorter integration time is used. For small photocurrents, longer integration time is used. As a result, the photo voltage can be confined within the well capacity. In implementations, the photocurrent is often integrated with multiple durations. The maximal non-saturated photo voltage and its integration time provide the digitized value of the WDR photocurrent. This method is also called multiple sampling. Exemplary teachings can be found in U.S. Pat. No. 6,175,383, titled &#x201c;Method and apparatus of high dynamic range image sensor with individual pixel reset,&#x201d; issued to Yadid-Pecht of Arcadia, Calif., and assigned to California Institute of Technology, Pasadena, Calif., January 2001, in U.S. Pat. No. 6,975,355, titled &#x201c;Multiple sampling via a time-indexed method to achieve wide dynamic range,&#x201d; issued to Yang of Mountain View, Calif., and assigned to Pixim Inc., Mountain View, Calif., December 2005, and in U.S. Pat. No. 7,397,509, titled &#x201c;High dynamic range imager with a rolling shutter,&#x201d; issued to Krymski of La Crescenta, Calif., and assigned to Micron Technology Inc., Boise, Id., July 2008.</p>
<p id="p-0014" num="0013">Another major group of WDR CMOS image sensor designs scales the integration capacitor for different photocurrent levels. For large photocurrents, larger integration capacitance is used. For small photocurrents, smaller integration capacitance is used. As a result, the photo voltage can also be confined within the well capacity. Exemplary teachings can be found in U.S. Pat. Appl. No. US2008/0036888, titled &#x201c;Optical sensor and solid-state imaging device,&#x201d; issued to Sugawa et al. of Miyagi, JP, and assigned to Tohoku University, February 2008, and in U.S. Pat. Appl. No. US2008/0001736, titled &#x201c;Electronic Circuit,&#x201d; issued to Steadman et al. of Aachen, Del., and assigned to Koninklijke Philips Electronics N.V., Eindhoven, NL, January 2008.</p>
<p id="p-0015" num="0014">Still another major group of WDR CMOS image sensor designs expands the equivalent well capacity by self-resetting the pixel. The pixel includes an internal shutter, which is controlled by a comparator. The comparator compares the float drain (FD) voltage (V<sub>n</sub>) to a threshold voltage (V<sub>ref</sub>). If V<sub>n </sub>falls below V<sub>ref</sub>, the output of the comparator resets the pixel. The temporal course of the FD voltage of a self-reset pixel is plotted in <figref idref="DRAWINGS">FIG. 2</figref>. The self-reset activity is proportional to the photocurrent intensity. A self-reset pixel can be treated as a continuous-time 1<sup>st</sup>-order &#x3a3;&#x394; analog-to-digital converter (ADC). By including a fast digital processor and storage cell for each photodiode, the CMOS image sensor is able to achieve WDR. An exemplary teaching can be found in U.S. Pat. No. 6,741,198, titled &#x201c;High resolution, low power, wide dynamic range imager with embedded pixel processor and DRAM storage,&#x201d; issued to McIlrath of Lexington, Mass., and assigned to R3 Logic, Inc., Somerville, Mass., May 2004. The digital pixel sensor (DPS) design developed a self-reset pixel including a pixel-level ADC. The ADC quickly reads out the FD voltage periodically. A column-level processor is designed to process the digitized voltages to estimate the photocurrent level. An exemplary teaching can be found in U.S. Pat. No. 6,927,796, titled &#x201c;CMOS image sensor system with self-reset digital pixel architecture for improving SNR and dynamic range,&#x201d; issued to Liu et al. of Palo Alto, Calif., and assigned to the Board of Trustees of the Leland Stanford Junior University, Stanford, Calif., August 2005.</p>
<p id="p-0016" num="0015">Although the aforementioned CMOS image sensor designs provide WDR, images from these sensors have performance deficiencies. The logarithmic WDR CIS has low linearity and high noise. The scaling methods have limited linearity over the whole DR. The time scaling methods also have low signal-to-noise ratio (SNR). The pixel-level &#x3a3;&#x394; scheme includes high-speed digital circuits in the analog pixel, which reduces the sensor fill factor and injects digital noise into the analog pixel. The linearity of the DPS scheme is low as well. For a self-reset pixel, the effective reset threshold voltage is actually dependent on the photocurrent level due to the comparator offset and the comparator delay. <figref idref="DRAWINGS">FIG. 3</figref> shows the simulated well capacity (V<sub>w</sub>) against photocurrent, which is highly nonlinear. Without compensating this nonlinearity, the linearity of the image senor design is low. The total-harmonic distortion (THD) is around &#x2212;40 dB. The self-reset pixels also have high fixed-pattern noise (FPN) because of the mismatch in pixel circuits.</p>
<p id="p-0017" num="0016">In summary, a common problem for existing WDR CMOS image sensor designs is their low linearity. An image senor converts light intensity into digital values. The linearity describes the fidelity of this conversion. For applications such as medical diagnostics, biological characterization, scientific research and space missions, the captured light intensity is used as indication of the amount of certain substance or tissues. Hence, it requires high linearity, as well as wide dynamic range, from the imaging system. Also, WDR CMOS image sensors normally generate digital image data at very high data rate. It is desirable to reduce the data rate for implantable medical diagnostics, surveillance and sensory imaging applications.</p>
<heading id="h-0006" level="1">BRIEF SUMMARY OF THE INVENTION</heading>
<p id="p-0018" num="0017">Described herein is a CMOS image sensor circuit and related method that provide wide dynamic range, high linearity, high signal-to-noise ratio, low fixed-pattern noise, and high fill factor. The CMOS image sensor circuit described herein also has the advantage of reduced data rate.</p>
<p id="p-0019" num="0018">According to one embodiment, the CMOS image sensor circuit utilizes a self-reset pixel approach to expand the dynamic range. The sensor circuit includes a partial-quantization architecture with a new self-reset pixel design and new column processing circuits. In the embodiment, digital circuits are separated from the analog pixel completely so that WDR image information can be read out efficiently without digital noise coupling into the analog pixel. The fill factor of the CMOS image sensor is improved.</p>
<p id="p-0020" num="0019">According to another embodiment, an interpolation-based digital calibration method is used to compensate the nonlinear V<sub>w </sub>of the self-reset pixel, thereby improving the linearity of the image sensor and reducing the fixed-pattern noise. The sensor circuit includes calibration circuits in each self-reset pixel, corresponding column-level calibration circuits, a reference current analog-to-digital converter, and a decoder.</p>
<p id="p-0021" num="0020">According to still another embodiment, the CMOS image sensor utilizes activity-triggering to reduce the output data rate. Temporal difference circuits are incorporated in each pixel. During the normal operation, the image sensor generates a difference image at low data rate. When pixels in the difference image exceed a threshold, indicating heavy activities or substantial motions in the scene, the CMOS image sensor switches to capture high quality WDR images.</p>
<p id="p-0022" num="0021">In a further embodiment, a partial quantization scheme is implemented in the pixel circuit, which linearly expands the imaging sensor dynamic range (DR) to 95.3 dB. The linearity of the partial quantization scheme over the wide DR is improved using a digital calibration method with a back-end digital signal processor (DSP). The pixel distortion after calibration reaches &#x2212;75.6 dB. The partial quantization pixel also achieves high signal-to-noise ratio (SNR). The fill factor of the new pixel is 27%.</p>
<p id="p-0023" num="0022">In still further embodiment, an imaging apparatus having a wide dynamic range, improved linearity, and low output data rate is provided. The imaging apparatus includes a pixel array having a first working mode for generating calibration data, a second working mode for measuring a difference between consecutive frames, and a third working mode for generating pixel signals having a dynamic range larger than the dynamic range of the first and second modes. The imaging apparatus further includes a control circuit for generating control signals for switching the pixel array among the first, second, and third working modes, and a processor for generating output signals in accordance with the pixel signals and the calibration data so that a linearity characteristic of the pixel signals is improved.</p>
<p id="p-0024" num="0023">In an alternative embodiment, a pixel circuit for generating analog and digital pixel signals is provided. The pixel circuit includes (a) a photodiode for generating a photocurrent in response to incident light; (b) a float drain for integrating the photocurrent; (c) a first cascode transistor coupled between the photodiode and the float drain for passing the photocurrent; (d) an external shutter transistor coupled between the float drain and a supply voltage for providing an external shutter signal to reset the float drain; (e) an internal shutter transistor for resetting the float drain in response to one or more self-reset event; (f) a comparator for comparing a voltage of the float drain and a reference voltage and generating a pulse indicative each of the one or more self-reset events in response to the comparison; (g) a memory for recording the pulse; (h) an analog buffer for receiving the analog pixel signal from the float drain and for transmitting the analog pixel signal through an analog column bus; (i) a digital buffer for receiving the digital pixel signal from the memory and for transmitting the digital pixel signal through a digital column bus; (j) a second cascode transistor coupled to the float drain for passing a calibration current; (k) a first switch coupled between the photodiode and the supply voltage and controlled by a calibration signal; (l) a second switch coupled between a calibration current input terminal and the second cascode transistor and controlled by the calibration signal; and (m) a current sampler coupled to the float drain for sampling the photocurrent.</p>
<p id="p-0025" num="0024">In still an alternative embodiment, a partial quantization circuit for extending a dynamic range of a CMOS image sensor is provided. The circuit comprises: (a) a pixel array including a plurality of pixels arranged in one or more columns, wherein each pixel of the pixel array integrates a photocurrent, performs a self-reset, and generates a pulse in response to the self-reset; (b) one or more analog column buses, each coupled to one of the one or more columns for receiving a residual pixel voltage from the associated column; (c) one or more digital column buses, each coupled to one of the one or more columns for receiving the pulses from the associated column; (d) one or more digital column counter, each coupled to one of the one or more digital column buses for counting the number of the pulses collected from the associated column; (e) one or more analog-to-digital converters (ADCs), each coupled to one of the one or more analog column buses for quantizing the residual pixel voltage from the associated column at the end of an integration; and (f) a processor for calculating a photo voltage using the number of the pulses, the quantized residual pixel voltage, and a well capacity so that the dynamic range of the photo voltage is extended.</p>
<p id="p-0026" num="0025">In still an alternative embodiment, a partial quantization method is provided for improving a dynamic range and a signal-to-noise ratio of a CMOS image sensor. The method comprises: (a) generating a photocurrent in response to incident light; (b) generating a pixel voltage by integrating the photocurrent; (c) continuously comparing the pixel voltage to a reference voltage during the integration; (d) generating a pulse in response to a result of (c); (e) resetting the pixel voltage to a reset voltage; (d) calculating a pixel well capacity by taking a difference between the reference voltage and the reset voltage; (f) counting the number of pulses during the integration; (g) generating a residual pixel voltage by sampling and quantizing the pixel voltage at the end of the integration; (h) multiplying the number of pulses by the pixel well capacity; and (i) calculating a digitized photo voltage by adding the residual pixel voltage to the product of the number of pulses and the pixel well capacity.</p>
<p id="p-0027" num="0026">In still an alternatively embodiment, a circuit is provided for improving the linearity of a CMOS image sensor. The circuit comprises: (a) a pixel array including a plurality of pixels, each pixel having a calibration mode, a difference mode, and a wide dynamic range mode, and each pixel further including a calibration circuit for switching the photodiode off and integrating a calibration current; (b) a calibration current array for generating a plurality of calibration currents for the calibration mode; (c) a reference analog-to-digital converter for quantizing the calibration currents in the calibration mode for generating calibration parameters; and (d) a decoder for processing calibration data and raw quantized data for calculating image data during the wide dynamic range mode so that the linearity of the image data is improved.</p>
<p id="p-0028" num="0027">In still an alternative embodiment, an interpolation-based calibration method is provided for improving the linearity and reducing the fixed-pattern noise of a CMOS image sensor having a partial quantization architecture, wherein the CMOS image sensor includes an array of pixels. The method includes: (a) generating a photocurrent in each pixel in response to incident light; (b) digitizing a least-significant bit (LSB) size of a quantizing analog-to-digital converter (ADC) of the image sensor by a reference ADC; (c) taking a plurality of samples of a well capacity of each pixel of the image sensor; (d) calculating an interpolated well capacity for each pixel by interpolating the samples; (e) multiplying a self-reset number by the linear well capacity; and (f) calculating an accumulated photo voltage by adding a residual pixel voltage and the product of generated in (e).</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0007" level="1">BRIEF DESCRIPTION OF THE SEVERAL VIEWS OF THE DRAWINGS</heading>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 1</figref> depicts the diagram of a conventional three-transistor active pixel sensor;</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 2</figref> depicts the pixel dynamics of a pixel with self-reset capability;</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 3</figref> illustrates the nonlinear relationship between the well capacity and the photocurrent of a pixel;</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 4A</figref> depicts the diagram of one embodiment of the pixel circuit having an linearly expanded WDR;</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 4B</figref> depicts the block diagram of an CMOS image sensor having three operation modes: the difference mode, the WDR mode, and the calibration mode;</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 5A</figref> depicts the diagram of another embodiment of the pixel circuit having an linearly expanded WDR;</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 5B</figref> depicts the circuit diagram of the 1-bit memory <b>403</b> shown in <figref idref="DRAWINGS">FIG. 5A</figref>;</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 6</figref> illustrates the timing of control signals of a pixel in the wide dynamic range mode;</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 7A</figref> depicts another embodiment of the pixel circuit having an linearly expanded WDR;</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 7B</figref> illustrates the potential diagram of the pixel circuit in the WDR mode;</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 7C</figref> illustrates the timing diagram of the difference mode and the WDR mode;</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 8</figref> depicts a 16-bit dual-slope current ADC used to measured the calibration current;</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 9</figref> depicts the diagram of the column circuit <b>500</b>;</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 10</figref> depicts the diagram of the column counter <b>501</b> shown in <figref idref="DRAWINGS">FIG. 9</figref>;</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 11</figref> illustrates the timing of control signals of the column counter <b>501</b>;</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 12</figref> depicts the flow chart of the interpolation-based calibration method;</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 13</figref> illustrates the linear interpolation method for calibration;</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 14</figref> depicts the structure of the digital decoder <b>600</b> for providing digital calibration;</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 15</figref> depicts the structure of the interpolation parameter decoder <b>602</b>;</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 16</figref> depicts components of the interpolation parameter decoder <b>602</b>;</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 17</figref> depicts the structure of the recovery decoder <b>603</b>;</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 18</figref> depicts the structure of the fine photocurrent calculation decoder <b>632</b>;</p>
<p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. 19</figref> illustrates the spectrum of the fabricated column-wise ADC with f<sub>frame</sub>=15 Hz;</p>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 20</figref> illustrates the sampled well size of one pixel;</p>
<p id="p-0053" num="0052"><figref idref="DRAWINGS">FIG. 21</figref> illustrates the pixel linearity before calibration;</p>
<p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. 22</figref> illustrates the pixel linearity after calibration;</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0008" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="h-0009" num="0000">WDR Pixel Design</p>
<p id="p-0055" num="0054">The dynamic range (DR) of a pixel is limited by the well capacity as specified by</p>
<p id="p-0056" num="0055">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mi>D</mi>
            <mo>&#x2062;</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <mi>R</mi>
          </mrow>
          <mo>=</mo>
          <mfrac>
            <mrow>
              <msub>
                <mi>V</mi>
                <mi>w</mi>
              </msub>
              <mo>&#x2062;</mo>
              <mrow>
                <msub>
                  <mi>C</mi>
                  <mi>int</mi>
                </msub>
                <mo>/</mo>
                <msub>
                  <mi>T</mi>
                  <mi>int</mi>
                </msub>
              </mrow>
            </mrow>
            <msub>
              <mi>I</mi>
              <mi>min</mi>
            </msub>
          </mfrac>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where I<sub>min </sub>is the minimum photo current that the sensor can detect. This is determined by the least significant bit (LSB) size of the quantizer or the pixel read-out noise level, whichever is larger. The maximum SNR of this pixel is
</p>
<p id="p-0057" num="0056">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mi>S</mi>
            <mo>&#x2062;</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <mi>N</mi>
            <mo>&#x2062;</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <mi>R</mi>
          </mrow>
          <mo>=</mo>
          <mfrac>
            <msubsup>
              <mi>V</mi>
              <mi>w</mi>
              <mn>2</mn>
            </msubsup>
            <mrow>
              <mfrac>
                <msub>
                  <mi>qV</mi>
                  <mi>w</mi>
                </msub>
                <msub>
                  <mi>C</mi>
                  <mi>int</mi>
                </msub>
              </mfrac>
              <mo>+</mo>
              <msubsup>
                <mi>&#x3c3;</mi>
                <mi>rd</mi>
                <mn>2</mn>
              </msubsup>
            </mrow>
          </mfrac>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>2</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where &#x3c3;<sub>rd</sub><sup>2 </sup>is the input-referred read-out voltage noise power.
</p>
<p id="p-0058" num="0057">In order to design a highly linear WDR imaging sensor with high SNR, the dynamic range (DR) should be expanded linearly. In one embodiment, the DR is linearly expanded by adding a comparator <b>204</b> and a counter <b>206</b> into the pixel circuit as shown in <figref idref="DRAWINGS">FIG. 4A</figref>. The photo diode gets reset whenever V<sub>n </sub>falls below the threshold voltage, as shown in <figref idref="DRAWINGS">FIG. 2</figref>. The number of pixel overflow events (D<sub>w</sub>) is recorded by the counter <b>206</b>. The equivalent well size in this pixel is V<sub>rst</sub>&#x2212;V<sub>ref</sub>. At the end of the accumulation, the accumulated photo voltage can be simply calculated as
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>ph</sub><i>=D</i><sub>w</sub><i>&#xb7;V</i><sub>w</sub><i>+D</i><sub>r</sub>&#xb7;LSB<sub>0</sub>&#x2003;&#x2003;(3)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where LSB<sub>0 </sub>is the LSB of the quantizer, while D<sub>r </sub>is the quantized residual voltage (V<sub>r</sub>). Because V<sub>w </sub>is nonlinearly dependent on the photocurrent as shown in <figref idref="DRAWINGS">FIG. 3</figref>, the photo voltage V<sub>ph </sub>obtained above is low. The embodiments detailed below provide calibration circuits and methods to compensate for the nonlinearity.
<br/>
Circuit Description
</p>
<p id="p-0059" num="0058">In one embodiment, the imaging sensor is designed in a 0.35 &#x3bc;m 2P4M CMOS process. The functional block diagram of the designed imaging sensor is shown in <figref idref="DRAWINGS">FIG. 4B</figref>. Pixels <b>400</b> in pixel array <b>305</b> are organized in N<sub>r </sub>rows and N<sub>c </sub>columns. Outputs of pixels <b>400</b> in each column are processed by a column circuit <b>500</b> associated with the column. Parallel digital outputs of N<sub>c </sub>column circuits <b>500</b> are multiplexed by a shift register <b>304</b>. The analog reference voltages and currents of pixels <b>400</b> and column circuits <b>500</b> are generated by reference generation circuit <b>301</b>. The calibration circuit requires a calibration current generation circuit <b>302</b> and a reference ADC <b>306</b>. The calibration data and raw quantized photocurrent data are processed by decoder <b>600</b> for recovering the accurate digital photocurrent. Control signals and clocks of pixel <b>400</b>, column circuit <b>500</b>, shift register <b>304</b>, reference ADC <b>306</b> and decoder <b>600</b> are generated by control logic <b>303</b>. The working mode of the circuit is selected by an external digital code (mode&#x3c;1:0&#x3e;). Control logic <b>303</b> further receives an external clock (clk) and an external reset signal (rst).</p>
<p id="p-0060" num="0059">A. Pixel Circuit</p>
<p id="p-0061" num="0060">According to a further embodiment, the pixel circuit <b>400</b> with the column-wise pathway is shown in <figref idref="DRAWINGS">FIG. 5A</figref>. Each pixel circuit <b>400</b> includes a basic four-transistor active pixel sensor (4T APS), which includes transistors <b>406</b>, <b>409</b>, <b>411</b>, and <b>412</b> and photodiode <b>408</b>, an in-pixel comparator <b>402</b>, a one-bit memory <b>403</b>, a current sampler <b>401</b>, a buffer <b>414</b> and calibration circuits including transistors <b>404</b>, <b>405</b>, and <b>407</b>.</p>
<p id="p-0062" num="0061">The circuit <b>400</b> shown in <figref idref="DRAWINGS">FIG. 5A</figref> can be operated with a global shutter, which means &#x3c6;<sub>rst,i </sub>for all rows are the same. The pixel circuit <b>400</b> can also be operated with a rolling shutter, which means &#x3c6;<sub>rst,i </sub>has a phase shift between different rows. The rolling shutter reduces the speed requirement on the circuits with the same frame rate (f<sub>frame</sub>).</p>
<p id="p-0063" num="0062">The 1-bit memory <b>403</b> is further shown in <figref idref="DRAWINGS">FIG. 5B</figref>. The memory is a 1-bit dynamic random-access-memory (DRAM). The data is stored on capacitor <b>422</b>. Diode <b>421</b> enables the pulse to be written into the DRAM asynchronously. Transistor <b>423</b> controls the reset of the DRAM by using signal &#x3c6;<sub>d,rst,i</sub>. The PMOS diode <b>421</b> has strong write capability, while the reset transistor <b>423</b> has weak reset capability. Therefore, pulses can be written into the DRAM during the reset period.</p>
<p id="p-0064" num="0063">The pixel circuit <b>400</b> operates in three modes: the difference mode, the WDR mode, and the calibration mode.</p>
<p id="p-0065" num="0064">When the pixel circuit is in the WDR mode, signal &#x3c6;<sub>cal </sub>is low. Transistors <b>404</b> and <b>407</b>, which act as switches, are turned off. Current sampler <b>401</b> is turned off by the control signals. The timing of control signals of pixel <b>400</b> in the WDR mode is shown in <figref idref="DRAWINGS">FIG. 6</figref>. The external shutter signal of row i (&#x3c6;<sub>rst,i</sub>) turns on external shutter transistor <b>409</b> to reset the FD voltage V<sub>n </sub>to a reset voltage V<sub>rst</sub>. Photocurrent from photodiode <b>408</b> discharges V<sub>n</sub>. <b>405</b> and <b>406</b> are identical cascode transistors. Once V<sub>n </sub>falls below V<sub>ref</sub>, comparator <b>402</b> turns on internal shutter <b>410</b> and resets the FD to V<sub>rst </sub>again. The pulse from comparator <b>402</b> is recorded by 1-bit memory <b>403</b>. Control signal &#x3c6;<sub>drd,i </sub>periodically turns on digital buffer <b>414</b> of the digital column bus for column circuit <b>500</b>. At the end of the integration, control signal &#x3c6;<sub>ard,i </sub>turns on analog buffer <b>411</b> of the analog column bus. V<sub>n </sub>voltage is read and quantized by column circuit <b>500</b>. A simple comparator with low biasing current can be used for comparator <b>402</b>.</p>
<p id="p-0066" num="0065">When pixel <b>400</b> is in the difference mode, current sampler <b>401</b> is turned on by the control signals. V<sub>ref </sub>is biased with a very low voltage so that the self-reset function is shut off. Current sampler <b>401</b> samples the photocurrent from photodiode <b>408</b> in the sampling frame. In the consecutive accumulation frame, current sampler <b>401</b> holds the current of the previous sampling frame. The current difference between consecutive frames is integrated. V<sub>n </sub>is read and quantized at the end of this frame, which gives the difference frame and indicates the activity within the scene. An exemplary teaching on the current sampler design can be found in &#x201c;Design and implementation of a switched-current memory cell for low-power and weak-current operations&#x201d;, IEEE Journal of Solid-State Circuits, Vol. 36, pp. 304-307, February 2001, by C. Wang et al, which is incorporated herein by reference in its entirety and for everything it teaches therein.</p>
<p id="p-0067" num="0066">When pixel <b>400</b> is in the calibration mode, control signal &#x3c6;<sub>cal </sub>is high and current sampler <b>401</b> is turned off. Photodiode <b>408</b> is disconnected from V<sub>n</sub>. Instead the calibration current I<sub>cal </sub>is integrated in the pixel.</p>
<p id="p-0068" num="0067">The three operating modes are described in greater detailed below with reference to <figref idref="DRAWINGS">FIG. 7A</figref>, which depicts further details of the pixel circuit <b>400</b>.</p>
<p id="p-0069" num="0068">1) Difference Mode</p>
<p id="p-0070" num="0069">The pixel circuit <b>400</b> normally runs in the difference mode to reduce the output data rate, which saves data transmission power and the digital power of following processing circuits. In the difference mode, the current sampler <b>401</b> in each pixel circuit is active. V<sub>ref </sub>of the comparator <b>402</b> is set to a low value, which keeps the comparator output low. The difference mode runs through every two consecutive frames and a difference image is calculated from the two consecutive frames.</p>
<p id="p-0071" num="0070">At the beginning of the sampling frame, both sampling switches stay on. &#x3c6;<sub>s,TDI </sub>turns off early, which injects charge only onto the capacitor M<b>6</b>. At the end of the frame, &#x3c6;<sub>s1,TDI </sub>turns off, and injects most charge onto M<b>8</b> which is about 5 times larger than M<b>6</b>. The designed sampler <b>401</b> can sample the photo current with offset less than 0.1%, which is enough for activity detection in most applications.</p>
<p id="p-0072" num="0071">In an accumulation frame, the difference current between the new photo current and the sampled current accumulates on the floating drain (V<sub>n</sub>) after the difference shutter (&#x3c6;<sub>rst,TDI</sub>) turns off. The reset level V<sub>cm,TDI </sub>is in the middle of the voltage range so that both positive and negative difference currents can be accumulated. At the end of the frame, the accumulated voltage is quantized by the column-wise ADC.</p>
<p id="p-0073" num="0072">An off-chip DSP checks the difference image, which indicates the activity in the scene. If the activity is beyond a certain level, the imaging sensor <b>300</b> is switched to the WDR mode to capture a high-quality image. The current sampler <b>401</b> is switched off during the WDR mode. The supply voltage of the sampler (V<sub>d,TDI</sub>) is 0.4V lower than V<sub>d </sub>to suppress the leakage current from the sampler.</p>
<p id="p-0074" num="0073">2) WDR Mode</p>
<p id="p-0075" num="0074">To avoid image lag in the 4T APS pixel, the transfer gate M<b>1</b><i>a </i>never resets during the accumulation. Instead, V<sub>b </sub>stays fixed so that the potential well of the diode is always full in the steady state, as shown in <figref idref="DRAWINGS">FIG. 7A</figref>. The photo charge spills over to the floating drain during the accumulation.</p>
<p id="p-0076" num="0075">The WDR mode starts as a rolling shutter (&#x3c6;<sub>rst,i</sub>) resets the pixel. When the accumulated voltage on the floating drain (V<sub>n</sub>) reaches the threshold voltage V<sub>ref </sub>of the comparator, the output of the comparator (&#x3c6;<sub>rst2</sub>) resets the floating drain, as shown in <figref idref="DRAWINGS">FIG. 7B</figref>. Then, the photo current accumulates on the floating drain again. The dynamic of the floating drain voltage V<sub>n </sub>is similar to that shown in <figref idref="DRAWINGS">FIG. 2</figref>. An overflow event is recorded by a MOS capacitor M<b>3</b> in the 1-bit memory. M<b>3</b> is regularly read and reset by the column slice to count the overflow number. At the end of the accumulation, the residual voltage D<sub>r </sub>of the pixel is read out and quantized by the column-wise ADC.</p>
<p id="p-0077" num="0076">Correlated double sampling (CDS) is performed on the residual voltage D<sub>r</sub>. The ADC first samples (&#x3c6;<sub>cds,s</sub>) the residual voltage on C<sub>s</sub>. The pixel is reset before the analog read-out control (&#x3c6;<sub>ard,i</sub>) switches to the next row. The pixel reset voltage is sampled on C<sub>r</sub>. This CDS is performed over two frames. It can effectively remove 1/f reset noise. The quantization takes place after the CDS phase (&#x3a6;<sub>cds</sub>) turns off.</p>
<p id="p-0078" num="0077">The timing diagram for the difference mode and the WDR mode is shown in <figref idref="DRAWINGS">FIG. 7C</figref>.</p>
<p id="p-0079" num="0078">With a constant well size V<sub>w</sub>, the accumulated photo voltage of this partial quantization scheme can be calculated by equation (3). Nonetheless, V<sub>w </sub>is nonlinear because the asynchronous reset by the weak-current comparator (1 nA) depends heavily on the photo current. In order to compensate for the nonlinearity, a digital calibration scheme is provided for the sensor circuit <b>300</b>.</p>
<p id="p-0080" num="0079">The general operation of the calibration scheme involves sampling the nonlinear V<sub>w </sub>function in the calibration mode. In the WDR mode, the accurate well size V<sub>w </sub>is interpolated from the sampled nonlinear function, and is used to calculate the accurate photo voltage using equation (3).</p>
<p id="p-0081" num="0080">3) Calibration Mode</p>
<p id="p-0082" num="0081">In the calibration mode, the photodiode is switched off. Instead, the pixel accumulates an on-chip calibration current (I<sub>cal</sub>). Identical cascode transistors M<b>1</b><i>a </i>and M<b>1</b><i>b </i>keep the same FD capacitance in the calibration mode and the WDR mode. The exact I<sub>cal </sub>value can be measured from an on-chip 16-bit current ADC, as shown in <figref idref="DRAWINGS">FIG. 8</figref>. With equation (3), the well capacity V<sub>w </sub>for current I<sub>cal </sub>can be calculated, which forms one sample on the nonlinear function in <figref idref="DRAWINGS">FIG. 3</figref>. Twelve on-chip current sources are designed for each column.</p>
<p id="p-0083" num="0082">The current ADC is a dual-slope ADC. In the pre-charge phase &#x3c6;<sub>p</sub>, I<sub>cal </sub>charges C<sub>1</sub>. In the quantization phase &#x3c6;<sub>q</sub>, the reference current I<sub>ref </sub>discharges C<sub>1</sub>. V<sub>x </sub>is compared with V<sub>rcal </sub>continuously in &#x3c6;<sub>clk,2 </sub>phases. CDS is performed in &#x3c6;<sub>clk,1 </sub>phase. The zero crossing moment will be latched by the output of A<sub>2</sub>, which is proportional to I<sub>cal</sub>. The system clock is 20 MHz. Each I<sub>cal </sub>quantization takes about 3.2 ms. Measurements of the calibration currents in one column last about 38.4 ms.</p>
<p id="p-0084" num="0083">In one embodiment of the pixel circuit <b>400</b>, the pixel area is 25 &#x3bc;m&#xd7;25 &#x3bc;m. The photodiode size is 17 &#x3bc;m&#xd7;10 &#x3bc;m, which gives a fill factor of 27%. The current sampler accounts for about 19% of the pixel. Without the current sampler, the fill factor is 33%.</p>
<p id="p-0085" num="0084">4) Temporal Noise Analysis</p>
<p id="p-0086" num="0085">With a small photo current which does not trigger an overflow, the pixel temporal noise mainly comes from the photo current shot noise and the read-out circuit noise. The noise power is</p>
<p id="p-0087" num="0086">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mover>
          <msubsup>
            <mi>v</mi>
            <mi>n</mi>
            <mn>2</mn>
          </msubsup>
          <mi>_</mi>
        </mover>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <msub>
              <mi>qV</mi>
              <mi>ph</mi>
            </msub>
            <msub>
              <mi>C</mi>
              <mi>int</mi>
            </msub>
          </mfrac>
          <mo>+</mo>
          <mrow>
            <mover>
              <msubsup>
                <mi>&#x3c3;</mi>
                <mi>rd</mi>
                <mn>2</mn>
              </msubsup>
              <mi>_</mi>
            </mover>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>4</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
At the low current end, the circuit noise dominates. Therefore, the SNR increases 6 dB per photo current doubling. At the large current end, the photo current shot noise dominates. The SNR increases 3 dB per photo current doubling.
</p>
<p id="p-0088" num="0087">When the photo current is large enough to trigger overflows, the pixel temporal noise mainly comes from the reset noise and the photo current shot noise. The overall noise power is</p>
<p id="p-0089" num="0088">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mover>
            <msubsup>
              <mi>v</mi>
              <mi>n</mi>
              <mn>2</mn>
            </msubsup>
            <mi>_</mi>
          </mover>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <msub>
                <mi>qV</mi>
                <mi>ph</mi>
              </msub>
              <msub>
                <mi>C</mi>
                <mi>int</mi>
              </msub>
            </mfrac>
            <mo>+</mo>
            <mrow>
              <msub>
                <mi>D</mi>
                <mi>w</mi>
              </msub>
              <mo>&#x2062;</mo>
              <mfrac>
                <mi>kT</mi>
                <msub>
                  <mi>C</mi>
                  <mi>int</mi>
                </msub>
              </mfrac>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>5</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where D<sub>w </sub>is the overflow number. The reset noise is much smaller than the shot noise. Therefore, the SNR improves by 3 dB per photo current doubling. The pixel SNR can be simulated and plotted in <figref idref="DRAWINGS">FIG. 7</figref>. In the simulation, the well capacity V<sub>w </sub>is 1.5V. The DR is extended by 256 times. The integration capacitance is 12fF. The read out circuit noise is 30e<sup>&#x2212;</sup>. As the partial quantization scheme extends the DR greatly, the pixel SNR is better than the previous designs.
</p>
<p id="p-0090" num="0089">B. Column-wise Counter</p>
<p id="p-0091" num="0090">A block diagram of column circuit <b>500</b> is shown in <figref idref="DRAWINGS">FIG. 9</figref>. The single-bit data on the digital column bus is periodically processed by column counter <b>501</b>. Analog buffer <b>411</b> in each pixel is driven by column current source <b>502</b>. The output analog value on the analog column bus is quantized by an n-bit ADC <b>503</b> into digital code D<sub>r</sub>. The resolution of the ADC is generally 8-10 bits. The ADC can be designed from multiple structures. One possibility is a single-slope ADC. An exemplary teaching can be found in &#x201c;A CMOS imager with column-level ADC using dynamic column fixed-pattern noise reduction,&#x201d; IEEE Journal of Solid-State Circuits, Vol. 41, pp. 3007-3015, December 2006, by M. Snoeij et al, which is hereby incorporated by reference and for everything that it includes.</p>
<p id="p-0092" num="0091">The block diagram of counter <b>501</b> for j-th column is shown in <figref idref="DRAWINGS">FIG. 10</figref>. The timing of control signals for counter <b>501</b> is shown in <figref idref="DRAWINGS">FIG. 11</figref>. Counter <b>501</b> includes an array of static random-access-memory (SRAM). Each SRAM is m-bit long. It holds the self-reset number (D<sub>w</sub>) of the pixel in one row. The SRAMs of different rows are opened sequentially by control signal &#x3c6;<sub>sram,i</sub>. The operation sequence on every SRAM includes a read and a write, which is performed in a counter clock &#x3c6;<sub>clk,cnt </sub>cycle. In the read phase of SRAM (i,j), switch <b>513</b> of pixel (i,j) is turned on and connects digital buffer <b>414</b> to the digital column bus so that the content of the SRAM adds up with the content of 1-bit memory <b>403</b> by adder <b>511</b>, which gives the new D<sub>w </sub>of pixel (i,j). On the &#x3c6;<sub>clk,cnt </sub>falling edge, the new D<sub>w </sub>is latched by register <b>512</b>. As control signal &#x3c6;<sub>cwr </sub>turns on transistors <b>516</b> and <b>519</b>, the new D<sub>w </sub>is written into SRAM (i, j). During the write phase of the same SRAM, 1-bit memory <b>403</b> in pixel (i, j) is also reset by signal &#x3c6;<sub>d,rst,i</sub>. The BIT bus and the <o ostyle="single">BIT</o> bus are equalized by control signal &#x3c6;<sub>eqw </sub>before any SRAM cell is opened. The SRAM cells are reset by the control signal &#x3c6;<sub>reg,rst</sub>. Depending on the shutter design, the timing of signals can be different. <figref idref="DRAWINGS">FIG. 11</figref> is the timing diagram for the rolling shutter. During each frame, an m-bit long SRAM needs to be refreshed by 2<sup>m </sup>times. As a result, the dynamic range of the image sensor is expanded by 2<sup>m </sup>times with this partial quantization method. The frequency of the counter clock is 2<sup>m</sup>&#xd7;N<sub>r</sub>&#xd7;f<sub>frame</sub>.</p>
<p id="p-0093" num="0092">The dynamic range of this partial quantization architecture is m+n bit. With the quantized values D<sub>w </sub>and D<sub>r</sub>, the overall accumulated photo voltage V<sub>ph </sub>can be calculated as
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>ph</sub><i>=D</i><sub>w</sub><i>&#xb7;V</i><sub>w</sub><i>+D</i><sub>r</sub>&#xb7;LSB<sub>0</sub>,<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where LSB<sub>0 </sub>is the least significant bit (LSB) size of ADC <b>503</b>. Because V<sub>w </sub>is nonlinearly dependent on the photocurrent as shown in <figref idref="DRAWINGS">FIG. 3</figref>, the linearity of V<sub>ph </sub>from the equation above is as low as the other self-reset CMOS image sensors. This nonlinearity is compensated for and eliminated by using the calibration scheme described herein.
</p>
<p id="p-0094" num="0093">In one further embodiment, the pixel DR is expanded by 256 times. As a result, an 8-bit column counter is required by each pixel. A normal 8-bit counter needs 8 D-flip-flops (DFF), which requires about 300 transistors. If this counter is included in the pixel, the fill factor will be low. The digital spikes will contaminate the analog sensor as well.</p>
<p id="p-0095" num="0094">The column-wise counter includes an SRAM bank for different pixels in the column. The logics add the overflow bit B<sub>w </sub>from the pixel to the content of the SRAM periodically. The counter runs on the counter clock &#x3c6;<sub>clk,cnt</sub>. The clock rate is 256&#xd7;N<sub>r</sub>&#xd7;f<sub>frame</sub>, where N<sub>r </sub>is the row number. At the beginning of each frame of every row, SRAM of this row is reset by &#x3c6;<sub>eqw</sub>. The digital read-out control signal &#x3c6;<sub>drd,i </sub>selects both the SRAM and the 1-bit memory of i-th row to perform the addition. After the addition, the falling edge of &#x3c6;<sub>clk,cnt </sub>latches the new overflow number. Then, the column digital write signal &#x3c6;<sub>dwr </sub>controls the new overflow number to be written into the same SRAM. After that, the next row is turned on for refreshing. Within a frame, the SRAM of one pixel will be refreshed by 256 times. The adder and the register should operate at this frequency.</p>
<p id="p-0096" num="0095">After the addition, the clock &#x3c6;<sub>bw,rst,i </sub>resets the 1-bit memory in the pixel of i-th row. To prevent a write and reset confliction, a weak reset is designed by applying a low gate voltage on the NMOS switch <b>423</b>. If the comparator <b>402</b> generates a high pulse during the reset phase &#x3c6;<sub>bw,rst,i</sub>, the NMOS diode <b>421</b> is still able to pull up the voltage on transistor <b>423</b>.</p>
<p id="p-0097" num="0096">Because the adder is shared by different pixels in the column, the transistor count per pixel can be greatly reduced. On average, 48 transistors are needed for each pixel, which could be further reduced by using dynamic RAM (DRAM). DRAM can be easily implemented in this architecture because the refreshing circuits are already in place.</p>
<p id="p-0098" num="0097">C. Column-wise ADC</p>
<p id="p-0099" num="0098">As shown in <figref idref="DRAWINGS">FIG. 7B</figref>, a single-slope ADC is designed to quantize the pixel residual voltages in one column. The ADC design is similar to the one introduced in, M. Snoeij, et al. &#x201c;A CMOS imager with column-level ADC using dynamic column fixed-pattern noise reduction,&#x201d; <i>IEEE J. Solid</i>-<i>State Circuits</i>, Vol. 41, pp. 3007-3015, December 2006, which is hereby incorporated by reference in its entirety and for everything it teaches therein. A high quality ramp signal is generated by a similar ramp signal generator in F. Azais, et al. &#x201c;A low-cost adaptive ramp generator for analog BIST applications,&#x201d; <i>IEEE Proc. VLSI Test Symp</i>., pp. 266-271, May 2001, which is hereby incorporated by reference in its entirety and for everything it teaches therein. The column-wise ADC is designed for 9 bit resolution. The frequency of the column-wise ADC clock (&#x3a6;<sub>clk,adc</sub>) is 512&#xd7;N<sub>r</sub>&#xd7;f<sub>frame</sub>.</p>
<p id="h-0010" num="0000">Digital Calibration</p>
<p id="p-0100" num="0099">According to one embodiment, an interpolation-based method is used to estimate the nonlinear V<sub>w </sub>function in <figref idref="DRAWINGS">FIG. 3</figref>, and to compensate for the nonlinearity using a digital decoder. The overall procedure includes two modes. The procedure of the method is plotted in <figref idref="DRAWINGS">FIG. 12</figref>.</p>
<p id="p-0101" num="0100">In the calibration mode, pixel <b>400</b> is connected to the calibration current I<sub>cal</sub>. Different calibration currents I<sub>cal </sub>are quantized by the pixel, so that the nonlinear function V<sub>w</sub>=f(I<sub>ph</sub>) is sampled. The calibration currents are generated by I<sub>cal </sub>generation circuits <b>302</b>. Current sources with high output resistance are used in I<sub>cal </sub>generation circuits <b>302</b>. The exact I<sub>cal </sub>values are digitized by a current reference ADC <b>306</b> with m+n bit resolution. A dual slope ADC can be used to achieve the high resolution.</p>
<p id="p-0102" num="0101">At the beginning of the calibration mode, a calibration current I<sub>cal,0 </sub>that does not trigger a pixel self-reset is applied to pixel <b>400</b>, and is quantized to (0, D<sub>r,0</sub>). Reference ADC <b>306</b> quantizes the same current to D<sub>cal,0</sub>. The LSB of the pixel system is digitized by the reference ADC <b>306</b> as</p>
<p id="p-0103" num="0102">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>D</mi>
    <mrow>
      <mi>L</mi>
      <mo>&#x2062;</mo>
      <mstyle>
        <mspace width="0.3em" height="0.3ex"/>
      </mstyle>
      <mo>&#x2062;</mo>
      <mi>S</mi>
      <mo>&#x2062;</mo>
      <mstyle>
        <mspace width="0.3em" height="0.3ex"/>
      </mstyle>
      <mo>&#x2062;</mo>
      <mi>B</mi>
    </mrow>
  </msub>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <msub>
        <mi>D</mi>
        <mrow>
          <mi>cal</mi>
          <mo>,</mo>
          <mn>0</mn>
        </mrow>
      </msub>
      <msub>
        <mi>D</mi>
        <mrow>
          <mi>r</mi>
          <mo>,</mo>
          <mn>0</mn>
        </mrow>
      </msub>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0104" num="0103">Then, N<sub>s </sub>different calibration currents I<sub>cal,k </sub>are quantized by both pixel <b>400</b> to (D<sub>w,k</sub>, D<sub>r,k</sub>) and current reference ADC <b>503</b> to D<sub>cal,k</sub>. From these digitized values, the digital equivalence (D<sub>cw,k</sub>) of V<sub>w </sub>for I<sub>cal,k </sub>can be calculated as</p>
<p id="p-0105" num="0104">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>D</mi>
          <mrow>
            <mi>cw</mi>
            <mo>,</mo>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>D</mi>
              <mrow>
                <mi>w</mi>
                <mo>,</mo>
                <mi>k</mi>
              </mrow>
            </msub>
          </mfrac>
          <mo>&#x2062;</mo>
          <mrow>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>D</mi>
                  <mrow>
                    <mi>cal</mi>
                    <mo>,</mo>
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo>-</mo>
                <mrow>
                  <msub>
                    <mi>D</mi>
                    <mrow>
                      <mi>r</mi>
                      <mo>,</mo>
                      <mi>k</mi>
                    </mrow>
                  </msub>
                  <mo>&#x2062;</mo>
                  <msub>
                    <mi>D</mi>
                    <mrow>
                      <mi>L</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>S</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>B</mi>
                    </mrow>
                  </msub>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mstyle>
        <mspace width="0.3em" height="0.3ex"/>
      </mstyle>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0106" num="0105">(D<sub>cal,k</sub>D<sub>cw,k</sub>) forms a sample of the nonlinear function. Consecutive samples form an interpolation region. The slope of this region is calculated as</p>
<p id="p-0107" num="0106">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>S</mi>
    <mi>k</mi>
  </msub>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <msub>
          <mi>D</mi>
          <mrow>
            <mi>cw</mi>
            <mo>,</mo>
            <mrow>
              <mi>k</mi>
              <mo>+</mo>
              <mn>1</mn>
            </mrow>
          </mrow>
        </msub>
        <mo>-</mo>
        <msub>
          <mi>D</mi>
          <mrow>
            <mi>cw</mi>
            <mo>,</mo>
            <mi>k</mi>
          </mrow>
        </msub>
      </mrow>
      <mrow>
        <msub>
          <mi>D</mi>
          <mrow>
            <mi>cal</mi>
            <mo>,</mo>
            <mrow>
              <mi>k</mi>
              <mo>+</mo>
              <mn>1</mn>
            </mrow>
          </mrow>
        </msub>
        <mo>-</mo>
        <msub>
          <mi>D</mi>
          <mrow>
            <mi>cal</mi>
            <mo>,</mo>
            <mi>k</mi>
          </mrow>
        </msub>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0108" num="0107">The interpolation parameters can be calculated using interpolation parameter decoder <b>602</b> shown in <figref idref="DRAWINGS">FIG. 14</figref> in the calibration mode. The interpolation parameters will be stored in memory to calculate accurate photocurrents in the WDR mode. <figref idref="DRAWINGS">FIG. 15</figref> describe a schematic diagram of interpolation parameter decoder <b>602</b>.</p>
<p id="p-0109" num="0108">In the WDR mode, the accurate V<sub>w </sub>of a photocurrent can be estimated through linear interpolation as shown in <figref idref="DRAWINGS">FIG. 13</figref>. With digitized values (D<sub>w</sub>, D<sub>r</sub>), if the photocurrent is found to be in segment x on the curve, the accurate digital photocurrent value can be calculated as</p>
<p id="p-0110" num="0109">
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>D</mi>
    <mrow>
      <mi>ph</mi>
      <mo>,</mo>
      <mi>fine</mi>
    </mrow>
  </msub>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>D</mi>
            <mi>w</mi>
          </msub>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>D</mi>
                <mrow>
                  <mi>cw</mi>
                  <mo>,</mo>
                  <mi>x</mi>
                </mrow>
              </msub>
              <mo>-</mo>
              <mrow>
                <msub>
                  <mi>S</mi>
                  <mi>x</mi>
                </msub>
                <mo>&#x2062;</mo>
                <msub>
                  <mi>D</mi>
                  <mrow>
                    <mi>cal</mi>
                    <mo>,</mo>
                    <mi>x</mi>
                  </mrow>
                </msub>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
          <msub>
            <mi>D</mi>
            <mi>r</mi>
          </msub>
          <mo>&#x2062;</mo>
          <msub>
            <mi>D</mi>
            <mrow>
              <mi>L</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mi>S</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mi>B</mi>
            </mrow>
          </msub>
        </mrow>
      </mrow>
      <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mrow>
          <msub>
            <mi>S</mi>
            <mi>x</mi>
          </msub>
          <mo>&#x2062;</mo>
          <msub>
            <mi>D</mi>
            <mi>w</mi>
          </msub>
        </mrow>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0111" num="0110">The calculation can be performed with decoder <b>603</b> in <figref idref="DRAWINGS">FIG. 14</figref>. Segment x can be found through iterations. <figref idref="DRAWINGS">FIG. 17</figref> depicts a schematic diagram of recovery decoder <b>603</b>.</p>
<p id="p-0112" num="0111">The calibration and recovery procedures are further described herein with reference to <figref idref="DRAWINGS">FIGS. 13-18</figref>. In the calibration mode, the pixel is configured to sample the nonlinear well capacity V<sub>w </sub>with M samples {(I<sub>cal</sub>, V<sub>w</sub>)<sub>i</sub>}<sub>i=1, . . . , M</sub>. In the WDR mode, the imaging sensor generates raw image data (D<sub>w</sub>, D<sub>r</sub>). A DSP estimates the accurate well capacity V<sub>w </sub>through linear interpolation from the M samples in real time, and recovers the accurate image from the raw image data.</p>
<p id="p-0113" num="0112">A. Recovery Procedure</p>
<p id="p-0114" num="0113">For a photo current I<sub>ph</sub>, the pixel quantizes it into D<sub>w </sub>and D<sub>r </sub>so that
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>I</i><sub>ph</sub><i>=K</i>(<i>D</i><sub>w</sub><i>V</i><sub>w</sub><i>+D</i><sub>r</sub>LSB<sub>0</sub>)&#x2003;&#x2003;(6)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where K=C<sub>int</sub>/T<sub>int</sub>.
</p>
<p id="p-0115" num="0114">With an approximate V<sub>w0 </sub>applied, a crude I<sub>ph0 </sub>can be calculated. Based on I<sub>ph0</sub>, the interpolation segment region x can be identified as shown in <figref idref="DRAWINGS">FIG. 13</figref>. With interpolation, the accurate V<sub>w </sub>can be calculated.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>w</sub>=(<i>I</i><sub>ph</sub><i>&#x2212;I</i><sub>cal,x</sub>)<i>S</i><sub>x</sub><i>+V</i><sub>w,x</sub>&#x2003;&#x2003;(7)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where S<sub>x </sub>is the slope in this region. With equations (6) and (7), the accurate photo current can be found as
</p>
<p id="p-0116" num="0115">
<maths id="MATH-US-00010" num="00010">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>I</mi>
          <mi>ph</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mrow>
              <mi>K</mi>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>D</mi>
                      <mi>w</mi>
                    </msub>
                    <mo>&#x2062;</mo>
                    <msub>
                      <mi>V</mi>
                      <mrow>
                        <mi>w</mi>
                        <mo>,</mo>
                        <mi>x</mi>
                      </mrow>
                    </msub>
                  </mrow>
                  <mo>+</mo>
                  <mrow>
                    <msub>
                      <mi>D</mi>
                      <mi>r</mi>
                    </msub>
                    <mo>&#x2062;</mo>
                    <mi>L</mi>
                    <mo>&#x2062;</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>&#x2062;</mo>
                    <mi>S</mi>
                    <mo>&#x2062;</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>&#x2062;</mo>
                    <msub>
                      <mi>B</mi>
                      <mn>0</mn>
                    </msub>
                  </mrow>
                  <mo>-</mo>
                  <mrow>
                    <msub>
                      <mi>D</mi>
                      <mi>w</mi>
                    </msub>
                    <mo>&#x2062;</mo>
                    <msub>
                      <mi>I</mi>
                      <mrow>
                        <mrow>
                          <mi>ca</mi>
                          <mo>&#x2062;</mo>
                          <mi>l</mi>
                        </mrow>
                        <mo>,</mo>
                        <mi>x</mi>
                      </mrow>
                    </msub>
                    <mo>&#x2062;</mo>
                    <msub>
                      <mi>S</mi>
                      <mi>x</mi>
                    </msub>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mrow>
              <mn>1</mn>
              <mo>-</mo>
              <mrow>
                <msub>
                  <mi>KD</mi>
                  <mi>w</mi>
                </msub>
                <mo>&#x2062;</mo>
                <msub>
                  <mi>S</mi>
                  <mi>x</mi>
                </msub>
              </mrow>
            </mrow>
          </mfrac>
          <mo>.</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>8</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0117" num="0116">The interpolation region x should be verified with this photo current value. If it is in the wrong region, the new region would be used for another iteration. Theoretically, it might take several iterations before the final I<sub>ph </sub>is found. However, experiments show that no iteration is needed because the pixel nonlinearity generally is small, and the nonlinear function is well-formed.</p>
<p id="p-0118" num="0117">During the experiment, a digital version of this algorithm is coded in a DSP. The mathematical derivation of this digital algorithm can be found in H. Chan, and J. Yuan, &#x201c;A Low-Distortion and Wide Dynamic Range CMOS Imager for Wireless Capsule Endoscopy,&#x201d; <i>International Symp. Circuits and Systems</i>, pp. 2945-2948, Seattle, USA, May 18-23, 2008, and in J. Yuan, H. Chan, S. Fung, and B. Liu, &#x201c;Digital calibration technique for highly linear wide dynamic range CMOS imaging sensor,&#x201d; <i>Electron. Lett</i>., Vol. 45, No. 9, pp. 449-451, 2009, where are herein incorporated by reference in their entireties and for everything they teach.</p>
<p id="p-0119" num="0118">B. Decoder</p>
<p id="p-0120" num="0119">The calibration and recovery procedures are implemented by two decoders in the off-chip DSP. <figref idref="DRAWINGS">FIGS. 16 and 18</figref> shows structures of the decoders. The rectangular boxes <b>622</b>, <b>626</b> and <b>630</b> indicate memory elements. Signals outside boxes are inputs or outputs to the DSP.</p>
<p id="p-0121" num="0120">The decoder shown in <figref idref="DRAWINGS">FIG. 16</figref> calculates the interpolation parameters in the calibration mode. D<sub>cal </sub>is the digitized value of I<sub>cal</sub>. The speed of this decoder is not critical. The decoder in <figref idref="DRAWINGS">FIG. 18</figref> recovers the photo current during the WDR mode. It supports the real-time calculation. As the current ADC quantizes currents into 16 bits, 4M-2 bytes memory is required for each pixel on average. For a 1 K-pixel image sensor, 4M-2 KB memory is needed in the DSP. If all pixels are processed in serial, the decoder needs to run at the rate f<sub>frame</sub>&#xd7;N<sub>r</sub>&#xd7;N<sub>c </sub>Hz, where N<sub>c </sub>is the column number. Although 16-bit multipliers are needed in the decoder, only one such decoder is needed in the DSP. If the image size is not large, multiplications can be done in serial as well. Hence, the hardware overhead for digital calibration is low.</p>
<heading id="h-0011" level="1">Experimental Results</heading>
<p id="p-0122" num="0121">A proof-of-concept 32&#xd7;32 imaging sensor is fabricated in a 0.35 &#x3bc;m 2P4M CMOS process. The die area is 2.7 mm<sup>2</sup>&#xd7;3.5 mm<sup>2</sup>. The imaging chip is illuminated by an integrating sphere US-120-SF (Labsphere, Inc.), with the light source Fiber-Lite PL900 (Dolan Jenner Industries). The optical power meter is S-120 (Thorlabs). The output data from the imaging chip is captured by a logic analyzer 16902B (Agilent), and is further processed by a computer.</p>
<p id="p-0123" num="0122">A. Optical and Electrical Parameters</p>
<p id="p-0124" num="0123">The column-wise ADC is measured. A sinusoidal signal is applied to one column-wise ADC. A spectrum analyzer (SR760, Stanford Research Systems) shows that the input spurious-free dynamic range (SFDR) is about 83 dB. 512-pt FFT testing routine is performed on the ADC at 15 Hz frame rate. The spectrum is shown in <figref idref="DRAWINGS">FIG. 19</figref>. The overall signal-to-noise-distortion ratio (SINAD) is 50.9 dB. The SFDR is 53.7 dB. The effective number of bit (ENOB) is 8.2 bits. The ADC LSB size is 5.9 mV.</p>
<p id="p-0125" num="0124">The pixel capacitance is measured to be 12 fF by the on-chip current ADC. The sensitivity of the imaging sensor is 13.3 &#x3bc;V/e<sup>&#x2212;</sup>. With the optical meter, the responsivity of the imaging sensor is measured to be 0.38 A/W at the wavelength of 555 nm. The dark current of a pixel is 0.96 fA at room temperature, which corresponds to a dark current density of 0.56 nA/cm<sup>2</sup>.</p>
<p id="p-0126" num="0125">B. Difference Mode</p>
<p id="p-0127" num="0126">The imaging sensor starts in the difference mode, and switches to the WDR mode when the difference image pixel value reaches a threshold. Various digital thresholds are set within the potential well. The imaging chip is able to switch to the WDR mode correctly if the scene changes significantly.</p>
<p id="p-0128" num="0127">C. Linearity</p>
<p id="p-0129" num="0128">With the current ADC, the calibration procedure is performed on pixels of the imaging sensor. V<sub>w </sub>of one pixel is sampled by 11 I<sub>cal </sub>currents, and is shown in <figref idref="DRAWINGS">FIG. 20</figref>. The digitized photo current I<sub>ph </sub>and V<sub>w </sub>have been converted to their analog values with the ADC LSB sizes. The nonlinearity is strong, particularly at the low current end.</p>
<p id="p-0130" num="0129">The pixel linearity is measured by 17 currents. Without calibration, a uniform V<sub>w </sub>is used to estimate the accumulated photo voltage V<sub>ph</sub>. The estimated photo voltages are shown in <figref idref="DRAWINGS">FIG. 21</figref>, with a spectrum simulated from this line. The harmonic distortion is &#x2212;36.4 dB. The sampled nonlinear function is used to recover the accurate photo voltages. The recovered photo voltages after calibration are shown in <figref idref="DRAWINGS">FIG. 22</figref>, with a spectrum simulated from this line. The harmonic distortion is improved to &#x2212;75.6 dB.</p>
<p id="p-0131" num="0130">The linearity in <figref idref="DRAWINGS">FIG. 22</figref> is tested in the electrical domain, which includes only the circuits. Linearity test in the optical domain can not be performed with the existing equipment because it requires an optical source with better than 14-bit linearity. Nonetheless, the difference between the two measurements is only the photo-diode.</p>
<p id="p-0132" num="0131">D. FPN, Temporal Noise and DR</p>
<p id="p-0133" num="0132">The imaging sensor is uniformly illuminated by the integrating sphere. Before calibration, the measured FPN of images is 5.1%. The FPN is mainly due to the mismatch of pixel-level circuits. After calibration, the overall measured FPN is 1.0%. FPN of the processing and read-out circuits is measured by applying a current into all the pixels, and comparing the recovered V<sub>ph </sub>after calibration. The uniformity among pixel circuits after calibration is better than 12-bit. Therefore, the measured FPN is dominated by the photo diode variation and the optical equipment.</p>
<p id="p-0134" num="0133">The temporal noise of the imaging sensor is dominated by the ADC quantization noise at low illumination level. Therefore, the pixel analog output is measured for noise instead. At a low illumination level which does not trigger overflow, the measured temporal noise of one pixel is 3.1 m V<sub>rms</sub>. The accumulated photo voltage is 1.287V. The SNR is 47.4 dB. At a high illumination level, the measured pixel temporal noise is 37.4 mV. The accumulated photo voltage is 330.6V. The SNR is 73.9 dB. The photo current ratio of the two illumination levels is about 256, while the SNR improvement is 26.5 dB. The SNR improves 3.3 dB per signal doubling, which agrees with the temporal noise analysis well.</p>
<p id="p-0135" num="0134">At 15 Hz frame rate, the maximum photo current that the partial quantization scheme can process is 58.4 pA. The minimum detectable photo current is limited by the ADC LSB. The dynamic range of the imaging sensor is about 95.3 dB.</p>
<p id="p-0136" num="0135">The measured performance of the designed imaging sensor is listed in Table I.</p>
<p id="p-0137" num="0136">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE I</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>PERFORMANCE SUMMARY OF THE DESIGNED IMAGING</entry>
</row>
<row>
<entry>SENSOR</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="84pt" align="left"/>
<colspec colname="1" colwidth="133pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Performance</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="21pt" align="left"/>
<colspec colname="1" colwidth="63pt" align="left"/>
<colspec colname="2" colwidth="133pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Process</entry>
<entry>0.35um 2P4M N-Well CMOS</entry>
</row>
<row>
<entry/>
<entry>Supply Voltage</entry>
<entry>3.3 V</entry>
</row>
<row>
<entry/>
<entry>Pixel Size</entry>
<entry>25 &#x3bc;m &#xd7; 25 &#x3bc;m</entry>
</row>
<row>
<entry/>
<entry>Fill Factor</entry>
<entry>27%, 33%(without sampler)</entry>
</row>
<row>
<entry/>
<entry>Frame Rate</entry>
<entry>up to 15 Hz</entry>
</row>
<row>
<entry/>
<entry>Dark Current</entry>
<entry>0.56 nA/cm<sup>2</sup></entry>
</row>
<row>
<entry/>
<entry>Sensitivity</entry>
<entry>13.3 V/e<sup>&#x2212;</sup></entry>
</row>
<row>
<entry/>
<entry>Responsivity</entry>
<entry>0.38 A/W</entry>
</row>
<row>
<entry/>
<entry>Dynamic Range</entry>
<entry>95.3 dB</entry>
</row>
<row>
<entry/>
<entry>Maximal SNR</entry>
<entry>74.5 dB</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="offset" colwidth="21pt" align="left"/>
<colspec colname="1" colwidth="63pt" align="left"/>
<colspec colname="2" colwidth="70pt" align="center"/>
<colspec colname="3" colwidth="63pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry/>
<entry>Before cal.</entry>
<entry>After cal.</entry>
</row>
<row>
<entry/>
<entry>Linearity</entry>
<entry>&#x2212;36.4 dB</entry>
<entry>&#x2212;75.6 dB</entry>
</row>
<row>
<entry/>
<entry>FPN</entry>
<entry>5.1%</entry>
<entry>1.0%</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="21pt" align="left"/>
<colspec colname="1" colwidth="63pt" align="left"/>
<colspec colname="2" colwidth="133pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Power Consumption</entry>
<entry>316 &#x3bc;W @ 15 Hz</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0138" num="0137">The measured power only includes the analog and digital power of the imaging sensor. The imaging sensor requires a digital back-end for calibration, which will burn more digital power. This extra digital power is not important for imaging systems with static power supply. The WDR linear imaging sensor can also be used in power-limited implantable bio-medical sensors, such as capsule endoscopy. In these applications, only the imaging sensor is implanted. The raw image data is transmitted to an external receiver through a wireless link. The digital calibration back-end is included in the receiver. The external receiver is usually not sensitive to the extra digital power, while the implanted capsule's data transmission power is considerably reduced due to lower data rate from the imaging sensor with the activity detection feature.</p>
<p id="p-0139" num="0138">The design of a new activity-triggered wide dynamic range highly linear CMOS imaging sensor is introduced. The image sensor has three operation modes including difference mode, wide dynamic range (WDR) mode, and calibration mode. The imaging sensor normally runs in the difference mode. It switches to capture WDR images if the activity in the scene is intense.</p>
<p id="p-0140" num="0139">The co-existence of the two modes is enabled by the new pixel design. A low charge injection current sampler is included in the pixel for the difference mode. A partial quantization scheme is developed to linearly expand the DR of the imaging sensor with an in-pixel comparator. The nonlinear potential well size is compensated by a digital calibration scheme. The decoder cost of the pixel-level calibration scheme is low. A new out-of-pixel counter scheme is designed to separate the digital circuits from the analog pixel.</p>
<p id="p-0141" num="0140">One embodiment of the CMOS image sensor includes a 32&#xd7;32 pixel array manufactured in a 0.35 &#x3bc;m CMOS process. The pixel in the image sensor has a high fill factor of 27%. Without the current sampler, the fill factor is 33%. The fabricated imaging sensor capture images up to 15 Hz with 95.3 dB dynamic range. After the digital calibration, the pixel distortion is as low as &#x2212;75.6 dB over the whole dynamic range. The fixed-pattern noise of the designed imaging sensor is dominated by the photo-diode variation. The maximum SNR of the fabricated imaging sensor is 74.5 dB. The new CMOS imaging sensor design with its wide dynamic range and high linearity can be used in high-performance scientific and bio-medical imaging applications.</p>
<p id="p-0142" num="0141">All references, including publications, patent applications, and patents, cited herein are hereby incorporated by reference to the same extent as if each reference were individually and specifically indicated to be incorporated by reference and were set forth in its entirety herein.</p>
<p id="p-0143" num="0142">The use of the terms &#x201c;a&#x201d; and &#x201c;an&#x201d; and &#x201c;the&#x201d; and similar referents in the context of describing the invention (especially in the context of the following claims) are to be construed to cover both the singular and the plural, unless otherwise indicated herein or clearly contradicted by context. The terms &#x201c;comprising,&#x201d; &#x201c;having,&#x201d; &#x201c;including,&#x201d; and &#x201c;containing&#x201d; are to be construed as open-ended terms (i.e., meaning &#x201c;including, but not limited to,&#x201d;) unless otherwise noted. Recitation of ranges of values herein are merely intended to serve as a shorthand method of referring individually to each separate value falling within the range, unless otherwise indicated herein, and each separate value is incorporated into the specification as if it were individually recited herein. All methods described herein can be performed in any suitable order unless otherwise indicated herein or otherwise clearly contradicted by context. The use of any and all examples, or exemplary language (e.g., &#x201c;such as&#x201d;) provided herein, is intended merely to better illuminate the invention and does not pose a limitation on the scope of the invention unless otherwise claimed. No language in the specification should be construed as indicating any non-claimed element as essential to the practice of the invention.</p>
<p id="p-0144" num="0143">Preferred embodiments of this invention are described herein, including the best mode known to the inventors for carrying out the invention. Variations of those preferred embodiments may become apparent to those of ordinary skill in the art upon reading the foregoing description. The inventors expect skilled artisans to employ such variations as appropriate, and the inventors intend for the invention to be practiced otherwise than as specifically described herein. Accordingly, this invention includes all modifications and equivalents of the subject matter recited in the claims appended hereto as permitted by applicable law. Moreover, any combination of the above-described elements in all possible variations thereof is encompassed by the invention unless otherwise indicated herein or otherwise clearly contradicted by context.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08625012-20140107-M00001.NB">
<img id="EMI-M00001" he="6.35mm" wi="76.20mm" file="US08625012-20140107-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08625012-20140107-M00002.NB">
<img id="EMI-M00002" he="6.69mm" wi="76.20mm" file="US08625012-20140107-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08625012-20140107-M00003.NB">
<img id="EMI-M00003" he="10.58mm" wi="76.20mm" file="US08625012-20140107-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US08625012-20140107-M00004.NB">
<img id="EMI-M00004" he="7.03mm" wi="76.20mm" file="US08625012-20140107-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US08625012-20140107-M00005.NB">
<img id="EMI-M00005" he="7.03mm" wi="76.20mm" file="US08625012-20140107-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US08625012-20140107-M00006.NB">
<img id="EMI-M00006" he="6.69mm" wi="76.20mm" file="US08625012-20140107-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US08625012-20140107-M00007.NB">
<img id="EMI-M00007" he="7.03mm" wi="76.20mm" file="US08625012-20140107-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US08625012-20140107-M00008.NB">
<img id="EMI-M00008" he="6.69mm" wi="76.20mm" file="US08625012-20140107-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US08625012-20140107-M00009.NB">
<img id="EMI-M00009" he="6.35mm" wi="76.20mm" file="US08625012-20140107-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00010" nb-file="US08625012-20140107-M00010.NB">
<img id="EMI-M00010" he="6.69mm" wi="76.20mm" file="US08625012-20140107-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An imaging apparatus, comprising:
<claim-text>a pixel array including a plurality of pixel circuits, wherein the pixel array has different modes, the different modes including a calibration mode and a wide dynamic range, and wherein each pixel circuit includes:
<claim-text>a photodiode;</claim-text>
<claim-text>a comparator for comparing a node voltage with a reference voltage, wherein the photodiode is reset when the node voltage is below the threshold voltage; and</claim-text>
<claim-text>a counter configured to record a number of times that the photodiode is reset;</claim-text>
</claim-text>
<claim-text>a control circuit for generating control signals for switching the pixel array among the different modes;</claim-text>
<claim-text>a calibration parameter decoder for storing calibration data generated during the calibration mode;</claim-text>
<claim-text>a recovery decoder for incorporating the calibration data into a recovered image; and</claim-text>
<claim-text>at least one processor for generating output signals in accordance with pixel signals;</claim-text>
<claim-text>wherein the calibration and wide dynamic range modes are mutually exclusive in time.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The imaging apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the plurality of pixel circuits are arranged in one or more columns, the imaging apparatus further comprising:
<claim-text>one or more processing circuits, each associated with one of the one or more columns for generating column data from the pixel signals collected from the pixel array.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The imaging apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the plurality of pixel circuits are arranged in one or more columns and the pixel signals include digital and analog pixel signals, and each of the one or more columns further comprises:
<claim-text>a digital column bus for reading the digital pixel signals from an associated column;</claim-text>
<claim-text>an analog column bus for reading the analog pixel signals from an associated column; and</claim-text>
<claim-text>a column processing circuit for processing the digital and analog pixel signals, each column processing circuit further comprising:</claim-text>
<claim-text>an analog-to-digital converter for converting the analog pixel signals to digital codes; and</claim-text>
<claim-text>a column counter for counting the digital pixel signals.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The imaging apparatus of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the columns are configured to collect a plurality of sample data sets for each pixel from the pixel array operating in the calibration mode;
<claim-text>wherein the calibration decoder is further configured for generating calibration parameters from the plurality of sample data sets collected during the calibration mode, wherein the calibration parameters includes a set of sampled currents with their accurate well capacity; and</claim-text>
<claim-text>wherein incorporating the calibration data into a recovered image by the recovery decoder includes generating a recovered photo current from the calibration parameters, the digital pixel signals, and the analog pixel signals during the wide dynamic range mode.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The imaging apparatus of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein m is indicative of an integer and the column counter comprises:
<claim-text>an m-bit cell array for storing a self-reset number of each pixel;</claim-text>
<claim-text>an m-bit adder for summing the digital pixel signals and output values from the m-bit cell array;</claim-text>
<claim-text>an m-bit register for latching the summed value from the m-bit adder at a falling edge of a counter clock;</claim-text>
<claim-text>m inverters coupled to the m-bit register;</claim-text>
<claim-text>a first BIT bus coupled to a terminal of every cell of the m-bit cell array, including m bit lines;</claim-text>
<claim-text>a second BIT bus coupled to another terminal of every cell of the m-bit cell array including m bit lines;</claim-text>
<claim-text>a number of m identical switches coupled between said register and said BIT bus by control of a column write signal;</claim-text>
<claim-text>m identical switches coupled between the inverters and the second BIT bus and controlled by a column write signal; and</claim-text>
<claim-text>m identical switches coupled between the first and second BIT buses and controlled by an equalization signal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The imaging apparatus of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the m-bit cell array comprises m identical cells, and each cell comprises:
<claim-text>first and second cross-coupled inverters forming first and second internal nodes respectively;</claim-text>
<claim-text>a first cell switch coupled between the first internal node and a bit line in the first BIT bus and controlled by an SRAM signal; and</claim-text>
<claim-text>a second cell switch coupled between the second internal node and a bit line in the second BIT bus and controlled by the SRAM signal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The imaging apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the calibration parameter decoder is further configured for generating calibration parameters in the calibration mode; and
<claim-text>wherein incorporating the calibration data into a recovered image by the recovery decoder includes receiving raw quantized data and the calibration parameters for calculating accurate digitized photocurrent in accordance with an interpolation method in the wide dynamic range mode.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The imaging apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the imaging apparatus is configured to generate self-resets in the wide dynamic range mode so as to expand the dynamic range of the imaging apparatus.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. An imaging apparatus comprising:
<claim-text>pixel array including a plurality of pixel circuits, wherein the pixel array has different modes the different modes including a calibration mode and a wide dynamic range, and wherein each pixel circuit includes:
<claim-text>a photodiode</claim-text>
<claim-text>a comparator for comparing a node voltage with a reference voltage, wherein the photodiode is reset when the node voltage is below the threshold voltage; and</claim-text>
<claim-text>a counter configured to record a number of times that the photodiode is reset;</claim-text>
</claim-text>
<claim-text>a control circuit for generating control signals for switching the pixel array among the different modes;</claim-text>
<claim-text>a calibration parameter decoder configured to measure and calculate well capacities for calibration currents during calibration;</claim-text>
<claim-text>a recovery decoder configured to calculate the well capacity for a photocurrent from interpolation in the wide dynamic range mode; and</claim-text>
<claim-text>at least one processor for generating output signals in accordance with pixel signals;</claim-text>
<claim-text>wherein the calibration and wide dynamic range modes are mutually exclusive in time and wherein the imaging apparatus is configured to generate self-resets in the wide dynamic range mode so as to expand the dynamic range of the imaging apparatus.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. An imaging apparatus, comprising:
<claim-text>a pixel array including a plurality of pixel circuits, wherein the plurality of pixel circuits are arranged in one or more columns wherein the pixel array has different modes the different modes including a calibration mode and a wide dynamic range, and wherein each pixel circuit includes:
<claim-text>a photodiode;</claim-text>
<claim-text>a comparator for comparing a node voltage with a reference voltage, wherein the photodiode is reset when the node voltage is below the threshold voltage;</claim-text>
<claim-text>a counter configured to record a number of times that the photodiode is reset and</claim-text>
<claim-text>two cascode transistors configured to separate a column bus capacitance from an internal integration capacitance of the pixel circuit;</claim-text>
</claim-text>
<claim-text>one or more processing circuits, each associated with one of the one or more columns for generating column data from the pixel signals collected from the pixel array;</claim-text>
<claim-text>a control circuit for generating control signals for switching the pixel array among the different modes; and</claim-text>
<claim-text>at least one processor for generating output signals in accordance with pixel signals;</claim-text>
<claim-text>wherein the calibration and wide dynamic range modes are mutually exclusive in time.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
