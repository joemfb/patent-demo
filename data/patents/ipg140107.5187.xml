<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08626286-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08626286</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13282440</doc-number>
<date>20111026</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2007-337193</doc-number>
<date>20071227</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>107</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>N</subclass>
<main-group>1</main-group>
<subgroup>18</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>N</subclass>
<main-group>1</main-group>
<subgroup>39</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>5</main-group>
<subgroup>0428</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classifications-cpc>
<main-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>A</section>
<class>61</class>
<subclass>N</subclass>
<main-group>1</main-group>
<subgroup>3925</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
</main-cpc>
<further-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>5</main-group>
<subgroup>0428</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>Y</section>
<class>10</class>
<subclass>S</subclass>
<main-group>128</main-group>
<subgroup>901</subgroup>
<symbol-position>L</symbol-position>
<classification-value>A</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
</further-cpc>
</classifications-cpc>
<classification-national>
<country>US</country>
<main-classification>607  6</main-classification>
<further-classification>128901</further-classification>
</classification-national>
<invention-title id="d2e71">Analyzing waves of electrocardiogram during CPR using fourier series and optimization strategies</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6287328</doc-number>
<kind>B1</kind>
<name>Snyder et al.</name>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600509</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7171269</doc-number>
<kind>B1</kind>
<name>Addison et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>8190255</doc-number>
<kind>B2</kind>
<name>Yamaguchi et al.</name>
<date>20120500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>607  6</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2001/0056245</doc-number>
<kind>A1</kind>
<name>Mylnash et al.</name>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2004/0059237</doc-number>
<kind>A1</kind>
<name>Narayan et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2005/0101889</doc-number>
<kind>A1</kind>
<name>Freeman et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>601 41</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2005/0256415</doc-number>
<kind>A1</kind>
<name>Tan et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2006/0025825</doc-number>
<kind>A1</kind>
<name>Bowers</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>607  5</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2006/0149157</doc-number>
<kind>A1</kind>
<name>Weil et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600518</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>EP</country>
<doc-number>1 769 737</doc-number>
<date>20070400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>JP</country>
<doc-number>2007-020878</doc-number>
<date>20070200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>JP</country>
<doc-number>2007-117481</doc-number>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>WO</country>
<doc-number>WO 01/82099</doc-number>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>WO</country>
<doc-number>WO 2006/016289</doc-number>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00015">
<othercit>Berger, Ronald D., et al. (&#x201c;Rhythm discrimination during uninterrupted CPR using motion artifact reduction system&#x201d; Resuscitation. 75.1 (2007); 145-152).</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00016">
<othercit>Rheinberger, Klaus, et. al. (&#x201c;Removal of CPR Artifacts From Ventricular Fibrillation ECG by Adaptive Regression on Lagged Reference Signals&#x201d; IEEE Transactions on Biomedical Engineering. 55.1 (2008); 130-137).</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00017">
<othercit>Search Report in European Patent Application No. 0802257.3-1265, mailed Apr. 6, 2009.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>11</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>607  4-  7</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>128901</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600508-510</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600513</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600515-519</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600521</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600523</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>601 41</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>14</number-of-drawing-sheets>
<number-of-figures>18</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>12342178</doc-number>
<date>20081223</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>8190255</doc-number>
</document-id>
</parent-grant-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13282440</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120041327</doc-number>
<kind>A1</kind>
<date>20120216</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Yamaguchi</last-name>
<first-name>Yoshihiro</first-name>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Oya</last-name>
<first-name>Hidetoshi</first-name>
<address>
<city>Kawasaki</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Yamaguchi</last-name>
<first-name>Yoshihiro</first-name>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Oya</last-name>
<first-name>Hidetoshi</first-name>
<address>
<city>Kawasaki</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Brundidge &#x26; Stanger, P.C.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>CAE Solutions Corporation</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Layno</last-name>
<first-name>Carl H</first-name>
<department>3766</department>
</primary-examiner>
<assistant-examiner>
<last-name>Anthony</last-name>
<first-name>Jessica</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Electrocardiogram wave data in which a component of cardiac massage is removed from the electrocardiogram wave data is generated, so that the electrocardiogram wave at the time of cardiopulmonary resuscitation is identified. An electrocardiogram wave processing system of obtaining and processing the electrocardiogram wave data includes a wave identification unit that identifies an electrocardiogram wave from the obtained electrocardiogram wave data, a feature selection unit that selects a feature pattern including a feature when a cardiac massage has been performed with respect to the electrocardiogram wave data identified by the wave identification unit, a generation unit that generates a component of the cardiac massage using the feature pattern selected by the feature selection unit, and a removal unit that removes, from the obtained electrocardiogram wave data, the component of the cardiac massage generated by the generation unit.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="170.86mm" wi="208.96mm" file="US08626286-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="220.56mm" wi="181.69mm" orientation="landscape" file="US08626286-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="186.27mm" wi="192.02mm" file="US08626286-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="254.93mm" wi="187.11mm" file="US08626286-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="245.19mm" wi="120.31mm" orientation="landscape" file="US08626286-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="222.42mm" wi="168.66mm" orientation="landscape" file="US08626286-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="222.08mm" wi="165.61mm" orientation="landscape" file="US08626286-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="226.65mm" wi="170.94mm" orientation="landscape" file="US08626286-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="227.08mm" wi="167.81mm" orientation="landscape" file="US08626286-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="228.94mm" wi="171.96mm" orientation="landscape" file="US08626286-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="224.11mm" wi="168.49mm" orientation="landscape" file="US08626286-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="227.08mm" wi="178.14mm" orientation="landscape" file="US08626286-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="224.03mm" wi="172.47mm" orientation="landscape" file="US08626286-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="218.27mm" wi="169.59mm" orientation="landscape" file="US08626286-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="249.00mm" wi="170.35mm" orientation="landscape" file="US08626286-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<p id="p-0002" num="0001">This application is a continuation application of U.S. application Ser. No. 12/342,178 filed on Dec. 23, 2008, now U.S. Pat. No. 8,190,255, the entirety of which is incorporated herein by reference.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">1. Priority Application</p>
<p id="p-0004" num="0003">This application claims the benefit of priority from Japanese Patent 2007-337193, filed Dec. 27, 2007, the disclosure of which also is entirely incorporated herein by reference.</p>
<p id="p-0005" num="0004">2. Field of the Invention</p>
<p id="p-0006" num="0005">The present invention relates to a system and a method for analyzing waves of electrocardiogram, and in particular, to a system and a method for analyzing waves of electrocardiogram at the time of cardiopulmonary resuscitation, and a program executed on a computer for analyzing the waves of electrocardiogram.</p>
<p id="p-0007" num="0006">3. Description of the Related Art</p>
<p id="p-0008" num="0007">In most cases, sudden cardiac arrest is caused by severe arrhythmia such as Ventricular Fibrillation (VF), and the use of defibrillation (electrical defibrillation) as soon as possible is effective against the severe arrhythmia. In addition, according to the American Heart Association (AHA)'s guideline providing a standard guideline of the cardiopulmonary resuscitation law, a continuous cardiac massage is an important basic concept.</p>
<p id="p-0009" num="0008">In order to determine whether the electrocardiogram waves need to be subjected to defibrillation, all cardiopulmonary resuscitations must be stopped. However, this stop contradicts the continuous cardiac massage. In addition, stopping the cardiopulmonary resuscitations for the moment causes a critical adverse effect on a recovery of a patient. Further, stopping the cardiopulmonary resuscitation for 10 seconds or more damages the brain, which also becomes the cause of sequela.</p>
<p id="p-0010" num="0009">Several techniques are proposed for analyzing electrocardiogram wave data. For example, according to JP-A-2007-117481, a monitor system is disclosed for measuring an electrocardiogram and fluctuation of a baseline of the electrocardiogram to monitor both of the heart condition and the psychological disturbance.</p>
<p id="p-0011" num="0010">In addition, according to JP-A-2007-20878, a noise elimination apparatus is proposed, which employs a morphology filter to eliminate the baseline fluctuation noise of which the frequency component included in the electrocardiogram wave signal is 0.5 Hz or less.</p>
<p id="p-0012" num="0011">When the electrocardiogram waves are identified and processed at the time of cardiopulmonary resuscitation, a system is desperately required which can recognize waves to which the defibrillation must be applied in a safe and secure way while taking various resuscitation measures including a continuous cardiac massage. The implementation of the system is expected to bring a significant effect on resuscitation rate enhancement of the heart arrest patient.</p>
<p id="p-0013" num="0012">In addition, neither JP-A-2007-117481 nor JP-A-2007-20878 mentioned above discloses or suggests how to identify the electrocardiogram waves at the time of cardiopulmonary resuscitation. Further, a technique of analyzing the electrocardiogram waves obtained during the cardiac massage and determining whether the defibrillation must be applied to the electrocardiogram waves is not disclosed at all.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0014" num="0013">An object of the invention is therefore to provide a system, a method, and a program for analyzing waves of electrocardiogram at the time of cardiopulmonary resuscitation.</p>
<p id="p-0015" num="0014">Another object of the invention is to provide a system, a method, and a program, which can generate electrocardiogram waves in which components generated by a cardiac massage are removed from electrocardiogram wave data obtained during a continuous cardiac massage and can be used for identifying the electrocardiogram waves.</p>
<p id="p-0016" num="0015">Another object of the invention is to perform analysis using a frequency component of obtained electrocardiogram wave data and to determine whether defibrillation must be applied to the electrocardiogram wave data based on the analysis result.</p>
<p id="p-0017" num="0016">The present invention can identify electrocardiogram wave data obtained during a continuous cardiac massage, select a feature pattern from the identified electrocardiogram wave data, generate a component of the cardiac massage from the identified feature pattern, and remove the generated cardiac massage component from the original electrocardiogram wave data.</p>
<p id="p-0018" num="0017">According to a first aspect of the invention, there is provided a system of analyzing electrocardiogram wave data obtained from a subject, the system including: a wave identification unit that identifies an electrocardiogram wave from the obtained electrocardiogram wave data; a feature selection unit that selects a feature pattern including a feature when a cardiac massage has been performed with respect to the electrocardiogram wave data identified by the wave identification unit; a generation unit that generates a component of the cardiac massage using the feature pattern selected by the feature selection unit; and a removal unit that removes, from the obtained electrocardiogram wave data, the component of the cardiac massage generated by the generation unit.</p>
<p id="p-0019" num="0018">Preferably, when a Fourier series expansion is expressed by the expression 3:</p>
<p id="p-0020" num="0019">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>y</mi>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mi>t</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msub>
      <mi>a</mi>
      <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
      <munderover>
        <mo>&#x2211;</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
        </mrow>
        <mi>&#x221e;</mi>
      </munderover>
      <mo>&#x2062;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <msub>
              <mi>a</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>cos</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
            <msub>
              <mi>b</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>sin</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
and an approximate wave of the Fourier series expansion is expressed by the expression 4:
</p>
<p id="p-0021" num="0020">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <mrow>
    <mover>
      <mi>y</mi>
      <mo>^</mo>
    </mover>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mi>t</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msub>
      <mi>&#x3b1;</mi>
      <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
      <munderover>
        <mo>&#x2211;</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
        </mrow>
        <mi>M</mi>
      </munderover>
      <mo>&#x2062;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <msub>
              <mi>&#x3b1;</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>cos</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
            <msub>
              <mi>&#x3b2;</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>sin</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
assuming that the obtained electrocardiogram wave data is a wave in which a fundamental wave component and a harmonic wave component overlap each other, errors of &#x177;(t) and y(t) are made to be as small as possible by adjusting &#x3b1;=(&#x3b1;<sub>0</sub>, &#x3b1;<sub>1</sub>, &#x3b1;<sub>2</sub>, &#x3b1;<sub>3</sub>, . . . ) and &#x3b2;=(&#x3b2;<sub>1</sub>, &#x3b2;<sub>2</sub>, &#x3b2;<sub>2</sub>, . . . ), thereby searching &#x3b1; and &#x3b2;.
</p>
<p id="p-0022" num="0021">In addition, preferably, the system further includes a storage unit that store plural different feature patterns (referred to as registration feature patterns) in advance, wherein the feature selection unit refers to the registration feature patterns stored in the storage unit to select the registration feature pattern that is the most similar to the feature pattern included in the electrocardiogram wave data identified by the wave identification unit.</p>
<p id="p-0023" num="0022">In addition, preferably, the electrocardiogram wave data includes a wave of which the feature when the cardiac massage has been performed is represented as an amplitude component, the storage unit stores the registration feature patterns configured using a normalization distribution and thresholds that have been statistically collected, including, as the amplitude component, the feature when the cardiac massage has been performed, and the feature selection unit extracts the amplitude component from the electrocardiogram wave data identified by the wave identification unit, and also cross-checks the extracted amplitude component with amplitude components of the registration feature patterns stored in the storage unit to select the registration feature pattern of which the amplitude component is the most similar to amplitude component of the extracted amplitude component.</p>
<p id="p-0024" num="0023">In addition, preferably, the feature selection unit mainly uses a wave having an amplitude component ranging from 1.5 Hz to 1.9 Hz.</p>
<p id="p-0025" num="0024">In addition, preferably, the generation unit multiplies a normalized value of the selected feature pattern by a weighted value with respect to the electrocardiogram wave data identified by the wave identification unit.</p>
<p id="p-0026" num="0025">In addition, preferably, the removal unit mainly removes, from the electrocardiogram wave data, the component of the cardiac massage of which the electrocardiogram wave data has the amplitude component ranging from 1.5 Hz to 1.9 Hz.</p>
<p id="p-0027" num="0026">In addition, preferably, the system further includes a display that displays an electrocardiogram wave (a second electrocardiogram wave) output from the removal unit of which the component of the cardiac massage is removed.</p>
<p id="p-0028" num="0027">In addition, preferably, the system further includes a processing unit that executes a computer program, wherein the computer program for implementing each function of the wave identification unit, the feature selection unit, the generation unit, and the removal unit is executed on the processing unit.</p>
<p id="p-0029" num="0028">In addition, preferably, the system further includes determination means for determining whether defibrillation needs to be applied to the subject by cross-checking the electrocardiogram wave output from the removal unit with predetermined wave information already prepared in the storage unit, and alarm means for raising an alarm by means of voice or display upon determination of the determination unit that the defibrillation needs to be applied to the subject.</p>
<p id="p-0030" num="0029">According to a second aspect of the invention, there is provided a method of obtaining and analyzing electrocardiogram wave data using a processing apparatus, the method including: identifying electrocardiogram wave data (first electrocardiogram wave data) when a cardiac massage has been performed from the obtained electrocardiogram wave data; selecting a feature pattern from the identified electrocardiogram wave data; generating a component of the cardiac massage from the feature pattern; and removing the generated component from the original electrocardiogram wave data.</p>
<p id="p-0031" num="0030">Preferably, identifying the first electrocardiogram wave includes: when a Fourier series expansion is expressed by the expression 3:</p>
<p id="p-0032" num="0031">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>y</mi>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mi>t</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msub>
      <mi>a</mi>
      <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
      <munderover>
        <mo>&#x2211;</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
        </mrow>
        <mi>&#x221e;</mi>
      </munderover>
      <mo>&#x2062;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <msub>
              <mi>a</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>cos</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
            <msub>
              <mi>b</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>sin</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
and an approximate wave of the Fourier series expansion is expressed by the expression 4:
</p>
<p id="p-0033" num="0032">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mrow>
  <mrow>
    <mover>
      <mi>y</mi>
      <mo>^</mo>
    </mover>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mi>t</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msub>
      <mi>&#x3b1;</mi>
      <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
      <munderover>
        <mo>&#x2211;</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
        </mrow>
        <mi>M</mi>
      </munderover>
      <mo>&#x2062;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <msub>
              <mi>&#x3b1;</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>cos</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
            <msub>
              <mi>&#x3b2;</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>sin</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
assuming that the obtained electrocardiogram wave data is a wave in which a fundamental wave component and a harmonic wave component overlap each other, making errors of &#x177;(t) and y(t) as small as possible by adjusting &#x3b1;=(&#x3b1;<sub>0</sub>, &#x3b1;<sub>1</sub>, &#x3b1;<sub>2</sub>, &#x3b1;<sub>3</sub>, . . . ) and &#x3b2;=&#x3b2;<sub>1</sub>, &#x3b2;<sub>2</sub>, &#x3b2;<sub>2</sub>, . . . ); and searching &#x3b1; and &#x3b2; to identify and extract the electrocardiogram wave data to be analyzed.
</p>
<p id="p-0034" num="0033">In addition, preferably, the method further includes storing plural feature patterns (referred to as registration feature patterns) in a storage unit in advance, and sequentially cross-checking the first electrocardiogram wave data with the registration feature patterns to determine the most similar registration feature pattern to the first electrocardiogram wave data.</p>
<p id="p-0035" num="0034">In addition, preferably, the method further includes displaying on a display an electrocardiogram wave (second electrocardiogram wave) of which the component of the cardiac massage is removed.</p>
<p id="p-0036" num="0035">According to a third aspect of the invention, there is provided a method of obtaining and analyzing electrocardiogram wave data, the method including: performing analog/digital conversion on an electrocardiogram wave obtained from a subject that is continuously subjected to a cardiac massage to obtain electrocardiogram wave data; identifying the electrocardiogram wave from the obtained electrocardiogram wave data; generating a component of the cardiac massage using a feature pattern including a feature when the cardiac massage has been performed with respect to the identified electrocardiogram wave data; and removing the generated component of the cardiac massage from the electrocardiogram wave data.</p>
<p id="p-0037" num="0036">According to a fourth aspect of the invention, there is provided a computer-executable program for analyzing obtained electrocardiogram wave data, the program including instructions for implementing: means for identifying an electrocardiogram wave from the obtained electrocardiogram wave data; means for selecting a feature pattern including a feature when a cardiac massage has been performed with respect to the electrocardiogram wave data identified by the identification means; means for generating a component of the cardiac massage using the feature pattern selected by the means; and means for removing the component of the cardiac massage generated in the generation means, from the obtained electrocardiogram wave data.</p>
<p id="p-0038" num="0037">According to the present invention, electrocardiogram wave data obtained by cardiac massage can be processed such that the component of the cardiac massage is removed while the cardiac massage is continuously performed. This therefore allows the electrocardiogram wave to which defibrillation must be applied to be identified at the time of cardiopulmonary resuscitation.</p>
<p id="p-0039" num="0038">In addition, the electrocardiogram wave data can be continuously taken and analyzed without stopping the cardiac massage, so that the damage of the subject accompanying the stopping of the resuscitation can be reduced.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram illustrating the configuration of an electrocardiogram wave processing system according to an embodiment of the invention;</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 2</figref> is a diagram illustrating constitutional blocks of an electrocardiogram wave processing system according to an embodiment of the invention;</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 3</figref> is a flow chart illustrating processing operations of an electrocardiogram wave processing system according to an embodiment of the invention;</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIGS. 4A and 4B</figref> are diagrams illustrating the effect of an electrocardiogram wave processing system according to an embodiment of the invention;</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 5</figref> is a diagram illustrating electrocardiogram waves according to an embodiment of the invention;</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 6</figref> is a diagram illustrating electrocardiogram waves according to another embodiment of the invention;</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 7</figref> is a diagram illustrating electrocardiogram waves according to another embodiment of the invention;</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 8</figref> is a diagram illustrating electrocardiogram waves according to another embodiment of the invention;</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 9</figref> is a diagram illustrating electrocardiogram waves according to another embodiment of the invention;</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 10</figref> is a diagram illustrating electrocardiogram waves according to another embodiment of the invention;</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 11</figref> is a diagram illustrating electrocardiogram waves according to another embodiment of the invention;</p>
<p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. 12</figref> is a diagram illustrating electrocardiogram waves according to another embodiment of the invention;</p>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 13</figref> is a diagram illustrating electrocardiogram waves according to another embodiment of the invention; and</p>
<p id="p-0053" num="0052"><figref idref="DRAWINGS">FIGS. 14A to 14D</figref> are diagrams illustrating electrocardiogram waves according to another embodiment of the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0054" num="0053">The present inventors first collected an enormous amount of electrocardiogram wave data, and analyzed what processing was performed on the recorded electrocardiogram wave data and what features the recorded electrocardiogram wave data have. To perform the analysis, a frequency domain analysis and a time domain analysis were applied. And it was found that the electrocardiogram wave data during resuscitation was of a wave in which features of the electrocardiogram wave of the cardiac massage and the VF wave overlapped each other and these waves might be separated from each other. In addition, with respect to the wave recognition, it was found that the time domain analysis could be effectively used in combination with the frequency domain analysis, the electrocardiogram wave analysis, and the similarity determination of the analyzed results.</p>
<p id="p-0055" num="0054">Based on the knowledge mentioned above, electrocardiogram wave data was collected during the cardiac massage, and an algorithm for removing a component of the cardiac massage from the electrocardiogram wave data was developed, which were then applied to an electrocardiogram wave processing system.</p>
<p id="p-0056" num="0055">Hereinafter, an embodiment of the present invention will be described in detail with reference to accompanying drawings.</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 1</figref> illustrates the configuration of an electrocardiogram wave processing system according to an embodiment of the invention.</p>
<p id="p-0058" num="0057">The electrocardiogram wave system includes an analog/digital (A/D) converter <b>11</b> that converts an electrocardiogram wave sensed by a sensor attached to the chest of a subject, a storage unit <b>12</b> such as a flash memory or a hard disk that stores the electrocardiogram wave data output from the A/D converter <b>11</b>, a processing unit <b>1</b> that processes the electrocardiogram wave data read out from the storage unit <b>12</b>, a display <b>13</b> that displays the electrocardiogram wave data C processed by the processing unit <b>1</b> as the electrocardiogram wave, and a storage unit <b>14</b> such as a hard disk that stores the processed electrocardiogram wave data C. In addition, the storage unit <b>14</b> may be the same as the storage unit <b>12</b> such as a hard disk. In addition, although not shown in the drawing, a filter of removing a high frequency noise may be disposed at a front end of the A/D converter <b>11</b> where the electrocardiogram wave is input.</p>
<p id="p-0059" num="0058">When a cardiac massage is performed, the component of the performed cardiac massage is overlapped and included in the electrocardiogram wave S and the electrocardiogram wave data A. The processing unit <b>1</b> performs specific processing for removing the component of the cardiac massage from the electrocardiogram wave data A in accordance with the present invention.</p>
<p id="p-0060" num="0059">The processing unit <b>1</b> has a cardiac massage estimating portion <b>10</b> that estimates the component of the cardiac massage of the electrocardiogram wave data A, and a subtracting portion <b>105</b> that removes the cardiac massage component B from the electrocardiogram wave data A.</p>
<p id="p-0061" num="0060">The cardiac massage component estimating portion <b>10</b> has a wave identification unit <b>101</b>, a selector <b>103</b>, and a cardiac massage component generation unit <b>104</b>. In addition, plural different feature patterns <b>102</b> are stored in the storage unit <b>12</b> in advance. The feature patterns <b>102</b> are n patterns configured to include distinctive patterns reflected on the electrocardiogram wave data using a normalization distribution, adjustable parameters, and statistically collected thresholds when the heat massage was performed.</p>
<p id="p-0062" num="0061">The wave identification unit <b>101</b> analyzes what components compose the input electrocardiogram wave data A, and generates the identified wave. The selector <b>103</b> selects the feature pattern k that is the closest to the corresponding electrocardiogram wave data A identified by the wave identification unit <b>101</b> in combination with the feature pattern <b>102</b>.</p>
<p id="p-0063" num="0062">The cardiac massage component generation unit <b>104</b> generates the component B of the cardiac massage included in the selected feature pattern k. The subtractor <b>105</b> subtracts the cardiac massage component B from the input electrocardiogram wave data A to output processed data C (=A&#x2212;B) that does not include the cardiac massage component.</p>
<p id="p-0064" num="0063">With respect to examples of the electrocardiogram waves,</p>
<p id="p-0065" num="0064"><figref idref="DRAWINGS">FIG. 5</figref> illustrates an example of the electrocardiogram wave data A input to the wave identification unit <b>101</b>, <figref idref="DRAWINGS">FIG. 10</figref> illustrates an example of the feature pattern, <figref idref="DRAWINGS">FIG. 11</figref> illustrates an example of the cardiac massage component B, <figref idref="DRAWINGS">FIGS. 12 and 14B</figref> illustrate the results that the cardiac massage component B was removed from the electrocardiogram wave data A. In addition, <figref idref="DRAWINGS">FIGS. 5</figref>, <b>12</b>, and so forth illustrate the electrocardiogram wave data over time (a horizontal axis denotes a time axis and a vertical axis denotes an amplitude). In addition, <figref idref="DRAWINGS">FIG. 13</figref> illustrates the frequency characteristic (relationship between the amplitude (vertical axis) and the frequency (horizontal axis)).</p>
<p id="p-0066" num="0065">The time taken for obtaining the electrocardiogram wave data is 4 to 5 seconds, and the sampling rate is 1 kHz. Typically, the cardiac massage is performed at a rate of about 100 times/min, so that the wave B resulting from the cardiac massage is shown in a frequency range of about 1.5 to about 1.9 Hz.</p>
<p id="h-0005" num="0000">[Explanation of Electrocardiogram Wave Recognition Algorithm]</p>
<p id="p-0067" num="0066">At the moment of development on the algorithm of identifying the electrocardiogram wave, the present inventors have thought that identification of the electrocardiogram wave can be accomplished by mainly implementing processing of setting elements of the electrocardiogram wave to be identified, selecting the feature pattern, estimating the cardiac massage component, and removing the cardiac massage component from the electrocardiogram wave data. Therefore, the algorithms for implementing the respective processing will be described.</p>
<p id="p-0068" num="0067">(1) Identification Algorithm of Electrocardiogram Wave</p>
<p id="p-0069" num="0068">(1.1) Basic Knowledge of Identifying Electrocardiogram Wave</p>
<p id="p-0070" num="0069">It is thought that the electrocardiogram wave is a periodical signal, which can be described as a collection of plural frequency components. Accordingly, the signal y(t) having the period T can be expanded by Fourier series as the expression 1 below:</p>
<p id="p-0071" num="0070">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <mi>y</mi>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>t</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>=</mo>
              <mi/>
              <mo>&#x2062;</mo>
              <mrow>
                <msub>
                  <mi>a</mi>
                  <mn>0</mn>
                </msub>
                <mo>+</mo>
                <mrow>
                  <munderover>
                    <mo>&#x2211;</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>=</mo>
                      <mn>1</mn>
                    </mrow>
                    <mi>&#x221e;</mi>
                  </munderover>
                  <mo>&#x2062;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mrow>
                        <msub>
                          <mi>a</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>&#x2062;</mo>
                        <mi>cos</mi>
                        <mo>&#x2062;</mo>
                        <mfrac>
                          <mrow>
                            <mn>2</mn>
                            <mo>&#x2062;</mo>
                            <mi>&#x3c0;</mi>
                            <mo>&#x2062;</mo>
                            <mstyle>
                              <mspace width="0.3em" height="0.3ex"/>
                            </mstyle>
                            <mo>&#x2062;</mo>
                            <mi>it</mi>
                          </mrow>
                          <mi>T</mi>
                        </mfrac>
                      </mrow>
                      <mo>+</mo>
                      <mrow>
                        <msub>
                          <mi>b</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>&#x2062;</mo>
                        <mi>sin</mi>
                        <mo>&#x2062;</mo>
                        <mfrac>
                          <mrow>
                            <mn>2</mn>
                            <mo>&#x2062;</mo>
                            <mi>&#x3c0;</mi>
                            <mo>&#x2062;</mo>
                            <mstyle>
                              <mspace width="0.3em" height="0.3ex"/>
                            </mstyle>
                            <mo>&#x2062;</mo>
                            <mi>it</mi>
                          </mrow>
                          <mi>T</mi>
                        </mfrac>
                      </mrow>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mi/>
              <mo>&#x2062;</mo>
              <mrow>
                <msub>
                  <mi>a</mi>
                  <mn>0</mn>
                </msub>
                <mo>+</mo>
                <mrow>
                  <munderover>
                    <mo>&#x2211;</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>=</mo>
                      <mn>1</mn>
                    </mrow>
                    <mi>&#x221e;</mi>
                  </munderover>
                  <mo>&#x2062;</mo>
                  <mrow>
                    <msub>
                      <mi>A</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>&#x2062;</mo>
                    <mrow>
                      <mi>cos</mi>
                      <mo>&#x2061;</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mfrac>
                            <mrow>
                              <mn>2</mn>
                              <mo>&#x2062;</mo>
                              <mi>&#x3c0;</mi>
                              <mo>&#x2062;</mo>
                              <mstyle>
                                <mspace width="0.3em" height="0.3ex"/>
                              </mstyle>
                              <mo>&#x2062;</mo>
                              <mi>it</mi>
                            </mrow>
                            <mi>T</mi>
                          </mfrac>
                          <mo>-</mo>
                          <msub>
                            <mi>&#x3b8;</mi>
                            <mi>i</mi>
                          </msub>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mi>expression</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>1</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0072" num="0071">where Ai and &#x3b8;i(i=1, . . . &#x221e;) denote amplitude and phase represented by the expression 2 below:</p>
<p id="p-0073" num="0072">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>A</mi>
            <mi>i</mi>
          </msub>
          <mo>=</mo>
          <msup>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msubsup>
                  <mi>a</mi>
                  <mi>i</mi>
                  <mn>2</mn>
                </msubsup>
                <mo>+</mo>
                <msubsup>
                  <mi>b</mi>
                  <mi>i</mi>
                  <mn>2</mn>
                </msubsup>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mfrac>
              <mn>1</mn>
              <mn>2</mn>
            </mfrac>
          </msup>
        </mrow>
        <mo>&#x2062;</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <msub>
            <mi>&#x3b8;</mi>
            <mi>i</mi>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>tan</mi>
              <mrow>
                <mo>-</mo>
                <mn>1</mn>
              </mrow>
            </msup>
            <mo>&#x2062;</mo>
            <mfrac>
              <msub>
                <mi>b</mi>
                <mi>i</mi>
              </msub>
              <msub>
                <mi>a</mi>
                <mi>i</mi>
              </msub>
            </mfrac>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>expression</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>2</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0074" num="0073">The electrocardiogram wave data A to be recorded is finite data, but it is not clear that the electrocardiogram wave data is periodical, and it can be assumed that (a) the wave to be analyzed is a periodic signal having the period T and (b) the wave to be analyzed is composed of a fundamental wave (sine wave or cosine wave) having its period as a fundamental frequency and a harmonic wave. Based on this assumption, constitutional elements of the wave can be analyzed using the Fourier series expansion of the expression 1. Its basic understanding is as follows. In addition, the parameters M and T of the expression 4 below denote the order of the harmonic wave component and the fundamental period, respectively.</p>
<p id="p-0075" num="0074">(i) The wave as the subject can be represented by the collection of the fundamental wave component and the harmonic wave component as shown in the expression 3 below:</p>
<p id="p-0076" num="0075">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>y</mi>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mi>t</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <msub>
            <mi>a</mi>
            <mn>0</mn>
          </msub>
          <mo>+</mo>
          <mrow>
            <munderover>
              <mo>&#x2211;</mo>
              <mrow>
                <mi>i</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>&#x221e;</mi>
            </munderover>
            <mo>&#x2062;</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <msub>
                    <mi>a</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>&#x2062;</mo>
                  <mi>cos</mi>
                  <mo>&#x2062;</mo>
                  <mfrac>
                    <mrow>
                      <mn>2</mn>
                      <mo>&#x2062;</mo>
                      <mi>&#x3c0;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>it</mi>
                    </mrow>
                    <mi>T</mi>
                  </mfrac>
                </mrow>
                <mo>+</mo>
                <mrow>
                  <msub>
                    <mi>b</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>&#x2062;</mo>
                  <mi>sin</mi>
                  <mo>&#x2062;</mo>
                  <mfrac>
                    <mrow>
                      <mn>2</mn>
                      <mo>&#x2062;</mo>
                      <mi>&#x3c0;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>it</mi>
                    </mrow>
                    <mi>T</mi>
                  </mfrac>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>expression</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>3</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0077" num="0076">(ii) Similarly, an approximate wave can be represented by the expression 4.</p>
<p id="p-0078" num="0077">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mover>
            <mi>y</mi>
            <mo>^</mo>
          </mover>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mi>t</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <msub>
            <mi>&#x3b1;</mi>
            <mn>0</mn>
          </msub>
          <mo>+</mo>
          <mrow>
            <munderover>
              <mo>&#x2211;</mo>
              <mrow>
                <mi>i</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>M</mi>
            </munderover>
            <mo>&#x2062;</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <msub>
                    <mi>&#x3b1;</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>&#x2062;</mo>
                  <mi>cos</mi>
                  <mo>&#x2062;</mo>
                  <mfrac>
                    <mrow>
                      <mn>2</mn>
                      <mo>&#x2062;</mo>
                      <mi>&#x3c0;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>it</mi>
                    </mrow>
                    <mi>T</mi>
                  </mfrac>
                </mrow>
                <mo>+</mo>
                <mrow>
                  <msub>
                    <mi>&#x3b2;</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>&#x2062;</mo>
                  <mi>sin</mi>
                  <mo>&#x2062;</mo>
                  <mfrac>
                    <mrow>
                      <mn>2</mn>
                      <mo>&#x2062;</mo>
                      <mi>&#x3c0;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>it</mi>
                    </mrow>
                    <mi>T</mi>
                  </mfrac>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>expression</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>4</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0079" num="0078">(iii) When the data length of y(t) is T<sub>L </sub>[sec] and the time interval is &#x394;[sec], N numerical (data length T=N&#xd7;&#x394;[sec]) values are obtained by sampling, which is referred to as y(k)(k=1, 2, . . . N).</p>
<p id="p-0080" num="0079">
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mi>y</mi>
            <mo>&#x2061;</mo>
            <mrow>
              <mo>(</mo>
              <mi>k</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <msub>
              <mi>a</mi>
              <mn>0</mn>
            </msub>
            <mo>+</mo>
            <mrow>
              <munderover>
                <mo>&#x2211;</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                </mrow>
                <mi>&#x221e;</mi>
              </munderover>
              <mo>&#x2062;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>a</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>&#x2062;</mo>
                    <mi>cos</mi>
                    <mo>&#x2062;</mo>
                    <mfrac>
                      <mrow>
                        <mn>2</mn>
                        <mo>&#x2062;</mo>
                        <mi>&#x3c0;</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mi>ik</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mi>&#x394;</mi>
                      </mrow>
                      <mi>T</mi>
                    </mfrac>
                  </mrow>
                  <mo>+</mo>
                  <mrow>
                    <msub>
                      <mi>b</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>&#x2062;</mo>
                    <mi>sin</mi>
                    <mo>&#x2062;</mo>
                    <mfrac>
                      <mrow>
                        <mn>2</mn>
                        <mo>&#x2062;</mo>
                        <mi>&#x3c0;</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mi>ik</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mi>&#x394;</mi>
                      </mrow>
                      <mi>T</mi>
                    </mfrac>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mrow>
              <mi>k</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mo>,</mo>
            <mn>2</mn>
            <mo>,</mo>
            <mrow>
              <mi>&#x2026;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.8em" height="0.8ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mi>N</mi>
            </mrow>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>expression</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>3</mn>
        <mo>&#x2062;</mo>
        <mstyle>
          <mtext>-</mtext>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>1</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0081" num="0080">(iv) &#x177;(t) is the same as y(t), so that N sampled data indicate &#x177;(k) (k=1, 2, . . . N).</p>
<p id="p-0082" num="0081">
<maths id="MATH-US-00010" num="00010">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mover>
              <mi>y</mi>
              <mo>^</mo>
            </mover>
            <mo>&#x2061;</mo>
            <mrow>
              <mo>(</mo>
              <mi>k</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <msub>
              <mi>&#x3b1;</mi>
              <mn>0</mn>
            </msub>
            <mo>+</mo>
            <mrow>
              <munderover>
                <mo>&#x2211;</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                </mrow>
                <mi>M</mi>
              </munderover>
              <mo>&#x2062;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>&#x3b1;</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>&#x2062;</mo>
                    <mi>cos</mi>
                    <mo>&#x2062;</mo>
                    <mfrac>
                      <mrow>
                        <mn>2</mn>
                        <mo>&#x2062;</mo>
                        <mi>&#x3c0;</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mi>ik</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mi>&#x394;</mi>
                      </mrow>
                      <mi>T</mi>
                    </mfrac>
                  </mrow>
                  <mo>+</mo>
                  <mrow>
                    <msub>
                      <mi>&#x3b2;</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>&#x2062;</mo>
                    <mi>sin</mi>
                    <mo>&#x2062;</mo>
                    <mfrac>
                      <mrow>
                        <mn>2</mn>
                        <mo>&#x2062;</mo>
                        <mi>&#x3c0;</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mi>ik</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mi>&#x394;</mi>
                      </mrow>
                      <mi>T</mi>
                    </mfrac>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mrow>
              <mi>k</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mo>,</mo>
            <mn>2</mn>
            <mo>,</mo>
            <mrow>
              <mi>&#x2026;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.8em" height="0.8ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mi>N</mi>
            </mrow>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>expression</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>4</mn>
        <mo>&#x2062;</mo>
        <mstyle>
          <mtext>-</mtext>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>1</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0083" num="0082">By adjusting &#x3b1;=(&#x3b1;<sub>0</sub>, &#x3b1;<sub>1</sub>, &#x3b1;<sub>2</sub>, &#x3b1;<sub>3</sub>, . . . &#x3b1;<sub>M</sub>) and &#x3b2;=(&#x3b2;<sub>1</sub>, &#x3b2;<sub>2</sub>, &#x3b2;<sub>3</sub>, . . . &#x3b2;<sub>M</sub>, errors of &#x177;(k) and y(k) are made as small as possible.</p>
<p id="p-0084" num="0083">In this case, a<sub>0 </sub>and &#x3b1;<sub>0 </sub>denote direct current values (bias), which can be removed in advance by means of filtering. At this time, a becomes &#x3b1;=(&#x3b1;<sub>1</sub>, &#x3b1;<sub>2</sub>, &#x3b1;<sub>3</sub>, . . . ), however the same result can be obtained when &#x3b1;<sub>0</sub>=0 in the following description.</p>
<p id="p-0085" num="0084">(1.2) Optimization for Identifying Electrocardiogram Wave</p>
<p id="p-0086" num="0085">It is thought that errors of &#x177;(k) and y(k) can be made as small as possible by adjusting the parameters &#x3b1;=(&#x3b1;<sub>0</sub>, &#x3b1;<sub>1</sub>, &#x3b1;<sub>2</sub>, &#x3b1;<sub>3</sub>, . . . &#x3b1;<sub>M</sub>) and &#x3b2;=(&#x3b2;<sub>1</sub>, &#x3b2;<sub>2</sub>, &#x3b2;<sub>3</sub>, . . . &#x3b2;<sub>M</sub>) when the wave obtained by the identification is represented by &#x177;(k)(k=1, . . . N). In this case, M and T are design parameters, respectively.</p>
<p id="p-0087" num="0086">Accordingly, it is thought that the objective function as shown in the expression 5 below can be minimized by the expression 6 using the parameters &#x3b1;=(&#x3b1;<sub>0</sub>, &#x3b1;<sub>1</sub>, &#x3b1;<sub>2</sub>, &#x3b1;<sub>3</sub>, . . . &#x3b1;<sub>M</sub>) and &#x3b2;=(&#x3b2;<sub>1</sub>, &#x3b2;<sub>2</sub>, &#x3b2;<sub>3</sub>, . . . &#x3b2;<sub>M</sub>).</p>
<p id="p-0088" num="0087">
<maths id="MATH-US-00011" num="00011">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>v</mi>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>&#x3b1;</mi>
              <mo>,</mo>
              <mi>&#x3b2;</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>&#x2211;</mo>
            <mrow>
              <mi>k</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>N</mi>
          </munderover>
          <mo>&#x2062;</mo>
          <msup>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mi>y</mi>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>k</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>-</mo>
                <mrow>
                  <mover>
                    <mi>y</mi>
                    <mo>^</mo>
                  </mover>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>k</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mn>2</mn>
          </msup>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>expression</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>5</mn>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>Minimize</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mrow>
            <mo>{</mo>
            <mrow>
              <mi>v</mi>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>&#x3b1;</mi>
                  <mo>,</mo>
                  <mi>&#x3b2;</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>}</mo>
          </mrow>
        </mrow>
        <mo>&#x2062;</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <mi>&#x3b1;</mi>
          <mo>,</mo>
          <mi>&#x3b2;</mi>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>expression</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>6</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0089" num="0088">This minimization is equivalent to searching for the parameters &#x3b1;=(&#x3b1;<sub>0</sub>, &#x3b1;<sub>1</sub>, &#x3b1;<sub>2</sub>, &#x3b1;<sub>3</sub>, . . . &#x3b1;<sub>M</sub>) and &#x3b2;=(&#x3b2;<sub>1</sub>, &#x3b2;<sub>2</sub>, &#x3b2;<sub>3</sub>, . . . &#x3b2;<sub>M</sub>) meeting the condition below.</p>
<p id="p-0090" num="0089">
<maths id="MATH-US-00012" num="00012">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mfrac>
            <mrow>
              <mo>&#x2202;</mo>
              <mrow>
                <mi>v</mi>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>&#x3b1;</mi>
                    <mo>,</mo>
                    <mi>&#x3b2;</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
            <mrow>
              <mo>&#x2202;</mo>
              <mi>&#x3b1;</mi>
            </mrow>
          </mfrac>
          <mo>=</mo>
          <mn>0</mn>
        </mrow>
        <mo>&#x2062;</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <mfrac>
            <mrow>
              <mo>&#x2202;</mo>
              <mrow>
                <mi>v</mi>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>&#x3b1;</mi>
                    <mo>,</mo>
                    <mi>&#x3b2;</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
            <mrow>
              <mo>&#x2202;</mo>
              <mi>&#x3b2;</mi>
            </mrow>
          </mfrac>
          <mo>=</mo>
          <mn>0</mn>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>expression</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>7</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0091" num="0090">As a method of searching for &#x3b1;=(&#x3b1;<sub>0</sub>, v<sub>1</sub>, &#x3b1;<sub>2</sub>, &#x3b1;<sub>3</sub>, . . . &#x3b1;<sub>M</sub>) and &#x3b2;=(&#x3b2;<sub>1</sub>, &#x3b2;<sub>2</sub>, &#x3b2;<sub>3</sub>, . . . &#x3b2;<sub>M</sub>) meeting the expression 7, a steepest descent method is employed. However, it is also possible to employ other optimization method or neutral network or the like to search for &#x3b1;=(&#x3b1;<sub>0</sub>, &#x3b1;<sub>1</sub>, &#x3b1;<sub>2</sub>, &#x3b1;<sub>3</sub>, . . . &#x3b1;<sub>M</sub>) and &#x3b2;=(&#x3b2;<sub>1</sub>, &#x3b2;<sub>2</sub>, &#x3b2;<sub>3</sub>, . . . &#x3b2;<sub>M</sub>).</p>
<p id="p-0092" num="0091">(2) Selection of Feature Pattern</p>
<p id="p-0093" num="0092">According to an investigation of the present inventors, cases of the VF at the time that there was no cardiac massage and cases of the VF at the time that there was a cardiac massage were discriminated and analyzed with respect to electrocardiogram wave data A when the cardiac massage was performed and electrocardiogram wave data before and after the electrocardiogram wave data A, so that the following was found.</p>
<p id="p-0094" num="0093">(i) There was a difference in cardiac massage wave due to the difference of the operators performing the cardiac massage.</p>
<p id="p-0095" num="0094">(ii) Unlike the case of VF, the electrocardiogram wave data at the time of cardiac massage recorded before and after the electrocardiogram wave that is determined not to be VF while there is no cardiac massage, was occasionally shown to have the feature in a low-pass frequency.</p>
<p id="p-0096" num="0095">(iii) The feature of the fundamental tuning wave was occasionally shown in the electrocardiogram wave data recorded during the cardiac massage.</p>
<p id="p-0097" num="0096">Accordingly, plural feature patterns is stored in the storage unit in advance, which is in combination with the electrocardiogram wave data that was actually sensed to select the feature pattern having the highest similarity to the corresponding electrocardiogram wave data.</p>
<p id="p-0098" num="0097">In this case, the feature patterns were generated based on the normalization distribution using adjustable parameters and thresholds determined by the statistical processing. That is, 1200 electrocardiogram wave data pieces were randomly extracted from the electrocardiogram wave data recorded before and after the electrocardiogram wave data that is likely to be the VF at the time that there is no cardiac massage, amplitude components obtained from identification of the extracted data were analyzed, and the determined thresholds were used, which were configured based on the normalization distribution. In this case, the average value in the normalization distribution was the adjustable parameter and the maximum peak value of the distribution was 1 (normalization). In addition, in order to calculate the similarity between the feature patterns and the actually obtained electrocardiogram wave data, for example, a method of calculating the distance therebetween was employed.</p>
<p id="p-0099" num="0098">An algorithm of selecting the feature pattern using the distance calculation is as follows.</p>
<p id="p-0100" num="0099">(i) As described above, the amplitude component of the electrocardiogram wave data can be obtained from the identification result. This is referred to as Ai(i=0, . . . M), which is normalized. This is referred to as Ain.</p>
<p id="p-0101" num="0100">(ii) The feature pattern also includes an amplitude component, so that this is referred to as Ak/i(k=1, 2, . . . n). In this case, n is the number of the feature pattern.</p>
<p id="p-0102" num="0101">(iii) A square of a difference between the normalized feature pattern Ain and each of the feature patterns Ak/i is calculated. That is,</p>
<p id="p-0103" num="0102">
<maths id="MATH-US-00013" num="00013">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>&#x25b;</mi>
          <mi>k</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>&#x2211;</mo>
            <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>0</mn>
            </mrow>
            <mi>M</mi>
          </munderover>
          <mo>&#x2062;</mo>
          <msup>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>A</mi>
                  <mi>in</mi>
                </msub>
                <mo>-</mo>
                <msubsup>
                  <mi>A</mi>
                  <mi>i</mi>
                  <mi>k</mi>
                </msubsup>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mn>2</mn>
          </msup>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>expression</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>8</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
(A<sub>i</sub><sup>k </sup>is also referred to as Ak/i)
</p>
<p id="p-0104" num="0103">(iv) The pattern having the highest similarity, A*/i, that is, Ak/i having the minimum value of &#x3b5;<sup>k </sup>is selected.</p>
<p id="p-0105" num="0104">(3) Estimation and Removal of Cardiac Massage Component</p>
<p id="p-0106" num="0105">The cardiac massage component can be estimated using the identification result of the electrocardiogram wave data and the selected feature pattern.</p>
<p id="p-0107" num="0106">This is obtained by multiplying the normalized selected feature pattern with a weighted value with respect to the identification result. That is, when the coefficients of the respective components obtained from the identification result are &#x3b1;i and &#x3b2;i and the selected feature pattern is A*/i, the estimated coefficients of the cardiac massage component are obtained by the expression 9.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>O</i><sub>&#x3b1;</sub><sub><sub2>i</sub2></sub>=&#x3b1;<sub>i</sub><i>&#xd7;A</i><sub>i</sub>*<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>O</i><sub>&#x3b2;</sub><sub><sub2>i</sub2></sub>=&#x3b2;<sub>i</sub><i>&#xd7;A</i><sub>i</sub>*&#x2003;&#x2003;expression 9:<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0108" num="0107">(In addition, A<sub>i</sub>* is referred to as A*/i). Accordingly, the cardiac massage component &#xd4;(t) is obtained by the expression 10.</p>
<p id="p-0109" num="0108">
<maths id="MATH-US-00014" num="00014">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mover>
            <mi>O</mi>
            <mo>^</mo>
          </mover>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mi>t</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>&#x2211;</mo>
            <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>M</mi>
          </munderover>
          <mo>&#x2062;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mrow>
                <msub>
                  <mi>O</mi>
                  <msub>
                    <mi>&#x3b1;</mi>
                    <mi>i</mi>
                  </msub>
                </msub>
                <mo>&#x2062;</mo>
                <mi>cos</mi>
                <mo>&#x2062;</mo>
                <mfrac>
                  <mrow>
                    <mn>2</mn>
                    <mo>&#x2062;</mo>
                    <mi>&#x3c0;</mi>
                    <mo>&#x2062;</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>&#x2062;</mo>
                    <mi>ik</mi>
                    <mo>&#x2062;</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>&#x2062;</mo>
                    <mi>&#x394;</mi>
                  </mrow>
                  <mi>T</mi>
                </mfrac>
              </mrow>
              <mo>+</mo>
              <mrow>
                <msub>
                  <mi>O</mi>
                  <msub>
                    <mi>&#x3b2;</mi>
                    <mi>i</mi>
                  </msub>
                </msub>
                <mo>&#x2062;</mo>
                <mi>sin</mi>
                <mo>&#x2062;</mo>
                <mfrac>
                  <mrow>
                    <mn>2</mn>
                    <mo>&#x2062;</mo>
                    <mi>&#x3c0;</mi>
                    <mo>&#x2062;</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>&#x2062;</mo>
                    <mi>ik</mi>
                    <mo>&#x2062;</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>&#x2062;</mo>
                    <mi>&#x394;</mi>
                  </mrow>
                  <mi>T</mi>
                </mfrac>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>expression</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>10</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0110" num="0109">When the cardiac massage component is removed from the electrocardiogram wave data, the wave of the expression 11 is obtained.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>z</i>(<i>k</i>)={circumflex over (<i>y</i>)}(<i>k</i>)&#x2212;{circumflex over (<i>O</i>)}(<i>k</i>)&#x2003;&#x2003;expression 11:<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0111" num="0110">Next, specific embodiments of the electrocardiogram wave processing system will be described with reference to <figref idref="DRAWINGS">FIGS. 2 and 3</figref>.</p>
<p id="p-0112" num="0111">In this electrocardiogram wave processing system, a computer such as a personal computer is employed to implement the processing of the electrocardiogram wave data A.</p>
<p id="p-0113" num="0112"><figref idref="DRAWINGS">FIG. 2</figref> illustrates an example of the configuration of the electrocardiogram wave processing system that executes a program for recognizing the electrocardiogram wave using a personal computer (PC), and <figref idref="DRAWINGS">FIG. 3</figref> illustrates a flow chart of executing the program for processing the electrocardiogram wave data.</p>
<p id="p-0114" num="0113">The electrocardiogram wave processing system includes a central processing unit CPU <b>20</b>, a main memory <b>21</b>, a storage unit <b>22</b> such as a hard disk, an input unit <b>23</b> such as a keyboard or a mouse, a display <b>24</b>, and an adapter AD <b>25</b> for connection with an external apparatus, which are all connected to a common bus <b>29</b>.</p>
<p id="p-0115" num="0114">The CPU <b>20</b> executes the program <b>211</b> for processing the electrocardiogram wave data to implement an electrocardiogram wave identification function <b>201</b>, a feature extraction function <b>202</b>, a cardiac massage component estimation function <b>203</b>, and a cardiac massage component removal function <b>204</b>. The program <b>211</b> for processing the electrocardiogram wave data, and plural feature patterns <b>212</b> that are prepared in advance are stored in the memory <b>21</b>. In addition, the feature patterns <b>212</b> may be stored in the storage unit <b>22</b> in advance and may be read out to the main memory <b>21</b> if required.</p>
<p id="p-0116" num="0115">The adapter <b>25</b> is connected to a device of measuring the electrocardiogram wave via a predetermined interface. The device senses the electrocardiogram wave, converts the wave into digital data by means of A/D conversion, and transmits the converted electrocardiogram wave data to the adapter <b>25</b>. The electrocardiogram wave data is temporarily stored in the main memory <b>21</b> or the storage unit <b>22</b>.</p>
<p id="p-0117" num="0116">Next, operations of processing the functions of the electrocardiogram wave processing system will be described with reference to the flow chart of <figref idref="DRAWINGS">FIG. 3</figref>.</p>
<p id="p-0118" num="0117">In this flow chart, the step S<b>30</b> is the function of initial processing, the step S<b>31</b> is the function <b>201</b> of identifying the electrocardiogram wave, the step S<b>32</b> is the function of extracting the feature, the step S<b>33</b> is the function <b>203</b> of estimating the cardiac massage component, the step S<b>34</b> is the function of implementing the function <b>204</b> of removing the cardiac massage component, and the step S<b>35</b> is the function of displaying and storing the electrocardiogram wave of the processed result.</p>
<p id="p-0119" num="0118">First, in the step S<b>301</b> of the initial processing S<b>30</b>, coefficients of waves to be analyzed, orders of the harmonic component, and fundamental frequencies are input from the input unit <b>23</b>. That is, an initial setting operation is performed for obtaining the electrocardiogram wave data of the subject to be analyzed from the adapter <b>25</b> and storing the data in the storage unit <b>22</b>. This allows the order M and the fundamental period T of the harmonic components of the expressions 3 and 4 that was predefined to be set.</p>
<p id="p-0120" num="0119">Similarly, in the step S<b>302</b>, the upper limit (C&#x2267;V(&#x3b1;, &#x3b2;)) of the expression 5 is set as a threshold C from the input unit <b>23</b>. In addition, the order, the fundamental period, and the threshold of the harmonic component may be stored in the storage unit <b>22</b> in advance and may be read out to the memory <b>21</b>. In addition, in the step S<b>303</b>, the coefficients of the expression 5, &#x3b1; and &#x3b2;, are input from the input unit <b>23</b> and are set.</p>
<p id="p-0121" num="0120">In addition, prior to this initial processing, n feature patterns A<b>1</b>/I to AN/i (<b>212</b>) configured by the normalization distribution using the statistically collected thresholds and the adjustable parameters are stored in the storage unit <b>22</b> or the memory <b>21</b>.</p>
<p id="p-0122" num="0121">After the several coefficients mentioned above are initially set, in the step S<b>311</b> of the electrocardiogram wave identification step S<b>31</b>, the identification wave &#x177;(k) is generated according to the expression 4. And in the step S<b>312</b>, errors of the identification wave of the expression 4 and the wave to be analyzed represented by the expression 3 are calculated from the expression 5.</p>
<p id="p-0123" num="0122">In the step S<b>313</b>, the obtained error V(&#x3b1;, &#x3b2;) is compared with the threshold C that was initially set. When the error V(&#x3b1;, &#x3b2;) is greater than the threshold C, the steepest descent method is employed to recalculate the coefficients (&#x3b1;, &#x3b2;), thereby repeating the steps S<b>311</b> to S<b>313</b>. In the meantime, when the error is smaller than the threshold C, it is determined that the electrocardiogram wave of the subject is close to the approximate wave, so that the process proceeds to the feature extracting processing step S<b>32</b>. In addition, the number of repeating the steps S<b>311</b> to S<b>313</b> by means of coefficient recalculation is P, and when the error is still greater than the threshold C even in the step S<b>313</b> reaching the repeating number P, the identification of the corresponding wave to be analyzed may be stopped to wait for an input of the next subject.</p>
<p id="p-0124" num="0123">In the step S<b>321</b> of the feature extraction processing S<b>32</b>, an amplitude component Ai(i=0, . . . M) is obtained for the identified electrocardiogram wave data.</p>
<p id="p-0125" num="0124">In the step S<b>322</b>, the distance calculation is used to select the feature pattern having the highest similarity. This processing calculates &#x3b5;<sup>k </sup>according to the expression 8 to determine whether the calculated result is greater than the initially set threshold. When the calculated result is smaller than the threshold, it is determined that the corresponding Ak/i is the feature pattern having the highest similarity. In the meantime, when the calculated result is greater than the threshold, another feature pattern Ak+1/i is read out from the memory <b>21</b> to perform the calculation of the expression 8. This is repeatedly carried out until the maximum number n (the maximum number of the feature patterns), and when the calculated result is still greater than the threshold, it is determined that there is no optimal feature pattern, and the processing of the corresponding step S<b>322</b> is terminated to wait for an input of the next electrocardiogram wave data. That is, the process waits for processing of the step S<b>31</b>.</p>
<p id="p-0126" num="0125">When the feature pattern Ak/i having the highest similarity is selected with this processing, the process proceeds to the next step S<b>33</b> of generating the massage component.</p>
<p id="p-0127" num="0126">In the step S<b>331</b> of the step S<b>33</b> of generating the cardiac massage component, coefficients O<sub>&#x3b1;i </sub>and O<sub>&#x3b2;i </sub>of the cardiac massage components are obtained from the expression 9. In addition, in the step S<b>332</b>, the cardiac massage component &#xd4; is calculated from the expression 10.</p>
<p id="p-0128" num="0127">The process then proceeds to the step S<b>34</b> of removing the cardiac massage component, so that the cardiac massage component &#xd4;(k) is removed from the initial electrocardiogram wave data &#x177;(k) according to the expression 11.</p>
<p id="p-0129" num="0128">In the step S<b>35</b>, the electrocardiogram wave (processed result wave) in which the cardiac massage component is removed is displayed on the display <b>24</b> and is stored in the storage unit <b>22</b>, so that the processing of recognizing one electrocardiogram wave is completed. In addition, when the next electrocardiogram wave is input to this processing system, the above-described processing is performed on the next electrocardiogram wave. The doctor may see the wave in which the cardiac massage component is removed, which is displayed on the display <b>24</b>, and determines whether defibrillation must be performed.</p>
<p id="p-0130" num="0129">Next, exemplary waves that are processed by the detection or processing device <b>20</b> or displayed on the display <b>24</b> in each processing step will be illustrated.</p>
<p id="p-0131" num="0130"><figref idref="DRAWINGS">FIG. 5</figref> illustrates an example of the electrocardiogram wave data A input to the electrocardiogram wave processing system of <figref idref="DRAWINGS">FIG. 1</figref> or <figref idref="DRAWINGS">FIG. 2</figref>. This wave data is input to the wave identification unit <b>101</b> (or the electrocardiogram wave identification function <b>201</b>). The horizontal and vertical axes denote the time t and the voltage value of the wave, respectively.</p>
<p id="p-0132" num="0131"><figref idref="DRAWINGS">FIG. 6</figref> illustrates the wave output from the wave identification unit <b>101</b> (or the electrocardiogram wave identification function <b>201</b>).</p>
<p id="p-0133" num="0132"><figref idref="DRAWINGS">FIGS. 7 and 8</figref> illustrate coefficients &#x3b1; and &#x3b2; obtained by the expression 5 from the wave identification result. The horizontal and vertical axes denote the time t and the voltage value, respectively.</p>
<p id="p-0134" num="0133"><figref idref="DRAWINGS">FIG. 9</figref> illustrates an example of the feature resulting from the identified wave, and the horizontal and vertical axes denote the time t and the amplitude, respectively. The wave having a greater amplitude in the frequency range of 1.5 to 1.9 Hz (the range of about 1.5 to 1.9 Hz in the horizontal axis of <figref idref="DRAWINGS">FIG. 9</figref>) indicates the cardiac massage component. <figref idref="DRAWINGS">FIG. 9</figref> illustrates the amplitude component of the wave calculated using coefficients &#x3b1; and &#x3b2; and obtained from the expression 5 from the result of the identified wave.</p>
<p id="p-0135" num="0134"><figref idref="DRAWINGS">FIG. 10</figref> illustrates an example of n feature patterns configured by the normalization distribution using the statistically collected thresholds and the adjustable parameters. The horizontal and vertical axes denote the frequency and the amplitude, respectively.</p>
<p id="p-0136" num="0135"><figref idref="DRAWINGS">FIG. 11</figref> illustrates the cardiac massage component estimated by the expression 10. The horizontal and vertical axes denote the time t and the voltage value of the wave, respectively.</p>
<p id="p-0137" num="0136"><figref idref="DRAWINGS">FIG. 12</figref> illustrates the wave in which the cardiac massage component shown in <figref idref="DRAWINGS">FIG. 11</figref> is removed from the electrocardiogram wave of <figref idref="DRAWINGS">FIG. 5</figref>. The horizontal and vertical axes denote the time t and the voltage value, respectively.</p>
<p id="p-0138" num="0137"><figref idref="DRAWINGS">FIG. 13</figref> illustrates the wave (frequency feature wave) in which the cardiac massage component is removed from the electrocardiogram wave of <figref idref="DRAWINGS">FIG. 10</figref>. The horizontal and vertical axes denote the frequency and the amplitude, respectively. It can be seen that the estimated cardiac massage component is removed.</p>
<p id="p-0139" num="0138">In summary, an example of the recognized electrocardiogram wave data becomes present as shown in <figref idref="DRAWINGS">FIGS. 14A to 14D</figref>. Right waves <b>14</b>C and <b>14</b>D indicate the electrocardiogram waves to be analyzed, and left waves <b>14</b>A and <b>14</b>B indicate the frequency feature waves. In addition, upper waves <b>14</b>A and <b>14</b>C indicate the waves before the cardiac massage component is removed, and lower waves <b>14</b>B and <b>14</b>D indicate waves after the cardiac massage component is removed. The wave of the portion surrounded by the solid line in <b>14</b>A corresponds to the main component resulting from the heat massage. When the cardiac massage is removed, it becomes the wave as shown in the dotted line in <b>14</b>B.</p>
<p id="p-0140" num="0139"><figref idref="DRAWINGS">FIGS. 4A and 4B</figref> are diagrams for explaining an effect of the present embodiment.</p>
<p id="p-0141" num="0140"><figref idref="DRAWINGS">FIG. 4A</figref> indicates the case where the conventional semiautomatic defibrillation device is used, and <figref idref="DRAWINGS">FIG. 4B</figref> indicates the case where the electrocardiogram wave process of the present embodiment is applied.</p>
<p id="p-0142" num="0141">Referring to <figref idref="DRAWINGS">FIG. 4A</figref>, S<b>1</b>, S<b>2</b>, and so on denote the processes of performing the cardiac massage. Typically, the duration of the cardiac massage Si is 120 seconds. After that, when an announcement V<b>1</b> indicating &#x201c;please hands off&#x201d; occurs for about 2 seconds, the operator stops performing the cardiac massage. After that, detection X<b>1</b> of the electrocardiogram wave is performed for about 4 to 5 seconds, and analysis Y<b>1</b> of the detected electrocardiogram wave is performed for about 2 seconds. After that, when an announcement V<b>2</b> indicating &#x201c;please perform the cardiac massage again&#x201d; occurs for about 9 seconds, the cardiac massage S<b>2</b> is performed again for 120 seconds. This is repeated.</p>
<p id="p-0143" num="0142">In this case, T<b>1</b> (=X<b>1</b>+Y<b>1</b>+V<b>2</b>) becomes about 16 seconds. Typically, the cardiac massage is performed at this duration. However, when the cardiac massage must be stopped and the defibrillation must be performed, the duration may actually exceed one minute, because of the description for the apparatus status of the semiautomatic defibrillation apparatus being charged or a voice announcement for performing the defibrillation, thereby possibly causing more damage to the brain of the subject.</p>
<p id="p-0144" num="0143">To deal with this, according to the present embodiment, the electrocardiogram wave is detected (X<b>1</b>) and is analyzed (Y<b>1</b>) while the cardiac massage is continuously performed without being stopped as shown in (B<b>1</b>). Actually, the detected electrocardiogram wave data is subjected to A/D conversion and is stored in the storage unit, which is then read out for analysis. The analysis process (Y<b>1</b>) is to remove the component of the cardiac massage from the obtained electrocardiogram wave. This time T (=X<b>1</b>+Y<b>1</b>) is about 6 seconds.</p>
<p id="p-0145" num="0144">The doctor (or emergency life guard) can determine whether the defibrillation is required while listening to the determination result of the defibrillation or monitoring the wave in which the cardiac massage component is removed. In addition, the electrocardiogram wave can be taken and analyzed without stopping the cardiac massage, so that it is possible to avoid an adverse effect resulting from the stopped cardiac massage on the cardiopulmonary resuscitation.</p>
<p id="p-0146" num="0145">In this way, the electrocardiogram wave processing system according to the present embodiment can advantageously provide information for determining whether the defibrillation needs to be applied by analyzing the electrocardiogram wave using specific processing.</p>
<p id="p-0147" num="0146">In addition, the electrocardiogram wave processing system may be applied to the defibrillation apparatus in other applications. An automated or semi-automated external defibrillator (AED) is an apparatus, which is driven by a battery and performs electrical defibrillation by means of the electrode attached to the patient. For example, the electrocardiogram wave processing system shown in <figref idref="DRAWINGS">FIG. 1</figref> or <figref idref="DRAWINGS">FIG. 2</figref> may be applied to an AED having an electrocardiogram monitor, so that the AED can display on the monitor the result of the electrocardiogram wave processed according to the present embodiment.</p>
<p id="p-0148" num="0147">In the meantime, well-known AEDs may have a voice unit without the electrocardiogram monitor. In this kind of AED, the voice unit notifies the operator such as the emergency life guard of whether the defibrillation must be performed. Accordingly, in this AED, for example, the structure in <figref idref="DRAWINGS">FIG. 2</figref> of which the display <b>13</b> is removed is applied thereto, and predetermined patterns of the electrocardiogram waves where the defibrillation must be applied are stored in the storage unit in advance. It is determined whether the defibrillation must be applied by cross-checking the electrocardiogram wave output from the removal unit <b>205</b> with the predetermined patterns that are prepared in the storage unit in advance. Upon determination that the defibrillation must be applied, the operator is notified by voice means. In addition, an alarming unit such as an alarming display may be employed instead of or in addition to the voice means. When the alarm from the alarming unit is present, the operator may perform the defibrillation.</p>
<p id="p-0149" num="0148">Terms or symbols used in the embodiments above are exemplary. Others may be employed sometimes, however, they must be determined in view of the gist of the present invention. In addition, the present invention may be variously modified without being limited to the embodiments above.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08626286-20140107-M00001.NB">
<img id="EMI-M00001" he="8.47mm" wi="76.20mm" file="US08626286-20140107-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08626286-20140107-M00002.NB">
<img id="EMI-M00002" he="8.81mm" wi="76.20mm" file="US08626286-20140107-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08626286-20140107-M00003.NB">
<img id="EMI-M00003" he="8.47mm" wi="76.20mm" file="US08626286-20140107-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US08626286-20140107-M00004.NB">
<img id="EMI-M00004" he="8.81mm" wi="76.20mm" file="US08626286-20140107-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US08626286-20140107-M00005.NB">
<img id="EMI-M00005" he="17.27mm" wi="76.20mm" file="US08626286-20140107-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US08626286-20140107-M00006.NB">
<img id="EMI-M00006" he="12.36mm" wi="76.20mm" file="US08626286-20140107-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US08626286-20140107-M00007.NB">
<img id="EMI-M00007" he="8.47mm" wi="76.20mm" file="US08626286-20140107-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US08626286-20140107-M00008.NB">
<img id="EMI-M00008" he="8.81mm" wi="76.20mm" file="US08626286-20140107-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US08626286-20140107-M00009.NB">
<img id="EMI-M00009" he="12.70mm" wi="76.20mm" file="US08626286-20140107-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00010" nb-file="US08626286-20140107-M00010.NB">
<img id="EMI-M00010" he="13.38mm" wi="76.20mm" file="US08626286-20140107-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00011" nb-file="US08626286-20140107-M00011.NB">
<img id="EMI-M00011" he="18.03mm" wi="76.20mm" file="US08626286-20140107-M00011.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00012" nb-file="US08626286-20140107-M00012.NB">
<img id="EMI-M00012" he="13.80mm" wi="76.20mm" file="US08626286-20140107-M00012.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00013" nb-file="US08626286-20140107-M00013.NB">
<img id="EMI-M00013" he="8.81mm" wi="76.20mm" file="US08626286-20140107-M00013.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00014" nb-file="US08626286-20140107-M00014.NB">
<img id="EMI-M00014" he="8.81mm" wi="76.20mm" file="US08626286-20140107-M00014.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00015" nb-file="US08626286-20140107-M00015.NB">
<img id="EMI-M00015" he="8.47mm" wi="76.20mm" file="US08626286-20140107-M00015.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00016" nb-file="US08626286-20140107-M00016.NB">
<img id="EMI-M00016" he="8.81mm" wi="76.20mm" file="US08626286-20140107-M00016.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00017" nb-file="US08626286-20140107-M00017.NB">
<img id="EMI-M00017" he="8.47mm" wi="76.20mm" file="US08626286-20140107-M00017.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00018" nb-file="US08626286-20140107-M00018.NB">
<img id="EMI-M00018" he="8.81mm" wi="76.20mm" file="US08626286-20140107-M00018.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00019" nb-file="US08626286-20140107-M00019.NB">
<img id="EMI-M00019" he="8.47mm" wi="76.20mm" file="US08626286-20140107-M00019.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00020" nb-file="US08626286-20140107-M00020.NB">
<img id="EMI-M00020" he="8.81mm" wi="76.20mm" file="US08626286-20140107-M00020.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A system of analyzing electrocardiogram wave data obtained from a subject, comprising:
<claim-text>a wave identification unit that identifies a first electrocardiogram wave from the obtained electrocardiogram wave data;</claim-text>
<claim-text>a feature selection unit that selects a feature pattern including a feature when a cardiac massage has been performed with respect to the electrocardiogram wave data of the first electrocardiogram wave identified by the wave identification unit;</claim-text>
<claim-text>a generation unit that generates a component of the cardiac massage using the feature pattern selected by the feature selection unit; and</claim-text>
<claim-text>a removal unit that removes, from the obtained electrocardiogram wave data, the component of the cardiac massage generated by the generation unit;</claim-text>
<claim-text>wherein said wave identification unit executes the following expressions to identify the first electrocardiogram wave:</claim-text>
<claim-text>a Fourier series expansion expressed by the expression:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00015" num="00015">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>y</mi>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mi>t</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msub>
      <mi>a</mi>
      <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
      <munderover>
        <mo>&#x2211;</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
        </mrow>
        <mi>&#x221e;</mi>
      </munderover>
      <mo>&#x2062;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <msub>
              <mi>a</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>cos</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
            <msub>
              <mi>b</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>sin</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<claim-text>and an approximate wave of the Fourier series expansion expressed by the expression:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00016" num="00016">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mover>
        <mi>y</mi>
        <mo>^</mo>
      </mover>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>(</mo>
        <mi>t</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <msub>
        <mi>&#x3b1;</mi>
        <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mrow>
        <munderover>
          <mo>&#x2211;</mo>
          <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>M</mi>
        </munderover>
        <mo>&#x2062;</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>&#x3b1;</mi>
                <mi>i</mi>
              </msub>
              <mo>&#x2062;</mo>
              <mi>cos</mi>
              <mo>&#x2062;</mo>
              <mfrac>
                <mrow>
                  <mn>2</mn>
                  <mo>&#x2062;</mo>
                  <mi>&#x3c0;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>it</mi>
                </mrow>
                <mi>T</mi>
              </mfrac>
            </mrow>
            <mo>+</mo>
            <mrow>
              <msub>
                <mi>&#x3b2;</mi>
                <mi>i</mi>
              </msub>
              <mo>&#x2062;</mo>
              <mi>sin</mi>
              <mo>&#x2062;</mo>
              <mfrac>
                <mrow>
                  <mn>2</mn>
                  <mo>&#x2062;</mo>
                  <mi>&#x3c0;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>it</mi>
                </mrow>
                <mi>T</mi>
              </mfrac>
            </mrow>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>&#x2003;and assuming that the obtained electrocardiogram wave data describes a wave in which a fundamental wave component and a harmonic wave component overlap each other, errors of &#x177;(t) and y(t) are made to be as small as possible by adjusting &#x3b1;=(&#x3b1;0, &#x3b1;1, &#x3b1;2, &#x3b1;3, . . . ) and &#x3b2;=(&#x3b2;1, &#x3b2;2, &#x3b2;3, . . . ), thereby searching &#x3b1; and &#x3b2; to identify and extract the electrocardiogram wave data to be analyzed.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The system according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a storage unit that stores a plurality of different registration feature patterns in advance,</claim-text>
<claim-text>wherein the feature selection unit refers to the registration feature patterns stored in the storage unit to select the registration feature pattern that is the most similar to the feature pattern included in the electrocardiogram wave data of the first electrocardiogram wave identified by the wave identification unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The system according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising:
<claim-text>a determination unit that determines whether defibrillation needs to be applied to the subject by cross-checking an electrocardiogram wave output from the removal unit with predetermined wave information already prepared in the storage unit; and</claim-text>
<claim-text>an alarm unit that raises an alarm by sound or display upon determination of the determination unit that the defibrillation needs to be applied to the subject.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The system according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the generation unit multiplies a normalized value of the selected feature pattern by a weighted value with respect to the first electrocardiogram wave identified by the wave identification unit.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The system according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the removal unit mainly removes, from the electrocardiogram wave data, the component of the cardiac massage of which the electrocardiogram wave data has an amplitude component ranging from 1.5 Hz to 1.9 Hz.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The system according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a display that displays a second electrocardiogram wave output from the removal unit of which the component of the cardiac massage is removed.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The system according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a processing unit that executes a computer program which implements each function of the wave identification unit, the feature selection unit, the generation unit, and the removal unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A method of obtaining and analyzing electrocardiogram wave data using a processing apparatus, comprising:
<claim-text>identifying a first electrocardiogram wave when a cardiac massage has been performed from the obtained electrocardiogram wave data;</claim-text>
<claim-text>selecting a feature pattern from the electrocardiogram wave data of the identified first electrocardiogram wave;</claim-text>
<claim-text>generating a component of the cardiac massage from the feature pattern; and</claim-text>
<claim-text>removing the generated component from the obtained electrocardiogram wave data;</claim-text>
<claim-text>wherein the following expressions are executed when identifying the first electrocardiogram wave:</claim-text>
<claim-text>a Fourier series expansion expressed by the expression:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00017" num="00017">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>y</mi>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mi>t</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msub>
      <mi>a</mi>
      <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
      <munderover>
        <mo>&#x2211;</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
        </mrow>
        <mi>&#x221e;</mi>
      </munderover>
      <mo>&#x2062;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <msub>
              <mi>a</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>cos</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
            <msub>
              <mi>b</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>sin</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<claim-text>and an approximate wave of the Fourier series expansion expressed by the expression:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00018" num="00018">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mover>
        <mi>y</mi>
        <mo>^</mo>
      </mover>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>(</mo>
        <mi>t</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <msub>
        <mi>&#x3b1;</mi>
        <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mrow>
        <munderover>
          <mo>&#x2211;</mo>
          <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>M</mi>
        </munderover>
        <mo>&#x2062;</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>&#x3b1;</mi>
                <mi>i</mi>
              </msub>
              <mo>&#x2062;</mo>
              <mi>cos</mi>
              <mo>&#x2062;</mo>
              <mfrac>
                <mrow>
                  <mn>2</mn>
                  <mo>&#x2062;</mo>
                  <mi>&#x3c0;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>it</mi>
                </mrow>
                <mi>T</mi>
              </mfrac>
            </mrow>
            <mo>+</mo>
            <mrow>
              <msub>
                <mi>&#x3b2;</mi>
                <mi>i</mi>
              </msub>
              <mo>&#x2062;</mo>
              <mi>sin</mi>
              <mo>&#x2062;</mo>
              <mfrac>
                <mrow>
                  <mn>2</mn>
                  <mo>&#x2062;</mo>
                  <mi>&#x3c0;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>it</mi>
                </mrow>
                <mi>T</mi>
              </mfrac>
            </mrow>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>assuming that the obtained electrocardiogram wave data describes a wave in which a fundamental wave component and a harmonic wave component overlap each other, making errors of &#x177;(t) and y(t) as small as possible by adjusting &#x3b1;=(&#x3b1;0, &#x3b1;1, &#x3b1;2, &#x3b1;3, . . . ) and &#x3b2;=(&#x3b2;1, &#x3b2;2, &#x3b2;3, . . . ); and
<claim-text>searching &#x3b1; and &#x3b2; to identify and extract the electrocardiogram wave data to be analyzed.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, further comprising:
<claim-text>storing a plurality of registration feature patterns in a storage unit in advance; and</claim-text>
<claim-text>sequentially cross-checking the electrocardiogram wave data of the first electrocardiogram wave with the registration feature patterns to determine the most similar registration feature pattern included in the electrocardiogram wave data of the first electrocardiogram wave.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, further comprising:
<claim-text>displaying a second electrocardiogram wave of which the component of the cardiac massage is removed.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A non-transitory computer readable medium comprising instructions for executing a method of analyzing obtained electrocardiogram wave data, the method comprising the steps of:
<claim-text>identifying an electrocardiogram wave from the obtained electrocardiogram wave data;</claim-text>
<claim-text>selecting a feature pattern including a feature when a cardiac massage has been performed with respect to the electrocardiogram wave data of the identified electrocardiogram wave;</claim-text>
<claim-text>generating a component of the cardiac massage from the selected feature pattern; and</claim-text>
<claim-text>removing the generated component of the cardiac massage from the obtained electrocardiogram wave data;</claim-text>
<claim-text>wherein the following expressions are executed in identifying the electrocardiogram wave:</claim-text>
<claim-text>a Fourier series expansion expressed by the expression:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00019" num="00019">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>y</mi>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mi>t</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msub>
      <mi>a</mi>
      <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
      <munderover>
        <mo>&#x2211;</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
        </mrow>
        <mi>&#x221e;</mi>
      </munderover>
      <mo>&#x2062;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <msub>
              <mi>a</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>cos</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
            <msub>
              <mi>b</mi>
              <mi>i</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mi>sin</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>it</mi>
              </mrow>
              <mi>T</mi>
            </mfrac>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<claim-text>and an approximate wave of the Fourier series expansion expressed by the expression:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00020" num="00020">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mover>
        <mi>y</mi>
        <mo>^</mo>
      </mover>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>(</mo>
        <mi>t</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <msub>
        <mi>&#x3b1;</mi>
        <mn>0</mn>
      </msub>
      <mo>+</mo>
      <mrow>
        <munderover>
          <mo>&#x2211;</mo>
          <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>M</mi>
        </munderover>
        <mo>&#x2062;</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>&#x3b1;</mi>
                <mi>i</mi>
              </msub>
              <mo>&#x2062;</mo>
              <mi>cos</mi>
              <mo>&#x2062;</mo>
              <mfrac>
                <mrow>
                  <mn>2</mn>
                  <mo>&#x2062;</mo>
                  <mi>&#x3c0;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>it</mi>
                </mrow>
                <mi>T</mi>
              </mfrac>
            </mrow>
            <mo>+</mo>
            <mrow>
              <msub>
                <mi>&#x3b2;</mi>
                <mi>i</mi>
              </msub>
              <mo>&#x2062;</mo>
              <mi>sin</mi>
              <mo>&#x2062;</mo>
              <mfrac>
                <mrow>
                  <mn>2</mn>
                  <mo>&#x2062;</mo>
                  <mi>&#x3c0;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>it</mi>
                </mrow>
                <mi>T</mi>
              </mfrac>
            </mrow>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>and assuming that the obtained electrocardiogram wave data describes a wave in which a fundamental wave component and a harmonic wave component overlap each other, errors of &#x177;(t) and y(t) are made to be as small as possible by adjusting &#x3b1;=(&#x3b1;0, &#x3b1;1, &#x3b1;2, &#x3b1;3, . . . ) and &#x3b2;=(&#x3b2;1, &#x3b2;2, &#x3b2;3, . . . ), thereby searching &#x3b1; and &#x3b2; to identify and extract the electrocardiogram wave data to be analyzed.</claim-text>
</claim>
</claims>
</us-patent-grant>
