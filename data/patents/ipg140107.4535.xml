<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625619-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625619</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13486037</doc-number>
<date>20120601</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>TW</country>
<doc-number>100119137 A</doc-number>
<date>20110601</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>46</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>12</main-group>
<subgroup>28</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>J</subclass>
<main-group>3</main-group>
<subgroup>16</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>370401</main-classification>
<further-classification>370466</further-classification>
</classification-national>
<invention-title id="d2e71">Domain gateway control system and method thereof</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6363065</doc-number>
<kind>B1</kind>
<name>Thornton et al.</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370352</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6876654</doc-number>
<kind>B1</kind>
<name>Hegde</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370392</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7002973</doc-number>
<kind>B2</kind>
<name>MeLampy et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370401</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7028092</doc-number>
<kind>B2</kind>
<name>MeLampy et al.</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709230</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7031288</doc-number>
<kind>B2</kind>
<name>Ogier</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370338</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>8451845</doc-number>
<kind>B2</kind>
<name>Boucadair et al.</name>
<date>20130500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370393</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2001/0040895</doc-number>
<kind>A1</kind>
<name>Templin</name>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370466</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2002/0012320</doc-number>
<kind>A1</kind>
<name>Ogier et al.</name>
<date>20020100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370252</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2002/0101860</doc-number>
<kind>A1</kind>
<name>Thornton et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370352</main-classification></classification-national>
</us-citation>
</us-references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>12</number-of-drawing-sheets>
<number-of-figures>13</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120307833</doc-number>
<kind>A1</kind>
<date>20121206</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Leu</last-name>
<first-name>Kuen-Long</first-name>
<address>
<city>Hsinchu</city>
<country>TW</country>
</address>
</addressbook>
<residence>
<country>TW</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Leu</last-name>
<first-name>Kuen-Long</first-name>
<address>
<city>Hsinchu</city>
<country>TW</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Muncy, Geissler, Olds &#x26; Lowe, PLLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Accton Technology Corporation</orgname>
<role>03</role>
<address>
<city>Hsinchu</city>
<country>TW</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Han</last-name>
<first-name>Clemence</first-name>
<department>2464</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A domain gateway control system and a method are provided. The system includes a gateway device configured at an interface of a domain. The gateway device is further linked to more than one Ethernet. When the gateway device analyzes a data packet acquired from an Ethernet and detects that a destination MAC address data of the data packet points to a net device in the domain, the gateway device records a gateway MAC address data in a source MAC field of the data packet and records a domain type code data corresponding to the domain in an Ethernet-type field of the data packet to convert the data packet into a domain packet used in the domain. Any net device in the domain that acquires the domain packet learns the gateway MAC address data, and does not learn a device MAC address data of an external device of the Ethernet.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="172.13mm" wi="242.91mm" file="US08625619-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="206.42mm" wi="120.99mm" orientation="landscape" file="US08625619-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="242.65mm" wi="173.31mm" orientation="landscape" file="US08625619-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="229.11mm" wi="159.77mm" orientation="landscape" file="US08625619-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="243.33mm" wi="173.31mm" orientation="landscape" file="US08625619-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="244.01mm" wi="167.22mm" orientation="landscape" file="US08625619-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="240.62mm" wi="146.13mm" orientation="landscape" file="US08625619-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="252.22mm" wi="167.22mm" orientation="landscape" file="US08625619-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="219.54mm" wi="182.20mm" file="US08625619-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="235.88mm" wi="179.49mm" file="US08625619-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="236.14mm" wi="172.64mm" file="US08625619-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="229.45mm" wi="150.45mm" orientation="landscape" file="US08625619-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="166.62mm" wi="119.97mm" orientation="landscape" file="US08625619-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATION</heading>
<p id="p-0002" num="0001">This application claims the benefit of Taiwan Patent Application No. 100119137, filed on Jun. 1, 2011, which is hereby incorporated by reference for all purposes as if fully set forth herein.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">1. Field of Invention</p>
<p id="p-0004" num="0003">The present invention relates to a domain gateway control system and its method. More particularly, the invention relates to a domain gateway control system and its method in which a gateway device is used as a packet format conversion device between a domain and an Ethernet to make net devices in the domain form a network group dedicated to the domain.</p>
<p id="p-0005" num="0004">2. Related Art</p>
<p id="p-0006" num="0005">In the prior art, upon acquiring a data packet transported over a network, an L2 (data link layer) net device compares a destination Media Access Control (MAC) address data of the data packet with a device MAC table data built in the net device, and searches in the device MAC table data for port number data of a communication port corresponding to the destination MAC address data to output the data packet through the corresponding communication port. However, when no port number data of communication port corresponding to the destination MAC address data exists in the device MAC table data, the net device broadcasts the data packet from all communication ports of the net device except the communication port acquiring the data packet.</p>
<p id="p-0007" num="0006">Meanwhile, the net device also compares a source MAC address data of the data packet packet with the device MAC table data. If the source MAC address data does not exist in the device MAC table data, the source MAC address data and port number data of the communication port acquiring the data packet are recorded in the device MAC table data. On the contrary, when the source MAC address data exists in the device MAC table data, the net device compares the source MAC address data and port number data of the communication port acquiring the data packet with data recorded in the device MAC table data. If the source MAC address data and the port number data of communication port are the same as the data recorded in the device MAC table data, the data in the device MAC table data remains unchanged. If the port number data of communication port which corresponds to the source MAC address data is different from the data recorded in the device MAC table data, depending on the demands of the designer, the source MAC address data and the corresponding port number data of communication port will either be updated in the device MAC table data or the port number data of communication port corresponding to the source MAC address data will be added in the device MAC table data.</p>
<p id="p-0008" num="0007">For example, <figref idref="DRAWINGS">FIG. 1</figref> is a schematic view of connection of net devices in the prior art. Connection architecture of an L2-net device-switch with other net devices is provided for illustration. In <figref idref="DRAWINGS">FIG. 1</figref>, a switch <b>1</b> is connected to a net device B and a net device C. When a remote net device A needs to communicate with net device B, data packets are transmitted between net device A and net device B through the network, and the switch <b>1</b> records source MAC address data of the data packets and port number data of a communication port receiving the data packets respectively.</p>
<p id="p-0009" num="0008">It is assumed that the switch <b>1</b> acquires, through a No. I communication port <b>11</b>, a data packet P<b>1</b> transmitted by the net device A. The source MAC address data of the data packet P<b>1</b> is the MAC of the net device A, and the destination MAC address data of the data packet P<b>1</b> is the MAC address of the net device B. The switch <b>1</b> compares the source MAC address data of the data packet P<b>1</b> with a device MAC table data. If the MAC address of net device B is stored in the device MAC table data and the MAC address of net device B corresponds to the No. II communication port <b>12</b> of the switch <b>1</b>, the switch <b>1</b> outputs the data packet P<b>1</b> through the No. II communication port <b>12</b> to transport the data packet P<b>1</b> to net device B. On the contrary, if the MAC address of net device B is not stored in the MAC table data, the switch <b>1</b> broadcasts the data packet P<b>1</b> through all communication ports except the No. I communication port <b>11</b>.</p>
<p id="p-0010" num="0009">If the switch <b>1</b> determines the MAC address of net device A, it will record the MAC address of net device A and the No. I communication port <b>11</b> corresponding to the MAC address of net device A in the MAC table data.</p>
<p id="p-0011" num="0010">Next, it is assumed that the switch <b>1</b> acquires, through the No. II communication port <b>12</b>, a data packet P<b>2</b> transmitted by net device B. The source MAC address data of the data packet P<b>2</b> is the MAC address of the net device B, and the destination MAC address data of the data packet P<b>2</b> is the MAC address of the net device A. If the switch <b>1</b> determines that the MAC address of net device B is not in the system, the MAC address of the net device B will be recorded in the MAC table data by the switch <b>1</b>. However, if the switch <b>1</b> determines that the MAC address of the net device A is already learnt and knows that the MAC address of the net device A corresponds to the No. I communication port <b>11</b>, the switch will output the data packet P<b>2</b> output from the net device B through the No. I communication port <b>11</b>.</p>
<p id="p-0012" num="0011">Next, it is assumed that the switch <b>1</b> acquires a data packet P<b>3</b> of the net device C through a No. III communication port <b>13</b> and the data packet P<b>3</b> points to the net device B or the net device A. When the switch <b>1</b> first learns a MAC address of the net device C from the data packet P<b>3</b>, it will to update the MAC table data. Subsequently, the switch <b>1</b> outputs the data packet P<b>3</b> heading for net device A directly through the No. I communication port <b>11</b>, or uses the No. II communication port <b>12</b> to output the data packet P<b>3</b> heading for net device B.</p>
<p id="p-0013" num="0012">If only the L2-net protocol is applied, the other net devices can also perform operations that include a learning operation of a source MAC address data of a data packet and a forwarding operation of the data packet. As the number of net devices increases gradually and the network scale gets larger gradually, each net device needs to learn and record an increased number of MAC addresses. The net devices must have storage units having a larger memory capacity to record MAC addresses of other net devices. In addition, even if each net device has a built-in MAC update and stripping mechanism to perform better update and processing on data in the MAC table data, the demands for the memory capacity of the storage unit cannot be effectively restrained. Additionally, once data stored in the storage unit reaches an upper limit of the memory capacity, even if the MAC update and stripping mechanism are used, a processor of the net device cannot be prevented from continuously performing a MAC learning operation, and, as a result, extra software or hardware resources must be provided for the processor to assist the MAC learning operation, resulting in unnecessary resource consumption. Furthermore, with the demands for increasing memory capacity, the manufacturing costs of the storage units and net devices in which the storage units are applied increase accordingly.</p>
<p id="p-0014" num="0013">Therefore, the problem that manufacturers encounter is how to use net devices with limited memory capacity in net architectures of different scales.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0015" num="0014">The present invention is directed to a domain gateway control technology, in which data packet formats between a domain and an Ethernet are converted so that net devices in the domain form a unique device group in the domain.</p>
<p id="p-0016" num="0015">In order to solve the above technical problems, the present invention discloses a domain gateway control system, which comprises a domain and a gateway device. The gateway device serves as an interface of the domain, and is linked to an Ethernet.</p>
<p id="p-0017" num="0016">A domain packet is transmitted in the domain, and an Ethernet-type field of the domain packet records a domain type code data corresponding to the domain.</p>
<p id="p-0018" num="0017">The gateway device is used to analyze a destination MAC address data of the data packet when acquiring the data packet from the Ethernet. When the gateway device determines that the destination MAC address data of the first data packet points to the domain, the gateway device uses a MAC address Group Protocol (MAGP) information to convert the data packet into a domain packet, and forwards the domain packet to the domain. The MAGP information comprises: a recorded gateway MAC address data of the gateway device in a source MAC field comprised in the data packet and the recorded domain type code data in an Ethernet-type field of the data packet.</p>
<p id="p-0019" num="0018">In the domain gateway control system disclosed by the present invention, each net device in the domain comprises a device MAC table data. When any net device acquires a domain packet, the gateway MAC address data of the gateway device is the source MAC address data learnt by the net device, and the gateway MAC address data is recorded in the device MAC table data.</p>
<p id="p-0020" num="0019">In the domain gateway control system disclosed by the present invention, the gateway device further acquires a second domain packet from the domain, which is generated by any one of the net devices in the domain. A packet format of the second domain packet is equivalent to that of the first domain packet. When the gateway device analyzes that the destination MAC address data of the second domain packet points to the gateway device, and a data field includes an off-net destination MAC address data directed to the Ethernet and an Ethernet-type code data corresponding to the Ethernet, the gateway device updates the destination MAC address data field of the second domain packet with the off-net destination MAC address data and updates an Ethernet-type field of the second domain packet with the Ethernet-type code data to convert the second domain packet into a second data packet and forward the second data packet to the Ethernet, which is received by an external device corresponding to the off-net destination MAC address data.</p>
<p id="p-0021" num="0020">In order to solve the technical problems, the present invention discloses a domain gateway control method, which is applied to a gateway device configured at an interface of a domain. The gateway device is linked to an Ethernet. The domain gateway control method comprises: acquiring a first data packet from the Ethernet; analyzing a destination MAC address data of the first data packet; and when the gateway device determines that the destination MAC address data comprised in the first data packet points to the domain, MAGP information is used to convert the first data packet into a first domain packet, and the first domain packet is forwarded to the domain. The MAGP information comprises a recorded gateway MAC address data of the gateway device as a source MAC address data of the first data packet and a recorded domain type code data corresponding to the domain as an Ethernet-type code data of the first data packet.</p>
<p id="p-0022" num="0021">The characteristics of the present invention are as follows. A gateway device is used as a packet conversion device between a domain and an Ethernet, meanwhile a gateway MAC address data of the gateway device is updated to be directed to a source MAC address data of a data packet of the domain. Regardless of the size of the domain, each net device in the domain can at most only learn MACs of all of the net devices in the domain, which reduces the times that each net device learns the MACs, and meanwhile reduces demands for memory capacity for the MACs of the net devices. In addition, once the demands for the memory capacity decrease, manufacturers no longer need to configure storage units with large memory capacity in net devices, and thereby effectively reduce design and manufacturing costs of the net devices. In addition, operation time and resources of a processor of the net device can be prevented from being occupied excessively and improve operative performance of the net device indirectly. Furthermore, net devices in each domain form a device group dedicated to the domain, which makes it convenient for network management personnel to manage relevant net architectures effectively.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0023" num="0022">The present invention will become more fully understood from the detailed description given herein below and the drawings, which are example embodiments of the invention and are not be the only embodiments of the present invention:</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic view of an embodiment's connection of net devices in the prior art;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic system architecture diagram in a domain gateway control system according to an embodiment of the present invention;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 3</figref> is a schematic view of packet structure conversion in a domain gateway control system according to an embodiment of the present invention;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 4</figref> is a schematic view of forwarding a packet to a domain in a domain gateway control system according to an embodiment of the present invention;</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 5</figref> is a schematic view of sending out a domain packet in a domain gateway control system according to an embodiment of the present invention;</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 6</figref> is a schematic view of domain packet structure conversion in a domain gateway control system according to an embodiment of the present invention;</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 7</figref> is a schematic view of a cache MAC table data and an application thereof in a domain gateway control system according to an embodiment of the present invention;</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 8</figref> is a schematic flow chart of a domain gateway control method according to an embodiment of the present invention;</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 9</figref> is a schematic flow chart of sending out a domain packet in a domain gateway control method according to the present invention;</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 10</figref> is a flow chart of a net device forwarding a packet in a domain gateway control method according to the present invention;</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 11</figref> is a flow chart of a net device establishing a data packet to be sent out in a domain gateway control method according to the present invention;</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 12</figref> is a schematic logic diagram of an operation of a gateway device in a domain gateway control system according to the present invention; and</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 13</figref> is a schematic logic diagram of an operation of a net device in a domain gateway control system according to the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0037" num="0036">Preferred embodiments of the present invention are illustrated below in detail with reference to the accompanying drawings.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic system architecture diagram in a domain gateway control system according to an embodiment of the present invention. A system disclosed by the present invention includes a domain <b>2</b> and a gateway device <b>21</b>. The gateway device <b>21</b> is configured at an interface (a data transmission interface) of the domain <b>2</b>, and is linked to a first Ethernet <b>3</b>.</p>
<p id="p-0039" num="0038">More than one net device <b>22</b> is configured in the domain <b>2</b>. In the domain <b>2</b>, domain packets dedicated to the domain <b>2</b> and complying with an MAGP information are transmitted between the net devices <b>22</b>. The MAGP information has various rules, which are illustrated one by one in the following embodiments.</p>
<p id="p-0040" num="0039">In this embodiment, the gateway device <b>21</b> is an L2-net device (for example, a device of a relevant type, such as a network switch and a bridge). The first Ethernet <b>3</b> linked to the gateway device <b>21</b> is configured with more than one external device <b>30</b>. However, the external devices <b>30</b> and the net devices <b>22</b> in the domain <b>2</b> may be regarded as devices of the same protocol, and devices of different protocols are also applicable.</p>
<p id="p-0041" num="0040">In addition, the net devices <b>22</b>, the gateway device <b>21</b> and the external devices <b>30</b> have an identifying MAC in the net respectively, which complies with the MAC address format. For convenience of the following description, the MAC address of the net device <b>22</b> is temporarily called a device MAC address data, and the MAC address of the gateway device <b>21</b> is temporarily called a gateway MAC address data.</p>
<p id="p-0042" num="0041">The gateway device <b>21</b>, the net devices <b>22</b> in the domain <b>2</b>, and the external devices <b>30</b> all comply with an L2 network communication protocol, record a MAC address as a source MAC address data of a packet when the packet is generated, and record a MAC address of a destination device as a destination MAC address data of the packet.</p>
<p id="p-0043" num="0042">Upon acquiring various data packets from the net, the gateway device <b>21</b> and the net devices <b>22</b> in the domain <b>2</b> learn the source MAC address data in the data packet, acquire the communication port number data of the communication port of the data packet, and record the source MAC address data and the communication port number data in a device MAC table data <b>220</b> thereof. For convenience of description, the device MAC table data included in the gateway device <b>21</b> is also called a gateway MAC table data <b>210</b>.</p>
<p id="p-0044" num="0043">As shown in <figref idref="DRAWINGS">FIG. 2</figref>, the gateway device <b>21</b> acquires a first data packet <b>51</b><i>a </i>from the first Ethernet <b>3</b>, which is sent or forwarded by any one of the external devices <b>30</b> of the first Ethernet <b>3</b>. The gateway device <b>21</b> receives the first data packet <b>51</b><i>a </i>from the external device <b>30</b> adjacent to the gateway device <b>21</b>. Referring to <figref idref="DRAWINGS">FIG. 3</figref>, <figref idref="DRAWINGS">FIG. 3</figref> is a schematic view of packet structure conversion in a domain gateway control system according to an embodiment of the present invention. A packet structure of the first data packet <b>51</b><i>a</i>, as shown by a No. (<b>1</b>) structure in <figref idref="DRAWINGS">FIG. 3</figref>, includes a destination MAC field, a source MAC field, an Ethernet-type field and a data field.</p>
<p id="p-0045" num="0044">The gateway device <b>21</b> reads the destination MAC field of the first data packet <b>51</b><i>a</i>, performs MAC matching on the destination MAC field with the gateway MAC table data <b>210</b> thereof, and determines which device the destination MAC address data of the first data packet <b>51</b><i>a </i>points to. When the gateway device <b>21</b> determines that the destination MAC address data of the first data packet <b>51</b><i>a </i>is learned by the gateway device <b>21</b> and recorded in the gateway MAC table data <b>210</b>, the gateway device <b>21</b> reads the destination MAC address data and a communication port number data corresponding to the destination MAC address data from the gateway MAC table data <b>210</b>, and forwards the first data packet <b>51</b><i>a </i>from the communication port corresponding to the communication port number data.</p>
<p id="p-0046" num="0045">As shown in <figref idref="DRAWINGS">FIG. 2</figref>, it is assumed that the first data packet <b>51</b><i>a </i>is generated by a first external device <b>31</b>, the destination MAC address data is X<b>1</b>-X<b>1</b>-X<b>1</b>-X<b>1</b>-X<b>1</b>-X<b>1</b> (hexadecimal), the source MAC address data is A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b> (hexadecimal), the communication port number data recorded in the gateway MAC table data <b>210</b> that corresponds to the destination MAC address data (X<b>1</b>-X<b>1</b>-X<b>1</b>-X<b>1</b>-X<b>1</b>-X<b>1</b>) is port No. III, and the gateway device <b>21</b> forwards the first data packet <b>51</b><i>a </i>from a No. III communication port <b>213</b>. Before forwarding, the gateway device <b>21</b> learns the source MAC address data of the first data packet <b>51</b><i>a</i>. It is assumed that the gateway device <b>21</b> receives the first data packet <b>51</b><i>a </i>through a No. I communication port <b>211</b>, the gateway device <b>21</b> learns the source MAC address data of the first data packet <b>51</b><i>a </i>and records the source MAC address data and the communication port number data (A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>/No. I) in the gateway MAC table data <b>210</b>. Once the gateway device <b>21</b> has learned the source MAC address data, the gateway device <b>21</b> does not learn the source MAC address data repeatedly. The learning procedures of the following devices are the same as or similar to the above learning procedures, which are represented by &#x2018;learning&#x2019; hereinafter. Only the characteristics of the architecture of the system are illustrated, and in the embodiments, a content structure of a domain is illustrated through an appropriate architecture mode according to demands, and is not limited to the system architecture illustrated in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 4</figref> is a schematic view of a packet being forwarded to a domain in a domain gateway control system according to an embodiment of the present invention and refers to a No. (<b>2</b>) packet structure and a No. (<b>3</b>) packet structure in <figref idref="DRAWINGS">FIG. 3</figref>. Upon acquiring a first data packet <b>51</b><i>b</i>, the gateway device <b>21</b> analyzes the first data packet <b>51</b><i>b</i>. When the gateway device <b>21</b> determines that a destination MAC address data of the first data packet <b>51</b><i>b </i>points to the domain <b>2</b> governed by the gateway device <b>21</b>, or when the gateway device <b>21</b> must perform broadcasting to forward the first data packet <b>51</b><i>b </i>to the domain <b>2</b> because the gateway device <b>21</b> fails to know an exact destination MAC address data of the first data packet <b>51</b><i>b </i>from the gateway MAC table data <b>210</b>, the gateway device <b>21</b> converts the first data packet <b>51</b><i>b </i>in to a first domain packet <b>61</b> (in <figref idref="DRAWINGS">FIG. 4</figref>) according to the MAGP information. Two conversion modes are as follows.</p>
<p id="p-0048" num="0047">(1) Substitution. The gateway device <b>21</b> records the gateway MAC address data in the source MAC field of the first data packet <b>51</b><i>b </i>and records a domain type code data of the corresponding domain <b>2</b> in an Ethernet-type field of the first data packet <b>51</b><i>b. </i></p>
<p id="p-0049" num="0048">As shown in <figref idref="DRAWINGS">FIG. 4</figref>, it is assumed that the gateway device <b>21</b> is linked to the domain <b>2</b> through the No. III communication port <b>213</b>, and the domain type code data corresponding to the domain <b>2</b> is 0811 (hexadecimal), the source MAC address data of the first data packet <b>51</b><i>b </i>is equivalent to the source MAC address data of the first data packet <b>51</b><i>a</i>, that is A<b>1</b>-A-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>, the destination MAC address data of the first data packet <b>51</b><i>b </i>is D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b> (hexadecimal), and an Ethernet-type code data is 0800 (hexadecimal). When the gateway device <b>21</b> knows from the gateway MAC table data <b>210</b> that the destination MAC address data of the first data packet <b>51</b><i>b </i>points to the domain <b>2</b>, or when the first data packet <b>51</b><i>b </i>must be forwarded to the domain <b>2</b> in a broadcast manner, the gateway device <b>21</b> records the gateway MAC address data, that is G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b> (hexadecimal), in the source MAC field of the first data packet <b>51</b><i>b </i>and records the domain type code data 0811 (hexadecimal) in the Ethernet-type field of the first data packet <b>51</b><i>b</i>. The first data packet <b>51</b><i>b </i>is converted from the No. (<b>2</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 3</figref> into the No. (<b>3</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 3</figref>, thereby forming a first domain packet <b>61</b><i>a </i>(a packet format of the first domain packet <b>61</b>).</p>
<p id="p-0050" num="0049">(2) Insertion. The gateway device <b>21</b> inserts the gateway MAC address data and the domain type code data into the first data packet <b>51</b><i>b</i>, and an insertion position is between the destination MAC field and the source MAC field of the first data packet <b>51</b><i>b</i>, thereby forming a first domain packet <b>61</b><i>b </i>(also a packet format of the first domain packet <b>61</b>). A difference between the insertion mode and the update mode lies in that the original source MAC address data and the Ethernet-type code data of the first data packet <b>51</b><i>b </i>are regarded as data in a data field of the first domain packet <b>61</b><i>b</i>, and the data length of the first domain packet <b>61</b><i>b </i>is greater than the length of the first data packet <b>51</b><i>b</i>. In this embodiment, a read length of the data field is increased.</p>
<p id="p-0051" num="0050">The setting of a packet read length of the first domain packets (<b>61</b>, <b>61</b><i>a</i>, <b>61</b><i>b</i>) can be recorded in a header of the first domain packets (<b>61</b>, <b>61</b><i>a</i>, <b>61</b><i>b</i>), or in an executive system, firmware, or software of the net devices <b>22</b> and the gateway device <b>21</b> in the domain <b>2</b>. When it is preset to read the domain packet, the packet read length shall be used.</p>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 4</figref> is a schematic view of forwarding a packet to a domain in a domain gateway control system according to an embodiment of the present invention and refers to the No. (<b>2</b>) packet structure and the No. (<b>3</b>) packet structure in <figref idref="DRAWINGS">FIG. 3</figref>. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, it is assumed that the communication port through which the gateway device <b>21</b> is linked to the domain <b>2</b> is the No. III communication port <b>213</b>, the domain type code data corresponding to the domain <b>2</b> is 0811 (hexadecimal), and the structure of the first data packet <b>51</b><i>b </i>is as shown in <figref idref="DRAWINGS">FIG. 3</figref>. When the gateway device <b>21</b> knows from the gateway MAC table data <b>210</b> that the destination MAC address data of the first data packet <b>51</b><i>b </i>points to the domain <b>2</b>, or when the first data packet <b>51</b><i>b </i>must be forwarded to the domain <b>2</b> in a broadcast manner, the gateway device <b>21</b> inserts the gateway MAC address data, that is, G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b> (hexadecimal) and the domain type code data 0811 (hexadecimal) between the destination MAC field and the source MAC field of the first data packet <b>51</b><i>b</i>, and the original source MAC address data (A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>) and the Ethernet-type code data (0800) are regarded as data of the data field. The first data packet <b>51</b><i>b </i>is converted from the No. (<b>2</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 3</figref> into the No. (<b>4</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 3</figref>, thereby forming the first domain packet <b>61</b><i>b</i>. For convenience of description, the first domain packet <b>61</b><i>b </i>formed in an insertion mode is always used as an example below.</p>
<p id="p-0053" num="0052">The first domain packet <b>61</b><i>b </i>is transmitted to the domain <b>2</b>. Upon acquiring the first domain packet <b>61</b><i>b</i>, any net device <b>22</b> first determines whether a destination MAC address data of the first domain packet <b>61</b><i>b </i>points to a device MAC address data. If not, the net device <b>22</b> matches the destination MAC address data of the first domain packet <b>61</b><i>b </i>with the device MAC table data <b>220</b> to find a communication port corresponding to the destination MAC address data of the first domain packet <b>61</b><i>b </i>and use the communication port for forwarding. Accordingly, before forwarding, the net device <b>22</b> acquiring the first domain packet <b>61</b><i>b </i>also learns the source MAC address data of the first domain packet <b>61</b><i>b </i>to update the device MAC table data <b>220</b>. The first domain packet <b>61</b><i>b </i>is either an external data packet forwarded by the gateway device <b>21</b> or generated by the gateway device <b>21</b>. The source MAC address data of the first domain packet <b>61</b><i>b </i>is a gateway MAC address data, and the original source MAC address data is recorded in the data field of the first domain packet <b>61</b><i>b</i>. Therefore, in the a domain <b>2</b>, the net device <b>22</b> acquiring the first domain packet <b>61</b><i>b </i>does not learn the device MAC address data of the first external device <b>31</b>, A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>.</p>
<p id="p-0054" num="0053">As shown in <figref idref="DRAWINGS">FIG. 4</figref>, it is assumed that the MAC of a first net device <b>23</b> is D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>. The second net device <b>24</b> is linked to the No. III communication port <b>213</b> of the gateway device <b>21</b> through a No. I communication port <b>241</b> and is linked to a No. V communication port <b>235</b> of the first net device <b>23</b> through a No. IV communication port <b>244</b> respectively. A device MAC table data <b>224</b> included in the second net device <b>24</b> records the MAC of the first net device <b>23</b> and the communication port No. IV corresponding to the MAC.</p>
<p id="p-0055" num="0054">Upon acquiring the first domain packet <b>61</b><i>b</i>, the second net device <b>24</b> analyzes if the destination MAC address data is inconsistent with a device MAC address data and reads the device MAC table data <b>224</b> to learn that the first domain packet <b>61</b><i>b </i>shall be forwarded from the No. IV communication port <b>244</b>. Before forwarding, the second net device <b>24</b> learns the source MAC address data of the first domain packet <b>61</b><i>b</i>. Meanwhile, if the second net device <b>24</b> determines that the second net device <b>24</b> does not learn the source MAC address data of the first domain packet <b>61</b><i>b </i>(the gateway MAC address data G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>), the second net device <b>24</b> records the source MAC address data and the No. I communication port in the device MAC table data <b>224</b> of the second net device <b>24</b>.</p>
<p id="p-0056" num="0055">The first domain packet <b>61</b><i>b </i>is received by the No. V communication port <b>235</b> of the first net device <b>23</b>. The first net device <b>23</b> analyzes that the destination MAC address data of the first domain packet <b>61</b><i>b </i>matches the device MAC address data, and the first net device <b>23</b> learns the source MAC address data of the first domain packet <b>61</b><i>b </i>to update the device MAC table data <b>223</b>. Similarly, the source MAC address data learnt by the first net device <b>23</b> from the first domain packet <b>61</b><i>b </i>is also the gateway MAC address data. Furthermore, the first net device <b>23</b> acquires the domain type code data (0811) from the Ethernet-type field of the first domain packet <b>61</b><i>b</i>, and knows that the first domain packet <b>61</b><i>b </i>complies with the MAGP information, to find the original source MAC address data (the device MAC address data A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b> of the first external device <b>31</b>) in the data field of the first domain packet <b>61</b><i>b </i>and the Ethernet-type code data (0800) corresponding to the first Ethernet <b>3</b>. Alternatively, by using the MAGP information, The first data packet <b>61</b><i>b </i>is converted from the No. (<b>4</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 3</figref> into the No. (<b>2</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 3</figref>, the first domain packet <b>61</b><i>b </i>is recovered to the first data packet <b>51</b><i>b </i>for subsequent operations.</p>
<p id="p-0057" num="0056">Referring to <figref idref="DRAWINGS">FIG. 2</figref>, in this embodiment, the gateway device <b>21</b> is further linked to a second Ethernet <b>4</b>. When the gateway device <b>21</b> acquires a first data packet <b>51</b><i>c </i>from the first Ethernet <b>3</b>, and analyzes that a destination MAC address data of the first data packet <b>51</b><i>c </i>points to the second Ethernet <b>4</b>, the gateway device <b>21</b> forwards the first data packet <b>51</b><i>c </i>to the second Ethernet <b>4</b>.</p>
<p id="p-0058" num="0057">As shown in <figref idref="DRAWINGS">FIG. 2</figref>, for example, it is assumed that the second Ethernet <b>4</b> has a second external device <b>32</b>, the device MAC address data of the second external device <b>32</b> is B<b>1</b>-B<b>1</b>-B<b>1</b>-B<b>1</b>-B<b>1</b>-B<b>1</b>, the gateway device <b>21</b> is linked to the second external device <b>32</b> through a No. II communication port <b>212</b>, and the MAC B<b>1</b>-B<b>1</b>-B<b>1</b>-B<b>1</b>-B<b>1</b>-B<b>1</b> and the communication port No. II are made into pairs and recorded in the gateway MAC table data <b>210</b>.</p>
<p id="p-0059" num="0058">The gateway device <b>21</b> acquires the first data packet <b>51</b><i>c </i>from the first Ethernet <b>3</b>, and analyzes the destination MAC address data of the first data packet <b>51</b><i>c</i>. The gateway device <b>21</b> knows from the gateway MAC table data <b>210</b> that the destination MAC address data of the first data packet <b>51</b><i>c </i>is B<b>1</b>-B<b>1</b>-B<b>1</b>-B<b>1</b>-B<b>1</b>-B<b>1</b>, which points to the second Ethernet <b>4</b> rather than to the domain <b>2</b>. After learning the source MAC address data of the first data packet <b>51</b><i>c</i>, the gateway device <b>21</b> uses the No. II communication port <b>212</b> to forward the first data packet <b>51</b><i>c </i>to the second Ethernet <b>4</b>.</p>
<p id="p-0060" num="0059">Referring to <figref idref="DRAWINGS">FIG. 2</figref>, the gateway device <b>21</b> acquires a first data packet <b>51</b><i>d </i>from the first Ethernet <b>3</b> and analyzes the first data packet <b>51</b><i>d</i>. When the gateway device determines that the destination MAC address data of the first data packet <b>51</b><i>d </i>matches the gateway MAC address data, the gateway device <b>21</b> directly receives the first data packet <b>51</b><i>d</i>. Also, after learning the source MAC address data of the first data packet <b>51</b><i>d</i>, the gateway device <b>21</b> no longer forwards the first data packet <b>51</b><i>d. </i></p>
<p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. 5</figref> is a schematic view of sending out a domain packet in a domain gateway control system according to an embodiment of the present invention. In this embodiment, a second domain packet <b>62</b><i>a </i>is generated by any one of the net devices <b>22</b> in the domain, which complies with the domain sending out mode included in the MAGP information, that is, the destination MAC address data of the second domain packet <b>62</b><i>a </i>points to the gateway device <b>21</b>, the device MAC address data of the net device <b>22</b> generating the second domain packet <b>62</b><i>a </i>is recorded as the source MAC address data of the second domain packet <b>62</b><i>a</i>, the domain type code data is recorded in an Ethernet-type field of the second domain packet <b>62</b><i>a</i>, an off-net destination MAC address data and an Ethernet-type code data corresponding to an Ethernet are recorded in a data field of the second domain packet <b>62</b><i>a</i>, and in addition the off-net destination MAC address data is the device MAC address data of any one of the external devices <b>30</b>.</p>
<p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. 6</figref> is a schematic view of domain packet structure conversion in a domain gateway control system according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 5</figref> and <figref idref="DRAWINGS">FIG. 6</figref>, the first net device <b>23</b> generates the second domain packet <b>62</b><i>a</i>, and the destination MAC address data of the second domain packet <b>62</b><i>a </i>points to the gateway device <b>21</b>, that is, G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>. The source MAC address data of the second domain packet <b>62</b><i>a </i>is a device MAC address data of the first net device <b>23</b> (D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>). The off-net destination MAC address data is, by using a third external device <b>33</b> in the first Ethernet <b>3</b> as an example, the device MAC address data A<b>3</b>-A<b>3</b>-A<b>3</b>-A<b>3</b>-A<b>3</b>-A<b>3</b>. The device MAC address data of the third external device <b>33</b> and the Ethernet-type code data 0800 (hexadecimal) corresponding to the first Ethernet <b>3</b> are recorded in the data field of the second domain packet <b>62</b><i>a</i>, thereby forming the second domain packet <b>62</b><i>a </i>(No. (<b>1</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 6</figref>, which is also a packet format covered by the MAGP information).</p>
<p id="p-0063" num="0062">The first net device <b>23</b> transports the second domain packet <b>62</b><i>a </i>through the No. V communication port <b>235</b> according to the device MAC table data <b>223</b>. When any one of the net devices <b>22</b> acquires the second domain packet <b>62</b><i>a</i>, the net device <b>22</b> matches the destination MAC address data of the second domain packet <b>62</b><i>a </i>with the device MAC table data <b>220</b> to find a communication port corresponding to the destination MAC address data of the second domain packet <b>62</b><i>a </i>and uses the communication port for forwarding. Accordingly, before forwarding, the net device <b>22</b> acquiring the second domain packet <b>62</b><i>a </i>also learns the source MAC address data of the second domain packet <b>62</b><i>a </i>to update the device MAC table data <b>220</b>.</p>
<p id="p-0064" num="0063">As shown in <figref idref="DRAWINGS">FIG. 5</figref> and <figref idref="DRAWINGS">FIG. 6</figref>, for example, the second net device <b>24</b> acquires the second domain packet <b>62</b><i>a </i>through the No. IV communication port <b>244</b>, and analyzes if the destination MAC address data of the second domain packet <b>62</b><i>a </i>is different from the device MAC address data. The second net device <b>24</b> reads the device MAC table data <b>224</b> to know that the second domain packet <b>62</b><i>a </i>shall be forwarded from the No. I communication port <b>241</b>. Before forwarding, the second net device <b>24</b> also learns the source MAC address data of the second domain packet <b>62</b><i>a </i>to update the device MAC table data <b>224</b>.</p>
<p id="p-0065" num="0064">As shown in <figref idref="DRAWINGS">FIG. 5</figref> and <figref idref="DRAWINGS">FIG. 6</figref>, upon acquiring the second domain packet <b>62</b><i>a</i>, the gateway device <b>21</b> analyzes the second domain packet <b>62</b><i>a </i>to decide whether to forward the second domain packet <b>62</b><i>a</i>. If the gateway device <b>21</b> analyzes that the destination MAC address data of the second domain packet <b>62</b><i>a </i>matches the gateway MAC address data (G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>), the domain type code data (0811) is recorded in the Ethernet-type field of the second domain packet <b>62</b><i>a</i>, and the off-net destination MAC address data (the device MAC address data A<b>3</b>-A<b>3</b>-A<b>3</b>-A<b>3</b>-A<b>3</b>-A<b>3</b> of the third external device <b>33</b>) and the Ethernet-type code data (0800) of the corresponding first Ethernet <b>3</b> are recorded in the data field of the second domain packet <b>62</b><i>a</i>, the gateway device <b>21</b> confirms that the second domain packet <b>62</b><i>a </i>complies with a domain packet sending out format in the MAGP information.</p>
<p id="p-0066" num="0065">The gateway device <b>21</b> records the off-net destination MAC address data (A<b>3</b>-A<b>3</b>-A<b>3</b>-A<b>3</b>-A<b>3</b>-A<b>3</b>) in a destination MAC address data field of the second domain packet <b>62</b><i>a </i>again, and records the Ethernet-type code data (0800) in the Ethernet-type field of the second domain packet <b>62</b><i>a</i>. Alternatively, the gateway device <b>21</b> strips the original destination MAC field and Ethernet-type field of the second domain packet <b>62</b><i>a </i>and uses the off-net destination MAC address data and the Ethernet-type code data in the data field as data replacement. The second domain packet <b>62</b><i>a </i>is converted from the No. (<b>1</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 6</figref> into a No. (<b>2</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 6</figref> and thereby forms a second data packet <b>52</b>. Subsequently, the gateway device <b>21</b> forwards second data packet <b>52</b> to the first Ethernet <b>3</b>. Before converting the packet format, the gateway device <b>21</b> also learns the source MAC address data (D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>) of the second domain packet <b>62</b><i>a </i>to update the gateway MAC table data <b>210</b>.</p>
<p id="p-0067" num="0066">Refer to <figref idref="DRAWINGS">FIG. 5</figref> and <figref idref="DRAWINGS">FIG. 6</figref> for understanding a packet receiving mode. In this embodiment, the first net device <b>23</b> generates a second domain packet <b>62</b><i>b</i>, and the destination MAC address data of the second domain packet <b>62</b><i>b </i>points to the gateway device <b>21</b> (G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>). A source MAC address data of the second domain packet <b>62</b><i>b </i>is the device MAC address data of the first net device <b>23</b> (D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>). A difference from the aforementioned examples lies in that a data field of the second domain packet <b>62</b><i>b </i>does record any off-net destination MAC address data. That is to say, the second domain packet <b>62</b><i>b </i>is not transmitted to any Ethernet. In addition, the gateway device <b>21</b> is an intermediary device between the domain <b>2</b> and the Ethernet. The gateway device <b>21</b> has the capability of parsing a normal data packet and a domain packet dedicated to the domain <b>2</b>. Therefore, before any one of the net devices <b>22</b> in the domain <b>2</b> transmits data to the gateway device <b>21</b>, only a domain packet complying with a normal data packet protocol must be established (the MAGP information is not required). Therefore, in this embodiment, the second domain packet <b>62</b><i>b </i>established by the first net device <b>23</b> (a No. (<b>3</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 6</figref>) is an L2-network communication packet format.</p>
<p id="p-0068" num="0067">Upon acquiring the second domain packet <b>62</b><i>b</i>, the gateway device <b>21</b> analyzes the packet structure of the second domain packet <b>62</b><i>b </i>and data included in the second domain packet <b>62</b><i>b</i>. As shown in <figref idref="DRAWINGS">FIG. 5</figref> and <figref idref="DRAWINGS">FIG. 6</figref>, the gateway device <b>21</b> analyzes that the destination MAC address data of the second domain packet <b>62</b><i>b </i>matches the gateway MAC address data (G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>), and the data field of the second domain packet <b>62</b><i>b </i>does not record any off-net destination MAC address data, so the gateway device <b>21</b> confirms that the second domain packet <b>62</b><i>b </i>shall be received by the gateway device <b>21</b>. The gateway device <b>21</b> also learns the source MAC address data (D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>-D<b>1</b>) of the second domain packet <b>62</b><i>b </i>to update the gateway MAC table data <b>210</b>.</p>
<p id="p-0069" num="0068"><figref idref="DRAWINGS">FIG. 7</figref> is a schematic view of a cache MAC table data and an application in a domain gateway control system according to an embodiment of the present invention. A difference from the aforementioned embodiments lies in that each net device <b>22</b> in the domain is configured with a cache MAC table data <b>225</b>, which is used to record a MAC of an actual sender of a domain packet.</p>
<p id="p-0070" num="0069">The embodiment shown in <figref idref="DRAWINGS">FIG. 4</figref> and the No. (<b>4</b>) packet structure shown in <figref idref="DRAWINGS">FIG. 3</figref> are applied in this embodiment. The first domain packet <b>61</b><i>b </i>generated by the gateway device <b>21</b> (in the insertion mode) is transmitted in the domain <b>2</b>. When any one of the net devices <b>22</b> acquires the first domain packet <b>61</b><i>b </i>and determines that the destination MAC address data of the first domain packet <b>61</b><i>b </i>points to the net device <b>22</b>, besides learning the source MAC address data of the first domain packet <b>61</b><i>b</i>, the net device <b>22</b> also makes a pair of the original source MAC address data recorded in the data field of the first domain packet <b>61</b><i>b </i>and the communication port No. of the communication port receiving the first domain packet <b>61</b><i>b </i>and records the pair in the cache MAC table data <b>225</b> of the net device <b>22</b>. For ease of illustration, the cache MAC table data of the first net device <b>23</b> is numbered <b>226</b>, and the cache MAC table data of the second net device <b>24</b> is numbered <b>227</b>.</p>
<p id="p-0071" num="0070">As shown in <figref idref="DRAWINGS">FIG. 7</figref>, upon acquiring the first domain packet <b>61</b><i>b</i>, the second net device <b>24</b> learns the source MAC address data (G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>) of the first domain packet <b>61</b><i>b </i>to update the device MAC table data <b>224</b>. But the destination MAC address data of the first domain packet <b>61</b><i>b </i>is not directed to the second net device <b>24</b>, so the second net device <b>24</b> forwards the first domain packet <b>61</b><i>b </i>and does not analyze data in the data field of the first domain packet <b>61</b><i>b </i>nor does it record the original data (the device MAC address data of the first external device <b>31</b>: A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>) in the cache MAC table data <b>227</b>.</p>
<p id="p-0072" num="0071">Upon acquiring the first domain packet <b>61</b><i>b</i>, the first net device <b>23</b> learns the source MAC address data (G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>-G<b>1</b>) of the first domain packet <b>61</b><i>b </i>to update the device MAC table data <b>223</b>. However, when the first net device <b>23</b> analyzes the destination MAC address data of the first domain packet <b>61</b><i>b</i>, and determines that first net device <b>23</b> shall receive the first domain packet <b>61</b><i>b</i>, the first net device <b>23</b> retrieves the original source MAC address data from the data field of the first domain packet <b>61</b><i>b</i>; that is, the device MAC address data A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b> of the first external device <b>31</b>, makes a pair of the device MAC address data and the communication port No. V and records the pair (A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>/No. V) in the cache MAC table data <b>226</b>.</p>
<p id="p-0073" num="0072">When the first net device <b>23</b> needs to communicate with the first external device <b>31</b>, the first net device <b>23</b> can use the cache MAC table data <b>226</b> to generate a packet with a destination MAC address data being A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b> and immediately know that the packet must be outputted through the No. V communication port <b>235</b>. Both a normal data packet format and a domain packet format dedicated to the domain (complying with the MAGP information) are applicable. So, the packet forwarding process is expedited.</p>
<p id="p-0074" num="0073">Similarly, when the second net device <b>24</b> acquires the packet with the destination MAC address data A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>, the second net device <b>24</b> also reads the cache MAC table data <b>227</b> of the second net device <b>24</b>. But when the cache MAC table data <b>227</b> does not record a communication port number data corresponding to the A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>, the second net device <b>24</b> uses the device MAC table data <b>224</b> to determine which communication port number data shall be used to output the packet through a relevant communication port. In addition, when the device MAC table data <b>224</b> does not record the communication port number data corresponding to A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>, the second net device <b>24</b> outputs the packet in a broadcast manner or according to a packet transmission rule, in which the packet transmission rule of the second net device <b>24</b> is established in advance by network management personnel.</p>
<p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. 8</figref> is a schematic flow chart of a domain gateway control method according to an embodiment of the present invention. Refer to <figref idref="DRAWINGS">FIG. 2</figref> to <figref idref="DRAWINGS">FIG. 7</figref> for following illustration of the processes. The method is applicable to the gateway device <b>21</b> as shown in <figref idref="DRAWINGS">FIG. 2</figref>. The gateway device <b>21</b> is configured at an interface of the domain <b>2</b>, and is linked to the first Ethernet <b>3</b>, and the process is illustrated below.</p>
<p id="p-0076" num="0075">A first data packet is acquired from a first Ethernet (Step S<b>110</b>). As shown in <figref idref="DRAWINGS">FIG. 4</figref>, the first data packet <b>51</b><i>b </i>(as shown by the No. (<b>2</b>) structure in <figref idref="DRAWINGS">FIG. 3</figref>) is sent or forwarded by any one of the external devices <b>30</b> of the first Ethernet <b>3</b>. Here, the first external device <b>31</b> is an example. The gateway device <b>21</b> receives the first data packet <b>51</b><i>b </i>from an external device <b>30</b> adjacent to the gateway device <b>21</b>.</p>
<p id="p-0077" num="0076">The destination MAC address data of the first data packet is analyzed (Step S<b>120</b>). The gateway device <b>21</b> reads the destination MAC field of the first data packet <b>51</b><i>b</i>, matches the destination MAC field with the gateway MAC table data <b>210</b>, and determines which device the destination MAC address data of the first data packet <b>51</b><i>b </i>points to.</p>
<p id="p-0078" num="0077">When a gateway device determines that the destination MAC address data of the first data packet points to a domain, the gateway device uses an MAGP information to convert the first data packet into the first domain packet, and forwards the first domain packet to the domain (Step S<b>131</b>). In Step <b>131</b>, when the gateway device <b>21</b> determines that the destination MAC address data of the first data packet <b>51</b><i>b </i>points to the domain <b>2</b> governed by the gateway device <b>21</b>, or when the gateway device <b>21</b> determines that the first data packet <b>51</b><i>b </i>must be forwarded into the domain in a broadcast manner, the gateway device <b>21</b> converts the first data packet <b>51</b><i>b </i>into the first domain packet <b>61</b> according to the MAGP information. The two conversion modes are as follows: (1) substitution and (2) insertion. The two conversion modes are already described in detail in the embodiments of the packet structure conversion in <figref idref="DRAWINGS">FIG. 3</figref> and in the embodiment of forwarding a packet to a domain in the domain gateway control system in <figref idref="DRAWINGS">FIG. 4</figref>, and are not repeated here.</p>
<p id="p-0079" num="0078">When the gateway device determines that the destination MAC address data of the first data packet points to a second Ethernet, the gateway device forwards the first data packet to the second Ethernet (Step S<b>132</b>). Referring to <figref idref="DRAWINGS">FIG. 2</figref>, upon acquiring the first data packet <b>51</b><i>c</i>, the gateway device <b>21</b> analyzes the destination MAC address data of the first data packet <b>51</b><i>c</i>. After learning the source MAC address data of the first data packet <b>51</b><i>c</i>, the gateway device <b>21</b> uses the No. II communication port <b>212</b> to forward the first data packet <b>51</b><i>c </i>to the second Ethernet <b>4</b> according to records in the gateway MAC table data <b>210</b>.</p>
<p id="p-0080" num="0079">When the gateway device determines that the destination MAC address data of the first data packet points to the gateway device, the gateway device receives the first data packet (Step S<b>133</b>). Referring to <figref idref="DRAWINGS">FIG. 2</figref>, when the gateway device <b>21</b> acquires the first data packet <b>51</b><i>d </i>from the first Ethernet <b>3</b> and determines that the destination MAC address data of the first data packet <b>51</b><i>d </i>matches the gateway MAC address data, the gateway device <b>21</b> directly receives the first data packet <b>51</b><i>d </i>and no longer forwards the first data packet <b>51</b><i>d. </i></p>
<p id="p-0081" num="0080">After the learning procedure is applied in the gateway device to acquire and analyze the first data packet, a learning procedure of a gateway device is processed. The gateway device <b>21</b> learns the source MAC address data of the first data packets (<b>51</b><i>a</i>, <b>51</b><i>b</i>, <b>51</b><i>c</i>, <b>51</b><i>d</i>). The gateway device <b>21</b> makes pairs of the communication port Nos. of the communication ports receiving the first data packets (<b>51</b><i>a</i>, <b>51</b><i>b</i>, <b>51</b><i>c</i>, <b>51</b><i>d</i>) and the source MAC address data, and then records the pairs in the gateway MAC table data <b>210</b>.</p>
<p id="p-0082" num="0081"><figref idref="DRAWINGS">FIG. 9</figref> is a schematic flow chart of sending out a domain packet in a domain gateway control method according to the present invention. The process of sending out a domain packet includes the following steps:</p>
<p id="p-0083" num="0082">A gateway device acquires a second domain packet from a domain (S<b>31</b>). As shown in <figref idref="DRAWINGS">FIG. 5</figref> and <figref idref="DRAWINGS">FIG. 6</figref>, the second domain packet <b>62</b><i>a </i>generated by any one of the net devices <b>22</b> in the domain <b>2</b> has the No. (<b>1</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 6</figref>. Alternatively, the second domain packet <b>62</b><i>b </i>generated by any one of the net devices <b>22</b> in the domain <b>2</b> has the No. (<b>2</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 6</figref>. The illustration of the architectures is provided in detail before, and is not repeated here.</p>
<p id="p-0084" num="0083">The gateway device analyzes the second domain packet to decide whether to forward the second domain packet (Step S<b>32</b>), and the step includes the following multiple analysis results.</p>
<p id="p-0085" num="0084">(1) When the gateway device determines that the destination MAC address data of the second domain packet points to the gateway device, and a data field of the second domain packet does not include an off-net destination MAC address data, the gateway device receives the second domain packet (Step S<b>321</b>). As shown in <figref idref="DRAWINGS">FIG. 6</figref> and <figref idref="DRAWINGS">FIG. 5</figref>, the data field of the second domain packet <b>62</b><i>b </i>does not record any off-net destination MAC address data so that the gateway device <b>21</b> determines that the gateway device <b>21</b> shall receive the second domain packet <b>62</b><i>b. </i></p>
<p id="p-0086" num="0085">(2) When the gateway device determines that the destination MAC address data of the second domain packet points to the gateway device, and the data field of the second domain packet includes an off-net destination MAC address data that points to a first Ethernet and an Ethernet-type code data corresponds to the first Ethernet, the gateway device updates the destination MAC address data field of the second domain packet with the off-net destination MAC address data and updates an Ethernet-type field of the second domain packet with the Ethernet-type code data to convert the second domain packet into a second data packet and forward the second data packet to the first Ethernet (Step S<b>322</b>).</p>
<p id="p-0087" num="0086">When the gateway device <b>21</b> analyzes and confirms that the second domain packet <b>62</b><i>a </i>complies with the sending out format of a domain packet in the MAGP information, the gateway device <b>21</b> converts the second domain packet <b>62</b><i>a </i>from the No. (<b>1</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 6</figref> into the No. (<b>2</b>) packet structure as shown in <figref idref="DRAWINGS">FIG. 6</figref>, and forwards the second data packet <b>52</b> to the first Ethernet <b>3</b>. Details are shown in <figref idref="DRAWINGS">FIG. 5</figref> and <figref idref="DRAWINGS">FIG. 6</figref>, and are not repeated herein.</p>
<p id="p-0088" num="0087">Moreover, a net device learning a device MAC address data in a domain gateway control method is processed. Any net device acquires a first domain packet, and the net device is configured in a domain. The net device makes a pair of the source MAC address data of the first domain packet and the communication port number data of the communication port receiving the first domain packet, and records the pair in a device MAC table data of the net device.</p>
<p id="p-0089" num="0088">As shown in <figref idref="DRAWINGS">FIG. 3</figref> and <figref idref="DRAWINGS">FIG. 4</figref>, when the second net device <b>24</b> analyzes that the destination MAC address data of the first domain packet <b>61</b><i>b </i>is different from the device MAC address data, the second net device <b>24</b> reads the device MAC table data <b>224</b> to learn that the first domain packet <b>61</b><i>b </i>shall be forwarded from the No. IV communication port <b>244</b>. Before forwarding, the second net device <b>24</b> determines whether the source MAC address data of the first domain packet <b>61</b><i>b </i>exists in the device MAC table data <b>224</b> to decide whether to learn the source MAC address data of the first domain packet <b>61</b><i>b. </i></p>
<p id="p-0090" num="0089">However, in the process, a cache MAC table data of a net device may also be further established. The net device further makes a pair of the original source MAC address data and the communication port number data of the communication port receiving the first domain packet and records the pair in the cache MAC table data of the net device.</p>
<p id="p-0091" num="0090">As shown in <figref idref="DRAWINGS">FIG. 7</figref>, upon acquiring the first domain packet <b>61</b><i>b</i>, the second net device <b>24</b> gets the original source MAC address data (A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>-A<b>1</b>) from the data field of the first domain packet <b>61</b><i>b</i>, makes a pair of the device MAC address data and the communication port No. I, and records the pair in the cache MAC table data <b>227</b>.</p>
<p id="p-0092" num="0091"><figref idref="DRAWINGS">FIG. 10</figref> is a flow chart of a net device forwarding a packet in a domain gateway control method according to the present invention. The packet forwarding process includes the following steps.</p>
<p id="p-0093" num="0092">Any net device analyzes the destination MAC address data of the first domain packet (Step S<b>51</b>). When the net device determines that the destination MAC address data of the first domain packet points to the net device, the net device receives the first domain packet (Step S<b>52</b>). When the net device determines that the destination MAC address data of the first domain packet is not directed to the net device, the net device forwards the first domain packet (Step S<b>53</b>). The descriptions of the packet forwarding process have been previously disclosed according to the <figref idref="DRAWINGS">FIG. 3</figref> and <figref idref="DRAWINGS">FIG. 4</figref> and will not be repeated here.</p>
<p id="p-0094" num="0093"><figref idref="DRAWINGS">FIG. 11</figref> is a flow chart of a net device establishing a data packet to be sent out in a domain gateway control method according to the present invention. The process of sending out a data packet includes the following steps.</p>
<p id="p-0095" num="0094">Any net device generates a data packet to be sent out (Step S<b>71</b>). The net device reads a cache MAC table data to acquire an original source MAC address data and a communication port number data corresponding to the original source MAC address data (Step S<b>72</b>). The net device records the original source MAC address data in a destination MAC address data of the data packet to be sent out (Step S<b>73</b>). The net device outputs the data packet to be sent out (Step S<b>74</b>). The descriptions of the packet forwarding process have been previously disclosed according to the <figref idref="DRAWINGS">FIG. 7</figref> and will not be repeated here.</p>
<p id="p-0096" num="0095"><figref idref="DRAWINGS">FIG. 12</figref> is a schematic logic diagram of an operation of a gateway device in a domain gateway control system according to the present invention. According to the aforementioned embodiments, the operation forms of the gateway device <b>21</b> include multiple rules such as packet reception, packet source MAC address data learning and packet forwarding determination. The rules may be designed in operation firmware of the gateway device <b>21</b>, and the gateway device operates according to the rules in combination with the MAGP information. A logic operation process of the gateway device <b>21</b> is as follows.</p>
<p id="p-0097" num="0096">The gateway device <b>21</b> analyzes whether a received packet points to the gateway MAC address data (Step S<b>801</b>). The gateway device <b>21</b> reads the destination MAC address data field and the data field of the packet to know exactly which device the packet is actually directed to.</p>
<p id="p-0098" num="0097">When the packet is actually directed to the gateway device <b>21</b>, the gateway device <b>21</b> determines whether the packet complies with the MAGP information (Step S<b>802</b>) to decide whether to update the gateway MAC table data <b>210</b>, removes data related to the MAGP information from the packet, and performs relevant subsequent operations (Step S<b>803</b>), or directly performs relevant subsequent operations after the gateway MAC table data <b>210</b> is updated (Step S<b>804</b>).</p>
<p id="p-0099" num="0098">When the packet is not directed to the gateway device <b>21</b>, the gateway device <b>21</b> also determines whether the packet complies with the MAGP information (Step S<b>805</b>).</p>
<p id="p-0100" num="0099">When the gateway device <b>21</b> determines that the packet complies with the MAGP information, the gateway device <b>21</b> analyzes whether the packet points to the domain <b>2</b> governed by the gateway device <b>21</b> (Step S<b>806</b>). If the packet points to the domain <b>2</b> controlled by the gateway device <b>21</b>, the gateway device <b>21</b> learns the source MAC address data of the packet to update the gateway MAC table data <b>210</b>, and forwards the packet to the domain <b>2</b> (Step S<b>807</b>). On the contrary, if the packet is not directed to the domain <b>2</b> controlled by the gateway device <b>21</b> and the gateway device <b>21</b> determines that the packet points to an Ethernet linked to the gateway device <b>21</b>, the gateway device <b>21</b> also learns the source MAC address data of the packet to update the gateway MAC table data <b>210</b>, removes the data related to the MAGP information from the packet to convert the packet into a normal net packet, and forwards the net packet to the Ethernet (Step S<b>808</b>).</p>
<p id="p-0101" num="0100">After Step S<b>805</b>, when the gateway device <b>21</b> determines that the packet does not comply with the MAGP information, the gateway device <b>21</b> analyzes whether the packet points to the domain <b>2</b> governed by the gateway device <b>21</b> (Step S<b>809</b>).</p>
<p id="p-0102" num="0101">If the packet points to the domain <b>2</b> controlled by the gateway device <b>21</b>, the gateway device <b>21</b> learns the source MAC address data of the packet and updates the gateway MAC table data <b>210</b>, inserts data relevant to the MAGP information into the packet, and forwards the packet into the domain (Step S<b>810</b>). On the contrary, if the packet is not directed to the domain <b>2</b> controlled by the gateway device <b>21</b> and the gateway device <b>21</b> determines that the packet is still directed to an Ethernet linked to the gateway device <b>21</b>, the gateway device <b>21</b> also learns the source MAC address data of the packet to update the gateway MAC table data <b>210</b>, and forwards the packet to the Ethernet linked to the gateway device <b>21</b> (Step S<b>811</b>).</p>
<p id="p-0103" num="0102"><figref idref="DRAWINGS">FIG. 13</figref> is a schematic logic diagram of an operation of a net device in a domain gateway control system according to the present invention. According to the aforementioned embodiments, operation functions of the net device <b>22</b> include multiple rules such as packet reception, packet source MAC address data learning, and packet forwarding determination. The rules may be designed in operation firmware of the net device <b>22</b>, and the net device <b>22</b> operates according to the rules in combination with the MAGP information. A logic operation process of the net device <b>22</b> is as follows.</p>
<p id="p-0104" num="0103">The net device <b>22</b> analyzes whether a received packet points to a device MAC address data (Step S<b>901</b>). When the packet is not directed to the net device <b>22</b>, the net device <b>22</b> learns the source MAC address data of the packet to update the device MAC table data <b>220</b>, and forwards the packet into the domain <b>2</b> (Step S<b>902</b>).</p>
<p id="p-0105" num="0104">On the contrary, when the packet points to the net device <b>22</b>, the net device <b>22</b> determines if the packet complies with the MAGP information (Step S<b>903</b>) to decide whether to update the device MAC table data <b>220</b>, removes data related to the MAGP information from the packet, and performs relevant subsequent operations (Step S<b>904</b>), or directly performs relevant subsequent operations after the device MAC table data <b>220</b> is updated (Step S<b>905</b>).</p>
<p id="p-0106" num="0105">However, the net device <b>22</b> is a general name of the devices in the domain <b>2</b>, and includes the first net device <b>23</b> and the second net device <b>24</b>, which are otherwise named only for convenience of illustration. Similarly, the external devices <b>30</b> is a general name of the devices in the first Ethernet and the second Ethernet, and includes the first external device <b>31</b>, the second external device <b>32</b> and the third external device <b>33</b>, which are otherwise named only for convenience of illustration.</p>
<p id="p-0107" num="0106">In view of the above, the implementation or embodiments of the technical solutions presented by the present invention to solve the problems are described here, but the scope of implementation of the present invention is not limited to the described embodiments. Equivalent variations and modifications in accordance with the claims of the present invention or made according to the claims of the present invention shall fall within the claims of the present invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A domain gateway control system, comprising:
<claim-text>a domain, wherein a first domain packet is transmitted in the domain, and a domain type code data corresponding to the domain is recorded in an Ethernet-type field of the first domain packet; and</claim-text>
<claim-text>a gateway device, configured at an interface of the domain and linked to an Ethernet, wherein the gateway device is used to acquire a first data packet from the Ethernet and analyze a destination MAC (media access control) address data of the first data packet;</claim-text>
<claim-text>when the gateway device determines that the destination MAC address data of the first data packet points to the domain, the gateway device converts the first data packet into a first domain packet by using a MAC Address Group Protocol information, and forwards the first domain packet to the domain; and the MAC Address Group Protocol information comprises: a recorded gateway MAC address data of the gateway device in a source MAC field of the first data packet, and the recorded domain type code data in an Ethernet-type field of the first data packet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The domain gateway control system according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the gateway device comprises a gateway MAC table data, the gateway device learns a source MAC address data of the first data packet and records a communication port number data of communication port receiving the source MAC address data in the gateway MAC table data.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The domain gateway control system according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the gateway device is used to acquire a second domain packet transmitted in the domain, and the gateway device analyzes a destination MAC address data of the second domain packet to decide whether to forward the second domain packet.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The domain gateway control system according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the gateway device receives the second domain packet when the gateway device determines that the destination MAC address data of the second domain packet points to the gateway device, and a data field of the second domain packet does not include an off-net destination MAC address data.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The domain gateway control system according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein when the destination MAC address data of the second domain packet points to the gateway device and a data field of the second domain packet comprises an off-net destination MAC address data directed to the Ethernet and an Ethernet-type code data corresponding to the Ethernet, the gateway device updates a destination MAC address data field of the second domain packet with the off-net destination MAC address data and updates an Ethernet-type field of the second domain packet with the Ethernet-type code data, to convert the second domain packet into a second data packet and forward the second data packet to the Ethernet.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The domain gateway control system according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein any net device is configured in the domain and the net device comprises a device MAC table data, and the net device acquires a first domain packet and makes a pair of the source MAC address data of the first domain packet and the communication port number data of the communication port receiving the first domain packet, and records the pair in a device MAC table data of the net device.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The domain gateway control system according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the MAC Address Group Protocol information further comprises a recorded Ethernet-type code data corresponding to the Ethernet and an original source MAC address data in the data field of the first data packet, and the original source MAC address data is a MAC of an external device configured in the Ethernet.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The domain gateway control system according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein any net device configured in the domain comprises a cache MAC table data, the net device is used to acquire the first domain packet, make a pair of the original source MAC address data and communication port number data of a communication port receiving the first domain packet, and record the pair in the cache MAC table data.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The domain gateway control system according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the net device generates a data packet to be sent out according to the cache MAC table data, records the original source MAC address data in a destination MAC address data of the data packet to be sent out, and outputs the data packet to be sent out through the communication port corresponding to the original source MAC address data.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A domain gateway control method, applied in a gateway device, wherein the gateway device is configured at an interface of a domain and is linked to an Ethernet, and the domain gateway control method comprises:
<claim-text>acquiring a first data packet from the Ethernet; and</claim-text>
<claim-text>analyzing a destination MAC (media access control) address data of the first data packet through the gateway device; and</claim-text>
<claim-text>when the gateway device determine that the destination MAC address data of the first data packet points to the domain, using a MAC Address Group Protocol information to convert the first data packet into a first domain packet, forwarding the first domain packet to the domain, wherein the MAC Address Group Protocol information comprises: a recorded gateway MAC address data of the gateway device in a source MAC field of the first data packet, and a recorded domain type code data corresponding to the domain in an Ethernet-type field of the first data packet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The domain gateway control method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein:
<claim-text>when a gateway device determines that the destination MAC address data of the first data packet points to a second Ethernet, the gateway device uses an MAGP information to convert the first data packet into the first domain packet, and forwards the first domain packet to the second Ethernet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The domain gateway control method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein:
<claim-text>when the gateway device determines that the destination MAC address data of the first data packet points to a second Ethernet, the gateway device forwards the first data packet to the second Ethernet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The domain gateway control method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein:
<claim-text>when the gateway device determines that the destination MAC address data of the first data packet points to the gateway device, the gateway device receives the first data packet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The domain gateway control method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, further comprising:
<claim-text>acquiring a second domain packet from the domain; and</claim-text>
<claim-text>analyzing the second domain packet to decide whether to forward the second domain packet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The domain gateway control method according to <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein:
<claim-text>when the gateway device determines that the destination MAC address data of the second domain packet points to the gateway device, and the data field of the second domain packet includes an off-net destination MAC address data that points to a first Ethernet and an Ethernet-type code data corresponds to the first Ethernet, the gateway device updates the destination MAC address data field of the second domain packet with the off-net destination MAC address data and updates an Ethernet-type field of the second domain packet with the Ethernet-type code data to convert the second domain packet into a second data packet and forward the second data packet to the first Ethernet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The domain gateway control method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, further comprising:
<claim-text>acquiring, by any net device, the first domain packet, wherein the net device is configured in the domain; and</claim-text>
<claim-text>making a pair, by the net device, of a source MAC address data of the first domain packet and communication port number data of a communication port receiving the first domain packet, and recording the pair in a device MAC table data of the net device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The domain gateway control method according to <claim-ref idref="CLM-00016">claim 16</claim-ref>, further comprising:
<claim-text>analyzing the destination MAC address data of the first domain packet by any net device;</claim-text>
<claim-text>receiving the first domain packet by the net device when determining that the destination MAC address data of the first domain packet points to the net device; and</claim-text>
<claim-text>forwarding the first domain packet by the net device when determining that the destination MAC address data of the first domain packet is not directed to the net device, the net device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The domain gateway control method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the MAC Address Group Protocol information further comprises a recorded Ethernet-type code data corresponding to the Ethernet and an original source MAC address data in a data field of the first data packet, and the original source MAC address data is a MAC of an external device configured in the Ethernet.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The domain gateway control method according to <claim-ref idref="CLM-00018">claim 18</claim-ref>, further comprising:
<claim-text>acquiring, by any net device, the first domain packet, wherein the net device is configured in the domain; and</claim-text>
<claim-text>making a pair, by the net device, of an original source MAC address data and communication port number data of a communication port receiving the first domain packet, and recording the pair in a cache MAC table data of the net device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The domain gateway control method according to <claim-ref idref="CLM-00019">claim 19</claim-ref>, further comprising:
<claim-text>generating a data packet to be sent out by any net device;</claim-text>
<claim-text>reading a cache MAC table data to acquire an original source MAC address data and a communication port number data corresponding to the original source MAC address data by the net device;</claim-text>
<claim-text>recording the original source MAC address data in a destination MAC address data of the data packet to be sent out by the net device; and</claim-text>
<claim-text>outputting the data packet to be sent out by the net device. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
