<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625008-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625008</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13302545</doc-number>
<date>20111122</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2010-266975</doc-number>
<date>20101130</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>56</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>5</main-group>
<subgroup>202</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>5</main-group>
<subgroup>20</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>348254</main-classification>
<further-classification>348255</further-classification>
</classification-national>
<invention-title id="d2e71">Image processing apparatus having luminance-type gamma correction circuit capable of changing nonlinear characteristic, and image processing method therefor</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>7474303</doc-number>
<kind>B2</kind>
<name>Shin et al.</name>
<date>20090100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345204</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2005/0219259</doc-number>
<kind>A1</kind>
<name>Gonsalves et al.</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345593</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2005/0276471</doc-number>
<kind>A1</kind>
<name>Shin et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382162</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2006/0158564</doc-number>
<kind>A1</kind>
<name>Miyazawa</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>348650</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2009/0033682</doc-number>
<kind>A1</kind>
<name>Kaida et al.</name>
<date>20090200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345634</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2009/0290068</doc-number>
<kind>A1</kind>
<name>Abe et al.</name>
<date>20091100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>348649</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>JP</country>
<doc-number>2001045308</doc-number>
<kind>A</kind>
<date>20010200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>4</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>348234</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>348242</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>348253</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>348254</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>348674</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>348675</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>348687</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>348385</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>348519</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382169</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382274</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>345 83- 98</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>345204-215</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>345600</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>345690-699</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>9</number-of-drawing-sheets>
<number-of-figures>9</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120133806</doc-number>
<kind>A1</kind>
<date>20120531</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Hisa</last-name>
<first-name>Kenzo</first-name>
<address>
<city>Inagi</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Hisa</last-name>
<first-name>Kenzo</first-name>
<address>
<city>Inagi</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Rossi, Kimms &#x26; McDowell LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Canon Kabushiki Kaisha</orgname>
<role>03</role>
<address>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Ho</last-name>
<first-name>Tuan</first-name>
<department>2664</department>
</primary-examiner>
<assistant-examiner>
<last-name>Nguyen</last-name>
<first-name>Chan</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An image processing apparatus is provided in which, even if a nonlinear characteristic of a luminance-type gamma correction circuit for converting a luminance signal is changed, saturation with respect to a luminance output can be nearly constant. A signal amount of the luminance signal generated from image data that exceeds a previously defined threshold is calculated. A first nonlinear characteristic is selected from a plurality of nonlinear characteristics previously set depending on the calculated signal amount. Nonlinear conversation is performed on a signal generated from the image data to determine luminance with the selected first nonlinear characteristic. An output ratio of the first nonlinear characteristic to a second nonlinear characteristic is prepared and the second nonlinear characteristic is defined so that the output ratio is satisfied. Nonlinear conversion is performed on a signal that has been generated from the image data to determine saturation with the selected second nonlinear characteristic.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="172.80mm" wi="267.46mm" file="US08625008-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="266.45mm" wi="186.61mm" orientation="landscape" file="US08625008-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="242.91mm" wi="166.37mm" orientation="landscape" file="US08625008-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="274.83mm" wi="155.45mm" orientation="landscape" file="US08625008-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="227.75mm" wi="180.68mm" orientation="landscape" file="US08625008-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="205.91mm" wi="172.30mm" orientation="landscape" file="US08625008-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="275.67mm" wi="163.91mm" orientation="landscape" file="US08625008-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="271.44mm" wi="194.99mm" orientation="landscape" file="US08625008-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="266.45mm" wi="161.37mm" orientation="landscape" file="US08625008-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="137.84mm" wi="149.61mm" file="US08625008-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates to an image processing apparatus having a luminance-type gamma correction circuit capable of changing a nonlinear characteristic, and an image processing method therefor, and more particularly, to an image processing apparatus in which a variation of saturation occurring when the nonlinear characteristic of the luminance-type gamma correction circuit is changed is suppressed and an image processing method therefor.</p>
<p id="p-0004" num="0003">2. Description of the Related Art</p>
<p id="p-0005" num="0004">In an image pickup apparatus such as a digital video camera, image processing is performed for an output signal from an image pickup element to generate a video, then the video is outputted to a monitor or the like. Since the monitor has a gamma characteristic, an image processor of performing the image processing includes a gamma correction circuit for correcting the gamma characteristic of the monitor. Here, when correction of an inverse gamma characteristic of the monitor is performed with respect to a luminance signal, the luminance signal of the monitor output video generally linearly varies with respect to an incident light.</p>
<p id="p-0006" num="0005">However, in a state with an appropriate exposure, when the correction is performed with the inverse gamma characteristic of the monitor, a dynamic range becomes low, and over exposure occurs in relatively-low luminance parts of a high-luminance portion. This does not cause a problem for a low-contrast subject, but does cause a problem of increasing over exposure parts in a video of the high-luminance portion when a contrast becomes high. Consequently, there is known a method of setting a slope of a nonlinear characteristic in the gamma correction of the high-luminance portion to be smaller than that of the inverse gamma characteristic of the monitor, and furthermore giving a gradation to a signal of the high-luminance portion. According to this method, while a gradation expression in the high-luminance portion becomes low, a video having higher luminance can be expressed.</p>
<p id="p-0007" num="0006">However, if a color-difference signal is generated by using a signal processed with such a nonlinear characteristic, a shift occurs with respect to the inverse gamma characteristic of the monitor, and thus a hue shift occurs. Consequently, there is a proposed approach in which gamma correction circuits for luminance and for color are separately provided, and a luminance signal and a color signal are generated from signals corrected with different nonlinear characteristics.</p>
<p id="p-0008" num="0007">Moreover, an approach for generating an output signal obtained by the gamma correction of the color signal, with the number of bits larger than that of an output signal obtained by the gamma correction of the luminance signal has been invented (see Japanese Laid-Open Patent Publication (Kokai) No. 2001-45308). In this method, since the color signal is generated with a signal that is not suppressed in the high-luminance portion, a color shift or decolorization in the high-luminance portion is improved.</p>
<p id="p-0009" num="0008">Furthermore, there is a known approach for detecting a signal amount of the high-luminance portion in the video, and changing gradation of the high-luminance portion depending on the detected signal amount. In this approach, the nonlinear characteristic for the gamma correction for the luminance is varied depending on the signal amount of the high-luminance portion. For example, if the signal amount of the high-luminance portion is large, the slope of the high-luminance portion is decreased in a property of the gamma correction. However, instead of it, the gradation expression is performed for a further higher-luminance portion.</p>
<p id="p-0010" num="0009">In the above described approach for changing the gradation of the high-luminance portion depending on the signal amount of the high-luminance portion in the video, the saturation may vary along with the change of the nonlinear characteristic. Even for the same subject, the variation of the saturation can occur depending on the signal amount of the high-luminance portion.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0011" num="0010">The present invention provides an image processing apparatus in which, even if a nonlinear characteristic of a luminance-type gamma correction circuit for converting a luminance signal is changed, saturation with respect to a luminance output can be nearly constant and an image processing method therefor.</p>
<p id="p-0012" num="0011">In a first aspect of the present invention, there is provided an image processing apparatus, comprising a first nonlinearization unit adapted to perform nonlinear conversion of a signal that has been generated from image data and determines luminance, with a first nonlinear characteristic, a second nonlinearization unit adapted to perform nonlinear conversion of a signal that has been generated from the image data and determines saturation, with a second nonlinear characteristic, and a control unit adapted to set the first nonlinear characteristic and the second nonlinear characteristic to the first nonlinearization unit and the second nonlinearization unit, respectively, wherein the control unit is adapted to previously prepare the first nonlinear characteristic set to the first nonlinearization unit, and an output ratio of the first nonlinear characteristic with respect to an output of the signal that has been generated from the image data and determines the luminance, to the second nonlinear characteristic with respect to an output of the signal that has been generated from the image data and determines the saturation, and to define the second nonlinear characteristic to be set to the second nonlinearization unit so that the output ratio is satisfied.</p>
<p id="p-0013" num="0012">According to the present invention, even if the nonlinear characteristic of the luminance-type gamma correction circuit for converting the luminance signal is changed, the saturation for each output luminance level can be nearly constant.</p>
<p id="p-0014" num="0013">The above and other objects, features, and advantages of the invention will become more apparent from the following detailed description taken in conjunction with the accompanying drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram showing a schematic configuration of a digital video camera according to a first embodiment.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 2</figref> is a diagram showing a relationship between an evaluation value of a high-luminance signal obtained by a detector of the digital video camera of <figref idref="DRAWINGS">FIG. 1</figref>, and a representative value used for selecting a nonlinear characteristic.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram showing an example of nonlinear characteristics to be set to a luminance-type gamma correction circuit of the digital video camera of <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 4</figref> is a diagram showing an example of a relationship between the nonlinear characteristic to be set to the luminance-type gamma correction circuit, and a nonlinear characteristic to be set to a color-type gamma correction circuit of the digital video camera of <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 5</figref> is a diagram showing an example of a relationship of a ratio of the nonlinear characteristic to be set to the color-type gamma correction circuit to the nonlinear characteristic to be set to the luminance-type gamma correction circuit, with respect to an output from the luminance-type gamma correction circuit.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 6</figref> is a diagram showing the nonlinear characteristics to be set to the color-type gamma correction circuit, which are determined with respect to the nonlinear characteristics to be set to the luminance-type gamma correction circuit of <figref idref="DRAWINGS">FIG. 3</figref>.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 7</figref> is a block diagram showing a schematic configuration of the digital video camera according to a second embodiment.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 8</figref> is a diagram showing an example of a nonlinear characteristic to be set to a gamma correction circuit for hue of the digital video camera of <figref idref="DRAWINGS">FIG. 7</figref>.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 9</figref> is a flowchart showing a procedure of a nonlinear characteristic determination method according to the first embodiment.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF THE EMBODIMENTS</heading>
<p id="p-0024" num="0023">The present invention will now be described in detail with reference to the drawings showing preferred embodiments thereof. It should be noted that the relative arrangement of the components, the numerical expressions and numerical values set forth in these embodiments do not limit the scope of the present invention unless it is specifically stated otherwise.</p>
<p id="p-0025" num="0024">&#x3c;First Embodiment&#x3e;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram showing a schematic configuration of a digital video camera <b>1</b> according to a first embodiment. In <figref idref="DRAWINGS">FIG. 1</figref>, the digital video camera <b>1</b> consists of an optical system <b>101</b>, an image pickup section <b>102</b>, an analog front end (AFE) <b>103</b>, a signal processor <b>104</b>, a luminance-type signal processor <b>105</b>, and a luminance-type gamma correction circuit <b>106</b> that functions as a first nonlinearization unit. Moreover, the digital video camera <b>1</b> includes a color-type signal processor <b>107</b>, a color-type gamma correction circuit <b>108</b> that functions as a second nonlinearization unit, a color signal generation circuit <b>109</b>, a detector <b>110</b> and a system controller <b>111</b>. The system controller <b>111</b> controls the optical system <b>101</b>, the image pickup section <b>102</b>, the AFE <b>103</b>, the luminance-type gamma correction circuit <b>106</b>, the color-type gamma correction circuit <b>108</b>, and the detector <b>110</b>, and obtains a detection signal from the detector <b>110</b>.</p>
<p id="p-0027" num="0026">The optical system <b>101</b> includes an iris, a lens, and the like. The image pickup section <b>102</b> includes an image pickup element such as a CMOS image sensor or a CCD image sensor, a timing generator (TG), and the like. When a subject (not shown) is shot by the digital video camera <b>1</b>, a light that has passed through the optical system <b>101</b> is imaged onto the image pickup element of the image pickup section <b>102</b>. The image pickup element photoelectrically converts a subject image obtained by the imaging, and outputs the converted subject image as an analog image signal. It should be noted that this analog image signal is outputted from the image pickup section <b>102</b> at a shutter speed defined by the system controller <b>111</b>.</p>
<p id="p-0028" num="0027">The AFE <b>103</b> converts the analog image signal outputted from the image pickup section <b>102</b>, into a digital image signal (hereinafter referred to as &#x201c;image data&#x201d;) through analog/digital (A/D) conversion, and transmits the converted image data to the signal processor <b>104</b>. The signal processor <b>104</b> performs black level correction, white balance adjustment, and the like for received image data, and transmits each processed image data of red (R), green (G) and blue (B) to the luminance-type signal processor <b>105</b> and the color-type signal processor <b>107</b>.</p>
<p id="p-0029" num="0028">In the luminance-type signal processor <b>105</b>, a low-pass filter process and an edge correction process are performed, and each processed image data of RGB is transmitted to the luminance-type gamma correction circuit <b>106</b>. The luminance-type gamma correction circuit <b>106</b> performs nonlinear conversion of the above described each image data of RGB, and outputs the converted each image data of RGB. The image data that has passed through processing in the luminance-type gamma correction circuit <b>106</b> is transmitted to a luminance signal generation circuit <b>112</b>, where a luminance signal Y is generated from each signal of R, G and B.</p>
<p id="p-0030" num="0029">The color-type signal processor <b>107</b> corrects black and color balances. The image data that has passed through processing in the color-type signal processor <b>107</b> and determines saturation is transmitted to the color-type gamma correction circuit <b>108</b>, where signal correction through the nonlinear conversion is performed for each signal of RGB. The image data that has passed through processing in the color-type gamma correction circuit <b>108</b> is transmitted to the color signal generation circuit <b>109</b>, where color-difference signals Pr and Pb are generated from each signal of R, G and B. In this way, the image data (image signal) that is inputted to the color-type signal processor <b>107</b> and outputted from the color signal generation circuit <b>109</b> is processed as the image data that determines the saturation of the image.</p>
<p id="p-0031" num="0030">The detector <b>110</b> generates a luminance signal from the image data, based on a frame and a threshold that are set by the system controller <b>111</b>, and obtains an evaluation value for exposure control and an evaluation value of a high-luminance signal, based on this generated luminance signal. The evaluation value for the exposure control is, for example, a value representing an exposure of a current video, such as an average value of entire image data of one frame, and is transmitted from the detector <b>110</b> to the system controller <b>111</b>.</p>
<p id="p-0032" num="0031">The system controller <b>111</b> transmits signals to the optical system <b>101</b>, the image pickup section <b>102</b>, and the AFE <b>103</b> so that the evaluation value for the exposure control becomes a target value, and controls the iris, a shutter, and a gain. The evaluation value of the high-luminance signal is a value representing to what degree a signal of a high-luminance portion exists in the entire image data, and for example, a signal amount (a value of an integral) of the luminance signal exceeding a previously defined threshold is used. Accordingly, if the evaluation value of the high-luminance signal is large, it shows that many high-luminance portions exist in the image data. Similarly to the evaluation value for the exposure control, the evaluation value of the high-luminance signal is transmitted from the detector <b>110</b> to the system controller <b>111</b>.</p>
<p id="p-0033" num="0032">The system controller <b>111</b> sets, based on the evaluation value of the high-luminance signal, a nonlinear characteristic (first nonlinear characteristic) with which the luminance-type gamma correction circuit <b>106</b> performs the nonlinear conversion, and a nonlinear characteristic (second nonlinear characteristic) with which the color-type gamma correction circuit <b>108</b> performs the nonlinear conversion.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 9</figref> is a flowchart showing a procedure of a nonlinear characteristic determination method in the first embodiment. Hereinafter, the nonlinear characteristic determination method will be described according to the flowchart. The system controller <b>111</b> obtains the evaluation value of the high-luminance signal from the detector <b>110</b> (step S<b>901</b>), and calculates a representative value according to the evaluation value (step S<b>902</b>). Hereinafter, a method of calculating this representative value will be described with reference to <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 2</figref> is a diagram showing a relationship between the evaluation value of the high-luminance signal obtained by the detector <b>110</b> of the digital video camera <b>1</b> of <figref idref="DRAWINGS">FIG. 1</figref>, and the representative value used for selecting the nonlinear characteristic. The larger the evaluation value is, the larger the representative value becomes. The representative value is decided by the number of previously prepared nonlinear characteristics. In the present embodiment, it is assumed that 11 kinds of nonlinear characteristics are prepared. The representative value and the nonlinear characteristic are previously associated with each other, and the larger the representative value becomes, the higher luminance of an expressed gradation in the nonlinear characteristic becomes. As shown in <figref idref="DRAWINGS">FIG. 2</figref>, if the evaluation value of the high-luminance signal exceeds a maximum value (max), the representative value is fixed to &#x201c;10&#x201d;. As shown in <figref idref="DRAWINGS">FIG. 2</figref>, if evaluation values of subjects <b>0</b>, <b>1</b> and <b>2</b> are obtained, the representative values are set to <b>0</b>, <b>5</b> and <b>10</b>, respectively. It should be noted that the same nonlinear characteristic is given to each signal of RGB inputted to and outputted from the luminance-type gamma correction circuit <b>106</b>.</p>
<p id="p-0036" num="0035">Returning to <figref idref="DRAWINGS">FIG. 9</figref>, next, according to the representative value calculated in step S<b>902</b>, the first nonlinear characteristic to be set to the luminance-type gamma correction circuit <b>106</b>, and the second nonlinear characteristic to be set to the color-type gamma correction circuit <b>108</b> are selected (step S<b>903</b>), and this process is completed. According to this process, the selected nonlinear characteristics are set to the luminance-type gamma correction circuit <b>106</b> and the color-type gamma correction circuit <b>108</b>. Then, the set nonlinear characteristic is used to output Y from the luminance-type gamma correction circuit <b>106</b>. Moreover, an output of the color-type gamma correction circuit <b>108</b> is transmitted to the color signal generation circuit <b>109</b>, where Pr and Pb are outputted. For the nonlinear characteristics, nonlinear characteristics of a luminance-type and a color-type have been defined according to the representative value. Hereinafter, the nonlinear characteristic determination method will be described while the nonlinear characteristics are shown.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram showing an example of the nonlinear characteristics to be set to the luminance-type gamma correction circuit <b>106</b> of the digital video camera <b>1</b> of <figref idref="DRAWINGS">FIG. 1</figref>, and shows a nonlinear characteristic <b>301</b>, a nonlinear characteristic <b>302</b> and a nonlinear characteristic <b>303</b> that have been previously prepared for the representative value <b>0</b>, the representative value <b>5</b> and the representative value <b>10</b> shown in <figref idref="DRAWINGS">FIG. 2</figref>. In the nonlinear characteristic <b>301</b> prepared for the representative value <b>0</b>, a gradation of an output signal from the luminance-type gamma correction circuit <b>106</b> occurs with respect to an input signal of an input value up to 511 from the luminance-type signal processor <b>105</b> to the luminance-type gamma correction circuit <b>106</b>. In the nonlinear characteristic <b>303</b> prepared for the representative value <b>10</b>, the gradation of the output signal occurs with respect to the input signal of the input value up to 1023. In the nonlinear characteristic <b>302</b> prepared for the representative value <b>5</b>, the gradation of the output signal occurs with respect to the input signal of the input value up to 767 that is intermediate between these input values.</p>
<p id="p-0038" num="0037">As in a case of the representative value <b>0</b>, if the evaluation value of the high-luminance signal is small, the nonlinear characteristic <b>301</b> is selected, and the output signal from the luminance-type gamma correction circuit <b>106</b> at a time when the input value of the input signal from the luminance-type signal processor <b>105</b> is up to 511 is expressed with good gradation. On the other hand, like the representative value <b>10</b>, if the evaluation value of the high-luminance signal is large, the nonlinear characteristic <b>303</b> is selected, and the output signal from the luminance-type gamma correction circuit <b>106</b> at a time when the input value of the input signal from the luminance-type signal processor <b>105</b> is higher than 511 is expressed with the good gradation.</p>
<p id="p-0039" num="0038">In the digital video camera <b>1</b>, the nonlinear characteristic to be set in the color-type gamma correction circuit <b>108</b> has also been previously prepared for the above described plurality of representative values. <figref idref="DRAWINGS">FIG. 4</figref> is a diagram showing a relationship between the nonlinear characteristic to be set to the luminance-type gamma correction circuit <b>106</b>, and the nonlinear characteristic to be set to the color-type gamma correction circuit <b>108</b>, in the case of the representative value <b>0</b>. The nonlinear characteristic <b>301</b> shown in <figref idref="DRAWINGS">FIG. 4</figref> is the same as the nonlinear characteristic <b>301</b> shown in <figref idref="DRAWINGS">FIG. 3</figref>. In other words, with respect to the nonlinear characteristic <b>301</b> of <figref idref="DRAWINGS">FIG. 4</figref>, its x-axis represents the value of the input signal to the luminance-type gamma correction circuit <b>106</b>, and its y-axis represents a value of the output signal from the luminance-type gamma correction circuit <b>106</b>. Moreover, with respect to a nonlinear characteristic <b>401</b> of <figref idref="DRAWINGS">FIG. 4</figref>, its x-axis indicates a value of an input signal to the color-type gamma correction circuit <b>108</b>, and its y-axis indicates a value of an output signal from the color-type gamma correction circuit <b>108</b>. It should be noted that, similarly to the luminance-type gamma correction circuit <b>106</b>, the same nonlinear characteristic is given to each signal of RGB inputted to and outputted from the color-type gamma correction circuit <b>108</b>.</p>
<p id="p-0040" num="0039">The nonlinear characteristic to be set to the color-type gamma correction circuit <b>108</b> is defined as follows. Specifically, first, a reference output ratio of luminance to color is defined. The nonlinear characteristic <b>401</b> shown in <figref idref="DRAWINGS">FIG. 4</figref> is a nonlinear characteristic to be set to the color-type gamma correction circuit <b>108</b> if the representative value <b>0</b> is selected. In the present embodiment, the nonlinear characteristic <b>401</b> has a characteristic close to an inverse gamma characteristic of a monitor. The nonlinear characteristic <b>301</b> to be set to the luminance-type gamma correction circuit <b>106</b> and the nonlinear characteristic <b>401</b> to be set to the color-type gamma correction circuit <b>108</b> have a similar characteristic until both the value of the output signal from the luminance-type gamma correction circuit <b>106</b> and the value of the output signal from the color-type gamma correction circuit <b>108</b> become CP.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 5</figref> is a diagram showing a relationship of a ratio (output ratio) of the nonlinear characteristic to be set to the color-type gamma correction circuit <b>108</b> to the nonlinear characteristic to be set to the luminance-type gamma correction circuit <b>106</b>, with respect to the output signal from the luminance-type gamma correction circuit <b>106</b> (the nonlinear characteristic to be set to the luminance-type gamma correction circuit <b>106</b>). The output ratio becomes 1.0 times until both the value of the output signal from the luminance-type gamma correction circuit <b>106</b> and the value of the output signal from the color-type gamma correction circuit <b>108</b> become CP. Moreover, the output ratio becomes Cmax/Ymax when the value of the output signal from the luminance-type gamma correction circuit <b>106</b> become Ymax. The system controller <b>111</b> determines the nonlinear characteristic to be set to the color-type gamma correction circuit <b>108</b>, from the nonlinear characteristic to be set to the luminance-type gamma correction circuit <b>106</b>, and the output ratio of <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 6</figref> is a diagram showing the nonlinear characteristics to be set to the color-type gamma correction circuit <b>108</b>, which are determined with respect to the nonlinear characteristics <b>301</b>, <b>302</b> and <b>303</b> to be set to the luminance-type gamma correction circuit <b>106</b> as shown in <figref idref="DRAWINGS">FIG. 3</figref>. Nonlinear characteristics <b>601</b>, <b>602</b> and <b>603</b> shown in <figref idref="DRAWINGS">FIG. 6</figref> are the nonlinear characteristics to be set to the color-type gamma correction circuit <b>108</b>, and have been previously prepared for the representative values <b>0</b>, <b>5</b> and <b>10</b> shown in <figref idref="DRAWINGS">FIG. 2</figref>, respectively. The nonlinear characteristics <b>601</b>, <b>602</b> and <b>603</b> have been defined so that all of a ratio of the nonlinear characteristic <b>301</b> to the nonlinear characteristic <b>601</b>, a ratio of the nonlinear characteristic <b>302</b> to the nonlinear characteristic <b>602</b>, and a ratio of the nonlinear characteristic <b>303</b> to the nonlinear characteristic <b>603</b> satisfy the relationship of <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0043" num="0042">For example, in a case of the subject <b>0</b> shown in <figref idref="DRAWINGS">FIG. 2</figref>, the nonlinear characteristic <b>301</b> of <figref idref="DRAWINGS">FIG. 3</figref> is set to the luminance-type gamma correction circuit <b>106</b>, and the nonlinear characteristic <b>601</b> is set to the color-type gamma correction circuit <b>108</b>. It should be noted that, in the case of the present embodiment, the nonlinear characteristic <b>601</b> of <figref idref="DRAWINGS">FIG. 6</figref> becomes equivalent to the nonlinear characteristic <b>401</b> shown in <figref idref="DRAWINGS">FIG. 4</figref>. Similarly, in a case of the subject <b>1</b> shown in <figref idref="DRAWINGS">FIG. 2</figref>, the nonlinear characteristic <b>302</b> is set to the luminance-type gamma correction circuit <b>106</b>, and the nonlinear characteristic <b>602</b> is set to the color-type gamma correction circuit <b>108</b>. Moreover, in a case of the subject <b>2</b> shown in <figref idref="DRAWINGS">FIG. 2</figref>, the nonlinear characteristic <b>303</b> is set to the luminance-type gamma correction circuit <b>106</b>, and the nonlinear characteristic <b>603</b> is set to the color-type gamma correction circuit <b>108</b>.</p>
<p id="p-0044" num="0043">In this way, in the present embodiment, the system controller <b>111</b> changes the nonlinear characteristics to be set to the luminance-type gamma correction circuit <b>106</b> and the color-type gamma correction circuit <b>108</b>, depending on the evaluation value of the high-luminance signal that indicates the signal amount (the value of the integral) of the luminance signal that exceeds the previously defined threshold and has been generated by the detector <b>110</b>. In other words, depending on the evaluation value of the high-luminance signal, the system controller <b>111</b> selects the nonlinear characteristic to be set to the luminance-type gamma correction circuit <b>106</b>, from a plurality of nonlinear characteristics that have been previously prepared as the representative value <b>0</b> to the representative value <b>10</b>. Then, from the nonlinear characteristic set to the luminance-type gamma correction circuit <b>106</b>, and the output ratio of <figref idref="DRAWINGS">FIG. 5</figref>, the nonlinear characteristic to be set to the color-type gamma correction circuit <b>108</b> is determined so that this output ratio is satisfied.</p>
<p id="p-0045" num="0044">Since the nonlinear characteristic used in the nonlinear conversion in the color-type gamma correction circuit <b>108</b> is set by the method as described above, saturation with respect to a luminance output can be nearly constant when the nonlinear characteristic of the luminance-type gamma correction circuit <b>106</b> is varied, and a variation of the saturation can be reduced.</p>
<p id="p-0046" num="0045">&#x3c;Second Embodiment&#x3e;</p>
<p id="p-0047" num="0046">In the first embodiment, the nonlinear characteristic for the nonlinear conversion in the color-type gamma correction circuit <b>108</b> is varied corresponding to the nonlinear characteristic for the nonlinear conversion in the luminance-type gamma correction circuit <b>106</b>, and a color signal is generated with the output signal from the color-type gamma correction circuit <b>108</b>. Here, for example, in a case of the nonlinear characteristic <b>601</b> shown in <figref idref="DRAWINGS">FIG. 6</figref>, few color shifts occur because of closeness to the inverse gamma characteristic of the monitor. However, in cases of the nonlinear characteristics <b>602</b> and <b>603</b>, a hue shift occurs for an amount of deviation from the inverse gamma characteristic of the monitor. Consequently, in the present embodiment, the saturation is suppressed while hue is prevented from being affected.</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 7</figref> is a block diagram showing a schematic configuration of a digital video camera <b>1</b>&#x2032; according to a second embodiment. Component parts shown in <figref idref="DRAWINGS">FIG. 7</figref> corresponding to those in <figref idref="DRAWINGS">FIG. 1</figref> are assigned the same reference numerals, and descriptions thereof are herein omitted. The digital video camera <b>1</b>&#x2032; according to the present embodiment further includes a gamma correction circuit for hue <b>701</b> that functions as a third nonlinearization unit, a gamma correction circuit for saturation <b>702</b>, a color signal generation circuit for hue <b>703</b>, a color signal generation circuit for saturation <b>704</b>, and a saturation suppression circuit <b>705</b>.</p>
<p id="p-0049" num="0048">A flow of the nonlinear characteristic selection performed in the system controller is similar to <figref idref="DRAWINGS">FIG. 9</figref> shown in the first embodiment, and thus the flow is omitted. However, the second nonlinear characteristic selected in the present embodiment is set to the gamma correction circuit for saturation <b>702</b>.</p>
<p id="p-0050" num="0049">The image data that has passed through the processing in the color-type signal processor <b>107</b> is transmitted to each of the gamma correction circuit for hue <b>701</b> and the gamma correction circuit for saturation <b>702</b>. The nonlinear characteristic to be set to the luminance-type gamma correction circuit <b>106</b> in the present embodiment is assumed to be similar to the first embodiment. The nonlinear characteristic to be set to the gamma correction circuit for saturation <b>702</b> can be similar to the nonlinear characteristic to be set to the color-type gamma correction circuit <b>108</b> in the first embodiment.</p>
<p id="p-0051" num="0050">The gamma correction circuit for hue <b>701</b> applies the nonlinear conversion to a signal that determines the hue. A nonlinear characteristic (third nonlinear characteristic) used in the nonlinear conversion by the gamma correction circuit for hue <b>701</b> is set by the system controller <b>111</b>. <figref idref="DRAWINGS">FIG. 8</figref> is a diagram showing an example of the nonlinear characteristic to be set to the gamma correction circuit for hue <b>701</b> of the digital video camera <b>1</b>&#x2032; of <figref idref="DRAWINGS">FIG. 7</figref>. In the present embodiment, it is assumed that the nonlinear characteristic to be set to the gamma correction circuit for hue <b>701</b> is a characteristic close to the inverse gamma characteristic of the monitor, and that a constant nonlinear characteristic is always set to the gamma correction circuit for hue <b>701</b> regardless of the setting in the luminance-type gamma correction circuit <b>106</b>. Here, the same nonlinear characteristic is given to each signal of RGB inputted to and outputted from the gamma correction circuit for hue <b>701</b>.</p>
<p id="p-0052" num="0051">An output (RGB signal) from the gamma correction circuit for hue <b>701</b> is transmitted to the color signal generation circuit for hue <b>703</b>, and an output (RGB signal) from the gamma correction circuit for saturation <b>702</b> is transmitted to the color signal generation circuit for saturation <b>704</b>. Each of the color signal generation circuit for hue <b>703</b> and the color signal generation circuit for saturation <b>704</b> generates a Pb signal and a Pr signal from the received RGB signal, and transmits the Pb signal and the Pr signal to the saturation suppression circuit <b>705</b>.</p>
<p id="p-0053" num="0052">Here, the Pb signal and the Pr signal that are outputted from the color signal generation circuit for hue <b>703</b> are denoted as Pb<b>1</b> and Pr<b>1</b>, respectively, and the Pb signal and the Pr signal that are outputted from the color signal generation circuit for saturation <b>704</b> are denoted as Pb<b>2</b> and Pr<b>2</b>, respectively. The saturation suppression circuit <b>705</b> suppresses Pb<b>1</b> and Pr<b>1</b> at the same ratio. A value to be multiplied in the suppression is (Pb<b>2</b><sup>2</sup>+Pr<b>2</b><sup>2</sup>)<sup>0.5</sup>/(Pb<b>1</b><sup>2</sup>+Pr<b>1</b><sup>2</sup>)<sup>0.5</sup>. In this way, signals in which Pb<b>1</b> and Pr<b>1</b> are multiplied by this value are outputted as the Pb signal and the Pr signal, from the saturation suppression circuit <b>705</b>.</p>
<p id="p-0054" num="0053">The saturation can be suppressed to be nearly constant while the hue is maintained, by obtaining the Pb signal and the Pr signal by the above described method of the present embodiment. Moreover, even if a variation occurs in the nonlinear characteristic of the luminance-type gamma correction circuit <b>106</b>, the saturation can be generally similarly suppressed with respect to the luminance output.</p>
<p id="p-0055" num="0054">Other Embodiments</p>
<p id="p-0056" num="0055">Aspects of the present invention can also be realized by a computer of a system or apparatus (or devices such as a CPU or MPU) that reads out and executes a program recorded on a memory device to perform the functions of the above-described embodiment(s), and by a method, the steps of which are performed by a computer of a system or apparatus by, for example, reading out and executing a program recorded on a memory device to perform the functions of the above-described embodiment(s). For this purpose, the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device (e.g., computer-readable medium).</p>
<p id="p-0057" num="0056">While the present invention has been described with reference to exemplary embodiments, it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structures and functions.</p>
<p id="p-0058" num="0057">This application claims the benefit of Japanese Patent Application No. 2010-266975, filed Nov. 30, 2010, which is hereby incorporated by reference herein in their entirety.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An image processing apparatus comprising:
<claim-text>a first nonlinearization unit adapted to perform nonlinear conversion of a signal that has been generated from image data to determine luminance with a first nonlinear characteristic;</claim-text>
<claim-text>a second nonlinearization unit adapted to perform nonlinear conversion of a signal that has been generated from the image data to determine saturation with a second nonlinear characteristic; and</claim-text>
<claim-text>a control unit adapted to:</claim-text>
<claim-text>set the first nonlinear characteristic and the second nonlinear characteristic to said first nonlinearization unit and said second nonlinearization unit, respectively;</claim-text>
<claim-text>set a predetermined output ratio of the first nonlinear characteristic to the second nonlinear characteristic; and</claim-text>
<claim-text>select, upon setting the first nonlinear characteristic to said first nonlinearization unit, the second nonlinear characteristic to be set to said second nonlinearization unit satisfying the predetermined output ratio.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The image processing apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a calculating unit adapted to generate a luminance signal from the image data, and calculate a signal amount of the luminance signal exceeding a predetermined threshold,</claim-text>
<claim-text>wherein said control unit is further adapted to select the first nonlinear characteristic to be set to said first nonlinearization unit from among a plurality of predetermined nonlinear characteristics.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The image processing apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a third nonlinearization unit adapted to perform nonlinear conversion of a signal that has been generated from the image data and determine hue, with a third nonlinear characteristic,</claim-text>
<claim-text>wherein said control unit is further adapted to set a predetermined constant nonlinear characteristic that is independent of the first nonlinear characteristic, and to set the predetermined constant nonlinear characteristic as the third nonlinear characteristic to said third nonlinearization unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. An image processing method implemented in an image processing apparatus comprising an image pickup unit and a control unit, the method comprising:
<claim-text>a step of obtaining a subject image as image data by said image pickup unit;</claim-text>
<claim-text>a calculating step of generating a luminance signal from the image data, and calculating a signal amount of the luminance signal exceeding a predetermined threshold;</claim-text>
<claim-text>a first selecting step of selecting a first nonlinear characteristic from a plurality of predetermined nonlinear characteristics;</claim-text>
<claim-text>a first nonlinearization step of performing nonlinear conversion of a signal that has been generated from the image data to determine luminance, with the selected first nonlinear characteristic;</claim-text>
<claim-text>an output ratio setting step of setting a predetermined output ratio of the first nonlinear characteristic to the second nonlinear characteristic;</claim-text>
<claim-text>a second selecting step of selecting a second nonlinear characteristic, upon selecting the first nonlinear characteristic in said first selecting step, that satisfies the predetermined output ratio set in said output ratio setting step; and</claim-text>
<claim-text>a second nonlinearization step of performing nonlinear conversion of a signal that has been generated from the image data to determine saturation, with the selected second nonlinear characteristic. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
