<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08626268-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08626268</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13541111</doc-number>
<date>20120703</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>5</main-group>
<subgroup>05</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>600424</main-classification>
<further-classification>600407</further-classification>
<further-classification>600473</further-classification>
<further-classification>600476</further-classification>
<further-classification>600302</further-classification>
</classification-national>
<invention-title id="d2e43">Method and system for detecting colorimetric abnormalities in vivo</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>2002/0042562</doc-number>
<kind>A1</kind>
<name>Meron et al.</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600361</main-classification></classification-national>
</us-citation>
</us-references-cited>
<number-of-claims>18</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>600407</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600424</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600473</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600476</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600302</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>5</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>10097096</doc-number>
<date>20020314</date>
</document-id>
<parent-status>ABANDONED</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13541111</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60275486</doc-number>
<date>20010314</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120275683</doc-number>
<kind>A1</kind>
<date>20121101</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Adler</last-name>
<first-name>Doron</first-name>
<address>
<city>Nesher</city>
<country>IL</country>
</address>
</addressbook>
<residence>
<country>IL</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Zinaty</last-name>
<first-name>Ofra</first-name>
<address>
<city>Haifa</city>
<country>IL</country>
</address>
</addressbook>
<residence>
<country>IL</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Levy</last-name>
<first-name>Daphna</first-name>
<address>
<city>Carmiel</city>
<country>IL</country>
</address>
</addressbook>
<residence>
<country>IL</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Glukhovsky</last-name>
<first-name>Arkady</first-name>
<address>
<city>Nesher</city>
<country>IL</country>
</address>
</addressbook>
<residence>
<country>IL</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Adler</last-name>
<first-name>Doron</first-name>
<address>
<city>Nesher</city>
<country>IL</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Zinaty</last-name>
<first-name>Ofra</first-name>
<address>
<city>Haifa</city>
<country>IL</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Levy</last-name>
<first-name>Daphna</first-name>
<address>
<city>Carmiel</city>
<country>IL</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Glukhovsky</last-name>
<first-name>Arkady</first-name>
<address>
<city>Nesher</city>
<country>IL</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Pearl Cohen Zedek Latzer Baratz LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Given Imaging Ltd.</orgname>
<role>03</role>
<address>
<city>Yoqneam</city>
<country>IL</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Kish</last-name>
<first-name>James</first-name>
<department>3737</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A system and method for detection of colorimetric abnormalities within a body lumen includes an image receiver for receiving images from within the body lumen. Also included are a transmitter for transmitting the images to a receiver, and a processor for generating a probability indication of presence of colorimetric abnormalities on comparison of color content of the images and at least one reference value.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="171.62mm" wi="138.85mm" file="US08626268-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="185.34mm" wi="112.61mm" orientation="landscape" file="US08626268-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="134.62mm" wi="129.37mm" file="US08626268-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="194.31mm" wi="131.06mm" orientation="landscape" file="US08626268-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="182.88mm" wi="137.84mm" file="US08626268-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="186.61mm" wi="98.47mm" orientation="landscape" file="US08626268-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is a continuation application of U.S. patent application Ser. No. 10/097,096, filed Mar. 14, 2002 now abandoned, which claims priority from U.S. Provisional Patent Application No. 60/275,486, filed Mar. 14, 2001, both of which are incorporated herein by reference in their entirety.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to a method and system for detection of colorimetric abnormalities in vivo, and specifically within the gastrointestinal (GI) tract.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">Pathologies of the gastrointestinal (GI) tract may exist for a variety of reasons. Some examples of pathologies include bleeding, lesions, angiodisplasia, Crohn's disease, polyps, celiac disorders, and others. The majority of pathologies result in changes of color and/or texture of the inner surface of the GI tract.</p>
<p id="p-0005" num="0004">As one example, color changes may be due to bleeding. Blood may be present within the digestive tract for a variety of pathological reasons, including ulcers, cancer, or other disease conditions. It is often difficult to detect the presence of blood within the GI tract, since bleeding can occur in difficult to reach locations. In addition, it is difficult to &#x201c;see&#x201d; inside the tract, especially in sections which are hard to reach such as the small intestines.</p>
<p id="p-0006" num="0005">Several approaches have been used to try to detect the presence of blood within the GI tract. One approach has been the detection of blood in the feces by visual and/or chemical means. The main drawback of this approach has been that the concentration of blood in the feces is lower than the concentration of blood at the bleeding site since additional materials are accumulated along the GI passage. Therefore, the sensitivity of this approach is low. In addition, the specific bleeding site along the GI tract cannot be determined.</p>
<p id="p-0007" num="0006">A second, more invasive technique, has been the use of an endoscope or enteroscope. This approach enables direct visualization of parts of the GI tract. However, most portions of the small intestine are inaccessible by this method.</p>
<p id="p-0008" num="0007">Other examples of pathologies which may be detected based on the red part of the spectrum include active bleeding, blood clots, polyps, lesions, ulcerations, angiodispiasia and telangectasia. Pathologies which may be characterized by blue/violet color include arterio-venous malformation (AVM) and submucosal bleeding. AVM may also appear in red. In addition, some types of ulcers are characterized by white color.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0009" num="0008">There is provided, in accordance with one embodiment of the present invention, a method for detecting colorimetric abnormalities in a body lumen. The method includes the step of calculating a probability indication of a presence of an abnormal color within the body lumen based on comparison of spectral characteristics to at least one reference value.</p>
<p id="p-0010" num="0009">There is provided, in accordance with another embodiment of the present invention, a method for calculation of a reference value for tissue. The method includes the steps of receiving at least a first image and a second image from within a body lumen, selecting blocks of pixels within the images based on colorimetric parameters, averaging the calorimetric parameters of the selected blocks of pixels of the first and second images, and filtering the calorimetric parameters, thereby obtaining a reference value for tissue.</p>
<p id="p-0011" num="0010">There is provided, in accordance with another embodiment of the present invention, a swallowable capsule for detecting calorimetric abnormalities in a gastrointestinal tract. The capsule includes an image-receiver for receiving images from the gastrointestinal tract, and a processor for generating a probability indication for presence of colorimetric abnormalities by comparing color content of the images to at least one reference value.</p>
<p id="p-0012" num="0011">There is provided, in accordance with another embodiment of the present invention, an apparatus for determining colorimetric abnormalities within a body lumen. The apparatus includes an image-receiver for receiving images from a body lumen, a spectral analyzer for determining color content of the images, and a processor for generating a probability indication for presence of an abnormal condition by comparing the color content to at least one reference value.</p>
<p id="p-0013" num="0012">There is provided, in accordance with another embodiment of the present invention, a system for detection of blood within a body lumen. The system includes a swallowable capsule having an in-vivo imager for obtaining images from within the body lumen, a transmitter for transmitting the images to a receiver, and a processor for generating a probability indication of presence of blood based on comparison of color content of the received images and at least one reference value.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0014" num="0013">The present invention will be understood and appreciated more fully from the following detailed description taken in conjunction with the drawings in which:</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic illustration of a prior art in vivo camera system;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic illustration of the classification of samples according to their spectral components;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram illustration of a system according to one embodiment of the present invention;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 4</figref> is a flow chart illustration of the method used by the system shown in <figref idref="DRAWINGS">FIG. 3</figref>; and</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 5</figref> is a schematic illustration of adaptive building of a reference tissue sample.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0020" num="0019">The present invention relates to a method and system of detection of pathologies by spectral analysis of images captured by a moving in vivo video camera system. This analysis is based on detection of colorimetric abnormalities, or deviations from an expected spectrum. The in-vivo video camera system may be included on an endoscope, a swallowable capsule, or any other device which is introduced into the body to view the interior.</p>
<p id="p-0021" num="0020">U.S. Pat. No. 5,604,531, assigned to the common assignee of the present application and incorporated herein by reference, teaches an in vivo camera system, which is carried by a swallowable capsule. The in vivo video camera system captures and transmits images of the GI tract while the capsule passes through the GI lumen, in addition to the camera system, the capsule contains an optical system for imaging an area of interest onto the camera system and a transmitter for transmitting the video output of the camera. The capsule can pass through the entire digestive tract and operate as an autonomous video endoscope. It images even the difficult to reach areas of the small intestine.</p>
<p id="p-0022" num="0021">Reference is made to <figref idref="DRAWINGS">FIG. 1</figref>, which shows a schematic diagram of the system, described in U.S. Pat. No. 5,604,531. The system comprises a capsule <b>40</b> having an imager <b>46</b>, an illumination source <b>42</b>, and a transmitter <b>41</b>. Outside the patient's body are an image receiver <b>12</b> (usually an antenna array), a storage unit <b>19</b>, a data processor <b>14</b>, an image monitor <b>18</b>, and a position monitor <b>16</b>. While <figref idref="DRAWINGS">FIG. 1</figref> shows separate monitors, both an image and its position can be presented on a single monitor.</p>
<p id="p-0023" num="0022">Imager <b>46</b> in capsule <b>40</b> is connected to transmitter <b>41</b> also located in capsule <b>40</b>. Transmitter <b>41</b> transmits images to image receiver <b>12</b>, which sends the data to data processor <b>14</b> and to storage unit <b>19</b>. Data processor <b>14</b> analyzes the data and is in communication with storage unit <b>19</b>, transferring frame data to and from storage unit <b>19</b>. Data processor <b>14</b> also provides the analyzed data to image monitor <b>18</b> and position monitor <b>16</b> where the physician views the data. The image monitor presents an image of the GI lumen and the position monitor presents the position in the GI tract at which the image was taken. Data processor <b>14</b> can be configured for real time processing or for post processing to be viewed at a later date. In addition to revealing pathological conditions of the GI tract, the system can provide information about the location of these pathologies.</p>
<p id="p-0024" num="0023">In a preferred embodiment of the present invention, received images are analyzed for color content, Based on this analysis, as described hereinbelow, determination as to the presence or absence of a colorimetric abnormality may be made. A colorimetric abnormality may indicate a pathological condition, such as bleeding. Other examples of pathologies which may be detected based on the red part of the spectrum include active bleeding, blood clots, polyps, lesions, ulcerations, angiodisplasia and telangectasia. Pathologies which may be characterized by blue/violet color include arterio-venous malformation (AVM) and submucosal bleeding. AVM may also appear in red. In addition, some types of ulcers are characterized by white color. It will be apparent that the method and system described hereinbelow may be useful in detecting any colorimetric deviation from the normal color content of a body lumen, whether or not a pathological condition is present.</p>
<p id="p-0025" num="0024">Reference is now made to <figref idref="DRAWINGS">FIG. 2</figref>, which is a schematic illustration of the classification of samples according to their spectral components. Each test sample T is located within a coordinate system represented by the following variables: hue H, saturation S and value V. Hue H represents a number related to the dominant wavelength of the color stimulus, and varies from 0 to 1 as the color changes from red to yellow to green to cyan to blue to magenta and back to red again. Saturation S corresponds to color purity, and in the case of a pure color is equal to 100%. Value V is a measure of relative intensity of color, representing brightness of red, blue and green (RBG). A distance vector r(B,T) between test sample T and an ideal pathology sample B is calculated. Another distance vector r(R,T) between test sample T and a reference sample of healthy tissue R is calculated. The relationship of distance vector r(B,T) and distance vector r(R,T) is calculated. Each test sample T is classified based on the relationship between distance vector r(B,T) and distance vector r(R,T). Briefly, if distance vector r(B,T) is small relative to distance vector r(R,T), there is a positive indication of pathological color. In the preferred embodiment, the analysis is set up to include a higher possibility of false positives than false negatives, so as to minimize the likelihood of missing a positive diagnosis. However, other embodiments of analysis are possible as well.</p>
<p id="p-0026" num="0025">Reference is now made to <figref idref="DRAWINGS">FIGS. 3 and 4</figref>, which illustrate a system <b>15</b> and a flow chart diagram showing the steps of using system <b>15</b> for determining the blood content or any other color-distinguishable pathology within the gut, System <b>15</b> comprises illumination source <b>42</b>&#x2032;, image receiver <b>12</b>&#x2032;, data processor <b>14</b>&#x2032;, and image monitor <b>18</b>&#x2032;. Data processor <b>14</b>&#x2032; comprises a spectral analyzer <b>22</b>, an adaptive reference builder <b>24</b>, a distance calculator <b>26</b>, and a decision calculator <b>28</b>. According to one embodiment of the invention, data processor <b>14</b>&#x2032; is a standard computer accelerator board, high performance computer, multiprocessor or any other serial or parallel high performance processing machine. Image monitor <b>18</b>&#x2032; may be a video display, or a graph, table or any other indicator.</p>
<p id="p-0027" num="0026">Steps of <figref idref="DRAWINGS">FIG. 4</figref> may be accomplished using system <b>15</b> of <figref idref="DRAWINGS">FIG. 3</figref>. In one embodiment, images are captured and processed within a capsule. In another embodiment, images are captured by an in-vivo system, and are transmitted to a remote location where they are processed. Image receiver <b>12</b>&#x2032; receives (step <b>101</b>) images captured by the in-vivo camera system of <figref idref="DRAWINGS">FIG. 1</figref> or any other in-vivo imager.</p>
<p id="p-0028" num="0027">Data processor <b>14</b>&#x2032; divides (step <b>102</b>) the color images into a grid of pixels. As in other imaging applications, the number of pixels determines the resolution of the image, For purposes of this discussion, the images are divided into blocks (i,j) of 8&#xd7;8 pixels. Since, in one embodiment, the original image is a 256&#xd7;256 pixel image, the result of dividing into 8 pixels, and determining the color components is a 32&#xd7;32&#xd7;3 matrix of color component value blocks. Spectral analyzer <b>22</b> calculates (step <b>104</b>) the color components of each block: hue H<sub>i,j</sub>; saturation S<sub>i,j</sub>; and brightness value V<sub>i,j </sub>for each image.</p>
<p id="p-0029" num="0028">Spectral analyzer also calculates (steps <b>105</b> and <b>106</b>-<b>110</b>) the color components of blocks of pathology sample B and of healthy reference tissue R. Spectral analyzer <b>22</b> calculates (step <b>105</b>) the color components of blocks of pathology sample B from known images containing blood.</p>
<p id="p-0030" num="0029">Reference is now made to <figref idref="DRAWINGS">FIG. 5</figref>, which is a schematic illustration of the adaptive reference building steps <b>106</b>-<b>110</b> of <figref idref="DRAWINGS">FIG. 4</figref>. Adaptive reference builder <b>24</b> calculates (steps <b>108</b>-<b>110</b>) tissue reference color components in order to build a reference sample of healthy tissue. The adaptive approach is based on averaging healthy tissue appearing in subsequent images, Averages are used since the parameters of healthy tissue along the GI tract may change. Adaptive reference builder <b>24</b> selects (step <b>107</b>) blocks based on value V (brightness) and hue H. In one embodiment, the conditions are: 0.1&#x3c;V<sub>i,j</sub>&#x3c;0.9 and 0&#x3c;H<sub>i,j</sub>&#x3c;0.09. These conditions indicate that healthy tissue is present. As shown in <figref idref="DRAWINGS">FIG. 5</figref>, images P<sub>i</sub>, P<sub>i-1</sub>, and P<sub>i-2 </sub>with regions R<sub>i</sub>, R<sub>i-1</sub>, and R<sub>i-2 </sub>of healthy tissue are obtained. Adaptive reference builder <b>24</b> averages (step <b>108</b>) color components of healthy regions R<sub>i</sub>, R<sub>i-1</sub>, and R<sub>i-2 </sub>(i.e. the selected blocks) of images P<sub>i</sub>, P<sub>i-1</sub>, and P<sub>i-2 </sub>obtained along the GI tract. To smooth the data and eliminate sensitivity to particular images, adaptive reference builder <b>24</b> filters (step <b>110</b>) the average tissue colors of the present image P<sub>i </sub>and the previous image P<sub>i-1</sub>.</p>
<p id="p-0031" num="0030">In one embodiment an Infinite Impulse Response (IIR) filter with the following iterative computation is used:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>out(<i>t</i><sub>i</sub>)=0.08*in(<i>t</i><sub>i</sub>)+0.92*out(<i>t</i><sub>i-1</sub>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where t<sub>i </sub>represents the time index of the current frame i and t<sub>i-1 </sub>represents the time index of the previous frame i&#x2212;1.
</p>
<p id="p-0032" num="0031">Referring back to <figref idref="DRAWINGS">FIG. 4</figref>, distance calculator <b>26</b> then calculates (step <b>112</b>) the Euclidian distance between each block in the matrix and blood reference value B. Blood reference value B is obtained from known images containing blood, analyzed by spectral analyzer <b>22</b> as described above. In another embodiment, a different calorimetric reference value may be used for indication of other unusual colors. The result of this calculation, for the exemplary embodiment, is a matrix of 32&#xd7;32 elements &#x3b2;<sub>i,j</sub>. This calculation is done according to the following equation:</p>
<p id="p-0033" num="0032">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>&#x3b2;</mi>
    <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>j</mi>
    </mrow>
  </msub>
  <mo>=</mo>
  <mfrac>
    <msqrt>
      <mrow>
        <msup>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>H</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
              </msub>
              <mo>-</mo>
              <msub>
                <mi>H</mi>
                <mi>b</mi>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>S</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
              </msub>
              <mo>-</mo>
              <msub>
                <mi>S</mi>
                <mi>b</mi>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>V</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
              </msub>
              <mo>-</mo>
              <msub>
                <mi>V</mi>
                <mi>b</mi>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mn>2</mn>
        </msup>
      </mrow>
    </msqrt>
    <mrow>
      <msqrt>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msubsup>
              <mi>H</mi>
              <mi>b</mi>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>S</mi>
              <mi>b</mi>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>V</mi>
              <mi>b</mi>
              <mn>2</mn>
            </msubsup>
          </mrow>
          <mo>)</mo>
        </mrow>
      </msqrt>
      <mo>*</mo>
      <msqrt>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msubsup>
              <mi>H</mi>
              <mrow>
                <mi>i</mi>
                <mo>,</mo>
                <mi>j</mi>
              </mrow>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>S</mi>
              <mrow>
                <mi>i</mi>
                <mo>,</mo>
                <mi>j</mi>
              </mrow>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>V</mi>
              <mrow>
                <mi>i</mi>
                <mo>,</mo>
                <mi>j</mi>
              </mrow>
              <mn>2</mn>
            </msubsup>
          </mrow>
          <mo>)</mo>
        </mrow>
      </msqrt>
    </mrow>
  </mfrac>
</mrow>
</math>
</maths>
<br/>
where H<sub>b</sub>, S<sub>b </sub>and V<sub>b </sub>are the reference values for hue, saturation and brightness, respectively of blood.
</p>
<p id="p-0034" num="0033">A similar distance calculation is calculated relative to the adaptive tissue reference color (healthy tissue) components, resulting in a 32&#xd7;32 matrix &#x3b8;<sub>i,j </sub>as follows,</p>
<p id="p-0035" num="0034">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>&#x3d1;</mi>
    <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>j</mi>
    </mrow>
  </msub>
  <mo>=</mo>
  <mfrac>
    <msqrt>
      <mrow>
        <msup>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>H</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
              </msub>
              <mo>-</mo>
              <msub>
                <mi>H</mi>
                <mi>t</mi>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>S</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
              </msub>
              <mo>-</mo>
              <msub>
                <mi>S</mi>
                <mi>t</mi>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>V</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
              </msub>
              <mo>-</mo>
              <msub>
                <mi>V</mi>
                <mi>t</mi>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mn>2</mn>
        </msup>
      </mrow>
    </msqrt>
    <mrow>
      <msqrt>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msubsup>
              <mi>H</mi>
              <mi>t</mi>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>S</mi>
              <mi>t</mi>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>V</mi>
              <mi>t</mi>
              <mn>2</mn>
            </msubsup>
          </mrow>
          <mo>)</mo>
        </mrow>
      </msqrt>
      <mo>*</mo>
      <msqrt>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msubsup>
              <mi>H</mi>
              <mrow>
                <mi>i</mi>
                <mo>,</mo>
                <mi>j</mi>
              </mrow>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>S</mi>
              <mrow>
                <mi>i</mi>
                <mo>,</mo>
                <mi>j</mi>
              </mrow>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>V</mi>
              <mrow>
                <mi>i</mi>
                <mo>,</mo>
                <mi>j</mi>
              </mrow>
              <mn>2</mn>
            </msubsup>
          </mrow>
          <mo>)</mo>
        </mrow>
      </msqrt>
    </mrow>
  </mfrac>
</mrow>
</math>
</maths>
<br/>
where H<sub>t</sub>, S<sub>t </sub>and V<sub>t </sub>are the reference values for hue saturation and brightness, respectively, of healthy tissue.
</p>
<p id="p-0036" num="0035">Once the distance matrices are obtained, decision calculator <b>28</b> calculates (step <b>116</b>) a probability indication function &#x39b; according to the following equation:</p>
<p id="p-0037" num="0036">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mrow>
  <mi>&#x39b;</mi>
  <mo>=</mo>
  <mrow>
    <munder>
      <mo>&#x2211;</mo>
      <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mi>j</mi>
      </mrow>
    </munder>
    <mo>&#x2062;</mo>
    <mrow>
      <mo>{</mo>
      <mrow>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msub>
              <mi>&#x3b2;</mi>
              <mrow>
                <mi>i</mi>
                <mo>,</mo>
                <mi>j</mi>
              </mrow>
            </msub>
            <mo>&#x2264;</mo>
            <mi>BloodThreshold</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>&#x22c2;</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mfrac>
              <msub>
                <mi>&#x3d1;</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
              </msub>
              <msub>
                <mi>&#x3b2;</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
              </msub>
            </mfrac>
            <mo>&#x2265;</mo>
            <mi>TissueRatioThreshold</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>}</mo>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
The threshold can be set to any value, In a preferred embodiment, the threshold values are as follows: BloodThreshold=0.15 and TissueRatioThreshold=4. Blood exists if &#x39b;&#x3e;0.
</p>
<p id="p-0038" num="0037">Finally, image monitor <b>18</b>&#x2032; displays (step <b>118</b>) the results, either as a color video showing the presence of blood, or as a graph or table indicating the levels and/or threshold values.</p>
<p id="p-0039" num="0038">Display of results may include incorporation of a position indicator, so that the end user can determine where the presence of color change is within the GI tract, or other body lumen. Thus, the physician will be able to deal with the problem area.</p>
<p id="p-0040" num="0039">It will be appreciated by persons skilled in the art that the present invention is not limited to what has been particularly shown and described hereinabove. Rather the scope of the present invention is defined only by the claims that follow:</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08626268-20140107-M00001.NB">
<img id="EMI-M00001" he="10.24mm" wi="76.20mm" file="US08626268-20140107-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08626268-20140107-M00002.NB">
<img id="EMI-M00002" he="10.58mm" wi="76.20mm" file="US08626268-20140107-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08626268-20140107-M00003.NB">
<img id="EMI-M00003" he="9.14mm" wi="76.20mm" file="US08626268-20140107-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for processing in-vivo information, the method comprising:
<claim-text>receiving, at a data processor, data generated by a swallowable in-vivo device traversing a gastrointestinal tract, the data comprising a set of in-vivo images of the gastrointestinal tract;</claim-text>
<claim-text>the data processor comparing values of an image from the received set of images to a reference value of blood;</claim-text>
<claim-text>the data processor calculating an adaptive reference value of healthy tissue for the image, based on averaging parameters of images of healthy tissue, the images previous to the image in the received set of images;</claim-text>
<claim-text>the data processor comparing values of the image to the adaptive reference value of healthy tissue; and</claim-text>
<claim-text>based on the comparisons, the data processor generating a probability indication of a presence of blood in the image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising displaying, based on the probability indication, a color video showing a presence of bleeding.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising displaying a position in the gastrointestinal tract where the image was taken.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the values of the image comprise colorimetric parameters.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the values of the image comprise color components.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the presence of blood in the image is a presence of bleeding.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein comparing values of the image from the received set of images to the reference value of blood comprises calculating a Euclidian distance between the values of the image and the reference value of blood.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein comparing values of the image to the adaptive reference value of healthy tissue comprises calculating a Euclidian distance between the values of the image and the adaptive reference value of healthy tissue.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A system for processing in-vivo information, the system comprising:
<claim-text>a data processor configured to:</claim-text>
<claim-text>receive data generated by a swallowable in-vivo device traversing a gastrointestinal tract, the data comprising a set of in-vivo images of the gastrointestinal tract;</claim-text>
<claim-text>compare values of an image from the received set of images to a reference value of blood;</claim-text>
<claim-text>calculate an adaptive reference value of healthy tissue for the image, based on averaging parameters of images of healthy tissue, the images previous to the image in the received set of images;</claim-text>
<claim-text>compare values of the image to the adaptive reference value of healthy tissue; and</claim-text>
<claim-text>based on the comparisons, generate a probability indication of a presence of blood in the image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising the swallowable in-vivo device.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising a receiver for receiving signals from an in-vivo device.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising a monitor to display, based on the probability indication, a color video showing a presence of bleeding.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising a monitor configured to display a position in the gastrointestinal tract where the image was taken.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the values of the image comprise colorimetric parameters.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the values of the image comprise color components.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the presence of blood in the image is a presence of bleeding.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein comparing values of the image from the received set of images to the reference value of blood comprises calculating a Euclidian distance between the values of the image and the reference value of blood.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein comparing values of the image to the adaptive reference value of healthy tissue comprises calculating a Euclidian distance between the values of the image and the adaptive reference value of healthy tissue. </claim-text>
</claim>
</claims>
</us-patent-grant>
