<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08627055-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08627055</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12988861</doc-number>
<date>20081229</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>CN</country>
<doc-number>2008 1 0094066</doc-number>
<date>20080425</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>481</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>11</main-group>
<subgroup>30</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>7</main-group>
<subgroup>04</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>7</main-group>
<subgroup>38</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>713  2</main-classification>
<further-classification>713168</further-classification>
<further-classification>713193</further-classification>
<further-classification>726 30</further-classification>
<further-classification>726 23</further-classification>
<further-classification>712239</further-classification>
</classification-national>
<invention-title id="d2e71">Wimax terminal for calculating a first hash value to a load command and firmware and comparing the first hash value to a second hash value from the executed load command and firmware</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6308320</doc-number>
<kind>B1</kind>
<name>Burch</name>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>717154</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6779108</doc-number>
<kind>B2</kind>
<name>Ju et al.</name>
<date>20040800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>712239</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7168065</doc-number>
<kind>B1</kind>
<name>Naccache et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>717127</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7930686</doc-number>
<kind>B2</kind>
<name>Mitran et al.</name>
<date>20110400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>717148</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7937593</doc-number>
<kind>B2</kind>
<name>Chen et al.</name>
<date>20110500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713189</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>8140824</doc-number>
<kind>B2</kind>
<name>Craft</name>
<date>20120300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711217</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2003/0099358</doc-number>
<kind>A1</kind>
<name>Michael et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2003/0216927</doc-number>
<kind>A1</kind>
<name>Sridhar et al.</name>
<date>20031100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2005/0138270</doc-number>
<kind>A1</kind>
<name>Morais et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711102</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2005/0262576</doc-number>
<kind>A1</kind>
<name>Gassoway</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 30</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2006/0059547</doc-number>
<kind>A1</kind>
<name>Deloume et al.</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2006/0124730</doc-number>
<kind>A1</kind>
<name>Maloney</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>235379</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2006/0161773</doc-number>
<kind>A1</kind>
<name>Okazaki et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713168</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2007/0136609</doc-number>
<kind>A1</kind>
<name>Rudelic et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713193</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2008/0016576</doc-number>
<kind>A1</kind>
<name>Ueda et al.</name>
<date>20080100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 26</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2009/0328218</doc-number>
<kind>A1</kind>
<name>Tsurukawa</name>
<date>20091200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 23</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>CN</country>
<doc-number>1423766</doc-number>
<kind>A</kind>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>CN</country>
<doc-number>1550115</doc-number>
<kind>A</kind>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>CN</country>
<doc-number>101299849</doc-number>
<kind>A</kind>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>WO</country>
<doc-number>WO 01/61437</doc-number>
<kind>A2</kind>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>WO</country>
<doc-number>WO 03/021991</doc-number>
<kind>A1</kind>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00022">
<othercit>Supplementary European Search Report for European Patent Application No. 08874053.5-2211, dated Nov. 29, 2012 (8 pages).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00023">
<othercit>International Search Report for International Patent Application No. PCT/CN2008/073833, mailed Apr. 9, 2009.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>15</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>711217</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>711102</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713189</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713193</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713168</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>717148</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>717154</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>717127</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 30</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 23</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 26</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>235379</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>5</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110055543</doc-number>
<kind>A1</kind>
<date>20110303</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Guo</last-name>
<first-name>Junping</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Guo</last-name>
<first-name>Junping</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Clark &#x26; Elbing LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>ZTE Corporation</orgname>
<role>03</role>
<address>
<city>Shenzhen, Guangdong Province</city>
<country>CN</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Lee</last-name>
<first-name>Thomas</first-name>
<department>2115</department>
</primary-examiner>
<assistant-examiner>
<last-name>Prifti</last-name>
<first-name>Aurel</first-name>
</assistant-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/CN2008/073833</doc-number>
<kind>00</kind>
<date>20081229</date>
</document-id>
<us-371c124-date>
<date>20101021</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO2009/129687</doc-number>
<kind>A </kind>
<date>20091029</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The present invention discloses a starting method of a WiMAX terminal and a terminal thereof, wherein, the starting method comprises: step S<b>202</b>, calculating a load command and a firmware required to be loaded for starting the terminal in advance to obtain a first firmware Hash and a first load command Hash, and storing the first firmware Hash and the first load command Hash in a predefined memory of the terminal; step S<b>204</b>, in response to a starting operation of the terminal, performing starting process and starting a boot loader; step S<b>206</b>, the boot loader executing the load command transmitted by a driver of the terminal to download the firmware to the terminal; step S<b>208</b>, the boot loader calculating a second firmware Hash of the downloaded firmware and a second load command Hash of the load command transmitted by the driver; step <b>210</b>, the boot loader judging whether the first firmware Hash matches with the second firmware Hash, and judging whether the first load command Hash matches with the second load command Hash, and permitting to start the terminal under the circumstances that the first firmware Hash matches with the second firmware Hash and the first load command Hash matches with the second load command Hash.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="196.26mm" wi="132.50mm" file="US08627055-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="91.69mm" wi="165.18mm" file="US08627055-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="215.90mm" wi="142.24mm" file="US08627055-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="111.25mm" wi="161.88mm" file="US08627055-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="209.47mm" wi="157.40mm" file="US08627055-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="102.11mm" wi="128.19mm" file="US08627055-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is the U.S. national stage filing under 35 U.S.C. &#xa7;371 of International Application No. PCT/CN2008/073833, filed Dec. 29, 2008, which claims benefit of Chinese Patent Application No. 200810094066.6, filed Apr. 25, 2008.</p>
<heading id="h-0002" level="1">FILED OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to communication field and in particular to a World Interoperability for Microwave Access (WiMAX) terminal and a starting method thereof.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">The WiMAX is a novel air interface standard proposed aiming at the frequency band of microwave and millimeter wave, it can support time division duplex (TDD) and frequency division duplex (FDD), and support selecting channel bandwidth step by step, wherein the bandwidth frequency can be 20 MHz, 10 MHz, 5 MHz, 2.5 MHz or 1.25 MHz, so that the operator can customize service and price for customers.</p>
<p id="p-0005" num="0004">In virtue of the channel of 20 MHz and optimal modulation (namely, 256 Quadrature Amplitude Modulation (QAM)), the data transmission rate of the WiMAX can reach as high as 70-100 MB/s. Furthermore, adaptive modulation method is added in WiMAX technology, and this method allows wireless devices to select optimal modulation automatically according to link range, noises and other conditions. Besides, orthogonal frequency division multiplexing (OFDM) is also added in the WiMAX technology, this is a modulation/multiplexing/access technology for transmitting signals through a wideband, and similar to the CDMA, the OFDM can also reduce the influence of the following factors to the greatest extent, such as multiple path signal, diffraction, attenuation, and other phenomena related to microwave signal transmission. Besides, Reed Solomon forward error correction (FEC), convolutional encoding and interleaving access algorithm are also added in the WiMAX technology to determine and correct bit error. For the errors which can not be found out by the FEC, automatic repeat equipment (ARQ) function only needs to transmit the error data package again, that is, the errors could be corrected.</p>
<p id="p-0006" num="0005">In addition, in order to further improve the reliability of the link, transmission and reception diversity and adaptive antenna are also added in the WiMAX technology. In security aspect, this technology comprises the widely used triple data encryption standard (3DES) which is a 168-bit cryptographic key and has highly safe encryption performance.</p>
<p id="p-0007" num="0006">For developing a WiMAX terminal with mobile performance, the firmware of the WiMAX terminal is not stored in a flash, but stored in some place of a host, wherein the host generally refers to PC or the other hosts which use the WiMAX terminal. Whenever the device is inserted into the host and the system is started up, the firmware will be automatically downloaded to the random-access memory (RAM) of the device. After the download of the firmware image is completed, the real code of the firmware will be running on the CPU of an embedded chip.</p>
<p id="p-0008" num="0007">The downloaded firmware can visit the hardware units on all chips, therefore, if any code can be downloaded at will, some malicious codes breaking the WiMAX protocol may be run, related agreements may be breached, some un-authorized network may be visited, even the performances of base station (BS) or mobile station (MS) nearby may deteriorate. Furthermore, the firmware may visit code identification non-volatile memory (NVM) with X.509 certificate and device cryptographic key on the chip.</p>
<p id="p-0009" num="0008">Therefore, to authorize only reliable codes to run on the chip is very important. However, the technical scheme which can prevent the malicious code from running and ensure the correctness and security of terminal starting has not been proposed vet at present.</p>
<heading id="h-0004" level="1">SUMMMARY OF THE INVENTION</heading>
<p id="p-0010" num="0009">The present invention is proposed with the consideration of the problem that the correctness and security during the starting of a terminal can not be ensured in the above mentioned related art. Therefore, the present mainly aims at providing a WiMAX terminal starting method and a WiMAX terminal with starting protection function to solve at least one of above-mentioned problems.</p>
<p id="p-0011" num="0010">In order to achieve the above-mentioned aims, the present invention provides a starting method of a WiMAX terminal according to one aspect of the present invention.</p>
<p id="p-0012" num="0011">The starting method of a WiMAX terminal according to the present invention comprises: S<b>202</b>, calculating a load command and a firmware required to be loaded for starting the terminal in advance to obtain a first firmware Hash and a first load command Hash, and storing the first firmware Hash and the first load command Hash in a predefined memory of the terminal; S<b>204</b>, in response to a starting operation of the terminal, performing starting process and starting a boot loader; S<b>206</b>, the boot loader executing the load command transmitted by a driver of the terminal and downloading the firmware to the terminal; S<b>208</b>, the boot loader calculating a second firmware Hash of the downloaded firmware and a second load command Hash of the load command transmitted by the driver; <b>210</b>, the boot loader judging whether the first firmware Hash matches with the second firmware Hash, and judging whether the first load command Hash matches with the second load command Hash, and permitting to start the terminal under the circumstances that the first firmware Hash matches with the second firmware Hash and the first load command Hash matches with the second load command Hash.</p>
<p id="p-0013" num="0012">Wherein, in S<b>202</b>, after obtaining the first firmware Hash and the first load command Hash, the method further comprises: encrypting the first firmware Hash and the first load command Hash using a public key; storing the encrypted first firmware Hash and first load command Hash in the predefined memory; storing a private key corresponding to the public key in the terminal.</p>
<p id="p-0014" num="0013">Furthermore, in S<b>210</b>, during the judgment, the method further comprises: the boot loader decrypting the encrypted first firmware Hash and first load command Hash by using the stored private key, judging whether the decrypted first firmware Hash matches with the second firmware Hash, and judging whether the decrypted first load command Hash matches with the second load command Hash.</p>
<p id="p-0015" num="0014">In addition, in S<b>204</b>, the starting process comprises: after the terminal is powered on, resetting a chip of the terminal; a CPU of the terminal running the specific code in the chip to start a read only memory of the terminal, initializing the hardware units required for starting the read only memory, and performing corresponding pin configuration; the CPU reading interface configuration information stored in a non-volatile memory of the terminal.</p>
<p id="p-0016" num="0015">Besides, before the S<b>210</b>, the method further comprises: the driver transmitting the first firmware Hash and the first load command Hash to the chip of the terminal through a specific command; the boot loader obtaining the first firmware Hash and the first load command Hash in the specific command, wherein the specific command is used to start the terminal.</p>
<p id="p-0017" num="0016">Furthermore, the boot loader executes the specific command under the circumstances that the boot loader judges the first firmware Hash matches with the second firmware Hash, and the first load command Hash matches with the second load command Hash. Wherein the specific command is a skip command.</p>
<p id="p-0018" num="0017">Besides, in S<b>210</b>, under the circumstance that the judgment results are no, the method further comprises: the chip of the terminal is reset</p>
<p id="p-0019" num="0018">According to another aspect of the present invention, the present invention provides a WiMAX terminal.</p>
<p id="p-0020" num="0019">The terminal comprises: a storage module, configured to store a first firmware Hash and a first load command Hash obtained through calculating a load command and a firmware required to be loaded for starting the terminal in advance; a first starting module, configured to perform starting process and to start a boot loader in response to a starting operation of the terminal; an executing module, configured to execute the load command transmitted by a driving module of the terminal; a downloading module, configured to download the firmware to the terminal; a calculating module, configured to calculate a second firmware Hash of the downloaded firmware and a second load command Hash of the load command transmitted by the driver module; a matching module, configured to judge whether the first firmware Hash stored in the storage module matches with the second firmware Hash calculated by the calculating module, and to judge whether the first load command Hash stored in the storage module matches with the second load command Hash calculated by the calculating module; and a second starting module, configured to permit to start the terminal under the circumstances that the judging result of the matching module is: the first firmware Hash matches with the second firmware Hash and the first load command Hash matches with the second load command Hash.</p>
<p id="p-0021" num="0020">Through at least one of the above-mentioned technical schemes, the present invention obtains the firmware Hash and the load command Hash through calculating the firmware required to be loaded for starting the terminal and the load command in advance, calculates the firmware Hash and the load command Hash of the load command and the firmware downloaded by the terminal, and then matches the two firmware Hashes and the two load command Hashes respectively, starts the terminal if the matching result is yes, thus a complete security protection for the starting of the terminal can be provided the starting efficiency of the terminal is improved, and the protection processing thereof is not easy to be detected or intercepted, thereby high security is achieved.</p>
<p id="p-0022" num="0021">Other characteristics and advantages of the present invention will be described in the following specification, and will be apparent partly from the specification and embodiments of the present invention. The objects and other advantages can be realized and obtained through the structure specially illustrated in the specification, claims, and the drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0023" num="0022">The drawings are used to provide a further understanding to the present invention and constitute a part of the specification. The exemplary embodiments of the present invention and the explanation thereof are given thereafter by way of illustration only, and thus are not limitative of the present invention, and wherein:</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 1</figref> is a structural schematic diagram of a WiMAX terminal applied by the starting method of a WiMAX terminal according to a method embodiment of the present invention;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 2</figref> is a flowchart of the starting method of the WiMAX terminal according to a method embodiment of the present invention;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 3</figref> is a processing schematic diagram of the starting method of the WiMAX terminal according to a method embodiment of the present invention;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 4</figref> is a detailed flowchart of the processing after the terminal is powered on in the starting method of the WiMAX terminal according to a method embodiment of the present invention; and</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of the WiMAX terminal according to a device embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF EMBODIMENTS</heading>
<p id="p-0029" num="0028">General Description of Functions</p>
<p id="p-0030" num="0029">In the technical scheme provided by an embodiment of the present invention, the firmware required to be loaded for starting the terminal and the load command are calculated in advance, compared respectively with the calculation results of the firmware downloaded by the terminal and the load command. If the comparison result is matching, it means that the downloaded firmware is safe, and in this case the terminal will work normally; and if the comparison result is mismatching, it means that the downloaded firmware is illegal, and in this case the chip will be reset and the terminal is not able to work.</p>
<p id="p-0031" num="0030">The preferable embodiments of the present invention will be detailed hereinafter in connection with the drawings. What should be understood is that the preferable embodiments detailed hereafter are given by way of illustration only, and thus are not limitative of the present invention. What needs to be explained is that if un-conflictive, the embodiments of the present invention and the features therein can be combined with each other.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 1</figref> is a structural schematic diagram of the WiMAX terminal. As shown in <figref idref="DRAWINGS">FIG. 1</figref>, the WiMAX terminal comprises a WiMAX RF (radio frequency module), a WiMAX BB (baseband module), an EEPROM (electrically erasable programmable read only memory), a Mobile DDR RAM (mobile double-data-rate synchronous dynamic random access memory), and an express interface. Different from other types of terminals, the firmware of the WiMAX terminal is not stored in the flash, but stored in a host. When the device is inserted into the host and the system is powered on, corresponding firmware can be downloaded to the device to start running. The embodiments of the present invention will be detailed hereafter on the basis of this working mechanism.</p>
<p id="p-0033" num="0032">Method Embodiment</p>
<p id="p-0034" num="0033">A starting method of a WiMAX terminal is provided in this embodiment.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 2</figref> is a flowchart of the starting method of the WiMAX terminal according to this embodiment. As shown in <figref idref="DRAWINGS">FIG. 2</figref>, the starting method of the WiMAX terminal according to the embodiment comprises:</p>
<p id="p-0036" num="0035">Step S<b>202</b>, a load command and a firmware required to be loaded for starting the terminal are calculated in advance to obtain a first firmware Hash and a first load command Hash, and the first firmware Hash and the first load command Hash are stored in a predefined memory of the terminal, wherein, after obtaining the first firmware Hash and the first load command Hash, the first firmware Hash and the first load command Hash may be encrypted using a public key, the encrypted first firmware Hash and first load command Hash are stored in the predefined memory, and a private key corresponding to the public key is stored in the terminal.</p>
<p id="p-0037" num="0036">Step S<b>204</b>, when the terminal is started, a starting process is performed and a boot loader is started. Wherein, the starting process can be performed as follows: after the terminal is powered on, a chip of the terminal is reset; a CPU of the terminal runs the specific code in the chip to start a read only memory of the terminal, initializes the hardware units required for starting the read only memory, and performs corresponding pin configuration; the CPU reads interface configuration information stored in a non-volatile memory of the terminal.</p>
<p id="p-0038" num="0037">Step S<b>206</b>, the boot loader executes the load command transmitted by a driver of the terminal and downloads the firmware to the terminal;</p>
<p id="p-0039" num="0038">Step S<b>208</b>, the boot loader calculates a second firmware Hash of the downloaded firmware and a second load command Hash of the load command transmitted by the driver;</p>
<p id="p-0040" num="0039">Step <b>210</b>, the boot loader judges whether the first firmware Hash matches with the second firmware Hash or not, and judges whether the first load command Hash matches with the second load command Hash or not, and permits to start the terminal only under the circumstances that the judgment results are both matching. Concretely, the driver transmits the first firmware Hash and the first load command Hash to the chip of the terminal through a specific command which is used for starting the terminal; the boot loader obtains the first firmware Hash and the first load command Hash in the specific command; the boot loader decrypts the encrypted first firmware Hash and first load command Hash by using the stored private key, and judges whether the decrypted the first firmware Hash matches with the second firmware Hash, and judges whether the decrypted first load command Hash matches with the second load command Hash.</p>
<p id="p-0041" num="0040">If the boot loader judges the first firmware Hash matches with the second firmware Hash, and the first load command Hash matches with the second load command Hash, the specific command will be executed. For example, the specific command may be a skip command. On the other hand, in the specific implementing process, if any one of the judgment results in step S<b>210</b> is mismatching, the chip of the terminal will be reset.</p>
<p id="p-0042" num="0041">As seen from above descriptions, the starting method of the terminal in the embodiment of the present invention may comprise two sections: production presetting and practical use. Wherein, the production presetting section mainly completes the calculation and encryption of the Hashes of the firmware and the load command (namely, the first firmware Hash and the first load command Hash); and the practical use section relates to the processing of realizing safe Boot by the terminal. At last, the Hash results (namely, the second firmware Hash and the second load command Hash) calculated during the working of an individual device are compared with the Hash results preset by the production section. If the comparison result is yes, it means that the firmware is safe and the device will work normally; and if the comparison result is no, it means that the firmware is illegal, the chip will be reset and the terminal will not be able to work.</p>
<p id="p-0043" num="0042">Based on the above descriptions, a specific realization process of the embodiment of the present invention will be further detailed hereafter.</p>
<p id="p-0044" num="0043">Step <b>1</b>, the production presetting unit at the WiMAX terminal calculates the Hashes of the firmware and the load command, and then encrypts the Hash results thereof. This step completes the content of the production presetting section.</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 3</figref> is a processing schematic diagram of the starting method of the WiMAX terminal according to a method embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 3</figref>, the production presetting unit at the WiMAX terminal calculates the Hashes of the firmware and the load command (namely, the first firmware Hash and the first load command Hash) using a certain algorithm (e.g. SHA256), further encrypts the Hash results by using an encryption algorithm (e.g. RSA encryption private key) after obtaining the Hashes, obtains and stores the encrypted Hash results in order that the Hash messages can be restored (namely, decrypted) after the device is powered on, and judges whether the firmware and the load command are correct or not through comparing the Hash messages (namely, comparing the first firmware Hash with the second firmware Hash, and comparing the first load command Hash with the second load command Hash). Alternatively, besides the production presetting unit, the step can also be completed by a research and development unit or other units.</p>
<p id="p-0046" num="0045">Step <b>2</b>, the terminal is powered on and starts working.</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 4</figref> is a detailed flowchart of the processing after the terminal is powered on in the starting method of the WiMAX terminal according to a method embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, after the terminal is powered on, the chip is reset and the embedded CPU starts running the read only memory (ROM) code inside the chip to start the ROM, and the starting flow of the terminal begins, which is the first step of the safe Boot flow of the WiMAX terminal.</p>
<p id="p-0048" num="0047">Step <b>3</b>, the ROM code is started, the hardware units required to be used are initialized, and various kinds of configuration options are set according to GPIO pin as shown in <figref idref="DRAWINGS">FIG. 4</figref>. In this way, the foundation can be laid for invoking various software and hardware resources subsequently.</p>
<p id="p-0049" num="0048">Step <b>4</b>, the ROM code is started, whether the NVM is successfully connected is identified, and the interface configuration information is read from the NVM. Wherein, the NVM may be the EEPROM or other memories in the WiMAX terminal, and is mainly used for storing some key information such as the interface configuration information required during the starting of the terminal.</p>
<p id="p-0050" num="0049">Step <b>5</b>, after obtaining the interface configuration information from the NVM, the ROM is started, and the Boot loader is started (the safe Boot loader may be copied from the NVM to the internal static random access memory (SRAM)). Next, the Boot loader starts miming on the CPU, wherein the Boot loader can be defined as a safe boot loader, is an important unit for completing the safe starting, and can be an independent device with the following functions and features:</p>
<p id="p-0051" num="0050">(1) Prevent the stack and code of the Boot loader from being covered by download commands;</p>
<p id="p-0052" num="0051">(2) Check the firmware when the firmware is downloaded to a pure static memory, and protect special registration and the I/O information mapped by the memory;</p>
<p id="p-0053" num="0052">(3) During image download, prevent buffer memory and integer from overflowing (or other uses);</p>
<p id="p-0054" num="0053">(4) All the parameters of the download command are effective;</p>
<p id="p-0055" num="0054">(5) Only necessary download commands will be executed;</p>
<p id="p-0056" num="0055">(6) Comprise a public cryptographic key which is used for checking downloaded image signature;</p>
<p id="p-0057" num="0056">(7) During command procedure, calculate the downloaded firmware Hash (the first firmware Hash) (and when the data is copied into the static memory);</p>
<p id="p-0058" num="0057">(8) Check the image signature of downloaded firmware (including the addresses of each downloaded data block);</p>
<p id="p-0059" num="0058">(9) Perform image signature through the SHA-256 algorithm and RSA 2048 algorithm in a safety device; private signature cryptographic key does not leave safety server.</p>
<p id="p-0060" num="0059">Step <b>6</b>, according to the configuration information obtained from the NVM, the Boot loader starts to initialize related hardware and selected load interface, executes the initialization, the foundation for invoking software resources can be provided, and preparation for security identification can be completed;</p>
<p id="p-0061" num="0060">Step <b>7</b>, as shown in <figref idref="DRAWINGS">FIG. 4</figref>, the driver starts to send download command to the chip. The command is executed by the Boot loader. The download command comprises the address and data information written into the internal SRAM. After receiving the download command, the chip starts to download the firmware. As shown in <figref idref="DRAWINGS">FIG. 3</figref>, after receiving the firmware, the Boot loader calculates the Hash results of the firmware and the download command (address and data). For example, the calculation may adopt SHA-256 algorithm. The calculated results will be compared with the calculated results (as shown in <figref idref="DRAWINGS">FIG. 3</figref>) of the signature provided in step <b>8</b>. If the two kinds of results are the same, it is correct; otherwise, it is abnormal.</p>
<p id="p-0062" num="0061">Step <b>8</b>, the last download command sent by the driver is the skip command which indicates the initial position of the firmware code in detail. That the firmware code initiates from different places determines the current starting is normal or abnormal. If the starting is abnormal, the chip will be reset. The skip command also comprises the signature of the downloaded firmware, namely the preset and encrypted Hash message (namely, the first firmware Hash and the first load command Hash) in the production section.</p>
<p id="p-0063" num="0062">Step <b>9</b>, the Boot loader verifies the signature information. If the signature is effective, the Boot loader executes the skip command, and the device works normally; otherwise, the chip will be reset.</p>
<p id="p-0064" num="0063">Wherein, the Boot loader verifies the signature information according to the encryption algorithm consistent with production presetting section, for example, the RSA (2048Key) can be used to decrypt and verify the encrypted Hash information. The decrypted result will be compared with the calculated result in step <b>7</b>, to determine whether the firmware and the load command matches or not, are normal or not. Under the circumstance that the firmware and the load command are both normal, the skip command starts to execute skip action, and the device works normally; under the circumstance that the firmware and the load command are verified to be abnormal, the chip will be reset until the firmware and the load command turn normal.</p>
<p id="p-0065" num="0064">Through the above-mentioned Boot loader and the key starting flows of each section, the normal and safe starting of the device is ensured. That is to say, the device is started under the circumstance that only the firmware and the load command are both normal. When the firmware or the load command is abnormal, the chip will be reset, and the device will be rebooted again and again. In this way, the running of abnormal command or the load of abnormal firmware can be prevented.</p>
<p id="p-0066" num="0065">Device Embodiment</p>
<p id="p-0067" num="0066">In this embodiment, a WiMAX terminal with starting protection function is provided, and it is preferably applied for realizing the method in the method embodiment.</p>
<p id="p-0068" num="0067"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of the WiMAX terminal according to a device embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 5</figref>, the WiMAX terminal with the starting protection function according to the embodiment comprises: a storage module <b>2</b>, a starting module <b>4</b>, an executing module <b>6</b>, a downloading module <b>8</b>, a calculating module <b>10</b>, a matching module <b>12</b> and a second starting module <b>14</b>. Each module will be detailed hereafter:</p>
<p id="p-0069" num="0068">The storage module <b>2</b> is configured to store a first firmware Hash and a first load command Hash obtained through calculating a load command and a firmware required to be loaded for starting the terminal in advance.</p>
<p id="p-0070" num="0069">Wherein, the storage module <b>2</b> can represent one or a plurality of devices for storing data which comprise read only memory (ROM), random access memory (RAM), magnetic RAM, magnetic core memory, magnetic disc storage media, optical storage media, flash memory device, and/or other machine readable media for storing information.</p>
<p id="p-0071" num="0070">The first starting module <b>4</b>, in response to a starting request or starting operation of the terminal, starts the boot loader.</p>
<p id="p-0072" num="0071">The executing module <b>6</b> is connected to the first starting module <b>4</b>, and is configured to execute the load command transmitted by a driver module of the terminal;</p>
<p id="p-0073" num="0072">the downloading module <b>8</b> is configured to download the firmware to the terminal;</p>
<p id="p-0074" num="0073">the calculating module <b>10</b> is connected with the downloading module <b>8</b>, and is configured to calculate a second firmware Hash of the downloaded firmware and a second load command Hash of the load command transmitted by the driver module;</p>
<p id="p-0075" num="0074">the matching module <b>12</b> is connected to the storage module <b>2</b> and the calculating module <b>10</b>, is configured to judge whether the first firmware Hash stored in the storage module <b>2</b> matches with the second firmware Hash calculated by the calculating module <b>10</b>, and to judge whether the first load command Hash stored in the storage module <b>2</b> matches with the second load command Hash calculated by the calculating module <b>10</b>, and preferably to output the matching results;</p>
<p id="p-0076" num="0075">The second starting module <b>14</b> is connected to the matching module <b>12</b>, is configured to start the terminal under the circumstances that the first firmware Hash matches with the second firmware Hash, and the first load command Hash matches with the second load command Hash according to the matching results of the matching module <b>12</b>.</p>
<p id="p-0077" num="0076">The executing module <b>6</b>, downloading module <b>8</b>, calculating module <b>10</b>, matching module <b>12</b> and the second starting module <b>14</b> can be integrated in one import module.</p>
<p id="p-0078" num="0077">All in all, the embodiments of the present invention can realize complete security, namely, firmware and load command double verification. The verification process is executed inside the terminal device, and the execution time is comparatively short, so that the verification is not easy to be detected or intercepted, and the security is comparatively high. At the same time, the embodiments of the present invention merge the security verification function into the Boot flow of the device very well, improve the starting efficiency of the device under the precondition of ensuring the security. All the WiMAX terminal products designed on the basis of mainstream WiMAX terminal chip can apply the technical scheme provided by the embodiments of the present invention to perform safe Boot for the device. Therefore, the technical scheme has comparatively good compatibility. The safe Boot flow can bring security and profit protection commonly for operators, device suppliers and users, can refill the security leak of the WiMAX terminal chip manufacturer in business operation field, and moreover reduces the operation risk of the operators and the after-sale risk of the device suppliers.</p>
<p id="p-0079" num="0078">Through the technical scheme of the embodiments of the present invention, the present invention can realize complete security protection to the starting of the terminal, and improve the starting efficiency of the terminal. Furthermore, the processing of the protection is not easy to be detected or intercepted. The present invention has extraordinary high security, consequently brings security and profit protection commonly for operators, device suppliers and users, can refill the security leak of the WiMAX terminal chip manufacturer in business operation field, and moreover reduces the operation risk of the operators and the after-sale risk of the device suppliers.</p>
<p id="p-0080" num="0079">Obviously, those skilled in the art shall understand that the above-mentioned modules and steps of the present invention can be realized by using general purpose calculating device, can be integrated in one calculating device or distributed on a network which consists of a plurality of calculating devices. Alternatively, the modules and the steps of the present invention can be realized by using the executable program code of the calculating device. Consequently, they can be stored in the storage device and executed by the calculating device, or they can be made into integrated circuit module respectively, or a plurality of modules or steps thereof are made into one integrated circuit module. In this way, the present invention is not restricted to any particular hardware and software combination.</p>
<p id="p-0081" num="0080">The descriptions above are only preferable embodiments of the present invention, which are not used to restrict the present invention. For those skilled in the art, the present invention may have various changes and variations. Any amendments, equivalent substitutions, improvements etc. within the spirit and principle of the present invention are all concluded in the scope of protection of the present invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A starting method of a World Interoperability for Microwave Access (WiMAX) terminal, comprising:
<claim-text>S<b>202</b>, performing calculations for a load command and a firmware which are required to be loaded for starting the terminal in advance to obtain a first firmware Hash value and a first load command Hash value, and storing the first firmware Hash value and the first load command Hash value in a predefined memory of the terminal;</claim-text>
<claim-text>S<b>204</b>, in response to a starting operation of the terminal, performing starting process and starting a boot loader;</claim-text>
<claim-text>S<b>206</b>, the boot loader executing the load command transmitted by a driver of the terminal and downloading the firmware to the terminal;</claim-text>
<claim-text>S<b>208</b>, the boot loader calculating a second firmware Hash value of the downloaded firmware and a second load command Hash value of the load command transmitted by the driver;</claim-text>
<claim-text>S<b>210</b>, the boot loader judging whether the first firmware Hash value matches with the second firmware Hash value, and judging whether the first load command Hash value matches with the second load command Hash value, and permitting to start the terminal under the circumstances that the first firmware Hash value matches with the second firmware Hash value and the first load command Hash value matches with the second load command Hash value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein in step S<b>202</b>, storing the first firmware Hash value and the first load command Hash value in a predefined memory of the terminal comprises:
<claim-text>encrypting the first firmware Hash value and the first load command Hash value using a public key;</claim-text>
<claim-text>storing the encrypted first firmware Hash and first load command Hash in the predefined memory;</claim-text>
<claim-text>after the storing, step S<b>202</b> further comprises:</claim-text>
<claim-text>storing a private key corresponding to the public key in the terminal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein in step S<b>210</b>, before judging whether the Hash values are matching, the method further comprises:
<claim-text>the boot loader decrypting the encrypted first firmware Hash value and first load command Hash value by using the stored private key, to obtain a decrypted first firmware Hash value and a decrypted first load command Hash value;</claim-text>
<claim-text>the operation of judging whether the Hash values are matching comprises: judging whether the decrypted first firmware Hash value matches with the second firmware Hash value, and judging whether the decrypted first load command Hash value matches with the second load command Hash value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein in step S<b>204</b>, the starting process comprises:
<claim-text>after the terminal is powered on, resetting a chip of the terminal;</claim-text>
<claim-text>a CPU of the terminal running specific code in the chip to start a read only memory of the terminal, initializing the hardware units required for starting the read only memory, and performing corresponding pin configuration;</claim-text>
<claim-text>the CPU reading interface configuration information stored in a non-volatile memory of the terminal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein before step S<b>210</b>, the method further comprises:
<claim-text>the driver transmitting the first firmware Hash value and the first load command Hash value to the chip of the terminal through a specific command; the boot loader obtaining the first firmware Hash value and the first load command Hash value in the specific command, wherein the specific command is used to start the terminal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the boot loader executes the specific command under the circumstances that the boot loader judges the first firmware Hash value matches with the second firmware Hash value, and the first load command Hash value matches with the second load command Hash value.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the specific command is a skip command.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein in step S<b>210</b>, under the circumstance that the boot loader judges the first firmware Hash value does not match with the second firmware Hash value, and/or the first load command Hash value does not match with the second load command Hash value, the chip of the terminal is reset.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A World Interoperability for Microwave Access (WiMAX) terminal, comprising:
<claim-text>a storage module (<b>2</b>), configured to store a first firmware Hash value and a first load command Hash value which are obtained through performing calculations for a load command and a firmware which are required to be loaded for starting the terminal in advance;</claim-text>
<claim-text>a first starting module (<b>4</b>), configured to perform starting process and to start a boot loader in response to a starting operation of the terminal;</claim-text>
<claim-text>an executing module (<b>6</b>), configured to execute the load command transmitted by a driving module of the terminal;</claim-text>
<claim-text>a downloading module (<b>8</b>), configured to download the firmware to the terminal;</claim-text>
<claim-text>a calculating module (<b>10</b>), configured to calculate a second firmware Hash value of the downloaded firmware and a second load command Hash value of the load command transmitted by the driver module;</claim-text>
<claim-text>a matching module (<b>12</b>), configured to judge whether the first firmware Hash value stored in the storage module matches with the second firmware Hash value calculated by the calculating module, and to judge whether the first load command Hash value stored in the storage module matches with the second load command Hash value calculated by the calculating module; and</claim-text>
<claim-text>a second starting module (<b>14</b>), configured to permit to start the terminal under the circumstances that the judging result of the matching module is: the first firmware Hash value matches with the second firmware Hash value and the first load command Hash value matches with the second load command Hash value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein in step S<b>210</b>, under the circumstance that the boot loader judges the first firmware Hash value does not match with the second firmware Hash value, and/or the first load command Hash value does not match with the second load command Hash value, the chip of the terminal is reset.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein in step S<b>210</b>, under the circumstance that the boot loader judges the first firmware Hash value does not match with the second firmware Hash value, and/or the first load command Hash value does not match with the second load command Hash value, the chip of the terminal is reset.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein in step S<b>210</b>, under the circumstance that the boot loader judges the first firmware Hash value does not match with the second firmware Hash value, and/or the first load command Hash value does not match with the second load command Hash value, the chip of the terminal is reset.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein in step S<b>210</b>, under the circumstance that the boot loader judges the first firmware Hash value does not match with the second firmware Hash value, and/or the first load command Hash value does not match with the second load command Hash value, the chip of the terminal is reset.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein in step S<b>210</b>, under the circumstance that the boot loader judges the first firmware Hash value does not match with the second firmware Hash value, and/or the first load command Hash value does not match with the second load command Hash value, the chip of the terminal is reset.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein in step S<b>210</b>, under the circumstance that the boot loader judges the first firmware Hash value does not match with the second firmware Hash value, and/or the first load command Hash value does not match with the second load command Hash value, the chip of the terminal is reset. </claim-text>
</claim>
</claims>
</us-patent-grant>
