<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625856-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625856</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13237310</doc-number>
<date>20110920</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<us-term-extension>127</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>382110</main-classification>
</classification-national>
<invention-title id="d2e53">Method and system for wholesomeness inspection of freshly slaughtered chickens on a processing line</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>8126213</doc-number>
<kind>B2</kind>
<name>Chao et al.</name>
<date>20120200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382110</main-classification></classification-national>
</us-citation>
<us-citation>
<nplcit num="00002">
<othercit>&#x201c;Development of Fast Line Scanning Imaging Algorithm for Diseased Chicken Detection,&#x201d; Chun-Chieh Yang, et al, Optical Sensors and Sensing Systems for Natural Resources and Food Safety and Quality, Boston, MA, USA, Oct. 23, 2005; Proceedings of the SPIE&#x2014;The International Society for Optical Engineering, Nov. 9, 2005, vol. 5996, pp. 59960C-1-12.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00003">
<othercit>&#x201c;Development of multispectral image processing algorithms for identification of wholesome, septicemic, and inflammatory process chickens,&#x201d; Chun-Chieh Yang, et al., Journal of Food Engineering 69 (2005) 225-234.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
</us-references-cited>
<number-of-claims>18</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>382110</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>20</number-of-drawing-sheets>
<number-of-figures>20</number-of-figures>
</figures>
<us-related-documents>
<division>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>11904537</doc-number>
<date>20070927</date>
</document-id>
<parent-status>PENDING</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13237310</doc-number>
</document-id>
</child-doc>
</relation>
</division>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120008835</doc-number>
<kind>A1</kind>
<date>20120112</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Chao</last-name>
<first-name>Kuanglin</first-name>
<address>
<city>Ellicott City</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Chen</last-name>
<first-name>Yud R</first-name>
<address>
<city>Laurel</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Kim</last-name>
<first-name>Moon S</first-name>
<address>
<city>Silver Spring</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Chan</last-name>
<first-name>Diane</first-name>
<address>
<city>Odenton</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="005" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Yang</last-name>
<first-name>Chun-Chieh</first-name>
<address>
<city>Greenbelt</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Chao</last-name>
<first-name>Kuanglin</first-name>
<address>
<city>Ellicott City</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Chen</last-name>
<first-name>Yud R</first-name>
<address>
<city>Laurel</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Kim</last-name>
<first-name>Moon S</first-name>
<address>
<city>Silver Spring</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Chan</last-name>
<first-name>Diane</first-name>
<address>
<city>Odenton</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="005" designation="us-only">
<addressbook>
<last-name>Yang</last-name>
<first-name>Chun-Chieh</first-name>
<address>
<city>Greenbelt</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Fado</last-name>
<first-name>John</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Jones</last-name>
<first-name>Robert D.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="03" rep-type="attorney">
<addressbook>
<last-name>Shaw</last-name>
<first-name>Lesley</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>The United States of America as represented by the Secretary of Agriculture</orgname>
<role>06</role>
<address>
<city>Washington</city>
<state>DC</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Chen</last-name>
<first-name>Wenpeng</first-name>
<department>2665</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An imaging system containing an electron-multiplying charge-coupled device detector and line-scan spectrograph is used for identifying wholesome and unwholesome freshly slaughtered chicken carcasses on high-speed commercial chicken processing lines. Multispectral imaging algorithms allow for real-time online identification of wholesome and unwholesome chicken carcasses.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="190.84mm" wi="142.75mm" file="US08625856-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="228.01mm" wi="177.46mm" orientation="landscape" file="US08625856-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="229.70mm" wi="170.69mm" orientation="landscape" file="US08625856-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="132.67mm" wi="124.71mm" file="US08625856-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="137.24mm" wi="128.78mm" file="US08625856-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="209.63mm" wi="133.18mm" file="US08625856-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="223.18mm" wi="147.07mm" file="US08625856-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="124.29mm" wi="152.15mm" file="US08625856-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="135.04mm" wi="146.05mm" file="US08625856-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="132.33mm" wi="159.60mm" file="US08625856-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="136.57mm" wi="157.31mm" file="US08625856-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="127.76mm" wi="154.26mm" file="US08625856-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="135.30mm" wi="147.83mm" file="US08625856-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="128.44mm" wi="149.78mm" file="US08625856-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="112.69mm" wi="150.96mm" file="US08625856-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="143.26mm" wi="147.24mm" file="US08625856-20140107-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="116.08mm" wi="147.15mm" file="US08625856-20140107-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="137.67mm" wi="149.01mm" file="US08625856-20140107-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="129.20mm" wi="154.77mm" file="US08625856-20140107-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00019" num="00019">
<img id="EMI-D00019" he="139.62mm" wi="132.93mm" file="US08625856-20140107-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00020" num="00020">
<img id="EMI-D00020" he="141.39mm" wi="130.22mm" file="US08625856-20140107-D00020.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application claims the benefit of U.S. (divisional) application Ser. No. 11/904,537, filed Sep. 27, 2007, which is incorporated herein by reference in its entirety.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to an online line-scan imaging system capable of both hyperspectral and multispectral visible/near-infrared reflectance and to a method of using the system to inspect freshly slaughtered chickens on a processing line for wholesomeness and unwholesomeness. The system includes imaging apparatus, methods for image analysis and processing, and methods for use of this system for online inspection.</p>
<p id="p-0004" num="0003">The Federal Meat Inspection Act of 1906 mandated postmortem inspection of meat and poultry carcasses and authorized the U.S. Department of Agriculture (USDA) to inspect slaughter and processing operations and sanitation for meat and poultry products intended for human consumption. The 1957 Poultry Product Inspection Act mandated postmortem inspection of every bird carcass processed by a commercial facility. Since then, USDA inspectors have conducted on-site organoleptic inspection of all chickens processed at U.S. poultry plants for indications of diseases or defects. Inspectors of the USDA Food Safety and Inspection Service (FSIS) examine by sight and by touch the body, the inner body cavity surfaces, and the internal organs of every chicken carcass during processing operations.</p>
<p id="p-0005" num="0004">With the 1996 final rule on Pathogen Reduction and Hazard Analysis and Critical Control Point (HACCP) systems (USDA, Final Rule, Fed. Reg., Volume 61, 38805-38989, 1996), FSIS implemented the HACCP and Pathogen Reduction programs in meat and poultry processing plants throughout the country to prevent food safety hazards, to set specific food safety performance standards, and to establish testing programs to ensure that the performance standards are met, through the use of science-based process control systems. More recently, FSIS has also been testing the HACCP-Based Inspection Models Project (HIMP) in a small number of volunteer plants (USDA, Proposed Rule, Fed. Reg., 62: 31553-31562 (1997). HIMP requirements include zero tolerance for unwholesome chickens exhibiting symptoms of &#x201c;septox&#x201d;&#x2014;a condition of either septicemia or toxemia. Wholesome chickens do not exhibit symptoms of &#x201c;septox&#x201d;.</p>
<p id="p-0006" num="0005">Septicemia is caused by the presence of pathogenic microorganisms or their toxins in the bloodstream, and toxemia results from toxins produced by cells at a localized infection or from the growth of microorganisms. Septox birds are considered to be unwholesome and USDA inspectors remove these unwholesome birds from the processing lines during their bird-by-bird inspections, which can, by law, be conducted at a maximum speed of 35 birds per minute (bpm) for an individual inspector. The inspection process is subject to human variability, and the inspection speed restricts the maximum possible output for the processing plants while also making inspectors prone to fatigue and repetitive injury problems. This limit on production throughput, combined with increases in chicken consumption and demand over the past 2 decades, places additional pressure on both chicken production and safety inspection system. U.S. poultry plants now process over 8.8 billion broilers annually (USDA, Poultry Production and Value&#x2014;2006 Summary (2007). During processing at a typical U.S. poultry plant, birds are first slaughtered on kill lines and then transferred to evisceration lines on which inspection stations are located. Commercial evisceration lines in the U.S. currently may be operated at speeds up to 140 bpm; however, such processing lines require up to four inspection stations, each with an FSIS inspector to conduct bird-by-bird inspection at the 35 bpm speed limit.</p>
<p id="p-0007" num="0006">Machine vision technologies have been developed to address a variety of food and agricultural processing applications. Various sensing techniques such as RGB (red/green/blue) color imaging, visible and near-infrared (Vis/NIR) spectroscopy and imaging, fluorescence spectroscopy and imaging, and X-ray imaging, have been investigated for potential use in food processing and online inspection applications (Daley et al., Proc. SPIE, 2345: 403-411 (1994); Delwiche et al., Cereal Chem., 75: 412-416 (1998); Chao et al., Applied Engineering in Agriculture, 19(4): 453-458 (2003); Chao et al., Applied Engineering in Agriculture, 20(5): 683-690 (2004); Lu and Ariana, Applied Engineering in Agriculture, 18(5): 585-590 (2002); Lu, Trans. ASAE, 46(2): 523-530 (2003); Kim et al., Applied Optics, 42(9): 3927-3934 (2002); Mehl et al., Applied Engineering in Agriculture, 18(2): 219-226, 2002; Vargas et al., J. Food Science, 70(8): 471-476 (2003); Chen et al., Applied Optics, 40(8): 1195-2000 (2001).</p>
<p id="p-0008" num="0007">A variety of methods for imaging whole chicken carcasses and chicken viscera/organs have been investigated for use in food safety inspection of poultry. RGB color imaging of chicken spleens, hearts, and livers was found capable of identifying poultry disease conditions including leucosis, septicemia, airsacculitis, and ascites in the laboratory (Tao et al., Proc. SPIE, 3544: 138-145 (1998); Chao et at, Applied Engineering in Agriculture, 15(4): 363-369 (1999), but these methods required precise presentation of the visceral organs and thus were unsuitable for conventional poultry processing lines. A two-camera system using two wavebands in the visible spectrum for whole-carcass imaging was able to separate 90% of wholesome and unwholesome chickens at processing line speeds up to 70 bpm, but was not feasible for higher speed processing (Park and Chen, J. Food Processing Engineering, 23(5): 329-351 (2000); Chao et al., J. Food Engineering, 51(3): 185-192 (2002).</p>
<p id="p-0009" num="0008">Thus there remains a need to develop systems that can inspect chickens for wholesomeness in commercial processing lines which operate at speeds of at least 140 bpm.</p>
<p id="p-0010" num="0009">We have found that with appropriate methods of hyperspectral analysis and algorithms for online image processing, a machine vision system utilizing an EMCCD (Electron-Multiplying Charge-Coupled-Device) camera for multispectral inspection can satisfy both the food safety performance standards and the high-speed production requirements (e.g., at least 140 bpm) of commercial chicken processing. A system of this type can perform food safety inspection tasks accurately and with less variation in performance at high speeds (e.g., at least 140 bpm), and help poultry plants to improve production efficiency and satisfy increasing consumer demand for poultry products.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0011" num="0010">It is therefore an object of the present invention is to provide an imaging system for acquisition and processing of hyperspectral and multispectral reflectance images of freshly slaughtered chicken carcasses on processing lines for food safety inspection.</p>
<p id="p-0012" num="0011">A further object of the present invention is to provide an apparatus and process by which individual chicken carcasses can be detected for hyperspectral and multispectral imaging.</p>
<p id="p-0013" num="0012">Another object of the present invention is to provide apparatus and processes by which wholesome and unwholesome chicken carcasses can be identified using hyperspectral and multispectral imaging.</p>
<p id="p-0014" num="0013">A further object of the present invention is to provide apparatus and processes which can identify wholesome and unwholesome chicken carcasses at speeds compatible with the speeds at which chicken processing lines are operated.</p>
<p id="p-0015" num="0014">A still further object of the present invention is to provide a real-time automated inspection system for whole chicken carcasses which can quickly and accurately identify wholesome and unwholesome chicken carcasses.</p>
<p id="p-0016" num="0015">Another object of the present invention is to provide a method of hyperspectral reflectance image analysis for determining parameters to be utilized for multispectral reflectance imaging inspection of freshly slaughtered chickens.</p>
<p id="p-0017" num="0016">A further object of the present invention is to provide a method using multispectral reflectance imaging for inspecting freshly slaughtered chicken carcasses on a poultry processing line for wholesomeness.</p>
<p id="p-0018" num="0017">Another object of the present invention is to provide a method for inspecting chicken carcasses for wholesomeness by integrating the imaging system of the Present invention with commercial chicken processing lines.</p>
<p id="p-0019" num="0018">A further object of the present invention is to provide an improved inspection process for detecting and for removing or diverting unwholesome birds from chicken processing lines.</p>
<p id="p-0020" num="0019">Further objects and advantages of the invention will become apparent from the following description.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0021" num="0020">The patent or application file contains at least one drawing executed in color. Copies of this patent or patent application publication with color drawing(s) will be provided by the Office upon request and payment of the necessary fee.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 1</figref><i>a </i>is a schematic diagram of the arrangement of the hyperspectral/multispectral imaging system for operation on a poultry processing line. <figref idref="DRAWINGS">FIG. 1</figref><i>b </i>is a schematic diagram of the components of the hyperspectral/multispectral imaging inspection system. <figref idref="DRAWINGS">FIG. 1</figref><i>c </i>is a photograph of the hyperspectral/multispectral imaging inspection system on a commercial chicken processing line.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 2</figref> is a flowchart of the calibration process for the hyperspectral/multispectral imaging inspection system.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 3</figref> is a flowchart of the hyperspectral analysis method for determination of the region of interest (ROI) and key wavebands required to conduct multispectral imaging inspection of chickens for wholesomeness.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart of the method for online multispectral line-scan imaging inspection of chickens for wholesomeness.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 5</figref> is a graph of the reflectance spectra of a Spectralon diffuse reflectance standard when illuminated by the white LED line lights and by a mercury and neon calibration pen lamp.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 6</figref> is a graph of the second-order polynomial regression model used for spectral calibration of the imaging inspection system using a binning of 1 by 4.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 7</figref> shows images at four spectral wavebands of chicken carcasses that were acquired during hyperspectral line-scan imaging on the chicken processing line.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 8</figref> shows a contour image of two chicken carcasses marked with example locations of the SP (Starting Point), EP (Ending Point), m, and n parameters (described below) used for locating the ROI.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 9</figref> is a graph of the range, for each possible ROI, of difference values between average wholesome and average unwholesome chicken spectra, for optimizing the ROI to be used for inspection of chickens.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 10</figref> is a graph of average wholesome and average unwholesome chicken spectra, highlighting the 580 nm key waveband that can be used for intensity-based differentiation of wholesome and unwholesome chickens.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 11</figref> is a graph of the average wholesome and average unwholesome chicken spectra, highlighting possible key wavebands that can be used for two-waveband ratio differentiation of wholesome and unwholesome chickens.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 12</figref> is a graph of the mean and standard deviation for intensity value at key waveband 580 nm, and a second graph of the mean and standard deviation for ratio value using 580 nm and 620 nm, for wholesome and unwholesome chickens.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 13</figref> is a scatterplot graph of the distribution of chicken carcasses imaged during multispectral inspection, by the number of ROI pixels and the number of ROI lines for each chicken.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 14</figref> is an image of nine chickens with the optimized ROI highlighted on each chicken.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 15</figref> is a diagram of the structure of the fuzzy logic membership functions which use the intensity-based input value and ratio-based input value to create pixel-based decision outputs for wholesomeness classification.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 16</figref> shows a masked image (top) of nine chickens that highlights the ROI pixels to be analyzed for each chicken, and a second image (bottom) highlighting the ROI pixels for each chicken that were classified as wholesome.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 17</figref> is a scatterplot graph showing the distribution of chicken carcasses imaged during inspection shift <b>1</b>, by the number of ROI pixels and the final decision output for each chicken.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 18</figref> is a scatterplot graph showing the distribution of chicken carcasses imaged during inspection shift <b>2</b>, by the number of ROI pixels and the final decision output for each chicken.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0040" num="0039">For useful application to the task of automated chicken carcass inspection, an imaging system must be capable of operating at high speeds compatible with those at which poultry processing lines are operated. Commercial processing lines in the U.S. currently may be operated at speeds up to 140 bpm. The system must accurately detect individual birds on the processing line, process the spectral image data, and produce a classification result. Typical processing plant conditions also necessitate that the imaging system provide adequate illumination of the chicken carcasses for effective imaging. An imaging system capable of inspecting chicken carcasses with high speed and accuracy on a processing line will improve production efficiency of chicken processing plants and improve food safety inspection programs for chicken products.</p>
<p id="p-0041" num="0040">The present invention concerns in part a line-scan imaging system capable of both hyperspectral and multispectral reflectance imaging for online operation on chicken processing lines, and methods of hyperspectral analysis, multispectral classification of wholesome and unwholesome chickens for food safety inspection, and implementation of the system for operation on chicken processing lines.</p>
<p id="p-0042" num="0041">Imaging system <b>10</b> (<figref idref="DRAWINGS">FIG. 1</figref><i>a</i>) includes a means for obtaining spectral images <b>12</b>, a lighting system <b>2</b>, a means of providing a dark non-reflective imaging background <b>3</b>, and a data processing unit <b>7</b>. One embodiment of the present invention includes a hyperspectral/multispectral imaging system <b>10</b> (<figref idref="DRAWINGS">FIG. 1</figref><i>b</i>). Hyperspectral/multispectral imaging system <b>10</b> includes at least a means for obtaining spectral images <b>12</b>, such as, for example, an Electron-Multiplying Charge-Coupled-Device (EMCCD) imaging detector <b>1</b>A; a lighting system <b>2</b>; and a data processing unit <b>7</b>. The means for collecting spectral images <b>12</b> for purposes of this embodiment includes an Electron-Multiplying Charge-Coupled-Device (EMCCD) <b>1</b>A, a lens assembly <b>1</b>B, and a line-scan spectrograph <b>1</b>C.</p>
<p id="p-0043" num="0042">Device <b>1</b>A can be an Electron-Multiplying Charge-Coupled-Device (EMCCD). Examples of EMCCD include, for example, PhotonMAX 512b (Roper Scientific, Inc., Trenton, N.J.) and iXon and Luca (Andor Technology Limited, CT). EMCCD-based cameras can accommodate low-light imaging environments and both hyperspectral and multispectral imaging of rapidly moving targets. Their high quantum efficiencies, rapid frame-transfer mechanisms, and pre-output signal amplification via electron-multiplication also allow significantly improved signal-to-readout-noise ratios. When utilized for line-scan imaging, software controls for an EMCCD camera eliminate the need for the mechanical operation of a shutter and can operate the same camera for either hyperspectral or multispectral imaging without necessitating hardware adjustments. Consequently, wavelengths selected through hyperspectral analysis (described below) can be easily implemented for high-speed multispectral imaging of moving targets without the need for cross-system calibration.</p>
<p id="p-0044" num="0043">Line-scan spectrograph <b>1</b>C such as Hyperspec-VNIR Series C (Headwall Photonics, Lnc., Fitchburg, Mass.) or ImSpector V10 (Specim/Spectral Imaging Ltd., Oulu, Finland), has a nominal spectral range of about 400 nm to about 1000 nm and attaches to the EMCCD imaging detector <b>1</b>A for generating line-scan images. Lens assembly <b>1</b>B includes a C-mount lens such as, for example, a Xenoplan (Schneider, Haugppauge, N.Y.) or a Nikkor (Nikon Inc., Melville, N.Y.) lens and attaches to line-scan spectrograph <b>1</b>C.</p>
<p id="p-0045" num="0044">Imaging Device <b>1</b>A has approximately 512&#xd7;512 pixels and is thermoelectrically cooled to approximately &#x2212;70&#xb0; C. (for example via a three-stage Peltier device). The imaging device is coupled with a 14-bit or 16-bit digitizer <b>17</b>, such as ST-133 (Roper Scientific, Inc., Trenton, N.J.) or CCI-23 (Andor Technology Limited, CT) with a pixel-readout rate of approximately 10 MHz to 30 MHz. An imaging spectrograph <b>1</b>C (ImSpector V10, Specim/Spectral Imaging Ltd., Oulu, Finland), and a C-mount lens <b>1</b>B (Rainbow CCTV S6&#xd7;11, International Space Optics, S.A., Irvine, Calif.) are attached to the EMCCD Imaging Device <b>1</b>A. The spectrograph aperture slit of approximately 50 microns limits the instantaneous field of view (IFOV) of the imaging system to a thin line. Light from the linear IFOV is dispersed by a prism-grating-prism line-scan spectrograph and projected onto the EMCCD Imaging Device <b>1</b>A. The spectrograph creates a two-dimensional (spatial and spectral) image for each line-scan, with the spatial dimension along the horizontal axis and the spectral dimension along the vertical axis of the EMCCD Imaging Device <b>1</b>A.</p>
<p id="p-0046" num="0045">The image signals provided by the means for obtaining spectral images <b>12</b> are input to a computer <b>7</b> via a 14-bit or 16-bit digitizer <b>17</b>, such as the ST-133 (Roper Scientific, Inc., Trenton, N.J.). The digitizer <b>17</b> performs rapid analog-to-digital conversion of the image data for each hyperspectral or multispectral line-scan image. These data are then processed by the computer <b>7</b> for image analysis and classification of wholesome and unwholesome pixels in the line-scan images.</p>
<p id="p-0047" num="0046">The hyperspectral/multispectral imaging system requires lighting system <b>2</b>. Lighting system <b>2</b> includes an illuminator <b>2</b>A with at least 10000 lux (lumen/m<sup>2</sup>) intensity and excitation wavelengths between about 400 nm and about 800 nm, such as for example, two pairs of high power, broad-spectrum white light-emitting-diode (LED) line lights (LL6212, Advanced Illumination, Inc., Rochester, Vt.) and a line-regulated direct current power supply <b>2</b>B, such as for example a Sola/Hevi-Duty S6 10A 24V DC power supply (EGS Electrical Group, Rosemont, Ill.). The lighting system is controlled manually. The hyperspectral/multispectral imaging system requires a means of providing a dark, non-reflective imaging background <b>3</b> such as, for example, a black non-reflective matte-surface acrylic or fabric panel.</p>
<p id="p-0048" num="0047">The theoretical development of algorithms <b>20</b> which are used for this purpose is based on the difference between spectral reflectance of wholesome chickens versus that of unwholesome chickens. The assumption was made that, a mathematical combination of remotely sensed spectral bands could be used to identify wholesome chickens and unwholesome chickens. The results generated by such a combination of spectral bands corresponds to the color of chicken tissue in a given image pixel as affected by the wholesomeness or unwholesomeness of the bird. The end result of such computer analysis is the generation of a qualitative analysis such as a &#x201c;wholesome/unwholesome&#x201d; determination for each chicken that passes in front of the means for obtaining spectral images. The developed algorithms <b>20</b> are implemented using commercial software <b>18</b> such as MATLAB (MathWorks, Natick, Mass.) and LabView (National Instruments Corp., Austin, Tex.).</p>
<p id="p-0049" num="0048">Hyperspectral/multispectral imaging system <b>10</b> requires calibration before line-scan images can be acquired. Re-calibration is generally not required unless the physical arrangement of the components of the imaging system is disturbed. The first step in the calibration process was to cool the imaging system to its operating temperature of &#x2212;70&#xb0; C. (<figref idref="DRAWINGS">FIG. 2</figref>, Box <b>2</b>.<b>1</b>). The next step was to set image binning, which is determined by the spectral distribution of useful wavelengths and the size of spatial image features to be processed for the application (<figref idref="DRAWINGS">FIG. 2</figref>, Box <b>2</b>.<b>2</b>). The original image size, 512&#xd7;512 pixels, was reduced by 1&#xd7;4 binning to result in line-scan images with a spatial resolution of 512 pixels (512 divided by 1) and a spectral resolution of 128 pixels (512 divided by 4) in the spectral dimension. The binning process adds together photons from adjacent pixels in the detector array and was performed by the shift register of the EMCCD Imaging Device <b>1</b>A. This produced a reduced number of pixels to be digitized by the 16-bit A/D PCI board for the computer <b>7</b> to process. Reducing total pixel readout time decreased the acquisition time of each line-scan image, which allowed higher image acquisition speed for the EMCCD Imaging Device <b>1</b>A. Because the useful spectrum of light did not span the entire width of the EMCCD Imaging Device <b>1</b>A, the first 20 and last 53 spectral channels were discarded, resulting in a final line-scan image size of 512&#xd7;55 pixels for hyperspectral imaging.</p>
<p id="p-0050" num="0049">The next step in the calibration process was physical alignment of the spectrograph <b>1</b>C to ensure uniform waveband dispersal across the spectral dimension for each spatial pixel. This alignment was ascertained by examining the spectral dispersal of the 55 wavebands for each of the 512 spatial pixels for a line-scan image: the highest intensity value among all 55 wavebands should occur at the same spectral coordinate for each of the 512 spatial pixels (<figref idref="DRAWINGS">FIG. 2</figref>, Box <b>2</b>.<b>3</b>).</p>
<p id="p-0051" num="0050">The next step in the calibration process was spectral waveband calibration that identified each spectral channel with a specific wavelength. A neon-mercury calibration lamp (Oriel Instruments, Stratford, Conn.) provided spectral reference peaks (<figref idref="DRAWINGS">FIG. 2</figref>, Box <b>2</b>.<b>4</b>) for calibration using the following second-order polynomial regression:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3bb;=0.01<i>&#xd7;n</i><sub>c</sub><sup>2</sup>+6.03<i>&#xd7;n</i><sub>c</sub>+393.70<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where &#x3bb; is the wavelength in nm and n<sub>c </sub>is the spectral channel number (<figref idref="DRAWINGS">FIG. 2</figref>, Box <b>2</b>.<b>5</b>). The spectral range of the line-scan images began at 399.94 nm for the first channel and ended at 750.42 nm for the 55<sup>th </sup>channel.
</p>
<p id="p-0052" num="0051">Following system calibration, the hyperspectral/multispectral imaging system <b>10</b> was ready to be used for the acquisition of reference line-scan images. Prior to acquiring hyperspectral chicken images, acquisition of a white reference image was performed using a 99% diffuse reflectance standard (Spectralon, LabSphere, Inc., North Sutton, N.H.) illuminated by lighting system <b>2</b>; acquisition of a dark reference image was performed by acquiring an image with the lens covered by a non-reflective opaque black fabric (<figref idref="DRAWINGS">FIG. 3</figref>, Box <b>3</b>.<b>1</b>). These reference line-scan images were used to calculate the pixel-based relative reflectance for raw hyperspectral line-scan images as follows:</p>
<p id="p-0053" num="0052">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mi>I</mi>
  <mo>=</mo>
  <mfrac>
    <mrow>
      <msub>
        <mi>I</mi>
        <mn>0</mn>
      </msub>
      <mo>-</mo>
      <mi>D</mi>
    </mrow>
    <mrow>
      <mi>W</mi>
      <mo>-</mo>
      <mi>D</mi>
    </mrow>
  </mfrac>
</mrow>
</math>
</maths>
<br/>
where I is the relative reflectance, I<sub>0 </sub>is the raw reflectance, D is the dark reference, and W is the white reference (<figref idref="DRAWINGS">FIG. 3</figref>, Box <b>3</b>.<b>3</b>).
</p>
<p id="p-0054" num="0053">Following acquisition of raw hyperspectral line-scan images of chickens (<figref idref="DRAWINGS">FIG. 3</figref>, Box <b>3</b>.<b>2</b>) and conversion to relative reflectance images (<figref idref="DRAWINGS">FIG. 3</figref>, Box <b>3</b>.<b>3</b>), analysis of the hyperspectral relative reflectance images began with removal of the background. A relative reflectance threshold value of 0.1 was set for the 620 nm waveband. For any spatial pixel in the hyperspectral reflectance image, the pixel was identified as a background pixel if its reflectance at 620 nm was lower than the 0.1 threshold value. The value of the relative reflectance for every pixel identified as a background pixel was re-assigned to be zero, thus removing these pixels from further image analysis (<figref idref="DRAWINGS">FIG. 3</figref>, Box <b>3</b>.<b>3</b>).</p>
<p id="p-0055" num="0054">The background-removed relative reflectance line-scan images were compiled to form hyperspectral image cubes of entire wholesome and unwholesome chicken carcasses (<figref idref="DRAWINGS">FIG. 3</figref>, Box <b>3</b>.<b>4</b>). Using MATLAB software, (MathWorks, Natick, Mass.), the hyperspectral chicken images were then analyzed to optimize the spatial Region of Interest (ROI) within the chicken images (<figref idref="DRAWINGS">FIG. 3</figref>, Box <b>3</b>.<b>5</b>). The optimized ROI was one which provided the greatest spectral difference between averaged wholesome pixels and averaged unwholesome pixels across all 55 wavebands, which was obtained as follows: Within a bird image, the potential ROI area spanned from an upper border across the breast of the bird to a lower border at the lowest non-background spatial pixel in each line scan, or to the last (512<sup>th</sup>) spatial pixel if there were no background pixels present at the lower edge of the image. The average relative reflectance spectrum was calculated across all ROI pixels for all wholesome chicken images, and the average relative reflectance spectrum was calculated across all ROI pixels for all unwholesome chicken images. The difference spectrum between the wholesome and unwholesome average spectra was calculated. This calculation was performed for potential ROIs of varying size, as defined by the number of ROI pixels and their vertical coordinate locations within each line-scan, to optimizethe ROI size and location by selecting the ROI that produced the greatest maximum value in its difference spectrum. Using the optimized ROI, the waveband corresponding to the greatest spectral difference between averaged wholesome chicken pixels and averaged unwholesome chicken pixels was identified as a key waveband for differentiation of wholesome, and unwholesome chicken carcasses by relative reflectance intensity (<figref idref="DRAWINGS">FIG. 3</figref>, Box <b>3</b>.<b>6</b>). Again using the optimized. ROI, the average wholesome and average unwholesome spectra were analyzed and potential two-waveband ratios were identified as several ratios using wavebands at which the average wholesome and average unwholesome chicken pixel spectra showed local maxima and local minima. The value of each potential band ratio was calculated for the average wholesome chicken pixels and for the average unwholesome chicken pixels. The two-waveband ratio showing the greatest difference in ratio value between average wholesome and average unwholesome chicken pixels was identified for use in differentiating wholesome and unwholesome chicken carcasses (<figref idref="DRAWINGS">FIG. 3</figref>, Box <b>3</b>.<b>7</b>). Multispectral imaging inspection used the key wavelength and the two-waveband ratio to differentiate between wholesome and unwholesome chicken carcasses.</p>
<p id="p-0056" num="0055">Effective multispectral imaging inspection of wholesome and unwholesome chicken carcasses on a processing line required the capacity for detecting individual bird carcasses, classifying the condition of the chicken carcass, and generating a corresponding output useful for process control, at speeds compatible with online processing line operations. LabVIEW 8.0 (National Instruments Corp., Austin, Tex.) was used to control hyperspectral/multispectral imaging system <b>10</b> to perform the tasks required for multispectral inspection of chicken carcasses on a poultry processing line. The line-by-line mode of operation was the basis of the following algorithm that was developed to detect the entry of a bird carcass into the IFOV.</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 4</figref> shows the line-by-line algorithm for multispectral inspection to detect and classify wholesome and unwholesome chicken carcasses on a processing line. First, a line-scan image was acquired that contains only raw reflectance values at the two key wavebands needed for intensity and ratio differentiation, the raw reflectance data was converted into relative reflectance data, and background pixels were removed from the image (<figref idref="DRAWINGS">FIG. 4</figref>, Box <b>4</b>.<b>1</b>). The line-scan image was checked for the presence of the SP (Starting Point) of a new bird (<figref idref="DRAWINGS">FIG. 4</figref>, Box <b>4</b>.<b>2</b>); if no SP was present, no further analysis was performed for this line-scan image and a new line-scan image was acquired. If the line-scan was found to contain an SP, then the ROI pixels were located (<figref idref="DRAWINGS">FIG. 4</figref>, Box <b>4</b>.<b>3</b>) and the D<sub>o </sub>value was calculated for each pixel in the ROI of the line-scan image (<figref idref="DRAWINGS">FIG. 4</figref>, Box <b>4</b>.<b>4</b>). With each new line-scan image acquired (<figref idref="DRAWINGS">FIG. 4</figref>, Box <b>4</b>.<b>5</b>), the ROI pixels were located, and the decision output value of D<sub>o </sub>was calculated for each pixel, until the EP (Ending Point) was detected (<figref idref="DRAWINGS">FIG. 4</figref>, Box <b>4</b>.<b>6</b>), indicating no additional line-scan images to be analyzed for the bird carcass. The average D<sub>o </sub>value for the bird was calculated (<figref idref="DRAWINGS">FIG. 4</figref>, Box <b>4</b>.<b>9</b>) and compared to the threshold value (<figref idref="DRAWINGS">FIG. 4</figref>; Box <b>4</b>.<b>10</b>) for the final determination of wholesomeness or unwholesomeness for the bird carcass (<figref idref="DRAWINGS">FIG. 4</figref>, Boxes <b>4</b>.<b>11</b> and <b>4</b>.<b>12</b>).</p>
<p id="p-0058" num="0057">With the acquisition of each new line-scan image at the start of the detection algorithm, (<figref idref="DRAWINGS">FIG. 4</figref>, Box <b>4</b>.<b>1</b>), the relative reflectance at 620 nm was examined for each of the first (uppermost) 256 pixels of the line-scan image. The value of the relative reflectance at 620 nm was always at a low-intensity (below 0.1) for these pixels when there was no chicken carcass present in the IFOV. When the relative reflectance at 620 nm increased above 0.1 for any single pixel among the uppermost 256 pixels in the line-scan image, this indicated that a chicken carcass has entered the IFOV. This indication assumed that the inverted chicken carcass was correctly hung from the processing line shackle by both legs and that the entry of the first leg into the IFOV is triggering the detection. The detection algorithm examined only the uppermost 256 pixels in order to disregard carcass wings which were always overlapped between adjacent carcasses on the processing line. After detecting a line-scan image with a single pixel among the uppermost 256 exhibiting relative reflectance greater than 0.1 at 620 nm, the subsequent line-scan images were monitored as additional pixels within the 256 pixels began showing relative reflectance values greater than 0.1 (<figref idref="DRAWINGS">FIG. 4</figref>, Box <b>4</b>.<b>2</b>). Between the first detected pixel and the 256<sup>th </sup>pixel, pixels below the first detected pixel began increasing in relative reflectance as the chicken continues to move across the field of view. There would eventually be a line-scan image with one (or several) low-intensity pixels left that was located below the first detected pixel, and above or at the 256<sup>th </sup>pixel, which was immediately followed by another line-scan in which the previous line-scan's last low-intensity pixel(s) had increased above 0.1. The last low-intensity pixel, or the pixel in the center of the last contiguous group of remaining low-intensity pixels, was identified as the Starting Point (SP) of the bird carcass and represented the junction between the thigh and the abdomen on the leading edge of the carcass.</p>
<p id="p-0059" num="0058">Similar to the above algorithm, the following algorithm was developed to detect the last relevant line-scan image for each bird as it passed through the IFOV (<figref idref="DRAWINGS">FIG. 4</figref>, Box <b>4</b>.<b>6</b>). After the SP was detected, each subsequent line-scan image was analyzed to determine if the relative reflectance intensity at 620 nm for the pixel matching the vertical coordinate of the SP was above or below 0.1 When a line-scan image was acquired for which that pixel had a relative reflectance intensity at 620 nm that was below 0.1, this pixel was identified as the Ending Point (EP) of the bird carcass, indicating that the main body of the bird had already passed through the IFOV and no further line-scans should be analyzed for that specific bird carcass.</p>
<p id="p-0060" num="0059">After the initial identification of the SP for a bird carcass, the line-scan image containing the SP and subsequent line-scan images up to the one containing the EP were analyzed, line-by-line (<figref idref="DRAWINGS">FIG. 4</figref>, Boxes <b>4</b>.<b>3</b> through <b>4</b>.<b>8</b>), using the following algorithm to classify the bird carcass. For each line-scan image, fuzzy logic membership functions were used to produce two decision outputs for each non-background pixel in the line-scan image that was located within the ROI, using the ROI and waveband parameters previously determined through hyperspectral imaging analysis. For each pixel, two fuzzy logic membership functions were used to generate wholesome and unwholesome fuzzy membership values w<sub>1 </sub>and u<sub>1</sub>, corresponding to wholesome and unwholesome chickens, from the key wavelength reflectance intensity value for that pixel. Two additional fuzzy logic membership functions were used to generate wholesome and unwholesome fuzzy membership values w<sub>2 </sub>and u<sub>2</sub>, corresponding to wholesome and unwholesome chickens, from the ratio value for that pixel. The fuzzy inference engine executed a min-max operation (Chao, K., et al., Appl. Eng. in Agric., 15(4): 363-369 (1999)) to obtain a decision output D<sub>o </sub>for each pixel based on the n membership functions as follows, where n is the number of criteria input used (in this case, n=2):
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>D</i><sub>o</sub>=max[min{<i>w</i><sub>1 </sub><i>. . . w</i><sub>n</sub>}, min{<i>u</i><sub>1 </sub><i>. . . u</i><sub>n</sub>}]<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0061" num="0060">For each pixel, the value of D<sub>o </sub>was in the range between 0 and 1, where 0 indicates 100% possibility of wholesomeness and 1 indicated 100% possibility of unwholesomeness. When the EP for that bird carcass was encountered, the average D<sub>o </sub>value for all ROI pixels for that bird was calculated (<figref idref="DRAWINGS">FIG. 4</figref>, Box <b>4</b>.<b>9</b>). The bird carcass was identified as being unwholesome if the average D<sub>o </sub>value was greater than 0.6; otherwise the chicken carcass was identified as being wholesome (<figref idref="DRAWINGS">FIG. 4</figref>, Boxes <b>4</b>.<b>10</b>, <b>4</b>.<b>11</b>, <b>4</b>.<b>12</b>).</p>
<p id="p-0062" num="0061">The hyperspectral/multispectral imaging inspection system demonstrated classification accuracies greater than 90% on commercial processing lines which were operated at speeds of 70 bpm and 140 bpm. Current processing operations in U.S. poultry plants are allowed to run at speeds up to 140 bpm.</p>
<p id="p-0063" num="0062">The following examples are intended only to further illustrate the invention and are not intended to limit the scope of the invention which is defined by the claims.</p>
<heading id="h-0006" level="1">EXAMPLES</heading>
<heading id="h-0007" level="1">Example 1</heading>
<p id="p-0064" num="0063">Calibration of the imaging system <b>10</b> was conducted for the acquisition of hyperspectral chicken images on a commercial processing line. Following the cooling of the EMCCD detector to the necessary &#x2212;70&#xb0; C. operating temperature, spectral images were acquired using a mercury-neon pen lamp. With 1 by 4 binning (4&#xd7; binning in the spectral dimension), the mercury and neon reference peaks shown in <figref idref="DRAWINGS">FIG. 5</figref> were utilized for spectral calibration; the mercury peaks at 435.84 and 546.07 nm were found to correspond to the 8<sup>th </sup>and 25<sup>th </sup>bands, respectively, and neon peaks at 614.31, 640.23, 703.24, and 724.52 nm corresponded to the 35<sup>th</sup>, 39<sup>th</sup>, 49<sup>th</sup>, and 52<sup>nd </sup>bands, respectively. <figref idref="DRAWINGS">FIG. 6</figref> shows a plot of the second-order polynomial regression that was calculated from the mercury and neon spectral peaks to calibrate the spectral axis:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>wavelength (nm)=0.01<i>X</i><sup>2</sup>+6.03<i>X+</i>393.70 (<i>r</i><sup>2</sup>=0.9999)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where X is the spectral band number. The imaging spectrum ranged from 399.94 nm (the first band) to 750.42 nm (the 55th band) with an average bandwidth of 6.02 nm. The distance between the lens and IFOV target area was 914 mm, with the LED line lights illuminating the IFOV target area from a distance of 214 mm. The IFOV spanned 177.8 mm, which translated into 512 spatial pixels, with each pixel representing an area of 0.12 mm<sup>2</sup>.
</p>
<heading id="h-0008" level="1">Example 2</heading>
<p id="p-0065" num="0064">Using the calibration from Example 1 above, hyperspectral images were acquired using imaging system <b>10</b> for 5549 wholesome chicken carcasses and 93 unwholesome chicken carcasses on a 140 bpm commercial processing line, for analysis to optimize the ROI size and location and to determine the key intensity waveband and ratio wavebands to be used for online inspection. The wholesome or unwholesome condition of the birds on the line was identified by an FSIS veterinarian who observed the birds before they passed through the illuminated IFOV, where the imaging system acquired 55-band hyperspectral data for the chicken carcasses. <figref idref="DRAWINGS">FIG. 7</figref> shows example images, at four bands, of chickens on the processing line, including one unwholesome chicken (fifth from the left) among the series in the image. The images shown were compiled using image data from the 1<sup>st</sup>, 30<sup>th</sup>, 36<sup>th</sup>, and 55<sup>th </sup>spectral bands, corresponding to 400 nm, 580 nm, 620 nm, and 750 nm.</p>
<p id="p-0066" num="0065">The hyperspectral images were analyzed to optimize the ROI size and location and the key wavebands for differentiation by reflectance intensity and by waveband ratio. <figref idref="DRAWINGS">FIG. 8</figref> shows a contour image of two examples of chicken carcasses with the SP and EP marked and connected by a line on each. The possible size and location of the ROI is described by parameters m and n, which extended below the SP-EP line. The values of m and n indicated, by percentage of the pixel length between the SP-EP line and the furthest non-background pixel below the SP-EP line, the location of the upper and lower ROI borders. The possible locations of the upper ROI border ranged between a 10% and 40% distance below the SP-EP line, and the possible locations of the lower ROI border range between a 60% and 90% distance below the SP-EP line.</p>
<p id="p-0067" num="0066">For each possible ROI, the average spectrum across all ROI pixels from the 5549 wholesome chicken carcasses, and the average spectrum across all ROI pixels from the 93 unwholesome chicken carcasses, were calculated. The difference between the average wholesome and average unwholesome value at each of the 55 bands was calculated and their range for each possible ROI is shown in <figref idref="DRAWINGS">FIG. 9</figref>. Because the 40%-60% ROI showed the range with the greatest difference values between the average wholesome and unwholesome spectra, this ROI was considered the optimized ROI to be used for multispectral inspection. As shown in <figref idref="DRAWINGS">FIG. 10</figref>, the 30<sup>th </sup>band showed the greatest difference between the average wholesome and the average unwholesome spectra from among all 55 bands for the optimized ROI; this band, corresponding to 580 nm, was selected as the key waveband to be used for intensity-based differentiation of wholesome and unwholesome chicken carcasses.</p>
<p id="p-0068" num="0067"><figref idref="DRAWINGS">FIG. 11</figref> shows the average wholesome and average unwholesome chicken spectra, marked with the wavebands that were investigated for differentiation of wholesome and unwholesome chicken carcasses by a two-waveband ratio. The average ratio values were calculated for three possible two-waveband ratios:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i><sub>440</sub><i>/W</i><sub>460</sub><i>&#x2212;U</i><sub>440</sub><i>/U</i><sub>460</sub>=0.003461<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i><sub>500</sub><i>/W</i><sub>540</sub><i>&#x2212;U</i><sub>500</sub><i>/U</i><sub>540</sub>=0.038602<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i><sub>580</sub><i>/W</i><sub>620</sub><i>&#x2212;U</i><sub>580</sub><i>/U</i><sub>620</sub>=0.115535<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
The last ratio, using the 580 nm and 620 nm wavebands, showed the greatest difference between the average wholesome and average unwholesome chicken spectra and was thus selected for use in differentiation by two-waveband ratio. <figref idref="DRAWINGS">FIG. 12</figref> shows plots of the mean and standard deviation for the 580 nm key waveband and for the key waveband ratio using 580 nm and 620 nm, for wholesome and unwholesome chickens in the hyperspectral image data set.
</p>
<heading id="h-0009" level="1">Example 3</heading>
<p id="p-0069" num="0068">The optimized ROI and key wavebands determined in Example 2 above were used for multispectral inspection of over 100,000 chickens on a 140 bpm processing line during two 8-hour shifts at a commercial poultry plant. <figref idref="DRAWINGS">FIG. 14</figref> shows examples of chicken images highlighting the ROI that was used for online inspection. The inspection program specifically determined the 40%-60% ROI for each bird, which was clearly affected by the size and position of the bird. The ROI was a regular rectangular area for a bird whose body extended past the lower edge of the image, such as the first bird in <figref idref="DRAWINGS">FIG. 14</figref>. For other birds, the presence of background pixels near the lower edge of the image resulted in irregularly shaped ROIs. <figref idref="DRAWINGS">FIG. 13</figref> shows a scatter plot for the chickens inspected during the first shift, by the number of ROI pixels and the number of ROI lines for each bird. For 99% of the birds imaged during the first 8-hour inspection shift, imaging system <b>10</b> acquired between 15 and 40 ROI line-scan images, resulting in 1000-3500 ROI pixels for classification analysis. A very small number of data points in <figref idref="DRAWINGS">FIG. 13</figref> showed an unusually high number of ROI lines and ROI pixels, or a high number of ROI lines with very few ROI pixels. These data points resulted from occasional occurrences of birds that were not correctly hung or that were unusually positioned, such as being hung by one leg or being hung by two legs but on separate shackles, that may have prevented clear distinction between individual adjacent birds by the imaging system or resulted in an elevated position within the IFOV.</p>
<p id="p-0070" num="0069">Table 1 below shows the mean and standard deviation values for relative reflectance at 580 nm for wholesome and unwholesome birds in three data subsets drawn from the hyperspectral data analysis using the 40%-60% ROI in Example 2 and each of the two inspection shifts in Example 3. Table 2 shows the mean and standard deviation values for the two-waveband ratio using 580 nm and 620 nm for wholesome and unwholesome birds for the same three data subsets. Paired t-tests showed no significant differences (P=0.05) between the three data sets for the wholesome means, and similarly no significant difference between the three data sets for the unwholesome means. This demonstrates that when the hyperspectral/multispectral imaging system <b>10</b> is appropriately and consistently operated to maintain proper distance and illumination conditions, hyperspectral data collected by the system can be appropriately used for multispectral inspection conducted at different times and locations.</p>
<p id="p-0071" num="0070">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 1</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Mean and standard deviation values for reflectance intensity</entry>
</row>
<row>
<entry>at 580 nm for wholesome and unwholesome chicken images</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="offset" colwidth="91pt" align="left"/>
<colspec colname="1" colwidth="56pt" align="center"/>
<colspec colname="2" colwidth="7pt" align="center"/>
<colspec colname="3" colwidth="56pt" align="center"/>
<colspec colname="4" colwidth="7pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Wholesome</entry>
<entry/>
<entry>Unwholesome</entry>
<entry/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="offset" colwidth="91pt" align="left"/>
<colspec colname="1" colwidth="21pt" align="center"/>
<colspec colname="2" colwidth="42pt" align="center"/>
<colspec colname="3" colwidth="28pt" align="center"/>
<colspec colname="4" colwidth="35pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Mean</entry>
<entry>SD</entry>
<entry>Mean</entry>
<entry>SD</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="6">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="77pt" align="left"/>
<colspec colname="2" colwidth="21pt" align="center"/>
<colspec colname="3" colwidth="42pt" align="center"/>
<colspec colname="4" colwidth="28pt" align="center"/>
<colspec colname="5" colwidth="35pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Hyperspectral Analysis</entry>
<entry>0.378</entry>
<entry>0.088</entry>
<entry>0.243</entry>
<entry>0.076</entry>
</row>
<row>
<entry/>
<entry>Inspection Shift 1</entry>
<entry>0.419</entry>
<entry>0.115</entry>
<entry>0.253</entry>
<entry>0.069</entry>
</row>
<row>
<entry/>
<entry>Inspection Shift 2</entry>
<entry>0.398</entry>
<entry>0.083</entry>
<entry>0.253</entry>
<entry>0.075</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="5" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0072" num="0071">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 2</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Mean and standard deviation values for two-waveband ratio using</entry>
</row>
<row>
<entry>580 nm and 620 nm for wholesome and unwholesome chicken images</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="offset" colwidth="91pt" align="left"/>
<colspec colname="1" colwidth="56pt" align="center"/>
<colspec colname="2" colwidth="7pt" align="center"/>
<colspec colname="3" colwidth="56pt" align="center"/>
<colspec colname="4" colwidth="7pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Wholesome</entry>
<entry/>
<entry>Unwholesome</entry>
<entry/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="offset" colwidth="91pt" align="left"/>
<colspec colname="1" colwidth="21pt" align="center"/>
<colspec colname="2" colwidth="42pt" align="center"/>
<colspec colname="3" colwidth="28pt" align="center"/>
<colspec colname="4" colwidth="35pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Mean</entry>
<entry>SD</entry>
<entry>Mean</entry>
<entry>SD</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="6">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="77pt" align="left"/>
<colspec colname="2" colwidth="21pt" align="center"/>
<colspec colname="3" colwidth="42pt" align="center"/>
<colspec colname="4" colwidth="28pt" align="center"/>
<colspec colname="5" colwidth="35pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Hyperspectral Analysis</entry>
<entry>0.948</entry>
<entry>0.037</entry>
<entry>0.904</entry>
<entry>0.052</entry>
</row>
<row>
<entry/>
<entry>Inspection Shift 1</entry>
<entry>0.958</entry>
<entry>0.033</entry>
<entry>0.918</entry>
<entry>0.048</entry>
</row>
<row>
<entry/>
<entry>Inspection Shift 2</entry>
<entry>0.941</entry>
<entry>0.038</entry>
<entry>0.919</entry>
<entry>0.048</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="5" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0073" num="0072">For multispectral classification, fuzzy logic membership functions were built based on the mean and standard deviation values for the 580 nm key waveband from the hyperspectral analysis data subset, and on the mean and standard deviation values for the 580 nm and 620 nm two-waveband ratio, again from the hyperspectral analysis data subset. <figref idref="DRAWINGS">FIG. 15</figref> shows the structure of the fuzzy logic membership functions. These functions were used to classify each ROI pixel within an image as either wholesome or unwholesome, by using each pixel's 580 nm intensity value at 580 nm and its ratio value as inputs to obtain a decision output value D<sub>o </sub>between 0 and 1. The average D<sub>o </sub>value for a bird was used to determine a wholesome or unwholesome assignment by comparison with a threshold value. <figref idref="DRAWINGS">FIG. 16</figref> first shows a masked image of nine chickens with all ROI pixels highlighted for each chicken (top), and then another image highlighting only those ROI pixels that were classified as wholesome pixels (bottom), i.e., D<sub>o </sub>values of individual pixels were each compared to the 0.6 threshold value. The fourth chicken from the left is an unwholesome bird and all of its ROI pixels were identified as unwholesome, consequently not appearing in the second image (bottom).</p>
<p id="p-0074" num="0073"><figref idref="DRAWINGS">FIGS. 17 and 18</figref> show scatterplots of the imaging system's decision outputs against the number of ROI pixels for each chicken imaged during inspection shifts <b>1</b> and <b>2</b>. The total numbers of wholesome and unwholesome chickens identified by the system are shown in Table 3 below, compared with numbers drawn from FSIS tally sheets created by three inspection stations on the same processing line during those two inspection shifts. Although direct bird-to-bird comparison between the imaging inspection system and the inspectors was not possible, surprisingly the percentages indicated that the relative numbers of wholesome and unwholesome identified by the imaging inspection system and by the processing line inspectors were not significantly different.</p>
<p id="p-0075" num="0074">
<tables id="TABLE-US-00003" num="00003">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="266pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 3</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Wholesome and unwholesome birds identified during inspection shifts </entry>
</row>
<row>
<entry>by processing line inspectors and by the imaging inspection system</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="28pt" align="left"/>
<colspec colname="2" colwidth="119pt" align="center"/>
<colspec colname="3" colwidth="119pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Line inspectors</entry>
<entry>Imaging inspection system</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="7">
<colspec colname="1" colwidth="28pt" align="left"/>
<colspec colname="2" colwidth="42pt" align="center"/>
<colspec colname="3" colwidth="49pt" align="center"/>
<colspec colname="4" colwidth="28pt" align="center"/>
<colspec colname="5" colwidth="42pt" align="center"/>
<colspec colname="6" colwidth="49pt" align="center"/>
<colspec colname="7" colwidth="28pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Wholesome</entry>
<entry>Unwholesome</entry>
<entry>Total</entry>
<entry>Wholesome</entry>
<entry>Unwholesome</entry>
<entry>Total</entry>
</row>
<row>
<entry namest="1" nameend="7" align="center" rowsep="1"/>
</row>
<row>
<entry>Shift 1</entry>
<entry>53563</entry>
<entry>84</entry>
<entry>53647</entry>
<entry>45305</entry>
<entry>288</entry>
<entry>45593</entry>
</row>
<row>
<entry/>
<entry>(99.84%)</entry>
<entry>(0.16%)</entry>
<entry>(100%)</entry>
<entry>(99.37%)</entry>
<entry>(0.63%)</entry>
<entry>(100%)</entry>
</row>
<row>
<entry>Shift 2 </entry>
<entry>64972</entry>
<entry>71</entry>
<entry>65043</entry>
<entry>60922</entry>
<entry>&#x2002;98</entry>
<entry>61020</entry>
</row>
<row>
<entry/>
<entry>(99.89%)</entry>
<entry>(0.11%)</entry>
<entry>(100%)</entry>
<entry>(99.84%)</entry>
<entry>(0.16%)</entry>
<entry>(100%)</entry>
</row>
<row>
<entry namest="1" nameend="7" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0076" num="0075">A veterinarian also conducted several period of system verification, each lasting approximately 30 to 40 minutes. The veterinarian conducted bird-by-bird observation of chicken carcasses immediately before they entered the IFOV of the imaging system. The imaging system output was observed for agreement with the veterinarian's identifications. The veterinarian observed 16,174 wholesome birds and 43 unwholesome birds over 4 verification periods during inspection shift 1. Of these birds, the imaging system surprisingly incorrectly identified only 118 wholesome birds (99.27% correct) and 2 unwholesome birds (95.35% correct). The veterinarian observed 27,626 wholesome birds and 35 unwholesome birds over 6 verification periods during inspection shift 2. Of these birds, the imaging system surprisingly incorrectly identified only 46 wholesome birds (99.83% correct) and 1 unwholesome bird (97.14% correct). These results, together with the percentages listed in Table 3, strongly suggest that the imaging inspection system can perform successfully on a commercial poultry processing line.</p>
<p id="p-0077" num="0076">For multispectral inspection as conducted on a 140 bpm processing line as was performed for this example, the imaging system acquired about 30 to 40 line-scan images between the SP and EP for each chicken inspected. Previous testing of the imaging system on a 70 bpm processing line demonstrated similar performance in identification of wholesome and unwholesome birds with the analysis of about 70-80 line-scan images for each chicken. Because the unwholesome birds exhibit a systemic unwholesome condition affecting the entire body of the bird, this line-scan imaging system is able to identify such birds at even higher speeds; on a 200 bpm processing line, for example, the system would perform similarly in identifying wholesome and unwholesome birds by analyzing about 20-25 line-scan images for each chicken.</p>
<p id="p-0078" num="0077">U.S. Pat. No. 6,587,575 is herein incorporated by reference. The following references were authored or co-authored by the inventors and are relevant to the current disclosure: Chao et al, Applied Engineering in Agriculture, 18(1): 78-84 (2002); Chao et al., Proc. SPIE, 6381: 63810V1-63810V11 (2006); Chao et al., J. Sensing and Instrumentation for Food Quality and Safety, 1(2): 62-71 (2007); Lawrence et al, Trans. ASAE, 46(2): 513-521 (2003); Park et al, Trans. ASAE, 45(6): 2017-2026 (2003); Park et al., J. Food Processing Engineering, 27(5): 311-327 (2005); Yang et al., J. Food Engineering, 69(2): 225-234 (2005); Yang et al., Proc. SPIE, 6381: 63810Y1-63810Y10 (2006); Yang et al., Trans. ASAE, 49(1): 245-257 (2006).</p>
<p id="p-0079" num="0078">Thus, in view of the above, the present invention concerns (in part) the following:</p>
<p id="p-0080" num="0079">An imaging system for food safety-wholesomeness inspection of freshly slaughtered chicken carcasses on a processing line (for acquisition and processing of hyperspectral/multispectral reflectance images of freshly slaughtered chicken carcasses on a processing line for food safety inspection), comprising (or consisting essentially of or consisting of):
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0080">a means for obtaining both hyperspectral and multispectral images (of freshly slaughtered chicken carcasses on a processing line), and</li>
        <li id="ul0002-0002" num="0081">a data acquisition/processing unit operatively connected to said means for obtaining hyperspectral and multispectral images
<br/>
(wherein the system is capable of hyperspectral/multispectral imaging to detect individual chicken carcasses on a processing line and to determine the wholesome or unwholesome condition of a chicken carcass).
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0081" num="0082">The above imaging system wherein said system further comprises a lighting system (operatively connected to said means for obtaining hyperspectral and multispectral images).</p>
<p id="p-0082" num="0083">The above imaging system wherein said system further comprises a means of creating a dark imaging background.</p>
<p id="p-0083" num="0084">The above imaging system wherein said means for obtaining hyperspectral and multispectral images comprises (only one of each):
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0085">(an imaging device utilizing) an electron-multiplying charge-coupled device detector,</li>
        <li id="ul0004-0002" num="0086">a (14-bit and/or 16-bit) digitizer operatively connected to said electron multiplying charge-coupled device detector (wherein said digitizer has a pixel-readout rate in the range of approximately 10 MHz to approximately 30 MHz),</li>
        <li id="ul0004-0003" num="0087">a line-scan spectrograph operatively connected to said electron-multiplying charge-coupled device detector, and</li>
        <li id="ul0004-0004" num="0088">a lens assembly operatively connected to said line-scan spectrograph.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0084" num="0089">The above imaging system wherein said means for obtaining hyperspectral and multispectral images does not include a shutter.</p>
<p id="p-0085" num="0090">The above imaging system wherein said lighting system comprises continuous wave light sources for reflectance imaging.</p>
<p id="p-0086" num="0091">The above imaging system wherein said lighting system comprises at least two continuous wave light sources for reflectance imaging to provide illumination spanning at least 400 nm to 800 nm in the visible/near-infrared spectrum with a total intensity of at least 10,000 lux (lumens/m<sup>2</sup>).</p>
<p id="p-0087" num="0092">The above imaging system wherein said data acquisition/processing unit is encoded with algorithms for hyperspectral/multispectral image acquisition, analysis, and classification.</p>
<p id="p-0088" num="0093">A method of determining parameters for multispectral inspection of freshly slaughtered chicken carcasses to identify wholesome and unwholesome chicken carcasses (by analyzing a set of hyperspectral images of wholesome and unwholesome chicken carcasses), comprising (or consisting essentially of or consisting of):
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0094">(a) optimization of the location and size of a Region of Interest within individual bird images for identification of wholesome and unwholesome chicken carcasses by spectral analysis;</li>
        <li id="ul0006-0002" num="0095">(b) selection of key wavebands based on reflectance intensity at a single waveband and on ratio of reflectance intensities at two wavebands for input into a fuzzy logic classifier to identify wholesome and unwholesome chicken carcasses wavebands;</li>
        <li id="ul0006-0003" num="0096">(c) construction of fuzzy logic membership functions for identifying wholesome and unwholesome chickens, by use of the following algorithm:
        <ul id="ul0007" list-style="none">
            <li id="ul0007-0001" num="0097">(i) specify the size and location of potential Region of Interest selections across the breast area of chicken carcass images relative to vertical pixel coordinates within the images, for which said pixel coordinates are defined by percentage values of the distance extending from a horizontal line across the chicken breast area towards the chicken neck area to the furthest non-background pixel;</li>
            <li id="ul0007-0002" num="0098">(ii) for each potential Region of Interest selection, calculate the average reflectance spectrum calculated using all Region of Interest pixels for all wholesome chickens in the set of hyperspectral images;</li>
            <li id="ul0007-0003" num="0099">(iii) for each potential Region of Interest selection, calculate the average reflectance spectrum calculated using all Region of Interest pixels for all unwholesome chickens in the set of hyperspectral images;</li>
            <li id="ul0007-0004" num="0100">(iv) for each potential Region of Interest selection, calculate the difference spectrum between the average wholesome spectrum and average unwholesome spectrum, and note the maximum difference value that occurs for each potential Region of Interest;</li>
            <li id="ul0007-0005" num="0101">(v) compare the maximum difference values from all potential Regions of Interest to select the Region of Interest that resulted in the greatest maximum difference value as the optimized Region of Interest to use for multispectral identification of wholesome and unwholesome chicken carcasses;</li>
            <li id="ul0007-0006" num="0102">(vi) select the waveband corresponding to the greatest maximum difference value of the optimized Region of Interest as the key wavelength to use for multispectral identification of wholesome and unwholesome chickens based on reflectance intensity;</li>
            <li id="ul0007-0007" num="0103">(vii) using the optimized Region of Interest calculate the mean and standard deviation of reflectance intensity at the key wavelength from (vi) for wholesome chickens and calculate the mean and standard deviation of reflectance intensity values at the key wavelength for unwholesome chickens;</li>
            <li id="ul0007-0008" num="0104">(viii) specify potential pairs of key wavebands selected according to local maxima and minima in the difference spectrum of the optimized Region of Interest;</li>
            <li id="ul0007-0009" num="0105">(ix) calculate the band ratio value for each potential pair of key wavebands for the average wholesome Region of Interest reflectance spectrum calculated in (ii) and the average unwholesome Region of Interest reflectance spectrum calculated in (iii);</li>
            <li id="ul0007-0010" num="0106">(x) select the waveband pair corresponding to the greatest difference between band ratio values for wholesome and unwholesome as the key waveband pair to use for multispectral identification of wholesome and unwholesome chicken carcasses based on ratio value;</li>
            <li id="ul0007-0011" num="0107">(xi) using the optimized Region of Interest, calculate the mean and standard deviation of the two-waveband ratio from (x) for wholesome chickens and calculate the mean and standard deviation of the two-waveband ratio for unwholesome chickens; and</li>
            <li id="ul0007-0012" num="0108">(xii) construct fuzzy logic membership functions based on the mean and standard deviation values for key wavelength (intensity) and two-waveband ratio values for wholesome and unwholesome chickens.</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0089" num="0109">The above method wherein a set of hyperspectral images of freshly slaughtered wholesome and unwholesome chicken carcasses is acquired with the use of an imaging system with at least one electron-multiplying charge-coupled device detector operatively connected to both a spectrograph and a lens assembly.</p>
<p id="p-0090" num="0110">The above method wherein a set of hyperspectral images of freshly slaughtered wholesome and unwholesothe chicken carcasses is acquired with the use of a lighting system providing continuous wave illumination spanning at, least 400 nm to 800 nm in the visible/near-infrared region of the electromagnetic spectrum of at least 10,000 lux(lumen/m<sup>2</sup>) and a means of providing a dark imaging background.</p>
<p id="p-0091" num="0111">A method of multispectral inspection of freshly slaughtered chicken carcasses to identify wholesome and unwholesome chicken carcasses on a chicken processing line, comprising (or consisting essentially of or consisting of):
<ul id="ul0008" list-style="none">
    <li id="ul0008-0001" num="0000">
    <ul id="ul0009" list-style="none">
        <li id="ul0009-0001" num="0112">(a) continuous real-time acquisition of line-scan images of freshly slaughtered chickens on a commercial chicken processing line (operated at speeds between about 70 to about 200 birds per minute (e.g., 70-200 bpm);</li>
        <li id="ul0009-0002" num="0113">(b) real-time analysis of individual line-scan images to identify the presence and entrance of the leading edge of a chicken into the linear field of view of the imaging inspection system;</li>
        <li id="ul0009-0003" num="0114">(c) real-time analysis of individual line-scan images to locate Region of Interest pixels for individual chickens;</li>
        <li id="ul0009-0004" num="0115">(d) real-time calculation of decision output values for Region of Interest pixels in individual line-scan images;</li>
        <li id="ul0009-0005" num="0116">(e) real-time analysis of individual line-scan images to identify the exit of the trailing edge of a chicken from the linear field of view of the imaging inspection system; and</li>
        <li id="ul0009-0006" num="0117">(f) calculation of average decision output values to identify chickens as being wholesome or unwholesome by comparison to a threshold value, by use of the following algorithm:
        <ul id="ul0010" list-style="none">
            <li id="ul0010-0001" num="0118">(i) acquire a line-scan image and analyze the line-scan image to determine if the starting point coordinate of a chicken has been assigned, if no starting point coordinate has been assigned then repeat acquisition and analysis until a line-scan image is encountered for which a starting point coordinate has been assigned;</li>
            <li id="ul0010-0002" num="0119">(ii) locate the Region of Interest pixels within the line-scan image and calculate the decision output value for each Region of Interest pixel by using the reflectance intensity and waveband ratio values at the key wavebands as inputs to the fuzzy logic membership functions for classification, acquire a new line-scan image if no ending point coordinate has been assigned, repeat location of the Region of Interest and calculation of decision output values for each Region of Interest pixel for each new line-scan image until a line-scan image is encountered for which an ending point coordinate has been assigned;</li>
            <li id="ul0010-0003" num="0120">(iii) calculate the average decision output value for the chicken across all Region of Interest pixels using values calculated in (ii); and</li>
            <li id="ul0010-0004" num="0121">(iv) compare the average decision output value with the threshold value to identify an individual bird as either wholesome or unwholesome.</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0092" num="0122">The above method wherein real-time analysis of individual line-scan images to identify the presence and entrance of the leading edge of a chicken into the linear field of view of the imaging inspection system is performed by using the following algorithm:
<ul id="ul0011" list-style="none">
    <li id="ul0011-0001" num="0000">
    <ul id="ul0012" list-style="none">
        <li id="ul0012-0001" num="0123">(a) examine the 1-dimensional data array whose indices correspond to the uppermost 256 pixels of the line-scan image with 1 at the top of the line-scan image and which contains the relative reflectance values at the 620 nm waveband of the uppermost 256 pixels, if the array contains only values corresponding to background pixels having relative reflectance below 0.1 then continue examining subsequent line-scan images until the first non-background pixel or group of pixels is detected within the array; when any non-background pixels having relative reflectance greater than 0.1 are detected, indicating that a new chicken has entered the linear field of view, note the corresponding index of the first uppermost such pixel and assign this index as the top reference coordinate, if the value of the array at the last index does not correspond to a background pixel then note the index of the last lowermost background pixel in the array and assign this index as the bottom reference coordinate;</li>
        <li id="ul0012-0002" num="0124">(b) for the subsequent line-scan image, examine only the array values at the indices corresponding to and including the top reference coordinate and the bottom reference coordinate, within these indices find the index of the first uppermost background pixel and the last lowermost background pixel and reassign these indices to be the top reference coordinate and bottom reference coordinate respectively;</li>
        <li id="ul0012-0003" num="0125">(c) for each subsequent line-scan image continue searching for first and last background pixels between the top reference coordinate and bottom reference coordinate and then re-assigning the reference coordinates to the corresponding indices; and</li>
        <li id="ul0012-0004" num="0126">(d) when a line-scan image is found for which there are no background pixels occurring between the top reference coordinate and the bottom reference coordinate, check whether the top and bottom reference coordinates are assigned to the same index value, if they are the same then assign the vertical coordinate of the corresponding image pixel to be the starting point pixel, if they are not the same then assign the median of the two indices to be the starting point for the current chicken being imaged.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0093" num="0127">The above method wherein real-time analysis of individual line-scan images to locate Region of Interest pixels for individual chickens is performed by using the following algorithm:
<ul id="ul0013" list-style="none">
    <li id="ul0013-0001" num="0000">
    <ul id="ul0014" list-style="none">
        <li id="ul0014-0001" num="0128">(a) if the starting point has been assigned for the current chicken being imaged, examine the line-scan image and find the lowermost non-background pixel within the line-scan image which may coincide with the lowermost pixel of the line-scan image if there are no background pixels that the bottom of the line-scan image;</li>
        <li id="ul0014-0002" num="0129">(b) find the number of pixels between and including the starting point coordinate and the lowermost non-background pixel and consider this the reference distance; and</li>
        <li id="ul0014-0003" num="0130">(c) with the previously determined values of parameters m and n, each in the range between 0% and 100%, select all pixels within the line-scan image that occur between m % of the reference distance and n % of the reference distance, where the starting point coordinate is at 0% and the lowermost non-background pixel is the at 100%, these selected pixels comprise the ROI for this line-scan image.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0094" num="0131">The above method wherein real-time analysis of individual line-scan images to identify the exit of the trailing edge of a chicken from the linear field of view of the imaging inspection system is performed by using the following algorithm:
<ul id="ul0015" list-style="none">
    <li id="ul0015-0001" num="0000">
    <ul id="ul0016" list-style="none">
        <li id="ul0016-0001" num="0132">(a) if the starting point has been assigned for the current chicken being imaged, examine the relative reflectance value at 620 nm of the line-scan image at the starting point coordinate;</li>
        <li id="ul0016-0002" num="0133">(b) if the value corresponds to a non-background pixel, relative reflectance greater than 1.0, do not assign a value to be the ending point coordinate; and</li>
        <li id="ul0016-0003" num="0134">(c) if the value corresponds to a background pixel, relative reflectance less than 0.1, then assign the starting point coordinate to be the ending point coordinate, indicating that the previous line-scan image was the last line-scan to be analyzed for the current chicken being imaged and no additional line-scans are to be analyzed.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0095" num="0135">The above method wherein real-time calculation of decision output values for each Region of Interest pixel in the line-scan images is performed using a fuzzy logic classifier defined by the following equation:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>D</i><sub>o</sub>=max[min{<i>w</i><sub>1</sub><i>,w</i><sub>2</sub>}, min{<i>u</i><sub>1</sub><i>,u</i><sub>2</sub>}]<?in-line-formulae description="In-line Formulae" end="tail"?>
<ul id="ul0017" list-style="none">
    <li id="ul0017-0001" num="0000">
    <ul id="ul0018" list-style="none">
        <li id="ul0018-0001" num="0136">wherein w<sub>1 </sub>and u<sub>1 </sub>are fuzzy membership values for the pixel based on the reflectance intensity at the key wavelength, w<sub>2 </sub>and u<sub>2 </sub>are fuzzy membership values based on the two-waveband ratio, min indicates a minima operation that selects the smaller of the two values, max indicates a maxima operation that selects the larger of the two values, and D<sub>o </sub>is the decision output value for the pixel.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0096" num="0137">A process for automated online inspection of freshly slaughtered chicken carcasses on a processing line to identify wholesome and unwholesome chickens, comprising (or consisting essentially of or consisting of):
<ul id="ul0019" list-style="none">
    <li id="ul0019-0001" num="0000">
    <ul id="ul0020" list-style="none">
        <li id="ul0020-0001" num="0138">(a) illuminating said chicken carcasses with a source of electromagnetic radiation having a predetermined spectral content,</li>
        <li id="ul0020-0002" num="0139">(b) detecting radiation from said source reflected by said chicken carcasses in each of two key wavelengths, &#x3bb;<sub>1 </sub>and &#x3bb;<sub>2</sub>, using an imaging system that correlates radiation intensity at each of the two key wavelengths with spatial pixels of the images of said chicken carcasses,</li>
        <li id="ul0020-0003" num="0140">(c) identifying the entrance and exit of each of said chicken carcasses through the field of view of the imaging system,</li>
        <li id="ul0020-0004" num="0141">(d) identifying selected areas of each image of said chicken carcasses for which the values of reflected radiation intensity will be used in calculations to identify wholesomeness or unwholesomeness,</li>
        <li id="ul0020-0005" num="0142">(e) calculating the ratio of the radiation intensity at &#x3bb;<sub>1 </sub>divided by the radiation intensity at &#x3bb;<sub>2 </sub>for each pixel in the selected areas of each image,</li>
        <li id="ul0020-0006" num="0143">(f) calculating decision output values for each image pixel using a fuzzy logic classifier, and</li>
        <li id="ul0020-0007" num="0144">(g) generating an identification of being wholesome or unwholesome for each of said chicken carcasses based on the comparison of the average decision output for the selected area of each chicken image with a decision-making threshold value.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0097" num="0145">The above process wherein &#x3bb;<sub>1 </sub>is from about 570 nm to about 590 nm (e.g., 570-590 nm) and &#x3bb;<sub>2 </sub>is from about 610 nm to about 630 nm (e.g., 610-630 nm).</p>
<p id="p-0098" num="0146">The above process wherein &#x3bb;<sub>1 </sub>is about 580 nm and &#x3bb;<sub>2 </sub>is about 620 nm.</p>
<p id="p-0099" num="0147">The above process wherein &#x3bb;<sub>1 </sub>is 580 nm and &#x3bb;<sub>2 </sub>is 620 nm.</p>
<p id="p-0100" num="0148">A process for automated online inspection of freshly slaughtered chicken carcasses on a processing line to identify wholesome and unwholesome chickens, comprising (or consisting essentially of or consisting of) following the procedure in <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0101" num="0149">A method of determining parameters for multispectral inspection of freshly slaughtered chicken carcasses to identify wholesome and unwholesome chicken carcasses (by analyzing a set of hyperspectral images of wholesome and unwholesome chicken carcasses), comprising (or consisting essentially of or consisting of) following the procedure in <figref idref="DRAWINGS">FIG. 3</figref>.</p>
<p id="p-0102" num="0150">Other embodiments of the invention will be apparent to those skilled in the art from a consideration of this specification or practice of the invention disclosed herein. It is intended that the specification and examples be considered as exemplary only, with the true scope and spirit of the invention being indicated by the following claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08625856-20140107-M00001.NB">
<img id="EMI-M00001" he="6.01mm" wi="76.20mm" file="US08625856-20140107-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>We claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for inspecting animal carcasses, comprising the steps of:
<claim-text>(a) providing a processing system that moves animal carcasses past an operating line scanning camera;</claim-text>
<claim-text>(b) obtaining lines of data from a carcass moving past the operating line scanning camera, each line of data comprising a series of pixels;</claim-text>
<claim-text>(c) locating Region of Interest (ROI) pixels within each line of data and determining which ROI pixels indicate pixels corresponding to a wholesome carcass and an unwholesome carcass with a decision output parameter for each of the ROI pixels, wherein the decision output parameter is calculated immediately after obtaining each line of data;</claim-text>
<claim-text>(d) repeating steps (b)-(c) continuously until decision parameters have been calculated for each line of data with ROI pixels associated with the carcass.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein all the decision parameters are processed so that an average decision parameter value associated with the carcass is calculated.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein the average decision parameter is compared to a threshold value to determine whether the carcass is wholesome or unwholesome.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein a leading edge and a trailing edge of each carcass is identified.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the carcass comprises a poultry carcass.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the ROI comprises an essentially contiguous region on the carcass.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the ROI comprises less than half of the carcass.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the processing system is moving at a speed of up to 200 carcasses per minute.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the line of data is acquired by a multispectral imaging system.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref> wherein the ROI is selected by comparing maximum spectral difference values from potential ROIs to select an optimized ROI that results in a greatest maximum spectral difference value as the ROI.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref> wherein the ROI pixels comprise only animal pixels that occur between an upper boundary m % and a lower boundary n % of a reference distance, where both m % and n % are less than 100% of the reference distance, and the reference distance is the count of the ROI pixels comprising only animal pixels.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein the reference distance for each line scan comprises a length measured in pixels between a line on a designated area of the carcass and a furthest animal pixel from the line.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein m is 40% and n is 60%.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein less than 4 key wavebands are selected and a waveband ratio value is calculated for each ROI pixel.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein only one waveband ratio value is used to calculate the decision output parameter.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein a relative intensity waveband is selected and used to determine relative intensity values for each ROI pixel, the ROI pixel data further comprising the relative intensity values.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the relative intensity values comprise a decision output parameter.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the ROI is determined empirically.</claim-text>
</claim>
</claims>
</us-patent-grant>
