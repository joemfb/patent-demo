<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08627100-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08627100</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11885513</doc-number>
<date>20060607</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<us-term-extension>1584</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>12</main-group>
<subgroup>14</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>713189</main-classification>
<further-classification>713190</further-classification>
</classification-national>
<invention-title id="d2e53">Separate type mass data encryption/decryption apparatus and implementing method therefor</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6003135</doc-number>
<kind>A</kind>
<name>Bialick et al.</name>
<date>19991200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6005613</doc-number>
<kind>A</kind>
<name>Endsley et al.</name>
<date>19991200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>3482316</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6256701</doc-number>
<kind>B1</kind>
<name>Goto</name>
<date>20010700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710261</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6262915</doc-number>
<kind>B1</kind>
<name>Kihara et al.</name>
<date>20010700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
<classification-national><country>US</country><main-classification>36518511</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6439464</doc-number>
<kind>B1</kind>
<name>Fruhauf et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>235492</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6783078</doc-number>
<kind>B1</kind>
<name>Leaming</name>
<date>20040800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>235492</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7386717</doc-number>
<kind>B2</kind>
<name>Adusumilli</name>
<date>20080600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713153</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2001/0025882</doc-number>
<kind>A1</kind>
<name>Coulier</name>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>235380</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2002/0023209</doc-number>
<kind>A1</kind>
<name>Domstedt et al.</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
<classification-national><country>US</country><main-classification>713160</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2002/0090090</doc-number>
<kind>A1</kind>
<name>Van Rijnsoever et al.</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380279</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2002/0103944</doc-number>
<kind>A1</kind>
<name>Feuser et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710  2</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2003/0093812</doc-number>
<kind>A1</kind>
<name>Chang et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>725133</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2004/0030896</doc-number>
<kind>A1</kind>
<name>Sakamura et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713169</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2004/0073726</doc-number>
<kind>A1</kind>
<name>Margalit et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710 72</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2004/0256470</doc-number>
<kind>A1</kind>
<name>Takami et al.</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>235492</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2005/0149640</doc-number>
<kind>A1</kind>
<name>Hosokawa</name>
<date>20050700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710  8</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2005/0211788</doc-number>
<kind>A1</kind>
<name>Drabczuk et al.</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>235492</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2005/0240689</doc-number>
<kind>A1</kind>
<name>Leaming</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710 52</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>CN</country>
<doc-number>1302404</doc-number>
<date>20010700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>CN</country>
<doc-number>1464676</doc-number>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>CN</country>
<doc-number>1464676</doc-number>
<kind>A</kind>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>EP</country>
<doc-number>1241553</doc-number>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00023">
<othercit>ST22T064-A &#x201c;Smartacard 32-Bit RISC MCU with 64 Kbytes EEPROm &#x26; USB 2.0 Full Speed Device Controller&#x201d;, Oct. 2004.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00024">
<othercit>Haney (Haney et al., &#x201c;Unversla Serial Bus (USB)&#x201d; Jun. 2001, retrievied from http://tomeboy28.50megs.com/USB.html).</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
</us-references-cited>
<number-of-claims>13</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>7</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20080141022</doc-number>
<kind>A1</kind>
<date>20080612</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Hu</last-name>
<first-name>Peng</first-name>
<address>
<city>Beijing</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Li</last-name>
<first-name>Yong</first-name>
<address>
<city>Beijing</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Hu</last-name>
<first-name>Peng</first-name>
<address>
<city>Beijing</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Li</last-name>
<first-name>Yong</first-name>
<address>
<city>Beijing</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Fay Kaplun &#x26; Marcin, LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Beijing Watch Data System Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Beijing</city>
<country>CN</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Poltorak</last-name>
<first-name>Peter</first-name>
<department>2496</department>
</primary-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/CN2006/001236</doc-number>
<kind>00</kind>
<date>20060607</date>
</document-id>
<us-371c124-date>
<date>20070831</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO2006/131069</doc-number>
<kind>A </kind>
<date>20061214</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Embodiments of the present invention relate to a separate type mass data encryption/decryption apparatus and an implementing method therefor. The separate type mass data encryption/decryption apparatus includes a microprocessor and a storage unit for storing an encryption/decryption key. The apparatus further includes an external communication interface module connecting to a peripheral data bus for transmitting data between the encryption/decryption apparatus and an external terminal, and said microprocessor is used for encrypting/decrypting data inputted from the external terminal. Embodiments of the present invention can process mass data with higher security and expedience.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="222.50mm" wi="146.81mm" file="US08627100-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="138.43mm" wi="163.41mm" file="US08627100-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="200.07mm" wi="146.64mm" file="US08627100-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="187.03mm" wi="100.25mm" file="US08627100-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="234.61mm" wi="151.47mm" file="US08627100-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="245.11mm" wi="115.32mm" file="US08627100-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="150.96mm" wi="171.45mm" file="US08627100-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">TECHNICAL FIELD</heading>
<p id="p-0002" num="0001">The present disclosure generally relates to the field of communication and information security. In particular but not exclusively, the present disclosure relates to a separate type mass data encryption/decryption apparatus and an implementing method therefor.</p>
<heading id="h-0002" level="1">DESCRIPTION OF THE RELATED ART</heading>
<p id="p-0003" num="0002">With the rapid development of computer and internet technologies, many government offices, enterprises, other organizations and individuals have built their computer network systems, trying to use the internet to establish a fast and efficient network channel between the public and themselves. Thus, e-commerce and e-government affairs have become one of the main ways for them to provide various services and obtain information. Due to the particular industrial characteristics of the information service system based on the internet, the security of data transmission in a network becomes more and more important, for example, in network bank business, network tax reporting and network enterprise annual inspecting. In these systems, there is a large amount of information which is required to be kept secret. Such information must be protected in an encrypted manner in the network transmission to ensure the sensitive data therein to be transferred in security. At the same time, besides the data transmission in the network application, data in a user terminal (such as data in a hard disc) is also required to be encrypted to protect the access. When an attacker detaches a hard disc from a user terminal and installs it into another user terminal, it will be difficult for the attacker to know and decrypt information in the hard disc because a large amount of system data in the hard disc is stored in an encrypted manner, by which the security of the data is ensured.</p>
<p id="p-0004" num="0003">People have already a common understanding that encryption technology should be applied to both network information service systems and user local data, and have adopted various encryption technologies to protect them. For example, IC card technology and software module were applied to improve the reliability of the encryption technologies such as identity authentication. However, because of the restriction of some realistic conditions such as finance and technology maturity, currently a majority of systems still use a manner of software encryption to perform a simple data encryption protection.</p>
<p id="p-0005" num="0004">In a software encryption, an encryption/decryption key is generated by a key generating end such as an IC card or a software module, and an encryption/decryption operation is carried out by the CPU and the inner memory of a terminal. However, because the key used in the software encryption is required to be provided by the communication layer of the system from the generating end to the terminal and be stored in the inner memory of the terminal, an attacker can easily obtain the encryption/decryption key by monitoring the communication layer of the user terminal or stealing the data in the inner memory of the terminal, and then the encrypted data is easily decrypted. At the same time, because a computation to data which needs to be encrypted/decrypted is carried out using the CPU and the inner memory of the terminal, volumes of system resources are occupied.</p>
<p id="p-0006" num="0005">In order to overcome the shortcomings in the above encryption technology such as &#x201c;easy to be decrypted&#x201d; and &#x201c;occupation of system resources&#x201d;, people have proposed a hardware encryption technology to perform an encryption operation to data. In the conventional hardware encryption technology, an encryption chip is installed in or an encryption card is inserted into the terminal, a microprocessor contained in the chip or card is used to generate the encryption/decryption key, and an encryption/decryption computation to data which is required to be encrypted/decrypted is performed in the chip or card. However, because an encryption chip is installed or an encryption card is inserted into the terminal in the above technology, it is inconvenient for the user to use. In addition, the encryption chip and card are very expensive because most of them are provided by overseas manufacturers. Even the homemade products generally have the prices of thousands to tens of thousands RMB Yuan, and thus these products are difficult to spread to ordinary users.</p>
<heading id="h-0003" level="1">BRIEF SUMMARY</heading>
<p id="p-0007" num="0006">This section is for the purpose of summarizing some aspects of the present invention and to briefly introduce some preferred embodiments. Simplifications or omissions in this section as well as the title and the abstract of this disclosure may be made to avoid obscuring the purpose of the section, the title and the abstract. Such simplifications or omissions are not intended to limit the scope of the present invention.</p>
<p id="p-0008" num="0007">In order to overcome the shortcomings in the conventional technology, one aspect of the present invention is to provide a separate type mass data encryption/decryption apparatus and an implementing method therefor, in which mass data transferred at high-speed is encrypted/decrypted with high security and low cost.</p>
<p id="p-0009" num="0008">Other aspects, features, and advantages will become apparent upon examining the following detailed description of one or more embodiments, taken in conjunction with the attached drawings.</p>
<p id="p-0010" num="0009">The technical scheme of various embodiments of the present invention is as follows:</p>
<p id="p-0011" num="0010">A separate type mass data encryption/decryption apparatus comprises in one embodiment a microprocessor and a storage unit for storing an encryption/decryption key, wherein the apparatus further comprises:</p>
<p id="p-0012" num="0011">an external communication interface module connecting to a peripheral data bus for transferring data between the encryption/decryption apparatus and an external terminal, and</p>
<p id="p-0013" num="0012">said microprocessor performs an encryption/decryption operation to data inputted from the external terminal.</p>
<p id="p-0014" num="0013">The encryption/decryption apparatus receives data from the external terminal in an interrupt control mode and transfers data to the external terminal in a bulk transmission mode in one embodiment.</p>
<p id="p-0015" num="0014">The microprocessor of one embodiment is an at least a 32-bit multilevel pipeline RISC processor and supports a secure access control of hardware and an access control of peripheral component.</p>
<p id="p-0016" num="0015">The external communication interface module of one embodiment comprises at least a Universal Serial Bus interface module and an ISO7816 interface module.</p>
<p id="p-0017" num="0016">An encryption/decryption implementing method of a separate type mass data encryption/decryption apparatus comprises in one embodiment:</p>
<p id="p-0018" num="0017">a first step of the encryption/decryption apparatus receiving data packets which are sent by a terminal and required to be encrypted/decrypted;</p>
<p id="p-0019" num="0018">a second step of storing the data packets into a storage unit;</p>
<p id="p-0020" num="0019">a third step of a microprocessor performing encryption/decryption to the data packets by calling an encryption/decryption key stored in the storage unit according to a encryption/decryption command control word contained in the data packets, and storing the encrypted/decrypted data packets in the storage unit; and</p>
<p id="p-0021" num="0020">a fourth step of sending the encrypted/decrypted data packets to the terminal in a bulk transmission mode.</p>
<p id="p-0022" num="0021">In the first step, the terminal is a cable terminal, a wireless terminal or a handheld terminal according to various embodiments.</p>
<p id="p-0023" num="0022">In the first step, a data communication protocol command applied between the encryption/decryption apparatus and the terminal comprises a card head selection command word, a communication selection command word, a stream control word, a data length word and a data field according to various embodiments.</p>
<p id="p-0024" num="0023">In the second step, the data packet has 64 bytes in one embodiment.</p>
<p id="p-0025" num="0024">In the third step, the encryption/decryption command control word has a 2-bytes length in one embodiment.</p>
<p id="p-0026" num="0025">In the third step, the lower three bits of the encryption/decryption command control word serve as a channel mark for stream information encryption/decryption operation in one embodiment.</p>
<p id="p-0027" num="0026">The third step also comprises a step of encrypting/decrypting the key in one embodiment.</p>
<p id="p-0028" num="0027">In the fourth step of sending the data to the terminal in the bulk transmission mode, data is transferred by 2-6K bytes one time in an embodiment.</p>
<p id="p-0029" num="0028">The encryption/decryption adopts a symmetric algorithm or an asymmetric algorithm in one embodiment.</p>
<p id="p-0030" num="0029">One embodiment of the present invention has prominent advantages and positive effects. It adopts hardware as encryption carrier, uses a microprocessor carried by hardware devices to generate encryption/decryption key and performs an encryption/decryption computation to data which is required to be encrypted/decrypted in the chip to effectively improve the security of mass data during the transmission. It also provides a flexible and fast communication method which greatly facilitates the use of users. One or more embodiments of the present invention has the advantages as follows.</p>
<p id="p-0031" num="0030">1. Flexibility and randomicity of generating and changing of the key. The terminal of one embodiment can perform an encryption/decryption computation by use of a key randomly generated in the encryption/decryption apparatus or by transferring the key value to the encryption/decryption apparatus. The key will be stored in an encrypted protective area and can not be read again once it is generated or written. When the key is required to be changed, the terminal can send a command to update the key by the hardware itself or send a key again to the apparatus. At the same time, an encryption method can also be used during the course of key transmission to protect the key value, so that attacks such as internal memory wiretapping and communication layer monitoring mentioned above can be prevented completely.</p>
<p id="p-0032" num="0031">2. High speed and powerful data processing capacity. In one embodiment of the present invention, the encryption/decryption apparatus is connected with the terminal directly with an USB. In addition, the apparatus of the present invention can support a communication speed of the USB with a full speed of 12 Mbps, or that of the USB with a high speed of 480 Mbps. Because the microprocessor in the encryption/decryption apparatus is 32 bit or above, the apparatus of one embodiment of the present invention has a powerful data computing and processing capacity. At the same time, an asymmetric algorithm coprocessor module and a symmetric algorithm coprocessor module are embedded in the apparatus, by which data processing speed can be improved during the encryption/decryption computation. In addition, burden on occupied microprocessor resources caused by mass data computation can also be relieved so that the microprocessor can perform other data processing, by which the overall computing capacity of the apparatus is improved.</p>
<p id="p-0033" num="0032">3. Convenient and flexible use. The apparatus of one embodiment is connected to the terminal by a USB interface so that functions of plug-and-play and hot-plugging can be supported. The user can perform a mass data encryption/decryption operation without the needs of installing a chip or inserting an encryption card into the terminal. At the same time, installation and detachment of hardware devices are very simple, which facilitates the user. Only with the encryption/decryption apparatus, the user can have encryption/decryption services on any terminals which are installed with a driver supporting the apparatus. If the encryption/decryption apparatus according to one embodiment of the present invention is combined with the FLASH technology to use an AUTORUN function, then the apparatus can realize a function of automatically installing the driver, which further facilitates the user.</p>
<p id="p-0034" num="0033">4. High security and reliability. In one embodiment of the present invention, hardware is used as an encryption carrier, the encryption/decryption key is generated by the microprocessor carried by the hardware devices and the encryption/decryption computation to data which is required to be encrypted/decrypted is performed in the chip. Therefore, security and reliability of the mass data in transmission process are improved greatly. Because the encryption/decryption apparatus of one embodiment of the present invention can realize an asymmetric algorithm, such as a 1024-bit Public-Key encryption algorithm (RSA), a 2048-bit RSA algorithm and an error correction code algorithm (ECC), it can be combined with a PKI (public key infrastructure) technology to store a public key and a private key of the user and keep the user's certificate. In addition, computations for signing, authenticating, encrypting and decrypting are all performed inside the apparatus, which improves the security and reliability of the system and realizes an end-to-end security.</p>
<p id="p-0035" num="0034">5. Economics of encryption smart apparatus. Since one embodiment of the present invention uses a smart card chip having a 32 or more bit microprocessor with USB interface, hardware cost is greatly reduced. The apparatus according to one embodiment of the present invention may be USB peripheral equipments, such as a smart card with a USB interface, an electronic key (USBKEY), a USB mouse, a USB keyboard, an artificial intelligence device (HID).</p>
<p id="p-0036" num="0035">One or more embodiments of the present invention can be widely used in encrypted storage or moving protecting for information transmission in network and terminal hardware data, particularly in the application systems which have higher requirements for security, such as banks, securities, insurance, public security and national defense. It also can be applied in an encryption/decryption function of the next generation network technology Ipv6 to serve as encryption smart apparatus for Internet Protocol Security (IPSEC) which upgrades the conventional network Ipv4 to Ipv6. Because the conventional network Ipv4 protocol is considering how to realize interconnection in the internet, it ignores the security of data transmission in the network. Therefore, when people program the next generation internet protocol, IPSEC is introduced and it becomes necessary to have encryption/decryption protecting function in an Internet Protocol data packet. The encryption/decryption smart apparatus according to one embodiment of the present invention can provide a high speed symmetrical and asymmetrical encryption/decryption of mass data. This characteristic serves as an advantageous supplement to the IPSEC encryption/decryption function in the next generation network.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0037" num="0036">One or more embodiments of the invention will be readily understood by the following detailed description in conjunction with the accompanying drawings, wherein like reference numerals designate like structural elements, and in which:</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 1</figref> shows the constituting modules of the encryption/decryption apparatus of one embodiment of the present invention;</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic view showing the communication between the encryption/decryption apparatus of one embodiment of the present invention and a terminal;</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 3</figref> is a schematic view showing the relationship between communication protocol of the encryption/decryption apparatus and other parts of the present invention according to an embodiment;</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart of a communication data processing method of the encryption/decryption apparatus of one embodiment of the present invention;</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 5</figref> is a main flow chart of one embodiment of the present invention;</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart showing the terminal using the encryption/decryption apparatus to perform an encryption/decryption to mass data according to one embodiment;</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 7</figref> is a schematic view showing the data encryption/decryption procedure of an encryption/decryption apparatus based on a mobile telephone according to one embodiment.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0045" num="0044">The present invention will be described in detail with reference to the figures and embodiments. The detailed description of various embodiments of the invention is presented largely in terms of procedures, steps, logic blocks, processing, and other symbolic representations that directly or indirectly resemble the operations of data processing devices coupled to networks. These process descriptions and representations are typically used by those skilled in the art to most effectively convey the substance of their work to others skilled in the art. Numerous specific details are set forth in order to provide a thorough understanding of embodiments of the present invention. However, the various embodiments of the present invention may be practiced without these specific details. In other instances, well known methods, procedures, components, and circuitry have not been described in detail to avoid unnecessarily obscuring aspects of the present invention.</p>
<p id="p-0046" num="0045">Reference throughout this specification to &#x201c;one embodiment&#x201d; or &#x201c;an embodiment&#x201d; means that a particular feature, structure, or characteristic described in connection with the embodiment is included in at least one embodiment. Thus, the appearances of the phrases &#x201c;in one embodiment&#x201d; or &#x201c;in an embodiment&#x201d; in various places throughout this specification are not necessarily all referring to the same embodiment. Furthermore, the particular features, structures, or characteristics may be combined in any suitable manner in one or more embodiments.</p>
<p id="p-0047" num="0046">The headings provided herein are for convenience only and do not interpret the scope or meaning of the embodiments.</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 1</figref> shows the constituting modules of the encryption/decryption apparatus of one embodiment of the present invention. The encryption/decryption apparatus comprises a microprocessor, a FLASH, an EEPROM, a SRAM block, a multiplication coprocessor module, a storage management protection module, a security detection and protection module, an asymmetric algorithm coprocessor, a symmetric algorithm coprocessor, a randomizer, a clock transaction module, a power source management module, an interrupt controller and a timer. The microprocessor, the FLASH, the EEPROM, the SRAM, the multiplication coprocessor module, the storage management protection module are connected with a data bus, and are connected via a bridge connector to the security detection and protection module, the asymmetric algorithm coprocessor, the symmetric algorithm coprocessor, the randomizer, the clock transaction module, the power source management module, the interrupt controller and the timer which are connected to the data bus. It also comprises external communication interface modules which are respectively connected to the microprocessor, the FLASH, the EEPROM, the SRAM, the multiplication coprocessor module, the storage management protection module, the security detection and protection module, the asymmetric algorithm coprocessor, the symmetric algorithm coprocessor via the data bus for data transmission between the encryption/decryption apparatus and external terminals. The external communication interface module comprises a Universal Serial Bus interface module and an ISO7816 interface module in one embodiment.</p>
<p id="p-0049" num="0048">The chip used by the encryption/decryption apparatus of one embodiment is a high security SOC (system on a chip) chip based on a 32 or more bit Reduced Instruction Set Computing (RISC) processor and has characteristics of high processing capacity, high security, low power consumption and low cost. The chip of one embodiment has the following main characteristics:</p>
<p id="p-0050" num="0049">1. Processor Performance.</p>
<p id="p-0051" num="0050">The microprocessor is a tailor-made high security CPU core; it is a 32 or more bit RISC and adopts a five level stream line; its frequency is variable with the main frequency working at 100 MHz or above; and there is a multiplication coprocessor as hardware.</p>
<p id="p-0052" num="0051">The microprocessor adopts a total security concept and has excellent security performance and processing capacity.</p>
<p id="p-0053" num="0052">The microprocessor uses a high performance and high speed CACHE comprising an instruction CACHE of 1 K bytes and a data CACHE of 1 K bytes.</p>
<p id="p-0054" num="0053">The storage management and protection unit (MMU) can be configured to be closed. After it is closed, a segment management mode can be supported and the maximum supported space is 128 MB. It has an application oriented storage partition, supports variable page length, uses a multi-level query structure, supports virtual storage space management, supports hardware security access control and the peripheral component access is controllable.</p>
<p id="p-0055" num="0054">2. Storage Unit on a Chip.</p>
<p id="p-0056" num="0055">The EEROM of one embodiment of the present invention is 32 KB and used as storage spaces of data and program; it can be used for reading, erasing and writing of a single byte and also for erasing and writing of single byte or multiple bytes (maximum of 64 bytes); it can tolerate at least 300,000 times of erasing and writing; data can be stored in it under room temperature for at least 10 years; the erasing and writing performance is as follows: a writing time for a single byte is 20 &#x3bc;s, a page erasing time is 4 ms, and a programming voltage of EEPROM is generated inside the chip.</p>
<p id="p-0057" num="0056">The FLASH is 128 KB and is used as a storage space for programs, function library and device driving;</p>
<p id="p-0058" num="0057">The minimum erasing and writing times for erasing and writing of 128 byte page is 20,000 times, data can be stored in it under room temperature for at least 10 years;</p>
<p id="p-0059" num="0058">The erasing and writing performance is as follows: the writing time of a single byte is 20 &#x3bc;s, the page erasing time is 4 ms, and the SRAM is 8 KB.</p>
<p id="p-0060" num="0059">3. Peripheral Components.</p>
<p id="p-0061" num="0060">There are the following peripheral components according to various embodiments.</p>
<p id="p-0062" num="0061">(1) Hardware error correction code (ECC) coprocessor.</p>
<p id="p-0063" num="0062">(2) Hardware data encryption standard (DES) coprocessor. The data encryption standard (DES) coprocessor supports the encryption and decryption of a DES and a 3DES including 2KEY and 3KEY, and also supports the encryption and decryption in a way of Electronic Code Book (EBC) and Cipher Block Chaining (CBC). The data transmission channel is optimized to have a 3 Mbps bidirectional encryption/decryption speed for port data.</p>
<p id="p-0064" num="0063">(3) High speed truly random number generator. The generator has a random number generation bit rate of 2 Mbps, which has passed the test of the Office of State Code Management Commission of China.</p>
<p id="p-0065" num="0064">(4) USB interface. The USB interface supports full speed of USB1.1 protocol or higher speed. It supports three terminals, each of which supports dual buffers to have a high port utilization ratio. There is one serial interface which is in accordance with the ISO7816-3 standard, and supports a maximum clock of 5 MHz and a highest speed of 310 Kbps. There are one GIPO interface and two 32-bit timers. An oscillation controller and a Phase Locked Logic (PLL) are embedded, and a 4 MHz crystal can be connected externally. Power On Reset can be supported.</p>
<p id="p-0066" num="0065">4. Security Characteristics</p>
<p id="p-0067" num="0066">One embodiment has the following functions: hardware storage management and protection, high and low voltages detection, high and low frequencies detection, Differential Power Analysis/Static Power Analysis (DPA/SPA) attack protections, storage area encryption, bus scrambling, clock and reset signals pulse filtering and safe and optimized wiring. Each chip has a unique serial number.</p>
<p id="p-0068" num="0067">5. Electrical Characteristics</p>
<p id="p-0069" num="0068">The whole chip of one embodiment has a power consumption lower than 200 mw (at the voltage of 5V); there are three levels of lower power consumption mode control, that is, a maintain mode, a standby mode and a power fail mode. The power supply has an ISO mode of 2.7-5.5V and a USB mode of 3.6-5.5V. The anti static technical index (ESD) protection is above 4000V. Wiring bond positions of chip pins are in conformity with the provisions of the ISO7816-2.</p>
<p id="p-0070" num="0069"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic view showing the communication between the encryption/decryption apparatus of one embodiment of the present invention and a terminal. The terminal can be a wire terminal, a wireless terminal, a handheld terminal and a mobile telephone. As shown in <figref idref="DRAWINGS">FIG. 2</figref>, the encryption/decryption apparatus performs a data information transmission between the mobile terminal via a USB interface in one embodiment.</p>
<p id="p-0071" num="0070"><figref idref="DRAWINGS">FIG. 3</figref> is a schematic view showing the relationship between communication protocol of the encryption/decryption apparatus and other parts of an embodiment of the present invention. Since the encryption/decryption apparatus of one embodiment uses a USB interface to perform a communication, it is required to be supported by corresponding drivers, like the other USB apparatus, to ensure that the apparatus work properly on the terminal's operating system. Since the apparatus will process mass information data, a function of processing mass data is required to be added into the driver itself. According to one embodiment of the present invention, a special data communication protocol command packet is used when the USB interface performs communication. The command packet has a format of &#x201c;NAD PCB STR LEN DATA BCC&#x201d;, in which NAD is card head selection command word, PCB is communication selection command word, STR is a stream control word, LEN is a data length word, DATA is a data field and BCC is a check word. The data is transferred after coded, which guarantees high-speed and complete data transmission and increases an encryption/decryption speed of mass data. The message code and functions of command packet of encryption/decryption data stream of the encryption/decryption apparatus are shown in the following Table 1.</p>
<p id="p-0072" num="0071">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="259pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 1</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Message code and functions of command packet of encryption/decryption</entry>
</row>
<row>
<entry>data stream of the encryption/decryption apparatus</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="35pt" align="left"/>
<colspec colname="3" colwidth="189pt" align="center"/>
<tbody valign="top">
<row>
<entry>Code</entry>
<entry>Value</entry>
<entry>Meaning</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="35pt" align="left"/>
<colspec colname="3" colwidth="189pt" align="left"/>
<tbody valign="top">
<row>
<entry>NAD</entry>
<entry>00/12/13H</entry>
<entry>Card selection NAD = 0x00/0x12 Main card head NAD = 0x13</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SAM card head</entry>
</row>
<row>
<entry>PCB</entry>
<entry>00H</entry>
<entry>Having no relation with communication; used when CPU card</entry>
</row>
<row>
<entry/>
<entry/>
<entry>T = 1; PCB generally set as 0x00 if CPU is not specifically</entry>
</row>
<row>
<entry/>
<entry/>
<entry>defined.</entry>
</row>
<row>
<entry>STR</entry>
<entry>00H</entry>
<entry>When set as 00H, a smart card command format (APDU)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>mode is used to process commands;</entry>
</row>
<row>
<entry/>
<entry>0XH</entry>
<entry>When set as 0XH, a stream information mode is used to</entry>
</row>
<row>
<entry/>
<entry/>
<entry>process commands and corresponding passage is designated</entry>
</row>
<row>
<entry/>
<entry/>
<entry>to perform stream encryption/decryption operations.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>In order to decrease command length of encryption/decryption</entry>
</row>
<row>
<entry/>
<entry/>
<entry>data stream, lower three bits (b2, b1, b0) in the command</entry>
</row>
<row>
<entry/>
<entry/>
<entry>word are used to denote a channel mark for stream</entry>
</row>
<row>
<entry/>
<entry/>
<entry>encryption/decryption operations.</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="10">
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="35pt" align="left"/>
<colspec colname="3" colwidth="28pt" align="center"/>
<colspec colname="4" colwidth="28pt" align="center"/>
<colspec colname="5" colwidth="28pt" align="center"/>
<colspec colname="6" colwidth="21pt" align="center"/>
<colspec colname="7" colwidth="21pt" align="center"/>
<colspec colname="8" colwidth="21pt" align="center"/>
<colspec colname="9" colwidth="21pt" align="center"/>
<colspec colname="10" colwidth="21pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry/>
<entry>b7</entry>
<entry>b6</entry>
<entry>b5</entry>
<entry>b4</entry>
<entry>b3</entry>
<entry>b2</entry>
<entry>b1</entry>
<entry>b0</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="7">
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="35pt" align="left"/>
<colspec colname="3" colwidth="105pt" align="center"/>
<colspec colname="4" colwidth="21pt" align="center"/>
<colspec colname="5" colwidth="21pt" align="center"/>
<colspec colname="6" colwidth="21pt" align="center"/>
<colspec colname="7" colwidth="21pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry/>
<entry>0</entry>
<entry>1</entry>
<entry>X</entry>
<entry>X</entry>
<entry>X</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="35pt" align="left"/>
<colspec colname="3" colwidth="189pt" align="left"/>
<tbody valign="top">
<row>
<entry>LEN</entry>
<entry>XXXXH</entry>
<entry>Designating data length for performing encryption/decryption</entry>
</row>
<row>
<entry/>
<entry/>
<entry>operations; length: 2 bytes.</entry>
</row>
<row>
<entry>DATA</entry>
<entry>data</entry>
</row>
<row>
<entry>BCC</entry>
<entry>XXH</entry>
<entry>XOR check byte</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0073" num="0072">Possibly echoed status code which is returned into mainframe data field of the encryption/decryption apparatus is shown in Table 2.</p>
<p id="p-0074" num="0073">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 2</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Possibly echoed status code which is</entry>
</row>
<row>
<entry>returned into mainframe data field</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="63pt" align="left"/>
<colspec colname="2" colwidth="126pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>SW1 SW2</entry>
<entry>Meaning</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>9000</entry>
<entry>Command successfully executed</entry>
</row>
<row>
<entry/>
<entry>6700</entry>
<entry>Error length</entry>
</row>
<row>
<entry/>
<entry>6A81</entry>
<entry>Unsupportable function</entry>
</row>
<row>
<entry/>
<entry>9401</entry>
<entry>Error channel mark</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart of a communication data processing method of the encryption/decryption apparatus in accordance with one embodiment of the present invention. A user calls a shared library corresponding to the encryption/decryption apparatus to write corresponding applications. Besides providing to users basic operating functions for the smart card, such as device communication, control and operations, the shared library also provides a function for processing encryption/decryption of mass data. As shown by combing the Tables 1 and 2, an embodiment of the present invention defines a stream control word (STR) which is necessary for transmission of the apparatus in the command packet of encryption/decryption data stream of the encryption/decryption apparatus. The function of the control word is to distinguish whether the user is using basic smart card commands which are in conformity with ISO 7815 provisions or stream encryption/decryption commands which are not in conformity with ISO 7815 provisions to operate the apparatus. In addition, the LEN command word is defined to be two bytes in order that the amount of bytes of data is increased and the encryption/decryption commands can be ensured to process data as much as possible.</p>
<p id="p-0076" num="0075"><figref idref="DRAWINGS">FIG. 5</figref> is a main flow chart of one embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 5</figref>, the terminal downloads data to be processed to a device driving layer via the shared library. The driving layer integrates data according to the communication protocol command and then transfers it to a USB bottom driver (USBD) self carried by the terminal and a USB hardware controller interface (UHCI/E) layer in the terminal. The UHCI/E is a standard USB device. Here, data is divided into a plurality of data packets of 64 bytes, and then the data packets are sent to the encryption/decryption apparatus according to their sequence. The encryption/decryption apparatus receives the data packets downloaded form the terminal in an interrupt mode. When the USB hardware interface USB IF at the apparatus end receives the first data packet, the program begins to process and determine whether this data packet contains encryption/decryption command control word. If yes, a mass data information process is performed. Otherwise, conventional basic processing mode is used to process the data. In the mass data processing, the program calls a symmetric algorithm or an asymmetric algorithm encryption/decryption function in the smart card operating system (COS) through a firmware in the encryption/decryption apparatus to process data information. At the same time, data of the terminal is received continuously with an interrupt mode to reduce the time needed for the transmission and increase the processing speed. Finally, data processed by the encryption/decryption smart terminal is uploaded in batch to the terminal.</p>
<p id="p-0077" num="0076">The USB of an embodiment has the following four transmission modes:</p>
<p id="p-0078" num="0077">1. Control transmission. The control transmission is a bidirectional transmission, usually with a small data amount. USB system program mainly serves to perform a query, a configuration and send general instructions to USB devices. The control transmission may comprise data of 8 bytes, 16 bytes, 32 bytes and 64 bytes depending on the USB devices and the transmission rate. The control transmission is typically used for the transmission between endpoints <b>0</b> between the mainframe and the USB peripheral equipments.</p>
<p id="p-0079" num="0078">2. Isochronous transmission. The isochronous transmission provides a determined bandwidth and latency. It is used in the stream data transmission which is strict with time and has good error tolerance, or can be used in on-line applications which require constant data transmission rate. For example, the synchronous transmission mode will be a good choice for network telephone application performing on-line talk. Isochronous data require determined bandwidth value and determined maximum transmission times. For the isochronous transmission, an on-line data transmission is more important than an accurate data accuracy and data integrality.</p>
<p id="p-0080" num="0079">3. Interrupt mode transmission. The interrupt mode transmission is mainly used for checking on schedule whether the apparatus has interrupt data to be transferred. The structure of the endpoint mode device determines that its checking frequency is in a range of 1 ms to 255 ms. The interrupt mode transmission is typically used in the transmission of a small quantity of data which is dispersed and unpredictable. Keyboards, joysticks and mice use this type of transmission. The interrupt mode transmission is a one way transmission and only has an input mode for the host. In this embodiment, data of 2-6K bytes can be transferred in one time.</p>
<p id="p-0081" num="0080">4. Bulk transmission.</p>
<p id="p-0082" num="0081">The bulk transmission is mainly used to ensure a transmission in a state that mass data is transferred and received and at the same time there is no special requirement on bandwidth and latency. Printers and scanners use this type of transmission. The bulk transmission is adapted for the transmission which is very slow and has a lot of delays. It also can transfer and receive data after transmission for the other types of data are finished.</p>
<p id="p-0083" num="0082">One embodiment of the present invention selects a mode of combining the interrupt mode transmission and the bulk transmission in the USB transmission. That is, data is received in an interrupt mode and outputted in a bulk transmission mode. Such combination communication mode can improve the speed of encryption/decryption process for mass data of the encryption/decryption apparatus.</p>
<p id="p-0084" num="0083">Please refer to <figref idref="DRAWINGS">FIGS. 6 and 7</figref>. <figref idref="DRAWINGS">FIG. 6</figref> is a flowchart showing the terminal using the encryption/decryption apparatus to perform an encryption/decryption to mass data according to an embodiment. <figref idref="DRAWINGS">FIG. 7</figref> is a schematic view showing the data encryption/decryption procedure of an encryption/decryption apparatus according to an embodiment based on a mobile telephone. In <figref idref="DRAWINGS">FIG. 7</figref>, a host computer receives from a mobile telephone data packets which are sent via the GSM network and stores them in a RAM area to be processed, and the mobile telephone terminal prepares stream data. The mobile telephone terminal obtains Handle of the apparatus. The mobile telephone terminal obtains Handle of the apparatus by key authentication. Whether the Handle is obtained is determined. If no, it reports to the application; if yes, a command for encrypting/decrypting data stream is issued. It further determines whether returning of the data to 9000 is received. If no, it reports to the application; if yes, it closes the command of encrypting/decrypting data stream and then reports to the application. With the development of wireless and communication technologies, mobile telephones have more and more powerful functions. The encryption/decryption apparatus can be provided to the users in a form of short message center (SIM) card to be used in the mobile telephone. Through the powerful data processing capacity of the encryption smart apparatus, voice information and short message information in the mobile telephone can be transferred in the wireless network in an encrypted mode, which can protect the personal information of users from stealing by attackers.</p>
<p id="p-0085" num="0084">It should be noted that the embodiments above are only for the illustration of the present invention and not intended to limit the present invention. Therefore, though the present invention has been describe in detail with reference to the embodiments above, it should be understood by those skilled in the art, that any modification or equivalent replacement may be made to the present invention without departing from the spirit and scope of the present invention that are set forth in the appended claims.</p>
<p id="p-0086" num="0085">The various embodiments described above can be combined to provide further embodiments. All of the foreign patents, foreign patent applications and non-patent publications referred to in this specification and/or listed in the Application Data Sheet are incorporated herein by reference, in their entirety. Aspects of the embodiments can be modified, if necessary, to employ techniques and structures of the various patents, applications and publications to provide yet further embodiments.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A separate type mass data encryption/decryption apparatus, comprising
<claim-text>a microprocessor and a storage unit to store an encryption/decryption key; and</claim-text>
<claim-text>an external communication interface module to connect to a peripheral data bus to transfer data packets between the encryption/decryption apparatus and an external terminal through a Universal Serial Bus protocol, and</claim-text>
<claim-text>wherein said microprocessor is configured to determine whether a data packet sent by the external terminal contains an encryption/decryption command control word, process the data packet in a smart card command format APDU mode if the data packet does not contain the encryption/decryption command control word, and perform an encryption/decryption operation to the data packet by calling the encryption/decryption key if the data packet contains the encryption/decryption command control word and send the encrypted/decrypted data packet to the external terminal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. A separate type mass data encryption/decryption apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the encryption/decryption apparatus receives data packets from the external terminal in an interrupt control mode and transfers data packets to the external terminal in a bulk transmission mode.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. A separate type mass data encryption/decryption apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the microprocessor is an at least 32-bit multilevel pipeline RISC processor and supports a secure access control of hardware and an access control of a peripheral component.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. A separate type mass data encryption/decryption apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the external communication interface module comprises at least a Universal Serial Bus interface module and an ISO7816 interface module.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. An encryption/decryption implementing method of a separate type mass data encryption/decryption apparatus, the method comprising:
<claim-text>the encryption/decryption apparatus receiving data packets which are sent by an external terminal through a Universal Serial Bus protocol;</claim-text>
<claim-text>storing the data packets into a storage unit;</claim-text>
<claim-text>a microprocessor determining whether a data packet sent by the external terminal contains an encryption/decryption command control word, processing the data packet in a smart card command format APDU mode if the data packet does not contain the encryption/decryption command control word, and performing an encryption/decryption operation to the data packet by calling an encryption/decryption key stored in the storage unit if the data packet contains the encryption/decryption command control word and storing the encrypted/decrypted data packet in the storage unit; and</claim-text>
<claim-text>sending the encrypted/decrypted data packet to the external terminal in a bulk transmission mode through the Universal Serial Bus protocol.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. An encryption/decryption implementing method of a separate type mass data encryption/decryption apparatus of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the external terminal is a cable terminal, a wireless terminal or a handheld terminal.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. An encryption/decryption implementing method of a separate type mass data encryption/decryption apparatus of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein a data communication protocol command applied between the encryption/decryption apparatus and the external terminal comprises a card head selection command word, a communication selection command word, a stream control word, a data length word and a data field.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. An encryption/decryption implementing method of a separate type mass data encryption/decryption apparatus of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein at least one of the stored data packets has 64 bytes.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. An encryption/decryption implementing method of a separate type mass data encryption/decryption apparatus of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the encryption/decryption command control word has a 2-bytes length.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. An encryption/decryption implementing method of a separate type mass data encryption/decryption apparatus of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein lower three bits of the encryption/decryption command control word serve as a channel mark for stream information encryption/decryption operation.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. An encryption/decryption implementing method of a separate type mass data encryption/decryption apparatus of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein said performing the encryption/decryption operation also comprises encrypting/decrypting the key.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. An encryption/decryption implementing method of a separate type mass data encryption/decryption apparatus of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the encryption/decryption operation adopts a symmetric algorithm or an asymmetric algorithm.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. An encryption/decryption implementing method of a separate type mass data encryption/decryption apparatus of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein in said sending the encrypted/decrypted data packets to the terminal in the bulk transmission mode, data is transferred by 2-6 KB in one time.</claim-text>
</claim>
</claims>
</us-patent-grant>
