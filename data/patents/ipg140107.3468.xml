<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08624532-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08624532</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13199126</doc-number>
<date>20110819</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<us-term-extension>223</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>02</class>
<subclass>P</subclass>
<main-group>6</main-group>
<subgroup>18</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>31840004</main-classification>
<further-classification>318607</further-classification>
<further-classification>318606</further-classification>
<further-classification>31840001</further-classification>
<further-classification>318700</further-classification>
</classification-national>
<invention-title id="d2e53">System and method for synchronizing sinusoidal drive to permanent magnet motor without distorting drive voltage</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4399395</doc-number>
<kind>A</kind>
<name>Espelage</name>
<date>19830800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>318803</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>4446512</doc-number>
<kind>A</kind>
<name>Jarvinen</name>
<date>19840500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>363 39</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>4916370</doc-number>
<kind>A</kind>
<name>Rowan et al.</name>
<date>19900400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>318368</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5672948</doc-number>
<kind>A</kind>
<name>Cohen et al.</name>
<date>19970900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>318603</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>5838128</doc-number>
<kind>A</kind>
<name>Maiocchi et al.</name>
<date>19981100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>31840035</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6252362</doc-number>
<kind>B1</kind>
<name>White et al.</name>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>31840035</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6385066</doc-number>
<kind>B1</kind>
<name>Garces et al.</name>
<date>20020500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>363 87</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6498451</doc-number>
<kind>B1</kind>
<name>Boules et al.</name>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>318661</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6586898</doc-number>
<kind>B2</kind>
<name>King et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>31840034</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6633145</doc-number>
<kind>B2</kind>
<name>Shao et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>31840035</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6771033</doc-number>
<kind>B2</kind>
<name>Kokami et al.</name>
<date>20040800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>31840035</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>7106021</doc-number>
<kind>B2</kind>
<name>DeCusatis et al.</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>318606</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>7230785</doc-number>
<kind>B2</kind>
<name>Itagaki et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7303</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>7429841</doc-number>
<kind>B2</kind>
<name>Yunus et al.</name>
<date>20080900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>31840001</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>7477034</doc-number>
<kind>B2</kind>
<name>MacKay</name>
<date>20090100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>318432</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>8217615</doc-number>
<kind>B2</kind>
<name>Tan et al.</name>
<date>20120700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>318650</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>8278867</doc-number>
<kind>B2</kind>
<name>Habbley et al.</name>
<date>20121000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>318727</main-classification></classification-national>
</us-citation>
<us-citation>
<nplcit num="00018">
<othercit>&#x201c;Position sensorless brushless DC motor/generator drives: review and future trends&#x201d;, T. Kim, H-W. Lee and M. Ehsani, IET Electr. Power Appl., vol. 1, No. 4, Jul. 2007, pp. 557-564.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00019">
<othercit>&#x201c;Sensorless PM Brushless DC Motor Drives&#x201d;, Nobuyuki Matsui, IEEE Transactions on Industrial Electronics, vol. 43, No. 2, Apr. 1996, pp. 300-308.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00020">
<othercit>Implementation of a Speed Field Oriented Control of 3-phase PMSM Motor using TMS320F240, Erwan Simon, Texas Instruments Application Report SPRA588, Sep. 1999, pp. 1-10 of 86.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00021">
<othercit>&#x201c;Clarke &#x26; Park Transforms on the TMS320C2xx&#x201d;, Texas Instruments Application Report BPRA048, 1997, pp. 1-46.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>31840004</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>31840001</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>318700</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>31840014</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>31840006</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>31840024</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>31840025</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>31840027</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>318606</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>318607</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20130043814</doc-number>
<kind>A1</kind>
<date>20130221</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Chuah</last-name>
<first-name>Yew Tat</first-name>
<address>
<city>Singapore</city>
<country>SG</country>
</address>
</addressbook>
<residence>
<country>SG</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Lu</last-name>
<first-name>Yisong</first-name>
<address>
<city>Singapore</city>
<country>SG</country>
</address>
</addressbook>
<residence>
<country>SG</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Chuah</last-name>
<first-name>Yew Tat</first-name>
<address>
<city>Singapore</city>
<country>SG</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Lu</last-name>
<first-name>Yisong</first-name>
<address>
<city>Singapore</city>
<country>SG</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Cooper</last-name>
<first-name>Alan A. R.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Brady, III</last-name>
<first-name>W. James</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="03" rep-type="attorney">
<addressbook>
<last-name>Telecky, Jr.</last-name>
<first-name>Frederick J.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Texas Instruments Incorporated</orgname>
<role>02</role>
<address>
<city>Dallas</city>
<state>TX</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Leykin</last-name>
<first-name>Rita</first-name>
<department>2837</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A system for controlling a motor (<b>3</b>) includes a driver circuit (<b>5</b>) for generating a drive voltage (v) to generate a phase current (i) in the motor. Phase current sensing circuitry (<b>10,21</b>) digitizes the phase current. A first circuit (<b>23</b>) provides a reconstructed digital representation of a BEMF signal (v<sub>bemf</sub>) of the motor to generate an error-corrected synchronization signal (SYNC) in response to the phase current and a detected error in the motor speed, an amplitude feedback signal (<b>15</b>), and information (i<sub>R</sub>,i<sub>L</sub>,&#x394;i<sub>L</sub>,v<sub>L</sub>) indicative of a resistance (R<sub>m</sub>) and an inductance (L<sub>m</sub>) of the motor. A motor drive signal (<b>15</b>) having an error-corrected frequency is generated in response to the synchronization signal. A PWM circuit (<b>16</b>) produces a PWM signal (<b>17</b>) having a frequency equal to the error-corrected frequency of the synchronization signal (SYNC) and a duty cycle controlled according to the detected error.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="177.72mm" wi="176.61mm" file="US08624532-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="227.67mm" wi="165.61mm" orientation="landscape" file="US08624532-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="177.29mm" wi="175.77mm" file="US08624532-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="207.77mm" wi="180.34mm" orientation="landscape" file="US08624532-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="221.40mm" wi="183.13mm" orientation="landscape" file="US08624532-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="260.01mm" wi="131.23mm" file="US08624532-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="229.45mm" wi="163.75mm" orientation="landscape" file="US08624532-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present invention relates generally to reducing the acoustic noise caused by torque ripple in permanent magnet motors, and more particularly to reducing the acoustic noise without &#x201c;tri-stating&#x201d; the sinusoidal motor drive voltage that causes the torque ripple.</p>
<p id="p-0003" num="0002">Permanent magnet motors generate a sinusoidal back electro-motive force (BEMF), and therefore require a sinusoidal drive signal to ensure low torque ripple so the acoustic noise generated by the motor will be low. The motor drive signal ordinarily is &#x201c;tri-stated&#x201d; for a time interval to synchronize the BEMF and a drive signal &#x201c;profile&#x201d; applied to drive the motor. This is necessary in order to measure the BEMF of the motor. The tri-stating of the motor drive voltages causes them to abruptly go to zero during the tri-stating interval, and this in turn causes the phase current to also go to zero during the tri-stating interval. The outputs of push-pull driver circuits (not shown) included in a motor driver circuit <b>5</b> (see subsequently described <figref idref="DRAWINGS">FIG. 2</figref>) are tri-stated, by turning off both the pull-up transistors and pull-down transistors thereof so that the drive voltage conductors are no longer being driven by the motor driver circuit. Since the output of each push-pull driver is tri-stated, it conducts a voltage that represents the motor BEMF. The segment A in subsequently described <figref idref="DRAWINGS">FIG. 1</figref> indicates that the output of the push-pull driver is tri-stated, but the voltage generated by the motor on an output conductor of a push-pull driver actually is the motor BEMF.</p>
<p id="p-0004" num="0003">The abrupt transition of the phase current to zero at the beginning of the tri-stating interval causes distortion in the motor phase current. (The term &#x201c;tri-stating&#x201d; of the motor drive voltage means that the pull-up transistors and pull-down transistors of the output stages of the motor driver circuitry are simultaneously turned off during the tri-stating interval, causing the voltages on the motor drive conductors to be determined only by the motor during the tri-stating interval.)</p>
<p id="p-0005" num="0004">The motor torque is equal to the product of the phase current and the BEMF of the permanent magnet motor, so the above mentioned distortion in the phase current causes a substantial disturbance in the torque ripple, and therefore causes the motor to generate acoustic noise. The acoustic noise is dependent on the motor torque, and if the torque is constant, the acoustic noise is very low. However, if there is substantial ripple or variation in torque it results in a substantial amount of acoustic noise. (The acoustic noise is believed to be generated by small mechanical deformations caused by the torque ripple in material of which the motor is fabricated.)</p>
<p id="p-0006" num="0005">Prior Art FIG. 1 shows waveforms for the sinusoidal drive voltage, the resulting phase current, and the sensed BEMF of a conventional permanent magnet motor. As indicated by segment &#x201c;A&#x201d; of the motor drive voltage waveform in <figref idref="DRAWINGS">FIG. 1</figref>, the drive voltage waveform is tri-stated for an interval during which a segment &#x201c;B&#x201d; of both the drive voltage waveform and the phase current waveform are zero. Therefore, the phase current is also considered to be tri-stated while phase current abruptly goes to zero and remains at zero during the tri-state interval B. After the tri-state interval B, the three waveforms in Prior Art FIG. 1 continue their normal sinusoidal variation for the negative portion of the sinusoidal cycle, wherein drive voltage, and hence the phase current, again are tri-stated as they approach the zero crossover level.</p>
<p id="p-0007" num="0006">Prior Art FIG. 1 also shows the waveform of a sensed signal SYNC which represents the present motor speed. The BEMF voltage continues while a single drive voltage is being tri-stated by the motor driver circuit. The zero cross-over points of the BEMF voltage typically are sensed by means of an ordinary comparator in order to generate the BEMF zero crossover signal SYNC.</p>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 1</figref> also shows the torque characteristic of the motor. The normal torque level is indicated by &#x201c;C&#x201d;. The levels &#x201c;D&#x201d; of the torque characteristic indicate the large torque distortion or ripple caused by the phase current going to zero during the tri-state intervals B.</p>
<p id="p-0009" num="0008">Other relevant prior art includes commonly assigned U.S. Pat. No. 6,252,362 entitled &#x201c;Method and Apparatus for Synchronizing PWM Sinusoidal Drive to a DC Motor&#x201d; issued Jun. 26, 2001 to White et al., incorporated herein by reference. This reference discloses a technique for tri-stating and synchronizing drive voltage to a DC permanent magnet motor to reduce acoustic noise of the motor. When the drive waveforms are properly synchronized, they cause a current in the motor windings that is in phase with the BEMF of the motor.</p>
<p id="p-0010" num="0009">Microcontrollers, such as digital signal processors (DSPs), are commonly used to control the driver circuits that generate the drive voltages applied to permanent magnet motors. Techniques for using digital signal processors for sinusoidal driving of permanent magnet DC motors are disclosed in the technical article &#x201c;Position Sensorless Brushless DC Motor/Generator Drives: Review and Future Trends&#x201d; by T. Kim et al., IET Electr. Power Appl., Vol. 1, No. 4, July, 2007. Also see &#x201c;Sensorless PM Brushless DC Motor Drives&#x201d; by Nobuyuki Matsui, IEEE Transactions on Industrial Electronics, Vol. 43, No. 2, April 1996. Also see Texas Instruments Application Report SPRA588 entitled &#x201c;Implementation of a Speed Field Oriented Control of 3-Phase PMSM Using TMS320&#x201d; by Erwan Simon.</p>
<p id="p-0011" num="0010">Unfortunately, the techniques including use of microcontrollers, DSPs, or the like to generate the drive voltages applied to permanent magnet motors are very complex, and sometimes include use of the well known Clarke-Park Transformation and PID (proportional-integral-derivative) controllers, and therefore are relatively expensive. The Clarke-Park Transformation is described in the Texas Instruments Application Report, Literature Number BPRA048, entitled Clarke &#x26; Park Transforms on the TMS320C2xx (1997). The Wikipedia article &#x201c;PID Controller&#x201d; cited in the Information Disclosure Statement submitted with the present application describes PID controller techniques.</p>
<p id="p-0012" num="0011">Thus, there is an unmet need for a circuit and method for driving a permanent magnet electric motor so as to eliminate acoustic noise without tri-stating its drive voltages.</p>
<p id="p-0013" num="0012">There also is an unmet need for a circuit and method for eliminating acoustic noise produced by an electric motor without tri-stating a motor drive voltage.</p>
<p id="p-0014" num="0013">There also is an unmet need for a circuit and method for driving a permanent magnet electric motor without tri-stating the motor drive voltage wherein parameters of the motor are automatically determined.</p>
<p id="p-0015" num="0014">There also is an unmet need for a circuit and method for driving a permanent magnet electric motor without the complexity and cost of utilizing a complex microcontroller such as a DSP.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0016" num="0015">It is an object of the invention to provide a circuit and method for eliminating acoustic noise produced by a permanent magnet electric motor without tri-stating a motor drive voltage.</p>
<p id="p-0017" num="0016">It is another object of the invention to provide circuit and method for driving an electric motor so as to eliminate acoustic noise without tri-stating its drive voltage.</p>
<p id="p-0018" num="0017">It is another object of the invention to provide a circuit and method for driving a permanent magnet electric motor without tri-stating the motor drive voltage wherein information representative of parameters of the motor is automatically determined, or is provided in a non-volatile memory such as an EEPROM.</p>
<p id="p-0019" num="0018">There also is an unmet need for a circuit and method for driving a permanent magnet electric motor without the complexity and cost of utilizing a complex microcontroller, such as a DSP.</p>
<p id="p-0020" num="0019">Briefly described, and in accordance with one embodiment, the present invention provides a system for controlling a motor (<b>3</b>), including a driver circuit (<b>5</b>) for generating a drive voltage (v) to generate a phase current (i) in the motor. Phase current sensing circuitry (<b>10</b>,<b>21</b>) digitizes the phase current. A first circuit (<b>23</b>) provides a reconstructed digital representation of a BEMF signal (v<sub>bemf</sub>) of the motor to generate an error-corrected synchronization signal (SYNC) in response to the phase current and a detected error in the motor speed, an amplitude feedback signal (<b>15</b>), and information (i<sub>R</sub>,i<sub>L</sub>,&#x394;i<sub>L</sub>,v<sub>L</sub>) indicative of a resistance (R<sub>m</sub>) and an inductance (L<sub>m</sub>) of the motor. A motor drive signal (<b>15</b>) having an error-corrected frequency is generated in response to the synchronization signal. A PWM circuit (<b>16</b>) produces a PWM signal (<b>17</b>) having a frequency equal to the error-corrected frequency of the synchronization signal (SYNC) and a duty cycle controlled according to the detected error.</p>
<p id="p-0021" num="0020">In one embodiment, the invention provides a system (<b>1</b>) for controlling a permanent magnet motor (<b>3</b>), including a driver circuit (<b>5</b>) for generating a drive voltage (v) applied to the motor (<b>3</b>), the motor (<b>3</b>) generating a phase current (i) in response to the drive voltage (v). Phase current sensing circuitry (<b>10</b>,<b>21</b>) senses the phase current (i) and converts it to a digitized phase current. A BEMF (back electromotive force) reconstruction circuit (<b>23</b>) provides a reconstructed digital representation of a BEMF signal (v<sub>bemf</sub>) of the motor (<b>3</b>) to generate an error-corrected synchronization signal (SYNC) in response to the digitized phase current signal, an amplitude feedback signal (<b>15</b>), information (i<sub>R</sub>,i<sub>L</sub>,&#x394;i<sub>L</sub>,v<sub>L</sub>) indicative of both a resistance (R<sub>m</sub>) and an inductance (L<sub>m</sub>) of the motor (<b>3</b>), and a detected error in the speed of the motor (<b>3</b>). Signal profile generating circuitry (<b>12</b>,<b>14</b>) generates a motor drive signal (<b>15</b>) having an error-corrected frequency that is determined by the synchronization signal (SYNC) and is in synchronization with the synchronization signal (SYNC). A PWM (pulse width modulation) circuit (<b>16</b>) receiving the motor drive signal (<b>15</b>) produces a PWM signal (<b>17</b>) having a frequency equal to the error-corrected frequency of the synchronization signal (SYNC) and has a duty cycle controlled in accordance with the detected error in the speed of the motor (<b>3</b>).</p>
<p id="p-0022" num="0021">In one embodiment, a parameter calculation circuit (<b>22</b>) generates the information indicative of both the motor resistance (R<sub>m</sub>) and the motor inductance (L<sub>m</sub>) in response to the digitized phase current under predetermined conditions. The parameter calculation circuit (<b>22</b>) includes a state machine (<b>19</b>) which performs the functions of mechanically stopping rotation of a rotor of the motor (<b>03</b>), applying the drive voltage (v) as a high frequency sinusoidal signal until the phase current (i) is at a DC value, saving a first value (v<sub>R</sub>) of the applied voltage (v), and saving a resulting value (i<sub>R</sub>) of the digitized phase current, generating the information indicative of the motor resistance (R<sub>m</sub>) from the first value (v<sub>R</sub>) of the applied voltage (v) and the resulting value (i<sub>R</sub>) of the digitized phase current signal, causing the phase current (i) to be equal to zero, saving a measured value of current change (&#x394;i<sub>L</sub>) and a second value (v<sub>L</sub>) of the applied drive voltage (v), and generating the information indicative of the motor inductance (L<sub>m</sub>) from the measured value of current change (&#x394;i<sub>L</sub>) and the second value (v<sub>L</sub>) of the applied drive voltage (v). The motor resistance (R<sub>m</sub>) may be represented by the expression R<sub>m</sub>=v<sub>R</sub>/i<sub>R </sub>and the motor inductance (L<sub>m</sub>) may be represented by the expression</p>
<p id="p-0023" num="0022">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>L</mi>
      <mi>m</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
      <msub>
        <mi>v</mi>
        <mi>L</mi>
      </msub>
      <mrow>
        <mi>&#x394;</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <msub>
            <mi>i</mi>
            <mi>L</mi>
          </msub>
          <mo>/</mo>
          <mi>&#x394;</mi>
        </mrow>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mi>t</mi>
      </mrow>
    </mfrac>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
where v<sub>R </sub>is the first value of the applied voltage (v), i<sub>R </sub>is the resulting value of the digitized phase current, v<sub>L </sub>is the second value of the applied drive voltage (v), &#x394;i<sub>L </sub>is the measured value of current change, and &#x394;t is a time interval.
</p>
<p id="p-0024" num="0023">In one embodiment, the BEMF reconstruction circuit (<b>23</b>) includes a state machine (<b>20</b>) which operates to capture a digitized phase current (I), a change (&#x394;I) in the digitized phase current (I), and a digitized motor driving voltage (V). The BEMF construction circuit (<b>23</b>) operates to compute a value of the BEMF signal (v<sub>bemf</sub>) in accordance with the expression
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>k&#xb7;v</i><sub>bemf</sub><i>=V&#xb7;i</i><sub>R</sub><i>&#xb7;&#x394;i</i><sub>L</sub><i>&#x2212;I&#xb7;v</i><sub>R</sub><i>&#x2212;v</i><sub>L</sub><i>&#xb7;&#x394;I, </i><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where V is the digitized motor driving voltage, I is the digitized phase current, &#x394;I is a change in the digitized phase current, i<sub>R </sub>is a current indicative of the resistance (R<sub>m</sub>) of the motor, v<sub>R </sub>is a voltage indicative of the resistance (R<sub>m</sub>), &#x394;i<sub>L </sub>is a change of a current indicative of the inductance (L<sub>m</sub>) of the motor, and v<sub>L </sub>is a voltage indicative of the inductance (L<sub>m</sub>) of the motor.
</p>
<p id="p-0025" num="0024">In a described embodiment, the state machine (<b>20</b>) operates to cause the synchronization signal (SYNC) to be at a first logic level (&#x201c;0&#x201d;) if a MSB (most significant bit) of the BEMF signal (v<sub>bemf</sub>) is a &#x201c;0&#x201d; and to cause the synchronization signal (SYNC) to be at a second logic level (&#x201c;1&#x201d;) if the MSB of the BEMF signal (v<sub>bemf</sub>) is a &#x201c;1&#x201d;. In a described embodiment, another state machine (<b>19</b>) generates the information (i<sub>R</sub>,i<sub>L</sub>,&#x394;i<sub>L</sub>,v<sub>L</sub>) indicative of the resistance (R<sub>m</sub>) and the inductance (L<sub>m</sub>) of the motor (<b>3</b>) in response to the phase current.</p>
<p id="p-0026" num="0025">In a described embodiment, the signal profile generating circuitry (<b>12</b>,<b>14</b>) includes an electrical period measuring circuit (<b>12</b>) for measuring an amount of time between corresponding edges of successive pulses of the synchronization signal (SYNC).</p>
<p id="p-0027" num="0026">In one embodiment, the motor (<b>3</b>) is a three phase motor, and the phase current (i) is generated in response to a single drive voltage (v). In one embodiment, the signal profile generating circuit (<b>12</b>,<b>14</b>) generates the motor drive signal (<b>15</b>) as a sinusoidal signal. In another embodiment, the signal profile generating circuit (<b>12</b>,<b>14</b>) generates the motor drive signal (<b>15</b>) as a trapezoidal signal.</p>
<p id="p-0028" num="0027">In one embodiment, the invention provides a method for controlling a permanent magnet motor (<b>3</b>), including generating a drive voltage (v) applied to the motor (<b>3</b>), the motor (<b>3</b>) generating a phase current (i) in response to the drive voltage (v); sensing the phase current (i) and converting it to a digitized phase current signal (I); providing information indicative of both a motor resistance (R<sub>m</sub>) and a motor inductance (L<sub>m</sub>); generating a reconstructed digital representation of a BEMF signal (v<sub>bemf</sub>) produced in the motor (<b>3</b>) in response to an amplitude feedback signal (<b>15</b>), the digitized phase current signal (I), the information indicative of the motor resistance (R<sub>m</sub>) and the motor inductance (L<sub>m</sub>), and a detected difference between a speed of the motor (<b>3</b>) and a desired speed of the motor (<b>3</b>) in order to produce a synchronization signal (SYNC) having an error-corrected frequency that is determined by zero crossover points of the reconstructed digital representation of the BEMF signal (v<sub>bemf</sub>); using a drive signal profile to generate a digital motor drive signal (<b>15</b>) having the error-corrected frequency; and producing a PWM signal (<b>17</b>) having a frequency equal to the error-corrected frequency and also having a duty cycle controlled according to the detected difference between the speed of the motor (<b>3</b>) and the desired speed of the motor (<b>3</b>).</p>
<p id="p-0029" num="0028">In one embodiment, the method includes operating the BEMF reconstruction circuit (<b>23</b>) to compute a value of the BEMF signal (v<sub>bemf</sub>) in accordance with the expression
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>k&#xb7;v</i><sub>bemf</sub><i>=V&#xb7;i</i><sub>R</sub><i>&#xb7;&#x394;i</i><sub>L</sub><i>&#x2212;I&#xb7;v</i><sub>R</sub><i>&#x2212;v</i><sub>L</sub><i>&#xb7;&#x394;I, </i><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where V is the digitized motor driving voltage, I is the digitized phase current, &#x394;I is a change in the digitized phase current, i<sub>R </sub>is a current indicative of the resistance (R<sub>m</sub>) of the motor, v<sub>R </sub>is a voltage indicative of the resistance (R<sub>m</sub>), &#x394;i<sub>L </sub>is a change of a current indicative of the inductance (L<sub>m</sub>) of the motor, and v<sub>L </sub>is a voltage indicative of the inductance (L<sub>m</sub>) of the motor. In one embodiment, the BEMF reconstruction circuit (<b>23</b>) includes a state machine (<b>20</b>) which operates to capture the digitized phase current (I), the change in the digitized phase current (&#x394;I), and the digitized motor driving voltage (V), the method including operating the state machine (<b>20</b>) to cause the synchronization signal (SYNC) to be at a first logic level (&#x201c;0&#x201d;) if a MSB (most significant bit) of the BEMF signal (v<sub>bemf</sub>) is a &#x201c;0&#x201d; and to cause the synchronization signal (SYNC) to be at a second logic level (&#x201c;1&#x201d;) if the MSB of the BEMF signal (v<sub>bemf</sub>) is a &#x201c;1&#x201d;.
</p>
<p id="p-0030" num="0029">In one embodiment, the method includes operating the state machine (<b>20</b>) to cause the synchronization signal (SYNC) to be at a first logic level (&#x201c;0&#x201d;) if a MSB (most significant bit) of the BEMF signal (v<sub>bemf</sub>) is a &#x201c;0&#x201d; and to cause the synchronization signal (SYNC) to be at a second logic level (&#x201c;1&#x201d;) if the MSB of the BEMF signal (v<sub>bemf</sub>) is a &#x201c;1&#x201d;.</p>
<p id="p-0031" num="0030">In one embodiment, the method includes operating the signal profile generating circuit (<b>12</b>,<b>14</b>) to generate the motor drive signal (<b>15</b>) as a sinusoidal signal.</p>
<p id="p-0032" num="0031">In one embodiment, the invention provides a system (<b>1</b>) for controlling a permanent magnet motor (<b>3</b>), including means (<b>5</b>) for generating a drive voltage (v) applied to the motor (<b>3</b>), the motor (<b>3</b>) generating a phase current (i) in response to the drive voltage (v); means (<b>10</b>,<b>21</b>) for sensing the phase current (i) and converting it to a digitized phase current signal (I); means (<b>22</b>) for providing information indicative of both a motor resistance (R<sub>m</sub>) and a motor inductance (L<sub>m</sub>); means (<b>23</b>) for generating a reconstructed digital representation of a BEMF signal (v<sub>bemf</sub>) produced in the motor (<b>3</b>) in response to an amplitude feedback signal (<b>15</b>), the digitized phase current signal (I), the information indicative of the motor resistance (R<sub>m</sub>) and the motor inductance (L<sub>m</sub>), and a detected difference between a speed of the motor (<b>3</b>) and a desired speed of the motor (<b>3</b>) in order to produce a synchronization signal (SYNC) having an error-corrected frequency that is determined by zero crossover points of the reconstructed digital representation of the BEMF signal (v<sub>bemf</sub>); means (<b>12</b>,<b>14</b>) for using a drive signal profile to generate a digital motor drive signal (<b>15</b>) having the error-corrected frequency; and means (<b>16</b>) for producing a PWM signal (<b>17</b>) having a frequency equal to the error-corrected frequency and also having a duty cycle controlled according to the detected difference between the speed of the motor (<b>3</b>) and the desired speed of the motor (<b>3</b>).</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 1</figref> is a timing diagram useful in explaining the shortcomings of the closest prior art.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram of a circuit for driving a permanent magnet motor in accordance with the present invention.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 3A</figref> is diagram of a state machine included in block <b>22</b> of <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 3B</figref> is diagram of a state machine included in block <b>23</b> of <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 4</figref> is a flow diagram useful in describing the method associated with the circuit described with reference to <figref idref="DRAWINGS">FIG. 2</figref> and the state machines shown in <figref idref="DRAWINGS">FIGS. 3A and 3B</figref>.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 5</figref> is a timing diagram useful in describing the operation of the circuit of <figref idref="DRAWINGS">FIG. 2</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0039" num="0038">The present invention provides a way of eliminating the above-mentioned problem of acoustic noise caused by phase current distortion in permanent magnet motors driven by the closest prior art motor controllers. This is accomplished by a technique of &#x201c;reconstructing&#x201d; the BEMF signal used to synchronize the driving of a permanent magnet motor without tri-stating its drive voltage. Consequently, there is no associated distortion of the motor phase current, and therefore there is no corresponding distortion of the motor torque which causes the acoustic noise.</p>
<p id="p-0040" num="0039">Referring to <figref idref="DRAWINGS">FIG. 2</figref>, system <b>1</b> includes a permanent magnet motor <b>3</b> driven by a motor driver circuit <b>5</b>. A motor controller circuit <b>7</b> receives a sensed phase current &#x201c;i&#x201d; of motor <b>3</b> through conductor <b>11</b> and produces a PWM (pulse width modulated) motor control signal on conductor <b>17</b> as an input to driver circuit <b>5</b>. Sensed phase current i may be generated in conductor <b>11</b> by a conventional current sensor <b>10</b> that is either in or connected to motor <b>3</b>. Control system <b>7</b> senses the phase current i and uses it to provide feedback from motor <b>3</b> to motor driver circuit <b>5</b>. The feedback includes motor speed/frequency and phase information in the form of a synchronization signal SYNC on conductor <b>24</b> and amplitude information on bus <b>15</b>.</p>
<p id="p-0041" num="0040">Driver circuit <b>5</b> generates three-phase sinusoidal drive voltages on conductors <b>9</b>-<b>1</b>, <b>9</b>-<b>2</b>, and <b>9</b>-<b>3</b>, respectively, in response to the above-mentioned feedback. (However, note that the invention is just as applicable to a single-phase permanent magnet motor as to a three-phase permanent magnet motor.) The driver circuits (not shown) in block <b>5</b> are conventional.</p>
<p id="p-0042" num="0041">The circuitry in motor controller <b>7</b> that generates the above mentioned feedback includes a phase current sensing circuit <b>21</b> which receives the single phase current i generated in conductor <b>11</b> by phase current sensor <b>10</b> in response to current in motor <b>3</b>. Motor controller <b>7</b> receives phase current i and provides PWM (pulse width modulation) feedback on conductor <b>17</b> to motor driver circuit <b>5</b>. Motor controller <b>7</b> determines the amount of an error in the timing of SYNC, determined on the basis of the present phase current i and the present output <b>15</b> of sine driving profile circuit <b>14</b>. Motor <b>3</b> is driven to its maximum speed, limited by the power supply. Since motor <b>3</b> does not have a terminal from which the phase current i can be directly conducted, current sensor <b>10</b>, which can be either internal or external to motor <b>3</b>, is used to determine the phase current i. Phase current sensing circuit <b>21</b> performs an analog-to-digital conversion of the analog phase current i to a digital representation which indicates values of i as a function of time. (Therefore, it can be seen that the phase current sensing according to the invention is very different than the phase current sensing in prior art permanent magnet motor controllers with waveforms such as those shown in Prior Art FIG. 1.)</p>
<p id="p-0043" num="0042">The digital information generated by phase current sensing circuit <b>21</b> is received and utilized by a parameter calculation circuit <b>22</b> and a BEMF reconstruction circuit <b>23</b> to perform the function of &#x201c;reconstructing&#x201d; the BEMF signal, for example by means of suitable state machines. In block <b>22</b> of <figref idref="DRAWINGS">FIG. 2</figref>, information representative of the motor resistance R<sub>m </sub>and motor inductance L<sub>m </sub>is determined, for example, by means of a state machine such as the one shown in subsequently described <figref idref="DRAWINGS">FIG. 3A</figref>. The foregoing information representative of R<sub>m </sub>and L<sub>m </sub>of motor <b>3</b> is computed automatically, as indicated in blocks <b>30</b>-<b>40</b> of the flowchart of subsequently described <figref idref="DRAWINGS">FIG. 4</figref>. (Alternatively, the information representative of R<sub>m </sub>and L<sub>m </sub>may be previously determined and stored in block <b>22</b> in place of a parameter calculation circuit.)</p>
<p id="p-0044" num="0043">Then, using (in effect) the foregoing values of R<sub>m </sub>and L<sub>m </sub>along with feedback generated on bus <b>15</b> by sine driving profile circuit <b>14</b>, BEMF reconstruction circuit <b>23</b> in <figref idref="DRAWINGS">FIG. 2</figref> digitally reconstructs the BEMF signal, determines its zero-crossing times, and generates rising edges of the synchronization signal SYNC on conductor <b>24</b> in response to the zero-crossing times. The frequency of SYNC therefore represents the instantaneous actual frequency (rotor speed) of motor <b>3</b>. Any error in the motor speed may be determined by comparing it with the previously measured value representing the desired motor speed.</p>
<p id="p-0045" num="0044">The BEMF zero-crossing signal SYNC on conductor <b>24</b> is applied to an input of an electrical period measurement circuit <b>12</b>, the output <b>13</b> of which is connected to the input of a sine drive profile circuit <b>14</b>. The frequency information contained in SYNC is converted to an electrical period measurement by circuit <b>12</b>, and is presented on digital bus <b>13</b> as an input to sine driving profile circuit <b>14</b>. The digital information on multi-conductor digital bus <b>13</b> represents error in the motor speed, which is corrected in response to the feedback provided by SYNC, because SYNC represents the variation in the frequency of motor <b>3</b>. Sine driving profile circuit <b>14</b> stores a normalized sine wave and is able to interpret the electrical period measurement from circuit <b>12</b> so that sine driving profile circuit <b>14</b> produces a sine wave profile having the correct frequency.</p>
<p id="p-0046" num="0045">Sine driving profile circuit <b>14</b> generates digital data that represents a sine wave on multi-conductor digital bus <b>15</b>. The frequency of the digital sine wave data on digital bus <b>15</b> is adjusted in response to shifts in the frequency of SYNC. The measured present speed is in effect compared to the previously measured desired speed. If the motor is either accelerating or decelerating, there will be error between the previously measured desired speed and the currently measured speed, and feedback causes automatic correction of the error. The shifts in the frequency of SYNC are caused by changes in the values of phase current i and are also caused by an error or difference between a previous value of the sine driving profile information on bus <b>15</b> and a previously measured value representing the desired speed of motor <b>3</b>. The period of SYNC is adjusted to minimize this error or difference in order to accomplish the correction. The sinusoidal driving profile amplitude control information on bus <b>15</b> in effect provides feedback that causes electrical period measurement circuit <b>12</b> to adjust the &#x201c;ideal&#x201d; sinusoidal profile information stored in sine driving profile circuit <b>14</b> to cause it to generate a corrected output on multi-conductor digital bus <b>15</b> of sine driving profile circuit <b>14</b>.</p>
<p id="p-0047" num="0046">In block <b>23</b> of <figref idref="DRAWINGS">FIG. 2</figref>, the BEMF signal of motor <b>3</b> is reconstructed within controller <b>7</b> in accordance with subsequently described Equations 1-6, which provide the basis for generating the data required to reconstruct the digital BEMF data signal that represents the &#x201c;actual&#x201d; analog BEMF signal of motor <b>3</b>. The times at which the reconstructed BEMF signal crosses the zero volt level can be readily detected from the reconstructed BEMF data. The detected BEMF zero-crossing times then are utilized to adjust the timing between the SYNC pulses generated on conductor <b>24</b>, which are coupled to an input of electrical period measurement circuitry <b>12</b> in FIG. <b>2</b>. The waveform of SYNC is shown in subsequently described <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0048" num="0047">Electrical period measurement circuitry <b>12</b> then utilizes a counter (not shown) to measure the amount of time between corresponding edges of the pulses of synchronization signal SYNC, i.e., to measure the period of SYNC. Electrical period measurement circuit <b>12</b> then generates a feedback signal on digital bus <b>13</b> which represents the present speed of motor <b>3</b>.</p>
<p id="p-0049" num="0048">The signal on bus <b>13</b> represents the corrected speed of motor <b>3</b> and is synchronized with SYNC and the rotation of motor <b>3</b>, and is utilized by sine driving profile circuit <b>14</b> to adjust the instantaneous amplitudes of the stored ideal sinusoidal driving profile information so as to generate the sinusoidal digital motor drive voltage profile on digital bus <b>15</b> as needed to maintain the desired motor speed.</p>
<p id="p-0050" num="0049">The information on bus <b>15</b> includes digital sinusoidal signal information including both waveform amplitude information and synchronization information generated in response to the signal SYNC produced by BEMF reconstruction circuit <b>23</b> to control the frequency, phase, and amplitude of each of the three motor driver voltages. Motor <b>3</b> is driven by a pure sine wave signal because the digital amplitude information generated by sine driving profile circuit <b>14</b> represents a pure analog sine wave signal that rises from zero to a maximum positive voltage and then falls back through zero to a minimum negative voltage before returning to zero.</p>
<p id="p-0051" num="0050">The digital signal on bus <b>15</b> is utilized by a conventional PWM generation circuit <b>16</b> to determine the duty cycle of a PWM signal <b>17</b> generated by PWM generation circuit <b>16</b>. PWM circuit <b>16</b> generates pulses the widths of which have duty cycles as needed to adjust the amplitudes of the motor drive voltage signals. PWM generation circuit <b>16</b> may use a standard method of converting a signal amplitude to a duty cycle, including comparing the amplitude value with a triangular waveform. When the value of the digital signal on bus <b>15</b> is less than the value of the triangular waveform, the PWM signal generated on conductor <b>17</b> is low, and when the value of the triangular waveform is higher than the value of the digital signal on bus <b>15</b>, the PWM signal generated on conductor <b>17</b> is high. The frequency of the provided triangular waveform is fixed. Therefore, as the amplitude of the digital signal on bus <b>15</b> increases, the duty cycle of the PWM signal generated on conductor <b>17</b> increases, and vice versa.</p>
<p id="p-0052" num="0051">PWM signal <b>17</b> is utilized in motor driver circuit <b>5</b> to control the turning on and turning off of pull-up output transistors and pull-down transistors in the output stages of the three push-pull driver circuits (not shown) included in motor driver circuit <b>5</b>. The pull-up and pull-down output transistors in motor driver circuit <b>5</b> are turned on and off in accordance with the duty cycle of PWM signal <b>17</b> and thereby control the amplitude, frequency, and phase of each of the three sinusoidal motor drive voltages on conductors <b>9</b>-<b>1</b>, <b>9</b>-<b>2</b>, and <b>9</b>-<b>3</b>, respectively.</p>
<p id="p-0053" num="0052">Before describing <figref idref="DRAWINGS">FIGS. 3A</figref>, <b>3</b>B, and <b>5</b>, it may be helpful to present the analytical basis for the motor parameter calculations performed by parameter calculation circuit <b>32</b> and the BEMF reconstruction calculations performed by BEMF reconstruction circuit <b>23</b>.</p>
<p id="p-0054" num="0053">The motor speed (i.e., angular velocity of the rotor of motor <b>3</b>) is used to achieve the driving of motor <b>3</b> in synchronization with its BEMF. The phase current i of motor <b>3</b> does not directly provide the motor speed. However, information representative of the values of L<sub>m </sub>and R<sub>m </sub>may be derived from the digitized representation of phase current i. The digitized phase current i is used to reconstruct the BEMF of motor <b>3</b>. The reconstructed BEMF signal then represents the actual BEMF signal generated by motor <b>3</b> on one of the tri-stated drive voltage conductors <b>9</b>-<b>1</b>,<b>2</b>,<b>3</b>, and hence represents the speed of motor <b>3</b>. The reconstructed BEMF signal also synchronizes the motor drive voltages generated by motor driver <b>5</b> with the BEMF of motor <b>3</b>.</p>
<p id="p-0055" num="0054">Theoretically, the speed of motor <b>3</b> may be derived from the measured phase current data by means of the following &#x201c;motor equation&#x201d;:</p>
<p id="p-0056" num="0055">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mover>
              <mi>v</mi>
              <mi>_</mi>
            </mover>
            <mi>bemf</mi>
          </msub>
          <mo>=</mo>
          <mrow>
            <mover>
              <mi>v</mi>
              <mi>_</mi>
            </mover>
            <mo>-</mo>
            <mrow>
              <mover>
                <mi>i</mi>
                <mi>_</mi>
              </mover>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <msub>
                <mi>R</mi>
                <mi>m</mi>
              </msub>
            </mrow>
            <mo>-</mo>
            <mrow>
              <msub>
                <mi>L</mi>
                <mi>m</mi>
              </msub>
              <mo>&#x2062;</mo>
              <mfrac>
                <mrow>
                  <mo>&#x2146;</mo>
                  <mover>
                    <mi>i</mi>
                    <mi>_</mi>
                  </mover>
                </mrow>
                <mrow>
                  <mo>&#x2146;</mo>
                  <mi>t</mi>
                </mrow>
              </mfrac>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>Eqn</mi>
          <mo>.</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mn>1</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
in which <o ostyle="single">v</o><sub>bemf </sub>is the BEMF of the driven motor <b>3</b> and is proportional to its speed. <o ostyle="single">v</o> is a phase output voltage vector of the driven motor <b>3</b>, and &#x12b; is the measured phase current vector of the driven motor. R<sub>m </sub>is the stator resistance of the driven motor, and L<sub>m </sub>is the inductance of the stator winding of the driven motor <b>3</b>.
</p>
<p id="p-0057" num="0056">Equation 1 depends on not only the driven value <o ostyle="single">v</o> and the measured value &#x12b;, but also on the constant motor parameters R<sub>m </sub>and L<sub>m </sub>of motor <b>3</b>. (Note that since these motor parameters vary from motor to motor, their values may be determined for each motor.)</p>
<p id="p-0058" num="0057">For the case in which the phase current is sampled at a fixed frequency or motor speed, Equation 1 may be written as</p>
<p id="p-0059" num="0058">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>v</mi>
          <mi>bemf</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <mi>v</mi>
          <mo>-</mo>
          <msub>
            <mi>iR</mi>
            <mi>m</mi>
          </msub>
          <mo>-</mo>
          <mrow>
            <msub>
              <mi>L</mi>
              <mi>m</mi>
            </msub>
            <mo>&#x2062;</mo>
            <mrow>
              <mfrac>
                <mrow>
                  <mi>&#x394;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>i</mi>
                </mrow>
                <mrow>
                  <mi>&#x394;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>t</mi>
                </mrow>
              </mfrac>
              <mo>.</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>Eqn</mi>
          <mo>.</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mn>2</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
In the case wherein motor <b>3</b> is stationary (see block <b>30</b> of subsequently described <figref idref="DRAWINGS">FIG. 4</figref>), v<sub>bemf </sub>is equal to zero, so Equation 2 is reduced to
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>v</i><sub>bemf</sub>=0<i>=v</i><sub>R</sub><i>&#x2212;i</i><sub>R</sub><i>&#xd7;R</i><sub>m</sub>,&#x2003;&#x2003;(Eqn. 3)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where v<sub>R </sub>and i<sub>R </sub>are the values of v and i utilized to compute R<sub>m</sub>. Consequently, R=v<sub>R</sub>/i<sub>R</sub>.
</p>
<p id="p-0060" num="0059">The motor inductance L<sub>m </sub>is obtained from the measured current change &#x394;i<sub>L </sub>and the value of the corresponding driven voltage v<sub>L </sub>while i=0, where v<sub>L </sub>and i<sub>L </sub>are the values of v and i utilized to compute L<sub>m</sub>. In this case Equation 2 is reduced to</p>
<p id="p-0061" num="0060">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mn>0</mn>
          <mo>=</mo>
          <mrow>
            <msub>
              <mi>v</mi>
              <mi>L</mi>
            </msub>
            <mo>-</mo>
            <mrow>
              <msub>
                <mi>L</mi>
                <mi>m</mi>
              </msub>
              <mo>&#x2062;</mo>
              <mrow>
                <mfrac>
                  <mrow>
                    <mi>&#x394;</mi>
                    <mo>&#x2062;</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>&#x2062;</mo>
                    <msub>
                      <mi>i</mi>
                      <mi>L</mi>
                    </msub>
                  </mrow>
                  <mrow>
                    <mi>&#x394;</mi>
                    <mo>&#x2062;</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>&#x2062;</mo>
                    <mi>t</mi>
                  </mrow>
                </mfrac>
                <mo>.</mo>
                <mstyle>
                  <mtext>
</mtext>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>Consequently</mi>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>L</mi>
            <mi>m</mi>
          </msub>
          <mo>=</mo>
          <mfrac>
            <msub>
              <mi>v</mi>
              <mi>L</mi>
            </msub>
            <mrow>
              <mi>&#x394;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mrow>
                <msub>
                  <mi>i</mi>
                  <mi>L</mi>
                </msub>
                <mo>/</mo>
                <mi>&#x394;</mi>
              </mrow>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mi>t</mi>
            </mrow>
          </mfrac>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>Eqn</mi>
          <mo>.</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mn>4</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where &#x394;i<sub>L </sub>is the difference in the measured phase current during a suitable time internal &#x394;t. Then, as indicated in block <b>40</b>, the measured current change &#x394;i<sub>L </sub>and the applied voltage v<sub>L </sub>are saved. &#x394;t is the PWM period, and is constant during the parameter calculation and driving of motor <b>3</b>. And as indicated by Equation 5 below, &#x394;t is cancelled out.
</p>
<p id="p-0062" num="0061">Blocks <b>41</b>-<b>47</b> of subsequently described <figref idref="DRAWINGS">FIG. 4</figref> indicate how the information indicative of the values of R<sub>m </sub>and L<sub>m </sub>is used by the state machine shown in subsequently described <figref idref="DRAWINGS">FIG. 3B</figref> in order to obtain the above-mentioned reconstructed BEMF data.</p>
<p id="p-0063" num="0062">To accomplish this, Equations (3) and (4) are substituted into Equation (2), which results in</p>
<p id="p-0064" num="0063">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>v</mi>
          <mi>bemf</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <mi>v</mi>
          <mo>-</mo>
          <mrow>
            <mi>i</mi>
            <mo>&#x2062;</mo>
            <mfrac>
              <msub>
                <mi>v</mi>
                <mi>R</mi>
              </msub>
              <msub>
                <mi>i</mi>
                <mi>R</mi>
              </msub>
            </mfrac>
          </mrow>
          <mo>-</mo>
          <mrow>
            <mfrac>
              <msub>
                <mi>v</mi>
                <mi>L</mi>
              </msub>
              <mrow>
                <mi>&#x394;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mrow>
                  <msub>
                    <mi>i</mi>
                    <mi>L</mi>
                  </msub>
                  <mo>/</mo>
                  <mi>&#x394;</mi>
                </mrow>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>t</mi>
              </mrow>
            </mfrac>
            <mo>&#xd7;</mo>
            <mrow>
              <mfrac>
                <mrow>
                  <mi>&#x394;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>i</mi>
                </mrow>
                <mrow>
                  <mi>&#x394;</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>t</mi>
                </mrow>
              </mfrac>
              <mo>.</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Eqn</mi>
        <mo>.</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mn>5</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
Multiplying Equation 5 by i<sub>R </sub>results in
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>k&#xb7;v</i><sub>bemf</sub><i>=v&#xb7;i</i><sub>R</sub><i>&#xb7;&#x394;i</i><sub>L</sub><i>&#x2212;i&#xb7;v</i><sub>R</sub><i>&#x2212;v</i><sub>L</sub><i>&#xb7;&#x394;i,</i>&#x2003;&#x2003;Eqn. 6<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where k&#xd7;v<sub>bemf </sub>is the motor speed, k is equal to i<sub>R</sub>&#xd7;&#x394;i<sub>L</sub>. (The value of k is not important since it is just a gain value, whereas the information of interest is the period information of v<sub>bemf</sub>.)
</p>
<p id="p-0065" num="0064">From Equation 6, the motor speed k&#xd7;v<sub>bemf </sub>can be determined without the complex calculations which are required by the closest prior art motor control systems, and without having to tri-state the driver output which are also required by the closest prior art motor control systems.</p>
<p id="p-0066" num="0065">In Equation 6, the instantaneous amplitude of motor drive voltage v is adjusted as needed to provide the required amount of drive to motor <b>3</b> to maintain its desired speed despite any variations in the load driven by motor <b>3</b> and despite any variations in certain other parameters. Digital values corresponding to the analog motor drive voltage v on conductors <b>9</b>-<b>1</b>,<b>2</b>,<b>3</b> are generated on bus <b>15</b> and are in accordance with Equation 6.</p>
<p id="p-0067" num="0066"><figref idref="DRAWINGS">FIG. 3A</figref> shows a diagram of a state machine which can be included in block <b>22</b> of <figref idref="DRAWINGS">FIG. 2</figref> to obtain the values of v, i, &#x394;i, and &#x394;t needed to determine the values of the constant motor parameters R<sub>m </sub>and L<sub>m</sub>. Referring to <figref idref="DRAWINGS">FIG. 3A</figref>, a state machine <b>19</b> for obtaining the information required to determine R<sub>m </sub>and L<sub>m </sub>includes states <b>25</b>, <b>26</b>, <b>27</b> and <b>28</b>. State <b>25</b> is an initial &#x201c;brake&#x201d; or &#x201c;standby&#x201d; state that occurs when a condition &#x201c;reset&#x201d; is met, i.e., when &#x201c;reset&#x201d; goes from a &#x201c;1&#x201d; to a &#x201c;0&#x201d;. State machine <b>19</b> then goes from state <b>25</b> to state <b>26</b>. In state <b>26</b>, when a condition &#x201c;deltaIisZero&#x201d; is met, i.e., goes from a &#x201c;0&#x201d; to a &#x201c;1&#x201d;, state machine <b>19</b> causes the values v<sub>R </sub>and i<sub>R </sub>to be obtained, and then state machine <b>19</b> goes from state <b>26</b> to state <b>27</b>. In state <b>27</b>, when a condition &#x201c;IisZero&#x201d; goes from a &#x201c;0&#x201d; to a &#x201c;1&#x201d;, state machine <b>19</b> obtains the present values of &#x394;i<sub>L </sub>and v<sub>L</sub>. State machine <b>19</b> then proceeds from state <b>27</b> to state <b>28</b>. In state <b>28</b>, state machine <b>19</b> causes motor <b>3</b> to run until a condition &#x201c;Fault=0&#x201d;, which means that there is no error and therefore motor <b>3</b> is running perfectly, changes to &#x201c;Fault=1&#x201d;. The condition &#x201c;Fault=1&#x201d; may mean that motor <b>3</b> is not running, or there is excessively high motor current, or an excessively low drive voltage, or some other unacceptable fault condition exists. Then state machine <b>19</b> returns to state <b>25</b>.</p>
<p id="p-0068" num="0067"><figref idref="DRAWINGS">FIG. 3B</figref> shows a diagram of a state machine <b>20</b> which can be included in BEMF reconstruction circuit <b>23</b> in <figref idref="DRAWINGS">FIG. 2</figref> to generate the feedback and synchronization signal SYNC. State machine <b>20</b> includes states <b>50</b>, <b>51</b>, <b>52</b>, <b>53</b>, <b>54</b>, and <b>55</b>. &#x201c;Start&#x201d; state <b>50</b> is set when a condition &#x201c;start&#x201d; goes from a &#x201c;0&#x201d; to a &#x201c;1&#x201d;, and this causes state machine <b>20</b> to go to state <b>51</b>. In state <b>51</b>, state machine <b>20</b> captures the digitized value of a present value of the motor phase current i when a condition &#x201c;capCurrReady&#x201d; goes from a &#x201c;0&#x201d; to a &#x201c;1&#x201d;. (Note that phase current i already has been digitized by phase current sensing circuit <b>21</b> in <figref idref="DRAWINGS">FIG. 2</figref>.) State machine <b>20</b> then goes to state <b>52</b> and captures the digitized present value of motor drive voltage v when the condition &#x201c;capVoltReady&#x201d; goes from a &#x201c;0&#x201d; to a &#x201c;1&#x201d;. State machine <b>20</b> then goes to state <b>53</b> and calculates the BEMF signal v<sub>bemf </sub>according to Equation 6, and then goes to state <b>54</b> if MSB is equal to &#x201c;0&#x201d; and sets SYNC to a &#x201c;0&#x201d; as indicated by state <b>54</b>. If MSB is a &#x201c;1&#x201d;, state machine <b>20</b> sets SYNC to a &#x201c;1&#x201d;. (MSB is the most significant bit of the computed digitized signal v<sub>bemf</sub>). In either case, state machine <b>20</b> goes to state <b>51</b> and again captures a new digitized present value of phase current i when &#x201c;capCurrReady&#x201d; goes from a &#x201c;0&#x201d; to a &#x201c;1&#x201d;. What this means is that v<sub>bemf </sub>is compared with a provided reference value that represents the desired speed of motor <b>3</b>. If v<sub>bemf </sub>is greater than the desired motor speed reference value, then SYNC is set to a &#x201c;1&#x201d;, and if v<sub>bemf </sub>is less than the desired motor speed reference value, then SYNC is set to a &#x201c;0&#x201d;.</p>
<p id="p-0069" num="0068">Blocks <b>30</b>-<b>40</b> of <figref idref="DRAWINGS">FIG. 4</figref> constitute a flowchart of the basic process performed by state machine <b>19</b> of <figref idref="DRAWINGS">FIG. 3A</figref> in parameter calculation circuit <b>22</b> of <figref idref="DRAWINGS">FIG. 2</figref> to determine information representative of the constant parameters R<sub>m </sub>and L<sub>m </sub>of motor <b>3</b>. In block <b>30</b> of <figref idref="DRAWINGS">FIG. 4</figref>, the running motor <b>3</b> is forced into a stationary or standby mode <b>3</b> by applying a mechanical brake to stop the rotor of motor <b>3</b> to ensure that the BEMF signal v<sub>bemf </sub>of Equation 2 is zero. In order to measure R<sub>m </sub>and L<sub>m</sub>, a high frequency sinusoidal drive voltage is applied to motor <b>3</b>, as indicated in block <b>32</b>. Since the rotor of motor <b>3</b> is forced to be stationary, the applied high frequency drive voltage v does not move the rotor of motor <b>3</b>, thereby ensuring that v<sub>bemf </sub>remains equal to zero. The loop associated with decision block <b>34</b> of <figref idref="DRAWINGS">FIG. 4</figref> then waits until the computed value of &#x394;i is equal to zero. Then, as indicated in block <b>36</b>, the value of the digitized &#x201c;measured phase current&#x201d; i<sub>R </sub>and the value of the digitized &#x201c;applied drive voltage&#x201d; v<sub>R </sub>needed to compute R<sub>m </sub>are saved. The motor resistance R<sub>m </sub>may be determined from the measured current i<sub>R </sub>and the &#x201c;driven voltage&#x201d; v<sub>R </sub>when the condition i=0 in block <b>38</b> is met.</p>
<p id="p-0070" num="0069">State machine <b>19</b> of <figref idref="DRAWINGS">FIG. 3A</figref> remains in state <b>26</b> as long as the condition deltaIisZero=&#x201c;0&#x201d; continues. This is when the steps of blocks <b>36</b> and <b>38</b> in the flowchart of <figref idref="DRAWINGS">FIG. 4</figref> have been completed. An idle loop associated with decision block <b>38</b> waits for the computed value of phase current i to be equal to zero. Then the value of the &#x201c;measured current change&#x201d; &#x394;i<sub>L </sub>and the current i<sub>L </sub>needed to compute L<sub>m </sub>are determined and saved, as indicated in block <b>40</b>. When state <b>27</b> of state machine <b>19</b> is complete, that means the step in block <b>40</b> of <figref idref="DRAWINGS">FIG. 4</figref> has been completed.</p>
<p id="p-0071" num="0070">Blocks <b>41</b>-<b>47</b> of subsequently described <figref idref="DRAWINGS">FIG. 4</figref> indicate how the foregoing information representative of the values of R<sub>m </sub>and L<sub>m </sub>is used by state machine <b>20</b> in <figref idref="DRAWINGS">FIG. 3B</figref> of BEMF reconstruction circuit <b>23</b> of <figref idref="DRAWINGS">FIG. 2</figref>, to provide the reconstructed BEMF data. In block <b>41</b> of <figref idref="DRAWINGS">FIG. 4</figref>, the running of motor <b>3</b> is started by the state machine of <figref idref="DRAWINGS">FIG. 3B</figref>. In decision block <b>42</b>, the state machine determines whether a variable SAMPLE DATA is equal to &#x201c;1&#x201d;. The data is sampled at a fixed frequency. Therefore, at the end of every fixed period &#x394;t, SAMPLE DATA goes to &#x201c;1&#x201d; to sample the data. If the determination of decision block <b>42</b> is affirmative, state machine <b>20</b> goes to block <b>43</b> and captures the digitized present motor current and the rate of change (during an interval &#x394;t) of the present motor current to obtain the digitized values I and &#x394;I. If the determination of decision block <b>42</b> is negative, state machine <b>20</b> waits until SAMPLE DATA is equal to a &#x201c;1&#x201d;. In block <b>44</b>, state machine <b>20</b> captures the motor drive voltage to obtain the digitized value V. Next, state machine <b>20</b> goes to block <b>45</b> and computes the digital value of v<sub>bemf </sub>in accordance with Equation 6. Then, state machine <b>20</b> goes to decision block <b>46</b> and determines if the MSB (most significant bit) of the digital value of v<sub>bemf </sub>is greater than or equal to 0, to cause SYNC to be generated. If the determination of decision block <b>46</b> is affirmative, the state machine goes to block <b>47</b> and captures the digital value of v<sub>bemf </sub>and returns to the entry point of block <b>41</b>. If the determination of decision block <b>46</b> is negative, the program returns to the entry point of block <b>41</b>.</p>
<p id="p-0072" num="0071">The previously measured motor speed represented by the frequency of SYNC in <figref idref="DRAWINGS">FIG. 2</figref> is used as the basis for the current voltage profile generation. If motor <b>3</b> is accelerating or decelerating (e.g., due to the varying load), the frequency of motor drive voltage profile generated by sine driving profile circuit <b>14</b> automatically changes to adapt to the speed change of the accelerating or decelerating motor and causes PWM generation circuit <b>15</b> to modify the amplitudes of the motor drive voltages accordingly. Therefore, there is no need for the previously mentioned complex PID control calculations which are required in the closest prior art motor controllers.</p>
<p id="p-0073" num="0072">Thus, the BEMF of motor <b>3</b> as a function of time is calculated on the basis of Equations 1-6 and used to determine the present BEMF zero-crossing times and the present motor speeds without having to tri-state the motor drive voltages. In the above described example, motor <b>3</b> is driven with a pure sinusoidal pattern having a frequency equal to the frequency of the measured speed of motor <b>3</b> adjusted so as to be equal to the frequency of the desired motor speed in response to the signal SYNC shown in <figref idref="DRAWINGS">FIG. 5</figref>. This sinusoidal pattern is updated every AC cycle, and the zero-crossing points at which the calculated BEMF goes from negative to positive and vice versa are used for synchronization of the motor drive signal with the reconstructed BEMF signal.</p>
<p id="p-0074" num="0073"><figref idref="DRAWINGS">FIG. 5</figref> shows waveforms for the sinusoidal drive voltage v, the resulting phase current i, and the voltage represented by the reconstructed BEMF of permanent magnet motor <b>3</b> in <figref idref="DRAWINGS">FIG. 2</figref>. Note that segments &#x201c;A&#x201d; and &#x201c;B&#x201d; shown in Prior Art FIG. 1 are missing from the waveforms shown in <figref idref="DRAWINGS">FIG. 5</figref> because no tri-stating of the motor drive voltages occurs in permanent magnet motor <b>3</b> in <figref idref="DRAWINGS">FIG. 2</figref>. Therefore, there is no corresponding distortion of the phase current waveform shown in <figref idref="DRAWINGS">FIG. 5</figref>. As previously mentioned, the torque of a permanent magnet motor is equal to the product of its BEMF (back electromotive force) and its phase current. As illustrated by the constant, ripple-free torque curve shown in <figref idref="DRAWINGS">FIG. 5</figref>, there is none of the large torque variation due to the phase current distortion seen in Prior Art FIG. 1. Consequently, essentially no acoustic noise is generated by motor <b>3</b>.</p>
<p id="p-0075" num="0074">To summarize, the phase current and the motor parameters in the foregoing example of the invention are provided as inputs to a state machine (or other suitable circuitry) to reconstruct the BEMF signal on a real-time basis, and to extract the zero-crossing information from the reconstructed BEMF signal to generate the synchronization signal SYNC. The drive voltages of the motor <b>3</b> are synchronized with the reconstructed BEMF data without tri-stating the motor drive voltages on conductors <b>9</b>-<b>1</b>, <b>9</b>-<b>2</b>, and <b>9</b>-<b>3</b>, respectively. Distortion in the torque produced by motor <b>3</b> by the prior art technique of sensing the actual BEMF zero-crossings to achieve synchronization of the drive voltage and the BEMF of the motor phase current is essentially eliminated. Therefore, and in contrast to the closest prior art, there is no corresponding distortion in the phase current and consequently no acoustic noise.</p>
<p id="p-0076" num="0075">Since the described control scheme makes use of the motor speed represented by the SYNC signal, the disclosed motor control system <b>1</b> of <figref idref="DRAWINGS">FIG. 2</figref> eliminates the need for the previously mentioned complex calculations that are required in the closest prior art DC permanent magnet motor control systems. Furthermore, the information representative of the motor parameters L<sub>m </sub>and R<sub>m </sub>is automatically determined. Furthermore, the above described technique works for both sinusoidal and trapezoidal BEMF motors.</p>
<p id="p-0077" num="0076">Although a sinusoidal BEMF motor has been described, the method and equations are not limited to a sinusoidal BEMF motor. The same scheme/method may be used for a trapezoidal BEMF motor (although the improvement in acoustic performance may not be as great as for a sinusoidal BEMF motor). This is in contrast to methods that use a DSP (digital signal processor) and the previously mentioned Clarke-Park transformation, wherein the motors BEMF must be sinusoidal.</p>
<p id="p-0078" num="0077">While the invention has been described with reference to several particular embodiments thereof, those skilled in the art will be able to make various modifications to the described embodiments of the invention without departing from its true spirit and scope. It is intended that all elements or steps which are insubstantially different from those recited in the claims but perform substantially the same functions, respectively, in substantially the same way to achieve the same result as what is claimed are within the scope of the invention.</p>
<p id="p-0079" num="0078">It should be understood that the invention may be used to reduce acoustic noise in various motor applications, including cooling fans for consumer electronic devices, ceiling fans, cooling fans for home appliances, and the like. The invention is also applicable to brushless permanent magnet DC motors (i.e., motors having a trapezoidal BEMF).</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08624532-20140107-M00001.NB">
<img id="EMI-M00001" he="6.01mm" wi="76.20mm" file="US08624532-20140107-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08624532-20140107-M00002.NB">
<img id="EMI-M00002" he="6.69mm" wi="76.20mm" file="US08624532-20140107-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08624532-20140107-M00003.NB">
<img id="EMI-M00003" he="6.35mm" wi="76.20mm" file="US08624532-20140107-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US08624532-20140107-M00004.NB">
<img id="EMI-M00004" he="12.70mm" wi="76.20mm" file="US08624532-20140107-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US08624532-20140107-M00005.NB">
<img id="EMI-M00005" he="6.69mm" wi="76.20mm" file="US08624532-20140107-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US08624532-20140107-M00006.NB">
<img id="EMI-M00006" he="6.01mm" wi="76.20mm" file="US08624532-20140107-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A system for controlling a permanent magnet motor, comprising:
<claim-text>(a) a driver circuit for generating a drive voltage applied to the motor, the motor generating a phase current in response to the drive voltage;</claim-text>
<claim-text>(b) phase current sensing circuitry for sensing the phase current and converting it to a digitized phase current;</claim-text>
<claim-text>(c) a BEMF (back electromotive force) reconstruction circuit for providing a reconstructed digital representation of a BEMF signal of the motor to generate an error-corrected synchronization signal in response to the digitized phase current signal, an amplitude feedback signal, information indicative of both a resistance and an inductance of the motor, and a detected error in a speed of the motor;</claim-text>
<claim-text>(d) signal profile generating circuitry for generating a motor drive signal having an error-corrected frequency that is determined by the synchronization signal and is in synchronization with the synchronization signal; and</claim-text>
<claim-text>(e) a PWM (pulse width modulation) circuit receiving the motor drive signal for producing a PWM signal having a frequency equal to the error-corrected frequency of the synchronization signal and having a duty cycle controlled in accordance with the detected error in the speed of the motor,</claim-text>
<claim-text>a parameter calculation circuit for generating the information indicative of both the motor resistance and the motor inductance in response to the digitized phase current under predetermined conditions,</claim-text>
<claim-text>wherein the parameter calculation circuit includes a state machine which performs the functions of mechanically stopping rotation of a rotor of the motor, applying the drive voltage as a high frequency sinusoidal signal until the phase current is at a DC value, saving a first value of the applied voltage, and saving a resulting value of the digitized phase current, generating the information indicative of the motor resistance from the first value of the applied voltage and the resulting value of the digitized phase current signal, causing the phase current to be equal to zero, saving a measured value of current change and a second value of the applied drive voltage, and generating the information indicative of the motor inductance from the measured value of current change and the second value of the applied drive voltage.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the motor resistance is represented by the expression R<sub>m</sub>=v<sub>R</sub>/i<sub>R </sub>and wherein the motor inductance is represented by the expression</claim-text>
<claim-text>
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>L</mi>
      <mi>m</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
      <msub>
        <mi>v</mi>
        <mi>L</mi>
      </msub>
      <mrow>
        <mi>&#x394;</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <msub>
            <mi>i</mi>
            <mi>L</mi>
          </msub>
          <mo>/</mo>
          <mi>&#x394;</mi>
        </mrow>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mi>t</mi>
      </mrow>
    </mfrac>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>where v<sub>R </sub>is the first value of the applied voltage, i<sub>R </sub>is the resulting value of the digitized phase current, v<sub>L </sub>is the second value of the applied drive voltage, &#x394;i<sub>L </sub>is the measured value of current change, and &#x394;t is a time interval.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the BEMF reconstruction circuit includes a state machine which operates to capture a digitized phase current, a change in the digitized phase current, and a digitized motor driving voltage.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The system of <claim-ref idref="CLM-00003">claim 3</claim-ref> wherein the BEMF construction circuit operates to compute a value of the BEMF signal in accordance with the expression
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>k&#xb7;v</i><sub>bemf</sub><i>=V&#xb7;i</i><sub>R</sub><i>&#xb7;&#x394;i</i><sub>L</sub><i>&#x2212;I&#xb7;v</i><sub>R</sub><i>&#x2212;v</i><sub>L</sub><i>&#xb7;&#x394;I, </i><?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
<claim-text>where V is the digitized motor driving voltage, I is the digitized phase current, &#x394;I is a change in the digitized phase current, i<sub>R </sub>is a current indicative of the resistance of the motor, v<sub>R </sub>is a voltage indicative of the resistance, &#x394;i<sub>L </sub>is a change of a current indicative of the inductance of the motor, and v<sub>L </sub>is a voltage indicative of the inductance of the motor,</claim-text>
<claim-text>and wherein k is i<sub>R</sub>&#xd7;&#x394;i<sub>L</sub>.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The system of <claim-ref idref="CLM-00004">claim 4</claim-ref> wherein the state machine operates to cause the synchronization signal to be at a first logic level if a MSB (most significant bit) of the BEMF signal is a &#x201c;0&#x201d; and to cause the synchronization signal to be at a second logic level if the MSB of the BEMF signal is a &#x201c;1&#x201d;.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The system of <claim-ref idref="CLM-00005">claim 5</claim-ref> including another state machine for generating the information indicative of the resistance and the inductance of the motor in response to the phase current.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the signal profile generating circuitry includes an electrical period measuring circuit for measuring an amount of time between corresponding edges of successive pulses of the synchronization signal.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the phase current sensing circuit includes an external current sensor for sensing the phase current.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the motor is a three phase motor, and the phase current is generated in response to a single drive voltage.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the signal profile generating circuit generates the motor drive signal as a sinusoidal signal.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the signal profile generating circuit generates the motor drive signal as a trapezoidal signal.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A method for controlling a permanent magnet motor, comprising:
<claim-text>(a) generating a drive voltage applied to the motor, the motor generating a phase current in response to the drive voltage;</claim-text>
<claim-text>(b) sensing the phase current and converting it to a digitized phase current signal;</claim-text>
<claim-text>(c) providing information indicative of both a motor resistance and a motor inductance;</claim-text>
<claim-text>(d) generating a reconstructed digital representation of a BEMF signal produced in the motor in response to an amplitude feedback signal, the digitized phase current signal, the information indicative of the motor resistance and the motor inductance, and a detected difference between a speed of the motor and a desired speed of the motor in order to produce a synchronization signal having an error-corrected frequency that is determined by zero crossover points of the reconstructed digital representation of the BEMF signal;</claim-text>
<claim-text>(e) using a drive signal profile to generate a digital motor drive signal having the error-corrected frequency; and</claim-text>
<claim-text>(f) producing a PWM signal having a frequency equal to the error-corrected frequency and also having a duty cycle controlled according to the detected difference between the speed of the motor and the desired speed of the motor, and</claim-text>
<claim-text>operating the BEMF reconstruction circuit to compute a value of the BEMF signal in accordance with the expression:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>k&#xb7;v</i><sub>bemf</sub><i>=V&#xb7;i</i><sub>R</sub><i>&#xb7;&#x394;i</i><sub>L</sub><i>&#x2212;I&#xb7;v</i><sub>R</sub><i>&#x2212;v</i><sub>L</sub><i>&#xb7;&#x394;I, </i><?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
</claim-text>
<claim-text>where V is the digitized motor driving voltage, I is the digitized phase current, &#x394;I is a change in the digitized phase current, i<sub>R </sub>is a current indicative of the resistance of the motor, v<sub>R </sub>is a voltage indicative of the resistance, &#x394;i<sub>L </sub>is a change of a current indicative of the inductance of the motor, and v<sub>L </sub>is a voltage indicative of the inductance of the motor,</claim-text>
<claim-text>and k is equal to i<sub>R</sub>&#xd7;&#x394;i<sub>L</sub>.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref> including operating the state machine to cause the synchronization signal to be at a first logic level if a MSB (most significant bit) of the BEMF signal is a &#x201c;0&#x201d; and to cause the synchronization signal to be at a second logic level if the MSB of the BEMF signal is a &#x201c;1&#x201d;.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref> including operating the signal profile generating circuit to generate the motor drive signal as a sinusoidal signal.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref> wherein the BEMF reconstruction circuit includes a state machine which operates to capture the digitized phase current, the change in the digitized phase current, and the digitized motor driving voltage, the method including operating the state machine to cause the synchronization signal to be at a first logic level if a MSB (most significant bit) of the BEMF signal is a &#x201c;0&#x201d; and to cause the synchronization signal to be at a second logic level if the MSB of the BEMF signal is a &#x201c;1&#x201d;.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A system for controlling a permanent magnet motor, comprising:
<claim-text>(a) means for generating a drive voltage applied to the motor, the motor generating a phase current in response to the drive voltage;</claim-text>
<claim-text>(b) means for sensing the phase current and converting it to a digitized phase current signal;</claim-text>
<claim-text>(c) means for providing information indicative of both a motor resistance and a motor inductance;</claim-text>
<claim-text>(d) means for generating a reconstructed digital representation of a BEMF signal produced in the motor in response to an amplitude feedback signal, the digitized phase current signal, the information indicative of the motor resistance and the motor inductance, and a detected difference between a speed of the motor and a desired speed of the motor in order to produce a synchronization signal having an error-corrected frequency that is determined by zero cross-over points of the reconstructed digital representation of the BEMF signal;</claim-text>
<claim-text>(e) means for using a drive signal profile to generate a digital motor drive signal having the error-corrected frequency; and</claim-text>
<claim-text>(f) means for producing a PWM signal having a frequency equal to the error-corrected frequency and also having a duty cycle controlled according to the detected difference between the speed of the motor and the desired speed of the motor,</claim-text>
<claim-text>(g) means for parameter calculation for generating the information indicative of both the motor resistance and the motor inductance in response to the digitized phase current under predetermined conditions,</claim-text>
<claim-text>wherein the means for calculating includes a state machine which performs the functions of mechanically stopping rotation of a rotor of the motor, applying the drive voltage as a high frequency sinusoidal signal until the phase current is at a DC value, saving a first value of the applied voltage, and saving a resulting value of the digitized phase current, generating the information indicative of the motor resistance from the first value of the applied voltage and the resulting value of the digitized phase current signal, causing the phase current to be equal to zero, saving a measured value of current change and a second value of the applied drive voltage, and generating the information indicative of the motor inductance from the measured value of current change and the second value of the applied drive voltage.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The system of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein means for generating a reconstructed digital representation of a BEMF signal includes a state machine which operates to capture a digitized phase current, a change in the digitized phase current, and a digitized motor driving voltage,
<claim-text>wherein the means for generating a reconstructed digital representation of a BEMF signal operates to compute a value of the BEMF signal in accordance with the expression
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>k&#xb7;v</i><sub>bemf</sub><i>=V&#xb7;i</i><sub>R</sub><i>&#xb7;&#x394;i</i><sub>L</sub><i>&#x2212;I&#xb7;v</i><sub>R</sub><i>&#x2212;V</i><sub>L</sub><i>&#xb7;&#x394;I, </i><?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
</claim-text>
<claim-text>where V is the digitized motor driving voltage, I is the digitized phase current, &#x394;I is a change in the digitized phase current, i<sub>R </sub>is a current indicative of the resistance of the motor, v<sub>R </sub>is a voltage indicative of the resistance, &#x394;i<sub>L </sub>is a change of a current indicative of the inductance of the motor, and v<sub>L </sub>is a voltage indicative of the inductance of the motor,</claim-text>
<claim-text>and k is equal to i<sub>R</sub>&#xd7;&#x394;i<sub>L</sub>.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The system of <claim-ref idref="CLM-00017">claim 17</claim-ref> wherein the state machine operates to cause the synchronization signal to be at a first logic level if a MSB (most significant bit) of the BEMF signal is a &#x201c;0&#x201d; and to cause the synchronization signal to be at a second logic level if the MSB of the BEMF signal is a &#x201c;1&#x201d;.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The system of <claim-ref idref="CLM-00018">claim 18</claim-ref> including another state machine for generating the information indicative of the resistance and the inductance of the motor in response to the phase current.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The system of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the means for generating a signal profile includes an electrical period measuring circuit for measuring an amount of time between corresponding edges of successive pulses of the synchronization signal.</claim-text>
</claim>
</claims>
</us-patent-grant>
