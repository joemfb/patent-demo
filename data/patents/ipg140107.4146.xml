<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625215-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625215</doc-number>
<kind>B1</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13413049</doc-number>
<date>20120306</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<us-term-extension>44</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>11</class>
<subclass>B</subclass>
<main-group>27</main-group>
<subgroup>36</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>360 31</main-classification>
<further-classification>360 39</further-classification>
<further-classification>360 53</further-classification>
<further-classification>360 55</further-classification>
</classification-national>
<invention-title id="d2e53">Method and system for compensating for adjacent tracks during writing of data</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6185063</doc-number>
<kind>B1</kind>
<name>Cameron</name>
<date>20010200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6442705</doc-number>
<kind>B1</kind>
<name>Lamberts</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6549362</doc-number>
<kind>B1</kind>
<name>Melrose et al.</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6697209</doc-number>
<kind>B2</kind>
<name>Hughes et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6724702</doc-number>
<kind>B2</kind>
<name>Taguchi et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6862155</doc-number>
<kind>B2</kind>
<name>Yang et al.</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6963528</doc-number>
<kind>B2</kind>
<name>Ogura</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>7082007</doc-number>
<kind>B2</kind>
<name>Liu et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>7126890</doc-number>
<kind>B2</kind>
<name>Learned et al.</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>7209305</doc-number>
<kind>B2</kind>
<name>Chan et al.</name>
<date>20070400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>7218665</doc-number>
<kind>B2</kind>
<name>McElwain</name>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>7423828</doc-number>
<kind>B2</kind>
<name>Emo et al.</name>
<date>20080900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 60</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>7457075</doc-number>
<kind>B2</kind>
<name>Liu et al.</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>7567397</doc-number>
<kind>B2</kind>
<name>Lu</name>
<date>20090700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>7768729</doc-number>
<kind>B2</kind>
<name>Moser et al.</name>
<date>20100800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>7965465</doc-number>
<kind>B2</kind>
<name>Sanvido et al.</name>
<date>20110600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>8014097</doc-number>
<kind>B1</kind>
<name>Sanvido</name>
<date>20110900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>8125723</doc-number>
<kind>B1</kind>
<name>Nichols et al.</name>
<date>20120200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>8139301</doc-number>
<kind>B1</kind>
<name>Li et al.</name>
<date>20120300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>8259409</doc-number>
<kind>B2</kind>
<name>Braganca et al.</name>
<date>20120900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>8300339</doc-number>
<kind>B1</kind>
<name>Nangare et al.</name>
<date>20121000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>2003/0218955</doc-number>
<kind>A1</kind>
<name>Isshiki et al.</name>
<date>20031100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2007/0177292</doc-number>
<kind>A1</kind>
<name>Bui et al.</name>
<date>20070800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>19</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>4</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61454699</doc-number>
<date>20110321</date>
</document-id>
</us-provisional-application>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Burd</last-name>
<first-name>Gregory</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Nangare</last-name>
<first-name>Nitin</first-name>
<address>
<city>Santa Clara</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Burd</last-name>
<first-name>Gregory</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Nangare</last-name>
<first-name>Nitin</first-name>
<address>
<city>Santa Clara</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Marvell International Ltd.</orgname>
<role>03</role>
<address>
<city>Hamilton</city>
<country>BM</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Edun</last-name>
<first-name>Muhammad N</first-name>
<department>2686</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method of writing data to a storage device includes writing current data to a first track of data, monitoring write head position, and on detection of encroachment of the write head position on a second track of previously written data, using the current data to recover the previously written data on the second track, and rewriting the current data to the first track. A storage controller includes a device controller that writes data to a current track of data on a storage device. The device controller monitors write head position. On detection of encroachment of the write head position on a second track of previously written data uses the current data to recover the previously written data on the second track, and rewrites the current data to the first track. A storage system includes a storage medium having a plurality of tracks of data thereon, and a storage controller.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="229.87mm" wi="205.57mm" file="US08625215-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="265.85mm" wi="205.57mm" file="US08625215-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="231.31mm" wi="204.64mm" file="US08625215-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="242.15mm" wi="182.20mm" orientation="landscape" file="US08625215-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="186.61mm" wi="129.62mm" file="US08625215-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This claims the benefit of copending, commonly-assigned U.S. Provisional Patent Application No. 61/454,699, filed Mar. 21, 2011, which is hereby incorporated by reference herein in its entirety.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD OF USE</heading>
<p id="p-0003" num="0002">This disclosure relates to a method and system for writing data in an arrangement of tracks on a storage medium by a write head that moves relative to the surface of the storage medium. More particularly, this disclosure relates to compensating, during a write operation, for encroachment by the write signal onto an adjacent track or tracks.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">The background description provided herein is for the purpose of generally presenting the context of the disclosure. Work of the inventors hereof, to the extent the work is described in this background section, as well as aspects of the description that may not otherwise qualify as prior art at the time of filing, are neither expressly nor impliedly admitted to be prior art against the present disclosure.</p>
<p id="p-0005" num="0004">In magnetic recording, as one example of a type of recording in which reading and writing are performed by a head that moves relative to the surface of the storage medium, data may be written in circular tracks on a magnetic disk. In many magnetic recording systems, minimum track pitch is limited by the write head width, while the read head is designed to be narrower than the write head so that reading can occur without picking up signals from any adjacent track. In addition, guard bands&#x2014;empty bands on either side of each track&#x2014;are provided to help prevent data on one track from being overwritten during writing of an adjacent track because of write head positioning errors.</p>
<p id="p-0006" num="0005">In other magnetic recording systems, in order to increase recording densities, it is desirable to shrink the track pitch and reduce or remove the guard bands between the tracks, which allows more tracks to fit on the recording medium. For example, in &#x201c;Shingle Write Recording,&#x201d; also known as &#x201c;Shingled Magnetic Recording,&#x201d; the tracks are written so that one track partially overlaps the previous track. In such a system, track pitch theoretically may be arbitrarily small. In practice, in a Shingled Magnetic Recording system, the track pitch is limited by the read head width. If track pitch is narrower than the read head width, then the read head may pick up a significant amount of signals from one or more adjacent tracks, leading to low data reliability.</p>
<p id="p-0007" num="0006">In order to further reduce the track pitch beyond the read head width, it is necessary to mitigate the interference picked up from adjacent tracks during a read operation. If the component of the adjacent track picked up by the read head is sufficiently small, it may be possible to use knowledge of the data written on the adjacent track to carry out ITI cancellation&#x2014;i.e., cancellation of &#x201c;inter-track interference (ITI).&#x201d;</p>
<p id="p-0008" num="0007">Copending, commonly-assigned U.S. patent application Ser. No. 12/882,802, filed Sep. 15, 2010 and hereby incorporated by reference herein in its entirety, describes a method and system for compensating for ITI during reading by using actual or estimated data from the adjacent track.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0009" num="0008">A method of writing data to a storage device includes writing current data to a first track of data, monitoring write head position, and on detection of encroachment of the write head position on a second track of previously written data, using the current data to recover the previously written data on the second track, and rewriting the current data to the first track.</p>
<p id="p-0010" num="0009">A storage controller includes a device controller, and a write channel including a write head. The storage medium has a plurality of tracks of data thereon, and when the device controller writes data to a current track of data on the storage device, the device controller monitors write head position, and on detection of encroachment of the write head position on a second track of previously written data uses the current data to recover the previously written data on the second track, and rewrites the current data to the first track.</p>
<p id="p-0011" num="0010">A storage system includes a storage medium having a plurality of tracks of data thereon, and a storage controller. The storage controller includes a device controller, and a write channel including a write head. The storage medium has a plurality of tracks of data thereon, and when the device controller writes data to a current track of data on the storage device, the device controller monitors write head position, and on detection of encroachment of the write head position on a second track of previously written data, uses the current data to recover the previously written data on the second track, and rewrites the current data to the first track.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0012" num="0011">Further features of the disclosure, its nature and various advantages, will be apparent upon consideration of the following detailed description, taken in conjunction with the accompanying drawings, in which like reference characters refer to like parts throughout, and in which:</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 1</figref> is a representation of data written on adjacent tracks of a recording medium;</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 2</figref> is a representation of data written on adjacent tracks of a recording medium, where data from one track has encroached on an adjacent track;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 3</figref> is a flow diagram of a process according to an embodiment of this disclosure;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 4</figref> is a representation of the writing, according to an embodiment of this disclosure, of data on a storage medium;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 5</figref> is a schematic view of apparatus in accordance with an embodiment of this disclosure; and</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 6</figref> is a schematic view of a system in accordance with an embodiment of this disclosure.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0019" num="0018">This disclosure is a method and system for repairing the partial overwriting of a previously-written track, that is adjacent to a track that is currently being written, when head-positioning error causes the current track to encroach on and partially overwrite the previously-written track. Although above-incorporated application Ser. No. 12/882,802 describes a technique for cancelling ITI during reading, such ITI cancellation techniques become less effective in situations where the encroaching track has itself been overwritten (e.g., by the writing of new data) subsequent to the encroachment event. While some shingled recording formats and other small-track-pitch recording formats group a band of sectors in adjacent tracks and allow writing of each sector only once before the entire band is erased, thereby increasing the effectiveness of ITI cancellation techniques during read operations, the technique of the present disclosure is effective even for recording formats (such as &#x201c;conventional&#x201d; recording of non-overlapping tracks) that do not limit rewriting.</p>
<p id="p-0020" num="0019">Such increased effectiveness of ITI cancellation may be achieved according to the current disclosure by carrying out ITI cancellation during writing rather than during reading. By detecting a head positioning error resulting in encroachment on, and overwriting of, an adjacent track almost as soon as it occurs, the technique according to the present disclosure can stop writing, and can read and store the portion of the current track that has encroached upon the adjacent track. The stored overwriting portion may be used to repair or recover the adjacent track by cancelling ITI caused by the overwriting data, and may then again be written to the current track, preferably after the head positioning error has been reduced or corrected.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 1</figref> shows two sectors <b>101</b>, <b>102</b> written on adjacent tracks <b>103</b>, <b>104</b>. Each write head <b>111</b>, <b>112</b> (which may be the same write head at different times) is slightly narrower than the track <b>103</b> or <b>104</b>. Because of a phenomenon known as &#x201c;side writing&#x201d;, each head <b>111</b>, <b>112</b> may nevertheless write substantially the full track width, and therefore is drawn in <figref idref="DRAWINGS">FIG. 1</figref> as though it were the substantially the same width as track <b>103</b>, <b>104</b>. Distribution <b>121</b> shows that for track <b>103</b>, head <b>111</b> writes substantially on-track. Similarly, distribution <b>122</b> shows that for track <b>104</b>, head <b>112</b>, which is currently subject to a positioning error, also writes substantially on-track but has a greater frequency of off-track write events. However, the presence of guard band <b>105</b> mitigates the effect of off-track events, because those events do not encroach on the adjacent track but only onto the guard band.</p>
<p id="p-0022" num="0021">In order to increase storage density, it is desirable to decrease the width of guard band <b>105</b>. However, such a decrease is likely to increase the occurrence of ITI, because an off-track event&#x2014;e.g., on track <b>104</b>&#x2014;would be more likely to encroach on an adjacent track (such as track <b>103</b>). Without a restriction on when a track can be rewritten as discussed above, ITI cancellation at read-time is not a reliable solution to such encroachments, as illustrated in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0023" num="0022">As seen in <figref idref="DRAWINGS">FIG. 2</figref>, an attempt to write to Track L (<b>201</b>) has resulted in an encroachment <b>211</b> by head <b>112</b> onto Track K (<b>202</b>), partially overwriting and corrupting data previously written to Track K (<b>202</b>). Subsequent to the occurrence of encroachment <b>211</b>, additional data <b>221</b> have been written to Track L (<b>201</b>) by head <b>112</b> in the correct position. Therefore, the data that caused encroachment <b>211</b> are no longer available to support ITI cancellation of encroachment <b>211</b> during reading of Track K (<b>202</b>). Therefore, performing ITI cancellation when Track K (<b>202</b>) is read will be less effective, or possibly ineffective.</p>
<p id="p-0024" num="0023">However, if ITI cancellation is performed during the writing process, substantially as the ITI occurs, there will not have been an opportunity for the encroaching data to have been overwritten, and therefore effective ITI cancellation should be possible, as diagrammed in <figref idref="DRAWINGS">FIG. 3</figref>, with reference to <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0025" num="0024">Process <b>300</b> (<figref idref="DRAWINGS">FIG. 3</figref>) begins at <b>301</b> where data are written to Track K (<b>401</b>). After, or contemporaneously with, each write operation, including write operation <b>301</b>, the position of write head <b>400</b> is monitored. For example, at test <b>302</b>, the write head servo mechanism may provide a position error signal (PES) that may be monitored. A threshold value for the PES may be determined below which no action need be taken. The presence of some guard band, similar to guard band <b>105</b>, and the width of that guard band, are some of the factors that affect the value of the threshold. Some degree of encroachment beyond the guard band also may be tolerable, depending on the criticality of the data and robustness of other available error correction techniques.</p>
<p id="p-0026" num="0025">In any event, in this pass, at test <b>302</b> there was no head position error in the writing of Track K (<b>401</b>) and so at test <b>303</b> it is determined whether or not there are any further writing operations queued up. If not, process <b>300</b> moves to a standby condition <b>304</b> to await further write commands. If at test <b>303</b> there are further write operations queued up (such as, in this case, the writing of Track L (<b>402</b>)), then process <b>300</b> loops back to step <b>301</b> to perform the next write operation (in this case, the writing of Track L (<b>402</b>)), followed again by test <b>302</b>.</p>
<p id="p-0027" num="0026">In this pass, test <b>302</b> will indicate a head position error beyond the tolerable threshold, and process <b>300</b> will, at <b>305</b>, begin ITI cancellation, during which the data <b>403</b> intended for Track L (<b>402</b>) that encroached on Track K (<b>401</b>) may be read and stored in a buffer <b>507</b> or <b>508</b> (<figref idref="DRAWINGS">FIG. 5</figref>). Operation <b>305</b> may be optional, because the device controller (not shown) will have just had those data in a buffer in order to write them at <b>301</b>. However, because the controller ordinarily would not have known in advance that it would need those data, it may not have retained them.</p>
<p id="p-0028" num="0027">Next, at <b>306</b>, the data <b>403</b> read from the encroachment <b>211</b> of Track L (<b>402</b>) onto Track K (<b>401</b>) are loaded into the read-data channel (RDC) <b>503</b> by the controller <b>501</b> (<figref idref="DRAWINGS">FIG. 5</figref>) for use in ITI cancellation. Again, this operation may be unnecessary as a separate operation, because the RDC will have just read the data to fulfill the read request at <b>305</b>. However, because the RDC ordinarily would not know that the read request is for ITI cancellation (as opposed, e.g., to a simple user data request), it would not necessarily have retained the data; if the data had been retained, operation <b>306</b> merges with operation <b>305</b>.</p>
<p id="p-0029" num="0028">Next, at <b>307</b>, ITI cancellation is performed on Track K (<b>401</b>) using the data <b>403</b> from the encroachment <b>211</b> as read at <b>305</b>/<b>306</b>. Any suitable ITI cancellation technique or other repair technique may be used. For example, the technique in above-incorporated application Ser. No. 12/882,802 is one example of a technique that may be used; however, other techniques exist and may be used instead.</p>
<p id="p-0030" num="0029">After Track K (<b>401</b>) has been recovered, process <b>300</b> returns at <b>308</b> to <b>301</b> to again write Track L (<b>402</b>), using the encroachment data already stored in the RDC during operations <b>305</b>/<b>306</b>. Presumably, on this pass the head position has been corrected and the data are properly written to Track L (<b>402</b>). However, process <b>300</b> continues as above, monitoring for errors, which may occur at this pass (in which case, ITI cancellation is performed again using the same data) or on a later pass (in which case, ITI cancellation is performed using different data).</p>
<p id="p-0031" num="0030">As discussed above, because position error detection and ITI cancellation or repair are performed during writing, before the encroaching data can be overwritten, ITI cancellation or repair according to embodiments of this disclosure can be used in ordinary recording where there is no restriction on overwriting of tracks. As also discussed above, because shingled recording schemes typically prevent overwriting of tracks until a band of tracks has been erased, ITI cancellation or repair according to embodiments of this disclosure is not necessary in shingled recording schemes. Nevertheless, ITI cancellation or repair according to embodiments of this disclosure may be used with shingled recording schemes; however, it would be unlikely to provide a measurable performance improvement.</p>
<p id="p-0032" num="0031">It will be apparent that ITI cancellation or repair according to embodiments of this disclosure can affect writing throughput, because some writing operations will have to be repeated, with additional time needed between passes for reading of encroaching data. However, because the availability of ITI cancellation or repair according to embodiments of this disclosure allows guard band <b>105</b> to be made smaller, some reduction of throughput is acceptable to gain increased recording density. One criterion for choosing minimum guard band size when using embodiments of this disclosure would be to choose that guard band size that causes, on writing, a retry rate (due to head position error) comparable to the retry rate that occurs on reading without using embodiments of this disclosure. There should be few retries on reading because errors are corrected on writing.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 5</figref> shows a schematic representation of apparatus <b>500</b> for carrying out such methods, which may be used in a storage device such as, e.g., a disk drive. The storage device may have a controller <b>501</b> (e.g., a hard disk controller, or HDC, where the device is a hard disk drive) which controls various functions and components of the device (not all of which are shown in <figref idref="DRAWINGS">FIG. 5</figref>). Controller <b>501</b> may send read commands <b>502</b> to read-data channel <b>503</b>, which may include at least one detector&#x2014;e.g., a SOVA detector (not shown)&#x2014;and at least one decoder&#x2014;e.g., a Viterbi decoder (not shown). Controller <b>501</b> may send write commands <b>504</b> to write-data channel <b>505</b> including a write head <b>506</b>.</p>
<p id="p-0034" num="0033">In accordance with embodiments of the present invention, controller <b>501</b> also may include memory, such as RAM <b>507</b>, for storing decoded data (e.g., NRZ data) from one or more previously-read tracks. If data from a track is needed to repair or recover an adjacent track, and/or needs to be rewritten after repair or recovery of an adjacent track, controller <b>501</b> can store the data in RAM <b>507</b> and retrieve it as necessary. Alternatively, controller <b>501</b> can store the data in separate DDR memory <b>508</b> for retrieval as necessary.</p>
<p id="p-0035" num="0034">A data storage system <b>600</b> (<figref idref="DRAWINGS">FIG. 6</figref>) may include a storage medium such as a hard disk <b>601</b> having a plurality of tracks <b>602</b> and controller apparatus <b>605</b>, which may, for example, be apparatus <b>500</b>, having head <b>506</b>.</p>
<p id="p-0036" num="0035">Thus it is seen that a data storage system, and a method of storing data, in which ITI cancellation or similar data repair can be performed before an encroaching track is overwritten, have been provided.</p>
<p id="p-0037" num="0036">It will be understood that the foregoing is only illustrative of the principles of the invention, and that the invention can be practiced by other than the described embodiments, which are presented for purposes of illustration and not of limitation, and the present invention is limited only by the claims which follow.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of writing data to a storage device, the method comprising:
<claim-text>writing current data to a first track of data;</claim-text>
<claim-text>monitoring write head position during the writing of the current data to the first track of data; and</claim-text>
<claim-text>on detection of encroachment of the write head position on a second track of previously written data:</claim-text>
<claim-text>stopping the writing of the current data to the first track of data;</claim-text>
<claim-text>after the stopping, using the current data to recover the previously written data on the second track; and</claim-text>
<claim-text>rewriting the current data to the first track after recovery of the previously written data on the second track.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein:
<claim-text>the writing of the current data comprises storing the current data in a buffer; and</claim-text>
<claim-text>the using of the current data comprises reading the current data from the buffer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein the rewriting comprises again reading the current data from the buffer.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the using of the current data comprises re-reading the current data from first track.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref> wherein:
<claim-text>the re-reading the current data from the first track comprises storing the current data in a buffer; and</claim-text>
<claim-text>the rewriting comprises reading the current data from the buffer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein:
<claim-text>the writing of the current data comprises storing the current data in a buffer; and</claim-text>
<claim-text>the rewriting comprises reading the current data from the buffer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the monitoring write head position comprises comparing a position error signal to a threshold value.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A storage controller comprising:
<claim-text>a device controller; and</claim-text>
<claim-text>a write channel including a write head; wherein:</claim-text>
<claim-text>the storage medium has a plurality of tracks of data thereon; and</claim-text>
<claim-text>when said device controller writes data to a current track of data on said storage device, said device controller:</claim-text>
<claim-text>monitors write head position, and</claim-text>
<claim-text>on detection of encroachment of the write head position on a second track of previously written data:</claim-text>
<claim-text>stops the writing of the current data to the first track of data,</claim-text>
<claim-text>after stopping the writing of the current data to the first track of data, uses the current data to recover the previously written data on the second track, and</claim-text>
<claim-text>rewrites the current data to the first track after recovery of the previously written data on the second track.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The storage controller of <claim-ref idref="CLM-00008">claim 8</claim-ref> further comprising a buffer; wherein:
<claim-text>the writing of the current data comprises storing the current data in the buffer; and</claim-text>
<claim-text>the device controller uses the current data by reading the current data from the buffer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The storage controller of <claim-ref idref="CLM-00009">claim 9</claim-ref> wherein the device controller rewrites the current data after again reading the current data from the buffer.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The storage controller of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the device controller uses the current data by re-reading the current data from first track.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The storage controller of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein the device controller:
<claim-text>stores the current data in a buffer; and</claim-text>
<claim-text>re-reads the current data from the first track by reading the current data from the buffer; and</claim-text>
<claim-text>rewrites the current data to the first track after re-reading the current data from the buffer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The storage controller of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the device controller:
<claim-text>stores the current data in a buffer; and</claim-text>
<claim-text>rewrites the current data to the first track after re-reading the current data from the buffer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A storage system comprising:
<claim-text>a storage medium having a plurality of tracks of data thereon; and</claim-text>
<claim-text>a storage controller comprising:</claim-text>
<claim-text>a device controller, and</claim-text>
<claim-text>a write channel including a write head; wherein:</claim-text>
<claim-text>the storage medium has a plurality of tracks of data thereon; and</claim-text>
<claim-text>when said device controller writes data to a current track of data on said storage device, said device controller:</claim-text>
<claim-text>monitors write head position, and</claim-text>
<claim-text>on detection of encroachment of the write head position on a second track of previously written data:</claim-text>
<claim-text>stops the writing of the current data to the first track of data,</claim-text>
<claim-text>after stopping the writing of the current data to the first track of data, uses the current data to recover the previously written data on the second track, and</claim-text>
<claim-text>rewrites the current data to the first track after recovery of the previously written data on the second track.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The storage system of <claim-ref idref="CLM-00014">claim 14</claim-ref> further comprising a buffer; wherein:
<claim-text>the writing of the current data comprises storing the current data in the buffer; and</claim-text>
<claim-text>the device controller uses the current data by reading the current data from the buffer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The storage system of <claim-ref idref="CLM-00015">claim 15</claim-ref> wherein the device controller rewrites the current data after again reading the current data from the buffer.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The storage system of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein the device controller uses the current data by re-reading the current data from first track.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The storage system of <claim-ref idref="CLM-00017">claim 17</claim-ref> wherein the device controller:
<claim-text>stores the current data in a buffer; and</claim-text>
<claim-text>re-reads the current data from the first track by reading the current data from the buffer; and</claim-text>
<claim-text>rewrites the current data to the first track after re-reading the current data from the buffer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The storage system of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein the device controller:
<claim-text>stores the current data in a buffer; and</claim-text>
<claim-text>rewrites the current data to the first track after re-reading the current data from the buffer. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
