<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625840-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625840</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13372646</doc-number>
<date>20120214</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<us-term-extension>87</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>9</main-group>
<subgroup>62</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>01</class>
<subclass>W</subclass>
<main-group>1</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>382100</main-classification>
<further-classification>382215</further-classification>
<further-classification>382218</further-classification>
<further-classification>702  3</further-classification>
</classification-national>
<invention-title id="d2e53">Method and apparatus for generating a forecast weather image</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5796611</doc-number>
<kind>A</kind>
<name>Ochiai et al.</name>
<date>19980800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5959567</doc-number>
<kind>A</kind>
<name>Wolfson et al.</name>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5974360</doc-number>
<kind>A</kind>
<name>Otsuka et al.</name>
<date>19991000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>702  3</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6128578</doc-number>
<kind>A</kind>
<name>Sakaino et al.</name>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>702  3</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6340946</doc-number>
<kind>B1</kind>
<name>Wolfson et al.</name>
<date>20020100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>342 26 R</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7062066</doc-number>
<kind>B2</kind>
<name>Wolfson et al.</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7542852</doc-number>
<kind>B1</kind>
<name>Rose et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2003/0156734</doc-number>
<kind>A1</kind>
<name>Wolfson et al.</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382100</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2004/0239550</doc-number>
<kind>A1</kind>
<name>Daly, Jr.</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>342 26 B</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2007/0005249</doc-number>
<kind>A1</kind>
<name>Dupree et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>702  3</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2009/0224965</doc-number>
<kind>A1</kind>
<name>Venkatachalam et al.</name>
<date>20090900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>342 26 R</main-classification></classification-national>
</us-citation>
<us-citation>
<nplcit num="00012">
<othercit>Costes et al. &#x201c;Weather Hazard Interpretation and Forecast by an Airborne Radar.&#x201d; International Radar Conference&#x2014;Surveillance for a Safer World, Oct. 12, 2009, pp. 1-6.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00013">
<othercit>Sakaino. &#x201c;A Unified Prediction Method for Heterogenous Weather Radar Patterns.&#x201d; Proceedings of the Sixth IEEE Workshop on Applications of Computer Vision, 2002, pp. 296-303.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00014">
<othercit>Shinozawa et al. &#x201c;A Weather Radar Image Prediction Method in Local Parallel Computation.&#x201d; IEEE International Conference on Neural Networks, IEEE World Congress on Computational Intelligence, vol. 7, Jun. 27, 1994, pp. 4210-4215.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00015">
<othercit>International Search Report and Written Opinion in counterpart international patent application No. PCT/US2012/024945, dated Sep. 26, 2012; 10 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00016">
<othercit>Yang, Christopher M. and Ravela, Sai, &#x201c;Deformation Invariant Image Matching by Spectrally Controlled Diffeomorphic Alignment&#x201d;, IEEE 12th International Conference on Computer Vision, 2009; 8 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00017">
<othercit>International Preliminary Report on Patentability in related International Patent No. PCT/US2012/024945, mailed on Aug. 29, 2013; 7 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>26</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>382100</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382215</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382217</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382218</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702  3</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification> 7317016</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61442892</doc-number>
<date>20110215</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120207343</doc-number>
<kind>A1</kind>
<date>20120816</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Ravela</last-name>
<first-name>Srinivas</first-name>
<address>
<city>Belmont</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Dupree</last-name>
<first-name>William J.</first-name>
<address>
<city>Westborough</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Langlois</last-name>
<first-name>Timothy R.</first-name>
<address>
<city>Tyngsboro</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Wolfson</last-name>
<first-name>Marilyn M.</first-name>
<address>
<city>Acton</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="005" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Yang</last-name>
<first-name>Christopher M.</first-name>
<address>
<city>Norwalk</city>
<state>CT</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Ravela</last-name>
<first-name>Srinivas</first-name>
<address>
<city>Belmont</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Dupree</last-name>
<first-name>William J.</first-name>
<address>
<city>Westborough</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Langlois</last-name>
<first-name>Timothy R.</first-name>
<address>
<city>Tyngsboro</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Wolfson</last-name>
<first-name>Marilyn M.</first-name>
<address>
<city>Acton</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="005" designation="us-only">
<addressbook>
<last-name>Yang</last-name>
<first-name>Christopher M.</first-name>
<address>
<city>Norwalk</city>
<state>CT</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Schmeiser, Olsen &#x26; Watts LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Massachusetts Institute of Technology</orgname>
<role>02</role>
<address>
<city>Cambridge</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Chang</last-name>
<first-name>Jon</first-name>
<department>2665</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Described are a method and an apparatus for generating a forecast weather image such as a forecast weather radar image. The method uses filters to approximate viscous alignment and to thereby determine displacement fields having meaningful structure. In various embodiments a power-law energy spectrum is utilized for deformations in the displacement field through the application of a set of Gabor filters. The Gabor filters are applied in a sequential manner to gradient error images and values of modes of motions corresponding to the Gabor filters are determined. The values are used to generate the displacement field which can then be applied to an existing weather image to generate a forecast weather image.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="213.70mm" wi="145.88mm" file="US08625840-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="214.29mm" wi="112.52mm" orientation="landscape" file="US08625840-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="225.98mm" wi="149.27mm" file="US08625840-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="103.72mm" wi="170.69mm" file="US08625840-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="225.98mm" wi="153.33mm" orientation="landscape" file="US08625840-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="230.04mm" wi="162.14mm" file="US08625840-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATION</heading>
<p id="p-0002" num="0001">This application claims the benefit of the earlier filing date of U.S. Provisional Patent Application Ser. No. 61/442,892, filed Feb. 15, 2011, titled &#x201c;Methods of Scale-Cascaded Field Alignment,&#x201d; the entirety of which is incorporated herein by reference.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?GOVINT description="Government Interest" end="lead"?>
<heading id="h-0002" level="1">GOVERNMENT RIGHTS IN THE INVENTION</heading>
<p id="p-0003" num="0002">This invention was made with government support under Grant No. FA8721-05-C-0002 awarded by the Federal Aviation Administration and under Grant No. NSF DBI 0640529 awarded by the National Science Foundation. The government has certain rights in this invention.</p>
<?GOVINT description="Government Interest" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0003" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0004" num="0003">The present invention relates generally to the processing of weather radar images for generating forecast weather images. More particularly, the invention relates to a method of generating a forecast weather image that uses a cascaded field alignment technique.</p>
<heading id="h-0004" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0005" num="0004">Short term and mid-range weather predictions (e.g., 30 minutes to several hours) of the location of organized storms and other weather features are extremely important to many sectors of the population. For example, aviation systems, traffic information systems, power companies and commuters realize important safety and economic benefits from accurate predictions of organized storms.</p>
<p id="p-0006" num="0005">Cross-correlation image processing has been applied to weather radar images to generate short term forecast images. For example, a method for predicting the motion of an organized storm is disclosed in U.S. Pat. No. 5,959,567, incorporated by reference herein. The method is based on applying an image filter matched to the structure of an organized storm to weather radar images at different times to thereby generate filtered weather radar images. An image tracker performs a cross-correlation of the filtered images to generate an array of track vectors that represents the movement of weather features, such as organized storms, in the time interval between the images. The track vectors are applied to a weather radar image to advect meteorological features and thereby generate a forecast image for a future time.</p>
<p id="p-0007" num="0006">The method based on cross-correlation image processing does not have constraints imposed on the track vectors. In some instances, highly discontinuous track vector fields are produced that are contrary to a practical meteorological environment and therefore do not yield accurate forecast images. For example, track vectors at adjacent grid points in the array can cross over each other or point in opposite directions.</p>
<heading id="h-0005" level="1">SUMMARY</heading>
<p id="p-0008" num="0007">In one aspect, the invention features a method of generating a forecast weather image. The method includes (a) receiving a template weather image and a target weather image for a geographical region, where the template and target weather images include values of a meteorological parameter according to location in the geographical region at a first time and a second time, respectively. The method also includes (b) determining a gradient error based on a difference of the template and target weather images; (c) applying a spectral filter to the determined gradient error to generate a value of a mode of motion corresponding to the spectral filter; and (d) deforming the template weather image according to the value of the mode of motion. Steps (b) through (d) are repeated. Each repetition of step (b) includes determining the gradient error based on a difference of a last deformed template weather image and the target weather image, each repetition of step (c) includes applying a spectral filter having a wavenumber greater than a wavenumber of a last applied spectral filter, and each repetition of step (d) includes deforming the last deformed template weather image. The method further includes determining a displacement field based on the values of the modes of motion.</p>
<p id="p-0009" num="0008">In another aspect the invention features a method of generating a forecast weather image that includes (a) receiving a template weather image and a target weather image for a geographical region, where the template and target weather images include values of a meteorological parameter according to location in the geographical region at a first time and a second time, respectively. The method also includes (b) determining a gradient error based on a difference of the template and target weather images; (c) applying a spectral filter to the determined gradient error to generate a value of a mode of motion corresponding to the spectral filter; and (d) deforming the template weather image according to the value of the mode of motion. The method further includes the step (e) of repeating steps of (b) through (d) where each repetition of step (b) comprises determining the gradient error based on a difference of a last deformed template weather image and the target weather image and wherein step (d) comprises deforming the last deformed template weather image. The method further includes the step (f) of repeating step (e), wherein each repetition of step (b) according to step (e) comprises determining the gradient error based on a difference of the last deformed weather image and the target weather image, each repetition of step (c) according to step (e) comprises applying a spectral filter having a wavenumber greater than a wavenumber for a last applied spectral filter, and each repetition of step (d) according to step (e) comprises deforming the last deformed template weather image.</p>
<p id="p-0010" num="0009">In still another aspect the invention features a computer program product for generating a forecast weather image. The computer program product includes a computer-readable storage medium having computer readable program code. The computer readable program code includes program code for executing various steps of the methods described above.</p>
<p id="p-0011" num="0010">In yet another aspect the invention features an apparatus for generating a weather forecast image. The apparatus includes an input module and a processor module. The input module is configured to acquire and store a template weather image and a target weather image for a geographical region. The template and target weather images include values of a meteorological parameter according to location in the geographical region at a first time and a second time, respectively. The processor module is in communication with the input module and includes a deformation module and an advection module. The deformation module is configured to determine a displacement field based on a plurality of values of modes of motion. Each value of a mode of motion is determined by an iterative application of a unique spectral filter to a gradient error image calculated from an iteratively deformed template weather image and the target weather image. The advection module is configured to determine an advection field based on the values of the modes of motion for each of the spectral filters and to apply the advection field to a weather image to thereby generate a forecast weather image.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0006" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0012" num="0011">The above and further advantages of this invention may be better understood by referring to the following description in conjunction with the accompanying drawings, in which like numerals indicate like structural elements and features in the various figures. For clarity, not every element may be labeled in every figure. The drawings are not necessarily to scale, emphasis instead being placed upon illustrating the principles of the invention.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of an embodiment of an apparatus for generating a forecast weather image according to the invention.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 2</figref> is an illustration of an example of a template weather radar image.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 3</figref> is an illustration of an example of a target weather radar image acquired at a time after the acquisition of the template weather radar image of <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 4</figref> is a three-dimensional graphical presentation of the sum of a plurality of Gabor filters that approximates a power law distribution.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 5</figref> is a cross-sectional view of the sum of the Gabor filters shown in <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart representation of an embodiment of a method for generating a forecast weather image according to the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0007" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0019" num="0018">The invention relates to a method and an apparatus for generating a forecast weather image. The method is based on the application of a cascaded field alignment technique to the processing of weather images such as weather radar images. By way of example, a weather radar image may include values for a vertically integrated liquid (VIL) field. Field alignment is achieved by displacing the coordinates of an image (i.e., a template image) to reduce or minimize a measure of dissimilarity between the image and another image (i.e., a target image). The displacement of a coordinate in the template image is specified by a vector for that coordinate. The array of displacement vectors describes a vector field that is referred to as a displacement field or a deformation field. In meteorological applications, the displacement field is sometimes referred to as an advection field. The displacement field is the solution to a process that attempts to reduce or minimize the error between the template and target images.</p>
<p id="p-0020" num="0019">Though described below as a method and an apparatus, it will be appreciated by one skilled in the art that aspects of the present invention may also be embodied as a computer program product. Accordingly, aspects of the present invention may take the form of an entirely hardware embodiment, an entirely software embodiment (including firmware, resident software, micro-code, etc.) or an embodiment combining software and hardware aspects that may all generally be referred to herein as a &#x201c;module&#x201d; or &#x201c;system.&#x201d; Furthermore, aspects of the present invention may take the form of a computer program product embodied in one or more computer readable medium(s) having computer readable program code embodied thereon.</p>
<p id="p-0021" num="0020">Any combination of one or more computer readable medium(s) may be utilized. The computer readable medium may be a computer readable signal medium or a computer readable storage medium. In the context of this document, a computer readable storage medium may be any tangible medium that can contain, or store a program for use by or in connection with an instruction execution system, apparatus, or device. A computer readable signal medium may include a propagated data signal with computer readable program code embodied therein. A computer readable signal medium may be any computer readable medium that is not a computer readable storage medium and that can communicate, propagate, or transport a program for use by or in connection with an instruction execution system, apparatus, or device. Program code embodied on a computer readable medium may be transmitted using any appropriate medium, including but not limited to wireless, wireline, optical fiber cable, RF, etc., or any suitable combination of the foregoing.</p>
<p id="p-0022" num="0021">Embodiments of the method of the invention are based on the application of filters to approximate viscous alignment and to thereby achieve displacement fields having meaningful structure. In various embodiments a power-law energy spectrum is utilized for addressing deformations in the displacement field through the application of a set of Gabor filters that approximates a power law. Thus the method generally avoids problems that would otherwise arise from discontinuities present in track vector fields generated by cross-correlation image processing techniques. In the various embodiments described below, the weather images are generally referred to as weather radar images; however, it will be recognized that the method can be performed with other types of weather images that include image data that may be generated or obtained without the use of radar. For example, other types of weather images include satellite irradiance images, infrared sounding images and hyperspectral images.</p>
<p id="p-0023" num="0022">Referring to the functional block diagram of <figref idref="DRAWINGS">FIG. 1</figref>, an apparatus <b>10</b> for generating a forecast weather image includes an input module <b>12</b> and a processor module <b>16</b>. The input module <b>12</b> receives weather radar image data from a weather radar image source <b>14</b>. The input module <b>12</b> provides the image data to the processor module <b>16</b> which generates a forecast weather radar image available at an output module <b>18</b>. The forecast weather radar image at the output module <b>18</b> may be provided as data that can be stored, transmitted or further processed. The output module <b>18</b> may include a display for graphical presentation of the forecast weather radar image to a user.</p>
<p id="p-0024" num="0023">The input module <b>12</b> includes an acquisition module <b>20</b> and a memory module <b>22</b> to receive and store weather radar images for processing by the processor module <b>16</b>. The acquisition module <b>20</b> initiates transfer of weather radar images from the image source <b>14</b> (e.g., remote computer system, satellite receiver and processor, Internet server or other device capable of transmitting weather radar images). The memory module <b>22</b> is any device capable of temporary or permanent storage of the weather radar image data.</p>
<p id="p-0025" num="0024">The processor module <b>16</b> includes an optional image filter module <b>24</b>, a deformation module <b>26</b> and an advection module <b>28</b>. The image filter module <b>24</b> receives multiple weather radar images from the memory module <b>22</b> and applies one or more image filters to the image data. Each image filter is matched to the structures of an organized storm and or other weather feature. The output of the image filter module <b>24</b> includes filtered weather radar images. The deformation module <b>26</b> determines a displacement field that corresponds to the difference between a template weather radar image obtained for an earlier time and a target weather radar image obtained for a later time. The advection module <b>28</b> applies the determined displacement field to one of the received weather radar images stored in the memory module <b>22</b> to generate the forecast weather radar image. In preferred embodiments, the determined displacement field is applied to a last acquired weather radar image to thereby generate the predicted weather radar image. Alternatively, the determined displacement field can be applied to other weather radar images such as an image derived by averaging a sequence of images. In some embodiments, the determined displacement field is applied to a weather radar image that has been spatially filtered to emphasize organized storms or other weather features, or to remove high spatial frequency features in the image.</p>
<p id="p-0026" num="0025">The received weather radar images include a value of a meteorological parameter for each grid point in the image. For example, the numerical values can be raw radar reflectivity values or can be values derived by processing the radar reflectivity values. For example, the values can be intensity values for vertical integrated liquid (VIL) as shown, for example, by the template weather radar image <b>30</b> of <figref idref="DRAWINGS">FIG. 2</figref> in which the VIL value for each grid point is graphically represented in one of four ranges of VIL values. <figref idref="DRAWINGS">FIG. 3</figref> shows an example of a target weather radar image <b>32</b> acquired at a time after the acquisition of the template weather radar image <b>30</b> of <figref idref="DRAWINGS">FIG. 2</figref>. The general motion of the weather features between the image times is from left to right and the shapes and intensities associated with the features change during the intervening time.</p>
<p id="p-0027" num="0026">According to various embodiments of the method for generating a forecast weather image, a displacement field that deforms the template weather radar image <b>30</b> into the target weather radar image <b>32</b> is determined. The displacement field is calculated based on application of a Green's function to a gradient error image where the Green's function includes smoothness and non-divergence as constraints. Advantageously, the Green's function can be expressed as a sum of Gabor filters that follows a power law and thus expresses the smoothness constraint. As described in embodiments below, each filter in a bank of Gabor filters is used in a sequential manner starting from a first Gabor filter at zero frequency and subsequently utilizing Gabor filters at increasingly greater frequencies. Each Gabor filter is applied in an iterative manner to determine a value for a mode of motion that approximately minimizes the gradient error. The template weather radar image <b>30</b> is then deformed using a displacement field corresponding to the mode of motion and scaled according to the value. Subsequent Gabor filters are applied in a similar manner to the deformed template image resulting from application of the last applied Gabor filter.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 4</figref> is a three-dimensional representation of the sum of a plurality of Gabor filters. <figref idref="DRAWINGS">FIG. 5</figref> is a cross-sectional view of the sum of the Gabor filters shown in <figref idref="DRAWINGS">FIG. 4</figref> where the dashed lines depict the different Gabor filters. The first Gabor filter is a Gaussian <b>40</b> having a center frequency of zero. Each higher order Gabor filter is a gaussian ring (e.g., <b>42</b>, <b>44</b>, <b>46</b>) having a unique radius or center frequency that corresponds to a higher wavenumber. Each Gabor filter has a maximum value at its center frequency according to an exponential envelope <b>48</b> which approximates a power law <b>50</b>.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart representation of one embodiment of a method <b>100</b> for generating a forecast weather image. Weather radar images are received (step <b>110</b>) from an image provider. In some embodiments, two or more weather radar images may be averaged, for example, by summing a number of consecutively acquired images. Each weather radar image may be pre-filtered using one or more image filters as described, for example, in U.S. Pat. No. 5,959,567. The method <b>100</b> continues by determining (step <b>120</b>) an error image based on a difference of an earlier (template) weather radar image and a later (target) weather radar image. Subsequently, the error image is transformed (step <b>130</b>) into a gradient error image by multiplying the value at each grid point in the error image by the local spatial gradient present in the template weather radar image. Thus the error image is effectively projected into gradient space.</p>
<p id="p-0030" num="0029">To solve for the displacement vector field that describes the deformation of the template weather radar image into the target radar weather radar image, the gradient error image is filtered (step <b>140</b>) using a first Gabor filter having a center frequency of zero to obtain a value for a first mode of motion. For a center frequency of zero (wavenumber zero), the first mode of motion corresponds to a global translation of the template weather radar image. The template weather radar image is then deformed (step <b>150</b>) for the first mode according to the value and a new error image is determined (step <b>160</b>) based on a difference of the deformed image and the target image. If the error image does not indicate that convergence is achieved as determined at step <b>170</b>, the method <b>100</b> returns to step <b>130</b> and continues through step <b>170</b> (where deformation is based on deforming the last deformed image) until convergence is achieved and a final value is determined for the first mode of motion. The final value of the first mode of motion represents the global translation between the template weather radar image and the target weather radar image.</p>
<p id="p-0031" num="0030">Subsequently, a second Gabor filter having a wavenumber of 0.5 is selected (step <b>190</b>) and applied to the gradient error image that is calculated based on the template weather radar image deformed according to the first mode of motion and the target weather radar image. Iterative application of the second Gabor filter and deformation is performed until convergence occurs and a final value for the second mode of motion is determined (steps <b>130</b> through <b>170</b>). Additional Gabor filters, each having an increased wavenumber relative to the last applied Gabor filter, are applied and values for higher modes of motion are determined in a similar manner until it is determined (step <b>180</b>) that all the Gabor filters have been applied.</p>
<p id="p-0032" num="0031">The method <b>100</b> continues at step <b>200</b> by determining the final displacement field (i.e., advection field) from the calculated values of the modes of motion. In effect, the displacement fields determined for each mode of motion are summed to generate the final displacement field. The advection field is then applied (step <b>210</b>) to one of the weather radar images to generate the forecast weather radar image. In preferred embodiments, the advection field is applied to the template weather radar image (e.g., the latest weather radar image) to generate the forecast weather radar image. In one embodiment, the template weather radar image is spatially filtered prior to application of the advection field.</p>
<p id="p-0033" num="0032">The number of Gabor filters employed in the method <b>100</b> can be selected according to a particular application. In various embodiments, the Gabor filters have wavenumbers of 0, 0.5, 1, 2, 4, 8 and so on such that each filter has a wavenumber that is twice the wavenumber of the preceding filter. In various embodiments, the number of Gabor filters is between 8 and 12, inclusive, although this is not a requirement. For example, the particular choice of the number of filters can be limited according to the image size expressed in pixels. In another example, the number of filters used is selected based on the desired modes of motions to be extracted from the images (e.g., rotation and local shear).</p>
<p id="p-0034" num="0033">This scale-cascaded alignment technique for deforming the template weather radar image to the target weather radar image based on application of the entirety of the Gabor filters can rapidly converge on a solution for the displacement field. Each Gabor filter application captures a different scale of motion and leaves increasingly negligible gradient error images for subsequent higher wavenumber Gabor filters to resolve. Moreover, the lower frequency Gabor filters can accurately capture advection associated with large scale temporally coherent meteorological events that persist over longer durations while less temporally coherent local meteorological events correspond to the more attenuated higher frequency Gabor filters.</p>
<p id="p-0035" num="0034">While the invention has been shown and described with reference to specific embodiments, it should be understood by those skilled in the art that various changes in form and detail may be made therein without departing from the spirit and scope of the invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of generating a forecast weather image, the method comprising:
<claim-text>(a) receiving a template weather image and a target weather image for a geographical region, the template and target weather images comprising values of a meteorological parameter according to location in the geographical region at a first time and a second time, respectively;</claim-text>
<claim-text>(b) determining a gradient error based on a difference of the template and target weather images;</claim-text>
<claim-text>(c) applying a spectral filter to the determined gradient error to generate a value of a mode of motion corresponding to the spectral filter;</claim-text>
<claim-text>(d) deforming the template weather image according to the value of the mode of motion;</claim-text>
<claim-text>(e) repeating steps (b) through (d), wherein each repetition of step (b) comprises determining the gradient error based on a difference of a last deformed template weather image and the target weather image, each repetition of step (c) comprises applying a spectral filter having a wavenumber greater than a wavenumber of a last applied spectral filter, and each repetition of step (d) comprises deforming the last deformed template weather image; and</claim-text>
<claim-text>(f) determining a displacement field based on the values of the modes of motion.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein step (c) comprises iteratively applying the spectral filter to a last determined gradient error to determine the value of the mode of motion corresponding to the spectral filter.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising applying the displacement field to a weather image to generate a forecast weather image.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref> wherein the displacement field is applied to the target weather image.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the weather images are weather radar images.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein the weather radar images are vertically-integrated liquid images.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the spectral filters are Gabor filters.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the spectral filter that is first applied has a wavenumber of zero and describes a global translation mode of motion.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein a sum of the spectral filters approximates a power law.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein at least one of the template weather radar image and the target weather radar image comprises an average of a plurality of weather radar images.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A method of generating a forecast weather image, the method comprising:
<claim-text>(a) receiving a template weather image and a target weather image for a geographical region, the template and target weather images comprising values of a meteorological parameter according to location in the geographical region at a first time and a second time, respectively;</claim-text>
<claim-text>(b) determining a gradient error based on a difference of the template and target weather images;</claim-text>
<claim-text>(c) applying a spectral filter to the determined gradient error to generate a value of a mode of motion corresponding to the spectral filter;</claim-text>
<claim-text>(d) deforming the template weather image according to the value of the mode of motion;</claim-text>
<claim-text>(e) repeating the steps of (b) through (d), wherein each repetition of step (b) comprises determining the gradient error based on a difference of a last deformed template weather image and the target weather image and wherein step (d) comprises deforming the last deformed template weather image; and</claim-text>
<claim-text>(f) repeating step (e), wherein each repetition of step (b) according to step (e) comprises determining the gradient error based on a difference of the last deformed weather image and the target weather image, each repetition of step (c) according to step (e) comprises applying a spectral filter having a wavenumber greater than a wavenumber for a last applied spectral filter, and each repetition of step (d) according to step (e) comprises deforming the last deformed template weather image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref> further comprising determining a displacement field based on the values of the modes of motion.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref> further comprising applying the displacement field to a weather image to generate a forecast weather image.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein the displacement field is applied to the target weather image.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein the spectral filters are Gabor filters.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein a sum of the spectral filters approximates a power law.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. An apparatus for generating a forecast weather image, comprising:
<claim-text>an input module configured to acquire and store a template weather image and a target weather image for a geographical region, the template and target weather images comprising values of a meteorological parameter according to location in the geographical region at a first time and a second time, respectively; and</claim-text>
<claim-text>a processor module in communication with the input module, the processor module comprising:
<claim-text>a deformation module configured to determine a displacement field based on a plurality of values of modes of motion, each value of a mode of motion being determined by an iterative application of a spectral filter to a gradient error image calculated from an iteratively deformed template weather image and the target weather image, the spectral filter used in the iterative application with each mode of motion being different from the spectral filters used for the iterative applications with the other modes of motion; and</claim-text>
<claim-text>an advection module configured to determine an advection field based on the values of the modes of motion for each of the spectral filters and to apply the advection field to a weather image to thereby generate a forecast weather image.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The apparatus of <claim-ref idref="CLM-00017">claim 17</claim-ref> wherein the spectral filters are Gabor filters.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The apparatus of <claim-ref idref="CLM-00017">claim 17</claim-ref> wherein the advection module applies the advection field to the target weather image.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The apparatus of <claim-ref idref="CLM-00017">claim 17</claim-ref> wherein the template weather image and target weather image are weather radar images.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The apparatus of <claim-ref idref="CLM-00020">claim 20</claim-ref> wherein the weather radar images are vertically-integrated liquid images.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The apparatus of <claim-ref idref="CLM-00017">claim 17</claim-ref> wherein the processor module further comprises an image filter module configured to apply one or more image filters to the template weather image and the target weather image, each of the image filters predefined to match a weather image feature.</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. A computer program product for generating a forecast weather image, the computer program product comprising:
<claim-text>a computer-readable storage medium having computer readable program code embodied therewith, the computer readable program code comprising:
<claim-text>(a) computer readable program code configured to receive a template weather image and a target weather image for a geographical region, the template and target weather images comprising values of a meteorological parameter according to location in the geographical region at a first time and a second time, respectively;</claim-text>
<claim-text>(b) computer readable program code configured to determine a gradient error based on a difference of the template and target weather images;</claim-text>
<claim-text>(c) computer readable program code configured to apply a spectral filter to the determined gradient error to generate a value of a mode of motion corresponding to the spectral filter;</claim-text>
<claim-text>(d) computer readable program code configured to deform the template weather image according to the value of the mode of motion;</claim-text>
<claim-text>(e) computer readable program code configured to cause a repeat execution of the (b) computer readable program code through the (d) computer readable program code, wherein each repeated execution of the (b) computer readable program code comprises determining the gradient error based on a difference of a last deformed template weather image and the target weather image, each repeated execution of the (c) computer readable program code comprises applying a spectral filter having a wavenumber greater than a wavenumber of a last applied spectral filter, and each repeated execution of the (d) computer readable program code comprises deforming the last deformed template weather image; and</claim-text>
<claim-text>(f) computer readable program code configured to determine a displacement field based on the values of the modes of motion.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The computer program product of <claim-ref idref="CLM-00023">claim 23</claim-ref> wherein the (c) computer readable program code is configured to iteratively apply the spectral filter to a last determined gradient error to determine the value of the mode of motion corresponding to the spectral filter.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The computer program product of <claim-ref idref="CLM-00023">claim 23</claim-ref> wherein the spectral filters are Gabor filters.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The computer program product of <claim-ref idref="CLM-00023">claim 23</claim-ref> wherein the computer readable storage medium further comprises computer readable program code configured to apply the displacement field to a weather image to generate a forecast weather image. </claim-text>
</claim>
</claims>
</us-patent-grant>
