<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625787-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625787</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12687515</doc-number>
<date>20100114</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>887</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>380 45</main-classification>
<further-classification>380262</further-classification>
<further-classification>380279</further-classification>
<further-classification>380284</further-classification>
<further-classification>713171</further-classification>
<further-classification>726 10</further-classification>
</classification-national>
<invention-title id="d2e53">Hierarchical key management for secure communications in multimedia communication system</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6606706</doc-number>
<kind>B1</kind>
<name>Li</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2005/0125684</doc-number>
<kind>A1</kind>
<name>Schmidt</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713200</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2008/0095070</doc-number>
<kind>A1</kind>
<name>Chan et al.</name>
<date>20080400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370254</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2010/0268937</doc-number>
<kind>A1</kind>
<name>Blom et al.</name>
<date>20101000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713153</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>WO</country>
<doc-number>03/079607</doc-number>
<kind>A1</kind>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>WO</country>
<doc-number>WO2009070075</doc-number>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>WO</country>
<doc-number>PCT/US2011/020686</doc-number>
<date>20110300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00008">
<othercit>W. Granzer et al., &#x201c;Key Set Management in Networked Building Automation Systems Using Multiple Key Servers,&#x201d; IEEE International Workshop on Factory Communication Systems (WFCS). May 2008, pp. 205-214.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00009">
<othercit>3GPP (3rd Generation Partnership Project) Technical Specification TS 33.328, V9.0.0, Dec. 2009, 41 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00010">
<othercit>3GPP (3rd Generation Partnership Project) Technical Specification TS 33.828, V1.6.1, Dec. 2009, 82 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00011">
<othercit>J. Mattsson et al., &#x201c;MIKEY-Ticket: An Additional Mode of Key Distribution in Multimedia Internet Keying (MIKEY),&#x201d; Network Working Group, RFC 3830, Oct. 19, 2009, pp. 1-48.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00012">
<othercit>J. Arkko, &#x201c;MIKEY: Multimedia Internet KEYing,&#x201d; Network Working Group, RFC 3830, Aug. 2004, pp. 1-66.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>16</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>380262</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380278</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380279</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380283</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380284</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380 44</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380 45</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713171</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 10</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>5</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110170694</doc-number>
<kind>A1</kind>
<date>20110714</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Brusilovsky</last-name>
<first-name>Alec</first-name>
<address>
<city>Du Page</city>
<state>IL</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Cakulev</last-name>
<first-name>Violeta</first-name>
<address>
<city>Milburn</city>
<state>NJ</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Brusilovsky</last-name>
<first-name>Alec</first-name>
<address>
<city>Du Page</city>
<state>IL</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Cakulev</last-name>
<first-name>Violeta</first-name>
<address>
<city>Milburn</city>
<state>NJ</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Ryan, Mason &#x26; Lewis, LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Alcatel Lucent</orgname>
<role>03</role>
<address>
<city>Paris</city>
<country>FR</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Shiferaw</last-name>
<first-name>Eleni</first-name>
<department>2437</department>
</primary-examiner>
<assistant-examiner>
<last-name>Callahan</last-name>
<first-name>Paul</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method performed in a third computing device comprises: receiving a request from one of a first computing device and a second computing device; and in response to the request, facilitating establishment of a security association between the first computing device and the second computing device such that the first computing device and the second computing device can then facilitate establishment of a security association between first user equipment and second user equipment. The first computing device, the second computing device and the third computing device comprise at least a part of a key management hierarchy wherein the first computing device and the second computing device are on a lower level of the hierarchy and the third computing device is on a higher level of the hierarchy. The first and second computing devices are configured to perform a key management function for respective first and second user equipment.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="143.09mm" wi="249.00mm" file="US08625787-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="214.04mm" wi="101.85mm" orientation="landscape" file="US08625787-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="214.97mm" wi="106.93mm" orientation="landscape" file="US08625787-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="249.34mm" wi="150.79mm" orientation="landscape" file="US08625787-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="246.80mm" wi="158.67mm" orientation="landscape" file="US08625787-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="211.41mm" wi="152.40mm" orientation="landscape" file="US08625787-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present invention relates generally to communication security and, more particularly, to a key management protocol for use in securing communications in environments such as a media plane of a multimedia communication system.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">Existing multimedia applications offered in conventional multimedia communication systems do not adequately support security in the media plane. Existing security proposals in a conventional multimedia communication system such as the Internet Protocol (IP) Multimedia Subsystem (IMS) are based on token-based symmetric key methodologies; managed using a key management service that potentially creates and distributes keys. 3GPP (3<sup>rd </sup>Generation Partnership Project) Technical Specifications (TS) 33.328 and 33.828, the disclosures of which are incorporated by reference herein, discuss existing proposals for IMS media plane encryption.</p>
<p id="p-0004" num="0003">Multimedia Internet Keying (MIKEY), as disclosed in RFC 3830, the disclosure of which is incorporated by reference herein, is an example of a media security protocol that is based on pre-shared keys.</p>
<p id="p-0005" num="0004">An attempted improvement of the MIKEY protocol is referred to as MIKEY-TICKET, and is disclosed in International Patent Publication No. WO2009/070075, the disclosure of which is incorporated by reference herein. MIKEY-TICKET is part of Rel-9 IMS Media Plane Security as disclosed in TS 33.328 and TS 33.828. The MIKEY-TICKET approach uses one or more key management services (KMSs) that issue a voucher (ticket) and key generating information to a user device for use in establishing a session key with another user device. The session key is then used by the user devices to communicate with one another. When, two KMSs are employed (one KMS for each user device), the two KMSs must not only establish a security association with the user devices they are servicing, but the two KMSs must also have a pre-existing one-to-one security association between them in order for the MIKEY-TICKET protocol to work. This may not always be preferable or possible, particularly when each KMS belongs to a different administrative domain.</p>
<p id="p-0006" num="0005">Thus, a need exists for an improved key management solution for use in securing communications in environments such as a media plane of a multimedia communication system.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0007" num="0006">Principles of the invention provide one or more hierarchical key management methodologies for use in securing communications in environments such as, by way of example, a media plane of a multimedia communication system.</p>
<p id="p-0008" num="0007">By way of one exemplary aspect of the invention, in a communication system wherein a first computing device is configured to perform a key management function for first user equipment and a second computing device is configured to perform a key management function for second user equipment, wherein the first user equipment seeks to initiate communication with the second user equipment, wherein the first computing device and the second computing device do not have a pre-existing security association there between, and wherein a third computing device is configured to perform a key management function and has a pre-existing security association with the first computing device and a pre-existing security association with the second computing device, the third computing device performing a method comprising steps of: receiving a request from one of the first computing device and the second computing device; and in response to the request, facilitating establishment of a security association between the first computing device and the second computing device such that the first computing device and the second computing device can then facilitate establishment of a security association between the first user equipment and the second user equipment.</p>
<p id="p-0009" num="0008">The first computing device, the second computing device and the third computing device comprise at least a part of a key management hierarchy wherein the first computing device and the second computing device are on a lower level of the hierarchy and the third computing device is on a higher level of the hierarchy.</p>
<p id="p-0010" num="0009">In one exemplary embodiment, the facilitating step performed by the third computing device further comprises sending a data item and cryptographic information to the first computing device.</p>
<p id="p-0011" num="0010">The first computing device then sends the data item to the second computing device. The first computing device also computes a key based on the cryptographic information received from the third computing device, and use the computed key to secure the transfer of one or more messages to the second computing device. Alternatively, when the cryptographic information received by the first computing device from the third computing device is a pre-computed key, the first computing device uses the pre-computed key to secure the transfer of one or more messages to the second computing device.</p>
<p id="p-0012" num="0011">The second computing device then sends the data item to the third computing system.</p>
<p id="p-0013" num="0012">The third computing system then sends the same cryptographic information to the second computing system that was sent to the first computing system, in response to receiving the data item from the second computing system.</p>
<p id="p-0014" num="0013">In one example, the second computing device may compute the key based on the cryptographic information received from the third computing device, and use the computed key to secure the transfer of one or more messages to the first computing device. In another example, when the cryptographic information received by the second computing device from the third computing device is the pre-computed key, the second computing device uses the pre-computed key to secure the transfer of one or more messages to the first computing device.</p>
<p id="p-0015" num="0014">In one embodiment, the first computing device, the second computing device and the third computing device are each key management services, and the data item comprises a ticket or a voucher.</p>
<p id="p-0016" num="0015">Furthermore, in accordance with the exemplary methodology, a session key and a security association is established between the first user equipment and the second user equipment once the security association is established between the first computing device and the second computing device.</p>
<p id="p-0017" num="0016">Also, the first computing device may be managed by a different administrative domain than the administrative domain that manages the second computing device.</p>
<p id="p-0018" num="0017">It is to be appreciated that while principles of the invention are particularly suitable to an Internet Protocol Multimedia Subsystem environment, the invention is not intended to be so limited. That is, principles of the invention are generally applicable to any suitable communication system in which it is desirable to provide key management features.</p>
<p id="p-0019" num="0018">These and other objects, features and advantages of the present invention will become apparent from the following detailed description of illustrative embodiments thereof, which is to be read in connection with the accompanying drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1A</figref> illustrates a key management architecture and methodology using a single key management service;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 1B</figref> illustrates a key management architecture and methodology using two key management services;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 2A</figref> illustrates a hierarchical key management architecture and methodology according to an embodiment of the invention;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 2B</figref> illustrates hierarchical key management messaging protocol according to an embodiment of the invention; and</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 3</figref> illustrates a generalized hardware architecture of a part of a communication system and computing devices suitable for implementing one or more of the methodologies and protocols according to embodiments of the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF PREFERRED EMBODIMENTS</heading>
<p id="p-0025" num="0024">The phrase &#x201c;multimedia communication system&#x201d; as used herein is generally defined as any communication system capable of transporting two or more types of media involving, but not limited to, text-based data, graphics-based data, voice-based data and video-based data.</p>
<p id="p-0026" num="0025">The phrase &#x201c;media plane&#x201d; as used herein is generally defined as the functional portion of the multimedia communication system in accordance with which the one or more types of media are exchanged between two or more parties in a call session. This is in contrast with a &#x201c;control plane&#x201d; which is the functional portion of the multimedia communication system in accordance with which call negotiation/scheduling is performed in order to establish the call session. Examples of media plane applications with which the inventive techniques can be used include, but are not limited to, Voice-over-IP (VoIP), Instant Messaging (IM), Video/Audio IM, and Video Share. It is understood that the media plane contains application layer traffic.</p>
<p id="p-0027" num="0026">The term &#x201c;key&#x201d; as used herein is generally defined as an input to a cryptographic protocol or methodology, for purposes such as, but not limited to, entity authentication, privacy, message integrity, etc.</p>
<p id="p-0028" num="0027">The phrase &#x201c;security association&#x201d; is generally defined as a relationship between two or more entities that is based on some cryptographic or secure data (e.g., one or more keys) generated for the purpose of authentication of one or more of the entities in the relationship, and/or for encryption, decryption, certification, etc.</p>
<p id="p-0029" num="0028">The phrase &#x201c;administrative domain&#x201d; is generally defined as a collection of network elements such as hosts and routers, and the interconnecting network(s), managed by a given administrative authority.</p>
<p id="p-0030" num="0029">The phrase &#x201c;user device&#x201d; is generally defined as a communication device or client device that may be employed by a party (user) to participate in the methodologies described herein and may include, but are not limited to, cellular phones, smart phones, desktop phones, personal digital assistants, laptop computers, personal computers, etc.</p>
<p id="p-0031" num="0030">The phrase &#x201c;key management service&#x201d; is generally defined as a logical element in a cryptographic system that provides functionality related to generation, exchange, storage, safeguarding, use, vetting, and replacement of cryptographic keys. For example, a key management service can be implemented via one or more servers.</p>
<p id="p-0032" num="0031">The term &#x201c;ticket&#x201d; or &#x201c;voucher&#x201d; is generally defined as a piece of information that is integrity-protected by the issuing KMS and may include one or more of metadata, identities of participating parties, time of creation, time of validity, sequence number, type of permitted communication usage, etc. The ticket may also include one or more keys or other information that needs to be privacy-protected.</p>
<p id="p-0033" num="0032">As mentioned above, the MIKEY-TICKET method for key distribution for IMS media security requires one or more key management services (KMSs) to have security associations with one or more user devices, i.e., user equipment (UE), in the communication network. In the case when UEs, which are establishing keys, belong to different administrative domains and different KMSs, these KMSs are required to have pre-existing one-to-one security associations between each other.</p>
<p id="p-0034" num="0033">In some implementations, such requirements might not be possible to fulfill. Examples for such network architectures are two or more KMSs belonging to two or more administrative domains and either not having pre-existing security associations between each other, or being outright prohibited from having such security associations. Thus, existing solutions require pre-existing one-to-one security associations between KMSs, making resulting key management solutions rather inflexible and resource-hungry. Also, the addition of any extra KMS (i.e., for roaming) will require the addition of a pre-existing security association with any existing KMSs.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 1A</figref> depicts a key management architecture and methodology using a single key management service (KMS). In particular, this is one form of the MIKEY-TICKET approach. As shown in methodology <b>100</b>, a user device <b>102</b>-I (initiator) seeks to initiate a communication session with user device <b>102</b>-R (responder).</p>
<p id="p-0036" num="0035">In accordance with the MIKEY-TICKET approach, KMS <b>104</b> is assumed to have capability to establish a shared key (secure communication) with user device <b>102</b>-I and, in response to a key request (step <b>1</b>), provides the user with key generating information <b>105</b> and a ticket <b>106</b> (step <b>2</b>) in response to the key request. User device <b>102</b>-I then transmits the ticket <b>106</b> to user device <b>102</b>-R in a request for communication (step <b>3</b>).</p>
<p id="p-0037" num="0036">The user device <b>102</b>-R, which has pre-established secure communication with KMS <b>104</b> (the same KMS that services user device <b>1024</b>), provides the ticket <b>106</b> to KMS <b>104</b> (step <b>4</b>). In response thereto, KMS <b>104</b> returns (step <b>5</b>) key generation information <b>105</b> to user device <b>102</b>-R (the same key generating information that KMS <b>104</b> sent to user device <b>102</b>-I in step <b>2</b>). Based on key generation information <b>105</b>, both user device <b>102</b>-I and user device <b>102</b>-R generate a common session key for use in multimedia communication. User device <b>102</b>-R sends a response (step <b>6</b>) to finalize the session key establishment process. Note that the KMS could send the user devices a common session key, already computed, as opposed to key generating information.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 1B</figref> depicts a key management architecture and methodology using multiple key management services, e.g., two, in this scenario. This is another form of the MIKEY-TICKET approach. As shown in methodology <b>110</b>, user device <b>102</b>-I again seeks to initiate a communication session with user device <b>102</b>-R. Steps <b>1</b> through <b>6</b> in <figref idref="DRAWINGS">FIG. 1B</figref> are essentially the same as described above for <figref idref="DRAWINGS">FIG. 1A</figref>. The only difference here is that there are now two KMSs, i.e., KMS <b>104</b>-I that services user device <b>102</b>-I and KMS <b>104</b>-R that services user device <b>102</b>-R. Additional step <b>2</b><i>a </i>as shown in <figref idref="DRAWINGS">FIG. 1B</figref> represents the requirement that, in accordance with the existing MIKEY-TICKET approach, a pre-existing one-to-one security association must exist between the two KMSs for the protocol to work. That is, KMS-R would not be able to resolve the request from <b>102</b>-R in steps <b>4</b> and <b>5</b>, if such a one-to-one security association did not exist with KMS <b>104</b>-I prior to the initiator initiating the protocol in step <b>1</b>. However, as mentioned above, this may not be preferable or in fact, may be prohibited, particularly when KMS <b>104</b>-I belongs to a different administrative domain than that of KMS <b>104</b>-R.</p>
<p id="p-0039" num="0038">To address these and other drawbacks associated with the existing approaches, illustrative principles of the invention provide a hierarchical key management solution which comprises implementing a hierarchical security association and trust model to simplify provisioning of security associations for KMSs, as well as to provide operators' flexibility in deployment of KMSs with the MIKEY-TICKET key distribution method or some other key distribution method. As such, two or more lower hierarchy KMSs belonging to two or more different administrative domains can have pre-existing security associations with an upper hierarchy KMS. Thus, the inventive solution allows the MIKEY-TICKET method or the like to be improved by introducing multiple levels of KMS hierarchy, allowing more flexible deployment of key distribution features in distinct networks (and thus administrative domains) of a multimedia communication system, i.e., a network operators' part of the communication system and an enterprises' part of the communication system.</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 2A</figref> illustrates a hierarchical key management architecture and methodology according to an embodiment of the invention. It is to be understood that user devices <b>202</b>-I (initiator) and <b>202</b>-R (responder) in <figref idref="DRAWINGS">FIG. 2A</figref> are the same or similar to users device <b>102</b>-I and user device <b>102</b>-R, respectively, in <figref idref="DRAWINGS">FIGS. 1A and 1B</figref>, and function in the same or similar manners except as otherwise noted. Likewise, KMS <b>204</b>-I and KMS <b>204</b>-R are the same or similar as KMS <b>104</b>-I and KMS <b>104</b>-R, respectively, with regard to the user devices, and function in the same or similar manners except as otherwise noted. An important difference, however, between KMS <b>204</b>-I/KMS <b>204</b>-R and KMS <b>104</b>-I/KMS <b>104</b>-R is that, at the start of the initiation request (step <b>1</b>) in <figref idref="DRAWINGS">FIG. 2A</figref>, KMS <b>204</b>-I and KMS <b>204</b>-R do not have an existing security association (trust) between them. However, in accordance with an embodiment of the invention, there is a hierarchical security association between KMS <b>204</b>-I and KMS <b>204</b>-<b>0</b>, as well as between KMS <b>204</b>-R and KMS <b>204</b>-<b>0</b>. That is, in accordance with an embodiment of the invention, KMSs at level B in the hierarchy are not required to have pre-existing one-to-one security associations with each other since each individual KMS at level B (lower hierarchical level) has or establishes a security association with a KMS at level A (a higher or upper hierarchical level). It is assumed, however, that the initiator UE (<b>202</b>-I) has or establishes a security association with its KMS I (<b>204</b>-I), and responder UE (<b>202</b>-R) has or establishes a similar security association with KMS R (<b>204</b>-R).</p>
<p id="p-0041" num="0040">It is to be understood that while <figref idref="DRAWINGS">FIG. 2A</figref> shows a two-level hierarchy with two KMSs at a lower level and one KMS at an upper level, principles of the invention contemplate hierarchies having more than two levels with more than the given number of KMSs shown in <figref idref="DRAWINGS">FIG. 2A</figref> at each level. Thus, adding a KMS at a given level does not require that the added KMS establish security associations with each of the other KMS at that same level, but rather only requires that the added KMS establish a security association with an upper hierarchy KMS.</p>
<p id="p-0042" num="0041">Accordingly, in the embodiment illustrated in <figref idref="DRAWINGS">FIG. 2A</figref>, the following steps occur. Note that below: user device <b>202</b>-I is referred to as &#x201c;Initiator UE&#x201d; or &#x201c;Initiator&#x201d; or &#x201c;I;&#x201d; user device <b>202</b>-R is referred to as &#x201c;Responder UE&#x201d; or &#x201c;Responder&#x201d; or &#x201c;R;&#x201d; KMS <b>204</b>-I is referred to as &#x201c;KMS I;&#x201d; KMS <b>204</b>-R is referred to as &#x201c;KMS R;&#x201d; and KMS <b>204</b>-<b>0</b> is referred to as &#x201c;KMS<b>0</b>.&#x201d; Also note that, unless otherwise specified or modified by the enhancements disclosed herein, standard MIKEY_TICKET techniques may be applied in the message transfers.</p>
<p id="p-0043" num="0042">Step <b>1</b>. Initiator UE sends a REQUEST_INIT message containing responder's identity to the KMS I.</p>
<p id="p-0044" num="0043">Step <b>2</b>. KMS I replies to Initiator with a REQUEST_RESP message containing a session key <b>205</b> (or, as mentioned above; key generating information for generating the session key) and a ticket <b>206</b>.</p>
<p id="p-0045" num="0044">Step <b>3</b>. Initiator sends a TRANSFER_INIT message containing the ticket <b>206</b> received from KMS I to the Responder.</p>
<p id="p-0046" num="0045">Step <b>4</b>. Responder forwards the ticket <b>206</b> received from Initiator in a RESOLVE_INIT message to the KMS R.</p>
<p id="p-0047" num="0046">Step <b>5</b>. KMS I sends a REQUEST_INIT_KMS message to KMS<b>0</b>.</p>
<p id="p-0048" num="0047">Step <b>6</b>. KMS<b>0</b> responds to KMS I with an inter-KMS ticket <b>208</b> and inter-KMS key <b>209</b> (or key generating information for generating the inter-KMS key) in a REQUEST_RESP_KMS message.</p>
<p id="p-0049" num="0048">Step <b>7</b>. KMS I transfers the inter-KMS ticket <b>208</b> received from KMS<b>0</b> to KMS R in a TRANSFER_INIT_KMS message. In this message, KMS I also transfers the session key <b>205</b> (or key generating information) to KMS R.</p>
<p id="p-0050" num="0049">Step <b>8</b>. KMS R forwards inter-KMS ticket <b>208</b> received from KMS I to KMS<b>0</b> in a RESOLVE_INIT_KMS message.</p>
<p id="p-0051" num="0050">Step <b>9</b>. KMS<b>0</b> responds to KMS R with inter-KMS key <b>209</b> in a RESOLVE_RESP_KMS message.</p>
<p id="p-0052" num="0051">Step <b>10</b>. KMS R confirms its receipt of the inter-KMS key <b>209</b> by sending a TRANSFER_RESP_KMS message to KMS I, thus finalizing the key exchange. At this point, the security association between KMS I and KMS R is established.</p>
<p id="p-0053" num="0052">Step <b>11</b>. KMS R sends a RESOLVE_RESP message with the session key <b>205</b> to Responder.</p>
<p id="p-0054" num="0053">Step <b>12</b>. Responder finalizes key exchange by sending a TRANSFER_RESP message to Initiator.</p>
<p id="p-0055" num="0054">Note that key <b>205</b> is the session key needed for the actual media session between I and R; KMS I sends key <b>205</b> to KMS R, and KMS R sends key <b>205</b> to R. Key <b>209</b> is the key which allows KMS I to establish a security association with KMS R after initiation of the communication session by I, thus alleviating the requirement that KMS I and KMS R have a pre-existing one-to-one security association. Note that no media is being protected by this inter-KMS key, only signaling between KMS I and KMS R.</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. 2B</figref> illustrates the same steps as described above in the context of <figref idref="DRAWINGS">FIG. 2A</figref> but shows the actual message ordering in a hierarchical key management messaging protocol <b>220</b>. Thus, in summary, KMS I and KMS R do not have security associations (SAs) with each other, but KMS I and KMS R do have SAs with KMS<b>0</b>. The key exchange is initiated by UE I; it sends a request to KMS I to securely connect with UE R, which is associated with KMS R. KMS I to KMS R have to establish an SA with each other. To do this, KMS I and KMS R use KMS<b>0</b> with which both of them, KMS I and KMS R, have pre-configured SAs. Note that the SA between KMS I and KMS R is considered as being established once KMS R sends the confirmation message to KMS I in step <b>10</b>. Also note that KMS I forwards (in the step #<b>7</b>) the session key previously given to UE I (step #<b>2</b>) to KMS R. After that KMS R can forward that session key to UE R in the step #<b>11</b>. Now UE I and UE R both have the session key and a security association, and can exchange media protected by the key.</p>
<p id="p-0057" num="0056">An alternative embodiment to the embodiment described above in the context of <figref idref="DRAWINGS">FIGS. 2A and 2B</figref> is the approach in which KMS R sends a REQUEST_INIT_KMS message to KMS<b>0</b> and receives inter-KMS ticket <b>208</b> and inter-KMS key <b>209</b> (or key generating information for generating the inter-KMS key) in a REQUEST_RESP_KMS message. REQUEST_INIT_KMS and REQUEST_RESP_KMS messages are followed by TRANSFER and RESOLVE messages (i.e., KMS R sends TRANSFER_INIT_KMS message to KMS I, which in turn exchanges RESOLVE_INIT_KMS/RESOLVE_RESP_KMS messages with the KMS<b>0</b> before it returns TRANSFER_RESP_KMS message to the KMS R).</p>
<p id="p-0058" num="0057">It is to be understood that while the embodiments above illustratively describe the hierarchical key management solutions of the invention in the context of the MIKEY-TICKET key distribution methodology, such inventive solutions are not limited to usage in the MIKEY-TICKET protocol. That is, such a hierarchical key management service architecture and methodology of the invention can be implemented in any other suitable key management scenario in a communication system.</p>
<p id="p-0059" num="0058">Also, note that the inventive hierarchical KMS architecture described herein advantageously allows scaling horizontally (i.e., adding more KMSs on the same level), as well as scaling vertically (i.e., adding levels of hierarchy) without changing of the base protocol.</p>
<p id="p-0060" num="0059">Accordingly, by way of one exemplary aspect of the invention, in a communication system wherein a first computing device (e.g., KMS I) is configured to perform a key management function (e.g., service) for first user equipment (e.g., UE I) and a second computing device (e.g., KMS R) is configured to perform a key management function for second user equipment (e.g., UE R), wherein the first user equipment seeks to initiate communication with the second user equipment, wherein the first computing device and the second computing device do not have a pre-existing security association there between, and wherein a third computing device (e.g., KMS<b>0</b>) is configured to perform a key management function and has a pre-existing security association with the first computing device and a pre-existing security association with the second computing device, the third computing device performing a method comprising steps of: receiving a request from the first computing device (e.g., step <b>5</b>); and in response to the request, facilitating establishment of a security association between the first computing device and the second computing device (steps <b>6</b> through <b>10</b>) such that the first computing device and the second computing device can then facilitate establishment of a security association between the first user equipment and the second user equipment. Note that in an alternative embodiment, the third computing device may receive the request from the second computing device, and thus the second computing device (rather than the first computing device) initiates establishment of the inter-KMS security association.</p>
<p id="p-0061" num="0060">The first computing device, the second computing device and the third computing device comprise at least a part of a key management hierarchy wherein the first computing device and the second computing device are on a lower level (e.g., level B) of the hierarchy and the third computing device is on a higher level (e.g., level A) of the hierarchy.</p>
<p id="p-0062" num="0061">In one exemplary embodiment, the facilitating step performed by the third computing device (e.g., KMS<b>0</b>) further comprises sending a data item (e.g., ticket <b>208</b>) and cryptographic information (key or key generating information <b>209</b>) to the first computing device (e.g., KMS I). The first computing device then sends the data item to the second computing device (e.g., KMS R). The second computing device then sends the data item to the third computing system. The third computing system then sends the same cryptographic information to the second computing system that was sent to the first computing system, in response to receiving the data item from the second computing system. The second computing device then sends a response to the first computing device. Furthermore, a session key and a security association between the first user equipment (e.g., UE I) and the second user equipment (e.g., UE R) is established once the security association is established between the first computing device and the second computing device.</p>
<p id="p-0063" num="0062">Referring now lastly to <figref idref="DRAWINGS">FIG. 3</figref>, illustrated is generalized hardware architecture <b>300</b> of a communication system environment and computing devices suitable for implementing a key management protocol between two entities according to the present invention. While <figref idref="DRAWINGS">FIG. 3</figref> shows only computing devices for two entities A and B, it is to be understood that other entities can have the same configuration. Thus, in terms of the key management protocols described above, the two entities A and B may be any two entities shown in <figref idref="DRAWINGS">FIGS. 2A and 2B</figref>, i.e.: initiator <b>202</b>-I and responder <b>202</b>-R; a KMS and either of the initiator and the responder; any two KMSs of the KMS hierarchy; etc. Thus, for the sake of simplicity, all the computing devices (communication devices and servers) that may participate in the protocols of the invention are not shown in <figref idref="DRAWINGS">FIG. 3</figref>.</p>
<p id="p-0064" num="0063">As shown, A's computing device designated <b>302</b> and B's computing device designated <b>304</b> are coupled via a network <b>306</b>. The network may be any network across which the devices are able to communicate, for example, as in the embodiments described above, the network <b>306</b> could include a publicly-accessible wide area communication network such as a cellular communication network operated by a network operator (e.g., Verizon, AT&#x26;T, Sprint). Network <b>306</b> may also include a private enterprise network. However, the invention is not limited to a particular type of network. Typically, the devices could be client machines. Examples of client devices that may be employed by the parties to participate in the protocols described herein may include, but are not limited to, cellular phones, smart phones, desktop phones, personal digital assistants, laptop computers, personal computers, etc. However, one or more of the devices could be servers. Thus, it is to be understood that the communication protocol of the present invention is not limited to the case where the computing systems are client and server, respectively, but instead is applicable to any form of computing devices.</p>
<p id="p-0065" num="0064">As would be readily apparent to one of ordinary skill in the art, the servers and clients may be implemented as programmed computers operating under control of computer program code. The computer program code would be stored in a computer readable storage medium (e.g., a memory) and the code would be executed by a processor of the computer. Given this disclosure of the invention, one skilled in the art could readily produce appropriate computer program code in order to implement the protocols described herein.</p>
<p id="p-0066" num="0065">Nonetheless, <figref idref="DRAWINGS">FIG. 3</figref> generally illustrates an exemplary architecture for each computer system communicating over the network. As shown, device <b>302</b> comprises I/O devices <b>308</b>-A, processor <b>310</b>-A, and memory <b>312</b>-A. Device <b>304</b> comprises I/O devices <b>308</b>-B, processor <b>310</b>-B, and memory <b>312</b>-B. It should be understood that the term &#x201c;processor&#x201d; as used herein is intended to include one or more processing devices, including a central processing unit (CPU) or other processing circuitry, including but not limited to one or more signal processors, one or more integrated circuits, and the like. Also, the term &#x201c;memory&#x201d; as used herein is intended to include memory associated with a processor or CPU, such as RAM, ROM, a fixed memory device (e.g., hard drive), or a removable memory device (e.g., diskette or CDROM). In addition, the term &#x201c;I/O devices&#x201d; as used herein is intended to include one or more input devices (e.g., keyboard, mouse) for inputting data to the processing unit, as well as one or more output devices (e.g., CRT display) for providing results associated with the processing unit.</p>
<p id="p-0067" num="0066">Accordingly, software instructions or code for performing the methodologies of the invention, described herein, may be stored in one or more of the associated memory devices, e.g., ROM, fixed or removable memory, and, when ready to be utilized, loaded into RAM and executed by the CPU.</p>
<p id="p-0068" num="0067">Although illustrative embodiments of the present invention have been described herein with reference to the accompanying drawings, it is to be understood that the invention is not limited to those precise embodiments, and that various other changes and modifications may be made by one skilled in the art without departing from the scope or spirit of the invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method, comprising:
<claim-text>in a communication system wherein a first computing device is configured to perform a key management function for first user equipment and a second computing device is configured to perform a key management function for second user equipment, wherein the first user equipment seeks to initiate communication with the second user equipment, wherein the first computing device and the second computing device do not have a pre-existing security association there between, and wherein a third computing device is configured to perform a key management function and has a pre-existing security association with the first computing device and a pre-existing security association with the second computing device, the third computing device performing steps of:</claim-text>
<claim-text>receiving a request from one of the first computing device and the second computing device;</claim-text>
<claim-text>in response to the request, facilitating establishment of a first security association between the first computing device and the second computing device such that the first computing device and the second computing device then facilitate establishment of a second security association different than the first security association between the first user equipment and the second user equipment; and</claim-text>
<claim-text>sending cryptographic information and a data item comprising a ticket or voucher to the first computing device,</claim-text>
<claim-text>the first computing device and the second computing device being on a lower level of a key management hierarchy and the third computing device being on a higher level of the hierarchy.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first computing device sends the data item to the second computing device.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first computing device computes a key based on the cryptographic information received from the third computing device, and uses the computed key to secure transfer of one or more messages to the second computing device.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the cryptographic information received by the first computing device from the third computing device is a pre-computed key, and the first computing device uses the pre-computed key to secure transfer of one or more messages to the second computing device.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the second computing device sends the data item to the third computing device.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the third computing device sends the same cryptographic information to the second computing device that was sent to the first computing device, in response to receiving the data item from the second computing device.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the second computing device computes the key based on the cryptographic information received from the third computing device, and uses the computed key to secure transfer of one or more messages to the first computing device.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the cryptographic information received by the second computing device from the third computing device is the pre-computed key, and the second computing device uses the pre-computed key to secure transfer of one or more messages to the first computing device.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first computing device, the second computing device and the third computing device are each key management services.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein a session key and the second security association is established between the first user equipment and the second user equipment once the first security association is established between the first computing device and the second computing device.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the communication system comprises an Internet Protocol Multimedia Subsystem.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first computing device is managed by a different administrative domain than the administrative domain that manages the second computing device.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. An apparatus, comprising:
<claim-text>in a communication system wherein a first computing device is configured to perform a key management function for first user equipment and a second computing device is configured to perform a key management function for second user equipment, wherein the first user equipment seeks to initiate communication with the second user equipment, wherein the first computing device and the second computing device do not have a pre-existing security association there between, and wherein a third computing device is configured to perform a key management function and has a pre-existing security association with the first computing device and a pre-existing security association with the second computing device, the third computing device comprising:</claim-text>
<claim-text>a memory; and</claim-text>
<claim-text>at least one processor coupled to the memory and configured to:</claim-text>
<claim-text>receive a request from one of the first computing device and the second computing device;</claim-text>
<claim-text>in response to the request, facilitate establishment of a first security association between the first computing device and the second computing device such that the first computing device and the second computing device then facilitate establishment of a second security association different than the first security association between the first user equipment and the second user equipment; and</claim-text>
<claim-text>send cryptographic information and a data item comprising a ticket or voucher to the first computing device,</claim-text>
<claim-text>the first computing device and the second computing device being on a lower level of a key management hierarchy and the third computing device being on a higher level of the hierarchy.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The apparatus of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein a session key and the second security association is established between the first user equipment and the second user equipment once the first security association is established between the first computing device and the second computing device.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The apparatus of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the first computing device is managed by a different administrative domain than the administrative domain that manages the second computing device.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. An article of manufacture, comprising:
<claim-text>in a communication system wherein a first computing device is configured to perform a key management function for first user equipment and a second computing device is configured to perform a key management function for second user equipment, wherein the first user equipment seeks to initiate communication with the second user equipment, wherein the first computing device and the second computing device do not have a pre-existing security association there between, and wherein a third computing device is configured to perform a key management function and has a pre-existing security association with the first computing device and a pre-existing security association with the second computing device, a non-transitory processor-readable storage medium storing one or more software programs which when executed by a processor associated with the third computing device perform steps of:</claim-text>
<claim-text>receiving a request from one of the first computing device and the second computing device;</claim-text>
<claim-text>in response to the request, facilitating establishment of a first security association between the first computing device and the second computing device such that the first computing device and the second computing device then facilitate establishment of a second security association different than the first security association between the first user equipment and the second user equipment; and</claim-text>
<claim-text>sending cryptographic information and a data item comprising a ticket or voucher to the first computing device,</claim-text>
<claim-text>the first computing device and the second computing device being on a lower level of a key management hierarchy and the third computing device being on a higher level of the hierarchy. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
