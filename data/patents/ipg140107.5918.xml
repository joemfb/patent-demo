<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08627027-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08627027</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13300283</doc-number>
<date>20111118</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2010-260527</doc-number>
<date>20101122</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>228</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>13</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>711162</main-classification>
</classification-national>
<invention-title id="d2e71">Data processing apparatus, access control method, and storage medium</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6704754</doc-number>
<kind>B1</kind>
<name>Kobayashi et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>8000755</doc-number>
<kind>B2</kind>
<name>Anzai et al.</name>
<date>20110800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455573</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2006/0224850</doc-number>
<kind>A1</kind>
<name>Yamamoto et al.</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2009/0240877</doc-number>
<kind>A1</kind>
<name>Taniyama</name>
<date>20090900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>GB</country>
<doc-number>2436629</doc-number>
<kind>A</kind>
<date>20071000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>JP</country>
<doc-number>06-028298</doc-number>
<kind>A</kind>
<date>19940200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>JP</country>
<doc-number>2000-353054</doc-number>
<kind>A</kind>
<date>20001200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>JP</country>
<doc-number>2001-325130</doc-number>
<kind>A</kind>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>JP</country>
<doc-number>2004-164362</doc-number>
<kind>A</kind>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>JP</country>
<doc-number>2005-510809</doc-number>
<kind>A</kind>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>JP</country>
<doc-number>2006-134021</doc-number>
<kind>A</kind>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>JP</country>
<doc-number>2007-110700</doc-number>
<kind>A</kind>
<date>20070400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00013">
<othercit>&#x201c;IBM. AIX 5L version 5.3 A guidance for controlling a system: Operating system and apparatuses&#x201d;; Inst De Tehnica Agricola Mecagro; Oct. 31, 2012.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00014">
<othercit>SX/A Command User Manual vol. 1;Nov. 30, 1995.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>11</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>18</number-of-drawing-sheets>
<number-of-figures>18</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120131295</doc-number>
<kind>A1</kind>
<date>20120524</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Nakajima</last-name>
<first-name>Satoru</first-name>
<address>
<city>Yokohama</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Nakajima</last-name>
<first-name>Satoru</first-name>
<address>
<city>Yokohama</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Canon USA Inc. IP Division</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Canon Kabushiki Kaisha</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Doan</last-name>
<first-name>Duc</first-name>
<department>2185</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">When an accessible state of an external memory unit is instructed to be canceled and data is not storing in the external memory unit, a data processing apparatus cancels the accessible state of the external memory unit if the external memory unit is not set as a backup destination, and does not cancel the accessible state of the external memory unit if the external memory unit is set as the backup destination.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="210.31mm" wi="184.23mm" file="US08627027-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="150.54mm" wi="176.45mm" file="US08627027-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="185.59mm" wi="171.28mm" file="US08627027-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="251.38mm" wi="104.90mm" orientation="landscape" file="US08627027-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="218.86mm" wi="192.79mm" file="US08627027-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="242.91mm" wi="179.15mm" file="US08627027-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="228.01mm" wi="174.58mm" orientation="landscape" file="US08627027-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="212.34mm" wi="130.30mm" file="US08627027-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="170.01mm" wi="114.64mm" file="US08627027-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="202.61mm" wi="106.17mm" orientation="landscape" file="US08627027-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="196.68mm" wi="152.40mm" file="US08627027-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="207.09mm" wi="154.35mm" file="US08627027-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="212.34mm" wi="200.58mm" file="US08627027-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="141.99mm" wi="116.59mm" file="US08627027-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="237.07mm" wi="182.37mm" file="US08627027-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="205.15mm" wi="150.45mm" file="US08627027-20140107-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="157.65mm" wi="138.77mm" file="US08627027-20140107-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="222.76mm" wi="151.72mm" orientation="landscape" file="US08627027-20140107-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="138.09mm" wi="132.25mm" file="US08627027-20140107-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates to a data processing apparatus that backs up data in an external memory unit.</p>
<p id="p-0004" num="0003">2. Description of the Related Art</p>
<p id="p-0005" num="0004">There is a data processing apparatus that backs up data in an external memory unit. For example, to back up data in a universal-serial-bus (USB) storage device that is an example of an external memory unit, the data processing apparatus executes processing (e.g., mount processing) for setting the USB storage device operable to store the data in the USB storage device.</p>
<p id="p-0006" num="0005">When a user removes the USB storage device from the data processing apparatus, the data processing apparatus executes processing (e.g., mount processing) for setting the USB storage device removable. Careless removable of the external memory unit during storage of the data in the external memory unit disables storage of the data in the external memory unit.</p>
<p id="p-0007" num="0006">Japanese Patent Application Laid-Open No. 2007-110700 discusses a data processing apparatus that inhibits removal of an external memory unit while storing data in the external memory unit.</p>
<p id="p-0008" num="0007">A conventional art has provided a data processing apparatus that inhibits removal of the external memory unit during access to the external memory unit. However, when the external memory unit is designated as a backup destination, a removable state of the external memory unit may not be desired even while there is no access to the external memory unit.</p>
<p id="p-0009" num="0008">For example, When data is backed up in the external memory unit at designated time, if the external memory unit is removable at this time, the data cannot be stored in the external memory unit.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0010" num="0009">The present invention is directed to a data processing apparatus capable of reducing data backup failures in an external memory unit, and a method thereof.</p>
<p id="p-0011" num="0010">According to an aspect of the present invention, a data processing apparatus configured to back up data in an external memory unit includes: an access control unit configured to set an accessible state of the external memory unit; a setting unit configured to set the external memory unit as a backup destination; and a backup unit configured to back up data in the external memory unit set in the accessible state and as the backup destination. Even when the accessible state of the external memory unit is instructed to be canceled and data is not stored in the external memory unit, the access control unit does not cancel the accessible state of the external memory unit if the external memory unit is set as the backup destination.</p>
<p id="p-0012" num="0011">Further features and aspects of the present invention will become apparent from the following detailed description of exemplary embodiments with reference to the attached drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0013" num="0012">The accompanying drawings, which are incorporated in and constitute a part of the specification, illustrate exemplary embodiments, features, and aspects of the invention and, together with the description, serve to explain the principles of the invention.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram illustrating a configuration of a data processing apparatus <b>100</b>.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram illustrating a functional configuration of system software of the data processing apparatus <b>100</b>.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 3</figref> illustrates an example of a table for storing connection state information.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart illustrating connection processing of a USB storage device.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 5</figref> illustrates an example of a screen of an operation unit <b>107</b> for displaying a connection state of the USB storage device.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 6</figref> illustrates an example of a backup setting screen displayed on an external apparatus or the operation unit <b>107</b>.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 7</figref> is a flowchart illustrating setting of a backup destination.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 8</figref> is a flowchart illustrating backup destination determination.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 9</figref> illustrates an example of an operation screen for executing backing-up.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 10</figref> is a flowchart illustrating backup start processing.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 11</figref> is a flowchart illustrating back-up processing.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 12</figref> illustrates an example of a setting screen for setting a backup schedule.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 13</figref> is a flowchart illustrating scheduling of back-up processing.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 14</figref> illustrates an example of an operation screen for executing unmounting.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 15</figref> is a flowchart illustrating unmounting processing of the USB storage device.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 16</figref> is a flowchart illustrating unmounting processing.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 17</figref> illustrates an example of a backup setting screen displayed when backup setting is canceled.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 18</figref> is a flowchart illustrating cancel processing for cancelling the backup setting.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF THE EMBODIMENTS</heading>
<p id="p-0032" num="0031">Various exemplary embodiments, features, and aspects of the invention will be described in detail below with reference to the drawings.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram illustrating a configuration of a data processing apparatus according to the present exemplary embodiment. The data processing apparatus <b>100</b> includes a controller unit <b>101</b> and an operation unit <b>107</b>. The controller unit <b>101</b> includes a central processing unit (CPU) <b>102</b>, a random access memory (RAM) <b>103</b>, a read-only memory (ROM) <b>104</b>, a hard disk drive (HDD) <b>105</b>, an operation unit interface (I/F) <b>106</b>, a USB host I/F <b>108</b>, a network I/F <b>110</b>, and a system bus <b>112</b>.</p>
<p id="p-0034" num="0033">The CPU <b>102</b> is a controller that controls the entire data processing apparatus, and is a center of the controller unit <b>101</b>. The RAM <b>103</b> is a system work memory necessary for operating the CPU <b>102</b>, and stores data processed by the CPU <b>102</b> or a program to be executed by the CPU <b>102</b>.</p>
<p id="p-0035" num="0034">The ROM <b>104</b> is a boot ROM to store a boot program. The HDD <b>105</b> stores a control program for controlling the data processing apparatus <b>100</b>, or document data. The CPU <b>102</b> controls the data processing apparatus <b>100</b> by executing the boot program stored in the ROM <b>104</b> or the control program transferred from the HDD <b>105</b> to the RAM <b>103</b>.</p>
<p id="p-0036" num="0035">The operation I/F <b>106</b> is an interface unit that communicates with the operation unit <b>107</b>. The operation I/F <b>106</b> outputs information to be displayed on the operation unit <b>107</b> to the operation unit <b>107</b>, or receives information input from the operation unit <b>107</b>. The operation unit <b>107</b> displays various pieces of information or receives instructions from a user. The operation unit <b>107</b> includes a display, a touch panel, or operation keys.</p>
<p id="p-0037" num="0036">The USB host I/F <b>108</b> is an interface unit that communicates with a USB storage device <b>109</b>. The USB host I/F <b>108</b> outputs the information input via the operation unit <b>107</b> or the document data stored in the HDD <b>105</b> to the USB storage device <b>109</b>. The USB host I/F <b>108</b> receives data stored in the USB storage device <b>109</b> to transmit it to the CPU <b>102</b>. The USB storage device <b>109</b> is an external memory unit that stores data, and is detachable from the USB host I/F <b>108</b>. A plurality of USB devices including the USB storage device <b>109</b> can be connected to the USB host I/F <b>108</b>.</p>
<p id="p-0038" num="0037">The network I/F <b>110</b> is connected to a local area network (LAN) <b>111</b> to communicate with external apparatuses connected to the LAN <b>111</b>. The LAN <b>111</b> can be replaced by another network that is not a LAN. The external apparatus may be a personal computer (PC), a data processing apparatus similar to the data processing apparatus <b>100</b>, or a file server.</p>
<p id="p-0039" num="0038">The system bus <b>112</b> is connected as a data transmission path to the abovementioned units.</p>
<p id="p-0040" num="0039">The data processing apparatus <b>100</b> can also include an image input/output device such as a scanner or a printer. In such a case, the controller unit <b>101</b> is connected to the image input/output device to control it.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram illustrating a functional configuration of system software of the data processing apparatus <b>100</b>. The CPU <b>102</b> realizes each function by executing a program corresponding to the function.</p>
<p id="p-0042" num="0041">An application unit <b>200</b> provides, to the user, a user interface for allowing the user to execute a reference instruction of a connection state of the USB storage device <b>109</b> or an unmounting instruction of the USB storage device <b>109</b> via the operation unit <b>107</b>. The application unit <b>200</b> makes, according to an instruction from the user, an inquiry about the connection state of the USB storage device <b>109</b> to a USB storage state notification unit <b>202</b>, and receives the connection state of the USB storage device <b>109</b>.</p>
<p id="p-0043" num="0042">The USB storage state notification unit <b>202</b> receives the connection state of the USB storage device <b>109</b> from a USB storage state management unit <b>203</b>, and notifies the application unit <b>200</b> of the connection state.</p>
<p id="p-0044" num="0043">The USB storage state management unit <b>203</b> manages the connection state of the USB storage device <b>109</b> detected by a USB storage detection unit <b>204</b>.</p>
<p id="p-0045" num="0044">The USB storage detection unit <b>204</b> makes an inquiry about the connection state of the USB storage device <b>109</b> to an operating system <b>201</b>, receives the connection state of the USB storage device <b>109</b>, and notifies the USB storage state management unit <b>203</b> of the connection state.</p>
<p id="p-0046" num="0045">The USB storage detection unit <b>204</b> instructs, as a part of access control to the USB storage device, mounting or unmounting of the USB storage device to the operating system <b>201</b>.</p>
<p id="p-0047" num="0046">A document management unit <b>205</b> manages image data stored in the HDD <b>105</b> as image data. The document management unit <b>205</b> stores document data acquired from a scanner or document data acquired from the external apparatus via the LAN <b>111</b> in the HDD <b>105</b> via the operating system <b>201</b>.</p>
<p id="p-0048" num="0047">The document management unit <b>205</b> acquires document data requested from the operation unit <b>107</b> or the external apparatus connected to the LAN <b>111</b> from the HDD <b>105</b> via the operating system <b>201</b>.</p>
<p id="p-0049" num="0048">A backup processing unit <b>206</b> receives a backup instruction of the document data from the application unit <b>200</b> to create backup data of the document data stored in the HDD <b>105</b>. The backup processing unit <b>206</b> stores the backup data in the USB storage device <b>109</b> via the operating system <b>201</b> or transmits the backup data to the external apparatus via the LAN <b>111</b>.</p>
<p id="p-0050" num="0049">The backup processing unit <b>206</b> acquires the backup data from the USB storage unit <b>109</b> via the operating system <b>201</b> or the backup data from the external apparatus via the LAN <b>111</b>. The backup processing unit <b>206</b> restores the document data in the HDD <b>105</b> based on the acquired backup data.</p>
<p id="p-0051" num="0050">An encryption unit <b>207</b> encrypts, according to an instruction from the backup processing unit <b>206</b>, the backup data or decrypts the encrypted backup data.</p>
<p id="p-0052" num="0051">According to the present exemplary embodiment, the backup data is stored in the USB storage device <b>109</b>.</p>
<p id="p-0053" num="0052">When the operating system <b>201</b> recognizes that the USB device has been connected to the USB host I/F <b>108</b>, the operating system <b>201</b> reads a driver necessary for using the USB device.</p>
<p id="p-0054" num="0053">The operating system <b>201</b> acquires device information from the USB device, and stores the device information as connection state information in the RAM <b>103</b>. The operating system <b>201</b> then allocates a device file for accessing the USB device to the USB device.</p>
<p id="p-0055" num="0054">Thus, the operating system <b>201</b> manages the entire USB device including the USB storage device. Hereinafter, the present exemplary embodiment is described by focusing on the USB storage device of the USB device.</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. 3</figref> illustrates an example of a table for storing the connection state information. The operating system <b>201</b> manages the table on the RAM <b>103</b>.</p>
<p id="p-0057" num="0056">A device file name <b>301</b> is a name of a device file allocated to the USB storage device. A vendor ID <b>302</b> identifies a manufacturing vendor of the USB storage device. A product ID <b>303</b> identifies a product of the USB storage device.</p>
<p id="p-0058" num="0057">A serial number <b>304</b> is a serial number of the USB storage device. A state <b>305</b> is a connection state of the USB storage device, indicating a connected state. A name <b>306</b> is a name given to the USB storage device. A total capacity <b>307</b> is a maximum data size storable in the USB storage device. A remaining capacity <b>308</b> is a data size storable thereafter in the USB storage device.</p>
<p id="p-0059" num="0058">The USB storage state management unit <b>203</b> manages a table similar to that illustrated in <figref idref="DRAWINGS">FIG. 3</figref> on the RAM <b>103</b>, and updates the table based on the connection state information acquired from the operating system <b>201</b>.</p>
<p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart illustrating connection processing of the USB storage device. The CPU <b>102</b> realizes the connection processing by executing a program.</p>
<p id="p-0061" num="0060">In step S<b>401</b>, the USB storage detection unit <b>204</b> periodically acquires connection state information of the USB storage device from the operating system <b>201</b>. In step S<b>402</b>, the USB storage detection unit <b>204</b> compares the acquired connection state information with connection state information managed by the USB storage state management unit <b>203</b>.</p>
<p id="p-0062" num="0061">In step S<b>403</b>, the USB storage detection unit <b>204</b> determines, based on a result of the comparison, whether there is, in the acquired connection state information, a USB storage device not present in the connection state information managed by the USB storage state management unit <b>203</b>. In other words, the USB storage detection unit <b>204</b> determines whether a new USB storage device has been connected.</p>
<p id="p-0063" num="0062">When there is a new USB storage device (YES in step S<b>403</b>), in step S<b>404</b>, the USB storage detection unit <b>204</b> instructs the operating system to mount the new USB storage device.</p>
<p id="p-0064" num="0063">The operating system <b>201</b> treats the new USB storage device as a device file, and allocates the device file to an arbitrary layer of a file system. The layer to which the device file has been allocated becomes a mounting point. In layers below the mounting point, the file system of the USB storage device is expanded. This enables file access to the USB storage device.</p>
<p id="p-0065" num="0064">Setting an accessible state to the USB storage device is referred to as mounting. Cancelling the accessible state to the USB storage device is referred to as unmounting. Thus, the operating system <b>201</b> executes mounting or unmounting of the USB storage device as a part of access control to the USB storage device.</p>
<p id="p-0066" num="0065">In step S<b>405</b>, the USB storage detection unit <b>204</b> determines whether mounting has been performed successfully. When performed successfully (YES in step S<b>405</b>), in step S<b>406</b>, the USB storage detection unit <b>204</b> notifies the USB storage state management unit <b>203</b> thereof, and the USB storage state management unit <b>203</b> registers connection information of the new USB storage device in the table.</p>
<p id="p-0067" num="0066">In step S<b>407</b>, the USB storage state management unit <b>203</b> notifies the application unit <b>200</b> of the mounting of the new USB storage device.</p>
<p id="p-0068" num="0067">When there is no new USB storage device (NO in step S<b>403</b>), in step S<b>408</b>, the USB storage detection unit <b>204</b> determines whether there is any USB storage device present in the connection state information managed by the USB storage state management unit <b>203</b> but not in the acquired connection state information. In other words, the USB storage detection unit <b>204</b> determines whether there is any disconnected USB storage device.</p>
<p id="p-0069" num="0068">When there is a disconnected USB storage device (YES in step S<b>408</b>), in step S<b>409</b>, the USB storage state management unit <b>203</b> deletes connection state information regarding this USB storage device from the table.</p>
<p id="p-0070" num="0069">In step S<b>410</b>, the USB storage state management unit <b>203</b> determines whether the disconnected USB storage device has been set as a backup destination (storage destination of backup data). A method for setting the backup destination is described below.</p>
<p id="p-0071" num="0070">When the USB storage device has not been set as a backup destination (NO in step S<b>410</b>), in step S<b>411</b>, the USB storage state management unit <b>203</b> notifies the application unit <b>200</b> of pulling-out of the USB storage device. The application unit <b>200</b> notifies the user of the pulling-out of the USB storage device, in other words, removal of the USB storage device as usual.</p>
<p id="p-0072" num="0071">When the USB storage device has been set as a backup destination (YES in step S<b>410</b>), in step S<b>412</b>, the USB storage state management unit <b>203</b> notifies the application unit <b>200</b> of pulling-out of the USB storage device that is the backup destination. The application unit <b>200</b> notifies the user of the pulling-out of the USB storage device that is the backup destination, in other words, removal of the USB storage device that is the backup destination.</p>
<p id="p-0073" num="0072">A method of notification to the user may display a message indicating the pulling-out of the USB storage device on the operation unit <b>107</b>, or transmit a mail indicating the pulling-out of the USB storage device to a specific address.</p>
<p id="p-0074" num="0073">Thus, even when the user removes the USB storage device without knowing that the USB storage device is the backup destination, the removal of the USB storage device that is the backup destination can be recognized.</p>
<p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. 5</figref> illustrates an example of a screen of the operation unit <b>107</b> for displaying the connection state of the USB storage device. A screen <b>501</b> is displayed when no USB storage device is connected. A screen <b>502</b> is displayed when a new USB storage device is connected. Anew USB storage named &#x201c;memory medium&#x201d; is added to a list.</p>
<p id="p-0076" num="0075">Next, setting of the backup destination is described. The backup destination is set according to an instruction transmitted from the external apparatus via the LAN <b>111</b>, or an instruction input via the operation unit <b>107</b>.</p>
<p id="p-0077" num="0076"><figref idref="DRAWINGS">FIG. 6</figref> illustrates an example of a backup setting screen displayed on the external apparatus or the operation unit <b>107</b>. A pull-down button <b>601</b> is for selecting a storage destination of backup data.</p>
<p id="p-0078" num="0077">A user can select &#x201c;USB HDD&#x201d; or &#x201c;SMB server&#x201d; by using the pull-down button <b>601</b>. The &#x201c;USB HDD&#x201d; is an example of a USB storage device. The &#x201c;SMB server&#x201d; transfers/receives data based on SMB protocol via the LAN <b>111</b>.</p>
<p id="p-0079" num="0078">An input area <b>602</b> is for inputting a path to a folder of the backup destination. When a user selects the &#x201c;USB HDD&#x201d;, the user determines which folder of the USB HDD the backup data is stored in, and designates a path indicating the folder in the input area <b>602</b>.</p>
<p id="p-0080" num="0079">An input area <b>603</b> is for inputting information necessary for using the SMB server. When the user has selected the &#x201c;SMB server&#x201d;, the user inputs information regarding the SMB server that is a storage destination of the backup data in the input area <b>603</b>.</p>
<p id="p-0081" num="0080">A &#x201c;host IP address&#x201d; is an IP address of the SMB server. A &#x201c;user name&#x201d; is a name of a user of the SMB server. A &#x201c;password&#x201d; is for using the SMB server, making a pair with the user name.</p>
<p id="p-0082" num="0081">A &#x201c;confirmation input&#x201d; is an area for re-inputting the password to check it. A &#x201c;path to folder&#x201d; is a path to the folder of the backup destination. The user determines which folder of the SMB server the backup data is stored in, and designates the path indicating the folder as a &#x201c;path to folder&#x201d;.</p>
<p id="p-0083" num="0082">A check box <b>604</b> is for instructing whether to encrypt the backup data. To store the backup data by using encryption in the backup destination, the user checks the check box <b>604</b>.</p>
<p id="p-0084" num="0083">A &#x201c;password&#x201d; below the check box <b>604</b> is necessary for encrypting data. The user, who has checked the check box <b>604</b>, designates a password necessary for encrypting the data as a &#x201c;password&#x201d;. A &#x201c;confirmation input&#x201d; is an area for re-inputting the password to check it.</p>
<p id="p-0085" num="0084">When the user presses an OK button <b>605</b> on a setting screen displayed on the external apparatus, data (referred to as backup setting data) set on the setting screen is transmitted from the external apparatus to the data processing apparatus <b>100</b> to be stored in the RAM <b>103</b>.</p>
<p id="p-0086" num="0085">When the user presses an OK button <b>605</b> on a setting screen displayed on the operation unit <b>107</b>, data (referred to as backup setting data) set on the setting screen is stored in the RAM <b>103</b>.</p>
<p id="p-0087" num="0086"><figref idref="DRAWINGS">FIG. 7</figref> is a flowchart illustrating setting processing of a backup destination. The CPU <b>102</b> realizes the setting processing by executing a program. <figref idref="DRAWINGS">FIG. 7</figref> illustrates only a case where the USB storage device is a backup destination.</p>
<p id="p-0088" num="0087">In step S<b>701</b>, the application unit <b>200</b> determines whether the USB HDD has been designated as a backup destination based on data set on the setting screen. When it is determined that the USB HDD has not been designated as a backup destination (NO in step S<b>701</b>), the setting processing is ended.</p>
<p id="p-0089" num="0088">When it is determined that the USB HDD has been designated as a backup destination (YES in step S<b>701</b>), in step S<b>702</b>, the application unit <b>200</b> acquires connection state information regarding the USB storage device connected to the data processing apparatus <b>100</b> from the USB storage state management unit <b>203</b>.</p>
<p id="p-0090" num="0089">In step S<b>703</b>, the application unit <b>200</b> determines whether the USB storage device has been connected to the data processing apparatus <b>100</b>. When it is determined that the USB storage device has not been connected (NO in step S<b>703</b>), the setting processing is ended.</p>
<p id="p-0091" num="0090">When it is determined that the USB storage device has been connected (YES in step S<b>703</b>), in step S<b>704</b>, the application unit <b>200</b> executes backup destination determination. The backup destination determination is described in detail below.</p>
<p id="p-0092" num="0091">In step S<b>705</b>, after the backup destination determination, the application unit <b>200</b> determines whether the number of USB storage devices selected by the backup destination determination is one. When the number is zero or a plural number (NO in step S<b>705</b>), the setting processing is ended. When the number is one (YES in step S<b>705</b>), in step S<b>706</b>, the application unit <b>200</b> stores connection state information of the USB storage device as information (referred to as backup destination identification information) to identify a backup USB storage device in the RAM <b>103</b>.</p>
<p id="p-0093" num="0092">In step S<b>410</b>, the application unit <b>200</b> determines whether a disconnected USB storage device is the USB storage device indicated by the backup destination identification information.</p>
<p id="p-0094" num="0093"><figref idref="DRAWINGS">FIG. 8</figref> is a flowchart illustrating the backup destination determination processing performed in step S<b>704</b>. The CPU <b>102</b> realizes the backup destination determination by executing a program.</p>
<p id="p-0095" num="0094">In step S<b>801</b>, the application unit <b>200</b> acquires, among pieces of connection state information of one or the plurality of USB storage devices acquired in step S<b>702</b>, connection state information of one USB storage device.</p>
<p id="p-0096" num="0095">In step S<b>802</b>, the application unit <b>200</b> determines whether a total capacity indicated by the connection state information is equal to or larger than a threshold value. When it is smaller than the threshold value (NO in step S<b>802</b>), the processing proceeds to step S<b>804</b>. When it is equal to or larger than the threshold value (YES in step S<b>802</b>), in step S<b>803</b>, the application unit <b>200</b> stores the USB storage device as a candidate of a backup USB storage device.</p>
<p id="p-0097" num="0096">In step S<b>804</b>, the application unit <b>200</b> determines whether there are other pieces of connection state information. When there is another piece of connection state information (YES in step S<b>804</b>), the processing returns to step S<b>801</b>. When there is no connection state information (NO in step S<b>804</b>), the backup destination determination is ended.</p>
<p id="p-0098" num="0097">The threshold value can be arbitrarily determined as a selection criterion of a backup USB storage device. As an example, a partition size of the HDD <b>105</b> or a data size of data to be backed up can be set as a threshold value.</p>
<p id="p-0099" num="0098">In step S<b>802</b>, the application unit <b>200</b> compares the total capacity of the USB storage device with the threshold value. However, the application unit <b>200</b> can compare an amount of free capacity of the USB storage device with the threshold value.</p>
<p id="p-0100" num="0099">In the setting processing illustrated in <figref idref="DRAWINGS">FIG. 7</figref>, when there is a plurality of USB storage devices selected by the backup destination determination processing, no backup USB storage device is determined. This is to prevent selection of a USB storage device connected for a purpose other than backing-up as a backup USB storage device.</p>
<p id="p-0101" num="0100">Next, data backing-up is described. The data is backed up according to an instruction transmitted from the external apparatus via the LAN <b>111</b> or an instruction input via the operation unit <b>107</b>.</p>
<p id="p-0102" num="0101"><figref idref="DRAWINGS">FIG. 9</figref> illustrates an example of an operation screen for executing backing-up, which is displayed on the external apparatus or the operation unit <b>107</b>.</p>
<p id="p-0103" num="0102">An area <b>901</b> is for selecting backing-up of all document data stored in the data processing apparatus <b>100</b> or backing-up of a difference from that of a last time. An area <b>902</b> is for displaying a storage destination of backup data. An area <b>903</b> is for displaying a path to a folder of a backup destination. An area <b>904</b> is for displaying whether a backup executable state has been set. An execution button <b>905</b> is for instructing execution of backing-up.</p>
<p id="p-0104" num="0103"><figref idref="DRAWINGS">FIG. 10</figref> is a flowchart illustrating backup start processing. The CPU <b>102</b> realizes the backup starting processing by executing a program.</p>
<p id="p-0105" num="0104">In step S<b>1001</b>, when execution of backing-up is instructed, the application unit <b>200</b> checks connection of a backup destination according to the backup setting data and the backup destination identification information stored in the RAM <b>103</b>.</p>
<p id="p-0106" num="0105">In step S<b>1002</b>, the application unit <b>200</b> determines whether connection to the backup destination is permitted. When it is not permitted (NO in step S<b>1002</b>), in step S<b>1003</b>, the application unit <b>200</b> notifies an error to end the backup start processing.</p>
<p id="p-0107" num="0106">When connection to the backup destination is permitted (YES in step S<b>1002</b>), in step S<b>1004</b>, the application unit <b>200</b> acquires a remaining amount of capacity of the backup destination. In step S<b>1005</b>, the application unit <b>200</b> calculates an expected size of backup data.</p>
<p id="p-0108" num="0107">In step S<b>1006</b>, the application unit <b>200</b> compares the remaining amount of capacity acquired in step S<b>1004</b> with the data size calculated in step S<b>1005</b> to determine whether the backup data can be stored in the backup destination.</p>
<p id="p-0109" num="0108">When the backup data can be stored (YES in step S<b>1006</b>), in step S<b>1007</b>, the application unit <b>200</b> causes the backup processing unit <b>206</b> to execute backup processing. The back-up processing is described in detail below. When the backup data cannot be stored (NO in step S<b>1006</b>), in step S<b>1003</b>, the application unit <b>200</b> notifies an error.</p>
<p id="p-0110" num="0109"><figref idref="DRAWINGS">FIG. 11</figref> is a flowchart illustrating the back-up processing performed in step S<b>1007</b>. The CPU <b>102</b> realizes the backup processing by executing a program.</p>
<p id="p-0111" num="0110">In step S<b>1101</b>, the backup processing unit <b>206</b> acquires data to be backed up by a predetermined size. In step S<b>1102</b>, the backup processing unit <b>206</b> creates backup data.</p>
<p id="p-0112" num="0111">In step S<b>1103</b>, the backup processing unit <b>206</b> determines whether encryption of the backup data has been instructed. When encryption of the backup data has been instructed (YES in step S<b>1103</b>), in step S<b>1104</b>, the encryption unit <b>207</b> encrypts the backup data.</p>
<p id="p-0113" num="0112">In step S<b>1105</b>, the backup processing unit <b>206</b> stores the backup data in the backup destination. In step S<b>1106</b>, the backup processing unit <b>206</b> determines whether a remaining amount of capacity of the backup destination is short.</p>
<p id="p-0114" num="0113">When it is not short (NO in step S<b>1106</b>), in step S<b>1107</b>, the backup processing unit <b>206</b> determines where there is still data to be backed up. When there is still data to be backed up (YES in step S<b>1107</b>), the processing proceeds to step S<b>1101</b>. When there is no data to be backed up (NO in step S<b>1107</b>), the backup processing is ended.</p>
<p id="p-0115" num="0114">In step S<b>1008</b>, when the remaining amount of capacity of the backup destination becomes short during the backup processing, the backup processing unit <b>206</b> sets an unmount flag to end the backup processing.</p>
<p id="p-0116" num="0115">The unmount flag indicates that only a specific user can unmount the backup USB storage device. In this case, only the specific user can unmount the backup USB storage device. For example, a system administrator is the specific user.</p>
<p id="p-0117" num="0116">The backup processing is not necessarily executed by pressing the execution button <b>905</b>. The backup processing may be executed according to a schedule. Next, the backup processing executed according to the schedule is described.</p>
<p id="p-0118" num="0117"><figref idref="DRAWINGS">FIG. 12</figref> illustrates an example of a setting screen for setting a backup schedule, which is displayed on the external apparatus or the operation unit <b>107</b>.</p>
<p id="p-0119" num="0118">A check box <b>1201</b> is for instructing whether to back up all the document data stored in the data processing apparatus <b>100</b>. Hereinafter, backing-up of all the document data is referred to as &#x201c;all backing-up&#x201d;. When wishing all backing-up, the user checks the check box <b>1201</b>.</p>
<p id="p-0120" num="0119">An input area <b>1202</b> is for instructing, when all backing-up is executed every day, at what time all backing-up is executed every day.</p>
<p id="p-0121" num="0120">An input area <b>1203</b> is for instructing, when all backing-up is executed on a designated day of the week, at what time and on what day all backing-up is executed. The user inputs time to execute all backing-up in a section of a day of the week to execute all backing-up.</p>
<p id="p-0122" num="0121">A check box <b>1204</b> is for instructing whether to back up only a difference from a last time. Hereinafter, backing-up of only the difference from the last time is referred to as &#x201c;difference backing-up&#x201d;. When wishing to back up the difference, the user checks the check box <b>1204</b>.</p>
<p id="p-0123" num="0122">An input area <b>1205</b> is for instructing, when difference backing-up is executed every day, at what time difference backing-up is executed every day. The user inputs time to execute difference backing-up.</p>
<p id="p-0124" num="0123">An input area <b>1206</b> is for instructing, when difference backing-up is executed on a designated day of the week, at what time and on what day difference backing-up is executed. The user inputs time to execute difference backing-up in a section of a day of the week to execute difference backing-up.</p>
<p id="p-0125" num="0124">When the user presses an OK button <b>1207</b> on a setting screen displayed in the external apparatus, data set on the setting screen (referred to as schedule setting data) is transmitted from the external apparatus to the data processing apparatus <b>100</b> to be stored in the RAM <b>103</b>.</p>
<p id="p-0126" num="0125">When the user presses an OK button <b>1207</b> on a setting screen displayed in the operation unit <b>107</b>, data set on the setting screen (referred to as schedule setting data) is stored in the RAM <b>103</b>.</p>
<p id="p-0127" num="0126"><figref idref="DRAWINGS">FIG. 13</figref> is a flowchart illustrating scheduling processing of backing-up. The CPU <b>102</b> realizes the scheduling processing by executing a program.</p>
<p id="p-0128" num="0127">In step S<b>1301</b>, the application unit <b>200</b> acquires the schedule setting date from the RAM <b>103</b>. In step S<b>1302</b>, the application unit <b>200</b> acquires current time from a clock.</p>
<p id="p-0129" num="0128">The clock can be included in the data processing apparatus <b>100</b> or connected to the LAN <b>111</b>. When the clock is connected to the LAN <b>111</b>, the data processing apparatus <b>100</b> acquires current time from the clock via the LAN <b>111</b>.</p>
<p id="p-0130" num="0129">In step S<b>1303</b>, the application unit <b>200</b> compares the schedule setting data acquired in step S<b>1301</b> with the current time acquired in step S<b>1302</b> to determine whether time designated to execute all backing-up or difference backing-up matches the current time. When they are not matched (NO in step S<b>1303</b>), the processing returns to step S<b>1301</b>.</p>
<p id="p-0131" num="0130">When the designated time matches the current time (YES in step S<b>1303</b>), in step S<b>1304</b>, the application unit <b>200</b> executes backup start processing.</p>
<p id="p-0132" num="0131">Next, unmounting of the USB storage device is described. The unmounting is executed according to an instruction input via the operation unit <b>107</b>.</p>
<p id="p-0133" num="0132"><figref idref="DRAWINGS">FIG. 14</figref> illustrates an example of an operation screen for executing unmounting. An operation screen <b>1401</b> displays a list of USB storage devices connected to the data processing apparatus <b>100</b> and mounted. The list may include USB storage devices other than backup USB storage devices.</p>
<p id="p-0134" num="0133">When the user selects a USB storage device to be unmounted, and presses a &#x201c;remove&#x201d; button on the operation screen <b>1401</b>, unmounting processing of the selected USB storage device is executed. An operation screen <b>1402</b> is displayed when the unmounting is successful. On the operation screen <b>1402</b>, the USB storage device instructed to be unmounted has been deleted from the list.</p>
<p id="p-0135" num="0134"><figref idref="DRAWINGS">FIG. 15</figref> is a flowchart illustrating unmounting processing of the USB storage device. The CPU <b>102</b> realizes the unmounting processing by executing a program.</p>
<p id="p-0136" num="0135">In step S<b>1501</b>, when the USB storage detection unit <b>204</b> is instructed to execute unmounting, the USB storage detection unit <b>204</b> determines whether a USB storage device instructed to be unmounted is being accessed. When the device is being accessed (YES in step S<b>1501</b>), in step S<b>1506</b>, the application unit <b>200</b> notifies an unmounting failure via the operation unit <b>107</b>.</p>
<p id="p-0137" num="0136">When the device is not being accessed (NO in step S<b>1501</b>), in step S<b>1502</b>, the application unit <b>200</b> acquires connection state information of the USB storage device instructed to be unmounted from the USB storage state management unit <b>203</b>. In step S<b>1503</b>, the application unit <b>200</b> acquires the backup destination identification information stored in the RAM <b>103</b>.</p>
<p id="p-0138" num="0137">In step S<b>1504</b>, the application unit <b>200</b> compares the connection state information acquired in step S<b>1502</b> with the backup destination identification information acquired in step S<b>1503</b> to determine matching thereof.</p>
<p id="p-0139" num="0138">Non-matching means that the USB storage device instructed to be unmounted is not a backup USB storage device. Thus, when non-matching is determined (NO in step S<b>1504</b>), in step S<b>1507</b>, the application unit <b>200</b> unmounts the USB storage device selected by the user. The processing performed in step S<b>1507</b> is described in detail below.</p>
<p id="p-0140" num="0139">When matching is determined (YES in step S<b>1504</b>), in step S<b>1505</b>, the application unit <b>200</b> determines whether an unmount flag has been set. Setting of the unmount flag means that a remaining amount of capacity of the USB storage device becomes short during data backing-up. Hence, the USB storage device must be replaced.</p>
<p id="p-0141" num="0140">When it is determined that the unmount flag has been set (YES in step S<b>1505</b>), in step S<b>1507</b>, the application unit <b>200</b> unmounts the USB storage device selected by the user.</p>
<p id="p-0142" num="0141">When the connection state information acquired in step S<b>1502</b> matches the backup destination identification information acquired in step S<b>1503</b>, and no unmount flag has been set, it means that unmounting of the USB storage device designated as a backup destination has been instructed.</p>
<p id="p-0143" num="0142">Thus, in step S<b>1506</b>, the application unit <b>200</b> notifies an error indicating an unmounting failure via the operation unit <b>107</b>. It is because when the USB storage device designated as the backup destination is unmounted, backing-up is not appropriately executed.</p>
<p id="p-0144" num="0143"><figref idref="DRAWINGS">FIG. 16</figref> is a flowchart illustrating the unmounting processing performed in step S<b>1507</b>. The CPU <b>102</b> realizes the unmounting by executing a program.</p>
<p id="p-0145" num="0144">In step S<b>1601</b>, the USB storage detection unit <b>204</b> instructs the operating system <b>201</b> to unmount the USB storage device selected by the user. The operating system <b>201</b>, which has received the unmounting instruction, separates a device file allocated to the USB storage device from the mounting point of the file system.</p>
<p id="p-0146" num="0145">The file system of the USB storage device expanded in the layers below the mounting point is removed, and hence access to a file stored in the USB storage device is not possible.</p>
<p id="p-0147" num="0146">This unmounting processing enables physical separation of the USB storage device from the data processing apparatus <b>100</b> without damaging data stored in the USB storage device.</p>
<p id="p-0148" num="0147">In step S<b>1602</b>, the USB storage detection unit <b>204</b> determines whether the unmounting has been executed successfully. When it has been executed successfully (YES in step S<b>1602</b>), in step S<b>1603</b>, the unmounted USB storage state management unit <b>203</b> deletes the connection state information of the USB storage device from the table.</p>
<p id="p-0149" num="0148">The USB storage state notification unit <b>202</b> notifies the application unit <b>200</b> of the unmounting of the USB storage device selected by the user.</p>
<p id="p-0150" num="0149">In step S<b>1604</b>, the application unit <b>200</b> notifies the unmounting of the USB storage device via the operation unit <b>107</b>. For example, the operation screen <b>1402</b> illustrated in <figref idref="DRAWINGS">FIG. 14</figref> is displayed on the operation unit <b>107</b>.</p>
<p id="p-0151" num="0150">When the USB storage detection unit <b>204</b> determines that the unmounting has not been executed successfully (NO in step S<b>1602</b>), the USB storage state notification unit <b>202</b> notifies the application unit <b>200</b> of an unmounting failure. In step S<b>1605</b>, the application unit <b>200</b> notifies an error indicating the unmounting failure via the operation unit <b>107</b>.</p>
<p id="p-0152" num="0151"><figref idref="DRAWINGS">FIG. 17</figref> illustrates an example of a backup setting screen displayed when backup setting is canceled. The user cancels the backup setting by setting a storage destination of the backup data to &#x201c;do not set&#x201d;.</p>
<p id="p-0153" num="0152"><figref idref="DRAWINGS">FIG. 18</figref> is a flowchart illustrating cancellation processing of backup setting. The CPU <b>102</b> realizes the cancellation processing by executing a program.</p>
<p id="p-0154" num="0153">In step S<b>1801</b>, when the OK button is pressed in the state illustrated in <figref idref="DRAWINGS">FIG. 17</figref>, the application unit <b>200</b> determines whether backup destination identification information is stored in the RAM <b>103</b>. When it is stored (YES in step S<b>1801</b>), in step S<b>1802</b>, the application unit <b>200</b> deletes the backup destination identification information and the backup setting data from the RAM <b>103</b>.</p>
<p id="p-0155" num="0154">According to the above described exemplary embodiment, when the UBS storage device set as the backup destination is instructed to be unmounted, even during access to the USB storage device, unmounting of the USB storage device can be prevented. This can prevent backup failures.</p>
<p id="p-0156" num="0155">According to the above described exemplary embodiment, the USB storage device is set as the backup destination. However, other types of external memory units can be used.</p>
<p id="p-0157" num="0156">According to the above described embodiment, the backup destination identification information, the backup setting data, and the schedule setting data are stored in the RAM <b>103</b>. However, such data can be stored in the HDD <b>105</b>.</p>
<p id="p-0158" num="0157">According to the present invention, when the external memory unit is a data backup destination, an accessible state to the external memory unit is prevented from being canceled.</p>
<p id="p-0159" num="0158">According to the present invention, when the external memory unit is the data backup destination, even if the external memory unit is removed, the external memory unit can be recognized as the data backup destination.</p>
<p id="p-0160" num="0159">Therefore, the present invention can reduce data backup failures.</p>
<p id="p-0161" num="0160">Aspects of the present invention can also be realized by a computer of a system or apparatus (or devices such as a CPU or MPU) that reads out and executes a program recorded on a memory device to perform the functions of the above-described embodiments, and by a method, the steps of which are performed by a computer of a system or apparatus by, for example, reading out and executing a program recorded on a memory device to perform the functions of the above-described embodiments. For this purpose, the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device (e.g., computer-readable medium). In such a case, the system or apparatus, and the recording medium where the program is stored, are included as being within the scope of the present invention.</p>
<p id="p-0162" num="0161">While the present invention has been described with reference to exemplary embodiments, it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all modifications, equivalent structures, and functions.</p>
<p id="p-0163" num="0162">This application claims priority from Japanese Patent Application No. 2010-260527 filed Nov. 22, 2010, which is hereby incorporated by reference herein in its entirety.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A data processing apparatus configured to back up data in an external memory unit, comprising:
<claim-text>an access control unit configured to set an accessible state of the external memory unit;</claim-text>
<claim-text>a setting unit configured to set the external memory unit as a backup destination; and</claim-text>
<claim-text>a backup unit configured to backup data in the external memory unit set in the accessible state and as the backup destination,</claim-text>
<claim-text>wherein the access control unit is configured to not cancel the accessible state of the external memory unit set as the backup destination even when the accessible state of the external memory unit is instructed to be canceled and data is not being stored in the external memory unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. A data processing apparatus configured to back up data in an external memory unit, comprising:
<claim-text>an access control unit configured to set an accessible state of the external memory unit;</claim-text>
<claim-text>a setting unit configured to set the external memory unit as a backup destination; and</claim-text>
<claim-text>a backup unit configured to backup data in the external memory unit set in the accessible state and as the backup destination,</claim-text>
<claim-text>wherein the access control unit is configured to cancel the accessible state of the external memory unit if the accessible state of the external memory unit is instructed to be canceled, data is not being stored in the external memory unit and the external memory unit is not set as the backup destination, and to not cancel the accessible state of the external memory unit if the accessible state of the external memory unit is instructed to be canceled, data is not being stored in the external memory unit and the external memory unit is set as the backup destination.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The data processing apparatus according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising a determination unit configured to determine whether an amount of capacity of the external memory unit is equal to or larger than a threshold value,
<claim-text>wherein the setting unit is configured to set the external memory unit as the backup destination when the capacity of the external memory unit is equal to or larger than the threshold value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The data processing apparatus according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising a second setting unit configured to set, when the data is being backed up in the external memory unit set as the backup destination and the amount of capacity of the external memory unit becomes insufficient to store remaining data, a flag to enable cancellation of the accessible state of the external memory unit,
<claim-text>wherein the access control unit is configured, even when the external memory unit is set as the backup destination, to cancel the accessible state of the external memory unit if the flag has been set.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The data processing apparatus according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the access control unit is configured to set the accessible state by executing mounting of the external memory unit, and wherein the access control unit is configured to cancel the accessible state by executing unmounting of the external memory unit.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The data processing apparatus according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the external memory unit is a USB storage device.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A data processing apparatus configured to back up data in an external memory unit, comprising:
<claim-text>an access control unit configured to set an accessible state of the external memory unit;</claim-text>
<claim-text>a setting unit configured to set the external memory unit as a backup destination;</claim-text>
<claim-text>a backup unit configured to backup data in the external memory unit set in the accessible state and as the backup destination; and</claim-text>
<claim-text>a notification unit configured to notify removal of the external memory unit set as the backup destination and removal of an external memory unit not set as a backup destination by different methods.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. An access control method executed by a data processing apparatus that is configured to back up data in an external memory unit, comprising:
<claim-text>setting an accessible state of the external memory unit;</claim-text>
<claim-text>setting the external memory unit as a backup destination;</claim-text>
<claim-text>backing up data in the external memory unit set in the accessible state and as the backup destination; and</claim-text>
<claim-text>wherein when the accessible state of the external memory unit is instructed to be canceled and data is not being stored in the external memory unit, in the setting of the accessible state of the external memory unit, the accessible state of the external memory unit is canceled if the external memory unit is not set as the backup destination,</claim-text>
<claim-text>wherein even when the accessible state of the external memory unit is instructed to be canceled and data is not being stored in the external memory unit, in the setting of the accessible state of the external memory unit, the accessible state of the external memory unit is not canceled if the external memory unit is set as the backup destination.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. An access control method executed by a data processing apparatus that is configured to back up data in an external memory unit, comprising:
<claim-text>setting an accessible state of the external memory unit;</claim-text>
<claim-text>setting the external memory unit as a backup destination;</claim-text>
<claim-text>backing up data in the external memory unit set in the accessible state and as the backup destination; and</claim-text>
<claim-text>notifying removal of the external memory unit set as the backup destination and removal of an external memory unit not set as a backup destination by different methods.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A non-transitory storage medium for storing a program readable by a computer, the program causing the computer to:
<claim-text>set an accessible state of an external memory unit;</claim-text>
<claim-text>set the external memory unit as a backup destination;</claim-text>
<claim-text>back up data in the external memory unit set in the accessible state and as the backup destination;</claim-text>
<claim-text>wherein when the accessible state of the external memory unit is instructed to be canceled and data is not being stored in the external memory unit, in the setting of the accessible state of the external memory unit, the accessible state of the external memory unit is canceled if the external memory unit is not set as the backup destination, and</claim-text>
<claim-text>wherein even when the accessible state of the external memory unit is instructed to be canceled and data is not being stored in the external memory unit, the computer does not cancel the accessible state of the external memory unit if the external memory unit is set as the backup destination.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A non-transitory storage medium for storing a program readable by a computer, the program causing the computer to:
<claim-text>set an accessible state of an external memory unit;</claim-text>
<claim-text>set the external memory unit as a backup destination;</claim-text>
<claim-text>back up data in the external memory unit set in the accessible state and as the backup destination; and</claim-text>
<claim-text>notify removal of the external memory unit set as the backup destination and removal of the external memory unit not set as a backup destination by different methods. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
