<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625143-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625143</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12659054</doc-number>
<date>20100224</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2009-052300</doc-number>
<date>20090305</date>
</priority-claim>
<priority-claim sequence="02" kind="national">
<country>JP</country>
<doc-number>2009-273284</doc-number>
<date>20091201</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>871</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>1</main-group>
<subgroup>21</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>1</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>3</main-group>
<subgroup>12</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>11</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>12</main-group>
<subgroup>28</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>358  116</main-classification>
<further-classification>358296</further-classification>
<further-classification>358  19</further-classification>
<further-classification>358  115</further-classification>
<further-classification>358  113</further-classification>
<further-classification>370235</further-classification>
<further-classification>370412</further-classification>
<further-classification>370537</further-classification>
</classification-national>
<invention-title id="d2e90">Decoding device, method for controlling decoding device, and image forming apparatus</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>RE35657</doc-number>
<kind>E</kind>
<name>Buckley et al.</name>
<date>19971100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358296</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5815283</doc-number>
<kind>A</kind>
<name>Watanabe et al.</name>
<date>19980900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358296</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6011590</doc-number>
<kind>A</kind>
<name>Saukkonen</name>
<date>20000100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>37524005</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6429950</doc-number>
<kind>B1</kind>
<name>Ebner</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  19</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6674536</doc-number>
<kind>B2</kind>
<name>Long et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  115</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7580151</doc-number>
<kind>B2</kind>
<name>Kurose et al.</name>
<date>20090800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  19</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7821658</doc-number>
<kind>B2</kind>
<name>Hyodo et al.</name>
<date>20101000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  115</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2002/0057446</doc-number>
<kind>A1</kind>
<name>Long et al.</name>
<date>20020500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  113</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2002/0146023</doc-number>
<kind>A1</kind>
<name>Myers</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370412</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2003/0103225</doc-number>
<kind>A1</kind>
<name>Hyodo et al.</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  113</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2003/0123392</doc-number>
<kind>A1</kind>
<name>Ruutu et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370235</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>JP</country>
<doc-number>2000177189</doc-number>
<kind>A</kind>
<date>20000600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-cpc-text>B41J 5/30</classification-cpc-text>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>JP</country>
<doc-number>2005-096343</doc-number>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>JP</country>
<doc-number>3757587</doc-number>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>JP</country>
<doc-number>3797844</doc-number>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00016">
<othercit>English language abstract of JP 2001-251518, Sep. 14, 2001, Japan.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00017">
<othercit>English language abstract of JP 11-177831, Jul. 2, 1999, Japan.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>19</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>358448</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>358  19</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>358296</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>358464</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>358  115</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>345604</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>345549</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>345600</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>14</number-of-drawing-sheets>
<number-of-figures>18</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20100225969</doc-number>
<kind>A1</kind>
<date>20100909</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Sato</last-name>
<first-name>Ryuichi</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Sato</last-name>
<first-name>Ryuichi</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Harness, Dickey &#x26; Pierce</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Ricoh Company, Limited</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Sarpong</last-name>
<first-name>Akwasi M</first-name>
<department>2675</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A decoding device checks whether there is free space in each of channel-by-channel buffers, specifies a channel corresponding to a buffer having free space as an input channel for receiving an input of compressed data, analyzes codes of the compressed data received through the input channel, and detects a delimit position in the compressed data on the basis of a result of the analysis. The decoding device expands the compressed data received through the input channel, and sorts the expanded data so as to be stored in the buffer corresponding to the input channel. The decoding device cancels specification of the input channel in accordance with detection of the delimit position, and checks whether there is free space in each of the channel-by-channel buffers, and then specifies a channel corresponding to a buffer having free space as a next input channel.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="79.33mm" wi="190.50mm" file="US08625143-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="272.20mm" wi="206.16mm" orientation="landscape" file="US08625143-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="256.79mm" wi="188.47mm" orientation="landscape" file="US08625143-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="158.41mm" wi="186.18mm" file="US08625143-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="261.28mm" wi="168.99mm" orientation="landscape" file="US08625143-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="262.55mm" wi="192.53mm" file="US08625143-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="264.16mm" wi="195.41mm" file="US08625143-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="231.14mm" wi="190.58mm" file="US08625143-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="271.27mm" wi="194.56mm" file="US08625143-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="162.22mm" wi="192.53mm" file="US08625143-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="194.39mm" wi="187.71mm" file="US08625143-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="121.50mm" wi="171.03mm" file="US08625143-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="265.43mm" wi="204.89mm" orientation="landscape" file="US08625143-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="265.09mm" wi="132.84mm" orientation="landscape" file="US08625143-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="262.38mm" wi="193.46mm" file="US08625143-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">The present application claims priority to and incorporates by reference the entire contents of Japanese Patent Application No. 2009-052300 filed in Japan on Mar. 5, 2009 and Japanese Patent Application No. 2009-273284 filed in Japan on Dec. 1, 2009.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">1. Field of the Invention</p>
<p id="p-0004" num="0003">The present invention relates to a decoding device, a method for controlling the decoding device, and an image forming apparatus.</p>
<p id="p-0005" num="0004">2. Description of the Related Art</p>
<p id="p-0006" num="0005">Conventionally, an image forming apparatus, such as an ink-jet printer or a laser printer, usually performs a compression process on data for forming an image on a recording medium such as paper (hereinafter, referred to as a &#x201c;sheet&#x201d;) because the data is tens to hundreds of megabytes in size. Therefore, at the time of image formation, the image forming apparatus needs to sequentially expand the compressed data and output this expanded data to a recording head or the like.</p>
<p id="p-0007" num="0006">In the case of color printing, compressed data input through multiple channels needs to be expanded with respect to each color. The following are known as conventional technologies for expanding compressed data input through multiple channels in a time-sharing manner: Japanese Patent Application Laid-open No. 2005-96343 and Japanese Patent Application Laid-open No. H11-177831. In the technology disclosed in Japanese Patent Application Laid-open No. 2005-96343, compressed data input through multiple channels is expanded in a time-sharing manner by the use of one expansion unit and channel-specific buffers. In the technology disclosed in Japanese Patent Application Laid-open No. H11-177831, dummy data is added to data before being compressed, and, at the time of expansion, the dummy data is thrown away after being read; thus, large-capacity buffers are not required for synchronizing the time to output expanded data expanded in a time-sharing manner.</p>
<p id="p-0008" num="0007">However, in the above conventional technologies, it is necessary to provide a large-capacity buffer capable of storing expanded data obtained by expanding compressed data input through the corresponding channel. Furthermore, the addition of dummy data to data before being compressed leads to a decrease in the compression efficiency of the compressed data.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0009" num="0008">It is an object of the present invention to at least partially solve the problems in the conventional technology.</p>
<p id="p-0010" num="0009">According to an aspect of the present invention, there is provided a decoding device that includes a plurality of buffers that are provided to correspond to a plurality of channels and store expanded data on a channel-by-channel basis; a plurality of input units that are provided to correspond to the channels and receive inputs of encoded compressed data on a channel-by-channel basis; a specifying unit configured to check whether there is free space in each of the buffers, and specify a channel corresponding to a buffer having free space as an input channel through which the input unit corresponding to the input channel receives the input of the expanded data; a detecting unit configured to analyze codes of the compressed data received through the input channel, and detect a delimit position in the compressed data on the basis of a result of the analysis; an expanding unit that expands the compressed data received through the input channel; and a sorting unit that sorts expanded data expanded by the expanding unit so as to be stored in the buffer corresponding to the input channel. The specifying unit is further configured to cancel specification of the input channel in accordance with detection of the delimit position, and check whether there is free space in each of the buffers, and then specify a channel corresponding to a buffer having free space as a next input channel.</p>
<p id="p-0011" num="0010">According to another aspect of the present invention, there is provided a decoding device that includes a plurality of buffers that are provided to correspond to a plurality of channels and store expanded data on a channel-by-channel basis; a plurality of input units that are provided to correspond to the channels and receive inputs of encoded compressed data on a channel-by-channel basis; a specifying unit configured to check whether there is free space in each of the buffers, and specify a channel corresponding to a buffer having free space as an input channel through which the input unit corresponding to the input channel receives the input of the expand data; an expanding unit that expands the compressed data received through the input channel; a counting unit that counts a data length of expanded data expanded by the expanding unit; and a sorting unit that sorts expanded data expanded by the expanding unit so as to be stored in the buffer corresponding to the input channel. The specifying unit is further configured to cancel specification of the input channel when the data length counted by the counting unit is a predetermined data length, and check whether there is free space in each of the buffers, and then specify a channel corresponding to a buffer having free space as a next input channel.</p>
<p id="p-0012" num="0011">According to still another aspect of the present invention, there is provided a method of controlling a decoding device including a plurality of buffers that are provided to correspond to a plurality of channels and store expanded data on a channel-by-channel basis. The method includes receiving inputs of encoded compressed data on a channel-by-channel basis; checking whether there is free space in each of the buffers to specify a channel corresponding to a buffer having free space as an input channel through which the input unit corresponding to the input channel receives the input of the expanded data; analyzing codes of the compressed data received through the input channel to detect a delimit position in the compressed data on the basis of a result of the analysis; expanding the compressed data received through the input channel; and sorting expanded data expanded at the expanding so as to be stored in the buffer corresponding to the input channel. At the specifying, specification of the input channel is cancelled in accordance with detection of the delimit position, and whether there is free space in each of the buffers is checked, and then a channel corresponding to a buffer having free space is specified as a next input channel.</p>
<p id="p-0013" num="0012">The above and other objects, features, advantages and technical and industrial significance of this invention will be better understood by reading the following detailed description of presently preferred embodiments of the invention, when considered in connection with the accompanying drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic side view for explaining the entire configuration of a mechanical part of an image forming apparatus according to a first embodiment;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic plan view for explaining the entire configuration of the image forming apparatus according to the first embodiment;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram illustrating a nozzle face of a recording head according to the first embodiment;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram schematically illustrating a functional configuration of the image forming apparatus according to the first embodiment;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 5</figref> is a timing chart showing an available period of data for respective colors to be output to the recording head;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram schematically illustrating internal configurations of an expanding unit and an image-data output unit;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 7</figref> is a diagram showing a virtual code correspondence table;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 8</figref> is a block diagram illustrating the simplified internal configuration of the expanding unit;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 9</figref> is a flowchart illustrating the operation of a channel specifying unit;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 10</figref> is a flowchart illustrating the operation of a code analyzing unit;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 11</figref> is a flowchart illustrating the operation of a sorting unit;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 12</figref> is a block diagram illustrating an internal configuration of an expanding unit according to a modification;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 13</figref> is a schematic side view for explaining the entire configuration of an image forming apparatus according to a second embodiment;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 14</figref> is a block diagram illustrating an example of the internal configuration of the expanding unit;</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 15</figref> is a diagram showing an example of a timing chart of the expanding unit;</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 16</figref> is a diagram showing another example of the timing chart of the expanding unit;</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 17</figref> is a diagram showing still another example of the timing chart of the expanding unit; and</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 18</figref> is a flowchart illustrating the operation of a channel specifying unit according to a second modification.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0032" num="0031">Exemplary embodiments of an image forming apparatus according to the present invention are explained in detail below with reference to the accompanying drawings.</p>
<p id="p-0033" num="0032">First Embodiment</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic side view for explaining the entire configuration of a mechanical part of an image forming apparatus <b>1</b> according to a first embodiment, and <figref idref="DRAWINGS">FIG. 2</figref> is a schematic plan view for explaining the entire configuration of the image forming apparatus <b>1</b> according to the first embodiment. <figref idref="DRAWINGS">FIG. 3</figref> is a diagram illustrating a nozzle face of a recording head <b>34</b>. First, the mechanical part of the image forming apparatus <b>1</b> is explained with reference to <figref idref="DRAWINGS">FIGS. 1 to 3</figref>.</p>
<p id="p-0035" num="0034">As shown in <figref idref="DRAWINGS">FIGS. 1 and 2</figref>, the image forming apparatus <b>1</b> holds a carriage <b>33</b> with a guide rod <b>31</b>, which is a guide member laterally lying between right and left side plates <b>21</b>A and <b>21</b>B making up a frame <b>21</b>, and a stay <b>32</b> so that the carriage <b>33</b> can slide in a main scanning direction. The carriage <b>33</b> scans while moving in a direction of arrow shown in <figref idref="DRAWINGS">FIG. 2</figref> (a carriage main-scanning direction) via a timing belt (not shown) driven by a main-scanning motor (not shown).</p>
<p id="p-0036" num="0035">The carriage <b>33</b> is provided with the recording head <b>34</b> made up of four droplet discharge heads for discharging droplets of ink in yellow (Y), cyan (C), magenta (M), and black (Bk), respectively, so that a plurality of ink discharge openings (hereinafter, referred to as &#x201c;nozzles&#x201d;) are arranged in a direction of crossing the main scanning direction and a direction of discharging droplets of ink is directed downward.</p>
<p id="p-0037" num="0036">Specifically, as shown in <figref idref="DRAWINGS">FIG. 3</figref>, a nozzle face <b>134</b><i>a </i>of the recording head <b>34</b> on which a plurality of nozzles <b>134</b><i>n </i>are formed is directed downward. On the nozzle face <b>134</b><i>a</i>, four lines of nozzles <b>134</b><i>k</i>, <b>134</b><i>c</i>, <b>134</b><i>m</i>, and <b>134</b><i>y </i>(hereinafter, referred to as a &#x201c;nozzle line <b>134</b>N&#x201d; unless otherwise distinguished), which are each made up of a plurality of the nozzles <b>134</b><i>n</i>, are formed.</p>
<p id="p-0038" num="0037">As an ink jet head making up the recording head <b>34</b>, ones including a piezoelectric actuator such as a piezoelectric element, a thermal actuator using a change of phase due to film boiling of liquid using an electrothermal conversion element such as a heat element, a shape-memory-alloy actuator using a change of metallic phase due to temperature change, an electrostatic actuator using an electrostatic force, and the like as a pressure generating means for generating pressure for discharging droplets of ink can be used.</p>
<p id="p-0039" num="0038">In the present embodiment, all the nozzles can be driven at the same time, and the nozzles can be driven in a time-sharing manner. When all the nozzles are driven at the same time, it may create disadvantages, such as a decrease in recording quality due to the influence of crosstalk between the nozzles or a high-capacity power source because high current is temporarily required; however, the disadvantages can be avoided by driving the nozzles in a time-sharing manner.</p>
<p id="p-0040" num="0039">The recording head <b>34</b> is equipped with a driver IC (not shown). The driver IC controls the generation of pressure for discharging droplets of ink. The driver IC is connected to a printer controller (to be described in detail later) via a harness (a flexible printed cable) <b>22</b>.</p>
<p id="p-0041" num="0040">The carriage <b>33</b> is equipped with sub-tanks <b>35</b> for supplying Y, C, M, and Bk color ink, respectively, to the recording head <b>34</b>. The sub-tanks <b>35</b> are each supplemented/supplied with respective color ink from corresponding ink cartridges <b>10</b> (specifically, ink cartridges <b>10</b><i>k</i>, <b>10</b><i>c</i>, <b>10</b><i>m</i>, and <b>10</b><i>y</i>) mounted on a cartridge loading unit <b>4</b> via respective color ink supply tubes <b>36</b>. Incidentally, the cartridge loading unit <b>4</b> is provided with a supply pump unit <b>24</b> for feeding ink into the ink cartridges <b>10</b>. Furthermore, the ink supply tubes <b>36</b> are held on a back plate <b>21</b>C making up the frame <b>21</b> with a locking member <b>25</b> in the middle of installation.</p>
<p id="p-0042" num="0041">As shown in <figref idref="DRAWINGS">FIG. 1</figref>, the image forming apparatus <b>1</b> includes, as a sheet feed unit for feeding sheets <b>42</b> stacked on a sheet stack unit (a pressure plate) <b>41</b> of a sheet feed tray <b>2</b>, a half-moon roller (a sheet feed roller) <b>43</b>, which feeds the sheet <b>42</b> one by one from the sheet stack unit <b>41</b> by separating the sheets <b>42</b> from one another, and a separation pad <b>44</b>, which is opposed to the sheet feed roller <b>43</b> and made of a material having a high friction coefficient; the separation pad <b>44</b> is biased on the side of the sheet feed roller <b>43</b>. Incidentally, the sheet <b>42</b> is a recording medium for forming an image thereon, and a type of the sheet <b>42</b> is not specifically limited; for example, any of recycled paper, high-quality paper, plain paper, a postcard, an envelope, heavy paper, an OHP sheet, and the like can be used as the sheet <b>42</b>.</p>
<p id="p-0043" num="0042">To feed the sheet <b>42</b> fed from the sheet feed unit to the lower side of the recording head <b>34</b>, the image forming apparatus <b>1</b> includes a guide member <b>45</b> for guiding the sheet <b>42</b>, a counter roller <b>46</b>, a conveyance guide member <b>47</b>, and a pressing member <b>48</b> having a leading-end pressure roller <b>49</b>; furthermore, the image forming apparatus <b>1</b> includes a conveyance belt <b>51</b> as a conveyance means for conveying the fed sheet <b>42</b> to the position opposed to the recording head <b>34</b> while attracting the sheet <b>42</b> thereto by a force of electrostatic attraction.</p>
<p id="p-0044" num="0043">The conveyance belt <b>51</b> is an endless belt, and is configured to be hung between a conveyance roller <b>52</b> and a tension roller <b>53</b> to endlessly move in a belt conveying direction (a sub-scanning direction). The conveyance belt <b>51</b> has a surface layer on the sheet attraction side and a back layer (a medium-resistive layer, a ground layer); the surface layer is formed of, for example, a pure resin material that is not subjected to resistance control and has a thickness of about 40 &#x3bc;m, such as an ETFE pure material; the back layer is formed of the same material as the surface layer and subjected to resistance control using carbon.</p>
<p id="p-0045" num="0044">Then, the image forming apparatus <b>1</b> includes a charging roller <b>56</b> as a charging means for charging the surface of the conveyance belt <b>51</b>. The charging roller <b>56</b> is arranged to come in contact with the surface layer of the conveyance belt <b>51</b> so as to rotate in accordance with the movement of the conveyance belt <b>51</b>, and a predetermined pressing force as a pressure force is applied to both ends of a shaft of the charging roller <b>56</b>. Incidentally, the conveyance roller <b>52</b> also serves as a ground roller, and is arranged to come in contact with the medium-resistive layer (the back layer) of the conveyance belt <b>51</b> so as to be grounded.</p>
<p id="p-0046" num="0045">On the underside of the conveyance belt <b>51</b>, a guide member <b>57</b> is arranged so as to correspond to a printing area of the recording head <b>34</b>. Since the guide member <b>57</b> is provided so that a top surface of which projects from the tangent of two rollers supporting the conveyance belt <b>51</b> (the conveyance roller <b>52</b> and the tension roller <b>53</b>) to the side of the recording head <b>34</b>, the highly-accurate flatness of the conveyance belt <b>51</b> is maintained.</p>
<p id="p-0047" num="0046">The conveyance roller <b>52</b> is driven to rotate by a sub-scanning motor (not shown), which leads the conveyance belt <b>51</b> to move in the belt conveying direction (the sub-scanning direction) shown in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0048" num="0047">The image forming apparatus <b>1</b> includes, as a sheet discharge unit for discharging the sheet <b>42</b> recorded by the recording head <b>34</b>, a separation claw <b>61</b> for separating the sheet <b>42</b> from the conveyance belt <b>51</b> and sheet discharge rollers <b>62</b> and <b>63</b>, and includes a copy receiving tray <b>3</b> below the sheet discharge roller <b>62</b>. The height of the copy receiving tray <b>3</b> is set to keep some distance from the position between the sheet discharge rollers <b>62</b> and <b>63</b> so that a volume of sheets stacked on the copy receiving tray <b>3</b> is ensured.</p>
<p id="p-0049" num="0048">A duplex unit <b>71</b> is removably attached to the back side of the image forming apparatus <b>1</b>. The duplex unit <b>71</b> takes therein the sheet <b>42</b> turned back by reverse movement of the conveyance belt <b>51</b> to invert the sheet <b>42</b>, and again feeds the inverted sheet <b>42</b> to between the counter roller <b>46</b> and the conveyance belt <b>51</b>. A top surface of the duplex unit <b>71</b> serves as a manual sheet feed tray <b>72</b>.</p>
<p id="p-0050" num="0049">As shown in <figref idref="DRAWINGS">FIG. 2</figref>, on the one side of a non-printing area in a scanning direction of the carriage <b>33</b>, a maintenance/restoration mechanism <b>81</b> including a restoration means for maintaining and restoring a state of the nozzles of the recording head <b>34</b> is arranged. The maintenance/restoration mechanism <b>81</b> is provided with cap members (hereinafter, referred to as &#x201c;caps&#x201d;) <b>82</b><i>a </i>to <b>82</b><i>d </i>(referred to as a &#x201c;cap <b>82</b>&#x201d; unless otherwise distinguished) for capping the nozzle face of the recording head <b>34</b>, a wiper blade <b>83</b> which is a blade member for wiping the nozzle face, a preliminary discharge receiver <b>84</b> for receiving droplets of ink at the time of preliminary discharge in which droplets of ink that do not contribute to recording are discharged so as to discharge ink having increased viscosity. Here, the cap <b>82</b><i>a </i>is used as a cap for suction and humidity retention, and the other caps are used as caps for humidity retention.</p>
<p id="p-0051" num="0050">Ink drainage generated by maintenance/restoration operation by the maintenance/restoration mechanism <b>81</b>, ink discharged to the cap <b>82</b>, ink that is attached to the wiper blade <b>83</b> and removed by a wiper cleaner, or ink preliminarily discharged into the preliminary discharge receiver <b>84</b> is discharged and kept in a drainage tank (not shown).</p>
<p id="p-0052" num="0051">Furthermore, as shown in <figref idref="DRAWINGS">FIG. 2</figref>, on the other side of the non-printing area in the scanning direction of the carriage <b>33</b>, a preliminary discharge receiver <b>88</b> for receiving droplets of ink at the time of preliminary discharge in which droplets of ink that do not contribute to recording are discharged so as to discharge ink that increases in viscosity during the recording or the like is arranged; the preliminary discharge receiver <b>88</b> is provided with apertures <b>89</b>, which are aligned along the nozzle line of the recording head <b>34</b>, and the like.</p>
<p id="p-0053" num="0052">On the back side of inside the image forming apparatus <b>1</b>, a communication circuit unit (an interface), such as a USB, for transmitting and receiving data between the image forming apparatus <b>1</b> and a host is provided, and a control circuit board making up the printer controller that controls the entire image forming apparatus is also provided.</p>
<p id="p-0054" num="0053">In the image forming apparatus <b>1</b> configured as described above, the sheet <b>42</b> is fed from the sheet feed tray <b>2</b> one by one by separating the sheets <b>42</b> from one another; the sheet <b>42</b> fed substantially vertically upward is guided by the guide member <b>45</b>, and conveyed while being sandwiched between the conveyance belt <b>51</b> and the counter roller <b>46</b>. Then, the leading end of the conveyed sheet <b>42</b> is guided by the conveyance guide member <b>47</b>, and pressed against the conveyance belt <b>51</b> by the leading-end pressure roller <b>49</b>, and the conveying direction of the sheet <b>42</b> is changed by about 90&#xb0;.</p>
<p id="p-0055" num="0054">At this time, the printer controller controls an AC bias supply unit to repeat a positive output and a negative output alternately, i.e., to apply an alternating voltage to the charging roller <b>56</b>, and the conveyance belt <b>51</b> is charged in an alternating charged voltage pattern, i.e., charged with a positive current and a negative current alternately in a certain width in the sub-scanning direction, i.e., the moving direction like a band. When the sheet <b>42</b> is fed onto the conveyance belt <b>51</b> charged with the positive current and negative current alternately, the sheet <b>42</b> is attracted to the conveyance belt <b>51</b>, and conveyed in the sub-scanning direction in accordance with the movement of the conveyance belt <b>51</b>.</p>
<p id="p-0056" num="0055">While moving the carriage <b>33</b>, the recording head <b>34</b> is driven depending on an image signal, and discharges droplets of ink to the sheet <b>42</b> being at a stop and records an image for one line on the sheet <b>42</b>; after the sheet <b>42</b> is conveyed for a predetermined distance, recording of an image for a next line is performed. When receipt of a recording complete signal or a signal indicating that the trailing end of the sheet <b>42</b> reaches a recording area, the recording operation is terminated, and the sheet <b>42</b> is discharged onto the copy receiving tray <b>3</b>.</p>
<p id="p-0057" num="0056">While waiting for printing (recording), the carriage <b>33</b> is moved to the side of the maintenance/restoration mechanism <b>81</b>, and the recording head <b>34</b> is capped by the cap <b>82</b> to keep the nozzles in a moist condition; thus, a discharge trouble due to the dryness of ink is prevented. Furthermore, a restoration operation to discharge ink that increases in viscosity and air bubbles is performed in such a manner that ink is suctioned from the nozzles by a suction pump (not shown) (referred to as &#x201c;nozzle suctioning&#x201d; or &#x201c;head suctioning&#x201d;) in a state where the recording head <b>34</b> is capped by the cap <b>82</b>. Moreover, a preliminary discharge operation to discharge ink that is not related to the recording is performed before the start of recording and during the recording or the like. By this operation, the consistent discharge performance of the recording head <b>34</b> is maintained.</p>
<p id="p-0058" num="0057">Subsequently, a functional configuration of the image forming apparatus <b>1</b> is explained with reference to <figref idref="DRAWINGS">FIG. 4</figref>. <figref idref="DRAWINGS">FIG. 4</figref> is a block diagram schematically illustrating the functional configuration of the image forming apparatus <b>1</b>.</p>
<p id="p-0059" num="0058">As shown in <figref idref="DRAWINGS">FIG. 4</figref>, the image forming apparatus <b>1</b> includes a printer controller <b>100</b>, which controls the overall operation of the image forming apparatus <b>1</b>, and a motor/sensor unit <b>105</b>, which performs the driving of the recording head <b>34</b> and the conveyance of the sheet <b>42</b> as described above and also performs the position detection and the like. The printer controller <b>100</b> includes a data input unit <b>101</b>, a CPU <b>102</b>, an image processing unit <b>103</b>, an engine control unit <b>104</b>, a memory <b>106</b>, a memory controller <b>107</b>, a compressing unit <b>108</b>, an expanding unit <b>109</b>, and an image-data output unit <b>110</b>. In the printer controller <b>100</b>, the above units are connected to one another via a bus <b>111</b>.</p>
<p id="p-0060" num="0059">The data input unit <b>101</b> is an interface for receiving input data from an external device <b>200</b>, such as a PC (Personal Computer), under the control of the CPU <b>102</b>. Specifically, the data input unit <b>101</b> can be a USB (Universal Serial Bus), a Centronics interface, the IEEE (Institute of Electrical and Electronic Engineers) 1284, an Ethernet (trademark) interface, or the like.</p>
<p id="p-0061" num="0060">The CPU <b>102</b> (Central Processing Unit) centrally controls the operation of the image forming apparatus <b>1</b>. Specifically, the CPU <b>102</b> develops programs stored in a ROM (Read Only Memory) or the like in a RAM (Random Access Memory) or a work area of the memory <b>106</b>, and sequentially executes the programs thereby outputting control signals to the units of the image forming apparatus <b>1</b>.</p>
<p id="p-0062" num="0061">The image processing unit <b>103</b> performs predetermined image processing on input image data under the control of the CPU <b>102</b>. Specifically, the image processing unit <b>103</b> performs image transformation, such as rotation or enlargement/reduction, and color conversion from RGB (red, green, blue) to CMYK (cyan, magenta, yellow, black) (or vice versa) by reference to a color profile or the like.</p>
<p id="p-0063" num="0062">Furthermore, the image processing unit <b>103</b> converts print data written in printer language (for example, page-description language (PDL), PCL, PostScript (PS), etc.) into directly-printable raster data. The raster data converted by the image processing unit <b>103</b> is subjected to data compression by being encoded by the compressing unit <b>108</b>, and then stored in the memory <b>106</b>. For example, when data input from the external device <b>200</b> or the like is print data, the print data is converted into raster data by the image processing unit <b>103</b>, and encoded by the compressing unit <b>108</b>, and then stored in the memory <b>106</b>.</p>
<p id="p-0064" num="0063">The engine control unit <b>104</b> outputs a control signal to the motor/sensor unit <b>105</b> under the control of the CPU <b>102</b>, thereby controlling the driving of the recording head <b>34</b> or the conveyance of the sheet <b>42</b>.</p>
<p id="p-0065" num="0064">The memory <b>106</b> is an HDD (Hard Disk Drive), a semiconductor memory, or the like, and stores therein predetermined data under the control of the memory controller <b>107</b>. As data stored in the memory <b>106</b>, there are data input from the external device <b>200</b> (print data), data compressed by being encoded by the compressing unit <b>108</b>, and the like. A portion of a storage area of the memory <b>106</b> can be used as a work area of the CPU <b>102</b>. The memory controller <b>107</b> performs storage of data in the memory <b>106</b> and readout of data stored in the memory <b>106</b> under the control of the CPU <b>102</b>.</p>
<p id="p-0066" num="0065">The compressing unit <b>108</b> encodes the input raster data for the respective colors (C, M, Y, and Bk) by a predetermined encoding method under the control of the CPU <b>102</b>, thereby compressing the raster data. The compressed data for each color is stored in the memory <b>106</b>. Under the control of the CPU <b>102</b>, the expanding unit <b>109</b> sequentially reads out the compressed data for each color stored in the memory <b>106</b>, and expands the compressed data in a time-sharing manner, and then outputs the expanded data to the image-data output unit <b>110</b>.</p>
<p id="p-0067" num="0066">Under the control of the CPU <b>102</b>, the image-data output unit <b>110</b> processes the raster data input from the expanding unit <b>109</b> as needed, for example, rearranges the order of the data in accordance with the driving of the recording head <b>34</b>, and then outputs the data to the recording head <b>34</b>. As described above, after compressed data for each color stored in the memory <b>106</b> is expanded in a time-sharing manner by the expanding unit <b>109</b>, the expanded data is output to the recording head <b>34</b> via the image-data output unit <b>110</b> without being again written on the memory <b>106</b> (i.e., on-the-fly).</p>
<p id="p-0068" num="0067"><figref idref="DRAWINGS">FIG. 5</figref> is a timing chart showing an available period of data (raster data) for each color to be output to the recording head <b>34</b>. As described above, the nozzle lines of the recording head <b>34</b> differ in physical location on the nozzle face <b>134</b><i>a </i>from one another. Therefore, to discharge droplets of ink to the same position on the sheet, it is necessary to vary output timing among raster data as shown in <figref idref="DRAWINGS">FIG. 5</figref> under the control of the CPU <b>102</b>. Furthermore, an effective area on the sheet may be different by color, and also ink in specific color (magenta in a case of the chart) may be not used depending on an image to be formed. In such cases, data transfer is not performed. Thus, timings at which the expanding unit <b>109</b> shown in <figref idref="DRAWINGS">FIG. 4</figref> expands the data with respect to each color are not the same, and also the data is not always expanded with respect to all the four colors.</p>
<p id="p-0069" num="0068">Here, the expanding unit <b>109</b> and the image-data output unit <b>110</b> are explained in detail. <figref idref="DRAWINGS">FIG. 6</figref> is a block diagram schematically illustrating internal configurations of the expanding unit <b>109</b> and the image-data output unit <b>110</b>. As shown in <figref idref="DRAWINGS">FIG. 6</figref>, the expanding unit <b>109</b> includes a controller <b>201</b>, data input units <b>202</b>K, <b>202</b>C, <b>202</b>M, and <b>202</b>Y, a channel specifying unit <b>203</b>, a code analyzing unit <b>204</b>, an expansion processing unit <b>205</b>, a sorting unit <b>206</b>, and data output I/Fs <b>207</b>K, <b>207</b>C, <b>207</b>M, and <b>207</b>Y. The image-data output unit <b>110</b> includes buffers <b>208</b>K, <b>208</b>C, <b>208</b>M, and <b>208</b>Y.</p>
<p id="p-0070" num="0069">The controller <b>201</b> controls the operation of each unit in the expanding unit <b>109</b> under the control of the CPU <b>102</b>. The data input units <b>202</b>K, <b>202</b>C, <b>202</b>M, and <b>202</b>Y read out compressed data for their respective colors (Bk, C, M, and Y) from the memory <b>106</b>, and input the read compressed data to the code analyzing unit <b>204</b>. Specifically, the data input unit <b>202</b>K inputs compressed Bk-color image data to the code analyzing unit <b>204</b>; the data input unit <b>202</b>C inputs compressed C-color image data to the code analyzing unit <b>204</b>; the data input unit <b>202</b>M inputs compressed M-color image data to the code analyzing unit <b>204</b>; the data input unit <b>202</b>Y inputs compressed Y-color image data to the code analyzing unit <b>204</b>.</p>
<p id="p-0071" num="0070">The channel specifying unit <b>203</b> specifies a channel (an input channel) through which the code analyzing unit <b>204</b> receives data from any of the data input units <b>202</b>K, <b>202</b>C, <b>202</b>M, and <b>202</b>Y and a channel (an output channel) through which the sorting unit <b>206</b> outputs data to any of the data output I/Fs <b>207</b>K, <b>207</b>C, <b>207</b>M, and <b>207</b>Y after the expansion processing unit <b>205</b> expands the data on the basis of a result of analysis of compressed data by the code analyzing unit <b>204</b>.</p>
<p id="p-0072" num="0071">The code analyzing unit <b>204</b> analyzes compressed data input from the data input units <b>202</b>K, <b>202</b>C, <b>202</b>M, and <b>202</b>Y, and detects a delimit position in the compressed data (the detection of delimit position will be described in detail later), and then outputs a result of the detection as a result of analysis to the channel specifying unit <b>203</b>. Furthermore, the code analyzing unit <b>204</b> inputs compressed data with respect to the channel (i.e., color) specified by the channel specifying unit <b>203</b> from the data input units <b>202</b>K, <b>202</b>C, <b>202</b>M, and <b>202</b>Y to the expansion processing unit <b>205</b>. The expansion processing unit <b>205</b> expands the received compressed data, and inputs the expanded data to the sorting unit <b>206</b>.</p>
<p id="p-0073" num="0072">The sorting unit <b>206</b> inputs the expanded data received from the expansion processing unit <b>205</b> to the channel (color) specified from the data output I/Fs <b>207</b>K, <b>207</b>C, <b>207</b>M, and <b>207</b>Y by the channel specifying unit <b>203</b>. The data output I/Fs <b>207</b>K, <b>207</b>C, <b>207</b>M, and <b>207</b>Y store the expanded data for respective colors in the buffers <b>208</b>K, <b>208</b>C, <b>208</b>M, and <b>208</b>Y, respectively.</p>
<p id="p-0074" num="0073">Specifically, the data output I/F <b>207</b>K stores expanded Bk-color image data in the buffer <b>208</b>K; the data output I/F <b>207</b>C stores expanded C-color image data in the buffer <b>208</b>C; the data output I/F <b>207</b>M stores expanded M-color image data in the buffer <b>208</b>M; the data output I/F <b>207</b>Y stores expanded Y-color image data in the buffer <b>208</b>Y. The buffers <b>208</b>K, <b>208</b>C, <b>208</b>M, and <b>208</b>Y each output the stored data to the recording head <b>34</b> at a predetermined timing under the control of the CPU <b>102</b>.</p>
<p id="p-0075" num="0074">Conventionally, to expand compressed data with respect to the respective colors (C, M, Y, and Bk) whose output timings are different from one another as shown in <figref idref="DRAWINGS">FIG. 5</figref> at the same time, i.e., to expand compressed data input from the four channels, it is necessary to provide configurations for performing the expansion process corresponding to the number of input channels. Furthermore, when the compressed data input from the channels is sequentially expanded in a time-sharing manner, it is necessary to provide a large-capacity buffer for absorbing the difference in output timing of the data after being subjected to the expansion to a subsequent stage.</p>
<p id="p-0076" num="0075">In the present embodiment, as shown in <figref idref="DRAWINGS">FIG. 6</figref>, the expanding unit <b>109</b> includes the channel specifying unit <b>203</b>, the code analyzing unit <b>204</b>, and the sorting unit <b>206</b>. The above units in the expanding unit <b>109</b> perform respective processes to be described later, which causes the single expansion processing unit <b>205</b> to sequentially expand the compressed data input from the channels in a time-sharing manner. Thus, each of the buffers <b>208</b>K, <b>208</b>C, <b>208</b>M, and <b>208</b>Y of the image-data output unit <b>110</b> just has to be a buffer capable of storing data in size larger than the unit size of time-sharing expansion, and each of the channels need not to be provided with a large-capacity buffer capable of storing expanded data that all the compressed data is expanded.</p>
<p id="p-0077" num="0076">Furthermore, the buffers <b>208</b>K, <b>208</b>C, <b>208</b>M, and <b>208</b>Y of the image-data output unit <b>110</b> can be used for the following applications. Expanded data (raster data) obtained by expanding compressed data stored in the memory <b>106</b> is data of pixels aligned in the main scanning direction. On the other hand, the nozzles in the recording head <b>34</b> are aligned in the sub-scanning direction, so it is necessary to perform a process for rotating the raster data. To implement the rotation process by the CPU <b>102</b>, it is necessary to perform bitwise operation, so a processing load of the CPU <b>102</b> increases. Thus, in the image-data output unit <b>110</b>, the expansion processing unit <b>205</b> performs the rotation process for each certain amount of the raster data. The buffers <b>208</b>K, <b>208</b>C, <b>208</b>M, and <b>208</b>Y are used as a work area of the rotation process.</p>
<p id="p-0078" num="0077">For example, when the number of nozzles in the recording head <b>34</b> is 256, and the rotation process is performed every 32 bits, the size of data that the buffers <b>208</b>K, <b>208</b>C, <b>208</b>M, and <b>208</b>Y can store therein is 256&#xd7;32 =8192 (bits). To output data while storing the data in the buffers <b>208</b>K, <b>208</b>C, <b>208</b>M, and <b>208</b>Y, a buffer capable of storing data corresponding to two nozzle faces is to be provided.</p>
<p id="p-0079" num="0078">When the data size of two nozzle faces is larger than the unit size of time-sharing expansion by the expansion processing unit <b>205</b>, even if compressed data input from the channels is, sequentially expanded by the single expansion processing unit <b>205</b> in a time-sharing manner, there is no need to add a new buffer. Therefore, the unit size of time-sharing expansion by the expansion processing unit <b>205</b> is preferably the same as the two nozzle faces of the recording head <b>34</b>, which is required to output expanded data to the recording head <b>34</b> while storing the data in the buffers <b>208</b>K, <b>208</b>C, <b>208</b>M, and <b>208</b>Y, or smaller than the two nozzle faces of the recording head <b>34</b>.</p>
<p id="p-0080" num="0079">In this manner, when a buffer is used as a buffer for storing expanded data expanded by the expanding unit <b>109</b> and a buffer for the recording head <b>34</b> to form an image in the main scanning direction, there is no need to add a new buffer.</p>
<p id="p-0081" num="0080">Here, an encoding method used upon encoding by the compressing unit <b>108</b> and expansion by the expansion processing unit <b>205</b> of the expanding unit <b>109</b> is explained with reference to <figref idref="DRAWINGS">FIG. 7</figref>. <figref idref="DRAWINGS">FIG. 7</figref> is a diagram showing a virtual code correspondence table.</p>
<p id="p-0082" num="0081">In data compression by the encoding method, for example, fixed-length data (code) before being compressed is converted on the basis of the code table in which a code of which the appearance ratio is high in data before being compressed is assigned to a code of which the code length is short, thereby reducing the data size. Specifically, as shown in <figref idref="DRAWINGS">FIG. 7</figref>, data compression/expansion is performed on the basis of the code correspondence table in which codes CA to CV are arranged in descending order of appearance ratio in data before being compressed and codes corresponding to the codes CA to CV in the data after being compressed are arranged in ascending order of code length (ranging from a code of 2 in code length to a code of 8 in code length).</p>
<p id="p-0083" num="0082">The code CV (EOL: End Of Line) here indicates a delimit position of one block (unit of compression), and specifically is an end code indicating the end of the delimited data. It will be assumed that codes of blocks before and after the code CV are not associated with each other. Therefore, this compression method can expand block by block independently. Incidentally, a signal that the code CV (the EOL code) is expanded (corresponding to &#x201c;00000000&#x201d; in an example of <figref idref="DRAWINGS">FIG. 7</figref>) is an end signal (an EOL signal).</p>
<p id="p-0084" num="0083">For example, in a case of &#x201c;code CA&#x2192;code CN&#x2192;code CD&#x2192;code CV (EOL)&#x201d;, a data length before compression is 8&#xd7;4=32 bits. When the data is compressed on the basis of the code correspondence table illustrated in <figref idref="DRAWINGS">FIG. 7</figref>, compressed data stored in the memory <b>106</b> is &#x201c;10000011101100000000&#x201d;, and a data length after the compression is 2+7+3+8=20 bits. At the time of expansion of this compressed data, the expansion processing unit <b>205</b> isolates the compressed data by the following steps on the basis of the code correspondence table in <figref idref="DRAWINGS">FIG. 7</figref>.</p>
<p id="p-0085" num="0084">Step <b>1</b>-<b>1</b>: Analyze an n-th code (implement comparison with all 22 codes).</p>
<p id="p-0086" num="0085">Step <b>1</b>-<b>2</b>: Identify a type and a code length of the n-th code.</p>
<p id="p-0087" num="0086">Step <b>1</b>-<b>3</b>: Perform a process corresponding to the identified type of code, and execute an expansion process.</p>
<p id="p-0088" num="0087">Step <b>1</b>-<b>4</b>: Identify the start position of an (n+1)-th code.</p>
<p id="p-0089" num="0088">Step <b>1</b>-<b>5</b>: Return to step <b>1</b>-<b>1</b> (replace n with n+1).</p>
<p id="p-0090" num="0089">However, when it is intended only to detect a specific code, the above steps are not always have to be taken. For example, in a case of compressed data compressed on the basis of the code correspondence table in <figref idref="DRAWINGS">FIG. 7</figref>, when one wants to detect the position of the code CV (EOL) and to detect a subsequent position, the one just takes the following steps.</p>
<p id="p-0091" num="0090">Step <b>2</b>-<b>1</b>: Analyze an n-th code, and identify a code length (&#x201c;*&#x201d; can be either 1 or 0).</p>
<p id="p-0092" num="0091">High-order bit of code is &#x201c;1*&#x201d;: Code length of 2</p>
<p id="p-0093" num="0092">High-order bit of code is &#x201c;01*&#x201d;: Code length of 3</p>
<p id="p-0094" num="0093">High-order bit of code is &#x201c;001*&#x201d;: Code length of 4</p>
<p id="p-0095" num="0094">High-order bit of code is &#x201c;0001*&#x201d;: Code length of 6</p>
<p id="p-0096" num="0095">High-order bit of code is &#x201c;00001*&#x201d;: Code length of 7</p>
<p id="p-0097" num="0096">High-order bit of code is &#x201c;000001*&#x201d;: Code length of 8</p>
<p id="p-0098" num="0097">Step <b>2</b>-<b>2</b>: Identify the start position of an (n+1)-th code.</p>
<p id="p-0099" num="0098">Step <b>2</b>-<b>3</b>: Terminate the process if an n-th code is the code CV (EOL); return to step <b>2</b>-<b>1</b> if the n-th code is a code other than the code CV (EOL) (replace n with n+1).</p>
<p id="p-0100" num="0099">As is obvious from the comparison between steps <b>1</b>-<b>1</b> to <b>1</b>-<b>5</b> and steps <b>2</b>-<b>1</b> to <b>2</b>-<b>3</b>, a processing load is smaller when it is intended only to detect a specific code.</p>
<p id="p-0101" num="0100">Incidentally, the code correspondence table illustrated in <figref idref="DRAWINGS">FIG. 7</figref> shows an example of detecting code lengths simply. Depending on a compression method, it may be not possible to detect a code length so simply like the example; however, that doesn't change the fact that a processing load is smaller when it is intended only to detect a specific code.</p>
<p id="p-0102" num="0101">Furthermore, the correspondence of the code correspondence table may change depending on a status of compressed data. Thus, the code analyzing unit <b>204</b> performs a process required to detect a code length before compressed data is input to the expansion processing unit <b>205</b>. For example, in a compression method used in a facsimile machine or the like, a code correspondence table corresponding to black data is different from a code correspondence table corresponding to white data. Therefore, the code analyzing unit <b>204</b> detects whether compressed data to be processed is black data or white data, and notifies the expansion processing unit <b>205</b> of a result of the detection.</p>
<p id="p-0103" num="0102">Subsequently, the operations of the units in the expanding unit are explained in detail with reference to <figref idref="DRAWINGS">FIGS. 8 to 11</figref>. Incidentally, for ease of the explanation, as shown in <figref idref="DRAWINGS">FIG. 8</figref>, the number of input channels is assumed to be two channels in the following explanation.</p>
<p id="p-0104" num="0103">Specifically, in a simplified expanding unit <b>109</b><i>a</i>, a data input unit <b>202</b><i>a </i>inputs compressed data for a channel CH<b>1</b>, and a data input unit <b>202</b><i>b </i>inputs compressed data for a channel CH<b>2</b>. A buffer <b>208</b><i>a </i>stores therein expanded data for the channel CH<b>1</b>, and a buffer <b>208</b><i>b </i>stores therein expanded data for the channel CH<b>2</b>.</p>
<p id="p-0105" num="0104">First, the operation of the channel specifying unit <b>203</b> is explained with reference to <figref idref="DRAWINGS">FIG. 9</figref>. As shown in <figref idref="DRAWINGS">FIG. 9</figref>, when the process is started, the channel specifying unit <b>203</b> determines whether it is within an available period to expand the compressed data of the channel CH<b>1</b> and whether the buffer <b>208</b><i>a </i>has enough free space to store data in size larger than the unit size of time-sharing expansion (Step S<b>1</b>).</p>
<p id="p-0106" num="0105">When the determination conditions are not met at Step S<b>1</b> (NO at Step S<b>1</b>), the channel specifying unit <b>203</b> determines whether it is within an available period to expand the compressed data of the channel CH<b>2</b> and whether the buffer <b>208</b><i>b </i>has enough free space to store data in size larger than the unit size of time-sharing expansion (Step S<b>2</b>). Incidentally, whether it is within the available period to expand the compressed data of the channel CH<b>1</b> or CH<b>2</b> is determined on the basis of whether the color corresponding to the channel CH<b>1</b> or CH<b>2</b> falls under the available period illustrated in <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0107" num="0106">When the determination conditions are met at Step S<b>1</b> (YES at Step S<b>1</b>), the channel specifying unit <b>203</b> specifies the channel CH<b>1</b> and sends a signal indicating the specification of the channel to the code analyzing unit <b>204</b> and the sorting unit <b>206</b> (Step S<b>3</b>). By Step S<b>3</b>, the compressed data input from the data input unit <b>202</b><i>a </i>is expanded by the expansion processing unit <b>205</b>, and the expanded data is stored in the buffer <b>208</b><i>a </i>by the sorting unit <b>206</b>.</p>
<p id="p-0108" num="0107">When the determination conditions are met at Step S<b>2</b> (YES at Step S<b>2</b>), the channel specifying unit <b>203</b> specifies the channel CH<b>2</b> and sends a signal indicating the specification of the channel to the code analyzing unit <b>204</b> and the sorting unit <b>206</b> (Step S<b>4</b>). By Step S<b>4</b>, the compressed data input from the data input unit <b>202</b><i>b </i>is expanded by the expansion processing unit <b>205</b>, and the expanded data is stored in the buffer <b>208</b><i>b </i>by the sorting unit <b>206</b>.</p>
<p id="p-0109" num="0108">Subsequently, the channel specifying unit <b>203</b> determines whether to receive, from the code analyzing unit <b>204</b> and the sorting unit <b>206</b>, acceptance signals indicating that the specification of the channel is accepted, respectively, and whether to detect an output of an EOL signal from the expansion processing unit <b>205</b> to the sorting unit <b>206</b> (Step S<b>5</b>). The channel specifying unit <b>203</b> waits until the determination conditions at Step S<b>5</b> are met; when the determination conditions at Step S<b>5</b> are met (YES at Step S<b>5</b>), the channel specifying unit <b>203</b> cancels the specification of the channel made at Step S<b>3</b> or S<b>4</b> (Step S<b>6</b>).</p>
<p id="p-0110" num="0109">Therefore, in the expanding unit <b>109</b><i>a</i>, when expansion of one block of compressed data for which the channel is specified is completed, the specification of the channel is cancelled, and the expanded data in which the one block of the compressed data is expanded is stored in the buffer <b>208</b><i>a </i>or <b>208</b><i>b. </i></p>
<p id="p-0111" num="0110">Then, the channel specifying unit <b>203</b> determines whether expansion of all the compressed data stored in the memory <b>106</b> is completed (Step S<b>7</b>); when the expansion is not completed (NO at Step S<b>7</b>), the channel specifying unit <b>203</b> returns the process back to Step S<b>1</b>; when the expansion is completed (YES at Step S<b>7</b>), the channel specifying unit <b>203</b> terminates the process.</p>
<p id="p-0112" num="0111">Subsequently, the operation of the code analyzing unit <b>204</b> is explained with reference to <figref idref="DRAWINGS">FIG. 10</figref>. As shown in <figref idref="DRAWINGS">FIG. 10</figref>, when the process is started, the code analyzing unit <b>204</b> determines whether specification of a channel is made by the channel specifying unit <b>203</b> (Step S<b>11</b>). The code analyzing unit <b>204</b> waits until the determination condition at Step S<b>11</b> is met.</p>
<p id="p-0113" num="0112">When there is specification of a channel, i.e., the determination condition at Step S<b>11</b> is met (YES at Step S<b>11</b>), the code analyzing unit <b>204</b> holds channel information indicating the specified channel, and issues the acceptance signal indicating that the specification of the channel is accepted, and outputs the acceptance signal to the channel specifying unit <b>203</b> (Step S<b>12</b>).</p>
<p id="p-0114" num="0113">Then, the code analyzing unit <b>204</b> receives data from the data input unit corresponding to the specified channel (Step S<b>13</b>), and analyzes codes of the received data and transmits the received data to the expansion processing unit <b>205</b> (Step S<b>14</b>). In the analysis of codes at Step S<b>14</b>, detection of an EOL code is performed by the foregoing steps.</p>
<p id="p-0115" num="0114">Then, the code analyzing unit <b>204</b> determines whether to detect an EOL code in the analysis of codes at Step S<b>14</b> (Step S<b>15</b>). When no EOL code is detected (NO at Step S<b>15</b>), the code analyzing unit <b>204</b> returns the process back to Step S<b>13</b>. Therefore, the code analyzing unit <b>204</b> continues to transmit the received data to the expansion processing unit <b>205</b> until an EOL code is detected from the received data received in accordance with the specified channel.</p>
<p id="p-0116" num="0115">When an EOL code is detected (YES at Step S<b>15</b>), the code analyzing unit <b>204</b> determines whether expansion of all the compressed data stored in the memory <b>106</b> is completed (Step S<b>16</b>). When the expansion is not completed (NO at Step S<b>16</b>), the code analyzing unit <b>204</b> returns the process back to Step S<b>11</b>; when the expansion is completed (YES at Step S<b>16</b>), the code analyzing unit <b>204</b> terminates the process.</p>
<p id="p-0117" num="0116">Subsequently, the operation of the sorting unit <b>206</b> is explained with reference to <figref idref="DRAWINGS">FIG. 11</figref>. As shown in <figref idref="DRAWINGS">FIG. 11</figref>, when the process is started, the sorting unit <b>206</b> determines whether specification of a channel is made by the channel specifying unit <b>203</b> (Step S<b>21</b>). The sorting unit <b>206</b> waits until the determination condition at Step S<b>21</b> is met.</p>
<p id="p-0118" num="0117">When there is specification of a channel, i.e., the determination condition at Step S<b>21</b> is met (YES at Step S<b>21</b>), the sorting unit <b>206</b> holds channel information indicating the specified channel, and issues an acceptance signal indicating that the specification of the channel is accepted, and outputs the acceptance signal to the channel specifying unit <b>203</b> (Step S<b>22</b>).</p>
<p id="p-0119" num="0118">Then, the sorting unit <b>206</b> transmits expanded data received from the expansion processing unit <b>205</b> to a buffer corresponding to the specified channel (Step S<b>23</b>). Then, the sorting unit <b>206</b> determines whether an EOL code is detected from the data received from the expansion processing unit <b>205</b> (Step S<b>24</b>).</p>
<p id="p-0120" num="0119">When no EOL signal is detected (NO at Step S<b>24</b>), the sorting unit <b>206</b> returns the process back to Step S<b>23</b>. Therefore, the sorting unit <b>206</b> continues to store the expanded data received from the expansion processing unit <b>205</b> in a buffer corresponding to the specified channel until an EOL signal is detected; when an EOL signal is detected, the sorting unit <b>206</b> stops the storage in the buffer corresponding to the specified channel. The sorting unit <b>206</b> stops the storage of the expanded data in the buffer in accordance with the detection of the EOL signal; thus, sorting of expanded data at the end of block can be definitely performed.</p>
<p id="p-0121" num="0120">When an EOL signal is detected (YES at Step S<b>24</b>), the sorting unit <b>206</b> determines whether expansion of all the compressed data stored in the memory <b>106</b> is completed (Step S<b>25</b>). When the expansion is not completed (NO at Step S<b>25</b>), the sorting unit <b>206</b> returns the process back to Step S<b>21</b>; when the expansion is completed (YES at Step S<b>25</b>), the sorting unit <b>206</b> terminates the process.</p>
<p id="p-0122" num="0121">Here, the time-sharing expansion in the expanding unit <b>109</b><i>a </i>by the operations of the channel specifying unit <b>203</b>, the code analyzing unit <b>204</b>, and the sorting unit <b>206</b> is explained with reference to <figref idref="DRAWINGS">FIG. 8</figref>. Steps of the time-sharing expansion in the expanding unit <b>109</b><i>a </i>are as follows.</p>
<p id="p-0123" num="0122">Step <b>3</b>-<b>1</b>: When the process is started, the channel specifying unit <b>203</b> determines a channel to be subjected to expansion. Specifically, when detecting that a buffer of a channel within an available period has free space enough to accumulate expanded data for one block, the channel specifying unit <b>203</b> specifies the channel, and transmits a signal indicating the specification of the channel to the code analyzing unit <b>204</b>. Incidentally, if a plurality of channels meet the condition, internal arbitration is performed to specify one of the channels. More specifically, arbitration is performed so as to preferentially specify a channel whose available period is close to the termination.</p>
<p id="p-0124" num="0123">Step <b>3</b>-<b>2</b>: When receiving the signal indicating the specification of the channel, the code analyzing unit <b>204</b> issues a request for outputting compressed data to a data input unit of the specified channel, and receives the compressed data.</p>
<p id="p-0125" num="0124">Step <b>3</b>-<b>3</b>: The code analyzing unit <b>204</b> analyzes codes of the compressed data using the table shown in <figref idref="DRAWINGS">FIG. 7</figref>, and outputs compressed data up to the position where an EOL code is detected to the expansion processing unit <b>205</b>.</p>
<p id="p-0126" num="0125">Step <b>3</b>-<b>4</b>: The expansion processing unit <b>205</b> issues an EOL signal when the expansion processing unit <b>205</b> detects the EOL code while expanding the input compressed data, and notifies the end of the block.</p>
<p id="p-0127" num="0126">Step <b>3</b>-<b>5</b>: The sorting unit <b>206</b> transmits the expanded data received from the expansion processing unit <b>205</b> to the channel (the buffer) specified by the channel specifying unit <b>203</b>. Furthermore, when receiving the EOL signal from the expansion processing unit <b>205</b>, the sorting unit <b>206</b> switches to a channel to which the expanded data is to be output at this timing.</p>
<p id="p-0128" num="0127">Step <b>3</b>-<b>6</b>: When receiving an acceptance signal for specification of a new channel from the code analyzing unit <b>204</b>, the channel specifying unit <b>203</b> starts specification of a next channel. However, if a channel specified next is identical to a channel being subjected to expansion, expansion of a block is waited, or the channel can be specified if the buffer has free space for two or more blocks.</p>
<p id="p-0129" num="0128">Here, there are shown examples of input data of the channels CH<b>1</b> and CH<b>2</b> and merged data input to the expansion processing unit <b>205</b>. Specifically, there is shown an example of time-sharing expansion in the order of the channel CH<b>1</b>&#x2192;the channel CH<b>1</b>&#x2192;the channel CH<b>2</b>&#x2192;the channel CH<b>1</b>&#x2192;the channel CH<b>2</b>&#x2192;the channel CH<b>2</b>.</p>
<p id="p-0130" num="0129">Input data of the channel CH<b>1</b>:</p>
<p id="p-0131" num="0130">code CA&#x2192;code CB&#x2192;code CC&#x2192;EOL (end of block 1)&#x2192;code CD&#x2192;code CE&#x2192;code CF&#x2192;EOL (end of block 2)&#x2192;code CG&#x2192;code CH&#x2192;EOL (end of block 3)</p>
<p id="p-0132" num="0131">Input data of the channel CH<b>2</b>:</p>
<p id="p-0133" num="0132">code CI&#x2192;code CJ&#x2192;code CK&#x2192;code CL&#x2192;EOL (end of block 1)&#x2192;code CM&#x2192;code CN&#x2192;EOL (end of block 2)&#x2192;code CO&#x2192;code CP&#x2192;EOL (end of block 3)</p>
<p id="p-0134" num="0133">Merged data input to the expansion processing unit:</p>
<p id="p-0135" num="0134">code CA&#x2192;code CB&#x2192;code CC&#x2192;EOL (channel CH<b>1</b>: end of block 1)&#x2192;code CD&#x2192;code CE&#x2192;code CF&#x2192;EOL (channel CH1: end of block 2)&#x2192;code CI&#x2192;code CJ&#x2192;code CK&#x2192;code CL&#x2192;EOL (channel CH<b>2</b>: end of block 1)&#x2192;code CG&#x2192;code CH&#x2192;EOL (channel CH1: end of block 3)&#x2192;code CM&#x2192;code CN&#x2192;EOL (channel CH2: end of block 2)&#x2192;code CO&#x2192;code CP&#x2192;EOL (channel CH2: end of block 3)</p>
<p id="p-0136" num="0135">In the present embodiment, detection of the code CV (EOL) is used for detection of delimiters in compressed data; however, any code can be used as long as the delimit position of each block can be detected by the code. For example, detection of delimiters in compressed data can be performed by detecting a code, such as a line header indicating a mode of each block. More specifically, when a line header is used for detection of delimiters, a part up to just before a line header is set down as one block. In other words, the line header is a start code indicating the start position of block delimiting.</p>
<p id="p-0137" num="0136">Furthermore, in the present embodiment, an EOL signal is used for detection of delimiters in expanded data; however, as long as completion of expansion with respect to each block in expanded data can be detected, it is not specifically limited to the configuration using an EOL signal. For example, when the size of one block is fixed (including a case where software setting is allowed), the sorting unit <b>206</b> can be provided with a counter for detecting the data size (data length) of expanded data, and the channel specifying unit <b>203</b> can switch a channel each time expansion for one block is completed. More specifically, the channel specifying unit <b>203</b> is notified that the counter of the sorting unit <b>206</b> has counted the data size for one block (a predetermined data length). In response to the notification from the sorting unit <b>206</b>, the channel specifying unit <b>203</b> cancels the specification of the channel to the code analyzing unit <b>204</b> and the sorting unit <b>206</b>, and specifies a new channel.</p>
<p id="p-0138" num="0137">In the time-sharing processing described above, the expanding unit <b>109</b><i>a </i>is provided with the buffers <b>208</b><i>a </i>and <b>208</b><i>b </i>each having a capacity capable of storing expanded data for one block. The specific reason is as follows.</p>
<p id="p-0139" num="0138">At the time of expansion for the channel CH<b>1</b>, expansion for the channel CH<b>2</b> cannot be started until expansion for one block size is completed. Furthermore, when an output of expanded data for the channel CH<b>1</b> stored in the buffer <b>208</b><i>a </i>is not performed, expansion of the block for the channel CH<b>1</b> cannot be completed because the buffer is occupied. In this case, even when an output of expanded data for the channel CH<b>2</b> stored in the buffer <b>208</b><i>b </i>is proceeded, and next expanded data is required, expansion for the channel CH<b>2</b> cannot be started. Therefore, it is necessary to provide a buffer having an enough capacity to store one-block expanded data. Incidentally, when the block size is different among blocks, it is necessary to provide a buffer in size for a possible largest block.</p>
<p id="p-0140" num="0139">Incidentally, in the expanding unit <b>109</b><i>a</i>, a case of two channels is illustrated; however, it goes without saying that the same is true in a case of three or more multiple channels. Specifically, in a case of multiple channels, for the same reason as the case of two channels, it is necessary to provide a buffer having a capacity capable of storing expanded data for blocks corresponding to the number of channels. For example, as shown in <figref idref="DRAWINGS">FIG. 6</figref>, when the number of channels is four, it is necessary to provide a buffer having an enough capacity to store expanded data for at least three blocks. Furthermore, when the number of channels is n, it is necessary to provide a buffer having a capacity capable of storing expanded data for at least (n&#x2212;1) blocks.</p>
<p id="p-0141" num="0140">(Modification)</p>
<p id="p-0142" num="0141">Subsequently, a modification of the expanding unit is explained with reference to <figref idref="DRAWINGS">FIG. 12</figref>. The components identical to those in the above embodiment are denoted by the same reference numerals, and the description of those components is omitted; in what follows, only different parts are explained.</p>
<p id="p-0143" num="0142">In an image compression method for a printer used in the image forming apparatus, depending on input image data, the size of the data after being compressed (compressed data) may be larger than that of the data before being compressed (expanded data). Thus, to minimize a volume of data on the memory, as for data of a specific channel, compressed data can be stored in the memory; as for data of the other channels, expanded data can be stored in the memory. In this modification, an expanding unit handling compressed data as well as expanded data is explained.</p>
<p id="p-0144" num="0143">Incidentally, whether the size of compressed data is larger than that of expanded data can be detected by counting the data size before and after compression. It is assumed that compressed data and expanded data are stored in the memory so as to minimize a volume of the data on the memory on the basis of a result of the detection. Furthermore, it is assumed that whether data stored in the memory is compressed data or expanded data is recorded on a header of the data.</p>
<p id="p-0145" num="0144">As shown in <figref idref="DRAWINGS">FIG. 12</figref>, an expanding unit <b>19</b><i>b </i>is provided with a detour path for detouring expanded data from a code analyzing unit <b>204</b><i>a </i>to a sorting unit <b>206</b><i>a </i>without passing through the expansion processing unit <b>205</b>. The code analyzing unit <b>204</b><i>a </i>checks a header of data input from the data input unit, and outputs the data to the expansion processing unit <b>205</b> if the data is compressed data, or outputs the data to the sorting unit <b>206</b><i>a </i>via the detour path if the data is expanded data. The sorting unit <b>206</b><i>a </i>sorts expanded data expanded by the expansion processing unit <b>205</b> and expanded data via the detour path so as to be each stored in a buffer corresponding to the input channel. Therefore, when input data is expanded data, the expanding unit <b>19</b><i>b </i>can handle an input of the expanded data without performing an expansion process on the expanded data.</p>
<p id="p-0146" num="0145">Second Embodiment</p>
<p id="p-0147" num="0146">In a second embodiment, an image forming apparatus that forms a color image on a sheet by the electrophotographic method is illustrated. <figref idref="DRAWINGS">FIG. 13</figref> is a schematic side view for explaining the entire configuration of an image forming apparatus <b>1</b><i>a </i>according to the second embodiment.</p>
<p id="p-0148" num="0147">As shown in <figref idref="DRAWINGS">FIG. 13</figref>, the image forming apparatus <b>1</b><i>a </i>is an electrophotographic tandem-type image forming apparatus, and employs an indirect transfer method; schematically, primary transfer devices <b>4</b>Y, <b>4</b>C, <b>4</b>M, and <b>4</b>K sequentially transfers toner images, which are formed by developing electrostatic latent images on four photoconductor drums <b>2</b>Y (yellow), <b>2</b>C (cyan), <b>2</b>M (magenta), and <b>2</b>K (black) as image carriers by developing units <b>3</b>Y, <b>3</b>C, <b>3</b>M, and <b>3</b>K, onto an intermediate transfer belt <b>5</b>L as a rotating member, and a secondary transfer device <b>6</b>L collectively transfers the images on the intermediate transfer belt <b>5</b>L onto a sheet P as a transferred body.</p>
<p id="p-0149" num="0148">The intermediate transfer belt <b>5</b>L is an endless belt, and is supported by a plurality of rollers <b>10</b>L to <b>13</b>L. The intermediate transfer belt <b>5</b>L is driven to move in a moving direction A at a constant speed by a motor (not shown) connected to a shaft of any of the rollers <b>10</b>L to <b>13</b>L. An intermediate transfer unit is made up of the intermediate transfer belt <b>5</b>L and a drive unit of the intermediate transfer belt <b>5</b>L (the motor, the rollers <b>10</b>L to <b>13</b>L, and the like). On the upper side of the intermediate transfer belt <b>5</b>L, the above-described four photoconductor drums <b>2</b>Y, <b>2</b>C, <b>2</b>M, and <b>2</b>K for yellow, cyan, magenta, and black colors, respectively, are arranged along the moving direction A to be parallel with one another.</p>
<p id="p-0150" num="0149">Charging devices <b>7</b>Y, <b>7</b>C, <b>7</b>M, and <b>7</b>K, the above-described developing units <b>3</b>Y, <b>3</b>C, <b>3</b>M, and <b>3</b>K, the above-described primary transfer devices <b>4</b>Y, <b>4</b>C, <b>4</b>M, and <b>4</b>K, cleaning devices <b>8</b>Y, <b>8</b>C, <b>8</b>M, and <b>8</b>K each made up of a blade, a brush, and the like, and static elimination devices <b>9</b>Y, <b>9</b>C, <b>9</b>M, and <b>9</b>K are provided around the photoconductor drums <b>2</b>Y, <b>2</b>C, <b>2</b>M, and <b>2</b>K, respectively.</p>
<p id="p-0151" num="0150">The primary transfer devices <b>4</b>Y, <b>4</b>C, <b>4</b>M, and <b>4</b>K are arranged to be opposed to the photoconductor drums <b>2</b>Y, <b>2</b>C, <b>2</b>M, and <b>2</b>K, respectively, across the intermediate transfer belt <b>5</b>L. In other words, the intermediate transfer belt <b>5</b>L moves in a state where the intermediate transfer belt <b>5</b>L is sandwiched between the primary transfer devices <b>4</b>Y, <b>4</b>C, <b>4</b>M, and <b>4</b>K and the photoconductor drums <b>2</b>Y, <b>2</b>C, <b>2</b>M, and <b>2</b>K.</p>
<p id="p-0152" num="0151">The photoconductor drums <b>2</b>Y, <b>2</b>C, <b>2</b>M, and <b>2</b>K are driven to rotate in a rotating direction B; at this time, the surfaces of the photoconductor drums <b>2</b>Y, <b>2</b>C, <b>2</b>M, and <b>2</b>K are charged to a predetermined polarity by the charging devices <b>7</b>Y, <b>7</b>C, <b>7</b>M, and <b>7</b>K, respectively. Then, the charged surfaces of the photoconductor drums <b>2</b>Y, <b>2</b>C, <b>2</b>M, and <b>2</b>K are irradiated with laser beams corresponding to image data by an optical-beam scanning device <b>16</b>L, an optical writing unit with an LD, an LED, an EL, or the like; as a result, electrostatic latent images are formed on the surfaces of the photoconductor drums <b>2</b>Y, <b>2</b>C, <b>2</b>M, and <b>2</b>K. The image data related to the irradiation of the laser beams is data that is expanded by the expanding unit explained in the first embodiment and output from the image-data output unit <b>110</b>. The electrostatic latent images formed in this manner are visualized by being developed into Y, C, M, and K toner images by the developing units <b>3</b>Y, <b>3</b>C, <b>3</b>M, and <b>3</b>K.</p>
<p id="p-0153" num="0152">The image-data output unit <b>110</b> includes line buffers <b>110</b>Y, <b>110</b>C, <b>110</b>M, and <b>110</b>K for which the optical-beam scanning device <b>16</b>L irradiates the charged surfaces of the photoconductor drums <b>2</b>Y, <b>2</b>C, <b>2</b>M, and <b>2</b>K. The line buffers <b>110</b>Y, <b>110</b>C, <b>110</b>M, and <b>110</b>K are used as a work area for data processing (mirroring, filtering, or the like) and an area for securing a data transfer rate when the optical-beam scanning device <b>16</b>L irradiates the charged surfaces with laser beams. Furthermore, in the same manner as in the first embodiment, when the line buffers <b>110</b>Y, <b>110</b>C, <b>110</b>M, and <b>110</b>K each have a capacity capable of storing data in size larger than the unit size of time-sharing expansion by the expanding unit, there is no need to add a buffer required for the time-sharing processing as described above if the line buffers <b>110</b>Y, <b>110</b>C, <b>110</b>M, and <b>110</b>K are shared between the optical-beam scanning device <b>16</b>L and the expanding unit.</p>
<p id="p-0154" num="0153">The developed Y, C, M, and K toner images on the photoconductor drums <b>2</b>Y, <b>2</b>C, <b>2</b>M, and <b>2</b>K are sequentially transferred onto the surface of the intermediate transfer belt <b>5</b>L in a superimposed manner by the action of the primary transfer devices <b>4</b>Y, <b>4</b>C, <b>4</b>M, and <b>4</b>K, and a composite color image in full color is formed.</p>
<p id="p-0155" num="0154">After toner images remaining on the photoconductor drums <b>2</b>Y, <b>2</b>C, <b>2</b>M, and <b>2</b>K are cleaned by the cleaning devices <b>8</b>Y, <b>8</b>C, <b>8</b>M, and <b>8</b>K, static electricity is removed from the photoconductor drums <b>2</b>Y, <b>2</b>C, <b>2</b>M, and <b>2</b>K by the static elimination devices <b>9</b>Y, <b>9</b>C, <b>9</b>M, and <b>9</b>K.</p>
<p id="p-0156" num="0155">The secondary transfer device <b>6</b>L is arranged to be opposed to the roller <b>12</b>L across the intermediate transfer belt <b>5</b>L. A sheet P fed from a sheet feed unit (not shown) is fed in between the roller <b>12</b>L (the intermediate transfer belt <b>5</b>L) and the secondary transfer device <b>6</b>L at a predetermined timing. When the sheet P is fed in between the roller <b>12</b>L (the intermediate transfer belt <b>5</b>L) and the secondary transfer device <b>6</b>L in a sheet conveying direction C, the composite color image carried on the intermediate transfer belt <b>5</b>L is collectively transferred onto the sheet P by the action of the secondary transfer device <b>6</b>L.</p>
<p id="p-0157" num="0156">After that, the composite color image on the sheet P is fixed by the action of heat and pressure by a fixing device <b>14</b>L, and discharged onto a copy receiving tray (not shown).</p>
<p id="p-0158" num="0157">Transfer residual toner attached to the surface of the intermediate transfer belt <b>5</b>L after the composite color image is transferred onto the sheet P is removed by a cleaning device <b>15</b>L.</p>
<p id="p-0159" num="0158">As described above, by applying the same expanding unit as the first embodiment to the image forming apparatus <b>1</b><i>a </i>that forms a color image on a sheet by the electrophotographic method, image data (compressed data) for respective colors in the image forming apparatus <b>1</b><i>a </i>can be expanded in a time-sharing manner.</p>
<p id="p-0160" num="0159">Second Modification of First Embodiment</p>
<p id="p-0161" num="0160">Subsequently, a second modification of the first embodiment is explained with reference to <figref idref="DRAWINGS">FIGS. 14 to 18</figref>. <figref idref="DRAWINGS">FIG. 14</figref> is a block diagram illustrating an example of the internal configuration of the expanding units <b>109</b>, <b>109</b><i>a</i>, and <b>109</b><i>b. </i></p>
<p id="p-0162" num="0161">As shown in <figref idref="DRAWINGS">FIG. 14</figref>, the expanding units <b>109</b>, <b>109</b><i>a</i>, and <b>109</b><i>b </i>include a data input unit <b>1091</b>, an input buffer <b>1092</b>, a calculating unit <b>1093</b>, an internal memory <b>1094</b>, an output buffer <b>1095</b>, and a data output unit <b>1096</b>. Namely, the expanding units <b>109</b>, <b>109</b><i>a</i>, and <b>109</b><i>b </i>temporarily accumulate (temporarily stores) a certain amount of data received by the data input unit <b>1091</b> in the input buffer <b>1092</b>. The data accumulated in the input buffer <b>1092</b> is output to the calculating unit <b>1093</b> using the internal memory <b>1094</b> as a work area, processed (expanded) by the calculating unit <b>1093</b>, and temporarily accumulated in the output buffer <b>1095</b> before being output from the data output unit <b>1096</b>. By such a configuration including the input buffer <b>1092</b>, even when the data input timing is different from the timing for the calculating unit <b>1093</b> to require the data, the data can be transferred efficiently. The same holds true for the output side configuration including the output buffer <b>1095</b>.</p>
<p id="p-0163" num="0162"><figref idref="DRAWINGS">FIG. 15</figref> is an example of a timing chart of the expanding units <b>109</b>, <b>109</b><i>a</i>, and <b>109</b><i>b</i>, and specifically, an example of a timing chart according to the first embodiment and the modification of the first embodiment. In <figref idref="DRAWINGS">FIG. 15</figref>, &#x201c;CH<b>1</b>[N]&#x201d; denotes data of the N-th block of the channel CH<b>1</b>, and &#x201c;CH<b>2</b>[M]&#x201d; denotes data of the M-th block of the channel CH<b>2</b>.</p>
<p id="p-0164" num="0163">Furthermore, times T<b>1</b> to T<b>6</b> denote as follows.</p>
<p id="p-0165" num="0164">Time T<b>1</b>: Time when expansion (data input) of CH<b>1</b>[N] is started</p>
<p id="p-0166" num="0165">Time T<b>2</b>: Time when data output of CH<b>1</b>[N] after being subjected to the expansion is started, and thus, the space status of the latter buffer (the output buffer <b>1095</b>) of the channel CH<b>1</b> becomes &#x201c;not available&#x201d;</p>
<p id="p-0167" num="0166">Time T<b>3</b>: Time when expansion (data input) of CH<b>2</b>[M] is started</p>
<p id="p-0168" num="0167">Time T<b>4</b>: Time when the data input of CH<b>2</b>[M] is completed</p>
<p id="p-0169" num="0168">Time T<b>5</b>: Time when data output of CH<b>1</b>[N] after being subjected to the expansion is completed, and arbitration is implemented</p>
<p id="p-0170" num="0169">Time T<b>6</b>: Time when data in the latter buffer of the channel CH<b>1</b> is wiped out (is all output), and the space status of the latter buffer becomes &#x201c;available&#x201d;</p>
<p id="p-0171" num="0170">Since data input to the expanding units <b>109</b>, <b>109</b><i>a</i>, and <b>109</b><i>b </i>to be expanded is compressed data, the data can be extremely small in size depending on a compression efficiency. Therefore, when the size of input data is comparable to the size of the internal buffers (the input buffer <b>1092</b> and the output buffer <b>1095</b>) of the expanding units <b>109</b>, <b>109</b><i>a</i>, and <b>109</b><i>b</i>, as shown in <figref idref="DRAWINGS">FIG. 15</figref>, data input of CH<b>2</b>[M] may be completed (the time T<b>4</b>) before data output of CH<b>1</b>[N] is completed (the time T<b>5</b>). In this case, if arbitration is implemented at the timing when the data output of CH<b>1</b>[N] is completed (the time T<b>5</b>), next data (CH<b>2</b>[M+<b>1</b>]) is input before the space of the latter buffer of the channel CH<b>2</b> becomes &#x201c;not available&#x201d;. Since data of CH<b>1</b>[N+<b>1</b>] cannot be output until output of the data of CH<b>2</b>[M+<b>1</b>] is completed, data output is stagnated.</p>
<p id="p-0172" num="0171">Such stagnation of data output can be prevented by controlling not to implement arbitration until output of whole data in which data for one block is expanded is completed so that the space status of the latter buffer can be detected accurately. Namely, in the second modification, the channel specifying unit <b>203</b> specifies a next input channel after waiting until all compressed data temporarily stored in the input buffer <b>1092</b> has been expanded by the calculating unit <b>1093</b> (corresponding to the expansion processing unit <b>205</b>) and the expanded data has been output to the output buffer <b>1095</b>; thus, arbitration is not implemented until output of whole data in which data for one block is expanded is completed.</p>
<p id="p-0173" num="0172"><figref idref="DRAWINGS">FIG. 16</figref> is an example of a timing chart of the expanding units <b>109</b>, <b>109</b><i>a</i>, and <b>109</b><i>b</i>, and specifically, an example of a timing chart according to the second modification of the first embodiment. The meanings of CH<b>1</b>[N] and CH<b>2</b>[M] in <figref idref="DRAWINGS">FIG. 16</figref> are the same as those in <figref idref="DRAWINGS">FIG. 15</figref>.</p>
<p id="p-0174" num="0173">Furthermore, times T<b>11</b> to T<b>15</b> denote as follows.</p>
<p id="p-0175" num="0174">Time T<b>11</b>: Time when expansion (data input) of CH<b>1</b>[N] is started</p>
<p id="p-0176" num="0175">Time T<b>12</b>: Time when data output of CH<b>1</b>[N] after being subjected to the expansion is started, and thus, the space status of the latter buffer of the channel CH<b>1</b> becomes &#x201c;not available&#x201d;</p>
<p id="p-0177" num="0176">Time T<b>13</b>: Time when data output of CH<b>1</b>[N] after being subjected to the expansion is completed, and arbitration is implemented, and then the channel CH<b>2</b> of which the latter buffer has free space is selected</p>
<p id="p-0178" num="0177">Time T<b>14</b>: Time when data output of CH<b>2</b>[M] after being subjected to expansion is started, and thus, the space status of the latter buffer of the channel CH<b>2</b> becomes &#x201c;not available&#x201d;</p>
<p id="p-0179" num="0178">Time T<b>15</b>: Time when the data output of CH<b>2</b>[M] after being subjected to expansion is completed, and arbitration is implemented, and then the channel CH<b>1</b> of which the latter buffer has free space is selected</p>
<p id="p-0180" num="0179">In the second modification, the channel specifying unit <b>203</b> specifies a next input channel after waiting until data stored in the input buffer <b>1092</b> is expanded by the calculating unit <b>1093</b> and the expanded data is output to the output buffer <b>1095</b>; thus, even when input data is extremely small in size (CH<b>2</b>[M]), next arbitration is not performed until data in which data for block is expanded has been output to the output buffer <b>1095</b> (the time T<b>15</b>). Therefore, at the time of arbitration (the time T<b>15</b>), it is possible to detect the space status of the latter buffer accurately. In this case, there is occurrence of overhead, such as occurrence of waiting with each block processing and a long period of time from when data input to the expanding units <b>109</b>, <b>109</b><i>a</i>, and <b>109</b><i>b </i>is started till when output of expanded data is started (the time T<b>11</b> to the time T<b>12</b>, the time T<b>13</b> to the time T<b>14</b>).</p>
<p id="p-0181" num="0180">To reduce the overhead, in the second modification, the channel specifying unit <b>203</b> specifies a plurality of channels as input channels, and specifies next input channels after waiting until all compressed data temporarily stored in the input buffers corresponding to their respective channels has been expanded.</p>
<p id="p-0182" num="0181"><figref idref="DRAWINGS">FIG. 17</figref> is an example of a timing chart of the expanding units <b>109</b>, <b>109</b><i>a</i>, and <b>109</b><i>b</i>, and specifically, an example of a timing chart in a case where a plurality of channels are specified in the second modification. The meanings of CH<b>1</b>[N] and CH<b>2</b>[M] in <figref idref="DRAWINGS">FIG. 17</figref> are the same as those in <figref idref="DRAWINGS">FIGS. 15 and 16</figref>.</p>
<p id="p-0183" num="0182">Furthermore, times T<b>21</b> to T<b>26</b> denote as follows:</p>
<p id="p-0184" num="0183">Time T<b>21</b>: Time when arbitration is started. At this time, both the channels CH<b>1</b> and CH<b>2</b> of which the space status of the latter buffer is &#x201c;available&#x201d; are selected. A code (CH<b>1</b>[N]) of the channel CH<b>1</b> out of the selected channels CH<b>1</b> and CH<b>2</b> is started being input.</p>
<p id="p-0185" num="0184">Time T<b>22</b>: Time when data output of CH<b>1</b>[N] after being subjected to expansion is started, and thus, the space status of the latter buffer of the channel CH<b>1</b> becomes &#x201c;not available&#x201d;</p>
<p id="p-0186" num="0185">Time T<b>23</b>: Time when a code (CH<b>2</b>[M]) of the channel CH<b>2</b> selected in the arbitration at the time T<b>21</b> is started being input.</p>
<p id="p-0187" num="0186">Time T<b>24</b>: Time when the data output of CH<b>1</b>[N] after being subjected to expansion is completed. At this time, next arbitration is not implemented.</p>
<p id="p-0188" num="0187">Time T<b>25</b>: Time when data in the latter buffer of the channel CH<b>1</b> is wiped out, and the space status of the latter buffer changes to &#x201c;available&#x201d;</p>
<p id="p-0189" num="0188">Time T<b>26</b>: Time when data output of CH<b>2</b>[M] after being subjected to expansion is completed. At this time, expanded data of all the channels selected in the arbitration at the time T<b>21</b> has been output, and next arbitration is implemented. In the example of <figref idref="DRAWINGS">FIG. 17</figref>, the channel CH<b>1</b> of which the latter buffer has free space is selected, and a code (CH<b>1</b>[N+1]) of the channel CH<b>1</b> is started being input.</p>
<p id="p-0190" num="0189">In the second modification, to reduce the overhead described above, not one channel but all channels of which the latter buffer has free space are specified in one-time arbitration. Incidentally, the processing order of the specified plurality of channels can be determined by another arbitration, or the fixed order can be set. Next arbitration is implemented after waiting until all compressed data temporarily stored in the input buffers <b>1092</b> of the channels specified in the arbitration has been expanded by the calculating unit <b>1093</b> and the expanded data has been output to the output buffers <b>1095</b>. Therefore, at the time of arbitration, the space status of the latter buffers of the channels can be detected accurately. Furthermore, it is possible to totally reduce overhead that occurs each time the arbitration is implemented. Specifically, as compared with the case shown in <figref idref="DRAWINGS">FIG. 16</figref>, a time for the overhead is expected to be &#x201c;1/[the number of channels subjected to expansion at the same time]&#x201d;.</p>
<p id="p-0191" num="0190"><figref idref="DRAWINGS">FIG. 18</figref> is a flowchart illustrating the operation of the channel specifying unit <b>203</b> according to the second modification. As shown in <figref idref="DRAWINGS">FIG. 18</figref>, at Steps S<b>31</b> to S<b>35</b>, a plurality of channels can be selected in one-time arbitration. Furthermore, the flow at Steps S<b>36</b> to S<b>42</b> shows that it is waited until codes of all the channels selected in the arbitration have been expanded and output.</p>
<p id="p-0192" num="0191">Specifically, when the process is started, the channel specifying unit <b>203</b> determines whether enough free space is not left in the latter buffers of all available channels (Step S<b>31</b>). When there is not enough free space (NO at Step S<b>31</b>), the channel specifying unit <b>203</b> waits the process. When there is enough free space (YES at Step S<b>31</b>), the channel specifying unit <b>203</b> advances the process to Step S<b>32</b>.</p>
<p id="p-0193" num="0192">The channel specifying unit <b>203</b> determines whether the channel CH<b>1</b> is available and whether there is enough free space in the latter buffer of the channel CH<b>1</b> (Step S<b>32</b>). When it is determined as YES at Step S<b>32</b>, the channel specifying unit <b>203</b> selects (specifies) the channel CH<b>1</b> (Step S<b>33</b>). When it is determined as NO at Step S<b>32</b>, the channel specifying unit <b>203</b> advances the process to Step S<b>34</b> without selecting the channel CH<b>1</b>.</p>
<p id="p-0194" num="0193">The channel specifying unit <b>203</b> determines whether the channel CH<b>2</b> is available and whether there is enough free space in the latter buffer of the channel CH<b>2</b> (Step S<b>34</b>). When it is determined as YES at Step S<b>34</b>, the channel specifying unit <b>203</b> selects (specifies) the channel CH<b>2</b> (Step S<b>35</b>). When it is determined as NO at Step S<b>34</b>, the channel specifying unit <b>203</b> advances the process to Step S<b>36</b> without selecting the channel CH<b>2</b>.</p>
<p id="p-0195" num="0194">The channel specifying unit <b>203</b> determines whether the channel CH<b>1</b> has been selected (Step S<b>36</b>). When t it is determined as NO at Step S<b>36</b>, the channel specifying unit <b>203</b> advances the process to Step S<b>39</b>. When it is determined as YES at Step S<b>36</b>, the channel specifying unit <b>203</b> determines whether output of data of the channel CH<b>1</b> after being subjected to expansion is completed, i.e., whether compressed data temporarily stored in the input buffer <b>1092</b> of the channel CH<b>1</b> has been expanded and the expanded data has been output (Step S<b>37</b>). When it is determined as NO at Step S<b>37</b>, the channel specifying unit <b>203</b> waits the process; on the other hand, when it is determined as YES at Step S<b>37</b>, the channel specifying unit <b>203</b> cancels the selection of the channel CH<b>1</b> (Step S<b>38</b>), and advances the process to Step S<b>39</b>.</p>
<p id="p-0196" num="0195">The channel specifying unit <b>203</b> determines whether the channel CH<b>2</b> has been selected (Step S<b>39</b>). When it is determined as NO at Step S<b>39</b>, the channel specifying unit <b>203</b> advances the process to Step S<b>41</b>. When it is determined as YES at Step S<b>39</b>, the channel specifying unit <b>203</b> determines whether output of data of the channel CH<b>2</b> after being subjected to expansion is completed, i.e., whether compressed data temporarily stored in the input buffer <b>1092</b> of the channel CH<b>2</b> has been expanded and the expanded data has been output (Step S<b>40</b>). When it is determined as NO at Step S<b>40</b>, the channel specifying unit <b>203</b> waits the process; on the other hand, when it is determined as YES at Step S<b>40</b>, the channel specifying unit <b>203</b> cancels the selection of the channel CH<b>2</b> (Step S<b>41</b>), and advances the process to Step S<b>42</b>.</p>
<p id="p-0197" num="0196">The channel specifying unit <b>203</b> determines whether the processing of all the data is completed (Step S<b>42</b>), and when it is determined as YES, the channel specifying unit <b>203</b> terminates the process; when it is determined as NO, the channel specifying unit <b>203</b> returns the process to Step S<b>31</b>.</p>
<p id="p-0198" num="0197">Incidentally, in the flowchart described above, the fixed priority order in which it is constantly processed in the order from the channel CH<b>1</b> when a plurality of channels are simultaneously selected is employed; alternatively, the processing order can be changed depending on the last processed channel, i.e., the input channel last specified by the channel specifying unit <b>203</b>. For example, when the channel CH<b>1</b> is specified last, and the process of the channel CH<b>1</b> is being performed, the channel CH<b>1</b> is put at the bottom of the priority order (for example, Steps S<b>32</b> and S<b>33</b> are put after Steps S<b>34</b> and S<b>35</b>), so that the inequality in the channels can be alleviated.</p>
<p id="p-0199" num="0198">Furthermore, in the flowchart described above, a case of two channels is explained; the number of occurrences of overhead is equal to the number of arbitrations, so the more the number of channels operating at the same time (the more the number of channels specified), the more effective it is in reducing the overhead (the more the number of channels operating at the same time, the lower the ratio of the number of arbitrations to &#x201c;the number of channels times the number of blocks&#x201d;).</p>
<p id="p-0200" num="0199">Incidentally, the image forming apparatuses in the above embodiments can be applied to any of a multifunction product having at least any two of a copy function, a printer function, a scanner function, and a facsimile function, a printer, a scanner device, a facsimile machine, and the like.</p>
<p id="p-0201" num="0200">Furthermore, in the above embodiments, there are described examples of the applications of the decoding device according to the present invention to the image forming apparatus <b>1</b> that forms a color image on a sheet by the ink-jet method and the image forming apparatus <b>1</b><i>a </i>that forms a color image on a sheet by the electrophotographic method; however, an applicable device is not specifically limited to these image forming apparatuses. The decoding device according to the present invention can be applied to any device as long as the device needs to decode compressed data input on a channel-by-channel basis; for example, the decoding device according to the present invention can be also applied to a cellular phone, an image processing apparatus, and the like.</p>
<p id="p-0202" num="0201">According to the present invention, when compressed data input per channel is expanded in a time-sharing manner, it is possible to reduce a capacity of a channel-by-channel buffer for storing expanded data.</p>
<p id="p-0203" num="0202">Although the invention has been described with respect to specific embodiments for a complete and clear disclosure, the appended claims are not to be thus limited but are to be construed as embodying all modifications and alternative constructions that may occur to one skilled in the art that fairly fall within the basic teaching herein set forth.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A decoding device comprising:
<claim-text>a plurality of input units corresponding to a plurality of data transmission channels and configured to accept inputs of encoded compressed data through the corresponding data transmission channels;</claim-text>
<claim-text>a plurality of buffers configured to correspond to the data transmission channels;</claim-text>
<claim-text>a specifying unit configured to,
<claim-text>check whether there is free space in each of the plurality of buffers so as to specify a data transmission channel corresponding to a buffer having a free space, and</claim-text>
<claim-text>cause the input unit corresponding to the specified data transmission channel to accept the input of encoded compressed data;</claim-text>
</claim-text>
<claim-text>a detecting unit configured to,
<claim-text>analyze codes of the compressed data received from the input unit corresponding to the specified data transmission channels and</claim-text>
<claim-text>detect a delimit position in the compressed data based on the analysis;</claim-text>
</claim-text>
<claim-text>an expanding unit configured to expand the compressed data based on the delimit position detected by the detecting unit and independently from other inputs of encoded compressed data; and</claim-text>
<claim-text>a sorting unit configured to sort and store the expanded data into the buffer corresponding to the specified data transmission channel, wherein</claim-text>
<claim-text>the specifying unit is further configured to, in response to detection of the delimit position, cancel the specified data transmission channel and then specify a next data transmission channel.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The decoding device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the detecting unit detects the delimit position on the basis of an end code indicating an end of the compressed data.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The decoding device according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the sorting unit stops storage in the buffer corresponding to the specified data transmission channel in accordance with an end signal included in the expanded data, the end signal being obtained by expanding the end code.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The decoding device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the detecting unit detects the delimit position on a basis of a start code indicating a start of the inputted compressed data.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The decoding device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein
<claim-text>each of the input units accepts inputs of the compressed data and expanded data through the corresponding data transmission channel,</claim-text>
<claim-text>the decoding device further comprises a detouring unit configured to detour the expanded data accepted by the input unit, the detoured expanded data being an output to the sorting unit without passing through the expanding unit, and</claim-text>
<claim-text>the sorting unit sorts and stores the expanded data expanded by the expanding unit and the expanded data detoured by the detouring unit into the buffer corresponding to the corresponding data transmission channel.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The decoding device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising an input buffer configured to temporarily store the compressed data accepted by the input unit corresponding to the specified data transmission channel output the temporarily-stored compressed data to the expanding unit, wherein
<claim-text>the specifying unit specifies the next data transmission channel after waiting until all the compressed data temporarily stored in the input buffer has been expanded by the expanding unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The decoding device according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the specifying unit specifies a plurality of data transmission channels, as well as a next data transmission channel after waiting until compressed data temporarily stored in the input buffers corresponding to the specified data transmission channels has been all expanded.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The decoding device according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the specifying unit specifies the plurality of channels in an order depending on the lastly-specified data transmission channel.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. An image forming apparatus comprising:
<claim-text>a memory for storing a color image to be formed as compressed image data;</claim-text>
<claim-text>the decoding device according to <claim-ref idref="CLM-00001">claim 1</claim-ref> for expanding the compressed image data with respect to each color; and</claim-text>
<claim-text>an image forming unit that forms a color image on a sheet,</claim-text>
<claim-text>wherein the image forming unit uses the buffers included in the decoding device as color-by-color buffers and forms the color image on the basis of the image data for their respective colors stored in the buffers.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The image forming apparatus according to <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the image forming unit forms the color image by an ink-jet method on the basis of the image data for their respective colors stored in the buffers.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A decoding device comprising:
<claim-text>a plurality of input units corresponding to a plurality of data transmission channels and configured to accept inputs of encoded compressed data through the corresponding data transmission channels;</claim-text>
<claim-text>a plurality of buffers corresponding to the data transmission channels;</claim-text>
<claim-text>a specifying unit configured to,.
<claim-text>check whether there is free space in each of the buffers so as to specify a data transmission channel corresponding to a buffer having a free space, and</claim-text>
<claim-text>cause the input unit corresponding to the specified data transmission channel to accept the input of encoded compressed data;</claim-text>
</claim-text>
<claim-text>a detecting unit configured to detect a delimit position in the compressed data;</claim-text>
<claim-text>an expanding unit configured to expand the compressed data based on the position detected by the detecting unit and independently from other inputs of encoded compressed data;</claim-text>
<claim-text>a counting unit configured to count a data length of the expanded data; and</claim-text>
<claim-text>a sorting unit configured to sort and store the expanded data into the buffer corresponding to the specified data transmission channel, wherein</claim-text>
<claim-text>the specifying unit is further configured to cancel the specified data transmission channel upon the data length counted by the counting unit being a predetermined data length, and then specify a next data transmission channel.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The decoding device according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, further comprising an input buffer configured to temporarily store the compressed data accepted by the input unit corresponding to the specified data transmission channels and output the temporarily-stored compressed data to the expanding unit, wherein
<claim-text>the specifying unit specifies the next data transmission channel after waiting until all the compressed data temporarily stored in the input buffer has been expanded by the expanding unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The decoding device according to <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the specifying unit specifies the plurality of data transmission channels as well as a next data transmission channel after waiting until compressed data temporarily stored in the input buffers corresponding to the specified data transmission channels has been all expanded.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The decoding device according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the specifying unit specifies the plurality of channels in the order depending on an lastly-specified data transmission channel.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. An image forming apparatus comprising:
<claim-text>a memory for storing a color image to be formed as compressed image data;</claim-text>
<claim-text>the decoding device according to <claim-ref idref="CLM-00011">claim 11</claim-ref> for expanding the compressed image data with respect to each color; and</claim-text>
<claim-text>an image forming unit that forms a color image on a sheet,</claim-text>
<claim-text>wherein the image forming unit uses the buffers included in the decoding device as color-by-color buffers and forms the color image on the basis of the image data for their respective colors stored in the buffers.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The image forming apparatus according to <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the image forming unit forms the color image by an ink-jet method on the basis of the image data for their respective colors stored in the buffers.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. A method of controlling a decoding device including a plurality of input units corresponding to a plurality of data transmission channels and configured to accept inputs of encoded compressed data through corresponding data transmission channels and a plurality of buffers corresponding to the data transmission channels, the method comprising:
<claim-text>checking whether there is free space in each of the plurality of buffers to specify a data transmission channel corresponding to a buffer having a free space;</claim-text>
<claim-text>causing the input unit corresponding to the data transmission channels to accept the input of encoded compressed data;</claim-text>
<claim-text>analyzing codes of the compressed data received from the input unit corresponding to the data transmission channels</claim-text>
<claim-text>detecting a delimit position in the compressed data based on the analyzing;</claim-text>
<claim-text>expanding the compressed data based on the detected delimit position and independently from other inputs of encoded compressed data; and</claim-text>
<claim-text>sorting and storing expanded data into the buffer corresponding to the specified data transmission channel, wherein</claim-text>
<claim-text>at the specifying, in response to detection of the delimit position, the specified data transmission channel is cancelled and a next data transmission channel is specified.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The decoding device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein
<claim-text>the detecting unit divides the compressed data into delimited data pieces based on the delimit position, and</claim-text>
<claim-text>the expanding unit expands the compressed data received from the detecting unit in a unit of delimited data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The decoding device according to <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein
<claim-text>the detecting unit merges the delimited data pieces of the compressed data received from the input unit corresponding to the specified data transmission channel and delimited data pieces of the compressed data received from the input unit corresponding to the next data transmission channel, and</claim-text>
<claim-text>the expanding unit expands merged compressed data received from the detecting unit in a unit of delimited data. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
