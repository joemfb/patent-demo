<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625791-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625791</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12737260</doc-number>
<date>20090630</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="regional">
<country>EP</country>
<doc-number>08305364</doc-number>
<date>20080630</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>181</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20110101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>7</main-group>
<subgroup>167</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>380210</main-classification>
<further-classification>380 29</further-classification>
<further-classification>380201</further-classification>
</classification-national>
<invention-title id="d2e71">Methods and apparatuses for selective data encryption</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6931534</doc-number>
<kind>B1</kind>
<name>Jandel et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713176</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2001/0033656</doc-number>
<kind>A1</kind>
<name>Gligor et al.</name>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380 28</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2003/0231767</doc-number>
<kind>A1</kind>
<name>Carbajal</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380200</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2005/0110662</doc-number>
<kind>A1</kind>
<name>Mukherjee et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>341 50</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2005/0262573</doc-number>
<kind>A1</kind>
<name>Bo et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 27</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2009/0316901</doc-number>
<kind>A1</kind>
<name>Hayashi</name>
<date>20091200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380267</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>WO</country>
<doc-number>WO0031964</doc-number>
<date>20000600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00008">
<othercit>Schneier B Ed, &#x201c;Applied Cryptography, Description of DES&#x201d;, Second Edition, John Wiley &#x26; Sons, Inc. New York, Jan. 1, 1996, pp. 270-277, XP002237575, ISBN: 978-0-471-11709-4.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00009">
<othercit>Kunkelmann et al., &#x201c;A Scalable Security Architecture for Multimedia Communication Standards&#x201d;, Multimedia Computing and Systems '97 Proceedings, Los Alamitos, CA, Jun. 3, 1997, p. 660-661.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00010">
<othercit>Schneier, &#x201c;Applied Cryptography, Descriiption of DES&#x201d;, Applied Cryptography, Second Edition, Jan. 1, 1996, pp. 270-277.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00011">
<othercit>Fujii et al., &#x201c;Partial-Scrambling of Information&#x201d;, Japan Telecommunication Review, vol. 11., No. 1, Japan, Jan. 1, 1999, pp. 116-123.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00012">
<othercit>Search Report Dated Sep. 25, 2009.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>15</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>713150</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380210</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>4</number-of-drawing-sheets>
<number-of-figures>9</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110119480</doc-number>
<kind>A1</kind>
<date>20110519</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Massoudi</last-name>
<first-name>Ayoub</first-name>
<address>
<city>Issy les Moupineaux</city>
<country>AM</country>
</address>
</addressbook>
<residence>
<country>AM</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Lefebvre</last-name>
<first-name>Fr&#xe9;d&#xe9;ric</first-name>
<address>
<city>Rennes</city>
<country>FR</country>
</address>
</addressbook>
<residence>
<country>FR</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Massoudi</last-name>
<first-name>Ayoub</first-name>
<address>
<city>Issy les Moupineaux</city>
<country>AM</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Lefebvre</last-name>
<first-name>Fr&#xe9;d&#xe9;ric</first-name>
<address>
<city>Rennes</city>
<country>FR</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Tutunjian &#x26; Bitetto, P.C.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Thomson Licensing</orgname>
<role>03</role>
<address>
<city>Issy les Moulineaux</city>
<country>FR</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Brown</last-name>
<first-name>Christopher</first-name>
<department>2439</department>
</primary-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/EP2009/058161</doc-number>
<kind>00</kind>
<date>20090630</date>
</document-id>
<us-371c124-date>
<date>20101222</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO2010/000727</doc-number>
<kind>A </kind>
<date>20100107</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method of encryption, using an encryption key K with key length k, of at least one message M comprising uniformly distributed symbols, k bits are encrypted of messages at least k bits long, while shorter messages are lengthened, e.g. by padding or concatenation, to obtain a lengthened message at least k bits long before encryption. The encryption efficiency is thus optimized while the encryption security is retained. The encryption method is particularly suitable for JPEG2000 encoded packets comprising a message M. Also provided are an encryption apparatus, a decryption method and a decryption apparatus.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="55.96mm" wi="119.46mm" file="US08625791-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="232.41mm" wi="149.27mm" file="US08625791-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="213.02mm" wi="111.51mm" file="US08625791-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="177.12mm" wi="160.70mm" file="US08625791-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="215.98mm" wi="168.66mm" file="US08625791-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<p id="p-0002" num="0001">This application claims the benefit, under 35 U.S.C. &#xa7;365 of International Application PCT/EP2009/058161, filed Jun. 30, 2009, which was published in accordance with PCT Article 21(2) on Jan. 7, 2010 in English and which claims the benefit of European patent application No. 08305364.5, filed on Jun. 30, 2008.</p>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates generally to data encryption, and in particular to encryption of image data organised in packetized bit streams.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">This section is intended to introduce the reader to various aspects of art, which may be related to various aspects of the present invention that are described and/or claimed below. This discussion is believed to be helpful in providing the reader with background information to facilitate a better understanding of the various aspects of the present invention. Accordingly, it should be understood that these statements are to be read in this light, and not as admissions of prior art.</p>
<p id="p-0005" num="0004">As an illustrative example, the following description will be directed to protection of packetized video data streams, such as those obtained by for instance JPEG2000 encoding. The skilled person will however appreciate that the data protection of the present invention may also be used in analogous fields in which data is transmitted in packets having the necessary properties.</p>
<p id="p-0006" num="0005">It has long been known to protect video data by encryption, notably in conditional access television systems. <figref idref="DRAWINGS">FIG. 1</figref> illustrates a traditional prior art approach for content access control. The video signal CNT is first encoded <b>110</b> using a standard compression encoder, and the resulting bit stream CNT&#x2032; is then encrypted <b>120</b> using a symmetric encryption standard (such as DES, AES, or IDEA). The encrypted bit stream [CNT&#x2032;] is then received by a receiver that decrypts <b>130</b> the encrypted bit stream [CNT&#x2032;] to obtain an encoded bit stream CNT&#x2032; that is decoded <b>140</b> to obtain a video signal CNT that is, at least in theory, identical to the initial video signal. In this approach, called fully layered, compression and encryption are completely independent processes. The media bit stream is processed as classical plaintext data, with the assumption that all symbols or bits in the plaintext are of equal importance, i.e. the symbols are uniformly distributed.</p>
<p id="p-0007" num="0006">This scheme is relevant when the transmission of the content is unconstrained, but it seems inadequate in situations where resources (such as memory, power or computation capabilities) are limited. Another way of putting this is that it is sometimes desired to increase the capacity of e.g. a processor to process encrypted data.</p>
<p id="p-0008" num="0007">Further, much research shows the specific characteristic of image and video content&#x2014;high transmission rate and limited allowed bandwidth&#x2014;which justifies the inadequacy of standard cryptographic techniques for such content. This has led to researchers to explore a new scheme of securing the content&#x2014;named &#x201c;selective encryption&#x201d;, &#x201c;partial encryption&#x201d;, &#x201c;soft encryption&#x201d;, or &#x201c;perceptual encryption&#x201d;&#x2014;by applying encryption to a subset of a bit stream with the expectation that the resulting partially encrypted bit stream is useless without the decryption of the encrypted subset. The general approach is to separate the content into two parts: the first part is the basic part of the signal (for example Direct Current, DC, coefficients in Discrete Cosine Transform, DCT, decomposition, or the low frequency layer in Discrete Wavelet Transform, DWT, decomposition), which allows the reconstruction of an intelligible, but low quality version of the original signal, and a second part that could be called the &#x201c;enhancement&#x201d; part (for example Alternating Current, AC, coefficients in DCT decomposition of an image, or high frequency layers in DWT), which allows the recovery of fine details of the image and reconstruction of a high quality version of the original signal. According to this scheme, only the basic part is encrypted, while the enhancement part is sent unencrypted or in some cases with light-weight scrambling. The aim is to protect the content and not the binary stream itself.</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 2</figref> illustrates selective encryption according to the prior art. Encoding and decoding is performed as in <figref idref="DRAWINGS">FIG. 1</figref>. In selective encryption, the encoded bit stream CNT&#x2032; is encrypted <b>220</b> depending on selective encryption parameters <b>240</b>. These parameters may, as mentioned, for example state that only the DC coefficients or the low frequency layer should be encrypted, while the rest of the encoded bit stream CNT&#x2032; should be left unencrypted. The partially encrypted bit stream [CNT&#x2032;] is then (partially) decrypted <b>230</b> depending on the selective encryption parameters <b>240</b>.</p>
<p id="p-0010" num="0009">An exemplary selective encryption scheme is described by T. Kunkelmann and R. Reinema in &#x201c;A Scalable Security Architecture for Multimedia Communication Standards&#x201d;; Multimedia Computing and Systems '97. Proceedings, IEEE International Conference on Ottawa, Ont., Canada, 3-6 Jun. 1997, Los Alamitos, Calif., USA, IEEE Comput. Soc, US, 3 Jun. 1997, pages 660-661, XP010239268, ISBN: 978-0-8186-7819-6. To encrypt an 8&#xd7;8-block, two integer values smaller than 64 is chosen; one value is for the DC components and one for the AC components. The individual blocks are then encrypted, for example using DES with a key length of 64 bits (e.g. described by Scheier B: &#x201c;Applied Cryptography, Description of DES&#x201d; Applied Cryptography, Second Edition, Protocols, Algorithms and Source Code in C, John Wiley &#x26; Sons, Inc, New York, 1 Jan. 1996, pages 270-277, XP002237575, ISBN: 978-0-471-11709-4). Other suitable block encryption methods, such as the one described in US 2001/0033656, may apparently also be used. The process is iterated until a number of AC and/or DC components have been encrypted. In other words, not all the components are encrypted, but each component is fully encrypted.</p>
<p id="p-0011" num="0010">As the invention is particularly suitable for JPEG2000, which will also be used as a non-limitative embodiment of the invention, a brief introduction to relevant parts of this standard, i.e. its code stream structure, will now be given.</p>
<p id="p-0012" num="0011">The JPEG2000 code stream is organized into packets, code stream packets are elementary units that transport data from a specific combination of entities called Resolution, Layer, Component and Precinct. A compressed image with R resolutions, L layers, P precincts and C components, thus results in RxLxCxP packets.</p>
<p id="p-0013" num="0012">JPEG2000 makes use of an embedded bit stream: the code stream can be truncated at any given end of packet without adverse impact on previously coded ones.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 3</figref> illustrates the main code stream structure, comprising:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0014">A main header <b>310</b>, comprising a Start of Code stream (SOC=0xFF4F) marker segment <b>312</b> and the main header marker segments <b>314</b>. The SOC marker indicates the start of the code stream and is required as the first marker. The main header marker segments indicate many user defined compression parameters, such as for example progression order, main coding style, components coding style, and tile size.</li>
        <li id="ul0002-0002" num="0015">One or more Tile-part headers <b>320</b><i>a</i>, <b>320</b><i>b</i>, each comprising a Start of Tile-part marker (SOT=0xFF90) <b>322</b>, tile part information <b>324</b><i>a</i>, <b>324</b><i>b</i>, and a Start of Data marker (SOD=0xFF93) <b>326</b>. As will be appreciated, the SOT <b>322</b> and the SOD <b>326</b> have standard values, while the tile part information <b>324</b><i>a</i>, <b>324</b><i>b </i>comprises information about the tile; e.g. tile part information <b>324</b><i>a </i>indicates that it belongs to Tile <b>0</b>, while tile part information <b>324</b><i>b </i>indicates that it belongs to Tile <b>1</b>. At least one tile-part header <b>320</b><i>a</i>, <b>320</b><i>b </i>is required at the beginning of each tile-part, which comprises the tile-part header <b>320</b><i>a</i>, <b>320</b><i>b </i>and, usually, a following bit stream <b>330</b><i>a</i>, <b>330</b><i>b</i>, where the SOD marker indicates the start of the bit stream <b>330</b><i>a</i>, <b>330</b><i>b </i>that contains the compressed data.</li>
        <li id="ul0002-0003" num="0016">End of Code stream <b>340</b>: this marker (EOC=0xFFD9) indicates the end of the code stream.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0015" num="0017">As can be seen, the bit stream is mainly composed of packet headers and packet data that form packets. <figref idref="DRAWINGS">FIG. 4</figref> illustrates an exemplary JPEG2000 packet comprising a packet header <b>420</b> and packet data <b>440</b>. Packet headers may be used in the bit stream or in the main header depending on the user defined options. <figref idref="DRAWINGS">FIG. 4</figref> shows the use of such headers within the bit stream: a Start of Packet header <b>410</b> (SOP=0xFF91) and an End of Packet Header <b>430</b> (EPH=0xFF92) respectively indicate the start and the end of the packet header <b>420</b>.</p>
<p id="p-0016" num="0018">It should be noted that for packet data, some code words&#x2014;the ones in the range [0xFF90; 0xFFFF] are reserved in JPEG2000. Such reserved code words are used as markers that delimit the main building blocks of the stream. For example, the SOT (0xFF90), the SOD (0xFF93) and the EOC (OxFFD9) are such reserved code words. When encrypting the code stream, it is important to ensure that &#x2018;normal&#x2019; (i.e. non-reserved) code words do not result in encrypted code words whose value are reserved. Packet data are entropy encoded and this property makes them very suited for cryptographically secure selective encryption as will be described later.</p>
<p id="p-0017" num="0019">The packet header <b>420</b> comprises information needed by the decoder to correctly parse and decode the packet data:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0020">Zero length packet: indicates whether or not the current packet is empty.</li>
        <li id="ul0004-0002" num="0021">Code-block inclusion: for each precinct, a tag tree is used to encode inclusion information for code blocks included.</li>
        <li id="ul0004-0003" num="0022">Zero-bitplane information: for each precinct, a tag tree encodes the first non zero bit-plane.</li>
        <li id="ul0004-0004" num="0023">Number of coding passes: Huffman-style code words are used to encode the number of coding passes included for each code block.</li>
        <li id="ul0004-0005" num="0024">Length of compressed data from each code block.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0018" num="0025">In &#x201c;Techniques for a Selective Encryption of Uncompressed and Compressed Images&#x201d;, Proceedings of Advanced Concepts for Intelligent Vision Systems (ACIVS) 2002, Ghent, Belgium, Sep. 9-11, 2002, M. Van Droogenbroeck and R. Benedett propose to apply selective encryption to a Huffman coder. Indeed, JPEG Huffman coder terminates runs of zeros with code words/symbols in order to approach the entropy. Appended bits are added to these code words to fully specify the magnitudes and signs of non-zero coefficients, only these appended bits are encrypted using DES or IDEA.</p>
<p id="p-0019" num="0026">In &#x201c;Selective Encryption of Wavelet-Packet Encoded Image Data&#x201d;, ACM Multimedia Systems Journal, Special Issue on Multimedia Security in 2003, A. Pommer and A. Uhl propose an algorithm based on AES encryption of the header information of wavelet packet encoding of an image, the header specifying the sub-band tree structure.</p>
<p id="p-0020" num="0027">In &#x201c;Compliant Encryption of JPEG2000 Codestreams&#x201d;, IEEE International Conference on Image Processing (ICIP 2004), Singapore, October 2004, Y. Wu and R. H. Deng propose a JPEG2000 compliant encryption algorithm which iteratively encrypts Codeblock Contribution to Packets (CCPs). The encryption process acts on CCPs (in the packet data) using stream ciphers or block ciphers, preferably stream ciphers with arithmetic module addition. The key stream is generated using Rivest Cipher 4 (RC4). Each CCP is iteratively encrypted until it has no forbidden code words (i.e. any code word in the range [0xFF90, 0xFFFF]).</p>
<p id="p-0021" num="0028">In &#x201c;Selective Encryption of the JPEG2000 Bitstream&#x201d;, in A. Lioy and D. Mazzocchi, editors, Communications and Multimedia Security. Proceedings of the IFIP TC6/TC11 Sixth Joint Working Conference on Communications and Multimedia Security, CMS '03, volume 2828 of Lecture Notes on Computer Science, pages 194-204, Turin, Italy, October 2003. Springer-Verlag, R. Norcen and A. Uhl observe that JPEG2000 is an embedded bit stream and that, in progression order JPEG2000 compressed images, the most important data is sent at the beginning of the bit stream. Based on this, the proposed scheme consists in AES encryption of selected packet data. The algorithm uses two optional markers SOP and EPH (as illustrated in <figref idref="DRAWINGS">FIG. 4</figref>) to identify packet data. Then, this packet data is encrypted using AES in CFB mode, as the packet data has variable length. The experiments were conducted on two kinds of images (lossy and lossless compressed), with different progression orders (resolution and layer progression orders). The evaluation criterion was the visual degradation obtained for a given amount of encrypted data. It was found that for the lossy compressed images, layer progression gives better results. For lossless compressed images, resolution progression gives better results.</p>
<p id="p-0022" num="0029">European patent application EP 08300093.5, provides an improved solution that uses a distortion-to-rate ratio for each packet to order the packets in descending ratio and encrypt packets until a predetermined accumulated distortion is achieved.</p>
<p id="p-0023" num="0030">The Applicant has discovered, however, that the there is still room for improvement when encrypting packet data.</p>
<p id="p-0024" num="0031">It can therefore be appreciated that there is a need for a solution that allows further improvement to encryption without unacceptably diminishing the security of the encrypted content. This invention provides such a solution.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0025" num="0032">In a first aspect, the invention is directed to a method of encryption, using an encryption key K with key length k, of at least one message M of uniformly distributed symbols. k bits are encrypted of each of the at least one message M with a length of k bits; and at least k bits and less than the whole length of message M are encrypted of each of the at least one message M longer than k bits.</p>
<p id="p-0026" num="0033">In a first preferred embodiment, at least one message M shorter than k bits is lengthened in order to obtain a lengthened message at least k bits long. k bits of the lengthened message are encrypted, if the lengthened message is k bits long; and at least k bits and less than the whole length of the lengthened message are encrypted, if the lengthened message is longer than k bits. It is advantageous that the at least one message M is lengthened by padding or by concatenation with at least one further message.</p>
<p id="p-0027" num="0034">In a second preferred embodiment, exactly k bits of the messages longer than k bits are encrypted. It is advantageous that the uniformly distributed symbols further are causal.</p>
<p id="p-0028" num="0035">In a third preferred embodiment, the at least one message M is JPEG2000 encoded.</p>
<p id="p-0029" num="0036">In a second aspect, the invention is directed to an apparatus for encryption, using an encryption key K with key length k, of at least one message M of uniformly distributed symbols. The apparatus comprises a processor adapted to encrypt k bits of each of the at least one message M with a length of k bits; and encrypt at least k bits and less than the whole length of message M of each of the at least one message M longer than k bits.</p>
<p id="p-0030" num="0037">In a third aspect, the invention is directed to a method of decryption, using a decryption key K with key length k, of at least one encrypted message [M]. A decryption device decrypts k bits of each of the at least one encrypted message [M] with a length of k bits; and decrypts at least k bits and less than the whole length of message M of each of the at least one message M longer than k bits.</p>
<p id="p-0031" num="0038">In a fourth aspect, the invention is directed to an apparatus for decryption of at least one encrypted message [M] using an encryption key K with key length k. The apparatus comprises a processor adapted to decrypt k bits of each of the at least one message M with a length of k bits; and decrypt at least k bits and less than the whole length of message M of each of the at least one message M longer than k bits.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0032" num="0039">Preferred features of the present invention will now be described, by way of non-limiting example, with reference to the accompanying drawings, in which:</p>
<p id="p-0033" num="0040"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a traditional prior art approach for content access control;</p>
<p id="p-0034" num="0041"><figref idref="DRAWINGS">FIG. 2</figref> illustrates selective encryption according to the prior art;</p>
<p id="p-0035" num="0042"><figref idref="DRAWINGS">FIG. 3</figref> illustrates the prior art JPEG2000 main code stream structure;</p>
<p id="p-0036" num="0043"><figref idref="DRAWINGS">FIG. 4</figref> illustrates an exemplary prior art JPEG2000 packet;</p>
<p id="p-0037" num="0044"><figref idref="DRAWINGS">FIG. 5</figref> illustrates JPEG2000 packets emanating from the coding of an image according to the prior art;</p>
<p id="p-0038" num="0045"><figref idref="DRAWINGS">FIG. 6</figref> illustrates schematically a message M encrypted using an embodiment idea of the invention;</p>
<p id="p-0039" num="0046"><figref idref="DRAWINGS">FIG. 7</figref> illustrates an encryption device for selective encryption according to a preferred embodiment of the invention;</p>
<p id="p-0040" num="0047"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a method for selective encryption according to a preferred embodiment of the invention; and</p>
<p id="p-0041" num="0048"><figref idref="DRAWINGS">FIG. 9</figref> illustrates a decryption device according to a preferred embodiment of the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">PREFERRED EMBODIMENT OF THE INVENTION</heading>
<p id="p-0042" num="0049">The invention uses an intrinsic property of JPEG2000 coding as a starting point to arrive at its surprising destination. In JPEG2000, Codeblock contribution to packet (CCP) is causal. Indeed, a codeblock is encoded by the CABAC (Context-Adaptive Binary Arithmetic Coding) coder which is context based. In other words, it is impossible to correctly decode a CCP without access to the beginning of the data, which makes it possible to encrypt less than the entire packet in order to guarantee cryptographic security.</p>
<p id="p-0043" num="0050"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a number of JPEG2000 encoded packets corresponding to an encoded image according to the prior art. The packets are arranged so that packets corresponding to a certain quality Layer (L) are in the same row.</p>
<p id="p-0044" num="0051"><figref idref="DRAWINGS">FIG. 6</figref> illustrates a message M with n bytes of which n<sub>e </sub>bytes are to be encrypted. M is made up of uniformly distributed symbols that, for example in the case of JPEG2000, may be causal. It should be noted that the message M may be regarded as payload, i.e. it does not comprise any headers, but the entire message M is for use to the receiver. To determine the amount of data to encrypt from message M, i.e. n<sub>e</sub>, let us consider the message M (representing a CCP), which is encrypted with an encryption ratio ER:</p>
<p id="p-0045" num="0052">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mi>ER</mi>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <msub>
        <mi>n</mi>
        <mi>e</mi>
      </msub>
      <mi>n</mi>
    </mfrac>
    <mo>=</mo>
    <mfrac>
      <msub>
        <mi>n</mi>
        <mi>e</mi>
      </msub>
      <mrow>
        <mo>&#xf603;</mo>
        <mi>M</mi>
        <mo>&#xf604;</mo>
      </mrow>
    </mfrac>
  </mrow>
</mrow>
</math>
</maths>
<br/>
where |M| is the number of bits of M.
</p>
<p id="p-0046" num="0053">In order to find the minimum encryption ratio that guarantees cryptographic security, use is made of a metric to measure the unpredictability of the encrypted message.</p>
<p id="p-0047" num="0054">The main idea is to consider an optimal brute force attack where the attacker has complete knowledge of the probability distribution of the language symbols. Let X be a discrete random variable that takes its values in the language
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>L</i><sup>n</sup><sup><sub2>e</sub2></sup><i>,X&#x3b5;{X</i><sub>1</sub><i>,X</i><sub>2 </sub><i>. . . X</i><sub>|L</sub><sub><sup2>n</sup2></sub><sub>e|</sub>}.<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0048" num="0055">The attacker would try to guess the value of X by trying all possible values in the decreasing order of their probabilities:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>p</i><sub>1</sub><i>&#x2267;p</i><sub>2 </sub><i>. . . &#x2267;p</i><sub>|L</sub><sub><sup2>n</sup2></sub><sub>e|</sub><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0049" num="0056">This gives a guesswork W:</p>
<p id="p-0050" num="0057">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>W</mi>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mi>X</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <munderover>
      <mo>&#x2211;</mo>
      <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
      </mrow>
      <mrow>
        <mo>&#xf603;</mo>
        <msup>
          <mi>L</mi>
          <msub>
            <mi>n</mi>
            <mi>e</mi>
          </msub>
        </msup>
        <mo>&#xf604;</mo>
      </mrow>
    </munderover>
    <mo>&#x2062;</mo>
    <mrow>
      <mi>i</mi>
      <mo>&#xb7;</mo>
      <msub>
        <mi>p</mi>
        <mi>i</mi>
      </msub>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
where W(X) is the expected number of guesses an attacker has to try before finding the right message X.
</p>
<p id="p-0051" num="0058">Note that since codeblock contributions are coded using arithmetic coding which outputs uniformly distributed data:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>p</i><sub>i</sub>=1/<i>|L</i><sup>n</sup><sup><sub2>e</sub2></sup>|=1/|&#x3a3;|<sup>n</sup><sup><sub2>e </sub2></sup><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where &#x3a3; is the alphabet for codeblock contributions. This gives a guesswork value of:
</p>
<p id="p-0052" num="0059">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>W</mi>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mi>X</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mfrac>
        <mn>1</mn>
        <msup>
          <mrow>
            <mo>&#xf603;</mo>
            <mo>&#x2211;</mo>
            <mo>&#xf604;</mo>
          </mrow>
          <msub>
            <mi>n</mi>
            <mi>e</mi>
          </msub>
        </msup>
      </mfrac>
      <mo>&#x2062;</mo>
      <mrow>
        <munderover>
          <mo>&#x2211;</mo>
          <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <msup>
            <mrow>
              <mo>&#xf603;</mo>
              <mo>&#x2211;</mo>
              <mo>&#xf604;</mo>
            </mrow>
            <msub>
              <mi>n</mi>
              <mi>e</mi>
            </msub>
          </msup>
        </munderover>
        <mo>&#x2062;</mo>
        <mi>i</mi>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <msup>
          <mrow>
            <mo>&#xf603;</mo>
            <mo>&#x2211;</mo>
            <mo>&#xf604;</mo>
          </mrow>
          <msub>
            <mi>n</mi>
            <mi>e</mi>
          </msub>
        </msup>
        <mo>+</mo>
        <mn>1</mn>
      </mrow>
      <mn>2</mn>
    </mfrac>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0053" num="0060">On the other hand, if the attacker uses key guessing, the expected number of key W(K) that must be guessed (or tried) to find the correct key is given, for a k-bit key, is given by:</p>
<p id="p-0054" num="0061">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>W</mi>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mi>K</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <munderover>
        <mo>&#x2211;</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
        </mrow>
        <msup>
          <mn>2</mn>
          <mi>k</mi>
        </msup>
      </munderover>
      <mo>&#x2062;</mo>
      <mfrac>
        <mi>i</mi>
        <msup>
          <mn>2</mn>
          <mi>k</mi>
        </msup>
      </mfrac>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <msup>
          <mn>2</mn>
          <mi>k</mi>
        </msup>
        <mo>+</mo>
        <mn>1</mn>
      </mrow>
      <mn>2</mn>
    </mfrac>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0055" num="0062">From the two latter equations, we can conclude that brute force attack on the message space is harder than key guessing if W(X)&#x2267;W(K), which may also be expressed as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>|&#x3a3;|<sup>n</sup><sup><sub2>e</sub2></sup>&#x2267;2<sup>k </sup><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0056" num="0063">Hence, the size of the encrypted part has a lower bound determined by:</p>
<p id="p-0057" num="0064">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>n</mi>
    <mi>e</mi>
  </msub>
  <mo>&#x2265;</mo>
  <mfrac>
    <mi>k</mi>
    <mrow>
      <msub>
        <mi>log</mi>
        <mn>2</mn>
      </msub>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mo>&#xf603;</mo>
          <mo>&#x2211;</mo>
          <mo>&#xf604;</mo>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mfrac>
</mrow>
</math>
</maths>
</p>
<p id="p-0058" num="0065">In an exemplary embodiment of a JPEG2000 selective encryption algorithm typical values comprise:
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0066">With well studied encryption algorithm AES-128, k=128</li>
        <li id="ul0006-0002" num="0067">|&#x3a3;|=256</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0059" num="0068">This gives:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>n</i><sub>e</sub>&#x2267;16<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0060" num="0069">To summarize, given these parameters, it is recommended that the encrypted part is at least as long as the encryption key (128 bits=16 bytes); otherwise, the encryption algorithm can be bypassed and brute force attack on the plaintext space becomes easier for the attacker. Thus, the encryption efficiency is increased while keeping encryption security if the number of encrypted bits lies between k and |M|&#x2212;1.</p>
<p id="p-0061" num="0070">In the general JPEG2000 case, let us consider a packet data belonging to Pack<sub>e </sub>and containing contributions from p code blocks {m<sub>1</sub>, m<sub>2</sub>, . . . , m<sub>p</sub>}, according to the invention, to ensure cryptographic security, at least</p>
<p id="p-0062" num="0071">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mfrac>
  <mi>k</mi>
  <mrow>
    <msub>
      <mi>log</mi>
      <mn>2</mn>
    </msub>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mo>&#xf603;</mo>
        <mo>&#x2211;</mo>
        <mo>&#xf604;</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
</mfrac>
</math>
</maths>
<br/>
bytes from each codeblock contribution should be encrypted. The skilled person will appreciate that this result can be generalised to data resulting from other suitable encoding methods.
</p>
<p id="p-0063" num="0072">However, in order to optimize the encryption, it is preferred that exactly this number of bytes be encrypted. For this purpose, during the encoding process, metadata is generated for each packet in Pack<sub>e </sub>that gives the length of each codeblock contribution. If a codeblock contribution is smaller than</p>
<p id="p-0064" num="0073">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mrow>
  <mfrac>
    <mi>k</mi>
    <mrow>
      <msub>
        <mi>log</mi>
        <mn>2</mn>
      </msub>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mo>&#xf603;</mo>
          <mo>&#x2211;</mo>
          <mo>&#xf604;</mo>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mfrac>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
the entire codeblock contribution is encrypted. This approach can allow achieving the lowest encryption ratio for the target application requirements that guarantees cryptographic security.
</p>
<p id="p-0065" num="0074">In the exemplary JPEG2000 embodiment, it is, as mentioned sufficient to encrypt 128 bits (as AES-128 is used).</p>
<p id="p-0066" num="0075">The minimum encryption ratio is achieved if only the most significant layer in L<sub>e </sub>is selected for encryption. The same visual distortion is then achieved, for cryptographically secure encryption.</p>
<p id="p-0067" num="0076"><figref idref="DRAWINGS">FIG. 7</figref> illustrates an encryption device for selective encryption according to a preferred embodiment of the invention. The encryption device <b>710</b> comprises at least one processor (hereinafter &#x201c;processor&#x201d;) <b>720</b>, an input <b>730</b> for receiving at least one message M to encrypt and an output <b>740</b> for outputting encrypted messages [M].</p>
<p id="p-0068" num="0077">With further reference to <figref idref="DRAWINGS">FIG. 8</figref>, the processor <b>720</b> is adapted to receive a message M to encrypt, step <b>810</b>. In step <b>820</b>, the processor determines if the message length |M| is longer than or equal to the length k of encryption key K. If this is the case, then the processor <b>720</b> encrypts k bits, preferably the first k bits, of message M using the encryption key K in step <b>830</b>. On the other hand, if the message length |M| is shorter than the encryption key length k, then the processor <b>720</b> concatenates <b>840</b> message M with further messages to obtain a message that is at least k bits long and then encrypts k bits of the concatenated message using the encryption key K. It should be noted that the concatenation advantageously is for encryption purposes only, which is to say that the encrypted concatenated message is then separated into its respective encrypted messages. It should be noted that it is also possible to pad a message M that is too short so that padded message M comprises k bits. In this case, it may be necessary to add information about the padding in order for the receiver to be able to remove the padding.</p>
<p id="p-0069" num="0078">In JPEG2000, it is advantageous to concatenate the message M, whenever necessary, with the message having the same Resolution (R), Component (C) and Precinct (P) from the nearest underlying quality layer (L). In other words, the message corresponding to R<sub>i</sub>C<sub>i</sub>P<sub>i</sub>L<sub>i </sub>is concatenated with the message corresponding to R<sub>i</sub>C<sub>i</sub>P<sub>i</sub>L<sub>i+1 </sub>(with L<sub>0 </sub>being the most significant layer) and so on until the length of the concatenation has the required length.</p>
<p id="p-0070" num="0079">It will be appreciated that in most cases, message M is the payload part of a packet. It is naturally also possible that the message M is part of the payload of a packet. In these cases, the header part is not encrypted.</p>
<p id="p-0071" num="0080"><figref idref="DRAWINGS">FIG. 9</figref> illustrates a decryption device according to a preferred embodiment of the invention. The decryption device <b>910</b> comprises at least one processor (hereinafter &#x201c;processor&#x201d;) <b>920</b>, an input <b>930</b> for receiving at least one message [M] to decrypt and an output <b>940</b> for outputting decrypted messages M.</p>
<p id="p-0072" num="0081">Although not illustrated in a Figure, the decryption method mirrors the encryption method illustrated in <figref idref="DRAWINGS">FIG. 8</figref>. The processor <b>920</b> is adapted to receive a message [M] to decrypt. The processor <b>920</b> determines if the message length |M| is longer than or equal to the length k of decryption key K. If this is the case, then the processor <b>920</b> decrypts k bits&#x2014;the ones encrypted by an encryption device&#x2014;of message [M] using the decryption key K. On the other hand, if the message length |M| is shorter than the encryption key length k, then the processor <b>920</b> concatenates encrypted messages |M] in order to obtain a concatenated message that is at least as long as the encryption key, and decrypts k bits of the concatenated message using the decryption key K. In case padding was used during the encryption, no message is shorter than k bits, so each message may be decrypted using the decryption key K and the padding may be removed (possibly using information provided by the transmitter) if necessary.</p>
<p id="p-0073" num="0082">It is advantageous that the message M be at least part of the payload of a packet, as this makes it much easier for the decryption device to separate any concatenated messages.</p>
<p id="p-0074" num="0083">As will be appreciated, in the preferred embodiment, the key K is a symmetric key, i.e. the encryption key and the decryption key are identical. However, it is also possible to use asymmetrical encryption schemes, for example based upon elliptic curves. In this case, it is the length of the decryption key that determines the number of bits of a message to encrypt.</p>
<p id="p-0075" num="0084">Each feature disclosed in the description and (where appropriate) the claims and drawings may be provided independently or in any appropriate combination. Features described as being implemented in hardware may also be implemented in software, and vice versa. Connections may, where applicable, be implemented as wireless connections or wired, not necessarily direct or dedicated connections.</p>
<p id="p-0076" num="0085">It will be appreciated that the present invention is not limited to the preferred embodiment, JPEG2000, but may equally be used in other systems having a similar, layered architecture of the compressed pictures.</p>
<p id="p-0077" num="0086">Reference numerals appearing in the claims are by way of illustration only and shall have no limiting effect on the scope of the claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08625791-20140107-M00001.NB">
<img id="EMI-M00001" he="6.01mm" wi="76.20mm" file="US08625791-20140107-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08625791-20140107-M00002.NB">
<img id="EMI-M00002" he="9.14mm" wi="76.20mm" file="US08625791-20140107-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08625791-20140107-M00003.NB">
<img id="EMI-M00003" he="9.14mm" wi="76.20mm" file="US08625791-20140107-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US08625791-20140107-M00004.NB">
<img id="EMI-M00004" he="9.57mm" wi="76.20mm" file="US08625791-20140107-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US08625791-20140107-M00005.NB">
<img id="EMI-M00005" he="6.69mm" wi="76.20mm" file="US08625791-20140107-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US08625791-20140107-M00006.NB">
<img id="EMI-M00006" he="6.69mm" wi="76.20mm" file="US08625791-20140107-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US08625791-20140107-M00007.NB">
<img id="EMI-M00007" he="6.69mm" wi="76.20mm" file="US08625791-20140107-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of encryption of a message M of uniformly distributed symbols using an encryption key K with key length k, the method being performed using a processor in an encryption device and comprising the steps of:
<claim-text>determining if the message M is longer than, as long as, or shorter than the key length k; and</claim-text>
<claim-text>encrypting the message M;</claim-text>
<claim-text>wherein k bits are encrypted for the message M with a length of k bits;</claim-text>
<claim-text>wherein exactly k bits are encrypted for the message M with a length longer than k bits; and</claim-text>
<claim-text>for a message M with a length shorter than the key length k:
<claim-text>concatenating the message M with at least one further message in order to obtain a lengthened message at least k bits long; and</claim-text>
<claim-text>encrypting exactly k bits of the lengthened message.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the uniformly distributed symbols further are causal.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the at least one message M is JPEG2000 encoded.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. An apparatus for encryption of at least one message M of uniformly distributed symbols using an encryption key K with key length k, the apparatus comprising a processor configured to:
<claim-text>determine if the message M is longer than, as long as, or shorter than the key length k; and</claim-text>
<claim-text>encrypt the message M;</claim-text>
<claim-text>wherein the processor is configured to encrypt k bits of each message M with a length of k bits, encrypt exactly k bits of the message M having a length longer than k bits, and for a message M having a length shorter than the key length k:
<claim-text>concatenate the message M with at least one further message in order to obtain a lengthened message at least k bits long; and</claim-text>
<claim-text>encrypt exactly k bits of the lengthened message.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A method of decryption of an encrypted message using a decryption key with key length k, the method being performed using a processor in an decryption device and comprising the steps of:
<claim-text>determining if the encrypted message is longer than, as long as, or short than the key length k;</claim-text>
<claim-text>decrypting each of the at least one encrypted message;</claim-text>
<claim-text>wherein k bits are decrypted for the encrypted message with a length of k bits;</claim-text>
<claim-text>wherein exactly k bits of the encrypted message are decrypted for the encrypted message having a length longer than k bits; and</claim-text>
<claim-text>for the encrypted message having a length shorter than k bits:
<claim-text>concatenating the encrypted message with at least one further encrypted message in order to obtain a lengthened message at least k bits long; and</claim-text>
<claim-text>decrypting exactly k bits of the lengthened message.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. An apparatus for decryption of at least one encrypted message using a decryption key with key length k, the apparatus comprising a processor configured to:
<claim-text>determine if the encrypted message is longer than, as long as, or shorter than the key length k; and</claim-text>
<claim-text>decrypt the encrypted message;</claim-text>
<claim-text>wherein the processor is configured to decrypt k bits of the encrypted message having a length of k bits;</claim-text>
<claim-text>wherein the processor is configured to decrypt exactly k bits of the encrypted message having a length longer than k bits; and</claim-text>
<claim-text>for the encrypted message having a length shorter than k bits:
<claim-text>concatenate the encrypted message with at least one further encrypted message in order to obtain a lengthened message at least k bits long; and</claim-text>
<claim-text>decrypt exactly k bits of the lengthened message.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the encrypted message is at least part of a payload of a packet.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the encrypted message comprises encrypted data of a bit stream.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the at least one further encrypted message comprises encrypted data of the bit stream and is payload of a further packet.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The apparatus of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the encrypted message is at least part of a payload packet.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The apparatus of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the encrypted message comprises encrypted data of a bit stream.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The apparatus of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the at least one further encrypted message comprises encrypted data of the bit stream and is payload of a further packet.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The apparatus of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the message comprises entropy encoded data.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. the apparatus of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the entropy encoded data has been coded by a context-based encoder.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The apparatus of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the encrypted message is an encryption of at least one JPEG encoded codeblock.</claim-text>
</claim>
</claims>
</us-patent-grant>
