<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625623-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625623</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13021514</doc-number>
<date>20110204</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<us-term-extension>175</us-term-extension>
<disclaimer>
<text>This patent is subject to a terminal disclaimer.</text>
</disclaimer>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>12</main-group>
<subgroup>28</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>370413</main-classification>
<further-classification>710316</further-classification>
</classification-national>
<invention-title id="d2e55">Method and system to allocate exchange identifications for fibre channel N<sub>&#x2014;</sub>PORT aggregation</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6356944</doc-number>
<kind>B1</kind>
<name>McCarty</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6721320</doc-number>
<kind>B1</kind>
<name>Hoglund et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6801960</doc-number>
<kind>B1</kind>
<name>Ericson et al.</name>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6847647</doc-number>
<kind>B1</kind>
<name>Wrenn</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7197047</doc-number>
<kind>B2</kind>
<name>Latif et al.</name>
<date>20070300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7307995</doc-number>
<kind>B1</kind>
<name>Iyer et al.</name>
<date>20071200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7460528</doc-number>
<kind>B1</kind>
<name>Chamdani et al.</name>
<date>20081200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370381</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2002/0147843</doc-number>
<kind>A1</kind>
<name>Rao</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709245</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2002/0156918</doc-number>
<kind>A1</kind>
<name>Valdevit et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2003/0091037</doc-number>
<kind>A1</kind>
<name>Latif et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2003/0198251</doc-number>
<kind>A1</kind>
<name>Black et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2004/0174867</doc-number>
<kind>A1</kind>
<name>Nelson et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370352</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2005/0010735</doc-number>
<kind>A1</kind>
<name>Ito et al.</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2005/0030954</doc-number>
<kind>A1</kind>
<name>Dropps et al.</name>
<date>20050200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2005/0052920</doc-number>
<kind>A1</kind>
<name>Martin et al.</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2005/0080881</doc-number>
<kind>A1</kind>
<name>Voorhees et al.</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2005/0169188</doc-number>
<kind>A1</kind>
<name>Cometto et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2005/0243817</doc-number>
<kind>A1</kind>
<name>Wrenn et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2006/0092932</doc-number>
<kind>A1</kind>
<name>Ghosh et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00020">
<othercit>Cisco MDS 9000 Family Fabric Manger User's Guide, Cisco Systems, Inc., San Jose, CA, Release 1.2(1a), Sep. 2003, 149 pgs.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>370413</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370352</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370381</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709245</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>10</number-of-drawing-sheets>
<number-of-figures>10</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>11201107</doc-number>
<date>20050811</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>7907626</doc-number>
</document-id>
</parent-grant-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13021514</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60600834</doc-number>
<date>20040812</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110122888</doc-number>
<kind>A1</kind>
<date>20110526</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Saklecha</last-name>
<first-name>Bhavi</first-name>
<address>
<city>Fremont</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Hurley</last-name>
<first-name>Kean P.</first-name>
<address>
<city>Aptos</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Ip</last-name>
<first-name>Alfonso Y.</first-name>
<address>
<city>Fremont</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Saklecha</last-name>
<first-name>Bhavi</first-name>
<address>
<city>Fremont</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Hurley</last-name>
<first-name>Kean P.</first-name>
<address>
<city>Aptos</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Ip</last-name>
<first-name>Alfonso Y.</first-name>
<address>
<city>Fremont</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Sterne, Kessler, Goldstein &#x26; Fox PLLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Broadcom Corporation</orgname>
<role>02</role>
<address>
<city>Irvine</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Wilson</last-name>
<first-name>Robert</first-name>
<department>2475</department>
</primary-examiner>
<assistant-examiner>
<last-name>Preval</last-name>
<first-name>Lionel</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method and system for allocating exchange identifications (IDs) in a fiber channel switch for fiber channel aggregation. The method included determining a number (m) of N_ports present in a back end of the switch, and distributing available exchange IDs across the number (m) of present N_ports. Each exchange ID includes (j) bits and (n) bits are used to identify each of the present backend ports, where m&#x2266;2<sup>n</sup>.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="91.61mm" wi="158.75mm" file="US08625623-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="158.75mm" wi="102.62mm" orientation="landscape" file="US08625623-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="212.85mm" wi="167.72mm" orientation="landscape" file="US08625623-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="208.62mm" wi="158.75mm" orientation="landscape" file="US08625623-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="250.70mm" wi="155.87mm" orientation="landscape" file="US08625623-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="130.13mm" wi="123.53mm" orientation="landscape" file="US08625623-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="136.74mm" wi="141.05mm" orientation="landscape" file="US08625623-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="234.95mm" wi="142.41mm" orientation="landscape" file="US08625623-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="226.65mm" wi="168.40mm" orientation="landscape" file="US08625623-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="138.35mm" wi="147.91mm" orientation="landscape" file="US08625623-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="146.30mm" wi="134.79mm" orientation="landscape" file="US08625623-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is a Continuation of co-pending U.S. application Ser. No. 11/201,107 filed on Aug. 11, 2005 by SAKLECHA, Bhavi et al., the entire contents of which is incorporated herein by reference and for which priority is claimed under 35 U.S.C. &#xa7;120. As in the parent U.S. application Ser. No. 11/201,107, this application also claims the benefit of U.S. Provisional Patent Application No. 60/600,834, filed on Aug. 12, 2004, which is incorporated herein by reference in its entirety and for which priority is claimed under 35 U.S.C. &#xa7;119(e).</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">1. Field of the Invention</p>
<p id="p-0004" num="0003">The present invention generally relates to a network of devices. More particularly, it relates to an apparatus and system for coupling and decoupling data storage initiator devices to a network without disrupting the network.</p>
<p id="p-0005" num="0004">2. Related Art</p>
<p id="p-0006" num="0005">The data storage market includes a number of vendors and products. Unfortunately, integrating various products from different vendors is difficult, and it requires a substantial investment due to a lack of interoperability standards.</p>
<p id="p-0007" num="0006">In one instance, in order to increase system performance and lower costs, the manufacturers of blade servers and other storage devices are considering integrating a Fibre Channel fabric switch into their devices. However, a blade server with an integrated fabric switch is likely to have difficulties communicating to an external network because of incompatibilities and proprietary features. The conventional wisdom is that such devices are connected using a Fibre Channel E-Port or B-Port topology, thereby allowing fabric related information to be communicated. But, this causes many currently available Fibre Channel fabric switches to be reconfigured to a mode in which proprietary features are turned off and functions are disabled, resulting in a disruption of the network. It is also likely to create network management problems.</p>
<p id="p-0008" num="0007">What is needed, therefore, are new ways for integrating products from different venders to an existing network that overcome the deficiencies noted above.</p>
<heading id="h-0003" level="1">BRIEF SUMMARY OF THE INVENTION</heading>
<p id="p-0009" num="0008">Consistent with the principles of the present invention as embodied and broadly described herein, the present invention includes a method and system for allocating exchange identifications (IDs) in a fibre channel switch for fibre channel aggregation. The method included determining a number (m) of N_ports present in a back end of the switch, and distributing available exchange IDs across the number (m) of present N_ports. Each exchange ID includes (j) bits and (n) bits are used to identify each of the present backend ports, where m&#x2266;2<sup>n</sup>.</p>
<p id="p-0010" num="0009">Further features and advantages of the present invention, as well as the structure and operation of various embodiments of the present invention, are described in detail below with reference to the accompanying drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS/FIGURES</heading>
<p id="p-0011" num="0010">The accompanying drawings, which are incorporated in and constitute part of the specification, illustrate embodiments of the invention and, together with the general description given above and detailed description given below, serve to explain the principles of the invention. In the drawings:</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic diagram of an example apparatus for coupling and decoupling multiple processing devices to a network according to an embodiment of the invention;</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic diagram of an example system according to an embodiment of the invention;</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram illustration of an embodiment of the present invention configured for operation as an N_PORT Mode Model;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 4</figref> is block diagram illustration of extended link service frame flow in accordance with an embodiment of the present invention;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram illustration of a phantom port to N_PORT data path in accordance with an embodiment of the present invention;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram illustration of an N_PORT to phantom port data path in accordance with an embodiment of the present invention;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 7</figref> is a block diagram illustration of an exemplary IO table in accordance with an embodiment of the present invention;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 8</figref> is a schematic diagram illustrating operation of a management agent and routing of frame traffic according to an embodiment of the present invention;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 9</figref> is a flow diagram of an exemplary method of practicing a first aspect of an embodiment of the present invention; and</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 10</figref> is a flow diagram of an exemplary method of practicing a second aspect of an embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0022" num="0021">The following detailed description of the present invention refers to the accompanying drawings that illustrate exemplary embodiments consistent with this invention. Other embodiments are possible, and modifications may be made to the embodiments within the spirit and scope of the invention. Therefore, the following detailed description is not meant to limit the invention. Rather, the scope of the invention is defined by the appended claims.</p>
<p id="p-0023" num="0022">It would be apparent to one skilled in the art that the present invention, as described below, may be implemented in many different embodiments of hardware, software, firmware, and/or the entities illustrated in the drawings. For example, embodiments include a tangible computer readable storage medium carrying one or more sequences of one or more instructions for execution by one or more processors. Any actual software code with the specialized, controlled hardware to implement the present invention is not limiting of the present invention. Thus, the operation and behavior of the present invention will be described with the understanding that modifications and variations of the embodiments are possible, given the level of detail presented herein.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 1</figref> illustrates an example apparatus <b>100</b> for coupling and decoupling multiple processing or initiator devices to a network according to an embodiment of the invention. The apparatus <b>100</b> includes a network switch <b>102</b>, an exchange manager <b>104</b>, a processor <b>106</b>, and a memory <b>108</b>.</p>
<p id="p-0025" num="0024">The network switch <b>102</b> includes a network port <b>110</b>, an initiator port <b>112</b>, and a processor port <b>114</b>. The network port <b>110</b> is configured for coupling to an external network. The initiator port <b>112</b> is configured for coupling to multiple processing or initiator devices such as, for example, server blades. The processor port <b>114</b> couples the network switch <b>102</b> to the processor <b>106</b>.</p>
<p id="p-0026" num="0025">In an embodiment, the apparatus <b>100</b> operates in a loop topology mode referred to herein as NL_PORT mode. In this mode, the apparatus <b>100</b> connects to an external network such as, for example, a Fibre Channel fabric via the network port <b>110</b> such that the network port <b>110</b> operates as an NL_PORT, as defined in the Fibre Channel standards. As will be understood by persons skilled in the relevant art(s), an NL_PORT is a specialized loop port topology optimized to pass data traffic efficiently to a connected FL_PORT on a fabric switch. More details about this mode of operation are provided below.</p>
<p id="p-0027" num="0026">In another embodiment, the apparatus <b>100</b> operates in a non-loop mode referred to herein as N_PORT mode. In this mode, the apparatus <b>100</b> connects to an external network such as, for example, a Fibre Channel fabric via the network port <b>110</b> such that the network port <b>110</b> operates as an N_PORT as defined in the Fibre Channel standards.</p>
<p id="p-0028" num="0027">It is a feature of the apparatus <b>100</b> that selected portions can be formed using commercially available hardware. For example, in an embodiment, the network switch <b>102</b> is a commercially available network switch such as, for example, Broadcom Corporation's BCM8440 Fibre Channel fabric switch, available from Broadcom Corporation, Irvine Calif. The processor <b>106</b> can be formed using a MIPS processing core available from MIPS Technologies, Inc., Mountain View Calif.</p>
<p id="p-0029" num="0028">The exchange manager <b>104</b> is responsible for proper translation of Fibre Channel communication exchanges for all fiber channel protocol (FCP) frames that are routed to an eXM port <b>118</b><i>a </i>and an eXM port <b>118</b><i>b </i>of exchange manager port module <b>118</b>. As shown in <figref idref="DRAWINGS">FIG. 1</figref>, the eXM port <b>118</b><i>a </i>and eXM port <b>118</b><i>b </i>are respectively coupled to Pe port <b>116</b><i>a </i>and Ne port <b>116</b><i>b </i>of application port module <b>116</b>. In an embodiment of the present invention, the exchange manager <b>104</b> is implemented as a field programmable gate array (FPGA) device. The present invention, however, is not restricted to this implementation.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 2</figref> illustrates an example system <b>200</b> according to an embodiment of the invention. The system <b>200</b> includes an aggregator circuit <b>202</b> and a plurality of initiator devices <b>204</b>. The aggregator circuit <b>202</b> couples the initiator devices <b>204</b> to an external network <b>210</b>.</p>
<p id="p-0031" num="0030">As shown in <figref idref="DRAWINGS">FIG. 2</figref>, the aggregator circuit <b>202</b> includes two network switches <b>102</b><i>a </i>and <b>102</b><i>b</i>. The network switches <b>102</b><i>a </i>and <b>102</b><i>b </i>each have a network port <b>110</b> and an initiator port <b>112</b>. In an embodiment, each network switch <b>102</b> operates in NL_PORT mode and each network port <b>110</b> operates as an NL_PORT as defined in the Fibre Channel standards. In an embodiment, the network switches <b>102</b><i>a </i>and <b>102</b><i>b </i>are coupled to one another by an inter-switch communications link <b>206</b>.</p>
<p id="p-0032" num="0031">The initiator devices <b>204</b> each include a port <b>208</b>, implemented as an N_PORT in an embodiment, in accordance with Fibre channel standards. The port <b>208</b> is used to couple an initiator device <b>204</b> to an initiator port <b>112</b> of the network switch <b>102</b>. In the embodiment, the initiator devices <b>204</b> are Fibre Channel Protocol-Small Computer System Interface (FCP-SCSI) initiator devices, and the initiator port <b>112</b> includes a plurality of FC-FS2 point-to-point ports for connecting to FCP-SCSI initiator devices.</p>
<p id="p-0033" num="0032">As noted above, in embodiments of the present invention, the network switches <b>102</b> of the apparatus <b>100</b> and the system <b>200</b> are fabric switches, which operate in an NL_PORT mode. This is a specialized Fibre Channel switch architecture mode, in which the network ports <b>110</b> operate as FC-AL2 loop ports (referred to herein as NL_PORTs), configured for coupling to an external network, and the initiator ports <b>112</b> operate as FC-FS2 point-to-point ports (referred to herein as N-ph_PORTs), configured to couple to FCP-SCSI initiator devices. The network ports <b>110</b> and the initiator ports <b>112</b> are coupled together through a buffered non-blocking switch backplane.</p>
<p id="p-0034" num="0033">In NL_PORT mode, input/output (I/O) frame traffic from an initiator device <b>204</b> is routed through its associated initiator port <b>112</b> of the network switch <b>102</b> to the network port <b>110</b>. The network port <b>110</b> routes ingress frames through the initiator port <b>112</b> to an appropriate initiator device <b>204</b> based on the arbitrated loop physical address (ALPA) component of a DID.</p>
<p id="p-0035" num="0034">In N_PORT mode, the apparatus <b>100</b> acts as an N_PORT aggregator blade (NAB). In the N_PORT mode, input/output (I/O) frame traffic from an appropriate initiator device <b>204</b> is routed through its associated initiator port <b>112</b> of the network switch <b>102</b>, through the exchange manager <b>104</b>, to the network port <b>110</b>. The network port <b>110</b> routes ingress frames through the initiator port <b>112</b>, through the exchange manager <b>104</b> to an appropriate initiator device <b>204</b> based on point-to-point Fibre channel topology standards.</p>
<p id="p-0036" num="0035">The basic requirement of the NAB <b>100</b> is to replace the Port address and world wide name (WWN) of each of the FCP-SCSI initiator devices <b>204</b> with a Port address of the NAB N-ph PORTs of the initiator ports <b>112</b><i>a </i>and <b>112</b><i>b</i>. In this manner, the external network (fabric) <b>210</b> will only see the N_PORT of the NAB <b>100</b>.</p>
<p id="p-0037" num="0036">In order to replace the Port address and WWN of the FCP-SCSI initiator devices <b>204</b> with the Port address of the NAB N-ph PORTs <b>112</b><i>a </i>and <b>112</b><i>b</i>, the Fibre Channel Exchange protocol requires that for a given SID (internal SCSI Initiator in this case) the originator exchange identifier (OX_ID) should not be duplicated. In conventional systems, this requirement is significant because it is likely that each of the SCSI Initiator devices <b>204</b> will be using the same OX_ID. This is especially true, for example, when the SCSI Initiator devices <b>204</b> are manufactured by the same vendor. Thus, it is necessary to replace the Port addresses and WWNs to prevent duplication.</p>
<p id="p-0038" num="0037">In order to provide a unique OX_ID for each communication exchange generated by each of the SCSI Initiator devices <b>204</b>, the NAB <b>100</b> desirably monitors the exchange and performs replacements at the Login level and Exchange level of the Fibre Channel protocol.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 3</figref> is a more detailed illustration of the NAB <b>100</b> shown in <figref idref="DRAWINGS">FIG. 1</figref>. The NAB <b>100</b> shown in <figref idref="DRAWINGS">FIG. 3</figref> is configured for operation in N_PORT mode. In <figref idref="DRAWINGS">FIG. 3</figref>, as noted above, the NAB <b>100</b> includes the network switch <b>102</b> and the exchange manager <b>104</b>. When configured for operation in N_PORT mode, the initiator port <b>112</b> operates as multiple phantom ports and the network port <b>110</b> operates as an N_PORT. Firmware operating internal to the processor <b>106</b> of <figref idref="DRAWINGS">FIG. 1</figref>, forms an NAB management agent <b>300</b>.</p>
<p id="p-0040" num="0039">The network switch <b>102</b>, for example, provides the DID routing and extended link services (ELS) filtering capabilities. The processor <b>106</b>, for example, provides the Link Services, Name server and all the ELS processing for the NAB <b>100</b>. All of the ELS type of frames for Fibre Channel related exchange session management will be handled by the NAB Management Agent <b>300</b>.</p>
<p id="p-0041" num="0040">A frame received by one of the Phantom ports <b>112</b> is routed by the network switch <b>102</b>. The network switch <b>102</b> determines whether the frame is to be routed to the exchange manager <b>104</b>, the processor <b>106</b>, or to the N_PORT <b>110</b>. Similarly, a frame received at the N_PORT <b>110</b> will be routed by the network switch <b>102</b> to the exchange manager <b>104</b>, the processor <b>106</b>, or to one of the Phantom ports <b>112</b>.</p>
<p id="p-0042" num="0041">Frames routed to the exchange manager <b>104</b> will undergo address translation before being sent back to one of the Phantom ports <b>112</b>. Frames sent to the processor <b>106</b> are primarily for Link management and for ELS management. Frames can be sent directly between any one of the Phantom ports <b>112</b> and the N_PORT <b>110</b> if the NAB <b>100</b> is configured to have an E_PORT or NL_PORT, instead of N_PORT, connection into the external network <b>210</b>.</p>
<p id="p-0043" num="0042">The ELS and other Fabric management frames are handled within the NAB Management Agent <b>300</b>. The NAB management agent <b>300</b> receives ELS frames that have been filtered by the network switch <b>102</b>. In the present invention, for example, these frames will not be sent to the exchange manager <b>104</b>. The network switch <b>102</b> will route the ELS frames to the processor <b>106</b>. The NAB Management Agent will <b>300</b> be responsible for all the address translation for these frames and is configured to receive ELS frames from the Phantom ports <b>112</b> and from the N_PORT <b>110</b>.</p>
<p id="p-0044" num="0043">After a Fabric Login session, and when the NAB <b>100</b> is connected to an F_PORT, the ID of the Network Port <b>110</b> will not be a default value. In this case the external network <b>210</b> (Fibre channel Fabric), for example, will assign an address for the network Port <b>110</b> (N_PORT) to the NAB <b>100</b> during the Fabric Login process at the network Port <b>110</b> side.</p>
<p id="p-0045" num="0044">Similarly, on the Phantom port side of the NAB <b>100</b>, the Initiators <b>204</b> will Login to the Phantom ports <b>112</b>. The Phantom ports <b>112</b> will appear to the Initiator ports <b>208</b> as F_PORTs and the Initiators <b>204</b> will, themselves, login as N_PORT devices. The Initiator ports <b>208</b> will be assigned Port IDs by the NAB Management Agent <b>300</b>.</p>
<p id="p-0046" num="0045">The Port ID assignment is performed using arbitrated physical loop address (ALPA). During this process, the Initiator ports <b>208</b> will be assigned ALPAs starting from 0x01 through 0x0F. ALPA 0x00 is desirably reserved for the processor port <b>114</b> (see <figref idref="DRAWINGS">FIG. 1</figref>). The network switch <b>102</b> ports connected as Phantom ports and as an Ne_PORT (e.g. the port <b>116</b><i>b </i>of <figref idref="DRAWINGS">FIG. 1</figref>), will be programmed for ALPA based routing. The network switch <b>102</b> ports connected as N_PORT and as Pe_PORT (e.g., the port <b>116</b><i>a</i>) will be programmed for Area based routing.</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 4</figref> provides an illustration of ELS frame mapping, as implemented in an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, ELS frames <b>460</b> originating with the Initiators <b>204</b> are filtered by the Phantom ports <b>112</b> of the network switch <b>102</b>, and then routed to the processor port <b>114</b>. Next, the NAB Management Agent <b>300</b> will be interrupted and will read out the ELS frame from a CPU TX port <b>462</b>. After the ELS frame has been modified by the NAB Management Agent <b>300</b>, it can be written back into a CPU RX port <b>464</b> and queued to the proper RX queue for the N_PORT <b>110</b>. The final modified ELS frame will subsequently be sent to the N_PORT <b>110</b>.</p>
<p id="p-0048" num="0047">Similarly, ELS frames <b>466</b> originating with the External network <b>210</b> are filtered at the N_PORT <b>110</b> of the network switch <b>102</b> and then routed through the CPU TX and RX ports <b>464</b> and <b>462</b>. The NAB Management agent <b>300</b> can then send the ELS frames <b>466</b> to one or more of the Phantom ports <b>112</b>.</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 5</figref> is an illustration of phantom port to N_PORT mapping, as implemented in an embodiment of the present invention. In <figref idref="DRAWINGS">FIG. 5</figref>, a translate IO (exchange) is originated by a particular one of the initiators <b>204</b>. The particular Initiator sends, for example, a Fibre Channel Protocol command (FCP_CMND) frame whose destination is a DID that needs to be routed through NAB <b>100</b>. The exchange manager <b>104</b> receives the frame on the eXM-p Port <b>118</b><i>a </i>and performs the necessary address replacements to the FCP_CMD frame.</p>
<p id="p-0050" num="0049">The exchange manager <b>104</b> will process the command frame and create a Phantom port <b>112</b> to N_PORT <b>110</b> mapping for that exchange. The exchange manager <b>104</b> will also create a new entry in an internal IO table <b>500</b>, corresponding to this exchange. The exchange manager <b>104</b> will replace the SID of the particular one of the Initiators <b>204</b> with the SID of the address of the N_PORT <b>110</b>.</p>
<p id="p-0051" num="0050">As illustrated in <figref idref="DRAWINGS">FIG. 6</figref>, the exchange manager <b>104</b> then creates a new FCP_CMND frame, forwarding the new FCP_CMND frame to the network switch <b>102</b> N-pe Port <b>116</b><i>b</i>. Subsequent frames for that exchange are received by exchange manager <b>104</b> and handled as specified by its corresponding IO table entry.</p>
<p id="p-0052" num="0051">The corresponding response frame from a Target communicating with the particular one of the Initiators <b>204</b> (see <figref idref="DRAWINGS">FIG. 3</figref>) via the external network <b>210</b>, for example, will be received at the N_PORT <b>110</b> of network switch <b>102</b>. The response frame will then be routed through the Ne Port <b>116</b><i>b </i>to the eXMN Port <b>118</b><i>b </i>of the exchange manager <b>104</b>. The frame is looked up in an IO table <b>500</b> entry that is related to the exchange and the necessary address replacements are made to the response frame. The exchange manager <b>104</b> will replace the DID of the frame with the DID of the particular one of the initiators <b>204</b>. This frame will now be sent to the Ne port <b>116</b><i>a</i>. The network switch <b>102</b> can now route this frame to the appropriate Phantom port <b>112</b> that corresponds to the particular one of the initiators <b>204</b>.</p>
<p id="p-0053" num="0052">In order to do a proper translation of exchanges and Fibre Channel frame sequences, the exchange manager <b>104</b> will desirably track an Exchange Begin, Exchange End, Sequence begin, Sequence end and the type of FCP command. For proper Exchange translation for an N_PORT device, the Sequence ID will desirably be transposed so that SEQ_ID reuse is maintained as defined, for example, in Fibre Channel_FS-2.</p>
<p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. 7</figref> is an illustration of an exemplary IO table <b>500</b> arrangement. When the exchange manager <b>104</b> receives the first Exchange from an exchange originator, such as one of the initiators <b>204</b>, it identifies the exchange and creates a new entry in the IO table <b>500</b>. This provides the exchange manager <b>104</b> a starting point for tracking subsequent frames of the exchange. The SID, OX_ID, and SEQ_ID of the first Exchange frame is replaced with the aSID (SID of the NAB N_PORT SID), aOX_ID (the new OX_ID generated by the eXM), and the a_SEQ_ID (new SEQ_ID generated by the exchange manager <b>104</b>).</p>
<p id="p-0055" num="0054">When a Responder sends the first response frame having the same aOX_ID, the exchange manager <b>104</b> performs an IO Table <b>500</b> look up using the aOX_ID as an index. The exchange manager <b>104</b> will then retrieve the original SID, OX_ID and the SEQ_ID and replace those fields. Additionally, it will save the responder exchange identifier (RX_ID) in the IO table <b>500</b> and replace the RX_ID of the response frame with a new aRX_ID. To simplify this process, the exchange manager <b>104</b> will use the same value of the aOX_ID. For subsequent frames from the originator, the IO table <b>500</b> will be indexed by the aRX_ID of the frame.</p>
<p id="p-0056" num="0055">By simplifying the process as noted above, simpler memory schemes can be used to index into the IO table entries. An exemplary technique for indexing the IO table <b>500</b> might include the First Exchange frame creating a new entry using the aOX_ID as the index. For frames from the responder, the aOX_ID is used as the index, and any subsequent Initiator frames can use the aRX_ID.</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 8</figref> illustrates how one can think of the apparatus <b>100</b> as having a dividing line <b>802</b> at the midsection of network switch <b>102</b>, which separates network port <b>110</b> from initiator port <b>112</b>.</p>
<p id="p-0058" num="0057">As shown in <figref idref="DRAWINGS">FIG. 8</figref>, management frame processing is different for the different port types. Accordingly, management agent <b>300</b> can be thought of as including a front-end management agent <b>402</b> and a back-end management agent <b>404</b>. The front-end management agent <b>402</b> performs operations relating to specific tasks associated with the network port <b>110</b>. The back-end management agent <b>404</b> performs operations relating to specific tasks associated with the initiator port <b>112</b>. These specific tasks include handling unsolicited management request frames from the network port <b>110</b> and the initiator port <b>112</b>. Depending on processing logic, these frames may be filtered and forwarded, or the frames may be processed directly by the management agent and a management response returned.</p>
<p id="p-0059" num="0058">In embodiments of the present invention, the management agent <b>300</b> is responsible for one or more of the following tasks:</p>
<p id="p-0060" num="0059">1. Forwarding non-disruptive (query/get) oriented management frames from the initiator port <b>112</b> (i.e., the N-ph_PORTs) to the network port <b>110</b>;</p>
<p id="p-0061" num="0060">2. Re-mapping back-end N-ph_PORT network provider identification (NPID) and world wide port name (WWPN) parameter field values to fixed NPID and WWPN values in all management frames;</p>
<p id="p-0062" num="0061">3. Internally processing and replying to registration oriented management frames issued from initiator devices coupled to the initiator port <b>112</b>;</p>
<p id="p-0063" num="0062">4. Performing device registration for initiator devices coupled to network port <b>110</b>; and</p>
<p id="p-0064" num="0063">5. Hiding back-end initiator port connection oriented events (port up/port down) from the external network <b>210</b> (e.g., the back-end ports should be considered I/O processing engines, and the addition or removal of these back-end ports should be isolated from the front-end port and the external network).</p>
<p id="p-0065" num="0064">The front-end management agent <b>402</b> is responsible for management frame processing related to the network port <b>110</b>. For example, the front-end management agent <b>402</b> processes port initialization and initiates device registration for the network port <b>110</b>. In the present invention, the scope of frame processing is the full required protocol coverage of ELS and Name Server frames mentioned in Fibre Channel-FLA 2.7.</p>
<p id="p-0066" num="0065">The front-end management agent <b>402</b> assigns a unique static WWPN/WWNN for each network port <b>110</b> (and each ALPA in NL_PORT mode). The WWPN remains fixed and static irregardless of the actual initiator devices connected to the back-end N-ph_PORTs. Front-end management agent <b>402</b> also is responsible for processing all unsolicited ELS and Fabric Service frames sent from a fabric.</p>
<p id="p-0067" num="0066">In embodiments, front-end management agent <b>402</b> is responsible for processing one or more of the following:</p>
<p id="p-0068" num="0067">1. Network port Initialization;</p>
<p id="p-0069" num="0068">2. Device registration with a network controller (e.g., FLOGI);</p>
<p id="p-0070" num="0069">3. Device registration with Name Server (NS set operations);</p>
<p id="p-0071" num="0070">4. Rx RCSN forwarding and fan-out to back-end N-ph_PORTs (exchange cleanup handling);</p>
<p id="p-0072" num="0071">5. Rx generic ELS processing;</p>
<p id="p-0073" num="0072">6. Proxy agent probing;</p>
<p id="p-0074" num="0073">7. Rx unsolicited FCP-SCSI discovery command(s);</p>
<p id="p-0075" num="0074">8. SCSI Inquiries; and</p>
<p id="p-0076" num="0075">9. Vital product data page information.</p>
<p id="p-0077" num="0076">The front-end management agent <b>402</b> performs port initialization for each front-end port, for example, in the system <b>202</b>. In an embodiment, the network port initializes using Fibre Channel-AL2 loop protocol in NL_PORT mode. The back-end ports (N-ph PORTs) associated with the front-end ports are affected by the port-up and port-down events occurring on the front-end network ports. When a front-end network port <b>110</b> goes down, it forces each associated N-ph_PORT into an offline state, for example, by sending NOS continuously to all associated N-ph PORTs.</p>
<p id="p-0078" num="0077">When the network port <b>110</b> returns to proper operation, it completes name server and fabric logic services, and it allows associated N-ph ports to come on line. Back-end management agent <b>404</b> assigns port IDs to the N-ph_PORTs and sends accept responses to N-ph port registration requests. Initiators devices on the N-ph PORTs as part of the target discovery process send PLOGIs to target devices. Back-end management agent <b>404</b> processes the PLOGIs (modified WWNN and WWPN) and forwards them to each target.</p>
<p id="p-0079" num="0078">The front-end management agent <b>402</b> sources fabric logic (FLOGI) requests for each front-end N_PORT (or for each ALPA exposed on an NL_PORT). A fixed WWPN/WWNN is used for these devices. The public address domain and areas components (e.g., DDAA[XX]) returned from the fabric assigned to the front-end port in the FLOGI accept frame is used for associated back-end ports. Back-end management agent <b>404</b> uses this internally recorded address identifier (DDAAXX) for back-end N-ph_PORT FLOGI response processing. Registration for state change notification(s) is performed for each ALPA exposed on an NL_PORT using a storage resource card (SRC) protocol.</p>
<p id="p-0080" num="0079">The front-end management agent <b>402</b> also sources non-stop (NS) registration frames for each front-end ALPA exposed on an NL_PORT. This includes registration of Fibre Channel-4 types RFT_ID, device port id RPN_ID (fixed WWPN value), device port name RNN_ID, device node name: RSNN_NN (fixed WWNN assigned value), and the symbolic port name RSPN_ID. Registration is performed for each NL_PORT exposed to the external network.</p>
<p id="p-0081" num="0080">The front-end management agent <b>402</b> is responsible for receiving and processing unsolicited RSCN request frames from a fabric controller for each front-end NL_PORT. The front-end management agent <b>402</b> replicates registered state change notification (RSCN) events and forwards the appropriate data to associated back-end N-ph_PORTs.</p>
<p id="p-0082" num="0081">The front-end management agent <b>402</b> receives and processing unsolicited ELS frames for FCP-SCSI initiator devices, for example, according to the Fibre Channel-FLA 2.7 standard. The frames/requests are directly processed and returned by the front-end management agent <b>402</b>. The responses return information defining a FCP-SCSI initiator, and no interaction with back-end management agent is required. In embodiments, front-end management agent <b>402</b> support the following ELS frames as ELS Responder: ADISC, FAN, PLOGO, PDISC, PLOGI, PRLI, PRLO, RNC, RRQ, RSCN. In selected embodiments, the following ELS frames also are supported: ABTX, RES, RLS, RSI, RSS, SCN, SCR, TPRLO.</p>
<p id="p-0083" num="0082">Many fabric switch devices have proxy discovery agents that probe edge devices in order to help populate the Name Server database. These devices can source ELS requests to the network port <b>110</b>. The front-end management agent <b>402</b> satisfies requests for information from these devices about the network port <b>110</b>.</p>
<p id="p-0084" num="0083">The front-end management agent <b>402</b> receives and processes unsolicited FCP-SCSI discovery commands. These requests also are processed and returned by the front-end management agent <b>402</b>, returning information defining a FCP-SCSI initiator, without interaction with the back-end management agent <b>404</b>. The following FCP-SCSI FCP commands are supported: Test Unit Ready, Inquiry-Standard, and Inquiry-Vital Product Data. The Vital Product Data page returns the WWPN/WWNN of network port <b>110</b>.</p>
<p id="p-0085" num="0084">The back-end management agent <b>404</b> is responsible for management frame processing related to the N-ph_PORTs (initiator port <b>112</b>) connected to back-end FCP-initiator devices. The back-end management agent <b>404</b> processes port initializations and replies to device registration requests for the N-ph_PORTs. The internal behavior of back-end management agent <b>404</b> allows initiator devices to operate as if they were directly connected to the external network (e.g., Fabric Switch) coupled to the network port <b>110</b>.</p>
<p id="p-0086" num="0085">In N_PORT mode, each initiator device coupled to an N-ph_PORT can operate as if it were the only device coupled to the network port <b>110</b>. This is accomplished by specialized forwarding and filtering of ELS and Fabric Services frames, as illustrated in <figref idref="DRAWINGS">FIG. 8</figref>. Fabric controller and name server registration is isolated and hidden from the external network/connected fabric. General WWPN re-mapping to a fixed WWPN (related to network port <b>110</b>) occurs for ELS and Fabric Service frames sourced by back-end ports.</p>
<p id="p-0087" num="0086">The back-end management agent <b>404</b> is responsible for processing/performing one or more of the following:</p>
<p id="p-0088" num="0087">1. Port Initialization (N-ph_PORTs);</p>
<p id="p-0089" num="0088">2. Unsolicited ELS/Fabric Service frames required for FCP-SCSI initiators by</p>
<p id="p-0090" num="0089">Fibre Channel-FLA 2.7;</p>
<p id="p-0091" num="0090">3. Fabric Control FLOGI frame requests;</p>
<p id="p-0092" num="0091">4. Name Server registrations; and</p>
<p id="p-0093" num="0092">5. Name Server queries.</p>
<p id="p-0094" num="0093">The back-end management agent <b>404</b> performs port initialization for each back-end N-ph PORT. The ports initialize using Fibre Channel-FS point-to-point protocol. The back-end N-ph PORTs are only allowed to become &#x201c;active&#x201d; ports after their associated front-end network port <b>110</b> has been initialized and achieved an active state. At this point, an N-ph PORT sends name server registration and fabric login requests to the back-end management agent <b>404</b>. The back-end management agent <b>404</b> assigns a port ID to the N-ph_PORT and sends accept responses to registration requests. An initiator device on the N-ph PORT then sends a PLOGI. Back-end management agent <b>404</b> filters the PLOGI WWNN/WWPN and forwards it. The back-end management agent <b>404</b> captures and processes the PLOGI ELS_ACC frame from the target and forwards it to the N-ph_PORT.</p>
<p id="p-0095" num="0094">All ELS and Fabric Service unsolicited requests sourced from back-end ports are received and processed by the back-end management agent <b>404</b>. In general, both the unsolicited requests and solicited responses are NPID/WWPN/WWNN filtered as follows:</p>
<p id="p-0096" num="0095">1. The unsolicited requests from N-ph_PORTs (which are forwarded to the fabric) have the N-ph_PORT initiators true NPID/WWPN/WWNN remapped to the associated network port <b>110</b> device NPID/WWPN/WWNN; and</p>
<p id="p-0097" num="0096">2. The solicited response frames returned from the fabric have the network port <b>110</b> NPID/WWPN/WWNN remapped to the N-ph_PORT initiators actual NPID/WWPN/WWNN.</p>
<p id="p-0098" num="0097">Specialized handling of specific ELS/Fabric Service unsolicited requested are described in more below.</p>
<p id="p-0099" num="0098">The back-end management agent <b>404</b> is responsible for receiving and responding to all FLOGI frames generated by N-ph_PORT devices. These requests are directly processed and returned by back-end management agent <b>404</b>.</p>
<p id="p-0100" num="0099">Internal checking/processing is performed on the FLOGI service parameters requested by each N-ph_PORT initiator device. The requested service parameters must be supported by the FLOGI service parameters negotiated by the associated frond-end network port device, and they are returned based on the negotiated front-end port service parameters.</p>
<p id="p-0101" num="0100">The NPID assigned to the each back-end port is based on the domain and area (DDAA--) address components assigned to the associated front-end network port. The ALPA/device component of the address (----XX) maps to fixed ALPA addresses assigned to each back-end N-ph_PORT.</p>
<p id="p-0102" num="0101">Returned link level negotiated values such as BBC, are processed based on the local link resources of the N-ph_PORT.</p>
<p id="p-0103" num="0102">The back-end management agent <b>404</b> also processes Fabric Service Name Server Registrations sourced from back-end N-ph_PORTs. These registration requests are terminated and acknowledge directly by the back-end management agent <b>404</b>. They are not forwarded to the Fabric as it is an objective of the present invention to hide or to virtualize the actual back-end initiators. All unsolicited Name Service registrations requests (0xX2XX type match) are acknowledge without the requirement for establishing and maintaining a local database.</p>
<p id="p-0104" num="0103">Also as illustrated in <figref idref="DRAWINGS">FIG. 8</figref>, the back-end management agent <b>404</b> forwards Fabric Service Name Server Query/Get requests (0xX1XX type match) sourced from back-end N-ph_PORT. These registration requests are forward through the associated network port <b>110</b>. The frames are filtered, and references to NPID or WWPN/WWNN are replaced as described above.</p>
<p id="p-0105" num="0104">Frame filtering is performed on unsolicited requests forwarded to the external network/fabric such that N-ph_PORT id/name data are changed to the appropriate network port <b>110</b> id/name data. Frame filtering is performed on the solicited responses returned from the external network/fabric such that the network port <b>110</b> id/name data are changed to the appropriate N-ph_PORT id/name data. These query operations are non-disruptive to the external network/fabric, and hence the forwarded protocol has no or minimal impact on external network/Fabric state or I/O data paths.</p>
<p id="p-0106" num="0105">In NL_PORT mode, registered state change notification (RSCN) frames are directly forwarded to the back-end N-ph_PORTs, such as the ports <b>208</b>.</p>
<p id="p-0107" num="0106">In the Fibre Channel N_Port aggregation application, one front end N port connected to a fabric would aggregate traffic from the backend N ports <b>208</b>. Each the N port <b>110</b> is allowed to have up to 64 K open exchanges in the fibre channel protocol. The front end N port <b>110</b> would then allocate its 64 K exchange IDs (on the fabric connection) among the backend N ports <b>208</b>. As an example, the exchange ID can be a 16 bit entity. To distribute the 64 K exchange IDs among (m) number of the backend N ports <b>208</b>, n bits, where m&#x3c;=2<sup>n</sup>, will be needed to identify the backend N ports <b>208</b>. The (n) most significant bits of the exchange ID are used to identify a particular one backend N ports <b>208</b>; and the remaining (16-n) bits will represent a consecutive range of exchange IDs.</p>
<p id="p-0108" num="0107">For example, for 8 backend ports, each backend port gets 8 K of the front end exchange IDs. The invention is not limited to any particular number of ports.</p>
<p id="p-0109" num="0108">Fibre Channel standard FC-FS-2 specifies that an N port could have up to 64 K exchanges. When a front end N port is used to aggregate traffic for multiple backend N ports, it is necessary to limit the number of exchanges that each backend N port could open.</p>
<p id="p-0110" num="0109">The ability to confine the number of exchanges on the front end N port to 64 K enables the front end N port to aggregate traffic from multiple back end N ports; and to be compliant with established Fibre Channel Standards, which is an advantage over conventional means.</p>
<p id="p-0111" num="0110">The approach can be modified and made applicable to allocate exchange IDs unevenly to favor selected backend N ports if the application warrants the uneven distribution. The modification is accomplished by allocating exchange IDs among x ports, where x is not a multiple of 2.</p>
<p id="p-0112" num="0111"><figref idref="DRAWINGS">FIG. 9</figref> is an illustration of an exemplary method <b>900</b> of practicing a first aspect of an embodiment of the present invention. In <figref idref="DRAWINGS">FIG. 9</figref>, a communication exchange is initiated between at least one initiator and a SAN, the exchange including transmission of a command frame, as indicated in step <b>902</b>. In step <b>904</b>, the exchange is monitored. And in step <b>906</b>, the unique SD of one of the initiators is replaced with an SID of the Fibre channel switch.</p>
<p id="p-0113" num="0112"><figref idref="DRAWINGS">FIG. 10</figref> is an illustration of an exemplary method <b>1000</b> of practicing a second aspect of an embodiment of the present invention. In <figref idref="DRAWINGS">FIG. 10</figref>, a number (m) of N_ports present in a back end of the switch is determined, as indicated in step <b>1002</b>. And in step <b>1004</b>, the available exchange IDs are distributed across the number (m) of present N_ports. Each exchange ID comprises (j) bits, and (n) bits are used to identify each of the present backend ports, where m&#x2266;2<sup>n</sup>.</p>
<heading id="h-0006" level="1">CONCLUSION</heading>
<p id="p-0114" num="0113">The present invention has been described above with the aid of functional building blocks illustrating the performance of specified functions and relationships thereof. The boundaries of these functional building blocks have been arbitrarily defined herein for the convenience of the description. Alternate boundaries can be defined so long as the specified functions and relationships thereof are appropriately performed.</p>
<p id="p-0115" num="0114">Any such alternate boundaries are thus within the scope and spirit of the claimed invention. One skilled in the art will recognize that these functional building blocks can be implemented by analog and/or digital circuits, discrete components, application-specific integrated circuits, firmware, processor executing appropriate software, and the like, or any combination thereof. Thus, the breadth and scope of the present invention should not be limited by any of the above-described exemplary embodiments, but should be defined only in accordance with the following claims and their equivalents.</p>
<p id="p-0116" num="0115">The foregoing description of the specific embodiments will so fully reveal the general nature of the invention that others can, by applying knowledge within the skill of the art (including the contents of the references cited herein), readily modify and/or adapt for various applications such specific embodiments, without undue experimentation, without departing from the general concept of the present invention.</p>
<p id="p-0117" num="0116">Therefore, such adaptations and modifications are intended to be within the meaning and range of equivalents of the disclosed embodiments, based on the teaching and guidance presented herein. It is to be understood that the phraseology or terminology herein is for the purpose of description and not of limitation, such that the terminology or phraseology of the present specification is to be interpreted by the skilled artisan in light of the teachings and guidance presented herein, in combination of one of ordinary skill in the art.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of allocating exchange identifications (IDs) in a fibre channel switch for fibre channel aggregation, comprising:
<claim-text>determining a number (m) of back-end N_ports present in a back end of the fibre channel switch;</claim-text>
<claim-text>limiting a number of exchange IDs that the back-end N_ports are configured to open, such that a corresponding total number of aggregated exchange IDs associated with a front-end N_port of the fibre channel switch does not exceed a limit of exchange IDs allocated by the front-end N_port, the limit of exchange IDs in compliance with a fibre channel standard;</claim-text>
<claim-text>distributing the exchange IDs across the number (m) of present back-end N_ports; and</claim-text>
<claim-text>replacing exchange IDs of frames associated with the back-end N_ports.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein (n) most significant bits of each distributed exchange ID are used to identify a particular one of the back-end N_ports, and wherein a remaining number (j&#x2212;n) bits represent a consecutive range of exchange IDs.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. An apparatus for allocating exchange identifications (IDs) in a fibre channel switch for fibre channel aggregation, comprising:
<claim-text>a module configured to determine a number (m) of back-end N_ports present in a back end of the fibre channel switch; a module configured to limit a number of exchange IDs that the back-end N_ports are configured to open, such that a corresponding total number of aggregated exchange IDs associated with a front-end N_port of the fibre channel switch does not exceed a limit of exchange IDs allocated by the front-end N-port, the limit of exchange IDs in compliance with a fibre channel standard;</claim-text>
<claim-text>a module configured to distribute the exchange IDs across the number (m) of present back-end N_ports; and</claim-text>
<claim-text>a module configured to replace exchange IDs of frames associated with the back-end N-ports.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The apparatus of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein (n) most significant bits of each distributed exchange ID are used to identify a particular one of the back-end N_ports, and wherein a remaining number (j&#x2212;n) bits represent a consecutive range of exchange IDs.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A non-transitory tangible computer readable storage medium carrying one or more sequences of one or more instructions for execution by one or more processors to allocate exchange identifications (IDs) in a fibre channel switch for fibre channel aggregation, the instructions when executed by the one or more processors causing the one or more processors to:
<claim-text>determine a number (m) of back-end N_ports present in a back end of the fibre channel switch;</claim-text>
<claim-text>limit a number of exchange IDs that the back-end N-ports are configured to open, such that a corresponding total number of aggregated exchange IDs associated with a front-end N_port of the fibre channel switch does not exceed a limit of exchange IDs allocated by the front-end N-port, the limit of exchange IDs in compliance with a fibre channel standard;</claim-text>
<claim-text>distribute the exchange IDs across the number (m) of present back-end N_ports; and</claim-text>
<claim-text>replace exchange IDs of frames associated with the back-end N_ports.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The non-transitory tangible computer readable storage medium of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein (n) most significant bits of each distributed exchange ID are used to identify a particular one of the back-end N_ports, and wherein a remaining number (j&#x2212;n) bits represent a consecutive range of exchange IDs.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein distributing the exchange IDs allocates exchange IDs unevenly to favor selected back-end N_ports.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The apparatus of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the module configured to distribute the exchange IDs allocates exchange IDs unevenly to favor selected back-end N_ports.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The non-transitory tangible computer readable storage medium of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein causing the one or more processors to distribute the exchange IDs allocates exchange IDs unevenly to favor selected back-end N_ports.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising: modifying, by an exchange manager, frames that are included in aggregated traffic associated with the back-end N_ports.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The apparatus of <claim-ref idref="CLM-00003">claim 3</claim-ref>, further comprising: an exchange manager configured to modify frames that are included in aggregated traffic associated with the back-end N_ports.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The non-transitory tangible computer readable storage medium of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the instructions further cause the one or more processors to:
<claim-text>modify, by an exchange manager, frames that are included in aggregated traffic associated with the back-end N_ports.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising: replacing at least one of a source identifier (SID), destination identifier (DID), originator exchange identifier (OX_ID), responder exchange identifier (RX_ID), and sequence identifier (SEQ_ID) of at least one of the frames associated with the back-end N_ports.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The apparatus of <claim-ref idref="CLM-00003">claim 3</claim-ref>, further comprising: a module configured to replace at least one of a source identifier (SID), destination identifier (DID), originator exchange identifier (OX ID), responder exchange identifier (RX_ID), and sequence identifier (SEQ_ID) of at least one of the frames associated with the back-end N_ports.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The non-transitory tangible computer readable storage medium of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the instructions further cause the one or more processors to: replace at least one of a source identifier (SID), destination identifier (DID), originator exchange identifier (OX_ID), responder exchange identifier (RX_ID), and sequence identifier (SEQ_ID) of at least one of the frames associated with the back-end N_ports.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising: storing information regarding the replaced exchanged IDs in a table in memory; and tracking subsequent frames for an exchange using the table.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The apparatus of <claim-ref idref="CLM-00003">claim 3</claim-ref>, further comprising: a module configured to: store information regarding the replaced exchanged IDs in a table in memory, and track subsequent frames for an exchange using the table.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The non-transitory tangible computer readable storage medium of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the instructions farther cause the one or more processors to: store information regarding the replaced exchanged IDs in a table in memory; and track subsequent frames for an exchange using the table.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the fibre channel standard is the fibre channel FC-FS-2 standard.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The apparatus of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the fibre channel standard is the fibre channel FC-FS-2 standard.</claim-text>
</claim>
</claims>
</us-patent-grant>
