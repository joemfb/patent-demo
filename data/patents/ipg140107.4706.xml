<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625798-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625798</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13347628</doc-number>
<date>20120110</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>KR</country>
<doc-number>10-2011-0002474</doc-number>
<date>20110110</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>32</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>380270</main-classification>
<further-classification>455466</further-classification>
</classification-national>
<invention-title id="d2e71">Method and apparatus for encrypting short data in a wireless communication system</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>2008/0279381</doc-number>
<kind>A1</kind>
<name>Narendra et al.</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380270</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2009/0280774</doc-number>
<kind>A1</kind>
<name>Patel et al.</name>
<date>20091100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455410</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2009/0307496</doc-number>
<kind>A1</kind>
<name>Hahn et al.</name>
<date>20091200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713171</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2010/0069097</doc-number>
<kind>A1</kind>
<name>Chin et al.</name>
<date>20100300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455466</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2010/0205442</doc-number>
<kind>A1</kind>
<name>Han et al.</name>
<date>20100800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713171</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2011/0302416</doc-number>
<kind>A1</kind>
<name>Hoshen et al.</name>
<date>20111200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713168</main-classification></classification-national>
</us-citation>
</us-references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>380270</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455466</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>10</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120177199</doc-number>
<kind>A1</kind>
<date>20120712</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Baek</last-name>
<first-name>Young-Kyo</first-name>
<address>
<city>Seoul</city>
<country>KR</country>
</address>
</addressbook>
<residence>
<country>KR</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Kang</last-name>
<first-name>Hyun-Jeong</first-name>
<address>
<city>Seoul</city>
<country>KR</country>
</address>
</addressbook>
<residence>
<country>KR</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Baek</last-name>
<first-name>Young-Kyo</first-name>
<address>
<city>Seoul</city>
<country>KR</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Kang</last-name>
<first-name>Hyun-Jeong</first-name>
<address>
<city>Seoul</city>
<country>KR</country>
</address>
</addressbook>
</inventor>
</inventors>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Samsung Electronics Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Suwon-si</city>
<country>KR</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Smithers</last-name>
<first-name>Matthew</first-name>
<department>2437</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method and apparatus is capable of encrypting short data in a wireless communication system When a terminal generates a short data burst in idle mode, the apparatus generates a Traffic Encryption Key (TEK) using a Cipher-based Message Authentication Code (CMAC)-TEK prekey derived from an Authorization Key (AK) related to Security Association (SA) between the terminal and a Base Station (BS). A nonce is constructed with a Packet Number (PN) identical to an uplink CMAC PN (CMAC-PN_U) transmitted together with a Ranging Request (RNG-REQ) message carrying the short data burst The short data burst is encrypted using the TEK and the nonce. A Medium Access Control (MAC) Protocol Data Unit (PDU) is generated by attaching a MAC header and a CMAC digest for integrity protection to the RNG-REQ message carrying the encrypted short data burst. The MAC PDU is transmitted to the BS.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="205.15mm" wi="143.51mm" file="US08625798-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="243.16mm" wi="165.18mm" file="US08625798-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="197.02mm" wi="125.05mm" file="US08625798-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="229.02mm" wi="157.40mm" file="US08625798-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="219.20mm" wi="158.58mm" file="US08625798-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="158.50mm" wi="164.25mm" file="US08625798-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="229.62mm" wi="173.91mm" file="US08625798-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATION(S) AND CLAIM OF PRIORITY</heading>
<p id="p-0002" num="0001">The present application is related to and claims priority under 35 U.S.C. &#xa7;119(a) to a Korean Patent Application filed in the Korean Intellectual Property Office on Jan. 10, 2011 and assigned Ser. No. 10-2011-0002474, the contents of which are incorporated herein by reference.</p>
<heading id="h-0002" level="1">TECHNICAL FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to a wireless communication system, and more particularly, to a method and apparatus for encrypting a short data burst.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">A cellular wireless communication system such as a Code Division Multiple Access (CDMA) 3<sup>rd </sup>Generation Partnership Project (3GPP) Long Term Evolution (LTE) system, a Worldwide interoperability for Micro Wave Access (WiMAX) system, and the like, provides a variety of services to Mobile Stations (MSs). The drastic development of computer, electronics, and communication technologies is a driving force behind provisioning of diverse wireless communication services through a wireless communication network. The most basic wireless communication service is a wireless voice call service that enables MS users to conduct voice calls wirelessly irrespective of time and place. A wireless Internet service is also provided, which enables users to conduct data communication through the Internet over a wireless communication network at any place while they are moving.</p>
<p id="p-0005" num="0004">Especially, Short Messaging Service (SMS) delivers text messages of a limited length between MSs irrespective of the communication state of a receiving MS, in other words, between MSs in idle modes. In general, the SMS limits a text message to about 80 bytes on a liquid crystal screen. Now, the use rate of the SMS is soaring, from personal usages to business usages. Beyond simple message exchanges between individual persons, the SMS has recently found its use in a wide range of group messaging, scheduled message transmission, e-mail reception notification, personal credit information management, financial information notification, and the like.</p>
<p id="p-0006" num="0005">The growing use and importance of the SMS has increased the necessity of SMS security. Especially when a text message carries personal credit information or financial information, SMS security is very important. Accordingly, there exists a need for a specific technique for encrypting a short data burst transmitted by a terminal in order to protect SMS security.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0007" num="0006">To address the above-discussed deficiencies of the prior art, it is a primary object to provide at least the advantages described below.</p>
<p id="p-0008" num="0007">Accordingly, an aspect of embodiments of the present disclosure is to provide a method and apparatus for encrypting short data transmitted in idle mode in a wireless communication system.</p>
<p id="p-0009" num="0008">Another aspect of embodiments of the present disclosure is to provide a method and apparatus for encrypting short data transmitted by an idle mode terminal in a wireless communication system.</p>
<p id="p-0010" num="0009">A further aspect of embodiments of the present disclosure is to provide a method and apparatus for encrypting short data to be encapsulated in a Ranging Request (RNG-REQ) message in a wireless communication system.</p>
<p id="p-0011" num="0010">In accordance with an embodiment of the present disclosure, there is provided a method for encrypting short data at a terminal in a wireless communication system, in which a short data burst is generated in idle mode, a Traffic Encryption Key (TEK) is generated using a Cipher-based Message Authentication Code (CMAC)-TEK prekey derived from an Authorization Key (AK) related to Security Association (SA) between the terminal and a Base Station (BS), the AK being acquired in advance through authentication during initial network entry, a nonce is constructed with a Packet Number (PN) identical to an uplink CMAC PN (CMAC-PN_U) transmitted together with a Ranging Request (RNG-REQ) message carrying the short data burst, the short data burst is encrypted using the TEK and the nonce, a Medium Access Control (MAC) Protocol Data Unit (PDU) is generated by attaching a MAC header and a CMAC digest for integrity protection to the RNG-REQ message carrying the encrypted short data burst, and the MAC PDU is transmitted in a radio signal to the BS. The CMAC-PN_U is included in the CMAC digest.</p>
<p id="p-0012" num="0011">In accordance with another embodiment of the present disclosure, there is provided a method for decrypting short data at a BS in a wireless communication system, in which a MAC PDU that includes an RNG-REQ message including an encrypted short data burst, a MAC header, and a CMAC digest for integrity protection is received from a terminal in idle mode, a TEK is generated using a CMAC-TEK prekey derived from an AK related to SA between the terminal and the BS, a nonce is constructed with a PN identical to an uplink CMAC PN (CMAC-PN_U) transmitted together with the RNG-REQ message, and the encrypted short data burst is decrypted using the TEK and the nonce. The CMAC-PN_U is included in the CMAC digest.</p>
<p id="p-0013" num="0012">In accordance with another embodiment of the present disclosure, there is provided a terminal apparatus for encrypting short data in a wireless communication system, in which a generator generates a short data burst in idle mode, an encryptor generates a TEK using a CMAC-TEK prekey derived from an AK related to SA between the terminal and a BS, the AK being acquired in advance through authentication during initial network entry, constructs a nonce with a PN identical to an uplink CMAC PN (CMAC-PN_U) transmitted together with an RNG-REQ message carrying the short data burst, and encrypts the short data burst using the TEK and the nonce, and a transmitter generates a MAC PDU by attaching a MAC header and a CMAC digest for integrity protection to the RNG-REQ message carrying the encrypted short data burst, and transmits the MAC PDU in a radio signal to the BS. The CMAC-PN_U is included in the CMAC digest.</p>
<p id="p-0014" num="0013">In accordance with a further embodiment of the present disclosure, there is provided a BS apparatus for decrypting short data in a wireless communication system, in which a receiver receives a MAC PDU that includes an RNG-REQ message including an encrypted short data burst, a MAC header, and a CMAC digest for integrity protection from a terminal in idle mode, and a decryptor generates a TEK using a CMAC-TEK prekey derived from an AK related to SA between the terminal and the BS, constructs a nonce with a PN identical to an uplink CMAC PN (CMAC-PN_U) transmitted together with the RNG-REQ message, and decrypts the encrypted short data burst using the TEK and the nonce. The CMAC-PN_U is included in the CMAC digest.</p>
<p id="p-0015" num="0014">Before undertaking the DETAILED DESCRIPTION OF THE INVENTION below, it may be advantageous to set forth definitions of certain words and phrases used throughout this patent document: the terms &#x201c;include&#x201d; and &#x201c;comprise,&#x201d; as well as derivatives thereof, mean inclusion without limitation; the term &#x201c;or,&#x201d; is inclusive, meaning and/or; the phrases &#x201c;associated with&#x201d; and &#x201c;associated therewith,&#x201d; as well as derivatives thereof, may mean to include, be included within, interconnect with, contain, be contained within, connect to or with, couple to or with, be communicable with, cooperate with, interleave, juxtapose, be proximate to, be bound to or with, have, have a property of, or the like; and the term &#x201c;controller&#x201d; means any device, system or part thereof that controls at least one operation, such a device may be implemented in hardware, firmware or software, or some combination of at least two of the same. It should be noted that the functionality associated with any particular controller may be centralized or distributed, whether locally or remotely. Definitions for certain words and phrases are provided throughout this patent document, those of ordinary skill in the art should understand that in many, if not most instances, such definitions apply to prior, as well as future uses of such defined words and phrases.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0016" num="0015">For a more complete understanding of the present disclosure and its advantages, reference is now made to the following description taken in conjunction with the accompanying drawings, in which like reference numerals represent like parts:</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 1</figref> illustrates short data transmission according to an embodiment of the present disclosure;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 2A</figref> illustrates a typical format of a Medium Access Control (MAC) Protocol Data Unit (PDU) including a Ranging Request (RNG-REQ) message;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 2B</figref> illustrates a format of a MAC PDU including an encrypted short data burst according to an embodiment of the present disclosure;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 3</figref> illustrates a short data encryption operation of a terminal according to an embodiment of the present disclosure;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a short data decryption operation of a Base Station (BS) according to an embodiment of the present disclosure;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a block diagram of a structure for encrypting a short data;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIGS. 6A and 6B</figref> illustrate a procedure for generating a Traffic Encryption Key (TEK) according to an embodiment of the present disclosure;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 7</figref> illustrates a terminal for encrypting a short data according to an embodiment of the present disclosure; and</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a BS for decrypting a short data according to an embodiment of the present disclosure.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0026" num="0025">Throughout the drawings, the same drawing reference numerals will be understood to refer to the same elements, features and structures.</p>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIGS. 1 through 8</figref>, discussed below, and the various embodiments used to describe the principles of the present disclosure in this patent document are by way of illustration only and should not be construed in any way to limit the scope of the disclosure. Those skilled in the art will understand that the principles of the present disclosure may be implemented in any suitably arranged wireless communication system. A detailed description of known functions and operations will not be given lest it should obscure the subject matter of the present disclosure.</p>
<p id="p-0028" num="0027">The following description is given with the appreciation that a Short Messaging Service (SMS) operation is performed in conformance to the Institute of Electrical and Electronics Engineers (IEEE) 802.16e/m standard in a wireless cellular communication system. However, the present disclosure is not limited to the specific communication protocol or system configuration and thus it is obvious to those skilled in the art that many modifications and variations can be made within the scope and spirit of the present disclosure.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 1</figref> illustrates short data transmission according to a preferred embodiment of the present disclosure. Referring to <figref idref="DRAWINGS">FIG. 1</figref>, a Mobile Station (MS) <b>120</b> within the cell area of a Base Station (BS) <b>110</b> transmits an intended text message in a radio signal to the BS <b>110</b> and the BS <b>110</b> transmits the text message to a receiving terminal <b>130</b>. The receiving terminal <b>130</b> can be another cellular MS, a PC, and the like. In the IEEE 802.16m standard, the BS <b>110</b> and the MS <b>120</b> are called an Advanced BS (ABS) and an Advanced MS (AMS), respectively, and an air interface between the ABS and the AMS is called an Advanced Air Interface (AAI).</p>
<p id="p-0030" num="0029">If an MS willing to transmit a text message is conducting a call, that is, it is in active mode, the text message is encrypted and transmitted in a traffic message. Alternatively, if the MS is not conducting a call, that is, it is in idle mode, the text message is carried in a message transmittable without network reentry in the idle mode, for example, in an AAI Ranging Request (AAI_RNG-REQ) message conforming to the IEEE 802.16m standard. Similarly, a text message directed to an idle-mode MS is transmitted in an AAI Ranging Response (AAI_RNG-RSP) message.</p>
<p id="p-0031" num="0030">When generating short data in the idle mode, a terminal transmits the short data burst, that is, SMS payload in an RNG-REQ message used for location update without network reentry, thereby save power.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 2A</figref> illustrates a typical format of a Medium Access Control (MAC) Protocol Data Unit (PDU) including an RNG-REQ message.</p>
<p id="p-0033" num="0032">Referring to <figref idref="DRAWINGS">FIG. 2A</figref>, the MAC PDU includes a MAC header <b>210</b>, payload <b>220</b> including an RNG-REQ message, and a Cipher-based Message Authentication Code (CMAC) Digest <b>230</b> for error check and integrity protection. If the RNG-REQ message is used for SMS transmission, a short data burst <b>225</b> is encapsulated in the payload <b>220</b>. The CMAC Digest <b>230</b> includes a PMK_SN and a CMAC-PN_U related to Security Association (SA) between a BS and the terminal and a CMAC value calculated for the RNG-REQ message, for integrity protection of the RNG-REQ message.</p>
<p id="p-0034" num="0033">The PMK_SN is the Serial Number (SN) of a Pairwise Master Key (PMK) to verify the integrity of the RNG-REQ message. The CMAC-PN_U is a CMAC Packet Number (PN) used on an Uplink (UL).</p>
<p id="p-0035" num="0034">Specifically, a UL or Downlink (DL) CMAC PN is the CMAC SN of a UL or DL control message. The UL or DL CMAC PN is a sequential counter that is incremented for each MAC control message containing a CMAC Tuple or CMAC Digest in the context of a UL or DL message. The CMAC PN is a part of an Authorization Key (AK) context acquired in an authentication procedure between the BS and the MS, unique for each MAC control message (such as, an RNG-REQ message) protected by a CMAC.</p>
<p id="p-0036" num="0035">The MAC PDU format illustrated in <figref idref="DRAWINGS">FIG. 2A</figref> supports the integrity protection of the RNG-REQ message, but not encryption of the short data burst <b>225</b>.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 2B</figref> illustrates a format of a MAC PDU including an encrypted short data burst according to a preferred embodiment of the present disclosure.</p>
<p id="p-0038" num="0037">Referring to <figref idref="DRAWINGS">FIG. 2B</figref>, the MAC PDU includes a MAC header <b>240</b>, payload <b>250</b> including an RNG-REQ message, and a CMAC Digest <b>260</b> for error check and integrity protection. Especially, an encrypted short data burst <b>255</b> is encapsulated in the payload <b>250</b>. As in <figref idref="DRAWINGS">FIG. 2A</figref>, the CMAC Digest <b>260</b> includes a PMK_SN, a CMAC-PN_U, and a CMAC value calculated for the RNG-REQ message.</p>
<p id="p-0039" num="0038">In accordance with an embodiment of the present disclosure, the short data burst <b>255</b> can be encrypted in an Advanced Encryption Standard with Counter mode (AES-CTR) encryption scheme. AES-CTR is one of encryption schemes supported by the IEEE 802.16m standard, in which text is encrypted without integrity verification. That is, since the integrity of the entire RNG-REQ message is ensured by the CMAC Digest <b>260</b>, a change in the size of the MAC PDU can be minimized by encrypting the short data burst <b>255</b> through AES-CTR.</p>
<p id="p-0040" num="0039">The AES-CTR scheme needs inputs of a Traffic Encryption Key (TEK) and a nonce N. The TEK is derived from a CMAC-TEK prekey which is generated using a Master Session Key (MSK) and an AK derived from the MSK. The terminal can acquire the MSK in an authentication procedure when it initially accesses the network, that is, during network entry and initialization.</p>
<p id="p-0041" num="0040">For example, the TEK can be derived by:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>TEK=Dot16KDF(CMAC-TEK prekey,SAID|COUNTER_TEK=0|TEK,128)&#x2003;&#x2003;[Eqn. 1]<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0042" num="0041">where Dot16KDF represents a predetermined key derivation function, SAID is an SA identification that identifies the SA between the BS and the terminal, and COUNTER_TEK is a counter value used to derive different TEKs from the same SAID. The SAID and COUNTER_TEK can be preset. For example, the SAID is set to 0x02 and the COUTNER_TEK is set to 0. A TEK generated based on the CMAC-TEK prekey, SAID=0x02, and COUNTER_TEK=0 is used for encryption of the short data burst <b>255</b>.</p>
<p id="p-0043" num="0042">The nonce N is constructed using a PN, for example, as illustrated in Table 1.</p>
<p id="p-0044" num="0043">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="35pt" align="left"/>
<colspec colname="1" colwidth="182pt" align="center"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" rowsep="1">TABLE 1</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Byte Number</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="offset" colwidth="35pt" align="left"/>
<colspec colname="1" colwidth="28pt" align="left"/>
<colspec colname="2" colwidth="42pt" align="left"/>
<colspec colname="3" colwidth="56pt" align="left"/>
<colspec colname="4" colwidth="56pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>0-1</entry>
<entry>2-3</entry>
<entry>4-9</entry>
<entry>10-12</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="28pt" align="left"/>
<colspec colname="3" colwidth="42pt" align="left"/>
<colspec colname="4" colwidth="56pt" align="left"/>
<colspec colname="5" colwidth="56pt" align="left"/>
<tbody valign="top">
<row>
<entry>Field</entry>
<entry>Short</entry>
<entry>STID and</entry>
<entry>Reserved</entry>
<entry>EKS and Packet</entry>
</row>
<row>
<entry>Name</entry>
<entry>data</entry>
<entry>Flow ID</entry>
<entry/>
<entry>Number</entry>
</row>
<row>
<entry/>
<entry>burst</entry>
</row>
<row>
<entry/>
<entry>length</entry>
</row>
<row>
<entry>Contents</entry>
<entry>Short</entry>
<entry>STID | FID</entry>
<entry>0x000000000000</entry>
<entry>00 |</entry>
</row>
<row>
<entry/>
<entry>data</entry>
<entry/>
<entry/>
<entry>CMAC_PN_U</entry>
</row>
<row>
<entry/>
<entry>burst</entry>
</row>
<row>
<entry/>
<entry>length</entry>
</row>
<row>
<entry namest="1" nameend="5" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0045" num="0044">Referring to [Table 1], the first two bytes of the nonce is filled with the length of the short data burst. If the Station ID (STID) and the Flow ID (FID) have not been assigned for a service flow of the terminal, STID and FID fields is set to all zeros (0's). The Encryption Key Sequence (EKS) field is filled with 0's and the PN used to construct the nonce is set to the same value as the CMAC-PN_U to be sent with the RNG-REQ message. The reason for using the CMAC-PN_U is that the RNG-REQ message does not have a PN, unlike a traffic MAC PDU.</p>
<p id="p-0046" num="0045">In an alternative embodiment, the RNG-REQ message can include an encryption indicator indicating whether the short data burst <b>255</b> is encrypted or not. The encryption indicator is 1 bit long, indicating whether the short data burst encapsulated in the RNG-REQ message is encrypted. [Table 2] below illustrates an exemplary format of an RNG-REQ message including the encryption indicator.</p>
<p id="p-0047" num="0046">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="42pt" align="center"/>
<colspec colname="3" colwidth="84pt" align="left"/>
<colspec colname="4" colwidth="49pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="4" rowsep="1">TABLE 2</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
<row>
<entry>Field</entry>
<entry>Size(bits)</entry>
<entry>Value/description</entry>
<entry>condition</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>Ranging</entry>
<entry>4</entry>
<entry>. . .</entry>
<entry/>
</row>
<row>
<entry>purpose</entry>
<entry/>
<entry>. . .</entry>
</row>
<row>
<entry>indication</entry>
<entry/>
<entry>0b0011 = Idle mode</entry>
</row>
<row>
<entry/>
<entry/>
<entry>location update</entry>
</row>
<row>
<entry/>
<entry/>
<entry>. . .</entry>
</row>
<row>
<entry>CMAC</entry>
<entry>1</entry>
<entry>Indicate whether this</entry>
</row>
<row>
<entry>indicator</entry>
<entry/>
<entry>message is protected by</entry>
</row>
<row>
<entry/>
<entry/>
<entry>CMAC tuple</entry>
</row>
<row>
<entry/>
<entry/>
<entry>0b0: not protected</entry>
</row>
<row>
<entry/>
<entry/>
<entry>0b1: protected</entry>
</row>
<row>
<entry>SMS</entry>
<entry>1</entry>
<entry>Indicate whether this SMS</entry>
</row>
<row>
<entry>encryption</entry>
<entry/>
<entry>is encrypted</entry>
</row>
<row>
<entry>indicator</entry>
<entry/>
<entry>0b0: not encrypted</entry>
</row>
<row>
<entry/>
<entry/>
<entry>0b1: encrypted</entry>
</row>
<row>
<entry>SMS</entry>
<entry>Variable</entry>
<entry>Short Message content up</entry>
<entry>May be</entry>
</row>
<row>
<entry/>
<entry/>
<entry>to 140 bytes</entry>
<entry>presented</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>when there is</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SMS content</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>to be sent</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0048" num="0047">In [Table 2], the Ranging purpose indication indicates the purpose of the RNG-REQ message. If the RNG-REQ message is used to transmit a short data burst, the Ranging purpose indication can be set to 0b0011. The CMAC indicator is a 1-bit field indicating whether the RNG-REQ message is protected by a CMAC and the SMS encryption indicator is a 1-bit field indicating whether the short data burst is encrypted.</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 3</figref> is a flowchart illustrating a short data encryption operation of a terminal according to an embodiment of the present disclosure.</p>
<p id="p-0050" num="0049">Referring to <figref idref="DRAWINGS">FIG. 3</figref>, an idle-mode terminal generates a short data burst to be transmitted to the peer in block <b>302</b> and determines whether to encrypt the short data burst in block <b>304</b>. In example, the determination can be made based on related parameters when the terminal's capabilities are negotiated during initial network entry. In another embodiment of the present disclosure, if it is regulated that a short data burst is always encrypted, block <b>304</b> can be omitted. In this case, the procedure jumps from block <b>302</b> to block <b>306</b>. Whether to omit block <b>304</b> can be determined according to a used communication standard or selection of a system designer.</p>
<p id="p-0051" num="0050">If the terminal determines not to encrypt the short data burst in block <b>304</b>, it jumps to block <b>308</b>. Alternatively, if the terminal determines to encrypt the short data burst in block <b>304</b>, the terminal proceeds to block <b>306</b>. In block <b>306</b>, the terminal generates a TEK needed for encryption of the short data burst using authorization-related parameters acquired during the initial network entry, that is, a CMAC-TEK prekey generated using an MSK and an AK derived from the MSK, constructs a nonce using the PN of a MAC PDU including an RNG-REQ message in which the short data burst is to be encapsulated, and encrypts the short data burst using the TEK and the nonce. The PN can be set to a CMAC-PN_U included in the MAC PDU.</p>
<p id="p-0052" num="0051">The terminal determines whether to perform CMAC protection for the RNG-REQ message in which the short data burst will be encapsulated in block <b>308</b>, which is optional. The determination of block <b>308</b> can be made in advance, for example, in the negotiation procedure during the initial network entry. If the terminal determines to perform CMAC protection, the terminal goes to block <b>310</b> and otherwise, it jumps to block <b>312</b>.</p>
<p id="p-0053" num="0052">In block <b>310</b>, the terminal generates a CMAC key using the CMAC-TEK prekey and derives a CMAC value from the CMAC key, to be included in a CMAC Digest of the MAC PDU along with the RNG-REQ message. The terminal generates the RNG-REQ message that includes the encrypted short data burst and optionally further includes a CMAC indicator and an SMS encryption indicator, constructs the MAC PDU by adding a MAC header and the CMAC Digest to the RNG-REQ message, and transmits the MAC PDU in a radio signal to a BS in block <b>312</b>.</p>
<p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart illustrating a short data decryption operation of a ES according to an embodiment of the present disclosure.</p>
<p id="p-0055" num="0054">Referring to <figref idref="DRAWINGS">FIG. 4</figref>, the BS receives a MAC PDU including an RNG-REQ message from an idle-mode terminal in block <b>402</b> and determines whether the RNG-REQ message is CMAC-protected based on a CMAC indicator included in the RNG-REQ message in block <b>404</b>. If the CMAC indicator indicates that the RNG-REQ message is CMAC-protected, the BS proceeds to block <b>406</b>. Otherwise, the BS discards the RNG-REQ message in block <b>418</b>.</p>
<p id="p-0056" num="0055">In block <b>406</b>, the BS acquires an AK context from an authenticator according to information included in the RNG-REQ message in order to authenticate the terminal. If the BS already has the AK context related to the terminal, block <b>406</b> may not be performed. The BS then generates a CMAC key using a CMAC-TEK prekey derived from the AK and verifies the CMAC of the RNG-REQ message using the CMAC key in block <b>408</b>. More specifically, the BS calculates a CMAC value for the RNG-REQ message using the CMAC key and compares the calculated CMAC value with a CMAC value set in a CMAC Digest attached to the RNG-REQ message.</p>
<p id="p-0057" num="0056">If the CMAC values are equal, the BS determines that the CMAC valuation of the RNG-REQ message is valid in block <b>410</b>. If the CMAC valuation of the RNG-REQ message is not valid, the BS discards the RNG-REQ message in block <b>418</b>. Alternatively, if the CMAC valuation of the RNG-REQ message is valid, the BS determines whether a short data burst encapsulated in the RNG-REQ message has been encrypted based on an encryption indicator included in the RNG-REQ message in block <b>412</b>. If the encryption indicator indicates that the short data burst has not been encrypted, the BS jumps to block <b>416</b>. If the encryption indicator indicates that the short data burst has been encrypted, the BS proceeds to block <b>414</b>. In another embodiment of the present disclosure, if it is regulated that a short data burst is always encrypted, an RNG-REQ message does not include an encryption indicator and thus the BS proceeds directly to block <b>414</b> without performing block <b>412</b>.</p>
<p id="p-0058" num="0057">In block <b>414</b>, the BS generates the same TEK as used for encryption of the short data burst in the terminal, using the CMAC-TEK prekey, constructs a nonce using a CMAC-PN_U attached to the RNG-REQ message, and decrypts the short data burst encapsulated in the RNG-REQ message using the TEK and the nonce in block <b>414</b>. In block <b>416</b>, the BS performs a process including display of the decrypted short data burst.</p>
<p id="p-0059" num="0058">It may be determined during initialization of a terminal whether the terminal is to encrypt a short data burst. According to an alternative embodiment of the present disclosure, an indicator indicating encryption of a Mobile-Originated (MO) short data burst can be included in a Subscriber Station Basic Capability Request (SBC-REQ) message transmitted by the terminal during its initialization or in a Subscriber Station Basic Capability Response (SBC-RSP) message with which the BS replies to the terminal in response to the SBC-REQ message. In another embodiment of the present disclosure, the indicator can be included in a Registration Request (REG-REQ) message transmitted by the terminal during network registration or in a Registration Response (REG-RSP) message that the BS transmits to the terminal in response to the REG-REQ message.</p>
<p id="p-0060" num="0059">[Table 3] below illustrates an exemplary format of an SBC-REQ/RSP message or an REG-REQ/RSP message that includes an MO SNS encryption indicator.</p>
<p id="p-0061" num="0060">
<tables id="TABLE-US-00003" num="00003">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="1" colwidth="70pt" align="left"/>
<colspec colname="2" colwidth="35pt" align="center"/>
<colspec colname="3" colwidth="70pt" align="left"/>
<colspec colname="4" colwidth="42pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="4" rowsep="1">TABLE 3</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
<row>
<entry>Field</entry>
<entry>Size(bits)</entry>
<entry>Value/description</entry>
<entry>Condition</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>MO(mobile-oriented)</entry>
<entry>1</entry>
<entry>Indicate whether MO</entry>
<entry/>
</row>
<row>
<entry>SMS encryption</entry>
<entry/>
<entry>SMS can be encrypted</entry>
</row>
<row>
<entry/>
<entry/>
<entry>0b0: support</entry>
</row>
<row>
<entry/>
<entry/>
<entry>encryption</entry>
</row>
<row>
<entry/>
<entry/>
<entry>0b1: not support</entry>
</row>
<row>
<entry/>
<entry/>
<entry>encryption</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0062" num="0061">Now a detailed description will be given of the procedures for encrypting and decrypting a short data burst.</p>
<p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of a structure for encrypting a short data by AES-CTR. Referring to <figref idref="DRAWINGS">FIG. 5</figref>, an AES-CTR encryption module <b>504</b> encrypts an input TEK <b>502</b>. A combiner <b>506</b> combines a short data burst <b>508</b> with the encrypted TEK, thus producing an encrypted short data burst <b>510</b>.</p>
<p id="p-0064" num="0063">As described before, because the TEK <b>502</b> is generated based on parameters known to the BS and the terminal, parameters exchanged through RNG-REQ and RNG-RSP messages, or expectable parameters, the encrypted short data burst <b>510</b> is not attached with additional payload such as an EKS and a PN, compared to encrypted traffic data. While a MAC PDU carrying traffic data is encrypted, only the short data burst is encrypted in the process of generating a MAC PDU carrying an RNG-REQ message in the embodiment of the present disclosure.</p>
<p id="p-0065" num="0064">A procedure for generating a TEK for use in encryption of a short data burst will be described below.</p>
<p id="p-0066" num="0065"><figref idref="DRAWINGS">FIGS. 6A and 6B</figref> illustrate a procedure for generating a TEK according to an embodiment of the present disclosure.</p>
<p id="p-0067" num="0066">Referring to <figref idref="DRAWINGS">FIG. 6A</figref>, a 512-bit MSK <b>602</b> is generated from an Authentication, Authorization, and Accounting (AAA) server and transmitted to an authenticator during authentication of a terminal. The terminal generates the same MSK as generated in the AAA server during the authentication. The terminal and the authenticator derive a 160-bit PMK <b>604</b> by truncating the MSK <b>602</b> to 160 bits. The derivation of the PMK <b>604</b> from the MSK <b>602</b> can be expressed as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>PMK=truncate(MSK,160)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0068" num="0067">If the initial authentication is successful, the BS and the terminal can derive an AK <b>606</b> from the PMK <b>604</b> in an Extensible Authentication Protocol (EAP)-based authorization procedure and share the AK <b>606</b> between them. For example, the AK <b>606</b> can be generated by:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>AK=Dot16KDF(PMK,AMS Address|ABSID|&#x201c;AK&#x201d;,160)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0069" num="0068">where AMS Address can be the MAC address or MS ID (MSID) of the terminal. The MSID is a random value generated using the MAC address of the MS as a seed. ABSID is the ID of the BS.</p>
<p id="p-0070" num="0069">Referring to <figref idref="DRAWINGS">FIG. 6B</figref>, a TEK <b>614</b> is generated based on the AK <b>606</b>. Specifically, a CMAC-TEK prekey <b>610</b> is generated by performing a KDF using the AK <b>606</b>. For example, the CMAC-TEK prekey <b>610</b> is derived by
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>CMAC-TEK prekey=Dot16KDF(AK,AK_COUNT|&#x201c;CMAC_TEK prekey&#x201d;,160)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0071" num="0070">where AK_COUNT is a counter value used to ensure that different CMAC keys and TEKs are used for the same BS-terminal pairs.</p>
<p id="p-0072" num="0071">Then, the 128-bit TEK <b>614</b> is generated using the CMAC-TEK prekey <b>610</b> as follows.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>TEK<i>i</i>=Dot16KDF(CMAC-TEK prekey,SAID|COUNTER_TEK=<i>I</i>|&#x201c;TEK&#x201d;,128)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0073" num="0072">where SAID is preset, for example, to 0x02 as stated before. The TEK <b>614</b>, that is, TEK<b>0</b> generated using SAID=0x02 and COUNTER_TEK=0 is used for encryption of the short data burst.</p>
<p id="p-0074" num="0073">Besides, a CMAC_KEY_U and a CMAC_KEY_D for the uplink and downlink can be generated using the CMAC-TEK prekey <b>610</b>, and a CMAC value in a CMAC Digest attached to an RNG-REQ message is generated using the CMAC_KEY_U. For example, the CMAC value is given as
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>CMAC value=Truncate(CMAC(CMAC_KEY<sub>&#x2014;</sub><i>U</i>,AK ID|CMAC_PN|STID|FID|24-bit zero padding|ASN.1 encoded MAC_Control_Message),64)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0075" num="0074">where STID is the station identifier of the terminal. If an STID is not assigned to the terminal, the STID can be set to &#x2018;000000000000&#x2019;.</p>
<p id="p-0076" num="0075">AKID identifies an AK for protecting the message, generated as follows, for example.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>AK ID=Dot16KDF(AK,0<i>b</i>0000|PMK SN|AMSID or MS MAC Address|ABSID|&#x201c;AKID,64)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0077" num="0076">According to an AK derivation formula, an AMSID or an MS MAC address can be used.</p>
<p id="p-0078" num="0077">Referring to <figref idref="DRAWINGS">FIGS. 3 and 4</figref> again, the terminal generates a CMAC value using a CMAC-TEK key derived from a CMAC-TEK prekey and transmits an RNG-REQ message together with the CMAC value to the BS in block <b>310</b>. In block <b>408</b>, the BS verifies the RNG-REQ message by comparing a CMAC value generated using a CMAC key derived from the CMAC-TEK prekey with the CMAC value attached to the RNG-REQ message.</p>
<p id="p-0079" num="0078">The operations according to the afore-described embodiments can be implemented by providing memories that stores program codes corresponding to the operations in the BS and the terminal. That is, the BS and the terminal perform the operations by reading the program codes from the memories through a processor or a Central Processing Unit (CPU) and executing the program codes. Specifically, both or either of the BS and the terminal is configured so as to perform short data burst encryption/decryption according to the embodiments of the present disclosure.</p>
<p id="p-0080" num="0079"><figref idref="DRAWINGS">FIG. 7</figref> is a block diagram of a terminal for encrypting a short data according to an embodiment of the present disclosure. While components of the terminal are shown in <figref idref="DRAWINGS">FIG. 7</figref> as separately configured, a plurality of components can be incorporated into a controller or a processor.</p>
<p id="p-0081" num="0080">Referring to <figref idref="DRAWINGS">FIG. 7</figref>, a short data generator <b>702</b> generates a short data burst to be transmitted to the peer. An encryptor <b>704</b> encrypts the short data burst received from the short data generator <b>702</b> based on authorization-related parameters received from a memory <b>712</b> under the control of a controller <b>710</b>. Specifically, the controller <b>710</b> determines whether to encrypt the short data burst according to a preliminary negotiation or a preset rule and controls the encryptor <b>704</b> according to the determination. The memory <b>712</b> stores authorization-related parameters acquired during initial network entry, including a CMACK-TEK prekey derived from an MSK and an AK by the controller <b>712</b> and provides the CMAC-TEK prekey to the encryptor <b>704</b> under the control of the controller <b>712</b>.</p>
<p id="p-0082" num="0081">The encryptor <b>704</b> generates a TEK needed for encryption of the short data burst using the CMAC-TEK prekey, constructs a nonce using the PN of a MAC PDU including an RNG-REQ message in which the short data burst is encapsulated, and encrypts the short data burst using the TEK and the nonce. The PN can be equal to a CMAC-PN_U included in the MAC PDU.</p>
<p id="p-0083" num="0082">A message generator <b>706</b> constructs an RNG-REQ message including the short data burst encrypted by the encryptor <b>704</b> and generates a MAC PDU including a CMAC Digest with a CMAC value generated using the CMAC-TEK prekey. A transmitter <b>708</b> transmits the MAC PDU in a radio signal to the BS.</p>
<p id="p-0084" num="0083"><figref idref="DRAWINGS">FIG. 8</figref> is a block diagram of a BS for decrypting a short data according to an embodiment of the present disclosure. While components of the BS are shown in <figref idref="DRAWINGS">FIG. 8</figref> as separately configured, a plurality of components can be incorporated into a controller or a processor.</p>
<p id="p-0085" num="0084">Referring to <figref idref="DRAWINGS">FIG. 8</figref>, a receiver <b>802</b> receives a MAC PDU including an RNG-REQ message in a radio signal. A message interpreter <b>804</b> parses a MAC header, the RNG-REQ message, and a CMAC Digest from the MAC PDU received from the receiver <b>802</b> and interprets them. Especially, the message interpreter <b>804</b> interprets the RNG-REQ message under the control of a controller <b>810</b> and extracts a short data burst from the RNG-REQ message.</p>
<p id="p-0086" num="0085">A decryptor <b>806</b> decrypts the encrypted short data burst received from the message interpreter <b>804</b> based on authorization-related parameters received from a memory <b>812</b> under the control of the controller <b>810</b>. Specifically, the controller <b>810</b> determines whether to decrypt the short data burst according to an encryption indicator included in the RNG-REQ message and controls the decryptor <b>806</b> according to the determination. In addition, the controller <b>810</b> acquires an AK context for authenticating the terminal from an authenticator according to information included in the RNG-REQ message, derives a CMAC-TEK prekey based on the AK context, and stores the CMAC-TEK prekey in the memory <b>812</b>. The decryptor <b>806</b> generates the same TEK as used for encrypting the short data burst in the terminal using the CMAC-TEK prekey received from the memory <b>812</b>, constructs a nonce using a CMAC-PN_U attached to the RNG-REQ message, and decrypts the encrypted short data burst using the TEK and the nonce. A short data processor <b>808</b> performs a necessary operation including display or output of the decrypted short data burst on a display.</p>
<p id="p-0087" num="0086">As is apparent from the above description, because short data to be transmitted from an idle-mode terminal is encrypted according to the present disclosure, the terminal can transmit important information securely. Especially, the short data is encrypted using authorization-related parameters already known to both a BS and the terminal in a known encryption scheme without using additional parameters. Therefore, security is provided to the short data without increasing system and signaling overhead.</p>
<p id="p-0088" num="0087">Although the present disclosure has been described with an exemplary embodiment, various changes and modifications may be suggested to one skilled in the art. It is intended that the present disclosure encompass such changes and modifications as fall within the scope of the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for encrypting short data at a terminal in a wireless communication system, the method comprising:
<claim-text>generating a short data burst in idle mode;</claim-text>
<claim-text>generating a Traffic Encryption Key (TEK) using a Cipher-based Message Authentication Code (CMAC)-TEK prekey derived from an Authorization Key (AK) related to Security Association (SA) between the terminal and a Base Station (BS), the AK being acquired in an authentication procedure during initial network entry;</claim-text>
<claim-text>constructing, by the terminal, a nonce using a Packet Number (PN) identical to an uplink CMAC PN (CMAC-PN_U) transmitted together with a Ranging Request (RNG-REQ) message carrying the short data burst;</claim-text>
<claim-text>encrypting the short data burst using the TEK and the nonce;</claim-text>
<claim-text>generating a Medium Access Control (MAC) Protocol Data Unit (PDU) by attaching a MAC header and the CMAC-PN_U for integrity protection to the RNG-REQ message carrying the encrypted short data burst; and</claim-text>
<claim-text>transmitting the MAC PDU in a radio signal to the BS.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the RNG-REQ message includes a ranging purpose indication field indicating that the RNG-REQ message is transmitted for idle-mode location update, a CMAC indicator indicating whether the RNG-REQ message is protected by a CMAC, and the encrypted short data burst.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the RNG-REQ message includes an encryption indicator indicating whether the short data burst included in the RNG-REQ message is encrypted.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the nonce includes a length of the short data burst, a Station Identifier (STID), a Flow ID (FID), a predetermined number of 0s, and the CMAC-PN_U.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>generating a Pairwise Master Key (PMK) by truncating a Master Session Key (MSK) acquired during the initial network entry;</claim-text>
<claim-text>generating the AK for the SA between the terminal and the BS using the PMK, an address of the terminal, and an ID of the BS; and</claim-text>
<claim-text>generating the CMAC-TEK prekey using the AK,</claim-text>
<claim-text>wherein the TEK generation comprises generating the TEK using the CMAC-TEK prekey, an SA Identification (SAID) of the SA between the terminal and the BS, and a TEK counter value for the TEK, and</claim-text>
<claim-text>wherein the SAID and the TEK counter value are preset.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. A method for decrypting short data at a Base Station (BS) in a wireless communication system, the method comprising:
<claim-text>receiving a Medium Access Control (MAC) Protocol Data Unit (PDU) that includes a Ranging Request (RNG-REQ) message carrying an encrypted short data burst, a MAC header, and an Uplink Cipher-based Message Authentication Code (CMAC) Packet Number (PN) (CMAC-PN _U) for integrity protection from a terminal in idle mode;</claim-text>
<claim-text>generating a Traffic Encryption Key (TEK) using a CMAC-TEK prekey derived from an Authorization Key (AK) related to Security Association (SA) between the terminal and the BS;</claim-text>
<claim-text>constructing a nonce using a Packet Number (PN) identical to the CMAC-PN_U transmitted with the RNG-REQ message; and</claim-text>
<claim-text>decrypting the encrypted short data burst using the TEK and the nonce.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the RNG-REQ message includes a ranging purpose indication field indicating that the RNG-REQ message is transmitted for idle-mode location update, and a CMAC indicator indicating whether the RNG-REQ message is protected by a CMAC, and the encrypted short data burst.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the RNG-REQ message includes an encryption indicator indicating whether the short data burst included in the RNG-REQ message is encrypted.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the nonce includes a length of the short data burst, a Station Identifier (STID), a Flow ID (FID), a predetermined number of 0s, and the CMAC-PN_U.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, further comprising:
<claim-text>generating a Pairwise Master Key (PMK) by truncating a Master Session Key (MSK) acquired in relation to the SA;</claim-text>
<claim-text>generating the AK for the SA between the terminal and the BS using the PMK, an address of the terminal, and an ID of the BS; and</claim-text>
<claim-text>generating the CMAC-TEK prekey using the AK,</claim-text>
<claim-text>wherein the TEK generation comprises generating the TEK using the CMAC-TEK prekey, an SA Identification (SAID) of the SA between the terminal and the BS, and a TEK counter value for the TEK, and</claim-text>
<claim-text>wherein the SAID and the TEK counter value are preset.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A terminal apparatus for encrypting short data in a wireless communication system, the terminal apparatus comprising:
<claim-text>a generator configured to generate a short data burst in idle mode;</claim-text>
<claim-text>an encryptor configured to generate a Traffic Encryption Key (TEK) using a Cipher-based Message Authentication Code (CMAC)-TEK prekey derived from an Authorization Key (AK) related to Security Association (SA) between the terminal and a Base Station (BS), the AK being acquired in an authentication procedure during initial network entry, construct a nonce with a Packet Number (PN) identical to an uplink CMAC PN (CMAC-PN_U) transmitted together with a Ranging Request (RNG-REQ) message carrying the short data burst, and encrypt the short data burst using the TEK and the nonce; and</claim-text>
<claim-text>a transmitter configured to generate a Medium Access Control (MAC) Protocol Data Unit (PDU) by attaching a MAC header and the CMAC-PN_U for integrity protection to the RNG-REQ message carrying the encrypted short data burst, and transmit the MAC PDU in a radio signal to the BS.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The terminal apparatus of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the RNG-REQ message includes a ranging purpose indication field configured to indicate that the RNG-REQ message is transmitted for idle-mode location update, a CMAC indicator configured to indicate whether the RNG-REQ message is protected by a CMAC, and the encrypted short data burst.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The terminal apparatus of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the RNG-REQ message includes an encryption indicator configured to indicate whether the short data burst included in the RNG-REQ message is encrypted.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The terminal apparatus of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the nonce includes a length of the short data burst, a Station Identifier (STID), a Flow ID (FID), a predetermined number of 0s, and the CMAC-PN_U.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The terminal apparatus of <claim-ref idref="CLM-00011">claim 11</claim-ref>, further comprising a controller configured to generate a Pairwise Master Key (PMK) by truncating a Master Session Key (MSK) acquired during the initial network entry, generating the AK for the SA between the terminal and the BS using the PMK, an address of the terminal, and an ID of the BS, and generating the CMAC-TEK prekey using the AK,
<claim-text>wherein the TEK is generated by using the CMAC TEK prekey, an SA Identification (SAID) of the SA between the terminal and the BS, and a TEK counter value for the TEK, and</claim-text>
<claim-text>wherein the SAID and the TEK counter value are preset.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A Base Station (BS) apparatus for decrypting short data in a wireless communication system, the BS apparatus comprising:
<claim-text>a receiver configured to receive a Medium Access Control (MAC) Protocol Data Unit (PDU) that includes a Ranging Request (RNG-REQ) message carrying an encrypted short data burst, a MAC header, and an Uplink Cipher-based Message Authentication Code (CMAC) Packet Number (PN) (CMAC-PN_U) for integrity protection from a terminal in idle mode; and</claim-text>
<claim-text>a decryptor configured to generate a Traffic Encryption Key (TEK) using a CMAC-TEK prekey derived from an Authorization Key (AK) related to Security Association (SA) between the terminal and the BS, construct a nonce with a Packet Number (PN) identical to the CMAC-PN_U transmitted with the RNG-REQ message, and decrypt the encrypted short data burst using the TEK and the nonce,</claim-text>
<claim-text>wherein the CMAC-PN_U is included in the CMAC digest.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The BS apparatus of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the RNG-REQ message includes a ranging purpose indication field configured to indicate that the RNG-REQ message is transmitted for idle-mode location update, a CMAC indicator configured to indicate whether the RNG-REQ message is protected by a CMAC, and the encrypted short data burst.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The BS apparatus of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein the RNG-REQ message includes an encryption indicator configured to indicate whether the short data burst included in the RNG-REQ message is encrypted.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The BS apparatus of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the nonce includes a length of the short data burst, a Station Identifier (STID), a Flow ID (FID), a predetermined number of 0s, and the CMAC-PN_U.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The BS apparatus of <claim-ref idref="CLM-00016">claim 16</claim-ref>, further comprising a controller configured to generate a Pairwise Master Key (PMK) by truncating a Master Session Key (MSK) acquired in relation to the SA, generating the AK for the SA between the terminal and the BS using the PMK, an address of the terminal, and an ID of the BS, and generating the CMAC-TEK prekey using the AK, wherein the TEK is generated by using the CMAC-TEK prekey, an SA Identification (SAID) of the SA between the terminal and the BS, and a TEK counter value for the TEK, and
<claim-text>wherein the SAID and the TEK counter value are preset.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
