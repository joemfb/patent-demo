<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08627390-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08627390</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11549909</doc-number>
<date>20061016</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<rule-47-flag/>
<us-term-of-grant>
<us-term-extension>1440</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20110101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>7</main-group>
<subgroup>173</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>725 95</main-classification>
<further-classification>725 93</further-classification>
</classification-national>
<invention-title id="d2e55">Method and device for providing programs to multiple end user devices</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5612742</doc-number>
<kind>A</kind>
<name>Krause et al.</name>
<date>19970300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>37524025</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6698020</doc-number>
<kind>B1</kind>
<name>Zigmond et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>725 34</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7558587</doc-number>
<kind>B2</kind>
<name>Albal et al.</name>
<date>20090700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455509</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2003/0066078</doc-number>
<kind>A1</kind>
<name>Bjorgan et al.</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>725 34</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2005/0081244</doc-number>
<kind>A1</kind>
<name>Barrett et al.</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>725 97</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2006/0268697</doc-number>
<kind>A1</kind>
<name>Oz et al.</name>
<date>20061100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370229</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2007/0147411</doc-number>
<kind>A1</kind>
<name>Bijwaard et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370432</main-classification></classification-national>
</us-citation>
</us-references-cited>
<number-of-claims>19</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>10</number-of-drawing-sheets>
<number-of-figures>10</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60764736</doc-number>
<date>20060201</date>
</document-id>
</us-provisional-application>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60764852</doc-number>
<date>20060203</date>
</document-id>
</us-provisional-application>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60744145</doc-number>
<date>20060403</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20090168679</doc-number>
<kind>A1</kind>
<date>20090702</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Benjamim</last-name>
<first-name>Shai</first-name>
<address>
<city>Mevaseret Zion</city>
<country>IL</country>
</address>
</addressbook>
<residence>
<country>IL</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Reister</last-name>
<first-name>John</first-name>
<address>
<city>Palo Alto</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Avieli</last-name>
<first-name>Gilat</first-name>
<address>
<city>Jerusalem</city>
<country>IL</country>
</address>
</addressbook>
<residence>
<country>IL</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Finkelstein</last-name>
<first-name>Modi</first-name>
<address>
<city>Ramat Aviv</city>
<country>IL</country>
</address>
</addressbook>
<residence>
<country>IL</country>
</residence>
</us-applicant>
<us-applicant sequence="005" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Elad</last-name>
<first-name>Asi</first-name>
<address>
<city>Neve Monoson</city>
<country>IL</country>
</address>
</addressbook>
<residence>
<country>IL</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Benjamim</last-name>
<first-name>Shai</first-name>
<address>
<city>Mevaseret Zion</city>
<country>IL</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Reister</last-name>
<first-name>John</first-name>
<address>
<city>Palo Alto</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Avieli</last-name>
<first-name>Gilat</first-name>
<address>
<city>Jerusalem</city>
<country>IL</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Finkelstein</last-name>
<first-name>Modi</first-name>
<address>
<city>Ramat Aviv</city>
<country>IL</country>
</address>
</addressbook>
</inventor>
<inventor sequence="005" designation="us-only">
<addressbook>
<last-name>Elad</last-name>
<first-name>Asi</first-name>
<address>
<city>Neve Monoson</city>
<country>IL</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Van Aacken</last-name>
<first-name>Troy A.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>ARRIS Solutions, Inc.</orgname>
<role>02</role>
<address>
<city>Suwanee</city>
<state>GA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Pendleton</last-name>
<first-name>Brian</first-name>
<department>2425</department>
</primary-examiner>
<assistant-examiner>
<last-name>Idowu</last-name>
<first-name>Olugbenga</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A scheme for providing programs to multiple end user devices. Two types of media streams that convey a first group of programs are provided to multiple end user devices via an edge device. The two types of programs include a unicast media stream and a multicast media stream. When a request from a first end user device to view a first program that belongs to the first group of programs is received, a type of a media stream that conveys the first program to a second end user device is selectively switched, in response to bandwidth constraints imposed on a communication path coupled to the edge device.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="147.66mm" wi="215.65mm" file="US08627390-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="264.50mm" wi="167.05mm" orientation="landscape" file="US08627390-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="238.76mm" wi="140.80mm" orientation="landscape" file="US08627390-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="246.46mm" wi="166.71mm" orientation="landscape" file="US08627390-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="258.06mm" wi="180.09mm" orientation="landscape" file="US08627390-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="215.90mm" wi="118.36mm" orientation="landscape" file="US08627390-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="215.90mm" wi="138.43mm" orientation="landscape" file="US08627390-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="214.97mm" wi="102.70mm" orientation="landscape" file="US08627390-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="215.90mm" wi="158.24mm" orientation="landscape" file="US08627390-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="120.82mm" wi="134.11mm" orientation="landscape" file="US08627390-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="246.46mm" wi="136.65mm" orientation="landscape" file="US08627390-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">The present application is related to and claims the priority benefit of the following U.S. provisional patent applications, each of which is incorporated herein by reference: U.S. Provisional Patent Application No. 60/764,736, filed 1 Feb. 2006, U.S. Provisional Patent Application No. 60/764,852, filed 2 Feb. 2006, and U.S. Provisional Patent Application No. 60/744,145, filed 3 Apr. 2006.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to communication systems and especially to methods and systems for providing programs to multiple end user devices.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">The number of television channels (programs) has dramatically increased during the last decade. In addition, various technologies such as high definition television require larger bandwidth.</p>
<p id="p-0005" num="0004">In order to provide many programs to multiple user devices various techniques such as statistical multiplexing and various compression schemes (such as but not limited to the MPEG compression standards) were developed. These techniques can improve the bandwidth utilization of existing infrastructure. Nevertheless, even when these techniques are implemented the number of programs that can be provided to users is relatively limited.</p>
<p id="p-0006" num="0005">The following patents and patent applications, all being incorporated herein by reference, illustrate some prior art methods and devices for providing multiple programs to users: U.S. Pat. No. 6,597,670 of Tweedy et al., entitled &#x201c;Method and system for distributing subscriber services using wireless bidirectional broadband loops&#x201d;; U.S. Patent Application Publication Serial Number 2005/0033342 of Rosetti et al., entitled &#x201c;Technique for providing a virtual digital video recorder service through a communication network&#x201d;; U.S. Patent Application Publication Serial Number of Carlucci et al., entitled &#x201c;Technique for effectively providing various entertainment services thorough a communication network&#x201d;; PCT Patent Application Publication No. WO 2005/008419 of Compton el al., entitled &#x201c;Distributed and scalable architecture for on demand session and resource management&#x201d;; PCT Patent Application Publication No. WO 2005/022796 of Krause et al., entitled &#x201c;Advanced, adaptive video multiplexing system&#x201d;; PCT Patent Application Publication No. WO 2005/022892 of Krause et al., entitled &#x201c;Video multiplexer system providing low-latency VCR-like effects and program changes&#x201d; and U.S. Pat. No. 6,718,552 of Goode, entitled &#x201c;Network bandwidth optimization by dynamic channel allocation&#x201d;.</p>
<p id="p-0007" num="0006">There is a need to provide efficient methods and devices for providing programs to multiple users.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0008" num="0007">A device for providing multiple programs. The device includes an output interface adapted to: (i) provide to an edge device two types of media streams that convey a first group of programs; wherein the two types comprises a unicast media stream and a multicast media stream; wherein the media streams are provided via the edge device to multiple end users; (ii) receive a request from a first end user device to view a first program that belongs to the first group of programs; and a controller adapted to determine when to selectively switch, in response to bandwidth constraints imposed on a communication path coupled to the edge device, a type of a media stream that conveys the first program to a second end user device.</p>
<p id="p-0009" num="0008">A method for providing programs to multiple end user devices. The method includes: providing to multiple end user devices, via an edge device, two types of media streams that convey a first group of programs; wherein the two types comprises a unicast media stream and a multicast media stream; receiving a request from a first end user device to view a first program that belongs to the first group of programs; and selectively switching, in response to bandwidth constraints imposed on a communication path coupled to the edge device, a type of a media stream that conveys the first program to a second end user device.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0010" num="0009">The present invention will be understood and appreciated more fully from the following detailed description taken in conjunction with the drawings in which:</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 1</figref> illustrates an intermediate unit and its environment according to an embodiment of the invention;</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 2</figref> illustrates an intermediate unit and its environment according to an embodiment of the invention;</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 3</figref> illustrates intermediate units and their environment according to an embodiment of the invention;</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 4</figref> illustrates an intermediate unit according to an embodiment of the invention;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a user device according to an embodiment of the invention;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 6</figref> illustrates various media streams that are provided to end user devices according to an embodiment of the invention;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 7</figref> illustrates various group of pictures according to an embodiment of the invention;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 8</figref> illustrates various bandwidth thresholds, according to an embodiment of the invention;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 9</figref> illustrates a method for providing programs to multiple end users, according to an embodiment of the invention; and</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 10</figref> illustrates a method for providing programs to multiple end users, according to an embodiment of the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0021" num="0020">It is noted that the description relates to MPEG (and especially MPEG2) compliant programs and components, but the invention is applicable to other types of media unit decoding and/or compression schemes as well.</p>
<p id="p-0022" num="0021">The method and device facilitate an alteration of a type of a media stream that is provided to an end user device in response to requests generated by another end user device. If bandwidth constraints require a reduction of the aggregate bandwidth of media streams provided to an edge device then at least one media stream can be converted from a unicast media stream to a multicast media stream. If bandwidth constraints allow an increment of the aggregate bandwidth of media streams provided to an edge device then at least one media stream can be converted from a multicast media stream to a unicast media stream.</p>
<p id="p-0023" num="0022">Conveniently the alteration of program (also referred to as channel) type from multicast to unicast occurs at switching points such as advertisement splicing points or channel change requests, thus providing a substantially seamless media stream type alteration. Switching in these switching points can be unnoticed by the end user.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 1</figref> illustrates an intermediate unit <b>40</b> and its environment <b>10</b> according to an embodiment of the invention.</p>
<p id="p-0025" num="0024">Intermediate unit <b>40</b> can also be referred to as aggregate unit or as device. It receives multicast media streams as well as unicast media streams and is able to alter the type (multicast, unicast) of media streams that it provides to one or more edge units (such as edge units <b>50</b>, <b>50</b>&#x2032; and <b>50</b>&#x2033;) in response to various parameters including bandwidth limitations of the communication paths between intermediate unit <b>40</b> and edge units <b>50</b>, <b>50</b>&#x2032; and <b>50</b>&#x2033; accordingly.</p>
<p id="p-0026" num="0025">Intermediate unit <b>40</b> can also receive upstream transmission from end user devices <b>60</b>-<b>62</b>, <b>60</b>&#x2032;-<b>62</b>&#x2032; and <b>60</b>&#x2033;-<b>62</b>&#x2033; and send it towards headend <b>20</b>. It is noted that multiple end user devices can be placed in a single household.</p>
<p id="p-0027" num="0026">Intermediate unit <b>40</b> is also able to process media streams by applying various rate-shaping and/or compression algorithms.</p>
<p id="p-0028" num="0027">Intermediate unit <b>40</b> can change the type of media streams provided to certain end user devices in response to requests from other end user devices. Thus, a change between multicast stream to unicast stream (and vice verse) provided to a certain end user device can occur even if that certain end user device does not request to change the program it receives.</p>
<p id="p-0029" num="0028">Headend <b>20</b> and intermediate unit <b>40</b> are connected to each other via a headend to intermediate unit network <b>30</b>. The intermediate unit <b>40</b> is connected to multiple edge units such as edge units <b>50</b>-<b>50</b>&#x2033; via intermediate unit to edge unit network <b>70</b>. It is noted that the number of edge units that are connected to a single intermediate unit can exceed and even well exceed three. Typically, each edge unit is connected to the intermediate unit <b>40</b> via a bandwidth limited communication link. This bandwidth limited communication link may cause the intermediate unit <b>40</b> to alter the type of media streams it sends to the edge unit and also may cause the intermediate unit to compress one or more media streams.</p>
<p id="p-0030" num="0029">Conveniently, the edge unit is a DSLAM, but this is not necessarily so.</p>
<p id="p-0031" num="0030">Environment <b>10</b> can be used to convey data, voice and video to end user devices and also receive upstream traffic from the end user devices towards headend <b>20</b>. It is noted that headend <b>20</b> can have a distributed architecture, and that various components such as but not limited to video on demand servers, broadband network gateways and the like can be connected to the intermediate unit <b>40</b>. In addition, more than two networks can be connected to the intermediate unit <b>40</b>.</p>
<p id="p-0032" num="0031">Headend <b>20</b> can receive media content from various sources such as video on demand server <b>92</b>, and satellite dishes <b>93</b>, <b>93</b>&#x2032; and <b>93</b>&#x2033;. Headend <b>20</b> includes a media processor <b>21</b> that can process programs in various manners, including rate-shaping, perform PID re-mapping, generate delayed versions of a program, duplicate programs, perform statistical multiplexing, compress, encrypt and the like. It is noted that video on demand server <b>92</b> can also be connected to an edge unit and not the headend <b>20</b>.</p>
<p id="p-0033" num="0032">An exemplary broadband media router that has such media processing capabilities is described in U.S. Pat. No. 6,434,141 of Oz et al., which is incorporated herein by reference. An exemplary method and device for generating delayed version of programs is described in U.S. Pat. No. 6,813,270 of Oz et al., which is also incorporated herein by reference. It is further noted that intermediate unit <b>40</b> can have at least some of the video processing capabilities of the broadband media router, although it is not necessarily a router but can be only a switch.</p>
<p id="p-0034" num="0033">Headend <b>20</b> transmits a headend multiplex (M<b>0</b>) to multiple intermediate units, such as intermediate unit <b>40</b>. Each intermediate unit transmits a intermediate unit multiplex (for example multiplexes M<b>1</b>-M<b>3</b> of intermediate unit <b>40</b>) to multiple edge devices such as edge devices <b>50</b>-<b>50</b>&#x2033;. Typically, end user devices that receive the same multiplex are referred to as an end user devices group.</p>
<p id="p-0035" num="0034">Media processor <b>21</b> of headend <b>20</b> is controlled by headend management unit <b>26</b> that may determine which media processing operations to apply and also determine which media streams should be included within the headend and intermediate unit multiplexes. These media streams can include multicast and unicast media streams. Typically, programs received from satellite dished <b>93</b>-<b>93</b>&#x2033; are conveyed over multicast media streams while programs received from VOD server <b>92</b> are conveyed over unicast media streams, but this is not necessarily so.</p>
<p id="p-0036" num="0035">Intermediate unit <b>40</b> can receive a program that is being conveyed over a multicast media stream and convert the multicast media stream to one or more multicast media streams. This split can be made for various reasons, including targeted advertising.</p>
<p id="p-0037" num="0036">Usually, headend <b>20</b> is connected to multiple intermediate units (for example intermediate units <b>40</b> and <b>40</b>&#x2032; <figref idref="DRAWINGS">FIG. 3</figref>), and is capable of providing to each intermediate unit a different program multiplex. It is noted that the number of intermediate units can differ from two.</p>
<p id="p-0038" num="0037">Alternatively, each intermediate unit can receive a headend multiplex of programs and select the programs and the type of conveying media streams to be included within the intermediate unit multiplex of programs. Typically, the bandwidth of the headend to intermediate unit network <b>30</b> is much larger than the bandwidth of the intermediate unit to edge unit network <b>70</b>, thus the headend multiplex can include much more programs than the intermediate unit multiplex. The intermediate unit to edge unit network <b>70</b> can include multiple point to point links from IU <b>40</b> to multiple edge units.</p>
<p id="p-0039" num="0038">The headend management unit <b>26</b> can perform additional tasks such as billing related tasks, and the like.</p>
<p id="p-0040" num="0039">Headend <b>20</b> also includes a transport system <b>24</b> that is adapted to receive one or more program multiplexes from media processor <b>21</b> and to process it such as to comply to format conveyed over headend to intermediate unit network <b>30</b>. This processing may include fragmentation, aggregation, packet encapsulation, and the like.</p>
<p id="p-0041" num="0040">Headend management unit <b>26</b> is usually adapted to perform resource allocation. The resource allocation determines the resources (including component, frequency, bandwidth, port and the like) that are allocated for a certain task (such as a transmission of a program). Headend management unit <b>26</b> can determine which programs to include within each multiplex, when to send program removal information and how to response to received program removal responses that are transmitted by user devices.</p>
<p id="p-0042" num="0041">According to another embodiment of the invention the resource management is performed, at least partially, by management units located within one or more intermediate units.</p>
<p id="p-0043" num="0042">According to an embodiment of the invention headend <b>20</b> can determine which programs to include within each program multiplex based upon various parameters, including user viewing patterns, viewing statistics and the like.</p>
<p id="p-0044" num="0043">According to an embodiment of the invention the headend <b>20</b>, or any of the intermediate units <b>40</b>, <b>40</b>&#x2032; and <b>40</b>&#x2033; are capable of inserting advertisements in the various multiplexes. By knowing which program will be viewed by which end user, the headend <b>20</b> or any intermediate unit can send to that end user targeted advertisements. A targeted advertisement is an advertisement that has a certain degree of correlation with the program viewed by the end user, or with one other end user characteristic. An end user characteristic can be learnt from the end user viewing patterns, and especially from the programs the end user watches. The headend and/or intermediate units <b>40</b> or <b>40</b>&#x2032; can receive end user related information from the end users or from another data source or database.</p>
<p id="p-0045" num="0044">According to an embodiment of the invention the end user can also receive interactive services, thus the manner in which the end user participates in these services can also indicate which commercials to send to the end user.</p>
<p id="p-0046" num="0045">Each component out of the headend <b>20</b>, intermediate unit <b>40</b> or intermediate unit <b>40</b>&#x2032; can insert a unique advertisement to a program that is sent to one or more end user devices.</p>
<p id="p-0047" num="0046">According to an embodiment of the invention a component allocates a certain channel to a client. When the client wishes to switch programs the central component switches the programs that are sent over the certain channel. In such a case the advertisement is inserted to the new program. The channel can be characterized by a various characteristics such as its carrier frequency. The type of media stream (multicast or unicast) can be dynamically altered in response to load imposed on the edge device.</p>
<p id="p-0048" num="0047">According to an embodiment of the invention an advertisement inserting components such as headend <b>20</b>, intermediate unit <b>40</b> and optionally even an edge device <b>50</b> includes multiple transmitters and the allocation of program between transmitters can depend upon the popularity of transmitted programs, the expected viewing patterns and the like. Such a component can insert an advertisement into the program that is sent to one or more end user devices by applying well known advertisement insertion (splicing) techniques.</p>
<p id="p-0049" num="0048">Conveniently, an advertisement insertion can include: (i) Determining one or more programs that are sent to one or more end user devices. (ii) Determining one or more advertisement to insert into the one or more programs, and (iii) Sending one or more programs that include one or more advertisements to the one or more end user device. Conveniently, an end user device can receive an advertisement that is associated with one or more characteristics of the end user. Conveniently, the characteristics are provided from a source out of the cable distribution network, but this is not necessarily so. Conveniently, the characteristic reflects the program viewed by the client or viewing patterns of the client.</p>
<p id="p-0050" num="0049">It is further noted that the content of a certain multiplex can be responsive to current viewing statistics, to previous viewing patterns, to expected viewing patterns, and/or to predefined criteria. Such a criteria can be responsive to a transmission priority of a program.</p>
<p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. 2</figref> illustrates intermediate unit (IU) <b>40</b> and its environment <b>12</b> according to an embodiment of the invention.</p>
<p id="p-0052" num="0051">Intermediate unit (U) <b>40</b> can be connected to a video source <b>35</b> via a drop and continue Ethernet port <b>31</b> and via an Internet Protocol network <b>35</b> that is followed by a broadband gateway. Intermediate unit <b>40</b> can receive video content via one of the mentioned above paths or from both. It is noted that the Internet Protocol (IP) and the Ethernet port are provided only as examples of certain communication protocols and network and that other communication protocols and networks can be connected to intermediate unit <b>40</b> without departing from the scope of the invention.</p>
<p id="p-0053" num="0052">Intermediate unit <b>40</b> also communicated with middleware <b>37</b>, via IP network <b>35</b> and broadband network gateway. It can exchange with middleware <b>37</b> control signals and status signals and can receive, for example the multicast and unicast addresses to be used when providing media streams to the edge devices. Middleware <b>37</b> can also provide program related information such as an Interactive Program Guide.</p>
<p id="p-0054" num="0053">Intermediate unit <b>40</b> is also connected to an advertisement streaming server <b>34</b>. It can receive advertisements and insert them in predefined locations that are usually identified by splice insertion tones or signals.</p>
<p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. 3</figref> illustrates intermediate units <b>40</b> and <b>40</b>&#x2032; and their environment <b>11</b> according to an embodiment of the invention.</p>
<p id="p-0056" num="0055">A first intermediate unit <b>40</b> and a second intermediate unit <b>40</b>&#x2032; are connected to headends <b>20</b> and <b>20</b>&#x2032; via backbone infrastructure <b>84</b> that can include headend to intermediate unit network <b>30</b>. This connection can increase the redundancy of the environment (for example by sending the same content to both intermediate units) but this is not necessarily so.</p>
<p id="p-0057" num="0056">Backbone infrastructure <b>84</b> is illustrated as including four backbone routers <b>82</b> that are connected to each other. It is noted that backbone infrastructure <b>84</b> can have other prior art configurations.</p>
<p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. 4</figref> illustrates intermediate unit <b>40</b> according to an embodiment of the invention.</p>
<p id="p-0059" num="0058">Intermediate unit <b>40</b> may send data and video via edge devices towards end user devices and can receive upstream traffic from the end user devices (via edge device). Typically the downstream traffic (towards the end user devices) is transmitted via in-band or downstream communication paths while the traffic from the end-user devices is transmitted via out-of-band or upstream communication paths.</p>
<p id="p-0060" num="0059">Intermediate unit <b>40</b> includes an output interface, a controller and an input interface. The controller can include egress traffic shaper <b>44</b>, the controller can include resource manager <b>46</b>, flow manager and multicast program manager <b>42</b> and flow manager and unicast program manager <b>42</b>. Intermediate unit also includes one or more video processors such as video processing modules <b>43</b>(<b>1</b>)-<b>43</b>(K) and <b>44</b>(<b>1</b>)-<b>44</b>(K). Intermediate controller <b>40</b> is connected to headend to intermediate unit network <b>30</b> via WAN processing and upstream traffic shaper <b>41</b>.</p>
<p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a user device <b>60</b>, according to an embodiment of the invention.</p>
<p id="p-0062" num="0061">Device <b>60</b> can be a set top box or another computerized entity. It is connected to a display, such as television <b>69</b> and can receive instructions from a remote control, via interface <b>68</b>. Thus, instructions such as change program instructions, alter picture or sound related instructions, as well as signals exchanged during interactive sessions are received by interface <b>65</b> and sent to controller <b>63</b>. It is noted that instructions can be provided in various manners including, but not limited to, using user device buttons, using a keyboard, using a mouse and the like.</p>
<p id="p-0063" num="0062">The analysis of these signals can indicate if a user views the received programs. The analysis can be responsive to the length of viewed programs, and/or to viewing patterns of the viewers. The interface <b>65</b> can also receive signals sent to the television, thus provide additional indication about the viewing related activities of the user.</p>
<p id="p-0064" num="0063">User device <b>60</b> also includes a transceiver unit (denoted RX/TX unit) <b>61</b> that is adapted to receive and transmit signals, such as radio frequency signals, over edge unit to user device network which usually includes (when DSL technologies are applied) a twisted pair of wires per end user device (or per a group of end user devices residing in the same residence).</p>
<p id="p-0065" num="0064">The transceiver unit <b>61</b> is connected to parser <b>62</b> that can selectively provide data and control signals to controller <b>63</b> while sending programs to decoder <b>64</b>. Decoder <b>64</b> is connected to television <b>69</b>.</p>
<p id="p-0066" num="0065"><figref idref="DRAWINGS">FIG. 6</figref> illustrates various media streams <b>120</b>-<b>130</b>&#x2032; that are provided to end user devices according to an embodiment of the invention.</p>
<p id="p-0067" num="0066">At a starting point first end user device <b>60</b> receives a first unicast media stream conveying first program <b>120</b>. A third end user device <b>62</b> receives a first multicast media stream conveying first program <b>122</b>. That first multicast media stream is illustrated as including group of pictures GOPs <b>123</b> (that starts at point of time A) and GOP <b>125</b> (that starts at point of time D. GOP <b>123</b> starts by I frame <b>123</b>(I) and GOP <b>125</b> starts by I frame <b>125</b>(I).</p>
<p id="p-0068" num="0067">At point in time B the intermediate unit <b>40</b> receives a request (indicated by flag <b>130</b>), from second end-user device <b>61</b>, to view the first program. It is assumed that due to bandwidth constrains intermediate unit <b>40</b> can not provide three different unicast media streams (conveying the first programs) to these three end user devices and that the three end user devices shall receive the first multicast program <b>122</b>.</p>
<p id="p-0069" num="0068">There can be a time gap (illustrated by the difference between point in time C and D) between a switching point (such as a splicing point) that occurs at point in time C and the next I frame (I frame <b>125</b>(I) of GOP <b>125</b>) of the first multicast program <b>122</b>. Accordingly, during this time gap an intermediate media stream (not shown) is provided to the first end user device.</p>
<p id="p-0070" num="0069">During another time gap (illustrated by the difference between points in time B and D) the second end user device <b>62</b> can receive another intermediate media stream (not shown).</p>
<p id="p-0071" num="0070"><figref idref="DRAWINGS">FIG. 7</figref> illustrates delay unit <b>250</b> and a timing diagram <b>113</b> according to an embodiment of the invention.</p>
<p id="p-0072" num="0071">The delay unit can generate multiple time shifted versions of a multicast media stream that can be provided to end user devices as intermediate media streams, during time gaps. The bit rate of these delayed multicast media streams can be changed so that after a certain period their I frames will be synchronized to the I frame of the non-delayed multicast media stream, thus allowing to switching to the non-delayed multicast media stream.</p>
<p id="p-0073" num="0072">Delay unit <b>250</b> can reside in the intermediate unit.</p>
<p id="p-0074" num="0073"><figref idref="DRAWINGS">FIG. 7</figref> illustrates three delay periods D<b>1</b>-D<b>3</b> and three delayed GOPs <b>123</b>(<b>1</b>)-<b>123</b>(<b>3</b>) of non-delayed GOP <b>123</b>.</p>
<p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. 8</figref> illustrates various bandwidth thresholds <b>210</b>-<b>224</b>, according to an embodiment of the invention.</p>
<p id="p-0076" num="0075">Conveniently, conversions of media stream types and optionally compressing media streams is responsive to the bandwidth limitation of a communication link between the intermediate unit <b>40</b> and an edge unit. The load imposed on this communication link depends upon the requests to view programs by end user devices and upon the type of media stream used to convey the program.</p>
<p id="p-0077" num="0076">It is noted that although <figref idref="DRAWINGS">FIG. 8</figref> illustrates five bandwidth switching thresholds that fewer than five or more than five thresholds can be defined. It is also noted that in addition to or instead of one of the illustrated bandwidth switching thresholds, compression thresholds can be applied. It is also noted that at least one unicast to multicast switching bandwidth threshold can equal a multicast to unicast switching bandwidth threshold.</p>
<p id="p-0078" num="0077">The bandwidth switching thresholds define the behavior of intermediate unit <b>40</b> when the load increases (illustrated by arrow <b>201</b>) or when the load decreases (illustrated by arrow <b>202</b>).</p>
<p id="p-0079" num="0078">The lower threshold is first multicast to unicast switching bandwidth threshold <b>224</b>. It is followed by first unicast to multicast switching bandwidth threshold <b>210</b>, by second unicast to multicast switching bandwidth threshold <b>222</b>, by second unicast to multicast switching bandwidth threshold <b>212</b> and by upper bandwidth threshold <b>230</b>.</p>
<p id="p-0080" num="0079">It is noted that the upper bandwidth threshold <b>230</b> can be defined in response to a maximal amount of bandwidth that can be allocated for video transmission between the intermediate unit <b>40</b> and an edge unit connected to that intermediate unit <b>40</b>.</p>
<p id="p-0081" num="0080">If (i) the load is rising but is below first unicast to multicast switching threshold <b>210</b> or (ii) the load has decreased below first multicast to unicast switching bandwidth threshold <b>224</b> them intermediate unit <b>40</b> can send to end user devices unicast media streams. Thus, it can convert multicast media streams it receives to unicast media streams.</p>
<p id="p-0082" num="0081">If (i) the load continues to rise such as to exceed first unicast to multicast switching bandwidth threshold <b>210</b> but is still below second unicast to multicast switching bandwidth threshold <b>212</b>, or (ii) the load continues to fall below second multicast to unicast switching bandwidth threshold <b>222</b> but is still above first multicast to unicast switching bandwidth threshold <b>224</b> then some new requests to receive a programs will follow by a provision of multicast media streams.</p>
<p id="p-0083" num="0082">Conveniently the programs can be prioritized based on their ability to carry revenue-generating addressable advertising. If a channel is highly prioritized for addressable advertising, the intermediate unit should allow an exception to carrying the stream as a unicast.</p>
<p id="p-0084" num="0083">If (i) the load continues to rise such as to exceed second unicast to multicast switching bandwidth threshold <b>212</b> but is still below upper bandwidth threshold <b>230</b>, or (ii) the load is between upper bandwidth threshold <b>230</b> but is still above second multicast to unicast switching bandwidth threshold <b>222</b> then some new requests to receive a programs will follow by a provision of multicast media streams.</p>
<p id="p-0085" num="0084">If the load reaches the upper bandwidth threshold <b>230</b> new requests to receive programs can be denied.</p>
<p id="p-0086" num="0085">It is noted that compression can be applied in addition to these media stream type conversions.</p>
<p id="p-0087" num="0086">Conveniently, intermediate unit <b>40</b> can initiate a process of pruning media streams, starting at the lowest priority programs. Intermediate unit <b>40</b> can calculate, based on control signals indicating how many end user devices are tuned into which programs, how many unicast media streams should be converted to multicast media streams in order to lower the load and even enter another load range.</p>
<p id="p-0088" num="0087">It is noted that if many media streams should be converted than this can be executed in a gradual manner. Conveniently starting from the lower priority media streams.</p>
<p id="p-0089" num="0088"><figref idref="DRAWINGS">FIG. 9</figref> illustrates method <b>300</b> for providing programs to multiple end user devices, according to an embodiment of the invention.</p>
<p id="p-0090" num="0089">Method <b>300</b> conveniently starts by stage <b>305</b> of defining multiple bandwidth thresholds. Exemplary thresholds are illustrated in <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0091" num="0090">Stage <b>305</b> is followed by stage <b>310</b> of providing to multiple end user devices, via an edge device, two types of media streams that convey a first group of programs; wherein the two types include a unicast media stream and a multicast media stream.</p>
<p id="p-0092" num="0091">Stage <b>310</b> is followed by stage <b>330</b> of receiving a request from a first end user device to view a first program that belongs to the first group of programs.</p>
<p id="p-0093" num="0092">Stage <b>330</b> is followed by stage <b>350</b> of selectively switching, in response to bandwidth constraints imposed on a communication path coupled to the edge device, a type of a media stream that conveys the first program to a second end user device. Accordingly, the switching occurs only in a selective manner&#x2014;only when the bandwidth constraints require such switching.</p>
<p id="p-0094" num="0093">Conveniently, stage <b>350</b> includes selectively switching at substantially an advertisement insertion splicing point.</p>
<p id="p-0095" num="0094">Conveniently, stage <b>350</b> includes selectively switching at substantially an advertisement insertion splicing point.</p>
<p id="p-0096" num="0095">Conveniently, stage <b>350</b> includes selectively switching at substantially a reception of a request from the second end user device to change a program.</p>
<p id="p-0097" num="0096">Conveniently, stage <b>350</b> includes determining to perform a selective switching between a first unicast media stream that conveys the media stream and a first multicast media stream that conveys the first program.</p>
<p id="p-0098" num="0097">Conveniently, stage <b>350</b> includes sending to the second end-user device, during a time gap between a switching point and a provision of the first multicast media stream, a last independently decodable image of the first multicast media stream that was received prior to the determination.</p>
<p id="p-0099" num="0098">Referring to the pervious figures, intermediate unit <b>40</b> can store the last group of pictures of each program it sends towards an edge device. At point in time D the intermediate unit <b>40</b> stores I-frame (<b>123</b>(I)) of GOP <b>123</b> and it can provide it during the time gap between points in time C and D or the time gap between B and D.</p>
<p id="p-0100" num="0099">Conveniently stage <b>350</b> includes sending to the second end-user device, during a time gap between a switching point and a provision of the first multicast media stream, an intermediate media stream that comprises a last independently decodable frame of the first multicast media stream that was received prior to the determination and previously decodable frames that follow that last independently decodable frame. The independently decodable frame can be an I-frame.</p>
<p id="p-0101" num="0100">Referring to the previous figures, intermediate unit <b>40</b> can store the last group of pictures of each program it sends towards an edge device. At point in time D the intermediate unit <b>40</b> stores I-frame (<b>123</b>(I)) of GOP <b>123</b> as well as various P frames and B frames that belong to GOP <b>123</b>. These frames can be provided during the time gap between points in time C and D or the time gap between B and D.</p>
<p id="p-0102" num="0101">Conveniently stage <b>350</b> includes sending to the second end-user device, during a time gap between a switching point and a provision of the first multicast media stream, an intermediate media stream that is a time shifted version of the first multicast media stream.</p>
<p id="p-0103" num="0102">Conveniently, method <b>300</b> includes a stage of converting non-independently decodable frames of the first multicast media stream to independently decodable frames. This stage may be followed by sending to the second end-user device, during a time gap between a switching point and a provision of the first multicast media stream an intermediate media stream that comprises the independently decodable frames.</p>
<p id="p-0104" num="0103">Conveniently, stage <b>350</b> of selectively switching is responsive to a switching priority associated with programs conveyed by media streams.</p>
<p id="p-0105" num="0104">Conveniently stage <b>350</b> is responsive to a switching priority associated with programs conveyed by media streams.</p>
<p id="p-0106" num="0105">Conveniently, stage <b>350</b> is responsive to a relationship between required bandwidth to the multiple bandwidth thresholds. Conveniently, stage <b>320</b> includes defining at least one unicast to multicast switching bandwidth threshold and defining at least one multicast to unicast switching bandwidth threshold; wherein the at least one unicast to multicast switching bandwidth threshold differs from the at least one multicast to unicast switching bandwidth threshold. An exemplary definition is illustrated in <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0107" num="0106">Conveniently method <b>300</b> includes receiving at least one multicast media stream and re-generating the at least one multicast media stream. The re-generating can include altering the address or port associated with the media stream. This can, for example, include altering the address of a media stream that is converted from a unicast media stream to a multicast media stream, altering an address of a media stream that was rate-shaped and the like.</p>
<p id="p-0108" num="0107"><figref idref="DRAWINGS">FIG. 10</figref> illustrates method <b>400</b> for providing programs to multiple end user devices, according to an embodiment of the invention.</p>
<p id="p-0109" num="0108">Method <b>400</b> differs from method <b>300</b> by including stage <b>380</b> of compressing one or more media streams in order to comply with bandwidth constraints. This stage is usually executed when media stream type conversions are not adequate, but this is not necessarily so.</p>
<p id="p-0110" num="0109">Stage <b>315</b> can be executed even before unicast media streams are converted to multicast media streams in response to the priority of the programs conveyed over the various media streams. For example a high priority program can be conveyed over a unicast media stream while another media stream is compresses if the unicast media stream has a high priority. The priority can be driven from a need to provide certain advertisements to certain end users. It is noted that the priority can be associated with the end users that receive the unicast media streams.</p>
<p id="p-0111" num="0110">Variations, modifications, and other implementations of what is described herein will occur to those of ordinary skill in the art without departing from the spirit and the scope of the invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for providing programs to multiple end user devices, the method comprising:
<claim-text>defining a plurality of bandwidth thresholds, the plurality of bandwidth thresholds comprise two unicast media stream to multicast media stream conversion thresholds that differ from each other, and two multicast media stream to unicast media stream conversion thresholds that differ from each other;</claim-text>
<claim-text>providing to multiple end user devices, via an edge device, two types of media streams that convey a group of programs; wherein the two types comprises a unicast media stream and a multicast media stream;</claim-text>
<claim-text>receiving a request from a first end user device to view a first program that belongs to the group of programs; and selectively switching, in response to bandwidth constraints imposed on a communication path coupled to the edge device and in response to the plurality of bandwidth thresholds, a type of a media stream that conveys the first program to a second end user device;</claim-text>
</claim-text>
<claim-text>wherein the two unicast media stream to multicast media stream conversion thresholds differ from the two multicast media stream to unicast media stream conversion thresholds.</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising sending to the second end-user device, during a time gap between a switching point and a provision of the first multicast media stream an intermediate media stream that is a time shifted version of the first multicast media stream and is selected out multiple time shifted versions of the first multicast media stream that differ from each other by a delay between each of the multiple time shifted versions of the first multicast media stream and the first multicast media stream.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising transmitting the time shifted versions of the first multicast media stream at a changed bit rate so that after a certain period an independently decodable frame of each of the time shifted versions of the first multicast media streams is synchronized to an independently decodable frame of the first multicast media stream.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising sending to the second end-user device, during a time gap between a switching point and a provision of the first multicast media stream an intermediate media stream that is a time shifted version of the first multicast media stream; wherein the intermediate media stream is transmitted at a changed bit rate so that after a certain period an independently decodable frame of the intermediate media stream is synchronized to an independently decodable frame of the first multicast media stream.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising converting non-independently decodable frames of the first multicast media stream to independently decodable frames and sending to the second end-user device, during a time gap between a switching point and a provision of the first multicast media stream an intermediate media stream that comprises the independently decodable frames.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> comprising compressing at least one media stream in response to bandwidth constraints imposed on the communication path coupled to the edge device if a media stream type conversion is not adequate.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the selectively switching comprises process of pruning media streams, starting at a lowest priority programs and generating time gap filler streams.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> comprising calculating how many end user devices are tuned into which programs and determining how many unicast media streams to be converted to multicast media streams to change a load range, wherein load ranges are defined by the plurality of bandwidth thresholds.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising defining an upper bandwidth threshold that is higher than the two unicast media stream to multicast media stream conversion thresholds and the two multicast media stream to unicast media stream conversion thresholds; and denying new requests to receive a program when the upper bandwidth threshold is reached.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A device for providing multiple programs, the device comprises
<claim-text>an output interface adapted to:
<claim-text>(i) provide to an edge device two types of media streams that convey a group of programs wherein the media streams are provided via the edge device to multiple end users;</claim-text>
<claim-text>(ii) receive a request from a first end user device to view a first program that belongs to the group of programs; and</claim-text>
</claim-text>
<claim-text>a controller adapted to determine when to selectively switch, in response to bandwidth constraints imposed on a communication path coupled to the edge device and to a plurality of bandwidth thresholds, a type of a media stream that conveys the first program to a second end user device;</claim-text>
<claim-text>wherein the plurality of bandwidth thresholds comprise two unicast media stream to multicast media stream conversion thresholds that differ from each other, and two multicast media stream to unicast media stream conversion thresholds that differ from each other;</claim-text>
<claim-text>wherein the two unicast media stream to multicast media stream conversion thresholds differ from the two multicast media stream to unicast media stream conversion thresholds.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The device according to <claim-ref idref="CLM-00010">claim 10</claim-ref> further adapted to send to the second end-user device, during a time gap between a switching point and a provision of the first multicast media stream an intermediate media stream that is a time shifted version of the first multicast media stream and is selected out multiple time shifted versions of the first multicast media stream that differ from each other by a delay between each of the multiple time shifted versions of the first multicast media stream and the first multicast media stream.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The device according to <claim-ref idref="CLM-00011">claim 11</claim-ref> further adapted to transmit the time shifted versions of the first multicast media stream at a changed bit rate so that after a certain period an independently decodable frame of each of the time shifted versions of the first multicast media streams is synchronized to an independently decodable frame of the first multicast media stream.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The device according to <claim-ref idref="CLM-00010">claim 10</claim-ref> further adapted to receive upstream transmission from end user devices over an out of band channel.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The device according to <claim-ref idref="CLM-00010">claim 10</claim-ref> further adapted to assign priority to media streams comprising characteristic learnt from the end user viewing patterns.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The device according to <claim-ref idref="CLM-00010">claim 10</claim-ref> further adapted to prune media streams, starting at a lowest priority programs and generating time gap filler streams.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The device according to <claim-ref idref="CLM-00010">claim 10</claim-ref> further adapted to provide the user with interactive services.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The device according to <claim-ref idref="CLM-00016">claim 16</claim-ref> further adapted to select advertisements based on user participation in interactive services.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The device according to <claim-ref idref="CLM-00010">claim 10</claim-ref> further adapted to send to the second end-user device, during a time gap between a switching point and a provision of the first multicast media stream an intermediate media stream that is a time shifted version of the first multicast media stream; wherein the intermediate media stream is transmitted at changed bit rate so that after a certain period an independently decodable frame of the intermediate media stream is synchronized to an independently decodable frame of the first multicast media stream.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The device according to <claim-ref idref="CLM-00010">claim 10</claim-ref> further adapted to deny new requests to receive program when an upper bandwidth threshold is reached; wherein the upper bandwidth threshold is higher than the two unicast media stream to multicast media stream conversion thresholds and the two multicast media stream to unicast media stream conversion thresholds. </claim-text>
</claim>
</claims>
</us-patent-grant>
