<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625797-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625797</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12997693</doc-number>
<date>20090622</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>DE</country>
<doc-number>10 2008 029 636</doc-number>
<date>20080623</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>274</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>30</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>16</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>177</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>380260</main-classification>
<further-classification>380277</further-classification>
<further-classification>713  2</further-classification>
<further-classification>713173</further-classification>
<further-classification>713187</further-classification>
</classification-national>
<invention-title id="d2e71">Releasing a service on an electronic appliance</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5454000</doc-number>
<kind>A</kind>
<name>Dorfman</name>
<date>19950900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714 54</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5757919</doc-number>
<kind>A</kind>
<name>Herbert et al.</name>
<date>19980500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713187</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5940007</doc-number>
<kind>A</kind>
<name>Brinkmeyer et al.</name>
<date>19990800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>340 1229</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6560706</doc-number>
<kind>B1</kind>
<name>Carbajal et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713155</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>8201240</doc-number>
<kind>B2</kind>
<name>Tarkkala</name>
<date>20120600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 18</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>8244845</doc-number>
<kind>B2</kind>
<name>Rao</name>
<date>20120800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709223</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2004/0193873</doc-number>
<kind>A1</kind>
<name>England</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713156</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2005/0010757</doc-number>
<kind>A1</kind>
<name>Bosler</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713156</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2005/0097328</doc-number>
<kind>A1</kind>
<name>England</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713173</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2006/0111105</doc-number>
<kind>A1</kind>
<name>Bajar et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2007/0250632</doc-number>
<kind>A1</kind>
<name>Nomura et al.</name>
<date>20071000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709227</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2008/0170697</doc-number>
<kind>A1</kind>
<name>Heinonen et al.</name>
<date>20080700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380277</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2009/0070596</doc-number>
<kind>A1</kind>
<name>Mantin et al.</name>
<date>20090300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713189</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2009/0198997</doc-number>
<kind>A1</kind>
<name>Yeap et al.</name>
<date>20090800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713155</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>CN</country>
<doc-number>1905448</doc-number>
<kind>A</kind>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>WO</country>
<doc-number>9938070</doc-number>
<kind>A1</kind>
<date>19990700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>WO</country>
<doc-number>0142889</doc-number>
<kind>A2</kind>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>WO</country>
<doc-number>2007054942</doc-number>
<kind>A2</kind>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>WO</country>
<doc-number>2008049959</doc-number>
<kind>A2</kind>
<date>20080500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00020">
<othercit>Paul England, Ed.; Peter Lipp et al.: Practical Techniques for Operating System Attestation, Mar. 11, 2008, Trusted Computing&#x2014;Challenges and Applications (LNCS); Springer, Berlin, Heidelberg; pp. 1-13. ISBN: 978-3-540-68972-2; p. 9, paragraph 4.2, to p. 11, line 10.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00021">
<othercit>International Search Report in PCT/EP2009/004482, Apr. 12, 2011.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00022">
<othercit>Search Report of German PTO regarding German Patent Application 10 2008 029 636.8, Jan. 20, 2009.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>15</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>380260</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>3</number-of-drawing-sheets>
<number-of-figures>3</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110091039</doc-number>
<kind>A1</kind>
<date>20110421</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Spitz</last-name>
<first-name>Stephan</first-name>
<address>
<city>M&#xfc;nchen</city>
<country>DE</country>
</address>
</addressbook>
<residence>
<country>DE</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Scherzer</last-name>
<first-name>Helmut</first-name>
<address>
<city>T&#xfc;bingen</city>
<country>DE</country>
</address>
</addressbook>
<residence>
<country>DE</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Urhahn</last-name>
<first-name>Thorsten</first-name>
<address>
<city>Ulm</city>
<country>DE</country>
</address>
</addressbook>
<residence>
<country>DE</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Borgs</last-name>
<first-name>Hans</first-name>
<address>
<city>Feldkirchen-Westerham</city>
<country>DE</country>
</address>
</addressbook>
<residence>
<country>DE</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Spitz</last-name>
<first-name>Stephan</first-name>
<address>
<city>M&#xfc;nchen</city>
<country>DE</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Scherzer</last-name>
<first-name>Helmut</first-name>
<address>
<city>T&#xfc;bingen</city>
<country>DE</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Urhahn</last-name>
<first-name>Thorsten</first-name>
<address>
<city>Ulm</city>
<country>DE</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Borgs</last-name>
<first-name>Hans</first-name>
<address>
<city>Feldkirchen-Westerham</city>
<country>DE</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Bacon &#x26; Thomas, PLLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Giesecke &#x26; Devrient GmbH</orgname>
<role>03</role>
<address>
<city>Munich</city>
<country>DE</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Zand</last-name>
<first-name>Kambiz</first-name>
<department>2434</department>
</primary-examiner>
<assistant-examiner>
<last-name>Bayou</last-name>
<first-name>Yonas</first-name>
</assistant-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/EP2009/004482</doc-number>
<kind>00</kind>
<date>20090622</date>
</document-id>
<us-371c124-date>
<date>20101213</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO2009/156108</doc-number>
<kind>A </kind>
<date>20091230</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">There is proposed a method for enabling a service made available by an electronic device (<b>100</b>), wherein a registration request (<b>114</b>) is generated (S<b>3</b>) by the device (<b>100</b>) and sent (S<b>7</b>) to the registration server (<b>300</b>). The registration server (<b>300</b>) thereupon generates (S<b>8</b>) a registration confirmation (<b>305</b>) and sends (S<b>9</b>) it to the device (<b>100</b>), where the service is finally enabled by receiving and saving (S<b>10</b>) of the registration confirmation (<b>305</b>) on the device (<b>100</b>). In this connection, a trustworthy authority (<b>200</b>) sets up (S<b>6</b>, S<b>12</b>) a timeframe on the registration server (<b>300</b>) such that the registration server (<b>300</b>) sends (S<b>9</b>) a registration confirmation (<b>305</b>) only for a registration request (<b>114</b>) received within the timeframe, and the device (<b>100</b>) sends (S<b>7</b>) the registration request (<b>114</b>) to the registration server (<b>300</b>) within the timeframe.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="158.16mm" wi="128.35mm" file="US08625797-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="208.36mm" wi="156.80mm" file="US08625797-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="221.49mm" wi="137.92mm" orientation="landscape" file="US08625797-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="179.07mm" wi="144.19mm" file="US08625797-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present invention relates to a method for enabling a service made available by an electronic device, to such an electronic device and to a system comprising such an electronic device.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">For portable data carriers and mobile electronic devices there are diverse security mechanisms known which are intended to ensure the integrity of the device and of the data saved thereon, or the unique identification of the data carrier or of its owner.</p>
<p id="p-0004" num="0003">The technical basis for such mechanisms that protect integrity or make identification possible is often a specially secured storage area for saving e.g. identification data tamper-resistantly therein. There exist for example special insulating mechanisms by which hardware areas and/or accesses to software components of a terminal for security-critical data and processes can be set up and effectively sealed off from accordingly unsecured areas, e.g. by software solutions, such as secure virtual processors, or hardware solutions, such as dedicated security kernels. Within such a secured area, in particular security-critical processes can be executed, e.g. in by a secure runtime environment by means of a suitable interpreter.</p>
<p id="p-0005" num="0004">For reasons of security and practicality, data relating to an individualization or identification of portable data carriers are usually saved during the production process, or at least before the issue of the relevant data carrier to a user, in the data carrier, e.g. in a secured area of a chip card, smart card or the like. A corresponding individualization of arbitrary mobile terminals within the framework of a production process involves considerable costs, however, on account of the infrastructure necessary therefor and a lower throughput resulting therefrom.</p>
<p id="p-0006" num="0005">In principle, cryptographic methods are available for individualization of mobile terminals, for example based on a symmetric key pair present on the terminal to be individualized, the public key of said key pair being provided with an electronic certificate by a trustworthy certification authority. Through a certification, communication partners of the relevant device who are employing its public key for encryption or for checking a signature of the device can make sure that the public key actually comes from the relevant device and has not been planted for fraudulent purposes.</p>
<p id="p-0007" num="0006">In this connection, WO 2008/049959 A2 proposes a certification method according to the PKCS specification (&#x201c;Public Key Cryptography Standard&#x201d;) in a mobile radio communication environment with possibly limited transfer rate and network security. US 2005/0010757 discloses a certification method on a distributed network wherein a certification request from a network node to a certification server is for security reasons only possible within a predefined time interval from the initialization of the corresponding network node, which in connection with mobile terminals would again require a basically impracticable individualization at a time close to their usual initialization within the framework of production. The receipt of a certificate request from a network node within the permissible time interval is monitored on the basis of the network node initialization time available to the certification server and of the time interval duration.</p>
<heading id="h-0003" level="1">SUMMARY</heading>
<p id="p-0008" num="0007">It is the object of the present invention to provide a secure, practicable and cost-efficient way of individualizing electronic, mobile terminals.</p>
<p id="p-0009" num="0008">On an electronic device, a service that is made available but not yet enabled for utilization&#x2014;e.g. execution by a user of the device&#x2014;is enabled by a registration procedure vis-&#xe0;-vis a registration server. Such a service to be enabled can be in principle any arbitrary expansion of functions or resources of the electronic device, in particular the enabling of an individualized operation on a device that is at first not individualized, or of a secured, insulated area for making available further security functionalities of the terminal.</p>
<p id="p-0010" num="0009">In the following, &#x201c;registration&#x201d; will be understood to mean the data communication between the electronic device and the registration server, while as the result of registration the actual making available of the relevant service on the device for use by the user will be designated as &#x201c;enabling&#x201d;. Thus, within the framework of a registration procedure the electronic device generates a registration request and sends it to the registration server, which generates a registration confirmation in response to the received registration request, and sends it back to the device. Finally, the relevant service is enabled on the device by the received registration confirmation being saved on the device in an intended fashion.</p>
<p id="p-0011" num="0010">According to the invention, a trustworthy third authority sets up a timeframe for the above-outlined registration procedure such that solely a registration request received within said timeframe is processed by the registration server and can lead to a registration of the relevant service vis-&#xe0;-vis the registration server. The relevant service can thus only be enabled when the registration request is sent to the registration server within the set-up timeframe; a registration request arriving at the registration server outside said timeframe (or even before the set-up of the timeframe) is at least not answered with a registration confirmation by the registration server. In this connection, the timeframe can be set up by the trustworthy authority in principle with an arbitrary starting and ending time, e.g. also in periodically iterative fashion or the like.</p>
<p id="p-0012" num="0011">Thus, the registration and enabling of a service can be carried out with sufficient security by the device itself within an almost arbitrary timeframe. This is an advantage in particular for those services that could only be enabled within the framework of the production process with considerable resource consumption, e.g. within the framework of time-consuming initialization processes of certain services, or that require an individualization of the electronic device in an environment that is in principle more insecure than the production environment, which is secured to the greatest possible extent. Further, the registration and enabling can be set up in flexible fashion, e.g. in dependence on specifications or modes of behavior of the user of an electronic device or on the service to be enabled itself, e.g. by the timeframe being coordinated with an installation procedure or initialization procedure of the service on the device.</p>
<p id="p-0013" num="0012">An electronic device according to the invention therefore comprises at least sufficient resources for making available services, e.g. in the form of software applications, in particular a processor and one or several memories. Furthermore, an electronic device comprises a data communication interface which makes possible the data communication with the registration server to be carried out within the framework of the registration procedure, and a registration unit which controls the registration procedure and the final enabling of a service by saving a received registration confirmation. The registration unit is set up according to the invention such that the registration request is sent to the registration server within the timeframe set up on the registration server by the trustworthy authority, i.e. the registration unit possesses or receives the sufficient information about the timeframe and coordinates the registration procedure therewith.</p>
<p id="p-0014" num="0013">The registration unit can ensure a timely registration request to the registration server by e.g. a registration request being sent automatically within a timeframe already configured on the registration unit upon the production, set-up or initialization of the device, or by the registration request being sent in reaction to information determining the timeframe from the trustworthy authority or the registration server.</p>
<p id="p-0015" num="0014">A registration system according to the invention therefore comprises an electronic device, a registration server and a trustworthy authority which are in each case set up and cooperate such that a service made available by the electronic device can be enabled according to the above-described registration procedure.</p>
<p id="p-0016" num="0015">In this connection, the registration server is preferably a central server equipped with a special trustworthiness, which has been set up, and authorized to perform the registration of services, e.g. by a manufacturer of the electronic device or a similarly trustworthy authority.</p>
<p id="p-0017" num="0016">The trustworthy authority can be for example a communication apparatus of a middleman that sells electronic devices according to the invention or services to be installed and enabled on such devices, or a credit institution, a government agency or another such authority. The trustworthiness of said authority or of the corresponding communication apparatus is established by an authentication to the registration server, for example cryptographically or by means of a password. This causes the trustworthiness of the registration server to be extended to the authority, which is thus entitled to set up a timeframe on the registration server.</p>
<p id="p-0018" num="0017">The trustworthy authority can either inform the registration server of a future timeframe by corresponding time signals, or actively start the timeframe on the registration server by a start signal. In the latter case the registration server can close the timeframe upon receipt of a stop signal or upon expiry of a predefined time duration. In particular, the trustworthy authority can set up a timeframe with an arbitrary starting time after the production of the electronic device, e.g. after the issue of the electronic device to a user (e.g. by the trustworthy authority) or the installation of a service to be enabled on the electronic device.</p>
<p id="p-0019" num="0018">The registration request generated by the registration unit preferably comprises a unique identification of the particular service to be enabled, so that there is in particular the possibility that the registration server can log and bill for the enabling of said service and thus its time of use by a user. In particular insofar as the service to be enabled is not a dedicated software application or the like, but rather a basic function expansion of the electronic device, there can also be integrated into the registration request a unique identification of the electronic device, instead of a unique identification of the service to be enabled (or additionally thereto). The unique device information can be the serial number of the device. Said unique service information or device information can also be used by the registration server to recognize, and to block, a new enabling attempt by means of a new registration request on the basis of the service identification or device identification available to the registration server. It is of course also possible that an enabling is only effective for a predefined time period, and a new registration/enabling of the relevant service must be effected after expiry of said time period. This, too, can be recognized and managed on the basis of a service identification or device identification.</p>
<p id="p-0020" num="0019">Services to be made available by the device and representing basic function expansions of the electronic device can relate e.g. to the set-up of a secured, insulated area on the device, which is completely disconnected from a remaining unsecured area of the electronic device in terms of hardware and software, in order to save security-relevant data and execute security-relevant processes in said insulated area.</p>
<p id="p-0021" num="0020">On the other hand, such a basic function expansion of the electronic device can also, as mentioned above, consist in setting up an individualized operation of the device, by the device being equipped within the framework of the registration procedure with an individual identifier that is verifiable by third parties, through which the identity of the device can be detected unequivocally.</p>
<p id="p-0022" num="0021">For enabling such an individualized operation of the electronic device, the registration unit of the electronic device can for example direct a certificate request to a certification server, said request comprising at least a public key of an asymmetric key pair present on the device or generated by the device. With the certificate request, a request is thus made to the registration server, configured as a certification server, to certify the public key of the electronic device and thereby transfer the trustworthiness of the certification server to the public key.</p>
<p id="p-0023" num="0022">If the electronic device makes a certified public key available to a communication partner for cryptographically securing messages or for checking a cryptographic signature, the relevant communication partner can verify on the basis of the certificate whether the public key available to it or him actually corresponds with the private key present on the electronic device. Accordingly, upon receipt of the certificate request the certification server creates the certificate for the public key and sends the certificate back to the electronic device as a registration confirmation. Through the certificate the device can then prove its own trustworthiness and identity to arbitrary communication partners, thereby making possible an individualized operation of the device. The certificate comprises a signature which links the service identification or device identification with the generated public key, in a manner verifiable for third parties.</p>
<p id="p-0024" num="0023">The registration request thus normally comprises a service identification and/or a device identification. The registration confirmation is created for a service identification and/or a device identification which are either received with the registration request or ascertained for the registration request. The registration confirmation can contain a digital signature which is formed via the service identification and/or the device identification and optionally via further data, such as the generated public key.</p>
<p id="p-0025" num="0024">Preferably, at least the private key of the asymmetric key pair and a possibly received certificate of the public key are stored in a secured area of the device. Said secured area is preferably an insulated, sealed-off hardware and software area that is inaccessible from a possible unsecured area of the device. For the execution of security-critical processes, e.g. the generation of an asymmetric key pair, such an insulated area can have a secure runtime environment with a corresponding interpreter. In particular, the total described registration process can be executed within such a secure runtime environment, so that the registration unit can be an application executable as a process by the runtime environment, operating system application or another software component of the electronic device.</p>
<p id="p-0026" num="0025">Preferably, a registration unit which creates and sends a certificate request and receives and stores the certificate is realized as a boot loader or as part of a multistage boot loader of the electronic device. In the presence of a secured, insulated area with a secure runtime environment, a registration unit configured as a boot loader can be integrated in particular into a multistage booting procedure of the electronic device or of the secured area and of the secure runtime environment.</p>
<p id="p-0027" num="0026">Preferably, the individualized operation of the electronic device is carried out upon a first-time booting procedure after delivery of the device to a merchant or user. The enabling of a service within the framework of a (first-time) booting procedure can of course also be provided for arbitrary other services, in particular also for basic function expansions of the device, e.g. the enabling of a secured, insulated area on the electronic device.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0028" num="0027">Further features and advantages of the invention will result from the following description of embodiment examples according to the invention as well as further alternative embodiments in connection with the attached drawings, which show:</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 1</figref> a flowchart of a method according to the invention;</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 2</figref> a registration system according to the invention; and</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 3</figref> a special embodiment of a registration unit according to the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF VARIOUS EMBODIMENTS</heading>
<p id="p-0032" num="0031">The initialization or individualization of an electronic device <b>100</b>, e.g. of a mobile (telecommunication) terminal, an embedded system, a system-on-a-chip or a portable data carrier, such as a chip card, mobile communication card, secure multimedia card or the like, can be carried out via a cryptographic infrastructure by a public key of an asymmetric key pair present on the electronic device being certified by an authority set up and authorized to do so, for example a certification server <b>300</b>. Besides the electronic device <b>100</b> and the certification server <b>300</b>, the certification system illustrated in <figref idref="DRAWINGS">FIGS. 1 and 2</figref> comprises a trustworthy authority <b>200</b>, e.g. an accordingly set-up computer of a government agency or of another trustworthy authority or the like.</p>
<p id="p-0033" num="0032">The flow of the certification process carried out by the certification system is outlined in <figref idref="DRAWINGS">FIG. 1</figref>. First, the electronic device <b>100</b> generates in step S<b>1</b> an asymmetric key pair (GEN KEYPAIR), whereby the private key of the asymmetric key pair is saved in step S<b>2</b> in a preferably tamper-resistant, secured area <b>112</b> of the electronic device <b>100</b> (SAVE PRIVKEY). In this manner, the private key is firmly associated with the electronic device <b>100</b>, so that a message which a communication partner of the electronic device <b>100</b> encrypts with the corresponding public key can be decrypted solely by the electronic device <b>100</b>. Likewise, the electronic device <b>100</b> can, by encrypting a message with the private key, generate a cryptographic signature on the basis of which the origin of a sent message can be checked by the recipient by means of the public key of the device <b>100</b>. Both are only possible with sufficient security, however, when a communication partner of the electronic device can be sure that the present public key actually comes from the relevant electronic device (i.e. that the electronic device possesses the corresponding private key) and has not been planted within the framework of an attempted fraud. In other words, the electronic device must be individualized, i.e. set up for an individualized operation.</p>
<p id="p-0034" num="0033">The verification of a unique association of the public key with the device <b>100</b> can be ensured by the public key being provided by the certification server <b>300</b> with an electronic certificate <b>305</b>, i.e. being associated uniquely with the identity of the electronic device <b>100</b>. A communication partner of the device <b>100</b> to whom or which the public key is available can then check on the basis of the certificate <b>305</b> whether the public key actually comes from the electronic device <b>100</b>.</p>
<p id="p-0035" num="0034">For this purpose, the device <b>100</b> generates in step S<b>3</b> a certification request <b>114</b> which comprises at least the public key to be certified, preferably also a unique identification of the electronic device, e.g. its IMEI number (GEN REQUEST). However, the certification request <b>114</b> is accepted and answered with the desired certificate <b>305</b> by the registration server <b>300</b> solely within a predefined timeframe, so that the device <b>100</b> can only carry out the step S<b>7</b> of sending the certificate request <b>114</b> (SEND REQUEST) when the corresponding timeframe on the registration server <b>300</b> is open.</p>
<p id="p-0036" num="0035">The timeframe is set up on the certification server <b>300</b> by a trustworthy authority <b>200</b>. For this purpose, the authority <b>200</b> first authenticates itself in step S<b>4</b> to the certification server <b>300</b>, e.g. cryptographically or with a password (AUTH), to have its trustworthiness attested by the certification server <b>300</b> and thus acquire the authorization to set up the timeframe. The timeframe is then opened on the certification server <b>300</b> in step S<b>6</b> (START TIMEFRAME) by sending of a start signal <b>201</b> in step S<b>5</b> (START). After the certification server <b>300</b> receives, after the onset of the timeframe, a certification request <b>114</b> sent in step S<b>7</b>, the registration server <b>300</b> generates in step S<b>8</b> a certificate <b>305</b> for the received public key (GEN CERT) and sends the certificate <b>305</b> back to the electronic device <b>100</b> in step S<b>9</b> (SEND CERT).</p>
<p id="p-0037" num="0036">The device <b>100</b> preferably saves the received certificate <b>305</b> in the same secured area in step S<b>10</b> (SAVE CERT) where the private key was already saved in step S<b>2</b>, and can in the future present its public key to potential communication partners together with the certificate <b>305</b> and thereby prove its identity.</p>
<p id="p-0038" num="0037">In step S<b>11</b> the unique device identification, e.g. the IMEI number, which the certification server <b>300</b> has received in connection with the certificate request <b>114</b> is saved in order to recognize a new certification attempt of the same device <b>100</b> and to be able to block it as an attempted abuse (BLOCK IMEI), because each further certification request with a different public key can be rated as an attempted fraud. The end of the timeframe can be effected either, as illustrated in <figref idref="DRAWINGS">FIG. 1</figref>, by the trustworthy authority by an explicit end signal <b>202</b> in step S<b>12</b> (END), whereupon the timeframe is closed in step S<b>13</b> (END TIMEFRAME). Likewise, it is possible that the timeframe is automatically closed immediately after sending of the certificate <b>305</b> to the electronic device <b>100</b> in step S<b>8</b>, or that the trustworthy authority has already in step S<b>5</b> transmitted to the registration server <b>300</b> within the framework of the start signal <b>115</b> the duration of the timeframe, after the expiry of which the timeframe is automatically closed thereby.</p>
<p id="p-0039" num="0038">With regard to the coordination between the sending of the certificate request <b>114</b> in step S<b>6</b> and the opening/closing of the timeframe in the steps S<b>5</b> and S<b>12</b>, several variants are possible. On the one hand, the device <b>100</b> can already be equipped with corresponding time information (e.g. already saved during the production of the device <b>100</b>) about the timeframe to be opened on the registration server <b>300</b>, and therefore needs no explicit notification about the start of the timeframe in step S<b>5</b>. On the other hand, it is also possible that the electronic device <b>100</b> is informed about the start of the timeframe and optionally about its duration or end either by the trustworthy authority <b>200</b> (in a step S<b>5</b><i>a</i>) or by the registration server <b>300</b> (in a step S<b>6</b><i>a</i>).</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 2</figref> more precisely describes the architecture of an electronic device <b>100</b>. The electronic device <b>100</b> can be for example an arbitrary mobile terminal, e.g. a mobile radio terminal, a portable data carrier, such as a chip card, mobile communication card or the like, an embedded system or a system-on-a-chip. Such an electronic device <b>100</b> comprises in principle all necessary resources and components for the execution of applications and services, in particular a processor CPU <b>104</b> as well as a memory device consisting of a RAM working memory <b>101</b>, a rewritable flash or EEPROM memory <b>102</b> and a ROM memory <b>103</b> with an operating system <b>115</b> (OS). Further, the device <b>100</b> comprises a data communication interface <b>105</b> for data communication with at least the certification server <b>300</b>.</p>
<p id="p-0041" num="0040">Preferably, the electronic device <b>100</b> also comprises a secured, insulated area <b>112</b> (TRUSTZONE) which forms an area of the hardware and software configuration of the electronic device <b>100</b> that is completely sealed off by insulating mechanisms, in particular a secure RAM memory <b>107</b> (SEC RAM), in order to save security-critical data and be able to execute security-critical processes therein. In particular, there runs in the secured area <b>112</b> a secure runtime environment <b>113</b> (RTE) which executes security-critical processes in the secure RAM <b>107</b>. By a registration unit <b>108</b> preferably set up in the secured area <b>112</b> there is obtained an initialization and individualization of the electronic device <b>100</b> or of the secured, insulated area <b>112</b>. The insulation of the secured area <b>112</b> from the other resources of the electronic device <b>100</b> can be obtained via known technologies, e.g. by virtualization in an embedded system or by an independent, secure processor on the same chip as the actual application processor <b>104</b>.</p>
<p id="p-0042" num="0041">In the embodiment outlined in <figref idref="DRAWINGS">FIG. 2</figref>, the registration unit <b>108</b> of the electronic device <b>100</b> is realized as a specialized boot loader <b>108</b> (bootstrap loader), which can constitute e.g. an expansion of conventional boot loaders that are used for starting (&#x201c;booting&#x201d;) an operating system from a &#x201c;bootable&#x201d; memory medium or for starting (&#x201c;booting&#x201d;) an embedded system or an arbitrary other mobile terminal.</p>
<p id="p-0043" num="0042">In this embodiment, the total certification procedure is carried out by the boot loader <b>108</b> within the framework of the booting procedure of the device <b>100</b>, so that the certification or individualization can be effected at a very early but nevertheless arbitrary time after production of the device <b>100</b> or issue to a user. Preferably, the individualization of the device <b>100</b> is carried out within the framework of the first boot of the device <b>100</b>. The registration unit can of course also be configured as an independent registration module stored in a secure area of the flash memory <b>102</b>, or as an operating system module <b>115</b> located in the ROM memory <b>103</b> and becoming active at an arbitrary time after the boot of the device <b>100</b>.</p>
<p id="p-0044" num="0043">The boot loader <b>108</b> generates and saves the private key <b>109</b> of the cryptographic key pair in the secured area of the flash memory <b>102</b>. Likewise, there is saved therein the certificate <b>305</b> received from the registration server <b>300</b>. The boot loader <b>108</b> sends the certification request <b>114</b> via the data communication interface <b>105</b> to the registration server <b>300</b> which comprises at least a data communication interface <b>301</b>, a processor <b>302</b>, a memory <b>303</b> and a certification unit <b>304</b> executable by the processor <b>302</b>. The certification unit <b>304</b> accepts the certification request <b>114</b>, generates the certificate <b>305</b> and sends it back to the electronic device <b>100</b> or its boot loader <b>108</b>.</p>
<p id="p-0045" num="0044">Likewise via the data communication interface <b>301</b>, the registration server <b>300</b> can communicate with the trustworthy authority <b>200</b>, for example within the framework of an authentication of the trustworthy authority <b>200</b> to the registration server <b>300</b> and the subsequent set-up of the timeframe on the certification server <b>300</b> by start and end signals <b>201</b>, <b>202</b>. The trustworthy authority <b>200</b> can represent in principle any arbitrary intermediate authority between the manufacturer of the device <b>100</b> and the user of the device <b>100</b>, for example a merchant, a credit institution, a government agency or the like.</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 3</figref> illustrates a booting procedure which is carried out by the boot loader <b>108</b> within the secure RAM memory <b>107</b>. The booting procedure outlined in <figref idref="DRAWINGS">FIG. 3</figref> is multistage and is carried out by several different boot loaders which preferably in each case boot up different system components, for example the electronic device <b>100</b> or its hardware and operating system, the secured area <b>112</b> and the secure runtime environment <b>113</b>. Within the framework of the boot of the secured area <b>112</b> or of the secure runtime environment <b>113</b>, the individualization of the electronic device <b>100</b> is carried out by a certification to the certification server <b>300</b>. The usual multistage booting procedure carried out in connection with a secure runtime environment <b>113</b> is thus expanded by a cryptographic initialization or individualization which is carried out by the boot loader <b>108</b> optionally upon the first boot of the electronic device <b>100</b>. Subsequently the operating system <b>115</b> is loaded into the unsecured part of the RAM memory <b>101</b> in conventional fashion.</p>
<p id="p-0047" num="0046">Besides the individualization of the device <b>100</b> as described in connection with <figref idref="DRAWINGS">FIGS. 1 to 3</figref>, it is in principle possible for arbitrary services to be registered on the device <b>100</b> by means of a corresponding registration procedure to a registration server <b>300</b> and to be enabled on the device. Such a service to be enabled by means of a registration can be in particular also the use and set-up of the secured, insulated area <b>112</b> or of the secure runtime environment <b>113</b>, or also any other software application or hardware resource available to the user. Thus it is also possible for example that a registration request <b>114</b> relates to the enabling of several services and the registration request accordingly contains several service identifications, which can in turn be answered by the registration server <b>300</b> individually or jointly. Accordingly, a new registration of these services is then blocked by the registration server <b>300</b>.</p>
<p id="p-0048" num="0047">The timeframe can be set up on the registration server <b>300</b> by the trustworthy authority <b>200</b> in an almost arbitrary way, and is not limited to a booting procedure of the device <b>100</b> as described in <figref idref="DRAWINGS">FIGS. 2 and 3</figref>. A timeframe independent of the booting procedure of the device <b>100</b> is expedient in particular when the service to be enabled does not involve a basic function expansion, like the cryptographic individualization, but rather the enabling of one or several arbitrary applications which are to be registered to the registration server <b>300</b> before an execution on the processor <b>104</b> of the device <b>100</b> e.g. for billing purposes. In this connection, by accordingly setting up the timeframe there can be provided a registration at an arbitrary time (e.g. also by arrangement with the user) in order to grant the user of the electronic device maximum operating freedom with regard to the utilized services, on the one hand, and to meet the security requirements by setting up a time restriction by means of a timeframe, on the other hand.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for enabling a service made available by an electronic device, comprising the steps of:
<claim-text>generating a registration request by the device and sending the registration request to a registration server;</claim-text>
<claim-text>generating a registration confirmation by the registration server and sending the registration confirmation to the device; and</claim-text>
<claim-text>receiving the registration confirmation by the device and enabling the service by saving the registration confirmation;</claim-text>
<claim-text>setting up a timeframe on the registration server using a trustworthy authority such that the registration server generates and sends a registration confirmation only for a registration request received within the timeframe, and the device sends the registration request to the registration server within the timeframe.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the trustworthy authority authenticates itself to the registration server and subsequently sets up the timeframe on the registration server.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the trustworthy authority sends to the registration server, for setting up the timeframe, time signals which determine a starting time and an ending time of the timeframe.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, including using the trustworthy authority to set up the timeframe at an arbitrary starting time after issuance of the device to a user.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, including generating via the device a registration request which comprises a unique identification of the service to be enabled, and logging the enablement of the service via the registration server on the basis of the unique identification.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, including enabling a secured area on the device or an individualized operation of the device as a service to be made available by the device.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein, for enabling the individualized operation, generating as the registration request a certificate request which comprises at least a public key of an asymmetric key pair present on the device or generated by the device, and generating as the registration confirmation a certificate for the public key.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, including generating via the device a certificate request which comprises a unique device identification, and via the registration server recognizing and blocking a new certificate request of the device on the basis of the unique device identification.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein on the device there is set up a secured area with a secure runtime environment, and in the secured area saving at least a private key of the asymmetric key pair and the certificate.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the enabling of the individualized operation of the device is carried out by a boot loader of the device, which is executed within the framework of a multistage booting procedure of the device.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the timeframe is set up such that the enabling of the individualized operation of the device is effected during a first-time booting procedure of the device.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. An electronic device comprising a processor and a memory for making available a service, a communication interface for data communication with a registration server, and a registration unit which is set up to effect an enabling of the service by generation of a registration request, sending of the registration request to the registration server and saving of a registration confirmation received from the registration server, wherein the registration unit is arranged to send the registration request to the registration server within a timeframe set up on the registration server by a trustworthy authority.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The device according to <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the registration unit is arranged to effect an enabling of an individualized operation of the device by generation of a certificate request comprising at least a public key of an asymmetric key pair present on the device, and saving of a certificate received from the registration server.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The device according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the device is a mobile terminal, an embedded system or a system-on-a-chip in which a secured area with a secure runtime environment is set up, and the registration unit is configured as a boot loader which is set up to effect the enabling of an individualized operation of the device within the framework of a first-time booting procedure of the device and/or of the secured area, said private key of the asymmetric key pair and the certificate of the public key being saved in the secured area.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A system comprising an electronic device according to <claim-ref idref="CLM-00012">claim 12</claim-ref>, a registration server and a trustworthy authority, wherein said device, server and authority are configured to cooperate so that a service made available by the electronic device is enabled according to the method of <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text>
</claim>
</claims>
</us-patent-grant>
