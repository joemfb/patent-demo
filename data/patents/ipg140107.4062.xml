<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625131-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625131</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12621893</doc-number>
<date>20091119</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2008-302846</doc-number>
<date>20081127</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>707</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>3</main-group>
<subgroup>12</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>1</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>358  115</main-classification>
<further-classification>358  19</further-classification>
<further-classification>358  113</further-classification>
</classification-national>
<invention-title id="d2e71">Communication between server and image forming apparatus</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6278532</doc-number>
<kind>B1</kind>
<name>Heimendinger et al.</name>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358442</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2002/0085705</doc-number>
<kind>A1</kind>
<name>Shires</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>37926504</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2003/0033543</doc-number>
<kind>A1</kind>
<name>Hubbard et al.</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2004/0085366</doc-number>
<kind>A1</kind>
<name>Foster et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345854</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2004/0148327</doc-number>
<kind>A1</kind>
<name>Satomi et al.</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2004/0148389</doc-number>
<kind>A1</kind>
<name>Satomi et al.</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2004/0187036</doc-number>
<kind>A1</kind>
<name>Nakamura</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713202</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2005/0015601</doc-number>
<kind>A1</kind>
<name>Tabi</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713182</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2005/0188226</doc-number>
<kind>A1</kind>
<name>Kasatani</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2006/0114501</doc-number>
<kind>A1</kind>
<name>Nakamura</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  115</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2006/0193001</doc-number>
<kind>A1</kind>
<name>Ii</name>
<date>20060800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  115</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2007/0011303</doc-number>
<kind>A1</kind>
<name>Hatakeyama et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2007/0121151</doc-number>
<kind>A1</kind>
<name>Uchida</name>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  115</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2007/0226776</doc-number>
<kind>A1</kind>
<name>Tsugawa</name>
<date>20070900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  1</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2008/0034403</doc-number>
<kind>A1</kind>
<name>Kakigi</name>
<date>20080200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  1</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2008/0120340</doc-number>
<kind>A1</kind>
<name>Hashimoto</name>
<date>20080500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>JP</country>
<doc-number>2003076662</doc-number>
<kind>A</kind>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>JP</country>
<doc-number>2004-227360</doc-number>
<kind>A</kind>
<date>20040800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>JP</country>
<doc-number>2006-197230</doc-number>
<kind>A</kind>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>JP</country>
<doc-number>2007048266</doc-number>
<kind>A</kind>
<date>20070200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>JP</country>
<doc-number>2008-40659</doc-number>
<kind>A</kind>
<date>20080200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>JP</country>
<doc-number>2008-129955</doc-number>
<kind>A</kind>
<date>20080600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00023">
<document-id>
<country>JP</country>
<doc-number>2008-219911</doc-number>
<kind>A</kind>
<date>20080900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00024">
<othercit>Japanese Office Action dated Jan. 29, 2013 in corresponding Japanese Application No. 2008-302846.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>2</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>19</number-of-drawing-sheets>
<number-of-figures>21</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20100128298</doc-number>
<kind>A1</kind>
<date>20100527</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Matsugashita</last-name>
<first-name>Hayato</first-name>
<address>
<city>Kawasaki</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Matsugashita</last-name>
<first-name>Hayato</first-name>
<address>
<city>Kawasaki</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Fitzpatrick, Cella, Harper &#x26; Scinto</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Canon Kabushiki Kaisha</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Hon</last-name>
<first-name>Ming</first-name>
<department>2675</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A problem that it is difficult to associate a log of processing executed in a web browser of an image forming apparatus with a log of processing executed in a web application server, and thus it is difficult to track the logs as a series of processing logs. The image processing apparatus receives an execution request of a function of the image forming apparatus and obtains identification information for a log of processing executed in the server apparatus in response to the received execution request of the function. The image forming apparatus stores a log of processing in the image forming apparatus related to the processing in the server apparatus corresponding to the obtained identification information, in association with the obtained identification information.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="169.16mm" wi="205.57mm" file="US08625131-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="211.75mm" wi="175.34mm" orientation="landscape" file="US08625131-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="166.62mm" wi="161.12mm" file="US08625131-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="134.62mm" wi="108.46mm" file="US08625131-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="182.46mm" wi="188.81mm" file="US08625131-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="211.41mm" wi="107.27mm" file="US08625131-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="172.97mm" wi="174.58mm" file="US08625131-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="83.40mm" wi="96.35mm" file="US08625131-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="100.92mm" wi="114.81mm" file="US08625131-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="138.18mm" wi="113.20mm" file="US08625131-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="228.01mm" wi="133.01mm" file="US08625131-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="119.97mm" wi="135.38mm" file="US08625131-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="214.97mm" wi="102.53mm" file="US08625131-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="172.97mm" wi="174.58mm" file="US08625131-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="263.65mm" wi="187.62mm" orientation="landscape" file="US08625131-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="267.97mm" wi="162.31mm" orientation="landscape" file="US08625131-20140107-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="166.29mm" wi="170.60mm" file="US08625131-20140107-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="250.61mm" wi="160.70mm" file="US08625131-20140107-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="260.86mm" wi="177.72mm" orientation="landscape" file="US08625131-20140107-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00019" num="00019">
<img id="EMI-D00019" he="257.30mm" wi="167.47mm" orientation="landscape" file="US08625131-20140107-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates to image forming apparatuses, log recording methods, and programs, and, in more detail, relates to an image forming apparatus, a log recording method, and a program for associating log information of the image forming apparatus with log information of a web server operating in conjunction with the image forming apparatus to provide a series of audit trails.</p>
<p id="p-0004" num="0003">2. Description of the Related Art</p>
<p id="p-0005" num="0004">An audit trail is a record preserved along a temporal sequence for a system auditor to track operation of an information system and contents and process during the operation. The audit trail is used for verifying that reliability, safety, efficiency, effectiveness, etc. are secured in the information system. Generally, a log recorded by the information system is an important audit trail. Japanese Patent Laid-Open No. 2003-076662 discloses a method tracking an information leaker by searching for a log as this audit trail.</p>
<p id="p-0006" num="0005">However, when a user carries out an operation across a plurality of devices connected with each other via a network, the logs exist across the plurality of devices and it is difficult to associate the logs of the same user (or same access source and the like) with each other. For solving this problem, Japanese Patent Laid-Open No. 2007-048266 discloses a method identifying an access source according to recorded date and time and access person information (i.e., user account information) in the log output from each device and pursuing the operation by sequentially tracking the logs.</p>
<p id="p-0007" num="0006">Meanwhile, there is known an image forming apparatus containing functions of respective devices such as a printer, a copier, a facsimile, and a scanner in one housing. Such a composite type image forming apparatus has applications corresponding to respective devices and operates as the printer, the copier, the scanner or the facsimile by switching the applications. When the various kinds of functions such as the printer, the copier, and the facsimile, are utilized, this image forming apparatus generates and executes a job corresponding to each of the functions. Then, after the job has been completed, the result is recorded as a job log. By analyzing this job log (i.e., audit trail), it is possible to track a use situation and a user of the image forming apparatus.</p>
<p id="p-0008" num="0007">Further, there is known a technique causing the image forming apparatus to combine a web browser for a web client function, to obtain (download) various contents from a remote control web application server and browse them, and to improve the functions of the image forming apparatus. In such a configuration, the web browser of the image forming apparatus executes various functions such as the printer and the scanner provided to the image forming apparatus according to the information contents obtained from the web application server.</p>
<p id="p-0009" num="0008">For associating the logs recorded across the plurality of devices with each other according to the method of above described Japanese Patent Laid-Open No. 2007-048266, the logs recorded in each of the devices need to have common information (same information). For example, the same date and time information, or the same user account information or user ID information needs to exist within the logs of the plurality of devices.</p>
<p id="p-0010" num="0009">In an actual case, however, the same user sometimes log-ins to a certain device using a user account of A and log-ins to another device using a user account of B. Accordingly, there can be a case where common information does not exist in both devices. In such a case, there is a problem that the log information cannot be associated with one another among the plurality of devices. For this point, it facilitates understanding to consider a specific environment as follows, and thus a specific environment will be described. Note that this environment is only an example and the present invention is not limited to a usage in such an example of the environment.</p>
<p id="p-0011" num="0010">First, a web browser of the image forming apparatus directly instructs an application of the image forming apparatus according to information obtained from a web application server, in a method as follows.</p>
<p id="p-0012" num="0011">When the web browser of the image forming apparatus accesses the web application server, a log of the access and a log of a website operation are recorded in the web application server. Recording time and user information recorded in the logs of the web application server are information managed within the web application server.</p>
<p id="p-0013" num="0012">On the other hand, when the web browser of the image forming apparatus directly instructs the application of the image forming apparatus and executes the function of the image forming apparatus, a job log of these operations is recorded in the image forming apparatus. Recording time and user information recorded in the job log are information managed in the image forming apparatus.</p>
<p id="p-0014" num="0013">As a result, when the user information managed by the image forming apparatus and the user information managed by the web application server are different from each other, it is very difficult to associate the logs recorded in the respective apparatuses with each other.</p>
<p id="p-0015" num="0014">Further, time is not always adjusted accurately between the image forming apparatus and the web application server (time itself is different particularly when recoding is done in a local time of a region), probably the logs cannot be associated with each other using the recording date and time.</p>
<p id="p-0016" num="0015">Further, since web application of the image forming apparatus implemented in the web application server is operated by web browsers of a plurality of image forming apparatuses at the same time, one access source cannot be specified only by the log recording date and time.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0017" num="0016">An image forming apparatus according to the present invention is an image forming apparatus communicably connected to a server apparatus via a network, the image forming apparatus comprising: a unit receiving an execution request of a function included in the image forming apparatus; a unit obtaining log identification information of processing executed in the server apparatus in response to the received execution request of the function, from the server apparatus; and a unit storing a log of processing executed in the image forming apparatus in response to the received execution request of the function in association with the received identification information.</p>
<p id="p-0018" num="0017">The present invention can provide an image forming apparatus, a log recording method, and a program for recording the audit trail which has information common to both of the web application server and the image forming apparatus.</p>
<p id="p-0019" num="0018">Further features of the present invention will become apparent from the following description of exemplary embodiments (with reference to the attached drawings).</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1</figref> is an example of a block diagram showing a system configuration;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 2</figref> is an example of an appearance diagram of an image forming apparatus;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 3</figref> is an appearance diagram of an operation part of an image forming apparatus;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 4</figref> is an example of a software configuration diagram of a control unit in an image forming apparatus;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 5</figref> is an example of a sequence diagram showing a processing flow of a request and a response by an HTTP protocol;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 6</figref> is a diagram showing an example of a screen configuration of a web browser in an image forming apparatus;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 7</figref> is a diagram showing an example of a data structure for authentication information;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 8</figref> is a diagram showing an example of a data structure for user account information;</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 9</figref> is a diagram showing an example of a data structure for log information;</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 10</figref> is a diagram showing an example of a log-in flow for an image forming apparatus in a first flow;</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 11</figref> is a diagram showing an example of a log-in screen in an image forming apparatus;</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 12</figref> is a diagram showing an example of a log-in flow for a web application server in a first flow;</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 13</figref> is a diagram showing an example of a function screen for web application;</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 14</figref> is a diagram showing the relationship between <figref idref="DRAWINGS">FIGS. 14A and 14B</figref>;</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 14A</figref> is a diagram showing an example of a processing flow for web application in a first flow;</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 14B</figref> is a diagram showing an example of a processing flow for web application in a first flow;</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 15</figref> is a diagram showing an example of a function screen displayed by a web browser;</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 16</figref> is a diagram showing an example of a log-in flow for a web application server in a second flow;</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 17</figref> is a diagram showing the relationship between <figref idref="DRAWINGS">FIGS. 17A and 17B</figref>;</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 17A</figref> is a diagram showing an example of a processing flow for web application in a second flow; and</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 17B</figref> is a diagram showing an example of a processing flow for web application in a second flow.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF THE EMBODIMENTS</heading>
<p id="p-0041" num="0040">Hereinafter, the best mode for implementing the present invention will be described with reference to the drawings. Note that parts having the same function are denoted by the same symbol in each diagram and duplicated description will be omitted.</p>
<p id="h-0005" num="0000">(First Embodiment)</p>
<p id="h-0006" num="0000">[System Configuration]</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram showing an entire configuration of a system including an image forming apparatus according to a first embodiment of the present invention.</p>
<p id="p-0043" num="0042">A web application server <b>120</b> is a computer such as a personal computer and a workstation. The web application server <b>120</b> includes a CPU, a direct storage unit, indirect storage unit, and an external interface which are not shown in the drawing, as main constituents. The indirect storage unit stores an operating system (OS) and various kinds of application programs which are software programs and these programs are read into the direct storage unit to be executed by the CPU.</p>
<p id="p-0044" num="0043">The following application programs are stored in the web application server <b>120</b> in the present embodiment and configured to be executable by the CPU.</p>
<p id="p-0045" num="0044">1) A web server part <b>121</b> transmitting content such as HTML data in response to a request of an HTTP protocol from a client</p>
<p id="p-0046" num="0045">2) An application server part <b>122</b> which is an application program loaded in a form such as a CGI (Common Gateway Interface) program and Servlet for carrying out predetermined processing according to an HTTP request and a dynamically varying HTTP response</p>
<p id="p-0047" num="0046">3) A data management part <b>123</b> performing preservation of script data called out from the application server part <b>122</b>, storage of the received data, storage of various access logs and an operation log, and perpetuation of various kinds of data</p>
<p id="p-0048" num="0047">An authentication server <b>130</b> is a computer similar to the web application server <b>120</b>. The authentication sever <b>130</b> stores a user authentication program <b>131</b> which is an application program for user authentication, and the authentication program <b>131</b> is configured to be executable by a CPU. The user authentication program <b>131</b> causes the CPU to execute the following processing.</p>
<p id="p-0049" num="0048">The user authentication program <b>131</b> is notified by the image forming apparatus <b>110</b> or the web application server <b>120</b> of user account information such as a user name, a domain name, and a password. The user authentication program <b>131</b> carries out user authentication by comparing the notified user account information and user account information under management. If the user authentication has succeeded, the user authentication program <b>131</b> returns Security Token (hereinafter, ST) to the image forming apparatus <b>110</b> or the web application server <b>120</b>. The user account is user credit information necessary for the user authentication, and indicates a user name, a domain name, a password, etc, for example. ST is an authentication token which is returned when the user account is confirmed to be authenticated and the user authentication has succeeded.</p>
<p id="p-0050" num="0049">The image forming apparatus <b>110</b> is a multi function peripheral (MFP) performing image input and output, image transmission and reception, and various kinds of image processing. The image forming apparatus <b>110</b> includes a scanner <b>113</b> which is an image input device, a printer <b>112</b> which is an image output device, a control unit <b>111</b>, an operation part <b>114</b> which is a user interface, and a communication unit <b>115</b> for performing external communication. Each of the scanner <b>113</b>, printer <b>112</b>, and operation part <b>114</b> is connected to the control unit <b>111</b> and controlled by an instruction from the control unit <b>111</b>. The control unit <b>111</b> is connected to a LAN via the communication unit <b>115</b>.</p>
<p id="p-0051" num="0050">The control unit <b>111</b> is configured with a CPU <b>116</b>, a direct storage part <b>117</b> (e.g., RAM), and an indirect storage part <b>118</b> (e.g., ROM or HDD). The direct storage part <b>117</b> is a storage part for directly exchanging data with the CPU <b>116</b>, and the indirect storage part <b>118</b> is a storage part for exchanging data with the CPU <b>116</b> via the direct storage part <b>117</b>. The indirect storage part <b>118</b> stores software such as an operating system (OS) and various kinds of application programs, which are read into the direct storage part to be executed by the CPU <b>116</b>. By the above processing, the control unit <b>111</b> executes various kinds of application programs which are to be described hereinafter and can carry out various kinds of processing. In the present specification, &#x201c;execution&#x201d; and &#x201c;processing&#x201d; of each application program means that the above control unit <b>111</b> &#x201c;executes&#x201d; and &#x201c;processes&#x201d; the application program, respectively.</p>
<p id="p-0052" num="0051">The web application server <b>120</b>, the authentication server <b>130</b>, and the image forming apparatus <b>110</b> are connected to a LAN <b>100</b> (Local Area Network) so as to be communicable thereamong.</p>
<p id="h-0007" num="0000">[Appearance Configuration of the Image Forming Apparatus <b>110</b>]</p>
<p id="p-0053" num="0052">An appearance configuration of the image forming apparatus <b>110</b> will be described with reference to <figref idref="DRAWINGS">FIG. 2</figref>. <figref idref="DRAWINGS">FIG. 2</figref> is a diagram showing the appearance configuration of the image forming apparatus <b>110</b> shown in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0054" num="0053">In the image forming apparatus <b>110</b>, the scanner <b>113</b> illuminates an image on a document paper and generates raster image data by scanning the image with a CCD line sensor (not shown in the drawing). When a user sets the document paper on a tray <b>202</b> of a document feeder <b>203</b> and provides an instruction of reading start on the operation part <b>114</b>, the control unit <b>111</b> generates a scan job and provides an execution instruction to the scanner <b>113</b>. Then, the document feeder <b>203</b> feeds the document papers one by one and the scanner <b>113</b> carries out the reading operation of the document image fed by the document feeder <b>203</b>. The control unit <b>111</b> completes the generated scan job after finishing of the reading and generates a job log as the completion result.</p>
<p id="p-0055" num="0054">The printer <b>112</b> prints the raster image data on a paper, and an electrophotographic method using a photosensitive drum or a photosensitive belt is used for the print method. Note that obviously other methods such as an ink jet method printing an image directly on a paper by ejecting ink from a miniature nozzle array may be used for the print method. For the print operation of the printer <b>112</b>, the control unit <b>111</b> generates a print job and provides an execution instruction to the printer <b>112</b>. The printer <b>112</b> has a plurality of paper feeding stages so that different paper sizes or different paper directions may be selected, and is provided with paper cassettes <b>205</b>, <b>206</b>, and <b>207</b> corresponding thereto. A paper discharge tray <b>208</b> is also provided and a printed paper is discharged into this paper discharge tray <b>208</b>. The control unit <b>111</b> completes the generated print job after finishing of the paper discharge and generates a job log as the completion result.</p>
<p id="h-0008" num="0000">[Operation Part <b>114</b> of the Image Forming Apparatus <b>110</b>]</p>
<p id="p-0056" num="0055">Next, a configuration of the operation part <b>114</b> will be described with reference to <figref idref="DRAWINGS">FIG. 3</figref>. <figref idref="DRAWINGS">FIG. 3</figref> is a diagram showing an appearance configuration of the operation part <b>114</b> of <figref idref="DRAWINGS">FIG. 1</figref>. The operation part <b>114</b> includes an LCD display part <b>501</b> having a touch panel sheet <b>302</b> attached on an LCD. This LCD display part <b>501</b> displays a system operation screen and soft keys and, when a displayed key is pressed, also transfers positional information indicating the pressed position to the control unit <b>111</b>.</p>
<p id="p-0057" num="0056">In addition, the operation part <b>114</b> is provided with various kinds of hard keys of a start key <b>305</b>, a stop key <b>303</b>, an ID key <b>307</b>, and a reset key <b>304</b>. The start key <b>305</b> is a key for providing an instruction of stating the document image reading operation and the start key <b>305</b> is provided with an LED display part <b>306</b> having two colors of green and red in the center part thereof. The two color LED display part <b>306</b> indicates whether the start key <b>305</b> can be used or not by the color. The stop key <b>303</b> is a key for interrupting operation during a job. The ID key <b>307</b> is a key used for inputting a user ID of the user. The reset key <b>304</b> is a key used for initializing a setting from the operation part <b>114</b>.</p>
<p id="h-0009" num="0000">[Software Configuration of the Control Unit <b>111</b>]</p>
<p id="p-0058" num="0057">Next, a software configuration of the control unit <b>111</b> will be described with reference to <figref idref="DRAWINGS">FIG. 4</figref>. <figref idref="DRAWINGS">FIG. 4</figref> is a block diagram showing the software configuration of the control unit <b>111</b> in the image forming apparatus <b>110</b> of <figref idref="DRAWINGS">FIG. 1</figref>. The control unit <b>111</b> is connected with the scanner <b>113</b> which is an image input device and the printer <b>112</b> which is an image output device and controls these devices. On the other hand, the control unit <b>111</b> executably stores an application program inputting and outputting image information and device information via the communication unit <b>115</b>.</p>
<p id="p-0059" num="0058">An operation control part <b>401</b> is an application program for inputting and outputting information to and from the operation part <b>114</b>. The operation control part <b>401</b> outputs image data to be displayed on the operation part <b>114</b> to the operation part <b>114</b> and carries out display control of various kinds of LEDs provided in the operation part <b>114</b>. Further, the operation control part <b>401</b> receives information input by the user via the operation part <b>114</b> and performs a role of such as transferring of the information to another application program via the operating system.</p>
<p id="p-0060" num="0059">A communication control part <b>402</b> is an application program connected to the communication unit <b>115</b> for inputting and outputting information to and from the communication unit <b>115</b>.</p>
<p id="p-0061" num="0060">A device control part <b>403</b> is an application program for interpreting instructions output from other application programs to each device (scanner <b>113</b>, or the like) provided in the image forming apparatus <b>110</b> and providing an instruction to a printer control part <b>405</b> or a scanner control part <b>404</b> to be described below. The other application programs outputting the instructions include a web browser <b>406</b>, a copy application program and a FAX transmission application program which are not shown in the drawing, etc.</p>
<p id="p-0062" num="0061">Each of the application programs requests the device control part <b>403</b> to generate various kinds of jobs for providing instructions of utilizing various functions of the image forming apparatus <b>110</b>. At this time, it is possible to set an attribute of the generated job. The attributes to be set include a user name of the job, an attribute value such as a document name accompanying the job, and a setting value specifying the behavior of the device such as a setting for copying or printing, for example.</p>
<p id="p-0063" num="0062">The device control part <b>403</b> monitors a processing situation of the job in each of the devices and reflects the situation to a job status. When the processing in each device has been completed, the device control part <b>403</b> completes the generated job and instructs a log output management part <b>407</b> to be described below to output a job log. The information to be output into the job log includes the above described attribute value set in each job, date and time, a job status, a kind of a job, a kind of operation, etc.</p>
<p id="p-0064" num="0063">The scanner control part <b>404</b> is an application program for carrying out correction, modification edition, etc. for input image data from the scanner <b>113</b> according to an instruction from the device control part <b>403</b>. The scanner control part <b>404</b> monitors the scanner <b>113</b> and the situation of the generated scan job and notifies the device control part <b>403</b>.</p>
<p id="p-0065" num="0064">The printer control part <b>405</b> is an application program for carrying out correction and resolution conversion for the input image data to be printed out according to an instruction from the device control part <b>403</b> and outputting the image data to the printer <b>112</b>. The printer control part <b>405</b> monitors the printer <b>112</b> and the situation of the print job and notifies the device control part <b>403</b>.</p>
<p id="p-0066" num="0065">A web browser <b>406</b> is an application program for reading various kinds of website (home page) information on the Internet or an intranet and displaying the information. A detailed configuration of this web browser <b>406</b> will be described hereinafter.</p>
<p id="p-0067" num="0066">The log output management part <b>407</b> is an application program for storing information about authentication processing carried out in an authentication service <b>408</b> and operation carried out through the operation part <b>114</b> into the indirect storage part as a job log. The contents of the stored job log will be described hereinafter.</p>
<p id="p-0068" num="0067">The authentication service <b>408</b> is an application program for controlling the user authentication processing carried out when the user utilizes the function of the image forming apparatus <b>110</b>. The authentication service <b>408</b> receives the user account information input from the operation part <b>114</b> via the operation control part <b>401</b> and carries out the authentication processing. The authentication service <b>408</b> can issue ST when the user authentication has succeeded in the authentication processing result. As another embodiment, the authentication service <b>408</b> may transmit the received user account information to the authentication server <b>130</b> and receive ST issued by the authentication server <b>130</b> after the authentication processing thereof.</p>
<p id="p-0069" num="0068">An authentication information management part <b>409</b> is an application program for storing and managing ST returned from the authentication service <b>408</b> after the success of the user authentication and the user account information which can be obtained from the authentication server <b>130</b>. Detailed description of the authentication information management part <b>409</b> will be described hereinafter.</p>
<p id="p-0070" num="0069">A user account information management part <b>410</b> is an application program for the web browser <b>406</b> to register or obtain the user account information using the authentication information stored and managed in the authentication information management part <b>409</b> and the URI (particularly URL) of the website as keys. Specifically, this account information is transferred to the web application server <b>120</b> via the web browser <b>406</b>. The data structure of the user account information to be registered in the user account information management part <b>410</b> will be described hereinafter. Note that the user account information management part <b>410</b> is an application program necessary for a second flow to be described hereinafter and is not necessary for a first flow.</p>
<p id="h-0010" num="0000">[Authentication Information Management Part <b>409</b>]</p>
<p id="p-0071" num="0070">The authentication information management part <b>409</b> stores and manages the authentication information of the user who has logged in to the image forming apparatus <b>110</b>. The authentication service <b>408</b> transfers information necessary for generation of the user authentication information (e.g., ST or the like) to the authentication information management part <b>409</b> after the success of the authentication. The authentication information management part <b>409</b> generates authentication information in which the user information is written. When the authentication has succeeded and the user information has been written in the authentication information, the image forming apparatus <b>110</b> operates within a range of a user's authority written in the authentication information for the user's operation after that. Further, the authentication information management part <b>409</b> manages a life cycle of the authentication information. The life cycle of the authentication information is a cycle from the generation of the authentication information to user's log-out processing. Log-out conditions include instruction of the log-out processing by the user via the operation part <b>114</b>, no operation via the operation part <b>114</b> for a set time-out period, change of the various kinds of device setting information, transfer to a low-power mode, and device restart.</p>
<p id="p-0072" num="0071">Next, an example of a data structure for the authentication information will be described by use of <figref idref="DRAWINGS">FIG. 7</figref>. The authentication information <b>701</b> includes an ST attribute <b>702</b>, a local user name attribute <b>703</b>, and a domain name attribute <b>704</b>. The ST attribute <b>702</b> stores ST obtained from the authentication service <b>408</b>. The local user name attribute <b>703</b> stores the user name obtained from the authentication service <b>408</b>. The domain name attribute <b>704</b> stores a domain name to which the user belongs, obtained from the authentication service <b>408</b>.</p>
<p id="h-0011" num="0000">[User Account Information Management Part <b>410</b>]</p>
<p id="p-0073" num="0072">An example of a data structure for the user account information registered by the user account information management part <b>410</b> will be described by use of <figref idref="DRAWINGS">FIG. 8</figref>. The user account information <b>801</b> includes an authentication information attribute <b>802</b>, a remote user name attribute <b>803</b>, a password attribute <b>804</b>, and a key attribute <b>805</b>. The authentication information attribute <b>802</b> stores the authentication information shown in <figref idref="DRAWINGS">FIG. 7</figref>. The remote user name attribute <b>803</b> stores a log-in user name for the web application server <b>120</b>. The password attribute <b>804</b> (Password) stores a log-in password for the web application server <b>120</b>. From a viewpoint of security, it is preferable that the password attribute be encrypted for storing. The key attribute <b>805</b> is configured so as to be able to register plural pairs of key and character string. The &#x201c;key&#x201d; here is . . . , for example. The &#x201c;character string&#x201d; is . . . , for example. The key attribute <b>805</b> stores the address of the web application server <b>120</b> which utilizes this user account information, the URI of a website, etc.</p>
<p id="p-0074" num="0073">Note that processing control by the user account information management part <b>410</b> will be described in the second flow to be described hereinafter.</p>
<p id="h-0012" num="0000">[Job Log Output in the Log Output Management Part <b>407</b>]</p>
<p id="p-0075" num="0074">An example of a data structure for the job log information output in the log output management part <b>407</b> will be described by use of <figref idref="DRAWINGS">FIG. 9</figref>. The job log information <b>901</b> includes a date and time attribute <b>902</b>, an application ID attribute <b>903</b>, a user name attribute <b>904</b>, a function name attribute <b>905</b>, a job ID attribute <b>906</b>, a job status attribute <b>907</b>, and a key attribute <b>908</b>. The date and time attribute <b>902</b> stores date and time when the job log information is output. The application ID attribute <b>903</b> stores GUID set for each application program. The user name attribute <b>904</b> stores a user name input from each application program. The function name attribute <b>905</b>, the job ID attribute <b>906</b>, and the job status attribute <b>907</b> are a name of a function executed by each application program, a generated job ID, and a status of the job, respectively, which are input from each application program and stored therein. The key attribute <b>908</b> is configured so as to be able to register plural pairs of key and character string. The key attribute <b>908</b> includes an attribute name and an attribute value set for each job, and information which each application sets and inputs optionally.</p>
<p id="h-0013" num="0000">[Configuration of the Web Browser <b>406</b>]</p>
<p id="p-0076" num="0075">The web browser <b>406</b> is an application program for setting up connection with another network node and carrying out communication therewith via the communication control unit <b>402</b>. In this communication, an HTTP request is issued to a resource described by a URL and a response thereof is obtained. Also in this process, communication data is encoded or decoded according to various kinds of encoding formats.</p>
<p id="p-0077" num="0076">The web browser <b>406</b> receives an event of operation which the user carried out using a touch panel sheet or each of the keys on the operation part <b>114</b> and executes processing corresponding to each of the events. In addition, the web browser <b>406</b> is provided with a script interpreter (not shown in the drawing). The script interpreter is a program interpreting and executing a script such as Java (registered trade mark) Script (ECMA Script). The script is embedded in a document or described in a separated file linked to the document. The script enables dynamic behavior of a document provided by the web application server <b>120</b> to be programmed.</p>
<p id="h-0014" num="0000">[Request and Response Flow in the HTTP Protocol]</p>
<p id="p-0078" num="0077"><figref idref="DRAWINGS">FIG. 5</figref> is a sequence diagram of a request and response process flow in the HTTP protocol. A client <b>501</b> is software transmitting an HTTP request and receiving an HTTP response. The client <b>501</b> corresponds to the web browser <b>406</b> built in the image forming apparatus <b>110</b> of the present embodiment and a typical web browser operating on a computer which is not shown in the drawing. A server <b>502</b> is software receiving the HTTP request to carry out corresponding processing and further returning the HTTP response, and corresponds to the web application server <b>120</b> of the present embodiment.</p>
<p id="p-0079" num="0078">The client <b>501</b> can transmit the HTTP request in either a GET method or a POST method. Here, when the client <b>501</b> transmits an HTTP request for a desired resource to the server <b>502</b> in the GET method, the resource is specified typically in the URI (particularly URL) format. The server <b>502</b> obtains or generates data corresponding to the resource specified by the HTTP request and returns this data in the HTTP response.</p>
<p id="p-0080" num="0079">Next, a case where the HTTP request is transmitted by the POST method will be described. For the case that a form is included in an HTML document and the POST method is specified for the transmission method thereof, the following processing is carried out. That is, information input by a user into a form displayed by the web browser <b>406</b> of the client <b>501</b> is encoded, and the encoded information, that is, input contents of the form is transmitted to the server <b>502</b> as an attachment to the HTTP request. In the server <b>502</b>, the specified resource receives the data transmitted from the client <b>501</b>, caries out processing, generates an HTTP response, and returns the HTTP response to the client <b>501</b>.</p>
<p id="p-0081" num="0080">Next, authentication by the HTTP protocol will be described. The authentication in the HTTP protocol has largely divided two methods. One is an authentication method utilizing header information defined in the HTTP protocol, and includes the NTLM authentication and the Kerberos authentication, for example. The other one is a method called a form authentication, which is provided with a form inputting a user name and a password into a web site and the web browser POSTs the information to the web application server.</p>
<p id="p-0082" num="0081">Currently, more than half of the websites employ the latter form authentication method because some web browsers do not accommodate the former authentication method and the former authentication method needs a certificate. Accordingly, the present specification will describe a sequence of the HTTP protocol in the form authentication.</p>
<p id="p-0083" num="0082">The client <b>501</b> provides GET to the URI of a log-in site for the form authenticating. The log-in site on the obtained HTML document generally includes a form for inputting an ID or a name of a log-in user, a form for inputting a password, and a button action for executing log-in. When the user input information into these forms and executes the log-in, the client <b>501</b> POSTs the information to the server <b>502</b>.</p>
<p id="p-0084" num="0083">The POSTed sever <b>502</b> carries out authentication according to the received information. After having succeeded in the authentication, the server <b>502</b> generates a Session ID which is session unique information, and responds to the client <b>501</b> by transmitting the Session ID together with the HTML document after the authentication.</p>
<p id="p-0085" num="0084">In the succeeding processing between the client <b>501</b> and the server <b>502</b>, the generated Session ID is transmitted and received, and thereby the authenticated state is maintained. This Session ID is retained by both sides as information effective within a set time limit.</p>
<p id="h-0015" num="0000">[Screen Configuration of the Browser in the Image Forming Apparatus <b>110</b>]</p>
<p id="p-0086" num="0085">Next, a screen configuration of the web browser <b>406</b> for a screen displayed by the operation part <b>114</b> will be described with reference to <figref idref="DRAWINGS">FIG. 6</figref>. A browser screen <b>600</b> displays a tab <b>601</b>, a URL input field <b>608</b>, an OK button <b>609</b>, a progress bar <b>607</b>, a content display area <b>602</b>, a back button <b>603</b>, a forward button <b>604</b>, a reload button <b>606</b>, an interrupt button <b>605</b>, and a status area <b>610</b>.</p>
<p id="p-0087" num="0086">The tab <b>601</b> switches the screen from a screen of another function (copy, box, transmission, expansion, or the like) for utilizing the function of the web browser <b>406</b> in the image forming apparatus <b>110</b>. The URL input field <b>608</b> is a field into which a user inputs the URL of a desired resource, and when the field is pressed by the user, a virtual full key board (not shown in the drawing) is displayed for character input. The user can input a desired character string with a soft key emulating a key top disposed on the virtual full key board.</p>
<p id="p-0088" num="0087">The OK button <b>609</b> is a soft key determining the input URL character string. When the URL has been determined, the web browser <b>406</b> issues an HTTP request for obtaining the resource. The progress bar <b>607</b> shows a progress status of the content obtaining processing by the HTTP request and response. The content display area is an area for displaying the obtained resource. The back button <b>603</b> is a soft key for re-displaying content which was displayed before currently displayed content by tracking back a history of the content display. The forward button <b>604</b> is a soft key for returning to a display of content which has been displayed after the currently displayed content when the display is tracking back the history of the content display. The reload button <b>606</b> is a soft key for obtaining and displaying currently displayed content again. The interrupt button <b>605</b> is a soft key for interrupting content obtaining processing under execution. The status area <b>610</b> is an area for displaying a message from each of the various application programs of the image forming apparatus <b>110</b>. This status area <b>610</b> can display a message to call attention to a user from each of the scanner <b>113</b>, the printer <b>112</b>, and other functions even when the browser screen <b>600</b> is being displayed. Further, the status area <b>610</b> can display a message from the function of the web browser <b>406</b> in the same manner. The function of the web browser <b>406</b> displays a URL character string of a link destination, a title character string of the content, a message specified by the script, etc.</p>
<p id="h-0016" num="0000">(First Flow)</p>
<p id="p-0089" num="0088">Next, for the embodiment of the present invention, a first processing flow will be described with reference to a flowchart.</p>
<p id="h-0017" num="0000">[Log-In Flow for the Image Forming Apparatus <b>110</b>]</p>
<p id="p-0090" num="0089"><figref idref="DRAWINGS">FIG. 10</figref> is a flowchart showing log-in processing for the image forming apparatus <b>110</b> in the control unit <b>111</b>. <figref idref="DRAWINGS">FIG. 11</figref> shows an example of a screen displayed on the operation part <b>114</b> when the user authentication is carried out by a user account of a user name, a domain name, and a password. The log-in processing for the image forming apparatus <b>110</b> in the control unit <b>111</b> will be described by use of <figref idref="DRAWINGS">FIG. 10</figref> and <figref idref="DRAWINGS">FIG. 11</figref>.</p>
<p id="p-0091" num="0090">In step S<b>1001</b>, the operation control part <b>401</b> displays a log-in screen as shown in <figref idref="DRAWINGS">FIG. 11</figref> on the operation part <b>114</b> according to information obtained from the authentication service <b>408</b> in the control unit <b>111</b>.</p>
<p id="p-0092" num="0091">Next, the log-in screen example of <figref idref="DRAWINGS">FIG. 11</figref> will be described. A user name input text box <b>1101</b> is a text box area for inputting a user name. Hereinafter, the user name input into the user name input text box <b>1101</b> is called a local user name for discrimination from a user name to be input in the log-in to the web application server <b>120</b> as will be described hereinafter. When the user has selected the user name input text box <b>1101</b>, the operation control part <b>401</b> carries out processing for displaying the software key board on the operation part <b>114</b>. Thereby, the user can carry out the character input easily.</p>
<p id="p-0093" num="0092">A domain name input textbook <b>1102</b> is a text box area for inputting a domain name. The domain name input text box <b>1102</b> is a multiple-choice type.</p>
<p id="p-0094" num="0093">A password input text box <b>1103</b> is a text box area for inputting a password.</p>
<p id="p-0095" num="0094">When a user pushes down an OK button <b>1104</b>, the user account information including the input user name, domain name, and password information is transferred to the authentication service <b>408</b> via the operation control part <b>401</b>. That is, the pushing down of the OK button <b>1104</b> by the user provides an execution request of the authentication function included in the image forming apparatus <b>110</b>.</p>
<p id="p-0096" num="0095">In step S<b>1002</b>, after the user account information of the user has been input via the operation part <b>114</b>, the user account information is notified to the authentication service <b>408</b> via the operation control part <b>401</b> of the control unit <b>111</b>.</p>
<p id="p-0097" num="0096">In step S<b>1003</b>, the authentication service <b>408</b> determines validity of the received user account (i.e., carries out the authentication processing). If the user account is not valid in the validity determination result (step S<b>1004</b>: NG), the operation control part <b>401</b> displays the log-in screen again on the operation part <b>114</b> in step S<b>1001</b>.</p>
<p id="p-0098" num="0097">If the user account is valid (step S<b>1004</b>: OK), in step S<b>1005</b>, the above authentication information is generated according to the user account information and stored into the authentication information management part <b>409</b>.</p>
<p id="p-0099" num="0098">In step S<b>1006</b>, the authentication service <b>408</b> transfers the following information to the log output management part <b>407</b> as an application ID, a user name, and a function name, and the log output management part <b>407</b> generates a job log using the information.
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0099">Application ID: application ID of the authentication service <b>408</b></li>
        <li id="ul0002-0002" num="0100">User name: local user name in the authentication information</li>
        <li id="ul0002-0003" num="0101">Function name: authentication</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0100" num="0102">Next, in step S<b>1007</b>, the control unit <b>111</b> presents an initial screen for selection of the application program functions provided in the control unit <b>111</b> on the operation part <b>114</b>. The initial screen corresponds to the web browser screen shown in <figref idref="DRAWINGS">FIG. 6</figref>, for example.</p>
<p id="p-0101" num="0103">From this step to user log-out, each of the application programs in the control unit <b>111</b> can utilize the function of the image forming apparatus <b>110</b> after having obtained the authentication information stored in the authentication information management part <b>409</b> and generated the job log.</p>
<p id="h-0018" num="0000">[Log-In Flow for the Web Application Server <b>120</b>]</p>
<p id="p-0102" num="0104"><figref idref="DRAWINGS">FIG. 12</figref> is a flowchart of a log-in processing for the web application server <b>120</b> in the web browser <b>406</b> of the control unit <b>111</b>.</p>
<p id="p-0103" num="0105">In step S<b>1201</b>, the control unit <b>111</b> displays the web browser screen <b>600</b> shown in <figref idref="DRAWINGS">FIG. 6</figref> on the operation part <b>114</b> via the operation control part <b>401</b>. This screen may be displayed when the user has selected the function of the web browser <b>406</b> on the operation part <b>114</b>, or may be displayed as an initial screen after the log-in to the image forming apparatus <b>110</b>.</p>
<p id="p-0104" num="0106">Next, the web browser <b>406</b> waits for URL input for a log-in site and the push down of the OK button from the user via the operation part <b>114</b>, in step S<b>1202</b>. Then, when the URL is input and the OK button is pushed down, the web browser <b>406</b> provides a GET request to the web application server <b>120</b> corresponding to the URL input via the communication control part <b>402</b> and the communication unit <b>115</b>, in step S<b>1203</b>.</p>
<p id="p-0105" num="0107">Note that, in a case where this log-in site URL is registered in the web browser <b>406</b> as an initial display URL, the above processing of step S<b>1202</b> and step S<b>1203</b> can be skipped.</p>
<p id="p-0106" num="0108">In step S<b>1204</b>, the web browser <b>406</b> displays a log-in screen provided by the web application server <b>120</b> as a response on the operation part <b>114</b> via the operation control part <b>401</b>. The log-in screen displayed here (not shown in the drawing) is provided with forms for inputting a user name (hereinafter, called a remote user name for discrimination from the local user name) and a password and a log-in (or OK) button for determining the input.</p>
<p id="p-0107" num="0109">In step S<b>1205</b>, the web browser <b>406</b> receives input of user account information from the user and push down of the log-in button via the operation part <b>114</b> and the operation control part <b>401</b>. The user account information input here includes a remote user name and a password for the log-in to the web application server <b>120</b>.</p>
<p id="p-0108" num="0110">In step S<b>1206</b>, the web browser <b>906</b> POSTs the received user account information to the web application server <b>120</b> via the communication control part <b>402</b> and the communication unit <b>115</b>.</p>
<p id="p-0109" num="0111">The web application server <b>120</b> transmits the account information to the authentication server <b>130</b> for verifying whether the received user account is valid or not, and generates a Session ID, which is session unique information, corresponding to the user account if the user account is valid. Then, the web application server <b>120</b> generates a device function screen corresponding to the user account and provides the screen to the communication unit <b>115</b> as a response. If the user account is not valid, the web application server <b>120</b> generates a screen showing that the authentication has failed and provides the screen to the communication unit <b>115</b> as a response.</p>
<p id="p-0110" num="0112">Here, if the user account information is valid, the web application server <b>120</b> outputs and stores a log which includes the user account information and the generated Session ID and shows the log-in of the user. The user account information and the Session ID included in the log-in log become identification information of this log. The user account information and the Session ID included in a log to be described below also become log identification information in the same manner. Note that the identification information is not necessarily included in the log, and the log and the identification information have only to be associated with each other.</p>
<p id="p-0111" num="0113">In step S<b>1207</b>, the web browser <b>406</b> receives the response screen and the Session ID information from the web application server <b>120</b> via the communication control part <b>402</b> and the communication unit <b>115</b>.</p>
<p id="p-0112" num="0114">Next, in step S<b>1208</b>, the web browser <b>406</b> associates the received Session ID information with the user account information and stores these information into the indirect storage part <b>118</b> or the like. Note that the Session ID information is stored so as to be obtainable using the user account information as a key until the user logs out from the website or a preservation period set for the Session ID elapses. That is, by the processing of step S<b>1206</b> and step S<b>1208</b>, the Session ID information is stored in both of the image forming apparatus <b>110</b> and the web application server <b>120</b> as common information.</p>
<p id="p-0113" num="0115">Next, in step S<b>1209</b>, the web browser <b>406</b> displays the received response screen on the operation part <b>114</b> via the operation control part <b>401</b>.</p>
<p id="p-0114" num="0116"><figref idref="DRAWINGS">FIG. 13</figref> shows an example of the web application screen presented after the log-in to the website. This web application screen shows an example of a document management application.</p>
<p id="p-0115" num="0117">A link <b>1301</b> is link information for the URI of the presented document. When the user has selected this link information, the web browser <b>406</b> is notified of the selection of the link information of the document, via the operation part <b>114</b> and the operation control part <b>401</b>. Details of processing after the notification will be described hereinafter.</p>
<p id="p-0116" num="0118">An upload button <b>1302</b> is a button for instructing upload of electronic data of a document generated in the image forming apparatus <b>110</b> to the web application server <b>120</b>. When the user pushes down this upload button <b>1302</b>, the web browser <b>406</b> is notified of the push down of the upload button via the operation part <b>114</b> and the operation control part <b>401</b>. Details of operation after the notification will be described hereinafter.</p>
<p id="p-0117" num="0119">In this manner, the log-in to the image forming apparatus <b>110</b> is carried out and further the log-in to the web application server <b>120</b> is carried out. In a case where the authentication service is different between the respective log-in flows, there is a possibility that the respective input user account information may be different from each other. Further, even if the authentication services are unified, there may be an operation in which some user inputs different user accounts into respective apparatuses. As a result, there is a possibility that the local user name included in the authentication information managed by the image forming apparatus <b>110</b> and the remote user name which has logged in to the web application server <b>120</b> are different from each other.</p>
<p id="h-0019" num="0000">[Utilization of the Function in the Image Forming Apparatus <b>110</b>]</p>
<p id="p-0118" num="0120"><figref idref="DRAWINGS">FIGS. 14A and 14B</figref> illustrate a flowchart showing processing when the function of the image forming apparatus <b>110</b> is utilized from the web browser <b>406</b> of the control unit <b>111</b>. The present specification describes the web application described by use of <figref idref="DRAWINGS">FIG. 13</figref> as an example.</p>
<p id="p-0119" num="0121">In step S<b>1401</b>, the web browser <b>406</b> displays a web application screen. The following processing will be described on the assumption that the web browser <b>406</b> displays an example of the web application screen shown in <figref idref="DRAWINGS">FIG. 13</figref> in this step.</p>
<p id="p-0120" num="0122">In step S<b>1402</b>, the web browser <b>406</b> receives a function selected by a user in the web application screen via the operation part <b>114</b> and the operation control part <b>401</b>. That is, the image forming apparatus <b>110</b> receives an execution request of the function of the image forming apparatus <b>110</b> from the user. The process is branched in step S<b>1403</b> depending on the selected function.</p>
<p id="p-0121" num="0123">First, a case where &#x201c;document link&#x201d; has been selected will be described.</p>
<p id="p-0122" num="0124">In step S<b>1404</b>, the web browser <b>406</b> transmits a request in the get method to the URL indicated by the selected link via the communication control part <b>402</b> and the communication unit <b>115</b> and obtains and stores document data together with the Session ID.</p>
<p id="p-0123" num="0125">Here, the web application server <b>120</b> outputs and preserves a log indicating that the document has been obtained in the GET method. The log includes the user account information of the user having logged in to the web application server <b>120</b>, the Session ID of a session accessed by the user, and the URL of the obtained document data.</p>
<p id="p-0124" num="0126">Next, in step S<b>1405</b>, the web browser <b>406</b> displays a screen for selecting the function of the web browser <b>406</b> as shown in <figref idref="DRAWINGS">FIG. 15</figref> on the operation part <b>114</b> via the operation control part <b>401</b>.</p>
<p id="p-0125" num="0127">Here, an example of the screen for selecting the function of the web browser <b>406</b> shown in <figref idref="DRAWINGS">FIG. 15</figref> will be described. A web browser function selection screen <b>1501</b> is a screen showing a function capable of processing a format of the obtained document. This example shows that display and print processing is possible for the format of the obtained document. A function selection button <b>1502</b> shows a selected state of the function. When an OK button <b>1503</b> is pushed down, the selected function is executed. When a cancel button <b>1504</b> is pushed down, the obtained document data is discarded and the function selection screen <b>1501</b> is closed.</p>
<p id="p-0126" num="0128">Next, in step S<b>1406</b>, the web browser <b>406</b> receives the selected function. In step S<b>1407</b>, the process is branched depending on the selected function.</p>
<p id="p-0127" num="0129">Next, the succeeding process will be described for a case where a print function has been selected in step S<b>1406</b>.</p>
<p id="p-0128" num="0130">In step S<b>1408</b>, the web browser <b>406</b> obtains currently preserved Session ID and the linked URI of the document. At the same time, the web browser <b>406</b> obtains the authentication information of the user currently having logged into the image forming apparatus <b>110</b> from the authentication information management part <b>409</b>.</p>
<p id="p-0129" num="0131">In step S<b>1409</b>, the web browser <b>406</b> sets the following information to a print job attribute and instructs the device control part <b>403</b> to generate and execute a print job.
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0132">Application ID: application ID of the web browser <b>406</b></li>
        <li id="ul0004-0002" num="0133">User name: local user name in the authentication information</li>
        <li id="ul0004-0003" num="0134">Key: Session ID</li>
        <li id="ul0004-0004" num="0135">Key: URI of the document</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0130" num="0136">The device control part <b>403</b> instructs the printer <b>112</b> to generate the print job and to carry out printing via the printer control part <b>405</b>. The printer control part <b>405</b> monitors the situation of the printing in the printer <b>112</b> and notifies the device control part <b>403</b> when having detected completion of the printing in step S<b>1410</b>.</p>
<p id="p-0131" num="0137">In step S<b>1411</b>, the device control part <b>403</b> notifies the log output management part <b>407</b> of the attribute information of the completed print job. The log output management part <b>407</b> carries out job log outputting of the print job in response to the received notification.</p>
<p id="p-0132" num="0138">Then, after the execution of these functions has been completed, the device control part <b>403</b> notifies the web browser <b>406</b> of the print completion.</p>
<p id="p-0133" num="0139">In step S<b>1412</b>, the web browser <b>406</b> closes the function selection screen <b>1501</b> shown on the operation part <b>114</b> and displays the web application screen again via the operation control part <b>401</b>.</p>
<p id="p-0134" num="0140">Next, a case where a display function has been selected in step S<b>1406</b> will be described.</p>
<p id="p-0135" num="0141">In step S<b>1413</b>, the web browser <b>406</b> obtains the currently preserved Session ID and the linked URL of the document. At the same time, the web browser <b>406</b> obtains the authentication information of the user currently having logged in to the image forming apparatus <b>110</b> from the authentication information management part <b>409</b>.</p>
<p id="p-0136" num="0142">In step S<b>1414</b>, the web browser <b>406</b> displays a preview of the obtained document on the operation part <b>114</b> or a display part (not shown in the drawing).</p>
<p id="p-0137" num="0143">In step S<b>1415</b>, the web browser <b>406</b> transfers the following information to the log output management part <b>407</b> and generates a job log.
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0144">Application ID: application ID of the web browser <b>406</b></li>
        <li id="ul0006-0002" num="0145">User name: local user name in the authentication information</li>
        <li id="ul0006-0003" num="0146">Function name: display</li>
        <li id="ul0006-0004" num="0147">Key: Session ID information</li>
        <li id="ul0006-0005" num="0148">Key: URI of the document</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0138" num="0149">Next, in step S<b>1416</b>, when the user has closed the preview display screen via the operation part <b>114</b>, the operation control part <b>401</b> detects it and the web browser <b>406</b> displays the web application screen again in step S<b>1412</b>.</p>
<p id="p-0139" num="0150">Next, a case where the function selected in step S<b>1402</b> is &#x201c;upload&#x201d; will be described.</p>
<p id="p-0140" num="0151">In step S<b>1417</b>, the web browser <b>406</b> displays a scan setting screen (not shown in the drawing) on the operation part <b>114</b> via the operation control part <b>401</b>. The scan setting screen can set scan operation behavior (e.g., setting of both-side reading, color/monochrome reading, etc.). Then, in step S<b>1418</b>, the web browser <b>406</b> receives a scan execution request of the user from the operation part <b>114</b> via the operation control part <b>401</b>.</p>
<p id="p-0141" num="0152">In step S<b>1419</b>, the web browser <b>406</b> obtains the currently preserved Session ID and the URL of upload destination of the document. At the same time, the web browser <b>406</b> obtains the authentication information of the user currently having logged in to the image forming apparatus <b>110</b> from the authentication information management part <b>409</b>.</p>
<p id="p-0142" num="0153">In step S<b>1420</b>, the web browser <b>406</b> sets the attribute set on the above scan setting screen and the following information to a scan job attribute and instructs the device control part <b>403</b> to generate and execute a scan job.
<ul id="ul0007" list-style="none">
    <li id="ul0007-0001" num="0000">
    <ul id="ul0008" list-style="none">
        <li id="ul0008-0001" num="0154">Application ID: application ID of the web browser <b>406</b></li>
        <li id="ul0008-0002" num="0155">User name: local user name in the authentication information</li>
        <li id="ul0008-0003" num="0156">Key: Session ID information</li>
        <li id="ul0008-0004" num="0157">Key: URI of the upload destination</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0143" num="0158">The device control part <b>403</b> provides an instruction of generating the scan job and reading via the scanner control part <b>404</b>. The scanner control part <b>404</b> monitors the situation of the reading by the scanner <b>113</b> and notifies the device control part <b>403</b> when detecting the completion of reading in step S<b>1421</b>.</p>
<p id="p-0144" num="0159">In step S<b>1422</b>, the device control part <b>403</b> notifies the log output management part <b>407</b> of the attribute information of the completed scan job and carries out job log outputting of the scan job.</p>
<p id="p-0145" num="0160">Then, when the execution of these functions has been completed, the device control part <b>403</b> notifies the web browser <b>406</b> of the completion of the scanning.</p>
<p id="p-0146" num="0161">In step S<b>1423</b>, the web browser <b>406</b> POSTs electronic data of the document generated by the scanning to the URI of specified upload destination via the communication control part <b>402</b> and receives a POST response.</p>
<p id="p-0147" num="0162">Here, the web application server <b>120</b> outputs and preserves a log indicating that the document has been uploaded. The log includes user account information of the user having logged in to the web application server <b>120</b>, the Session ID, and the URL of the uploaded document data.</p>
<p id="p-0148" num="0163">Next, in step S<b>1424</b>, the web browser <b>406</b> displays a response screen received in the POST response on the operation part <b>114</b> via the operation control part <b>401</b>.</p>
<p id="p-0149" num="0164">By the above processing, it becomes possible to output information identical to the Session ID generated in the web application server <b>120</b> to the job log after the utilization of the function in the web browser <b>406</b>.</p>
<p id="p-0150" num="0165">Accordingly, when document data obtained from the web application server <b>120</b> is printed, for example, it is possible to prove that this processing is a series of processing requested by the same user by associating the logs with each other using the following method. That is, first, the log output from the web application server <b>120</b>, indicating that the document data has been obtained by a GET request, is searched for. Next, by use of the Session ID included therein as a key, the job log output in the image forming apparatus <b>110</b> is searched for and associated.</p>
<p id="p-0151" num="0166">Accordingly, by the above described processing, it is possible to record a audit trail including information common to both devices of the web application server and the image forming apparatus.</p>
<p id="h-0020" num="0000">(Second Flow)</p>
<p id="p-0152" num="0167">In the first flow, when the authenticated user accounts are different between the web application server <b>120</b> and the image forming apparatus <b>110</b>, a difference occurs between the user names included in the logs output in the respective apparatuses. Accordingly, log association can be carried out only by the Session ID. A second flow is a flow in which the log association is easier than in the first flow and search capability and readability of the log (that is, audit trail) are improved.</p>
<p id="p-0153" num="0168">Hereinafter, the second flow will be described with reference to a flowchart. Note that description of the same processing as that of the first flow will be omitted.</p>
<p id="p-0154" num="0169"><figref idref="DRAWINGS">FIG. 16</figref> is a flowchart showing log-in processing for the web application server <b>120</b> in the web browser <b>406</b> of the control unit <b>111</b>, in the second flow.</p>
<p id="p-0155" num="0170">In step S<b>1601</b>, the control unit <b>111</b> displays the web browser screen <b>600</b> shown in <figref idref="DRAWINGS">FIG. 6</figref> on the operation part <b>114</b> via the operation control part <b>401</b>. The web browser screen <b>600</b> is displayed when a user has selected the web browser <b>406</b> via the operation part <b>114</b>, or may be displayed as an initial screen after log-in to the image forming apparatus <b>110</b>.</p>
<p id="p-0156" num="0171">Next, the web browser <b>406</b> waits for URL input and OK button push down by the user in step S<b>1602</b>. Then, when the user has inputted the URL of a log-in site and pushed down the OK button, in step S<b>1603</b>, the web browser <b>406</b> provides a GET request to the target web application server <b>120</b> via the communication control part <b>402</b> and the communication unit <b>115</b>.</p>
<p id="p-0157" num="0172">In a case where this log-in site URL is registered as an initial display URL in the web browser <b>406</b>, above step S<b>1602</b> and step S<b>1603</b> can be skipped.</p>
<p id="p-0158" num="0173">Next, instep S<b>1604</b>, the web browser <b>406</b> obtains the authentication information of the user having logged in to the image forming apparatus <b>110</b> from the authentication information management part <b>409</b>. Then, the web browser <b>406</b> searches the user account information management part <b>410</b> for user account information using the URL of the website to be displayed and the obtained authentication information as keys. In step S<b>1605</b>, the process is branched depending on the search result.</p>
<p id="p-0159" num="0174">If the user account information is not registered and the information has not been obtained as the search result in step S<b>1605</b>, the web browser <b>406</b> displays a login screen provided by the web application server <b>120</b> as a response on the operation part <b>114</b> in step S<b>1606</b>. The log-in screen (not shown in the drawing) displayed here is provided with a form for inputting a remote user name and a password and a log-in (or OK) button for determining the input.</p>
<p id="p-0160" num="0175">In step S<b>1607</b>, the web browser <b>406</b> receives and obtains input of the user account information from the user and push down of the log-in button via the operation part <b>114</b> and the operation control part <b>401</b>. The user account information obtained here includes the remote user name and the password for log-in to the web application server <b>120</b>.</p>
<p id="p-0161" num="0176">In a case where the user account information is registered as the search result in step S<b>1605</b>, the web browser <b>406</b> obtains the user account information from the user account information management part <b>410</b> in step S<b>1608</b>. The user account information obtained here includes the remote user name and the password registered in the user account information management part <b>410</b> when the user logged in to the web application server <b>120</b> in the past.</p>
<p id="p-0162" num="0177">Next, in step S<b>1609</b>, the web browser <b>406</b> POSTS the obtained user account to the web application server <b>120</b> via the communication control part <b>402</b> and the communication unit <b>115</b>.</p>
<p id="p-0163" num="0178">The web application server <b>120</b> inquires the authentication server <b>130</b> whether the received user account is valid or not, and, if valid, generates a Session ID which is session unique information corresponding to the user account. Then, the web application server <b>120</b> generates a device function screen corresponding to the user account and provides the Session ID and the device function screen to the communication unit <b>115</b> as a response. If the user account is not valid, the web application server <b>120</b> generates a screen indicating that the authentication has failed and provides the screen to the communication unit <b>115</b> as a response.</p>
<p id="p-0164" num="0179">When the user account information is valid here, the web application server <b>120</b> outputs a log which includes the user account information and the generated Session ID and indicates that the user has logged in.</p>
<p id="p-0165" num="0180">In step S<b>1610</b>, the web browser <b>406</b> receives the response screen and the Session ID information from the web application server <b>120</b> via the communication control part <b>402</b> and the communication unit <b>115</b>.</p>
<p id="p-0166" num="0181">Next, in step S<b>1611</b>, the web browser <b>406</b> associates the received Session ID information with the user account and stores these information for management. Note that the Session ID information is stored so as to be reusable by use of the user account as a key until the user logs out from the website or until a preservation period set for the Session ID elapses.</p>
<p id="p-0167" num="0182">In step S<b>1612</b>, the web browser <b>406</b> displays the received response screen on the operation part <b>114</b>.</p>
<p id="p-0168" num="0183">Next, in step S<b>1613</b>, the web browser <b>406</b> registers the user account information POSTed in step S<b>1609</b> to the user account information management part <b>410</b>. When the user account information is already registered, the user account information is updated. At this time, the web browser <b>406</b> registers the URI of the log-in screen and the authentication information obtained in step S<b>1604</b> as key information for searching for the user account information.</p>
<p id="p-0169" num="0184">This user account information which is stored and managed in the user account information management part <b>410</b> may be configured to be registered or deleted from the screen displayed on the operation part <b>119</b> via the operation control part <b>401</b>. Further, the user account information may be configured to be registered or deleted from an external computer connected by the network via the communication control part <b>402</b> and the communication unit <b>115</b>.</p>
<p id="h-0021" num="0000">[Utilization of the Function in the Image Forming Apparatus <b>110</b>]</p>
<p id="p-0170" num="0185"><figref idref="DRAWINGS">FIGS. 17A and 17B</figref> illustrate a flowchart showing processing in the second flow for a case where the function of the image forming apparatus <b>110</b> is utilized from the web browser of the control unit <b>111</b>. The present specification will describe the web application described by use of <figref idref="DRAWINGS">FIG. 13</figref>, as an example.</p>
<p id="p-0171" num="0186">In step S<b>1701</b>, the web browser <b>406</b> displays a web application screen. Description will be given on the assumption that the web browser <b>406</b> displays the web application screen shown in <figref idref="DRAWINGS">FIG. 13</figref> in this step.</p>
<p id="p-0172" num="0187">In step S<b>1702</b>, the web browser <b>406</b> receives a function selected by a user in the web application screen from the user via the operation part <b>114</b> and the operation control part <b>401</b>. The process is branched depending on the selected function in step S<b>1703</b>.</p>
<p id="p-0173" num="0188">First, a case where &#x201c;document link&#x201d; has been selected will be described.</p>
<p id="p-0174" num="0189">In step S<b>1704</b>, the web browser <b>406</b> provides a GET request to a URL indicated by the selected link via the communication control part <b>402</b> and the communication unit <b>115</b>, and obtains and preserves document data together with a Session ID.</p>
<p id="p-0175" num="0190">Here, the web application server <b>120</b> outputs and preserves a log indicating the GET request of the document. The log includes user account information of a user having logged in to the web application server <b>120</b>, a Session ID of a session accessed by the user, and the URL of the obtained document data.</p>
<p id="p-0176" num="0191">Next, in step S<b>1705</b>, the web browser <b>406</b> displays a screen for selecting the function of the web browser <b>406</b> as shown in <figref idref="DRAWINGS">FIG. 15</figref> on the operation part <b>119</b> via the operation control part <b>401</b>.</p>
<p id="p-0177" num="0192">Next, in step S<b>1706</b>, the web browser <b>406</b> receives a selected function. The process is branched depending on the selected function in step S<b>1707</b>.</p>
<p id="p-0178" num="0193">Next, the succeeding processing will be described when a print function has been selected in step S<b>1706</b>.</p>
<p id="p-0179" num="0194">In step S<b>1708</b>, the web browser <b>406</b> obtains the currently preserved Session ID and the linked URI of the document. At the same time, the web browser <b>406</b> obtains the authentication information of the user currently logged in to the image forming apparatus <b>110</b> from the authentication information management part <b>409</b>.</p>
<p id="p-0180" num="0195">Next, in step S<b>1709</b>, the web browser <b>406</b> searches the user account information management part <b>410</b> for user account information using the authentication information obtained from the authentication information management part <b>409</b> as a key, and obtains the user account information and the URI. Then, the web browser <b>406</b> retains the user account information when the URI on the web application screen and the obtained URI are completely identical.</p>
<p id="p-0181" num="0196">When completely identical URI does not exist, the web browser <b>406</b> obtains a URI having the latest update date and time, compares the obtained URI with URI host information on the web application screen, and retains the user account information if they are identical.</p>
<p id="p-0182" num="0197">When the user account information is not retained as a result, the same processing as that in the first flow is carried out from here.</p>
<p id="p-0183" num="0198">In step S<b>1710</b>, the web browser <b>406</b> sets the following information to the print job attribute and instructs the device control part <b>403</b> to generate and execute a print job.
<ul id="ul0009" list-style="none">
    <li id="ul0009-0001" num="0000">
    <ul id="ul0010" list-style="none">
        <li id="ul0010-0001" num="0199">Application ID: application ID of the web browser <b>406</b></li>
        <li id="ul0010-0002" num="0200">User name: remote user name obtained from the user account information management part <b>410</b></li>
        <li id="ul0010-0003" num="0201">Key: Session ID information</li>
        <li id="ul0010-0004" num="0202">Key: URI of the document</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0184" num="0203">The device control part <b>403</b> provides an instruction of print job generation and printing via the printer control part <b>405</b>. The printer control part <b>405</b> monitors the situation of the printing in the printer <b>112</b> and notifies the device control part <b>403</b> when having detected completion of the printing in step S<b>1711</b>.</p>
<p id="p-0185" num="0204">In step S<b>1712</b>, the device control part <b>403</b> notifies the log output management part <b>407</b> of the attribute information of the completed print job. The log output management part <b>407</b> carries out job log outputting of the print job in response to the received notification.</p>
<p id="p-0186" num="0205">Then, when the execution of these functions has been completed, the device control part <b>403</b> notifies the web browser <b>406</b> of the completion of the printing.</p>
<p id="p-0187" num="0206">In step S<b>1713</b>, the web browser <b>406</b> closes the function selection screen <b>1501</b> displayed on the operation part <b>114</b> via the operation control part <b>401</b> and displays the web application screen again.</p>
<p id="p-0188" num="0207">Next, a case where a display function has been selected in step S<b>1706</b> will be described.</p>
<p id="p-0189" num="0208">In step S<b>1714</b>, the web browser <b>406</b> obtains the currently preserved Session ID and the linked URI of a document. At the same time, the web browser <b>406</b> obtains authentication information of the user who has currently logged in to the image forming apparatus <b>110</b> from the authentication information management part <b>409</b>.</p>
<p id="p-0190" num="0209">Next, in step S<b>1715</b>, the web browser <b>406</b> searches the user account information management part <b>410</b> for user account information using the authentication information obtained from the authentication information management part <b>409</b> as a key, and obtains the user account information and the URI. Then, the web browser <b>406</b> retains the user account information when the URI on the web application screen and the obtained URI are completely identical.</p>
<p id="p-0191" num="0210">When completely identical URI does not exist, the web browser <b>406</b> obtains a URI having the latest update date and time, compares the obtained URI with URI host information on the web application screen, and retains the user account information if they are identical.</p>
<p id="p-0192" num="0211">When the user account information is not retained as a result, the same processing as that in the first flow is carried out from here.</p>
<p id="p-0193" num="0212">In step S<b>1716</b>, the web browser <b>406</b> displays a preview of the obtained document on the operation part <b>114</b> or the display part (not shown in the drawing).</p>
<p id="p-0194" num="0213">In step S<b>1717</b>, the web browser <b>406</b> transfers the following information to the log output management part <b>407</b> and generates a job log.
<ul id="ul0011" list-style="none">
    <li id="ul0011-0001" num="0000">
    <ul id="ul0012" list-style="none">
        <li id="ul0012-0001" num="0214">Application ID: application ID of the web browser <b>406</b></li>
        <li id="ul0012-0002" num="0215">User name: remote user name obtained from the user account information management part <b>410</b></li>
        <li id="ul0012-0003" num="0216">Function name: display</li>
        <li id="ul0012-0004" num="0217">Key: Session ID information</li>
        <li id="ul0012-0005" num="0218">Key: URI of the document</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0195" num="0219">Next, when the user has closed a screen displaying the preview via the operation part <b>114</b> in step S<b>1718</b>, the operation control part <b>401</b> detects it and the web browser <b>406</b> displays the web application screen again in step S<b>1713</b>.</p>
<p id="p-0196" num="0220">Next, a case where &#x201c;upload&#x201d; is a function selected in step S<b>1702</b> will be described.</p>
<p id="p-0197" num="0221">In step S<b>1719</b>, the web browser <b>406</b> displays the scan setting screen (not shown in the drawing) on the operation part <b>114</b> via the operation control part <b>401</b>.</p>
<p id="p-0198" num="0222">The scan setting screen can set scan operation behavior (e.g., setting of both-side reading, color/monochrome reading, etc.). Then, in step S<b>1720</b>, the web browser <b>406</b> receives a scan execution request of the user from the operation part <b>114</b> via the operation control part <b>401</b>.</p>
<p id="p-0199" num="0223">In step S<b>1721</b>, the web browser <b>406</b> obtains the currently preserved Session ID and the URL of upload destination of the document. At the same time, the web browser <b>406</b> obtains the authentication information of the user currently having logged in to the image forming apparatus <b>110</b> from the authentication information management part <b>409</b>.</p>
<p id="p-0200" num="0224">Next, in step S<b>1722</b>, the web browser <b>406</b> searches the user account information management part <b>410</b> for user account information using the authentication information obtained from the authentication information management part <b>409</b> as a key, and obtains the user account information and the URI. Then, the web browser <b>406</b> retains the user account information when the URI on the web application screen and the obtained URI are completely identical.</p>
<p id="p-0201" num="0225">When completely identical URI does not exist, the web browser <b>406</b> obtains a URI having the latest update date and time, compares the obtained URI with URI host information on the web application screen, and retains the user account information if they are identical.</p>
<p id="p-0202" num="0226">When the user account information is not retained as a result, the same processing as that in the first flow is carried out from here.</p>
<p id="p-0203" num="0227">In step S<b>1723</b>, the web browser <b>406</b> sets the attribute set on the above scan setting screen and the following information to the scan job attribute and instructs the device control part <b>403</b> to generate and execute a scan job.
<ul id="ul0013" list-style="none">
    <li id="ul0013-0001" num="0000">
    <ul id="ul0014" list-style="none">
        <li id="ul0014-0001" num="0228">Application ID: application ID of the web browser</li>
        <li id="ul0014-0002" num="0229">User name: remote user name obtained from the user account information management part <b>410</b></li>
        <li id="ul0014-0003" num="0230">Key: Session ID information</li>
        <li id="ul0014-0004" num="0231">Key: URI of the upload destination</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0204" num="0232">The device control part <b>403</b> provides an instruction of generating the scan job and reading via the scanner control part <b>404</b>. The scanner control part <b>404</b> monitors the situation of the reading by the scanner <b>113</b> and notifies the device control part <b>403</b> when detecting the completion of the reading in step S<b>1724</b>.</p>
<p id="p-0205" num="0233">In step S<b>1725</b>, the device control part <b>403</b> notifies the log output management part <b>407</b> of the attribute information of the completed scan job and carries out job log outputting of the scan job.</p>
<p id="p-0206" num="0234">Then, when the execution of these functions has been completed, the device control part <b>403</b> notifies the web browser <b>406</b> of the completion of the scanning.</p>
<p id="p-0207" num="0235">In step S<b>1726</b>, the web browser <b>406</b> POSTs electronic data of the document generated by the scanning to the URI of specified upload destination via the communication control part <b>402</b> and receives a POST response.</p>
<p id="p-0208" num="0236">Here, the web application server <b>120</b> outputs and preserves a log indicating that the document has been uploaded. The log includes user account information of the user having logged in to the web application server <b>120</b>, the Session ID, and the URL of the uploaded document data.</p>
<p id="p-0209" num="0237">Next, in step S<b>1727</b>, the web browser <b>406</b> displays a response screen received in the POST response on the operation part <b>114</b> via the operation control part <b>401</b>.</p>
<p id="p-0210" num="0238">By the above processing, the image forming apparatus <b>110</b> can output the same information as the user name and the Session ID, which are managed by the web application server <b>120</b>, in the job log after the utilization of the function in the web browser <b>406</b>.</p>
<p id="p-0211" num="0239">Accordingly, it is possible to obtain an operation log of a certain user as a whole by searching the job logs retained in the web application server and the image forming apparatus, respectively, using the remote user name of the web application server. As a result, it is possible to realize high search capability and readability for an audit trail.</p>
<p id="h-0022" num="0000">(Other Embodiments)</p>
<p id="p-0212" num="0240">Aspects of the present invention can also be realized by a computer of a system or apparatus (or devices such as a CPU or MPU) that reads out and executes a program recorded on a memory device to perform the functions of the above-described embodiment(s), and by a method, the steps of which are performed by a computer of a system or apparatus by, for example, reading out and executing a program recorded on a memory device to perform the functions of the above-described embodiment(s). For this purpose, the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device (e.g., computer-readable medium).</p>
<p id="p-0213" num="0241">While the present invention has been described with reference to exemplary embodiments, it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structure and functions.</p>
<p id="p-0214" num="0242">This application claims the benefit of Japanese Patent Application No. 2008-302846, filed Nov. 27, 2008, which is hereby incorporated by reference herein in its entirety.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A system comprising a server and an image forming apparatus having a web browser, wherein
<claim-text>the image forming apparatus performs first authentication processing in a case where an execution request of an authentication function is made from a local user who intends to log in to the image forming apparatus;</claim-text>
<claim-text>the image forming apparatus displays a screen of the web browser in a case where the first authentication processing has succeeded;</claim-text>
<claim-text>the web browser requests the server to perform second authentication processing in a case where an execution request of an authentication function is made from a remote user who intends to log in to the server;</claim-text>
<claim-text>the server performs the second authentication processing of the remote user upon receipt of the request from the web browser and generates and transfers, in a case where the second authentication processing has succeeded, a Session ID which is session unique information;</claim-text>
<claim-text>the web browser receives, upon generation of the Session ID, the generated Session ID from the server and displays a screen including link information for a document;</claim-text>
<claim-text>accessing, on the web browser, the server using the link information in a case where the remote user has selected the link information;</claim-text>
<claim-text>the server transfers a document corresponding to the link information and stores user account information of a remote user, the Session ID, and the link information as a log;</claim-text>
<claim-text>the web browser receives the document from the server;</claim-text>
<claim-text>the web browser obtains a local user name of a user currently having logged in to the image forming apparatus from the image forming apparatus, and transfers the document, the link information, the Session ID and the local user name to the image forming apparatus in a case where a printing instruction for the document is given to the web browser; and</claim-text>
<claim-text>the image forming apparatus prints the document, and stores a log that contains the local user name, the Session ID and the link information associated with each other.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. A control method for a system comprising a server and an image forming apparatus having a web browser, the control method comprising the steps of:
<claim-text>performing first authentication processing, in the image forming apparatus, in a case where an execution request of an authentication function is made from a local user who intends to log in to the image forming apparatus;</claim-text>
<claim-text>displaying a screen of the web browser, in the image forming apparatus, in a case where the first authentication processing has succeeded;</claim-text>
<claim-text>requesting the server to perform second authentication processing, from the web browser, in a case where an execution request of an authentication function is made from a remote user who intends to log in to the server;</claim-text>
<claim-text>performing, on the server, the second authentication processing of the remote user upon receipt of the request from the web browser and generating and transferring in a case where the second authentication processing has succeeded, a Session ID which is session unique information;</claim-text>
<claim-text>receiving, on the web browser, the generated Session ID from the server and displaying a screen including link information for a document;</claim-text>
<claim-text>accessing on the web browser, the server using the link information in a case where the remote user has selected the link information;</claim-text>
<claim-text>transferring, on the server, a document corresponding to the link information and storing user account information of the remote user, the Session ID, and the link information as a log;</claim-text>
<claim-text>receiving, on the web browser, the document from the server;</claim-text>
<claim-text>obtaining, on the web browser, a local user name of a user currently having logged in to the image forming apparatus from the image forming apparatus, and transferring the document, the link information, the Session ID and the local user name to the image forming apparatus in a case where a printing instruction for the document is given to the web browser; and</claim-text>
<claim-text>the image forming apparatus printing the document and storing a log that contains the local user name, the Session ID and the link information associated with each other. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
