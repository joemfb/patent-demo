<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08627131-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08627131</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13283472</doc-number>
<date>20111027</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<us-term-extension>138</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20130101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>21</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>713330</main-classification>
<further-classification>713150</further-classification>
</classification-national>
<invention-title id="d2e53">Hardware countermeasure against cryptographic attack</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6748410</doc-number>
<kind>B1</kind>
<name>Gressel et al.</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>708491</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2012/0124669</doc-number>
<kind>A1</kind>
<name>Carpenter et al.</name>
<date>20120500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 25</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>EP</country>
<doc-number>1571529</doc-number>
<kind>A2</kind>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>FR</country>
<doc-number>2863746</doc-number>
<kind>A1</kind>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>WO</country>
<doc-number>9963696</doc-number>
<kind>A1</kind>
<date>19991200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>WO</country>
<doc-number>03025715</doc-number>
<kind>A1</kind>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00007">
<othercit>Pramstaller, Norbert, et al. &#x201c;Towards an AES crypto-chip resistant to differential power analysis.&#x201d; Solid-State Circuits Conference, 2004. ESSCIRC 2004. Proceeding of the 30th European. IEEE, 2004.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00008">
<othercit>Extended European Search Report mailed Jan. 18, 2013, in corresponding European patent application No. 12152533.1.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00009">
<othercit>Najeh, Kamoun et al.; &#x201c;Correlated power noise generator as a low cost DPA countermeasures to secure hardware AES cipher&#x201d;, Signals, Circuits and Systems (SCS), 2009 3rd International Conference on, IEEE, Piscataway, NJ, USA, Nov. 6, 2009, pp. 1-6, XP031627510, DOI: 10.1109/ICSCS.2009.5413884 ISBN:978-1-4244-4397-0.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00010">
<othercit>Jean-Jacques Quisquater et al.; &#x201c;ElectroMagnetic Analysis (EMA): Measures and Counter-measures for Smart Cards&#x201d;, In: &#x201c;Smart Card programming and Security&#x201d;, Jan. 1, 2001, Springer Berlin Heidelberg, Berlin, Heidelberg, XP055031642, ISBN: 978-3-54-042610-3 vol. 2140, pp. 200-210, DOI: 10.1007/3-540-45418-7-17.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>12</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>713150</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713330</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>10</number-of-drawing-sheets>
<number-of-figures>12</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20130111204</doc-number>
<kind>A1</kind>
<date>20130502</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Gunnam</last-name>
<first-name>Kiran Kumar</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Gunnam</last-name>
<first-name>Kiran Kumar</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Novak Druce Connolly Bove + Quigg LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Certicom Corp.</orgname>
<role>03</role>
<address>
<city>Mississauga</city>
<country>CA</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Zand</last-name>
<first-name>Kambiz</first-name>
<department>2434</department>
</primary-examiner>
<assistant-examiner>
<last-name>Guirguis</last-name>
<first-name>Michael</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A hardware countermeasure for a cryptographic hardware module of a computing device is provided. The hardware countermeasure may include a noise-sample generator and a distributed buffer network co-located with the cryptographic module. The noise-sample generator may take as input data samples to be processed by the cryptographic hardware module and generate as output a non-Gaussian noise-sample for each of the input data samples. The distributed buffer network may take as input the non-Gaussian noise-samples and generate a non-Gaussian noise output corresponding to each of the non-Gaussian noise-samples.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="106.17mm" wi="118.11mm" file="US08627131-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="210.23mm" wi="180.09mm" orientation="landscape" file="US08627131-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="228.09mm" wi="128.19mm" orientation="landscape" file="US08627131-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="233.26mm" wi="126.92mm" orientation="landscape" file="US08627131-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="123.02mm" wi="126.92mm" file="US08627131-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="244.18mm" wi="184.15mm" orientation="landscape" file="US08627131-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="242.91mm" wi="167.22mm" orientation="landscape" file="US08627131-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="237.74mm" wi="173.65mm" orientation="landscape" file="US08627131-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="237.07mm" wi="169.84mm" orientation="landscape" file="US08627131-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="107.95mm" wi="100.25mm" orientation="landscape" file="US08627131-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="168.57mm" wi="147.40mm" orientation="landscape" file="US08627131-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD</heading>
<p id="p-0002" num="0001">The present application generally relates to security and, in particular, to a hardware countermeasure for improving resistance of a computing device to physical cryptographic attacks.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">Physical cryptographic attacks exploit implementation-specific characteristics of a computing device to provide additional information that may be used to assist in obtaining the secret parameters used by the computing device in cryptographic operations.</p>
<p id="p-0004" num="0003">Generally, physical cryptographic attacks may be categorized into three broad categories: invasive attacks, semi-invasive attacks and non-invasive attacks. Invasive attacks, such as de-packaging the computing device to allow for direct probing of device operations, may be resisted by constructing tamper-resistant hardware with sensors to detect the invasive attack. Semi-invasive attacks, such as using laser or ionized beams to induce faults in the device operations, may be resisted by including fault propagation in the circuits of the device to amplify the induced fault or by including consistency checking of results to detect and correct the induced faults. Non-invasive attacks typically use externally available physical measurements of the computing device while performing cryptographic operations to provide additional information that may be used to break an otherwise secure cryptographic operation.</p>
<p id="p-0005" num="0004">Non-invasive attacks that are passive, ie pure measurement without interfering with device operations, are commonly known as &#x201c;side-channel&#x201d; attacks and pose particular challenges to computing device security. Side-channel attacks exploit the physical implementation of a cryptographic operation on a computing device, without taking any direct action on the operations of the computing device.</p>
<p id="p-0006" num="0005">It would be advantageous to provide for a hardware countermeasure that improves the resistance of a computing device to cryptographic attack.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0007" num="0006">Reference will now be made to the accompanying drawings which show embodiments of the present application, and in which:</p>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 1A</figref> shows, a traditional cryptographic model involving secure communications between correspondents over a communication channel;</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 1B</figref> shows, the cryptographic model of <figref idref="DRAWINGS">FIG. 1A</figref> including an eavesdropper or man-in-the-middle attack on the communication channel</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 1C</figref> shows, the cryptographic model of <figref idref="DRAWINGS">FIG. 1B</figref> including emanation of side-channel information from the correspondents;</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIGS. 2A and 2B</figref> illustrate prior art methods of generating noise using hardware.</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 3</figref> illustrates an embodiment of a hardware countermeasure.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIGS. 4A</figref>, <b>4</b>B and <b>4</b>C illustrate embodiments of a noise-sample generator for the hardware countermeasure of <figref idref="DRAWINGS">FIG. 3</figref>.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 5A</figref> illustrates an embodiment of a distributed buffer network.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 5B</figref> illustrates an embodiment of a noise buffer.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 6</figref> illustrates an embodiment of a hardware countermeasure for a cryptographic hardware module.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0017" num="0016">Similar reference numerals may have been used in different figures to denote similar components.</p>
<heading id="h-0004" level="1">DESCRIPTION OF EMBODIMENTS</heading>
<p id="p-0018" num="0017">In an embodiment, a hardware countermeasure for a cryptographic hardware module of a computing device is provided. The hardware countermeasure may comprise a noise-sample generator, wherein the noise-sample generator is operable to accept as input data samples to be processed by the cryptographic hardware module and to generate as output a noise-sample for each of the input data samples, and wherein the noise-sample associated with a power level; and a distributed buffer network co-located with the cryptographic module, wherein the distributed buffer network is operable to accept as input the noise-samples and to emit, for each of the noise-samples, a noise output proportional in power to the power level associated with that noise-sample.</p>
<p id="p-0019" num="0018">In an aspect, the distributed buffer network may comprise a plurality of buffers, and wherein each of the plurality of buffers is connected with a corresponding capacitive load. At least one of the plurality of buffers and the corresponding capacitive load(s) may be located adjacent to an input register of the cryptographic hardware module. At least one of the plurality of buffers and the corresponding capacitive load(s) may be located adjacent to a hardware block of the cryptographic module that performs a masking operation. The masking operation may comprise either the application of a random mask to an input data sample for operation by a cryptographic operation or the removal of a random mask from an output data sample operated on by the cryptographic operation. In an aspect, at least one of the plurality of buffers and the corresponding capacitive load(s) may be located adjacent to a hardware block of the cryptographic module that performs a mask modification operation to update a mask of a masking operation.</p>
<p id="p-0020" num="0019">In an aspect, the distributed buffer network may be constructed with a standard CMOS structure and co-located with at least one cryptographic logic hardware block of the cryptographic hardware module.</p>
<p id="p-0021" num="0020">In an aspect, the noise-sample may comprise a binary number and each bit of the binary number corresponds to one or more buffers of the distributed buffer network. The distributed buffer network may be operable to emit the noise output by activating the one or more buffers that correspond to each bit of the binary number. The one or more buffers may comprise an increasing number of buffers corresponding to a significance of the each bit.</p>
<p id="p-0022" num="0021">In an aspect, the noise-samples output by the noise-sample output generator may comprise non-Gaussian noise-samples.</p>
<p id="p-0023" num="0022">In an aspect, the distributed buffer network may comprise a plurality of buffer blocks, each of the plurality of buffer blocks comprising at least one buffer, and the distributed buffer network is operable to emit the noise output by activating a combination of the plurality of buffer blocks corresponding to each of the noise-samples. Each of the plurality of buffer blocks may comprise a different number of buffers. Each of the plurality of buffer blocks may dissipate a different noise power level. The noise-sample may comprise a binary number and each bit of the binary number corresponds to a one of the plurality of buffer blocks.</p>
<p id="p-0024" num="0023">Embodiments of the hardware countermeasure as described above may comprise part of a computing device. In an aspect, the computing device may comprise a mobile communications device.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 1A</figref> illustrates a traditional cryptographic model <b>2</b> involving secure communications between a sending correspondent <b>10</b> and a receiving correspondent <b>20</b> over a communication channel <b>8</b>. In the model <b>2</b>, a message M <b>5</b> is taken as input <b>7</b> by the sending correspondent <b>10</b>. The sending correspondent <b>10</b> applies an encrypting cryptographic operation <b>12</b> that includes an encryption key K<sub>E </sub><b>14</b> as a private (secret) value. The encrypted message M<sub>E </sub><b>6</b> may be communicated securely over an open communication channel <b>8</b> to the receiving correspondent <b>20</b>. The receiving correspondent <b>20</b> may apply a decrypting cryptographic operation <b>22</b> that includes a decryption key K<sub>D </sub><b>24</b> to recover the M <b>5</b> as output <b>9</b>.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 1B</figref> illustrates the traditional cryptographic model <b>2</b> of <figref idref="DRAWINGS">FIG. 1A</figref>, further including an eavesdropper <b>30</b> that may intercept the encrypted message M<sub>E </sub><b>6</b> as it is transmitted over the communication channel <b>8</b>. The potential success of an interception attack of this type may typically be predicted from the theoretical strength of the encrypting cryptographic operation <b>12</b> being employed.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 1C</figref> illustrates the model of <figref idref="DRAWINGS">FIG. 1B</figref> and further including side-channel information <b>25</b> that is physically emanating from the sending computing device <b>14</b> and the receiving computing device <b>24</b>. Generally, for a cryptographic operation, the side-channel information <b>25</b> will be correlated to sub-steps of the cryptographic operation. An attacker may collect the side-channel information <b>25</b> and, in combination with an understanding of the underlying cryptographic process, may apply statistical methods to the side-channel information <b>25</b> to break the cryptographic process.</p>
<p id="p-0028" num="0027">A common side-channel attack includes measuring the electric field generated by the computing device when values are stored in registers of the computing device. These measurements provide timing information, as well as providing some information regarding the size of a value and whether a value has changed between operations or for repeated calculations using the same input value.</p>
<p id="p-0029" num="0028">One approach to resist such an attack has been to add random power dissipation to the computing device by executing arbitrary computations in parallel to the cryptographic operations. Referring to <figref idref="DRAWINGS">FIG. 2A</figref>, a cryptographic operation <b>26</b> may generate side-channel information. The side-channel information may be masked by a noise source, such as a Linear Feedback Shift Register (LFSR), that generates a random number each clock cycle. In <figref idref="DRAWINGS">FIG. 2A</figref>, a noise register <b>28</b> is connected to a pseudo-random number generator <b>29</b> that supplies a random number each clock cycle. The generated random number emanates its own signal, the power of which is determined by the size of the register <b>28</b> (ie the number of bits in the number) and the operation of the pseudo-random number generator <b>29</b>, such as the switching of components like XOR gates.</p>
<p id="p-0030" num="0029">An alternate approach to a noise additive circuit <b>30</b> is illustrated in <figref idref="DRAWINGS">FIG. 2B</figref>. In <figref idref="DRAWINGS">FIG. 2B</figref>, the noise additive circuit <b>30</b> comprises one or more dummy operations <b>36</b> that operate in parallel to the cryptographic operation <b>34</b>. As illustrated, an input value <b>31</b> may be stored in a register <b>32</b> and delivered to both the cryptographic operations <b>34</b> and the dummy operations <b>36</b>. Only the output <b>35</b> from the cryptographic operations <b>34</b> is passed on for further processing by the computing device. The dummy operations <b>36</b> are preferably unrelated to the input data <b>31</b> or any cryptographic keys used in the cryptographic operations <b>34</b>, but may be physically close to the cryptographic operations <b>34</b>. The one or more dummy operations <b>36</b>, preferably generate random background noise, rather than a repetitive signal that may be filtered out by an attacker. The power of the noise signal is dependent upon a number of dummy operations <b>36</b> and a size of any numbers stored in registers that form part of the dummy operations <b>36</b>.</p>
<p id="p-0031" num="0030">A further approach (not shown) is to employ a ring oscillator whose output randomly oscillates between two voltage levels (e.g. TRUE and FALSE). A potential limitation of the ring oscillator is that the power dissipation is a related to the frequency of the oscillation. Effectively, where a ring oscillator is oscillating at the clock speed of the board, the power dissipation is a fixed value. The level of power can be increased by either increasing the number of ring oscillators, or increasing the oscillation frequency of the ring oscillator.</p>
<p id="p-0032" num="0031">Generally, the above approaches all generate Additive White Gaussian Noise (AWGN). All processes being executed on a computing device generate a signal. An attacker can isolate the signal emitted by cryptographic operations by locating a capture antenna physically closest to the cryptographic operations, and/or by applying signal processing techniques to the captured signal to enhance the cryptographic signal and suppress the background or control operation signal. These signal processing techniques can typically be applied to suppress AWGN noise signals, for instance by collecting a number of sample measurements from the computing device. Over time, and a sufficient number of sample measurements, the AWGN signal will tend to average to a constant (positive value, negative value or zero) regardless of a number of sample measurements collected or a time of collection. For instance, for AWGN noise, an average m<sub>1 </sub>for 1000 collected samples may have a value of c and an average m<sub>2 </sub>for 2000 collected samples also has the value c.</p>
<p id="p-0033" num="0032">AWGN sources are an imperfect solution for countering side channel analysis attacks, and require that the power dissipated be high enough to cover the underlying cryptographic operations. The above methods generally provide either a limited power dissipation level, and/or are not constructed of standard CMOS architecture.</p>
<p id="p-0034" num="0033">In an embodiment of a hardware implementation, referring to <figref idref="DRAWINGS">FIG. 3</figref>, a hardware countermeasure is provided that improves the resistance of a computing device, such as a hardware cryptographic module, to side channel attack. In the embodiment of <figref idref="DRAWINGS">FIG. 3</figref>, an entropy source <b>38</b>, such as a pseudo-random number generator, generates random values.</p>
<p id="p-0035" num="0034">The random values and data samples <b>37</b> to be processed by the cryptographic hardware module are input to a noise-sample generator <b>40</b>. The noise-sample generator <b>40</b> accepts as input the random values, shown as being generated from an entropy source <b>38</b>, and the data samples <b>37</b>, and generates as output, a noise-sample for each input data sample. The noise-sample being associated with a power level of a noise output to be emitted by the hardware countermeasure.</p>
<p id="p-0036" num="0035">In an aspect, the series of noise-samples may comprise non-Gaussian noise-samples. For non-AWGN signals, an average computed from collected samples will change over time, based on a number of measurements and a time of collecting the samples. For instance, for non-AWGN noise, an average n<sub>1 </sub>for 1000 collected samples may have a value of c<sub>1 </sub>and an average n<sub>2 </sub>for 2000 collected samples has the value c<sub>2</sub>, where c<sub>1 </sub>!=c<sub>2</sub>. Typically, a magnitude of each of c<sub>1 </sub>and c<sub>2</sub>, are larger than a magnitude of c.</p>
<p id="p-0037" num="0036">The noise-samples from the noise-sample generator <b>40</b> are used to drive a distributed buffer network <b>52</b> that generates a noise output proportional in emitted power to a power level associated with each input noise-sample. The entropy source <b>38</b> and noise-sample generator <b>40</b> may be physically located elsewhere on the computing device, but the distributed buffer network <b>52</b> is preferably co-located with the hardware cryptographic module and most preferably co-located with any sensitive operations to be performed by the hardware cryptographic module, such as a hardware masking or de-masking operation.</p>
<p id="p-0038" num="0037">Referring to <figref idref="DRAWINGS">FIG. 4A</figref>, an embodiment of a noise-sample generator <b>40</b> for supplying noise-samples in an embodiment of a hardware countermeasure is illustrated. In the embodiment, a sample input <b>41</b>, such as a data sample being input into a cryptographic module, is preferably masked <b>43</b> with a sample from a random data sequence &#x3b3;(t) <b>42</b>. The random data sequence &#x3b3;(t) <b>42</b>, may be generated from an entropy source <b>38</b>, as illustrated in <figref idref="DRAWINGS">FIG. 3</figref>. The sample input <b>41</b> may comprise, for instance, a parallel output from an input register to the cryptographic module. The masking operation <b>43</b> may be considered to occur before (as illustrated) or as part of the noise-sample generator <b>40</b>. The masked sample input <b>44</b> may then be operated upon by the noise-sample generator <b>40</b> to generate a noise-sample output <b>50</b>. The noise-sample output <b>50</b> being associated with a noise output power level to be emitted by the hardware countermeasure. The noise-sample generator may comprise, for instance a digital filter having one or more coefficients.</p>
<p id="p-0039" num="0038">In the embodiment of <figref idref="DRAWINGS">FIG. 4B</figref>, the masked sample input <b>44</b> may first be operated on by a difference operation <b>45</b>, generating a difference <b>46</b> between a current sample and previous sample. The difference operation <b>45</b> is optional in an embodiment of the noise-sample generator <b>40</b>. The difference <b>46</b> may then be input into a filter operation h(t) <b>47</b> to generate a filtered sample <b>48</b>. The filtered sample <b>48</b> may optionally be further operated on by a masking operation <b>51</b>, shown as an additive masking operation in <figref idref="DRAWINGS">FIG. 4</figref>, by combination with a sample from a random data masking sequence &#x3b7;(t) <b>52</b>.</p>
<p id="p-0040" num="0039">The embodiment of <figref idref="DRAWINGS">FIG. 4B</figref> illustrates an optional arrangement, where the difference <b>46</b> may be further operated in parallel by a plurality of filter operations h(t) <b>47</b>, h<sub>&#x3b1;</sub>(t) <b>57</b> and h<sub>&#x3b2;</sub>(t) <b>58</b>. In the embodiment of <figref idref="DRAWINGS">FIG. 4B</figref>, the difference <b>46</b> may be split between the plurality of filter operations h(t) <b>47</b>, h<sub>&#x3b1;</sub>(t) <b>57</b> and h<sub>&#x3b2;</sub>(t) <b>58</b>, filtered and combined, for instance through an additive operation <b>51</b><i>b</i>, to generate a combined filtered sample <b>49</b> that may be masked in masking operation <b>51</b> with the random data masking sequence &#x3b7;(t) <b>52</b>.</p>
<p id="p-0041" num="0040">The difference <b>46</b> may be masked in a masking operation before input to one or more of the filter operations h(t) <b>47</b>, h<sub>&#x3b1;</sub>(t) <b>57</b> and h<sub>&#x3b2;</sub>(t) <b>58</b>. In the embodiment illustrated in <figref idref="DRAWINGS">FIG. 4B</figref>, the difference <b>46</b> may be masked with filter masking operations <b>55</b>, <b>56</b> before some of the plurality of filter operations h<sub>&#x3b1;</sub>(t) <b>57</b> and h<sub>&#x3b2;&#x3b2;</sub>(t) <b>58</b> to avoid operating on the same input in each of the plurality of filter operations h(t) <b>47</b>, h<sub>&#x3b1;</sub>(t) <b>57</b> and h<sub>&#x3b2;</sub>(t) <b>58</b>. In the embodiment illustrated in <figref idref="DRAWINGS">FIG. 4B</figref>, each of the filter masking operations <b>55</b>, <b>56</b> comprise an XOR operation, combining the difference <b>46</b> with a sample from a random data sequence &#x3b1;(t) <b>53</b>, &#x3b2;(t) <b>54</b>.</p>
<p id="p-0042" num="0041">The filter operations h(t) <b>47</b>, h<sub>&#x3b1;</sub>(t) <b>57</b> and h<sub>&#x3b2;&#x3b2;</sub>(t) <b>58</b> may comprise, for instance, a Finite Impulse Response (FIR) filter. The filter coefficients may differ between each of the filter operations h(t) <b>47</b>, h<sub>&#x3b1;</sub>(t) <b>57</b> and h<sub>&#x3b2;</sub>(t) <b>58</b> and in an aspect are selected randomly or pseudo-randomly. In an embodiment, the filter coefficients may further be re-set after one or more cryptographic operations or &#x201c;execution traces&#x201d; performed by the cryptographic module. In an aspect, the filter coefficients may be determined by at least one look-up table containing pseudo random data that has been selected for optimum filter operations according to known signal processing techniques. In the aspect, the filter coefficients may be updated by selecting either a next set of filter coefficients, or a random set of filter coefficients from the at least one look-up table. The selection may occur either after a pre-selected number of cryptographic operations, or according to some other trigger criteria, such as after a random number of operations or a period of time.</p>
<p id="p-0043" num="0042">In an embodiment, for instance, the filters may employ a coefficient word length of about 6 bits and the filters may comprise 7<sup>th </sup>order filters having 8 coefficients, though other combinations of word lengths and filter order are contemplated and may be selected depending upon the application and level of complexity required.</p>
<p id="p-0044" num="0043">The outputs from the plurality of filter operations h(t) <b>47</b>, h<sub>&#x3b1;</sub>(t) <b>57</b> and h<sub>&#x3b2;</sub>(t) <b>58</b> may be combined, for instance through addition operations <b>51</b><i>b </i>to generate the combined filtered sample <b>49</b>. The combined filtered sample <b>49</b> may be combined in a masking operation <b>51</b> with the sample from the random data masking sequence &#x3b7;(t) <b>52</b> to generate the noise-sample output <b>50</b>.</p>
<p id="p-0045" num="0044">The embodiment of <figref idref="DRAWINGS">FIG. 4C</figref> illustrates an alternative optional arrangement, comprising three filter operations h(t,w) <b>47</b>&#x2032;, h<sub>t </sub>(t) <b>57</b>&#x2032; the first order partial derivative of h(t,w) <b>47</b>&#x2032; with respect to t, and h<sub>w</sub>(t) <b>58</b>&#x2032; the first order partial derivative of h(t,w) <b>47</b>&#x2032; with respect to w. In the embodiment, the three filter operations h(t,w) <b>47</b>&#x2032;, h<sub>t</sub>(t) <b>57</b>&#x2032;, and h<sub>w</sub>(t) <b>58</b>&#x2032; generate a non-Gaussian noise-sample output <b>50</b>&#x2032;. While the noise-sample generator <b>40</b> accepts as input a sample input <b>41</b>, the non-Gaussian noise-sample output <b>50</b>&#x2032; preferably is not correlated to the sample input <b>41</b>.</p>
<p id="p-0046" num="0045">The noise-sample output <b>50</b>, or non-Gaussian noise-sample output <b>50</b>&#x2032;, may comprise, for instance, a binary number that is received as input by a noise generation component such as a distributed buffer network <b>52</b>. The distributed buffer network <b>52</b> may take as input the noise-sample output <b>50</b>, or non-Gaussian noise-sample output <b>50</b>&#x2032;, from the noise-sample generator <b>40</b> and dissipate a noise output having a power level that corresponds to a value of the input noise-sample <b>50</b> <b>50</b>&#x2032;.</p>
<p id="p-0047" num="0046">Referring to <figref idref="DRAWINGS">FIG. 5A</figref>, in an embodiment, the noise-sample generator <b>40</b> may send noise-sample outputs to the distributed buffer network <b>52</b>, which may comprise a plurality of buffers <b>82</b>. Each of the plurality of buffers <b>82</b> may be connected with a corresponding capacitive load <b>83</b>. For each of the plurality of buffers <b>82</b>, the corresponding capacitive load <b>83</b> determined by a size of that buffer <b>82</b> and a required response time for the buffer <b>82</b> as dictated by a board speed of the hardware, as would be understood by a person skilled in the art. For each of the plurality of buffers <b>82</b>, a combination of a buffer <b>82</b> connected with the corresponding capacitive load <b>83</b> may dissipate a noise output having a magnitude determined by a size of the buffer <b>82</b> and the corresponding capacitive load <b>83</b>.</p>
<p id="p-0048" num="0047">In the embodiment of <figref idref="DRAWINGS">FIG. 5A</figref>, control logic <b>80</b> is operable to activate some of the n buffer blocks <b>84</b>, <b>85</b>, <b>86</b>, <b>87</b> in response to noise-samples received from the noise-sample generator <b>40</b>. Generally, each noise-sample corresponds to a noise output power level to be output by the buffer network <b>52</b>. Accordingly, each noise-sample corresponds to a number of buffers <b>82</b>, or combination of buffer blocks <b>84</b>, <b>85</b>, <b>86</b>, <b>87</b> to be activated by the distributed buffer network <b>52</b>.</p>
<p id="p-0049" num="0048">As illustrated in Table 1, by way of an embodiment below, the control logic <b>80</b> may activate different combinations of the buffer blocks <b>84</b>, <b>85</b>, <b>86</b> &#x26; <b>87</b>, where the i<sup>th </sup>bit of the noise-sample value controls a one of the buffer blocks <b>84</b>, <b>85</b>, <b>86</b> &#x26; <b>87</b> generating a noise power proportional to 2<sup>i</sup>.</p>
<p id="p-0050" num="0049">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="1" colwidth="84pt" align="center"/>
<colspec colname="2" colwidth="42pt" align="center"/>
<colspec colname="3" colwidth="49pt" align="left"/>
<colspec colname="4" colwidth="42pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="4" rowsep="1">TABLE 1</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry/>
<entry>Buffers</entry>
<entry/>
</row>
<row>
<entry>Noise-sample Value (0-15)</entry>
<entry>Binary Value</entry>
<entry>Activated</entry>
<entry>Power Level</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="1" colwidth="84pt" align="char" char="."/>
<colspec colname="2" colwidth="42pt" align="center"/>
<colspec colname="3" colwidth="49pt" align="left"/>
<colspec colname="4" colwidth="42pt" align="left"/>
<tbody valign="top">
<row>
<entry>0</entry>
<entry>0000</entry>
<entry>NULL</entry>
<entry>0</entry>
</row>
<row>
<entry>1</entry>
<entry>0001</entry>
<entry>84</entry>
<entry>1 * P<sub>ref</sub></entry>
</row>
<row>
<entry>2</entry>
<entry>0010</entry>
<entry>85</entry>
<entry>2 * P<sub>ref</sub></entry>
</row>
<row>
<entry>3</entry>
<entry>0011</entry>
<entry>86</entry>
<entry>3 * P<sub>ref</sub></entry>
</row>
<row>
<entry>4</entry>
<entry>0100</entry>
<entry>87</entry>
<entry>4 * P<sub>ref</sub></entry>
</row>
<row>
<entry>5</entry>
<entry>0101</entry>
<entry>84, 85</entry>
<entry>5 * P<sub>ref</sub></entry>
</row>
<row>
<entry>6</entry>
<entry>0110</entry>
<entry>84, 86</entry>
<entry>6 * P<sub>ref</sub></entry>
</row>
<row>
<entry>7</entry>
<entry>0111</entry>
<entry>84, 87</entry>
<entry>7 * P<sub>ref</sub></entry>
</row>
<row>
<entry>8</entry>
<entry>1000</entry>
<entry>85, 86</entry>
<entry>8 * P<sub>ref</sub></entry>
</row>
<row>
<entry>9</entry>
<entry>1001</entry>
<entry>85, 87</entry>
<entry>9 * P<sub>ref</sub></entry>
</row>
<row>
<entry>10</entry>
<entry>1010</entry>
<entry>86, 87</entry>
<entry>10 * P<sub>ref</sub></entry>
</row>
<row>
<entry>11</entry>
<entry>1011</entry>
<entry>84, 85, 86</entry>
<entry>11 * P<sub>ref</sub></entry>
</row>
<row>
<entry>12</entry>
<entry>1100</entry>
<entry>84, 85, 87</entry>
<entry>12 * P<sub>ref</sub></entry>
</row>
<row>
<entry>13</entry>
<entry>1101</entry>
<entry>84, 86, 87</entry>
<entry>13 * P<sub>ref</sub></entry>
</row>
<row>
<entry>14</entry>
<entry>1110</entry>
<entry>85, 86, 87</entry>
<entry>14 * P<sub>ref</sub></entry>
</row>
<row>
<entry>15</entry>
<entry>1111</entry>
<entry>84, 85, 86, 87</entry>
<entry>15 * P<sub>ref</sub></entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0051" num="0050">In the embodiment, each buffer <b>82</b> is assumed to be of a same buffer size. Accordingly, a noise power level dissipated by each buffer block <b>84</b>, <b>85</b>, <b>86</b> &#x26; <b>87</b> may be determined by multiplying a reference buffer power value P<sub>ref </sub>times a number of buffers <b>82</b> in that buffer block <b>84</b>, <b>85</b>, <b>86</b>, <b>87</b>. In an alternate embodiment, for instance, one or more of the buffers <b>82</b> may comprise buffers <b>82</b> of a different size, such that a buffer noise power level may vary according to a size of the one or more buffers <b>82</b>. As will be appreciated, a power of the buffer blocks <b>84</b>, <b>85</b>, <b>86</b>, <b>87</b> controlled by each bit of the noise-sample value is illustrated as an embodiment, and other combinations of bits and buffer blocks <b>84</b>, <b>85</b>, <b>86</b>, <b>87</b> for emitting noise are contemplated.</p>
<p id="p-0052" num="0051">The combinations illustrated in Table 1 provide different noise power levels, as well as differing locations of noise generation from the distributed buffer network <b>52</b>. In the embodiment shown in <figref idref="DRAWINGS">FIG. 5A</figref> and Table 1, four buffer blocks <b>84</b>, <b>85</b>, <b>86</b>, <b>87</b> may be activated by the control logic <b>80</b> in <b>16</b> different combinations illustrated in Table 1. While the embodiment shows n=4 buffer blocks <b>84</b>, <b>85</b>, <b>86</b>, <b>87</b> as each including 2&#x2033; buffers <b>82</b>, in other embodiments the buffer blocks may include different numbers of buffers <b>82</b>, including possibly some buffer blocks <b>84</b>, <b>85</b>, <b>86</b>, <b>87</b> having a same number of buffers <b>82</b>.</p>
<p id="p-0053" num="0052">Referring to <figref idref="DRAWINGS">FIG. 5B</figref>, in an embodiment, a buffer may comprise a tri-state buffer <b>88</b>. The tri-state buffer <b>88</b> accepts as input the noise-sample, or a corresponding bit of the noise-sample for that tri-state buffer <b>88</b>, through a control input <b>90</b>. The tri-state buffer <b>88</b> further comprises an enabling input <b>89</b> that may, for instance, take as input a timing signal to trigger activation of the tri-state buffer <b>88</b>. The timing signal may comprise, for instance, a clock signal clocked to the operations of the hardware module <b>60</b>. The clock signal enable the tri-state buffer <b>88</b> to activate at the same clock timing as the hardware operations to be masked by the distributed buffer network <b>52</b>. In an aspect, the clock signal may specifically comprise a local clock signal connected to hardware components adjacent to a corresponding buffer network <b>52</b>.</p>
<p id="p-0054" num="0053">Referring to <figref idref="DRAWINGS">FIG. 6</figref>, a hardware module <b>60</b>, such as a cryptographic hardware module, or a portion of a general hardware module that has been dedicated to secure operations such as cryptographic operations is illustrated.</p>
<p id="p-0055" num="0054">An input <b>61</b> to the hardware module <b>60</b> may comprise input data to be processed by the hardware module <b>60</b>. The input <b>61</b> may optionally be transferred to an input register <b>62</b> for temporary storage before the stored input <b>63</b> is operated on by an input cryptographic operation <b>66</b>, such as the masking operation illustrated in <figref idref="DRAWINGS">FIG. 6</figref>. An input mask <b>65</b> is shown as being applied during the input cryptographic operation <b>66</b>, which produces a masked input <b>67</b> that may be operated on by masked cryptographic operations <b>68</b>. A masked result <b>69</b> of the masked cryptographic operations <b>68</b> may be operated on by an output cryptographic operation <b>71</b>, such as the de-masking operation illustrated in <figref idref="DRAWINGS">FIG. 6</figref>. An output mask <b>70</b> is shown as being applied during the output cryptographic operation <b>71</b>, which produces the unmasked result <b>72</b> for transfer out of the hardware module <b>60</b>.</p>
<p id="p-0056" num="0055">As illustrated in <figref idref="DRAWINGS">FIG. 6</figref>, in an aspect at least one of the plurality of buffers <b>75</b>, and the corresponding capacitive load, may be located adjacent to a register within the cryptographic module, such as the input register <b>62</b> of the hardware module <b>60</b>. In an embodiment, at least one of the plurality of buffers, and the corresponding capacitive load, may be co-located with internal registers, not shown in <figref idref="DRAWINGS">FIG. 6</figref>, of the cryptographic module that receive input data samples that are to be operated on by the cryptographic module.</p>
<p id="p-0057" num="0056">For instance, in an encryption operation sensitive data is input into the cryptographic hardware module and, typically, stored in an input register <b>62</b> such as a sensitive data input register. The sensitive data input register <b>62</b> supplies the input sample for an initial cryptographic operation <b>66</b>, such as a masking operation. Since the sensitive data input may typically have been output from another component of the computing device to the sensitive data input register <b>62</b> of the cryptographic module <b>60</b>, it is possible for an attacker to localize and match the sensitive data input located in the other component with the sensitive data input located in the sensitive data input register <b>62</b>. In the embodiment described above, at least one of the plurality of buffers <b>75</b>, and the corresponding capacitive load, may be co-located with the sensitive data input register <b>62</b> such that the countermeasure is operable to protect values stored in the sensitive data input register <b>62</b> from side channel analysis. In an aspect, a plurality of buffers <b>75</b> from the distributed buffer network <b>75</b> may be co-located with the sensitive data input register <b>62</b>.</p>
<p id="p-0058" num="0057">Similarly, other data samples input to the hardware module <b>60</b> from the computing device, including data samples such as encrypted data, date/time, random data, etc., may be protected. In an embodiment, other registers within the hardware module <b>60</b> may be required to receive the input data for operation on by the hardware module <b>60</b>.</p>
<p id="p-0059" num="0058">Referring again to <figref idref="DRAWINGS">FIG. 6</figref>, in an embodiment, at least one of the plurality of buffers <b>76</b>, and the corresponding capacitive load, may be located adjacent to a hardware block of the hardware module <b>60</b> that performs a cryptographic operation <b>66</b>, such as the masking operation illustrated. For instance, the sensitive data input register <b>62</b> may supply an input value for operation in a masked cryptographic operation of the hardware module <b>60</b>. An initial cryptographic operation <b>66</b> may consist of masking the input value in order to execute the masked cryptographic operation. In the embodiment, at least one of the plurality of buffers <b>76</b>, and the corresponding capacitive load(s), may be located adjacent to the hardware components that perform the cryptographic operation <b>66</b>. Once the input data has been masked, a risk of side channel analysis being successful is greatly reduced, so co-locating the at least one of the plurality of buffers <b>76</b> with the cryptographic operation <b>66</b> allows for a minimum of power expenditure in countering the side channel analysis.</p>
<p id="p-0060" num="0059">Referring again to <figref idref="DRAWINGS">FIG. 6</figref>, in an aspect, at least one of the plurality of buffers <b>77</b>, and the corresponding capacitive load, may be located adjacent to a hardware block of the hardware module <b>60</b> that performs a subsequent cryptographic operation <b>71</b>, such as the de-masking operation illustrated. The subsequent cryptographic operation <b>71</b> may consist of the removal of a random mask from an output data sample <b>69</b> operated on by the masked cryptographic operation <b>68</b>. For instance, after execution of the masked cryptographic operation <b>68</b>, the hardware module <b>60</b> may remove the mask by applying a de-masking mask <b>70</b> in the subsequent cryptographic operation <b>71</b> to yield an unmasked result <b>72</b> of the masked cryptographic operation <b>68</b> (such as encrypted or decrypted data) for output from the hardware module <b>60</b> to the computing device. Co-locating the at least one of the plurality of buffers <b>77</b> with the de-masking operation protects against providing information about the mask that was used in the masked cryptographic operation <b>68</b>.</p>
<p id="p-0061" num="0060">In an embodiment, the at least one of the plurality of buffers and the corresponding capacitive load may be located adjacent to a mask modification hardware block of a hardware module <b>60</b> that performs a mask modification operation to update a mask of a masking operation. Co-locating the at least one of the plurality of buffers with the mask modification operation protects against providing information about the mask that was used in the masked cryptographic operation. The mask modification hardware block may in an aspect be located, for instance, proximate to the cryptographic operation <b>66</b>, shown as a masking operation, or the subsequent cryptographic operation <b>71</b>, shown as a de-masking operation. In an alternate aspect, the mask modification hardware block may be located at another location within the hardware module <b>60</b>.</p>
<p id="p-0062" num="0061">In an embodiment, the distributed buffer network may be built with a standard CMOS structure. Accordingly, the buffers and corresponding capacitive load may be formed using the same silicon process as the rest of the cryptographic hardware module and co-located with either data registers, or cryptographic logic hardware blocks of the cryptographic hardware module. For instance, a register block within the cryptographic hardware module may start with register bits that contain a data sample, and end with register bits that comprise one or more of the buffers of a distributed buffer network. The one or more of the buffers of the distributed buffer network may each be located adjacent to a corresponding capacitive load. Constructing the distributed buffer network with a standard CMOS structure may reduce cost, reduce the size of a cryptographic hardware module containing the hardware countermeasure and improve its resistance to side channel analysis.</p>
<p id="p-0063" num="0062">In an embodiment, the noise-sample generated by the noise-sample generator <b>40</b> may comprise a binary number. In an aspect, each bit of the binary number may control one or more buffers of the distributed buffer network. Accordingly, a power level of noise generated by the distributed buffer network may not increase linearly with a number of bits contained in each noise-sample. In an aspect, the bits may cause activation of the one or more buffers that correspond to that bit of the noise-sample.</p>
<p id="p-0064" num="0063">Certain adaptations and modifications of the described embodiments can be made. Therefore, the above discussed embodiments are considered to be illustrative and not restrictive.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A hardware countermeasure for a cryptographic hardware module of a computing device, the hardware countermeasure comprising:
<claim-text>a non-Gaussian noise-sample generator, wherein the noise-sample generator is operable to accept as input data samples to be processed by the cryptographic hardware module and to generate as output a non-Gaussian noise-sample for each of the input data samples, and wherein the non-Gaussian noise-sample is a binary number associated with a power level that corresponds to one or more buffers of the distributed buffer network; and,</claim-text>
<claim-text>a distributed buffer network co-located with the cryptographic module, wherein the distributed buffer network is operable to accept as input the non-Gaussian noise-samples and to emit, for each of the noise-samples, a noise output power proportional to the power level associated with that noise-sample by activating, for each bit of the binary number, one or more buffers corresponding to a significance of that i<sup>th </sup>bit, such that the activated one or more buffers emit a noise power proportional to 2<sup>i</sup>.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The hardware countermeasure of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the distributed buffer network comprises a plurality of buffers, and wherein each of the plurality of buffers is connected with a corresponding capacitive load.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The hardware countermeasure of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein at least one of the plurality of buffers and the corresponding capacitive load(s) are located adjacent to an input register of the cryptographic hardware module.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The hardware countermeasure of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein at least one of the plurality of buffers and the corresponding capacitive load(s) are located adjacent to a hardware block of the cryptographic module that performs a masking operation.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The hardware countermeasure of <claim-ref idref="CLM-00004">claim 4</claim-ref> wherein the masking operation comprises either the application of a random mask to an input data sample for operation by a cryptographic operation or the removal of a random mask from an output data sample operated on by the cryptographic operation.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The hardware countermeasure of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein at least one of the plurality of buffers and the corresponding capacitive load(s) are located adjacent to a hardware block of the cryptographic module that performs a mask modification operation to update a mask of a masking operation.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The hardware countermeasure of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the distributed buffer network is built with a standard CMOS structure and co-located with at least one cryptographic logic hardware block of the cryptographic hardware module.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The hardware countermeasure of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the distributed buffer network comprises a plurality of buffer blocks, wherein each of the plurality of buffer blocks comprises at least one buffer, and wherein the distributed buffer network is operable to emit the noise output by activating a combination of the plurality of buffer blocks corresponding to the each of the noise-samples.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The hardware countermeasure of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein each of the plurality of buffer blocks comprises a different number of buffers.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The hardware countermeasure of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein each of the plurality of buffer blocks dissipates a different noise power level.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The hardware countermeasure of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein each bit of the binary number corresponds to a one of the plurality of buffer blocks.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A mobile communications device comprising the hardware countermeasure of <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text>
</claim>
</claims>
</us-patent-grant>
