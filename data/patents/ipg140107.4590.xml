<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625678-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625678</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11992741</doc-number>
<date>20050929</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<us-term-extension>837</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>7</main-group>
<subgroup>12</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>37524026</main-classification>
</classification-national>
<invention-title id="d2e53">Method for scalable video coding on a plurality of space resolution levels</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4853779</doc-number>
<kind>A</kind>
<name>Hammer et al.</name>
<date>19890800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>37524022</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5241608</doc-number>
<kind>A</kind>
<name>Fogel</name>
<date>19930800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5680487</doc-number>
<kind>A</kind>
<name>Markandey</name>
<date>19971000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6728317</doc-number>
<kind>B1</kind>
<name>Demos</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>37524021</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2005/0190979</doc-number>
<kind>A1</kind>
<name>Li et al.</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382240</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>EP</country>
<doc-number>0 644 695</doc-number>
<kind>A2</kind>
<date>19950300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00007">
<othercit>Horn et al., &#x201c;Determining Optical Flow&#x201d;, Massachusetts Institute of Technology Artificial Intelligence Laboratory, No. 17, pp. 1-27, (1980).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00008">
<othercit>Giaccone et al.; &#x201c;Spatio-Temporal Approaches to Computation of Optical Flow&#x201d;, Proceedings of the British Machine Vision Conference, 10 pages, (1997).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00009">
<othercit>Moulin et al.; &#x201c;Multiscale Modeling and Estimation of Motion Fields for Video Coding&#x201d;, IEEE Transactions of Image Processing, vol. 6, No. 12, pp. 1606-1620, (1997).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00010">
<othercit>Simoncelli; &#x201c;Bayesian Multi-Scale Differential Optical Flow&#x201d;, Handbook of Computer Vision and Applications, Academic Press, pp. 397-422, 1999.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00011">
<othercit>Taubman, &#x201c;SVC Technical Contribution: Overview of Recent Technology Developments at UNSW&#x201d;, ISO/IEC JTC1/SC29/WG11/M10868, pp. 1-22, (2004).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00012">
<othercit>Dipanda et al.; &#x201c;Multiresolution Motion Estimation with Discontinuities Preservation Using MRF and Determination of the Regularization Hyperparameter&#x201d; Part of the IS&#x26;T SPIE Conference on Capture, Analysis and Display of Image Sequences, San Jose California, XP-002385365, vol. 3642, pp. 44-55, (1999).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00013">
<othercit>Baaziz et al.; &#x201c;Multiconstraint Weiner-Based Motion Compensation Using Wavelet Pyramids&#x201d;, IEEE Transactions on Image Processing, vol. 3, No. 5, pp. 688-692, (1994).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00014">
<othercit>Castellano et al.; &#x201c;Moving Target Detection in Infrared Imagery Using a Regularized CDWT Optical Flow&#x201d;, Computer Vision Beyond the Visible Spectrum: Methods and Applications, (CVBVS '99) Proceedings IEEE Workshop, 10 pages, (1999).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>17</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>37524001</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>37524021</main-classification>
</classification-national>
<us-classifications-ipcr>H04N 7/12</us-classifications-ipcr>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>3</number-of-drawing-sheets>
<number-of-figures>4</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20090304090</doc-number>
<kind>A1</kind>
<date>20091210</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Cordara</last-name>
<first-name>Giovanni</first-name>
<address>
<city>Turin</city>
<country>IT</country>
</address>
</addressbook>
<residence>
<country>IT</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Francini</last-name>
<first-name>Gianluca</first-name>
<address>
<city>Turin</city>
<country>IT</country>
</address>
</addressbook>
<residence>
<country>IT</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Lepsoy</last-name>
<first-name>Skjalg</first-name>
<address>
<city>Turin</city>
<country>IT</country>
</address>
</addressbook>
<residence>
<country>IT</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Cordara</last-name>
<first-name>Giovanni</first-name>
<address>
<city>Turin</city>
<country>IT</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Francini</last-name>
<first-name>Gianluca</first-name>
<address>
<city>Turin</city>
<country>IT</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Lepsoy</last-name>
<first-name>Skjalg</first-name>
<address>
<city>Turin</city>
<country>IT</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Finnegan, Henderson, Farabow, Garrett &#x26; Dunner, L.L.P.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Telecom Italia S.p.A.</orgname>
<role>03</role>
<address>
<city>Milan</city>
<country>IT</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Czekaj</last-name>
<first-name>David</first-name>
<department>2487</department>
</primary-examiner>
<assistant-examiner>
<last-name>Li</last-name>
<first-name>Tracy</first-name>
</assistant-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/IB2005/002920</doc-number>
<kind>00</kind>
<date>20050929</date>
</document-id>
<us-371c124-date>
<date>20090522</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO2007/036759</doc-number>
<kind>A </kind>
<date>20070405</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method for estimating motion for the scalable video coding, includes the step of estimating the motion field of a sequence of photograms which can be represented with a plurality of space resolution levels including computing the motion field for the minimum resolution level and, until the maximum resolution level is reached, repeating the steps of: rising by one resolution level; extracting the photograms for such resolution level; and computing the motion field for such resolution level. The motion field is computed through an optical flow equation which contains, for every higher level than the minimum resolution level, a regularization factor between levels which points out the difference between the solution for the considered level and the solution for the immediately lower resolution level. A more or less high value of the regularization factor implies more or less relevant changes of the component at the considered resolution during the following process iterations.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="161.29mm" wi="210.31mm" file="US08625678-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="191.77mm" wi="150.88mm" orientation="landscape" file="US08625678-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="215.90mm" wi="162.14mm" orientation="landscape" file="US08625678-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="208.28mm" wi="155.45mm" orientation="landscape" file="US08625678-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATION</heading>
<p id="p-0002" num="0001">This application is a national phase application based on PCT/IB2005/002920, filed Sep. 29, 2005, the content of which is incorporated herein by reference.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">1. Technical Field</p>
<p id="p-0004" num="0003">The present invention deals with a method for scalable video coding.</p>
<p id="p-0005" num="0004">Video coding is a complex procedure, composed of a chain of different operations; motion estimation, space transform, quantization, entropy coding. The first operation, motion estimation, plays a major role in the process, and its efficiency deeply affects the obtainable compression ratio. During such step, in fact, a prediction of the contents of a photogram is computed starting from the adjacent ones, exploiting the high similarity which usually distinguishes subsequent photograms.</p>
<p id="p-0006" num="0005">2. Description of the Related Art</p>
<p id="p-0007" num="0006">Herein below, the term &#x201c;reference photogram&#x201d; means an already processed photogram so that it can be reconstructed by the decoder. The term &#x201c;current photogram&#x201d; means the photogram to be coded, namely the processing object. The reference photogram is modified in order to approximate the current photogram.</p>
<p id="p-0008" num="0007">The similarity between subsequent photograms can be expressed through &#x201c;distortions&#x201d;. The coded flow is composed of the differences between current photogram prediction and current photogram itself, and of additional information which allow the decoder to obtain the same prediction to obtain the perfect reconstruction. In such a way, the coded information energy is minimised, maximising the compression factor.</p>
<p id="p-0009" num="0008">In traditional standards of the hybrid type (for ex. MPEG-2, H.264/AVC) the most used motion estimation technique is the so-called &#x201c;block matching&#x201d;: the whole current photogram is divided into small blocks with variable size and each one of them is associated, on the reference photogram, with the block having the most similar contents and which minimises, therefore, the difference energy. The two small blocks (one on the current photogram and one on the reference photogram) are therefore presumably an identification of the same image portion; such image portion is often subjected to an offset when passing from a photogram to the following one due either to a movement of filmed objects or to the camera movement. Therefore, it is possible to associate every small block of the current image with a two-dimensional vector, which do represents the offset to which such small block has been subjected with respect to the previous photogram. Such two-dimensional vector which identifies the offset is called &#x201c;motion vector&#x201d; (MV).</p>
<p id="p-0010" num="0009">In the coded flow, consequently, reference photograms, MVs and differences between individual blocks and their predictions are inserted.</p>
<p id="p-0011" num="0010">The use of block matching introduces some visual artefacts on decoded flows with a high compression ratio, but appears as the most efficient method for computing the motion estimation in hybrid coders (namely in coders including the prediction for compensating movement and space compression).</p>
<p id="p-0012" num="0011">With the advent of new video coding technologies, based on different transforms from the traditional DCT (Discrete Cosine Transform), such as the &#x201c;wavelet&#x201d; transform, an efficiency loss is detected due to the use of block matching as motion estimation technique. The wavelet transform, in fact, contrary to DCT, which operates in blocks, is applied on the whole photogram, and the block matching technique therefore introduces discontinuities on small block edges which, in the transformed domain, give origin to high-frequency components. Such components highly limit performances during the quantization step. Therefore, a need arises for a new type of motion representation.</p>
<p id="p-0013" num="0012">A motion estimating device is known which is based on an alternative approach to block matching, the so-called &#x201c;optical flow&#x201d;, which computes the spot distortion of the reference photogram for determining a current photogram prediction without incurring in a block use. The optical flow technique is described for example in B. Horn, B. Schunck, &#x201c;Determining optical flow&#x201d;, Artificial Intelligence, no. 17, pp. 185-203, 1981. The optical flow is computed by solving a system of linear equations, whose coefficients are obtained from space and time derivatives of the current photogram, namely from spot differences between adjacent and/or subsequent pixels in time. The solution is a set of two-dimensional vectors, one for every photogram pixel, called &#x201c;motion field&#x201d;.</p>
<p id="p-0014" num="0013">The motion field produced by the optical flow can be determined so that it is regular, or &#x201c;smooth&#x201d;, due to the addition of regularization terms in the system of linear equations. The smooth field gives origin to residuals which do not show the typical discontinuities of block matching and are adapted to be decomposed with the wavelet transform.</p>
<p id="p-0015" num="0014">There are optical flow embodiments for which the motion fields are computed iteratively, so that each iteration determines a field which is inserted as term in a sum of fields. The final sum is the motion field. The article of P. Giaccone, G. Jones, &#x201c;Spatio-temporal approaches to the computation of optical flow&#x201d;, Proceedings of the British Machine Vision Conference, 1997, describes for example the use of the optical flow technique with a particular solution for building the first motion field, in which the first motion estimation is based on identification and tracking of some salient points.</p>
<p id="p-0016" num="0015">It is known to apply multi-resolution motion estimation techniques through optical flow in video coding contexts, as described for example in Moulin: P. Moulin, R. Krishnamurthy and J. Woods, &#x201c;Multiscale Modeling and Estimation of Motion Fields for Video Coding&#x201d;, IEEE Transactions on Image Processing, vol. 6, no. 12, pp. 1606-1620, December 1996.</p>
<p id="p-0017" num="0016">There are in particular motion estimation embodiments through optical flow which use a &#x201c;coarse-to-fine&#x201d; procedure, namely a multi-resolution one. Such techniques provide for the construction of motion fields as a sum. Every term of such sum corresponds to a level of a pyramid containing different space resolutions. Purpose of these procedures is overcoming the difficulties encountered by optical flow algorithms in the wide motion computation, namely in determining offsets which exceed a certain number of pixels.</p>
<p id="p-0018" num="0017">In practice, such techniques operate as follows. The firs terms is composed of the motion field estimated for photograms at the lowest resolution level. The following terms are produced in the following way:</p>
<p id="p-0019" num="0018">1. One goes up by one resolution level and photograms at such level are considered.</p>
<p id="p-0020" num="0019">2. A motion field is created expanding through interpolation and scaling the previously-computed field.</p>
<p id="p-0021" num="0020">3. The reference photogram is deformed with the field created thereby.</p>
<p id="p-0022" num="0021">4. The motion field is computed which exists between deformed photogram and current photogram. Such field will be a term of this sum, and will be added to what has already been computed.</p>
<p id="p-0023" num="0022">5. If the maximum resolution level has not been reached, the process is repeated from step 1.</p>
<p id="p-0024" num="0023">In such technique, therefore, the computed motion fields for lower levels are used as terms in the final field.</p>
<p id="p-0025" num="0024">The document by Eero P. Simoncelli: &#x201c;Bayesian multiscale differential optical flow&#x201d;, in Handbook of Computer Vision and Applications, eds. B. J&#xe4;hne, H. Haussecker, and P. Geissler, Academic Press, 1999 describes for example a multi-resolution optical flow arrangement, comprising the use of an algorithm which is able to manage the uncertainty belonging to the motion estimation at multiple levels. The motion field at a certain level is modelled as the sum of motion deriving from below levels and a stochastic component. Other documents related to multi-resolution optical flow motion estimation are U.S. Pat. No. 5,680,487 and U.S. Pat. No. 5,241,608.</p>
<p id="p-0026" num="0025">The optical flow can be applied in a different environment with respect to traditional coding, in particular in a context of Scalable Video Coding (SVC), also called &#x201c;level&#x201d; coding. The SVC technique objective is, starting from a single coded flow, to perform a single coding, originating a bitstream from which it is possible to obtain flows with multiple qualities. In fact, from such bitstream it is possible to extract a new bitstream related to a video flow with desired resolution (chosen from a set of possible resolutions), taking into account the space, time (in terms of &#x201c;frame rate&#x201d;) and quality (in terms of &#x201c;bit rate&#x201d;) dimensions. Arrangements using both hybrid technologies and wavelet-based approaches are known.</p>
<p id="p-0027" num="0026">The scalable coding is important, for example, for transmitting on noisy channels: in fact, it is possible to protect the most important levels (the basic levels) by transmitting them on channels with better performances. The scalable coding is very useful also on channels with variable bit-rate: when the band is reduced, the less important layers are not transmitted. Another useful application of the scalability consists in the progressive transmission, namely a user can revise a video preview, coded only with basic levels, for example in order to perform a choice in a database; once the decision has been taken, he will be able to receive the video at the best quality.</p>
<p id="p-0028" num="0027">In scalable coders, in case of space scalability, the motion estimation step is highly complicated and performances are strongly affected by such step. The optimum prediction for lower resolutions, in fact, is not always given by scaling of motion vectors computed at full resolution, due to the loss of details and the appearance of aliasing. The optimum solution, for the motion field associated with each space resolution, cannot be derived from other resolutions. It is therefore impossible to determine the optimum motion for all resolutions by exclusively computing it in a limited set thereof. However, the motion representation inserted in the bitstream must be unique, to avoid an excessive occupation of bits dedicated to the motion field.</p>
<p id="p-0029" num="0028">It is thereby necessary to find the best compromise able to optimise performances for all affected resolutions.</p>
<p id="p-0030" num="0029">There are approaches, based on a motion estimation of the block matching type, which provide for the computation of the motion field for each of the provided resolutions, and represent the motion information univocally by inserting in the coded flow a compromise which is able to keep good performances for each scalability level. The following approaches differ depending on the computation modes of the compromise:</p>
<p id="p-0031" num="0030">In EP0644695A2, starting from the estimation computed on a basic layer and on an enhancement layer, the final motion field computation is performed, by using weight functions guided by the estimation validity (in terms of residual energy) for each level.</p>
<p id="p-0032" num="0031">D. Taubman, N. Mehrseresht, R. Leung, &#x201c;SVC Technical Contribution: Overview of recent technology developments at UNSW&#x201d;, ISO/IEC JTC1/SC29/WG11/M10868, 2004&#x201d; describes an adaptive process, which assigns a variable weight, depending on the estimation validity, to motion information coming from high-frequency bands computed during space filtering.</p>
<p id="p-0033" num="0032">The Applicant has observed that, in spite the above documents describe motion estimation algorithms based on multi-resolution analysis with the use of a compromise for different scalability levels, motion estimation always occurs by applying the block matching. The block matching, however, has difficulties if applied to the scalable coding, since it is not known how to realise motion fields which are able to faithfully represent different space resolutions.</p>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE INVENTION</heading>
<p id="p-0034" num="0033">The Applicant has dealt with the problem of adapting the optical flow techniques to a scalable coding scenario, in particular of modifying the optical flow algorithmic process in order to improve performances of a motion estimating device in case of space scalability in a multi-resolution context for scalable video coding.</p>
<p id="p-0035" num="0034">The Applicant has found that, by performing the optical flow computation for the lowest space resolution, followed by a similar process for greater resolutions with the addition of a constraint which measures the similarity between the solution for the considered level and the solution for the below level at a lower resolution, it is possible to obtain an improvement of estimating device performances.</p>
<p id="p-0036" num="0035">When decoding, motion fields for different resolutions are obtained by the field associated with the highest resolution (computed when coding through the method described below) by applying a bench of filters of the wavelet type (Discrete Wavelet Transform&#x2014;DWT).</p>
<p id="p-0037" num="0036">The above constraint, realised as regularization term, penalises solutions which differ (in particular in the low-pass component) from the motion field already computed for the lower resolution. The regularization term quantifies the difference between the field to be computed and the already computed field for the level below. For such purpose, a low-pass wavelet filtering is applied to the field to be computed, followed by a sub-sampling for reducing the resolution.</p>
<p id="p-0038" num="0037">The influence exerted by regularization can then be set through a factor, called &#x201c;regularization factor&#x201d;, which determines the similarity between levels. A high regularization factor makes the component of a certain resolution scarcely change during the following iterations of the herein described process. If instead the regularization factor is low, then the component of a certain resolution is subjected to changes during following iterations, especially if details appeared at upper levels move differently from those which can be seen at lower levels.</p>
<p id="p-0039" num="0038">It is therefore possible to make the solution more or less constrained to some space levels, in order to maximise performances depending on scene contents and scalability needs.</p>
<p id="p-0040" num="0039">Fields computed for lower levels are used only as parts of the optimisation criteria, and not as terms in the final field. When decoding, to obtain a motion field which can be applied at a certain resolution, it is enough to perform a low-pass wavelet filtering to remove high-frequency components and then sub-sample the result.</p>
<p id="p-0041" num="0040">The technique of the present invention therefore adds innovative regularization terms in multi-resolution scalable video coding.</p>
<p id="p-0042" num="0041">The end result of this procedure is composed of the motion field computed at the highest level. It contains in itself, as components, approximations to optimum motion fields (in the optical flow sense) for every resolution level. The technique of the invention therefore allows distributing the error belonging to multi-resolution fields among the various used resolutions.</p>
<p id="p-0043" num="0042">The proposed solution, studied for video coders of the wavelet type, can also be adopted within a hybrid coder.</p>
<p id="p-0044" num="0043">According to a first aspect thereof, the present invention therefore relates to a method for motion estimation for scalable video coding, comprising the step of estimating the motion field of a sequence of photograms which can be represented with a plurality of space resolution levels included between a minimum resolution level and a maximum resolution level, wherein the step of estimating the motion field comprises the step of computing the motion field for each one of the space resolution levels by the minimization of a function, wherein, for each level which is different from the minimum space resolution level, said function comprises a regularization term between levels which is indicative of the difference between the solution of the minimisation for the considered level and the solution of the minimisation for the space resolution level which is immediately lower than the considered level. The expression &#x201c;solution of the minimisation&#x201d; means the solution which allows obtaining the minimum of the considered function.</p>
<p id="p-0045" num="0044">Preferably, the above function can be expressed through an optical flow equation. In other words, the motion field is computed through an optical flow equation which, for levels different from the minimum space resolution level, comprises the above regularization term between levels. Such term instead is absent for the minimum resolution level.</p>
<p id="p-0046" num="0045">Preferably, the step of computing the motion field for every level which is different from the minimum space resolution level is performed sequentially passing from minimum space resolution level to maximum space resolution level.</p>
<p id="p-0047" num="0046">For each space resolution level, the motion field comprises an initial motion field and an incremental motion field and the steps of computing the motion field preferably comprise computing the incremental motion field and adding the incremental motion field to the initial motion field.</p>
<p id="p-0048" num="0047">For a generic space resolution level of K&#x2212;m order different from the minimum space resolution level, the regularization term between levels can be expressed as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i><sub>3</sub>(<i>q</i><sub>K&#x2212;m</sub>)=&#x2225;<i>E</i>(<i>q</i><sub>K&#x2212;m</sub><i>+p</i><sub>K&#x2212;m</sub><sup>0</sup>)&#x2212;<i>p</i><sub>K&#x2212;m&#x2212;1</sub>&#x2225;<sup>2</sup>,<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0049" num="0048">where E is a filtering and sub-sampling operator, p<sup>0 </sup>is the initial motion field and q is the incremental motion field; moreover, the incremental motion field q in a generic point with coordinates x, y being suitable to be expressed as</p>
<p id="p-0050" num="0049">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>q</mi>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>x</mi>
          <mo>,</mo>
          <mi>y</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mo>[</mo>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mi>&#x3b4;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mrow>
                <mi>u</mi>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>x</mi>
                    <mo>,</mo>
                    <mi>y</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mi>&#x3b4;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mrow>
                <mi>v</mi>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>x</mi>
                    <mo>,</mo>
                    <mi>y</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
      <mo>]</mo>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
</p>
<p id="p-0051" num="0050">where &#x3b4;u and &#x3b4;v are the horizontal and vertical components of the incremental motion field.</p>
<p id="p-0052" num="0051">The filtering and sub-sampling operator E is preferably a low-pass component of a wavelet transform.</p>
<p id="p-0053" num="0052">For each level different from the minimum space resolution level, minimisation can preferably be expressed as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>q</i>=arg min{<i>F</i><sub>1</sub>(<i>q</i>)+&#x3bb;<i>F</i><sub>2</sub>(<i>q</i>)+&#x3bc;<i>F</i><sub>3</sub>(<i>q</i>)}<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0054" num="0053">where F<sub>1</sub>(q) is a term designating the approximation error, F<sub>2</sub>(q) is a term designating the motion field regularity and &#x3bb; and &#x3bc; are two regularization factors.</p>
<p id="p-0055" num="0054">Instead, for the minimum space resolution level, minimisation can preferably be expressed as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>q</i>=arg min{<i>F</i><sub>1</sub>(<i>q</i>)+&#x3bb;<i>F</i><sub>2</sub>(<i>q</i>)}.<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0056" num="0055">Moreover, taking into account two photograms g<sub>t </sub>and g<sub>t+1 </sub>at subsequent instants t and t+1 on the generic resolution level K&#x2212;m, the term designating the approximation error can be expressed as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i><sub>1</sub>(<i>q</i>)=&#x2225;<i>A</i><sub>K&#x2212;m</sub><i>q</i>&#x2212;(<i>M</i>(<i>g</i><sub>t</sub><i>,u</i><sub>0</sub><i>,v</i><sub>0</sub>)&#x2212;<i>g</i><sub>t+1</sub>)&#x2225;<sup>2</sup>, where:<?in-line-formulae description="In-line Formulae" end="tail"?>
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0056">u<sub>0 </sub>and v<sub>0 </sub>are the horizontal and vertical components of the initial motion field,</li>
        <li id="ul0002-0002" num="0057">A<sub>k&#x2212;m </sub>is a matrix composed of two diagonal sub-matrixes containing the space derivatives of photogram g<sub>t+1</sub>, expressed as A<sub>K&#x2212;m</sub>=[diag(g<sub>t+1</sub><sup>(x)</sup>)diag(g<sub>t+1</sub><sup>(x)</sup>)], and</li>
        <li id="ul0002-0003" num="0058">M is a motion operator adapted to distort a generic photogram g in the following way:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>M</i>(<i>g,u,v</i>)(<i>x,y</i>)=<i>g</i>(<i>x&#x2212;u</i>(<i>x,y</i>),<i>y&#x2212;v</i>(<i>x,y</i>)).<?in-line-formulae description="In-line Formulae" end="tail"?>
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0057" num="0059">The term designating the motion field regularity can be expressed as F<sub>2</sub>(q)=&#x2225;Hq&#x2225;<sup>2</sup>, where H is a second derivative operator which can be expressed as:</p>
<p id="p-0058" num="0060">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <mi>H</mi>
  <mo>=</mo>
  <mrow>
    <mo>[</mo>
    <mtable>
      <mtr>
        <mtd>
          <mfrac>
            <msup>
              <mo>&#x2146;</mo>
              <mn>2</mn>
            </msup>
            <mrow>
              <mo>&#x2146;</mo>
              <msup>
                <mi>x</mi>
                <mn>2</mn>
              </msup>
            </mrow>
          </mfrac>
        </mtd>
        <mtd>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
        </mtd>
      </mtr>
      <mtr>
        <mtd>
          <mfrac>
            <msup>
              <mo>&#x2146;</mo>
              <mn>2</mn>
            </msup>
            <mrow>
              <mo>&#x2146;</mo>
              <msup>
                <mi>y</mi>
                <mn>2</mn>
              </msup>
            </mrow>
          </mfrac>
        </mtd>
        <mtd>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
        </mtd>
      </mtr>
      <mtr>
        <mtd>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
        </mtd>
        <mtd>
          <mfrac>
            <msup>
              <mo>&#x2146;</mo>
              <mn>2</mn>
            </msup>
            <mrow>
              <mo>&#x2146;</mo>
              <msup>
                <mi>x</mi>
                <mn>2</mn>
              </msup>
            </mrow>
          </mfrac>
        </mtd>
      </mtr>
      <mtr>
        <mtd>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
        </mtd>
        <mtd>
          <mfrac>
            <msup>
              <mo>&#x2146;</mo>
              <mn>2</mn>
            </msup>
            <mrow>
              <mo>&#x2146;</mo>
              <msup>
                <mi>y</mi>
                <mn>2</mn>
              </msup>
            </mrow>
          </mfrac>
        </mtd>
      </mtr>
    </mtable>
    <mo>]</mo>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0059" num="0061">Before the steps of computing the motion fields, the method preferably comprises the further step of building photograms at different space resolution levels starting from photograms at maximum space resolution level.</p>
<p id="p-0060" num="0062">Moreover, for each space resolution level, the step of building the photograms preferably comprises filtering and sub-sampling the photograms at maximum space resolution level, such step of filtering and sub-sampling being performed a number of times equal to the number of levels which separate the space resolution level from the maximum space resolution level.</p>
<p id="p-0061" num="0063">The step of filtering and sub-sampling preferably comprises the following steps:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0064">low-pass filtering along the rows;</li>
        <li id="ul0004-0002" num="0065">sub-sampling the columns;</li>
        <li id="ul0004-0003" num="0066">low-pass filtering along the columns; and</li>
        <li id="ul0004-0004" num="0067">sub-sampling the rows.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0062" num="0068">The present invention further relates to a method for transmitting coded video images, comprising the steps of coding a video image according to the above-described method, transmitting the coded image, receiving the coded image and decoding the received coded image.</p>
<p id="p-0063" num="0069">Preferably, the step of decoding comprises applying to said coded video image at least one transform of the wavelet type to obtain a sequence of photograms at a desired resolution level.</p>
<p id="p-0064" num="0070">The above method is adapted to be performed (as sequence of steps) as program by a processor. The present invention therefore also relates to a processor program which can be directly loaded into a memory of a data processing system and is adapted to implement, when performed, the previously described method. The invention finally deals with a system comprising means for performing the steps of the previously described method.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE FIGURES</heading>
<p id="p-0065" num="0071">The present invention will be described herein below with reference to the enclosed figures, which show a non-limiting embodiment thereof. In particular:</p>
<p id="p-0066" num="0072"><figref idref="DRAWINGS">FIG. 1</figref> shows as an example a system for coding and decoding video images.</p>
<p id="p-0067" num="0073"><figref idref="DRAWINGS">FIG. 2</figref> shows sequences of video images on many resolution levels, to which the coding technique of the present invention is applied;</p>
<p id="p-0068" num="0074"><figref idref="DRAWINGS">FIG. 3</figref> shows filtering and sub-sampling steps included in the coding method of the present invention; and</p>
<p id="p-0069" num="0075"><figref idref="DRAWINGS">FIG. 4</figref> shows a flow diagram related to the steps of the method of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0070" num="0076">With reference to <figref idref="DRAWINGS">FIG. 1</figref>, <b>1</b> designates a system for transmitting video signals, comprising an image coder <b>2</b> and an image decoder <b>3</b>. The image coder <b>2</b> is adapted to receive a video signal S generated by a video filming device (such as a digital video camera), to code the signal S for generating a corresponding coded video signal S<sub>c</sub>, and finally to transmit such coded signal on a transmitting medium <b>4</b> of a known type, for example an optical fiber connection. The decoder <b>3</b> is adapted to receive the coded signal S<sub>c </sub>and to decode such signal to extract a signal S<sub>D</sub>, similar but not necessarily equal to signal S.</p>
<p id="p-0071" num="0077">The signal S is coded so that it can be decoded on a space resolution level chosen among a set of possible resolution levels.</p>
<p id="p-0072" num="0078">In the following description, therefore, the presence of a multi-resolution pyramid will be assumed for representing photograms and motion fields having M+1 levels, in which the highest level has index K and the lowest has index K&#x2212;M.</p>
<p id="p-0073" num="0079"><figref idref="DRAWINGS">FIG. 2</figref> shows three sequences of photograms at times t=1, t=2 . . . t=T, related to the same video but corresponding to three different resolution levels K, K&#x2212;m and K&#x2212;M. In particular, the first sequence of photograms f<sub>1</sub><sup>K</sup>, f<sub>2</sub><sup>K</sup>, . . . , f<sub>T</sub><sup>K </sup>is related to maximum resolution (level K), the second sequence of photograms f<sub>1</sub><sup>K&#x2212;m</sup>, f<sub>2</sub><sup>K&#x2212;m</sup>, . . . , f<sub>T</sub><sup>K&#x2212;m </sup>is related to an intermediate resolution (level K&#x2212;m) and the third sequence of photograms f<sub>1</sub><sup>K&#x2212;M</sup>, f<sub>2</sub><sup>K&#x2212;M</sup>, . . . , f<sub>T</sub><sup>K&#x2212;M </sup>is related to the minimum resolution (level K&#x2212;M).</p>
<p id="p-0074" num="0080">Upon receiving the uncoded video signal, comprising the sequence of photograms at maximum resolution level, the coder <b>2</b> performs the photogram construction at lower resolution levels. As shown in the flow diagram in <figref idref="DRAWINGS">FIG. 3</figref>, in order to build a photogram at a resolution of a lower level than the maximum resolution, the following sequence of operations is applied to the photogram at maximum resolution:
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0081">low-pass filtering along rows (step <b>10</b>);</li>
        <li id="ul0006-0002" num="0082">sub-sampling of columns (step <b>20</b>);</li>
        <li id="ul0006-0003" num="0083">low-pass filtering along columns (step <b>30</b>); and</li>
        <li id="ul0006-0004" num="0084">sub-sampling of rows (step <b>40</b>).</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0075" num="0085">This sequence of operations will be designated by letter B.</p>
<p id="p-0076" num="0086">In order to build a photogram at a resolution of m levels lower than the maximum one, the above cascade of operations is applied m times. This operation, designated as B<sup>m</sup>, is equivalent to the computation of the corresponding low-pass component of a discrete wavelet transform (DWT) for two-dimensional images. Then a photogram at time t and at level K&#x2212;m (namely m levels below the maximum one) is obtained from the corresponding photogram at time t and at maximum level K through the relationship:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>f</i><sub>t</sub><sup>K&#x2212;m</sup><i>=B</i><sup>m</sup><i>f</i><sub>t</sub><sup>K</sup>.&#x2003;&#x2003;(1)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0077" num="0087">Following the construction of photograms at different levels, the motion field computation is performed at different levels. In the present invention, the motion field is obtained when coding through an iterative procedure. Such procedure first computes a motion field at the lowest resolution by minimising a function of the optical flow type, in order then to compute motion fields for greater and greater resolutions, rising along the pyramid of resolutions till the greatest one is reached, for which the final motion field will be computed.</p>
<p id="p-0078" num="0088">At all other resolutions, the motion field is computed by minimising a cost function, in which a term represents the similarity between solution to be computed and already obtained solution for the level below. Minimising can be obtained by solving a system of equations.</p>
<p id="p-0079" num="0089">Let us assume a generic resolution K&#x2212;m and a generic time instant t. The two photograms being taken into account, related to such resolution at time t and at time t+1, are g<sub>t</sub>=f<sub>t</sub><sup>K&#x2212;m </sup>and g<sub>t+1</sub>=f<sub>t+1</sub><sup>K&#x2212;m</sup>.</p>
<p id="p-0080" num="0090">According to the optical flow technique, a matrix is built which contains the first space derivatives with respect to Cartesian coordinates x and y on two diagonals, and which is equal to zero in the other elements.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>A</i><sub>K&#x2212;m</sub>=[diag(<i>g</i><sub>t+1</sub><sup>(x)</sup>)diag(<i>g</i><sub>t+1</sub><sup>(y)</sup>)].&#x2003;&#x2003;(2)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0081" num="0091">The optical flow is initialised with horizontal u<sub>0</sub>(x,y) and vertical v<sub>0</sub>(x,y) motion fields, assuming in such a way that the pixel in (x,y) is moved by a vector</p>
<p id="p-0082" num="0092">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msup>
            <mi>p</mi>
            <mn>0</mn>
          </msup>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>x</mi>
              <mo>,</mo>
              <mi>y</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mo>[</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <msub>
                    <mi>u</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>x</mi>
                      <mo>,</mo>
                      <mi>y</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow>
                  <msub>
                    <mi>v</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>x</mi>
                      <mo>,</mo>
                      <mi>y</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
          <mo>]</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>3</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
between one photogram and the other.
</p>
<p id="p-0083" num="0093">The first term of the function to be minimised for solving the optical flow is:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i><sub>1</sub>(<i>q</i>)=&#x2225;<i>A</i><sub>K&#x2212;m</sub><i>q</i>&#x2212;(<i>M</i>(<i>g</i><sub>t</sub><i>,u</i><sub>0</sub><i>,v</i><sub>0</sub>)&#x2212;<i>g</i><sub>t+1</sub>)&#x2225;<sup>2</sup>,&#x2003;&#x2003;(4)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where variable q is an incremental motion field
</p>
<p id="p-0084" num="0094">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>q</mi>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>x</mi>
          <mo>,</mo>
          <mi>y</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mo>[</mo>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mi>&#x3b4;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mrow>
                <mi>u</mi>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>x</mi>
                    <mo>,</mo>
                    <mi>y</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mi>&#x3b4;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mrow>
                <mi>v</mi>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>x</mi>
                    <mo>,</mo>
                    <mi>y</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
      <mo>]</mo>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
to be added to the initial one and M is a motion operator defined as regards initialisation and adapted to distort a photogram g according to motion fields u and v:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>M</i>(<i>g,u,v</i>)(<i>x,y</i>)=<i>g</i>(<i>x&#x2212;u</i>(<i>x,y</i>),<i>y&#x2212;v</i>(<i>x,y</i>))&#x2003;&#x2003;(5)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
(with necessary modifications for fields u and v containing non-integer numbers and for a movement near to photogram edges).
</p>
<p id="p-0085" num="0095">Depending on what has been said above, the motion field p can therefore be expressed as p=q+p<sup>0</sup>, namely as the sum of an initial term and an incremental term.</p>
<p id="p-0086" num="0096">The above term F<sub>1</sub>(q) is a term designating the approximation error.</p>
<p id="p-0087" num="0097">The first term of the optical flow does not determine the motion field univocally. Following the classic formulation by Horn and Schunck, it is necessary to add a term equal to the energy of the second derivative of the motion fields. The derivatives are expressed with an operator H equal to:</p>
<p id="p-0088" num="0098">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>H</mi>
          <mo>=</mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mfrac>
                    <msup>
                      <mo>&#x2146;</mo>
                      <mn>2</mn>
                    </msup>
                    <mrow>
                      <mo>&#x2146;</mo>
                      <msup>
                        <mi>x</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </mfrac>
                </mtd>
                <mtd>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mfrac>
                    <msup>
                      <mo>&#x2146;</mo>
                      <mn>2</mn>
                    </msup>
                    <mrow>
                      <mo>&#x2146;</mo>
                      <msup>
                        <mi>y</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </mfrac>
                </mtd>
                <mtd>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                </mtd>
                <mtd>
                  <mfrac>
                    <msup>
                      <mo>&#x2146;</mo>
                      <mn>2</mn>
                    </msup>
                    <mrow>
                      <mo>&#x2146;</mo>
                      <msup>
                        <mi>x</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </mfrac>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                </mtd>
                <mtd>
                  <mfrac>
                    <msup>
                      <mo>&#x2146;</mo>
                      <mn>2</mn>
                    </msup>
                    <mrow>
                      <mo>&#x2146;</mo>
                      <msup>
                        <mi>y</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </mfrac>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>6</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
and the energy of the second derivative of the motion field becomes:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i><sub>2</sub>(<i>q</i>)=&#x2225;<i>Hq&#x2225;</i><sup>2</sup>.&#x2003;&#x2003;(7)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0089" num="0099">The second term F<sub>2 </sub>represents, with a suitable regularization factor, the motion field regularity (namely the detail &#x201c;poorness&#x201d;).</p>
<p id="p-0090" num="0100">According to the present invention, at all resolution levels, apart from the lowest one, a third term F<sub>3 </sub>is added to the two classic terms F<sub>1 </sub>and F<sub>2 </sub>of the function to be minimised. The term F<sub>1 </sub>is used for keeping the similarity between the field that has to be estimated (at space resolution level K&#x2212;m) and the previously computed field (at level K&#x2212;m&#x2212;1). To quantify such similarity the difference between the field at lower resolution (level K&#x2212;m&#x2212;1) and the low-pass component of the current field (at level K&#x2212;m) is considered.</p>
<p id="p-0091" num="0101">The low-pass component can be expressed through operator B as</p>
<p id="p-0092" num="0102">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mrow>
              <mo>[</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <mi>B</mi>
                  </mtd>
                  <mtd>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                  </mtd>
                  <mtd>
                    <mi>B</mi>
                  </mtd>
                </mtr>
              </mtable>
              <mo>]</mo>
            </mrow>
            <mo>&#x2062;</mo>
            <msub>
              <mi>p</mi>
              <mrow>
                <mi>K</mi>
                <mo>-</mo>
                <mi>m</mi>
              </mrow>
            </msub>
          </mrow>
          <mo>=</mo>
          <mrow>
            <msub>
              <mi>Ep</mi>
              <mrow>
                <mi>K</mi>
                <mo>-</mo>
                <mi>m</mi>
              </mrow>
            </msub>
            <mo>=</mo>
            <mrow>
              <mi>E</mi>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>q</mi>
                  <mo>+</mo>
                  <msubsup>
                    <mi>p</mi>
                    <mrow>
                      <mi>K</mi>
                      <mo>-</mo>
                      <mi>m</mi>
                    </mrow>
                    <mn>0</mn>
                  </msubsup>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>8</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where operator E filters and sub-samples both the horizontal and the vertical fields. The operation is performed on the field composed of the initial one p<sup>0 </sup>and the incremental one q to be computed.
</p>
<p id="p-0093" num="0103">In this way, the third term is
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i><sub>3</sub>(<i>q</i>)=&#x2225;<i>E</i>(<i>q+p</i><sub>K&#x2212;m</sub><sup>0</sup>)&#x2212;<i>p</i><sub>K&#x2212;m&#x2212;1</sub>&#x2225;<sup>2</sup>.&#x2003;&#x2003;(9)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0094" num="0104">Such third term is, with a suitable regularization factor, the constraint inherited by the resolution below. In other words, the third term is an regularization term between levels.</p>
<p id="p-0095" num="0105">From the three terms F<sub>1</sub>, F<sub>2 </sub>and F<sub>3</sub>, it is possible to obtain the final motion field, according to the algorithm described below.</p>
<p id="p-0096" num="0106">At the lowest resolution, the motion field
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>p</i><sub>K&#x2212;M</sub><i>=q+p</i><sub>K&#x2212;M</sub><sup>0</sup>&#x2003;&#x2003;(10)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
is computed, where p<sub>K&#x2212;M</sub><sup>0 </sup>is the initial field and q the incremental field. In turn, q can be expressed through the following (optical flow) equation:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>q</i>=arg min<sub>q&#x3b5;P</sub><sub><sub2>K&#x2212;M</sub2></sub><i>{F</i><sub>1</sub>(<i>q</i>)+&#x3bb;<i>F</i><sub>2</sub>(<i>q</i>)},&#x2003;&#x2003;(11)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
and &#x3bb; is a regularization factor. The constraint q&#x3b5;P<sub>K&#x2212;M </sub>shows that the solution is at resolution level K&#x2212;M.
</p>
<p id="p-0097" num="0107">At all resolutions greater that the lowest one, namely the generic level K&#x2212;m, the motion field is computed as
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>P</i><sub>K&#x2212;m</sub><i>=q+p</i><sub>K&#x2212;m</sub><sup>0</sup>&#x2003;&#x2003;(12)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where p<sub>K&#x2212;m</sub><sup>0 </sup>is the initial field and q the incremental field. In turn, q can be expressed through the following (optical flow) function:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>q</i>=arg min<sub>q&#x3b5;P</sub><sub><sub2>K&#x2212;m</sub2></sub><i>{F</i><sub>1</sub>(<i>q</i>)+&#x3bb;<i>F</i><sub>2</sub>(<i>q</i>)+&#x3bc;<i>F</i><sub>3</sub>(<i>q</i>)},&#x2003;&#x2003;(13)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
and &#x3bb; and &#x3bc; are regularization factors. The constraint q&#x3b5;P<sub>K&#x2212;m </sub>shows that the solution can be found at resolution level K&#x2212;m.
</p>
<p id="p-0098" num="0108">The three terms F<sub>1</sub>(q), F<sub>2</sub>(q) and F<sub>3</sub>(q) of the sum of equation (13) respectively represent approximation error, motion field regularity and constraint inherited by the resolution below. If factor &#x3bb; is high, regularity is given priority, namely the low content of details, for the resulting motion field. If factor &#x3bc; is high, priority is given to the similarity which the resulting motion field has with respect to the motion field computed for the lower resolution.</p>
<p id="p-0099" num="0109">Equation (13) is solved through normal equations</p>
<p id="p-0100" num="0110">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <msup>
              <mrow>
                <mo>[</mo>
                <mtable>
                  <mtr>
                    <mtd>
                      <msub>
                        <mi>A</mi>
                        <mrow>
                          <mi>K</mi>
                          <mo>-</mo>
                          <mi>m</mi>
                        </mrow>
                      </msub>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow>
                        <mi>&#x3bb;</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mi>H</mi>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow>
                        <mi>&#x3bc;</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mi>E</mi>
                      </mrow>
                    </mtd>
                  </mtr>
                </mtable>
                <mo>]</mo>
              </mrow>
              <mi>T</mi>
            </msup>
            <mo>&#x2061;</mo>
            <mrow>
              <mo>[</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>A</mi>
                      <mrow>
                        <mi>K</mi>
                        <mo>-</mo>
                        <mi>m</mi>
                      </mrow>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mrow>
                      <mi>&#x3bb;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>H</mi>
                    </mrow>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mrow>
                      <mi>&#x3bc;</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mi>E</mi>
                    </mrow>
                  </mtd>
                </mtr>
              </mtable>
              <mo>]</mo>
            </mrow>
          </mrow>
          <mo>&#x2062;</mo>
          <mi>q</mi>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <msup>
              <mrow>
                <mo>[</mo>
                <mtable>
                  <mtr>
                    <mtd>
                      <msub>
                        <mi>A</mi>
                        <mrow>
                          <mi>K</mi>
                          <mo>-</mo>
                          <mi>m</mi>
                        </mrow>
                      </msub>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow>
                        <mi>&#x3bb;</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mi>H</mi>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow>
                        <mi>&#x3bc;</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mi>E</mi>
                      </mrow>
                    </mtd>
                  </mtr>
                </mtable>
                <mo>]</mo>
              </mrow>
              <mi>T</mi>
            </msup>
            <mo>&#x2061;</mo>
            <mrow>
              <mo>[</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <mrow>
                      <mrow>
                        <mi>M</mi>
                        <mo>&#x2061;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <msub>
                              <mi>g</mi>
                              <mi>t</mi>
                            </msub>
                            <mo>,</mo>
                            <mrow>
                              <msub>
                                <mi>u</mi>
                                <mrow>
                                  <mn>0</mn>
                                  <mo>,</mo>
                                </mrow>
                              </msub>
                              <mo>&#x2062;</mo>
                              <msub>
                                <mi>v</mi>
                                <mn>0</mn>
                              </msub>
                            </mrow>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                      <mo>-</mo>
                      <msub>
                        <mi>g</mi>
                        <mrow>
                          <mi>t</mi>
                          <mo>+</mo>
                          <mn>1</mn>
                        </mrow>
                      </msub>
                    </mrow>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mrow>
                      <mi>&#x3bc;</mi>
                      <mo>&#x2061;</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <msub>
                            <mi>p</mi>
                            <mrow>
                              <mi>K</mi>
                              <mo>-</mo>
                              <mi>m</mi>
                              <mo>-</mo>
                              <mn>1</mn>
                            </mrow>
                          </msub>
                          <mo>-</mo>
                          <msubsup>
                            <mi>Ep</mi>
                            <mrow>
                              <mi>K</mi>
                              <mo>-</mo>
                              <mi>m</mi>
                            </mrow>
                            <mn>0</mn>
                          </msubsup>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mtd>
                </mtr>
              </mtable>
              <mo>]</mo>
            </mrow>
          </mrow>
          <mo>.</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>14</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0101" num="0111">The motion field computation will be described below with reference to the flow diagram in <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0102" num="0112">In a first step (block <b>100</b>) variable m is initialised at M in order to initialise the resolution level K&#x2212;m at the lowest level K&#x2212;M. On level K&#x2212;M two photograms f<sub>t </sub>and f<sub>t+1 </sub>are considered respectively at time t and at time t+1, and the respective photograms g<sub>t</sub>=f<sub>t</sub><sup>K&#x2212;M </sup>and g<sub>t+1</sub>=f<sub>t+1</sub><sup>K&#x2212;M </sup>are extracted.</p>
<p id="p-0103" num="0113">Motion field p<sub>K&#x2212;M </sub>is then computed (block <b>200</b>) minimising the function which can be expressed according to equations (10) and (11).</p>
<p id="p-0104" num="0114">One level is then risen, going up to level m&#x2212;1, and photograms are extracted for the new resolution level (block <b>300</b>).</p>
<p id="p-0105" num="0115">Motion field p<sub>K&#x2212;m </sub>is then computed (block <b>400</b>) minimising the function which can be expressed through equations (12) and (13) (block <b>400</b>).</p>
<p id="p-0106" num="0116">It is then checked whether the highest level (m=0) has been reached (block <b>500</b>). If such level has been reached, the procedure ends. If such level has still not been reached, the procedure restarts from block <b>300</b> rising by a further level.</p>
<p id="p-0107" num="0117">At the end of the procedure, the final motion field p<sub>k </sub>is obtained.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08625678-20140107-M00001.NB">
<img id="EMI-M00001" he="7.45mm" wi="76.20mm" file="US08625678-20140107-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08625678-20140107-M00002.NB">
<img id="EMI-M00002" he="29.29mm" wi="76.20mm" file="US08625678-20140107-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08625678-20140107-M00003.NB">
<img id="EMI-M00003" he="7.45mm" wi="76.20mm" file="US08625678-20140107-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US08625678-20140107-M00004.NB">
<img id="EMI-M00004" he="7.45mm" wi="76.20mm" file="US08625678-20140107-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US08625678-20140107-M00005.NB">
<img id="EMI-M00005" he="29.29mm" wi="76.20mm" file="US08625678-20140107-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US08625678-20140107-M00006.NB">
<img id="EMI-M00006" he="7.45mm" wi="76.20mm" file="US08625678-20140107-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US08625678-20140107-M00007.NB">
<img id="EMI-M00007" he="12.02mm" wi="76.20mm" file="US08625678-20140107-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US08625678-20140107-M00008.NB">
<img id="EMI-M00008" he="7.45mm" wi="76.20mm" file="US08625678-20140107-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US08625678-20140107-M00009.NB">
<img id="EMI-M00009" he="29.29mm" wi="76.20mm" file="US08625678-20140107-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for a scalable video coding, comprising:
<claim-text>estimating a motion field (p) of a sequence of photograms (f<sub>1</sub>, f<sub>2</sub>, . . . , f<sub>T</sub>) including a plurality of space resolution levels (K, . . . , K&#x2212;m, . . . , K&#x2212;M), wherein the plurality of space resolution levels are between a minimum resolution level (K&#x2212;M) and a maximum resolution level (K),</claim-text>
<claim-text>wherein estimating the motion field comprises:
<claim-text>computing the motion field for each one of said space resolution levels by a minimization of a function,</claim-text>
<claim-text>wherein, for each level which is different from the minimum space resolution level, said function comprises a regularization term including a constraint inherited by a space resolution level which is immediately lower than the level, wherein the constraint represents a difference between a low-pass component of a current motion field for the level and a previously computed motion field for the space resolution level which is immediately lower than the level.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said step of computing the motion field for every level different from the minimum space resolution level is performed sequentially passing from the minimum space resolution level to the maximum space resolution level.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein, for each space resolution level, the motion field comprises an initial motion field (p<sup>0</sup>) and an incremental motion field (q) and said step of computing the motion field (p) comprises computing the incremental motion field (q) and summing the incremental motion field (q) to the initial motion field (p<sup>0</sup>).</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein, for a generic space resolution level with order K&#x2212;m different from the minimum space resolution level, said regularization term between levels can be expressed as:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i><sub>3</sub>(<i>q</i><sub>K&#x2212;m</sub>)=&#x2225;<i>E</i>(<i>q</i><sub>K&#x2212;m</sub><i>+p</i><sub>K&#x2212;m</sub><sup>0</sup>)&#x2212;<i>p</i><sub>K&#x2212;m&#x2212;1</sub>&#x2225;<sup>2</sup>,<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
</claim-text>
<claim-text>where E is a filtering and sub-sampling operator, p<sup>0 </sup>is the initial motion field and q is the incremental motion field, said incremental motion field q in a generic point with coordinates x, y being suitable to be expressed as</claim-text>
<claim-text>
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>q</mi>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>x</mi>
          <mo>,</mo>
          <mi>y</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mo>[</mo>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mi>&#x3b4;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mrow>
                <mi>u</mi>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>x</mi>
                    <mo>,</mo>
                    <mi>y</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mi>&#x3b4;</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <mrow>
                <mi>v</mi>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>x</mi>
                    <mo>,</mo>
                    <mi>y</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
      <mo>]</mo>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>wherein &#x3b4;u and &#x3b4;v are the horizontal and vertical components of the incremental motion field.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein said filtering and sub-sampling operator E is a low-pass component of a wavelet transform.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method according to <claim-ref idref="CLM-00004">claim 4</claim-ref> wherein, for each level different from the minimum space resolution level, said minimization can be expressed as
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>q</i>=arg min{<i>F</i><sub>1</sub>(<i>q</i>)+&#x3bc;<i>F</i><sub>2</sub>(<i>q</i>)+&#x3b4;<i>F</i><sub>3</sub>(<i>q</i>)}<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
</claim-text>
<claim-text>where F<sub>1 </sub>(q) is a term designating the approximation error, F<sub>2 </sub>(q) is a term designating the motion field regularity and &#x3bb; and &#x3bc; are two regularization factors.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein, for said minimum space resolution level, said minimization can be expressed as:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>q</i>=arg min{<i>F</i><sub>1</sub>(<i>q</i>)+&#x3bb;<i>F</i><sub>2</sub>(<i>q</i>)}.<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein, taking into account two photograms g<sub>t </sub>and g<sub>t+1 </sub>at following instants t and t+1 at the generic resolution level K&#x2212;m, the term designating the approximation error can be expressed as:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i><sub>1</sub>(<i>q</i>)=&#x2225;<i>A</i><sub>K&#x2212;m</sub><i>q</i>&#x2212;(<i>M</i>(<i>g</i><sub>t</sub><i>,u</i><sub>0</sub><i>,v</i><sub>0</sub>)&#x2212;<i>g</i><sub>t+1</sub>)&#x2225;<sup>2</sup>, where:<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
<claim-text>u<sub>0 </sub>and v<sub>0 </sub>are the horizontal and vertical components of the initial motion field,</claim-text>
<claim-text>A<sub>k&#x2212;m </sub>is a matrix comprising two diagonal sub-matrixes containing space derivatives of photogram g<sub>t+1</sub>, expressed as A<sub>K&#x2212;m</sub>=[diag(g<sub>t+1</sub><sup>(x)</sup>) diag(g<sub>t+1</sub><sup>(y)</sup>], and</claim-text>
<claim-text>M is a motion operator adapted to distort a generic photogram g in the following way:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>M</i>(<i>g,u,v</i>)(<i>x,y</i>)=<i>g</i>(<i>x&#x2212;u</i>(<i>x,y</i>),<i>y&#x2212;v</i>(<i>x,y</i>)).<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the term designating the motion field regularity can be expressed as
<claim-text>F<sub>2</sub>(q)=&#x2225;Hq&#x2225;<sup>2</sup>, where H is a second derivative operator which can be expressed as:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mrow>
  <mi>H</mi>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mo>[</mo>
      <mtable>
        <mtr>
          <mtd>
            <mfrac>
              <msup>
                <mo>&#x2146;</mo>
                <mn>2</mn>
              </msup>
              <mrow>
                <mo>&#x2146;</mo>
                <msup>
                  <mi>x</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mfrac>
          </mtd>
          <mtd>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mfrac>
              <msup>
                <mo>&#x2146;</mo>
                <mn>2</mn>
              </msup>
              <mrow>
                <mo>&#x2146;</mo>
                <msup>
                  <mi>y</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mfrac>
          </mtd>
          <mtd>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
          </mtd>
          <mtd>
            <mfrac>
              <msup>
                <mo>&#x2146;</mo>
                <mn>2</mn>
              </msup>
              <mrow>
                <mo>&#x2146;</mo>
                <msup>
                  <mi>x</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mfrac>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
          </mtd>
          <mtd>
            <mfrac>
              <msup>
                <mo>&#x2146;</mo>
                <mn>2</mn>
              </msup>
              <mrow>
                <mo>&#x2146;</mo>
                <msup>
                  <mi>y</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mfrac>
          </mtd>
        </mtr>
      </mtable>
      <mo>]</mo>
    </mrow>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising, before the steps of computing the motion fields, the further step of building photograms at different space resolution levels starting from photograms at maximum space resolution level.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein, for each space resolution level, the step of building photograms comprises filtering and sub-sampling photograms at maximum space resolution level, said step of filtering and sub-sampling being performed a number of times equal to the number of levels separating the considered space resolution level from the maximum space resolution level.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the step of filtering and sub-sampling comprises the following steps:
<claim-text>low-pass filtering along the rows;</claim-text>
<claim-text>sub-sampling the columns;</claim-text>
<claim-text>low-pass filtering along the columns; and</claim-text>
<claim-text>sub-sampling the rows.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said function can be expressed through an optical flow equation.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method for transmitting coded video images, comprising the steps of coding a video image according to the method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, transmitting the coded image, receiving the coded image and decoding the received coded image.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method according to <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the step of decoding comprises applying to said coded video image at least one transform of the wavelet type for obtaining a sequence of photograms at a desired resolution level.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A non-transitory computer readable medium encoded with a computer program capable of being directly loaded in a memory of a data processing system and configured to implement, when executed, the method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. A system comprising a processor for performing the steps of the method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text>
</claim>
</claims>
</us-patent-grant>
