<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08622609-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08622609</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13949806</doc-number>
<date>20130724</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>B</section>
<class>01</class>
<subclass>F</subclass>
<main-group>13</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>366348</main-classification>
<further-classification>366349</further-classification>
</classification-national>
<invention-title id="d2e43">Valve switch modulation for reducing errors due to oscillations of the inlet fluid of a pump system</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>3985019</doc-number>
<kind>A</kind>
<name>Boehme et al.</name>
<date>19761000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>4595496</doc-number>
<kind>A</kind>
<name>Carson</name>
<date>19860600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>4767279</doc-number>
<kind>A</kind>
<name>Dourdeville et al.</name>
<date>19880800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6893547</doc-number>
<kind>B2</kind>
<name>Gascoyne et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>204547</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2002/0134143</doc-number>
<kind>A1</kind>
<name>Allington et al.</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00006">
<othercit>International Search Report and Written Opinion in related international patent application No. PCT/US2009/056434, mailed on Oct. 30, 2009.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>6</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>366348329</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>2101982</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>210656</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>10</number-of-drawing-sheets>
<number-of-figures>19</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>13063382</doc-number>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>8517597</doc-number>
</document-id>
</parent-grant-document>
<parent-pct-document>
<document-id>
<country>WO</country>
<doc-number>PCT/US2009/056434</doc-number>
<date>20090910</date>
</document-id>
</parent-pct-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13949806</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61096480</doc-number>
<date>20080912</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20130308415</doc-number>
<kind>A1</kind>
<date>20131121</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only" applicant-authority-category="assignee">
<addressbook>
<orgname>Waters Technologies Corporation</orgname>
<address>
<city>Milford</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Shreve</last-name>
<first-name>Joshua A.</first-name>
<address>
<city>Franklin</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Ciavarini</last-name>
<first-name>Steven J.</first-name>
<address>
<city>Natick</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Schmeiser, Olsen &#x26; Watts LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Guerin</last-name>
<first-name>William G.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Waters Technologies Corporation</orgname>
<role>02</role>
<address>
<city>Milford</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Soohoo</last-name>
<first-name>Tony G</first-name>
<department>1774</department>
</primary-examiner>
<assistant-examiner>
<last-name>Bhatia</last-name>
<first-name>Anshu</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Described is a method of reducing liquid composition errors in a low-pressure mixing pump system. Packets representing the switching intervals of each component of the desired fluid mixture are provided to an intake of the mixing pump system. For each packet, a switching time associated with at least one of the components in the packet is modulated. Modulated switching times are based on time offsets that are specifically selected according to the undesirable frequency characteristic of an intake response of the mixing pump system. The average of the volumes contributed by the packets thus modulated is equal to a component volume that achieves a desired proportion of the component in the output flow of the mixing pump system. Modulated switching times enable the reduction or elimination of composition error in the output flow of the mixing pump system.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="133.01mm" wi="155.45mm" file="US08622609-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="209.55mm" wi="165.69mm" file="US08622609-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="247.48mm" wi="190.75mm" file="US08622609-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="242.15mm" wi="188.47mm" orientation="landscape" file="US08622609-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="204.30mm" wi="183.22mm" file="US08622609-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="219.79mm" wi="166.03mm" orientation="landscape" file="US08622609-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="211.16mm" wi="185.84mm" file="US08622609-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="224.03mm" wi="188.13mm" file="US08622609-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="148.59mm" wi="190.08mm" file="US08622609-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="137.41mm" wi="184.49mm" file="US08622609-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="191.77mm" wi="163.75mm" file="US08622609-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is a continuation patent application of U.S. patent application Ser. No. 13/063,382, filed May 11, 2011, which is the national stage of International Application No. PCT/US2009/056434, filed Sep. 10, 2009 and designating the United States, which claims benefit of and priority to U.S. Provisional Patent Application No. 61/096,480, filed Sep. 12, 2008. The contents of these applications are expressly incorporated herein by reference in their entireties.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The invention relates generally to switching valves in liquid pump systems. More particularly, the invention relates to a method for reducing errors resulting from the intake fluid behavior of a gradient proportioning valve in a low pressure gradient pump system for liquid chromatography.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">A variety of applications exist in which the need to meter two or more liquids in accurately controlled proportions is critical. One such application is liquid chromatography wherein an analyte sample is passed in a flow of liquid solvent (the mobile phase) through a column packed with particulate matter (the stationary phase). While passing through the column, the various components in the sample separate from one another by adsorbing and desorbing from the stationary phase at different rates such that the individual components elute from the column at different times. The separated components flow through a detector which responds to each component and provides information to the user about the constituents of the sample.</p>
<p id="p-0005" num="0004">To achieve more effective separations, high performance liquid chromatography (HPLC) systems often use mixtures of solvents as the mobile phase. When this mixture is held constant, the system operates in an isocratic mode. More conventionally, the system operates in a gradient mode whereby the components of the mixture are changed over time.</p>
<p id="p-0006" num="0005">As used herein, a packet means a sequential contribution of fluid components provided to the pump intake. <figref idref="DRAWINGS">FIG. 1</figref> graphically depicts an example of two consecutive packets where each packet includes contributions from a first solvent A, then a second solvent B, then a third solvent C and finally a fourth solvent D. A slice as used herein means the contribution of a single component to a packet. Thus the volume of component A in each packet is the first slice for the packet, the volume of component B in each packet represents the second slice for the packet, and so forth.</p>
<p id="p-0007" num="0006">During gradient chromatography, metering and accuracy of the pump system is dependent on the valves controlling the volume of fluid drawn into the pump for each slice. Conventional metering techniques are based on an intake flow that accurately follows the commanded flow; however, the intake flow typically behaves like an underdamped system. <figref idref="DRAWINGS">FIG. 2</figref> shows an example of the flow error due to the switching of a valve. As illustrated, the flow error is a decaying sinusoid. The flow errors for a given system vary according to the gas solubility, viscosity, and compliance of the solvents and other factors relating to hydraulic inertia. Subsequent switching of the valves typically results in errors in the relative proportions of the components unless the switching occurs at a zero error crossing. Moreover, each additional switching event similarly results in a new intake flow disturbance and corresponding flow error that can adversely affect the desired proportions of components.</p>
<p id="p-0008" num="0007">Thus liquid chromatography performance being greatly dependent on the compositional accuracy of the solvent mixture is typically limited by errors due to the system intake response of the pump system and proportioning valve. The present invention addresses the need to reduce these errors.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0009" num="0008">The invention relates to a method for reducing composition error in the output flow of a low pressure mixing pump system due to the intake behavior of the pump system. Actuation of the switching valves for one or more of the components vary in time with respect to the initiation of a packet. This modulation of the actuation times and the consequential modulation of corresponding component volumes are performed in a manner that preserves the average of the component volumes to achieve the desired proportions in the output flow of the pump system. The modulation pattern is specifically selected according to frequency characteristics of the intake response of the pump system to reduce or cancel related errors.</p>
<p id="p-0010" num="0009">In one aspect, the invention features a method for reducing composition error in the output flow of a mixing pump system. The method includes, for each packet in a plurality of packets provided to an intake of the mixing pump system, modulating a switching time of at least one component in the packet according to an element in a vector having a number n of elements d in a sequence from d<sub>1 </sub>to d<sub>n</sub>, each of the elements indicating a switching time offset value, the modulation of the switching time of the at least one component defined according to the sequence of the elements in the vector, wherein the switching time offset values are determined in response to a frequency characteristic of an intake response of the mixing pump system and wherein an average of a component volume for each of the components equals a component volume predetermined to achieve a proportion of the respective component in the output flow.</p>
<p id="p-0011" num="0010">In another aspect, the invention features a method for reducing composition error in the output flow of a mixing pump system. The method includes, for each packet in a plurality of packets provided to an intake of a mixing pump system, determining a plurality of switching time offsets for a modulation of a switching time of at least one component in a plurality of components in the packet. The determination of the switching time offsets are based on a frequency characteristic of an intake response of the mixing pump system and an average of a component volume for each of the components in the plurality of packets equals a component volume predetermined to achieve a proportion of the respective component in an output flow of the mixing pump system. The switching time offsets define a switching time modulation range that includes an unmodulated switching time. The method also includes determining a plurality of scaled switching time offsets if a difference in time between at least one of the switching time offsets and an unmodulated switching time is greater than an available switching time. Each of the scaled switching time offsets is proportionally decreased in value from a respective one of the switching time offsets. For each of the scaled switching time offsets, a difference in time between the scaled switching time offset and the unmodulated switching time does not exceed an available switching time.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0012" num="0011">The above and further advantages of this invention may be better understood by referring to the following description in conjunction with the accompanying drawings, in which like numerals indicate like structural elements and features in the various figures. For clarity, not every element may be labeled in every figure. The drawings are not necessarily to scale, emphasis instead being placed upon illustrating the principles of the invention.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 1</figref> is an illustration of an example of two consecutive packets composed of slices.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 2</figref> graphically illustrates flow error resulting from the switching of a valve.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of a liquid chromatography system that can be used to practice an embodiment of the method of the invention.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 4</figref> illustrates the reduction of flow error in comparison to the flow error of <figref idref="DRAWINGS">FIG. 2</figref> resulting from switching time offset modulation according to an embodiment of the invention.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 5</figref> graphically illustrates examples of a binary gradient for unmodulated switching times and a binary gradient achieved using modulated switching times according to an embodiment of the method of the invention.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIGS. 6A and 6B</figref> graphically illustrate a six-point modulation scheme and the corresponding frequency response according to an embodiment of the invention.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 7</figref> is a timeline depicting an embodiment of the method of the invention using a two-point modulation scheme to control the switching of four solvents.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIGS. 8A to 8H</figref> illustrate the application of an embodiment of the method of the invention according to a first rule for different values of packets per pump stroke and slices per packet.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 9</figref> illustrates the application of an embodiment of the method of the invention according to a second rule for two packets per pump stroke and three slices per packet.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 10A</figref> and <figref idref="DRAWINGS">FIG. 10B</figref> graphically illustrate an example of a timeline for switching events based on switching time modulation and a modified timeline based on a collapsed vector of switching time offset values according to an embodiment of the method of the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0023" num="0022">In brief overview, the invention relates to a method for reducing composition error in the output flow of a low pressure mixing pump system due to the intake behavior of the pump system. Actuation of the switching valves for one or more of the components vary in time with respect to the initiation of a packet. This modulation of the actuation times and the consequential modulation of corresponding component volumes are performed in a manner that preserves the average of the component volumes necessary to achieve the desired proportions. The modulation pattern is specifically selected according to frequency characteristics of the intake response of the pump system to reduce or cancel related errors. The method produces predictable results that do not vary in time.</p>
<p id="p-0024" num="0023">In the following description, the switching of proportioning valves is generally specified with respect to time; however, in preferred embodiments switching is referenced to the volume domain according to component volume. For example, switching events may be indexed to pump stroke displacement or stepper motor position so that variations from a constant inlet flow rate can be accommodated.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of a liquid chromatography system <b>10</b> that can be used to practice the method of the invention. The system <b>10</b> includes a system controller <b>14</b> (e.g., microprocessor) in communication with a user interface device <b>18</b> for receiving input parameters and displaying system information. The system controller <b>14</b> communicates with a valve drive module <b>22</b> for operating a gradient proportioning valve (GPV) <b>26</b> and a motor drive module <b>30</b> for operating one or more stepper motors for a pump system <b>34</b>. The pump system <b>34</b> can include complementary pump heads that are operated in opposite phase as is known in the art. The gradient proportioning valve <b>26</b> includes a plurality of fluid switching valves which are in turn connected by tubing to respective component reservoirs <b>38</b>A, <b>38</b>B, <b>38</b>C, <b>38</b>D that hold the components (solvents) to be combined. The fluid switching valves of the gradient proportioning valve <b>26</b> are coupled through a common outlet port which in turn is connected to the inlet port of the pump system <b>34</b>. The outlet port of the pump system <b>34</b> delivers the mixture of solvents to a chromatographic column <b>42</b>, typically at much higher pressures.</p>
<p id="p-0026" num="0025">During operation of the liquid chromatography system, the switching valves of the gradient proportioning valve <b>26</b> are opened sequentially so that the pump system <b>34</b> draws liquid from each of the reservoirs <b>38</b>. The proportions of solvents present in the liquid mixture delivered by the pump system <b>34</b> depend on the relative actuation time of each of the switching valves in relation to the inlet velocity profile during the intake cycle.</p>
<p id="p-0027" num="0026">As described above, the initiation of intake for a pump typically results in the start of an intake response as shown in <figref idref="DRAWINGS">FIG. 2</figref> where an error occurs in the desired intake flow rate. According to the method of the invention, switching times (i.e., the times at which the switching valves are actuated) are carefully determined so that the volume contributions for each slice of a given solvent average to a desired value. These switching times are offset in time from switching times used in a conventional pump system in which the error in the intake flow rate due to the intake response is ignored or left uncompensated.</p>
<p id="p-0028" num="0027">In one embodiment of the method, if a dominant frequency appears in the intake response as depicted in <figref idref="DRAWINGS">FIG. 2</figref>, a two-point offset modulation of the switching times is used to target the dominant frequency and thereby significantly reduce the error. Instead of operating the switching valve at the proportioned time after each packet initiation time, as with a conventional pump system, the switching valve is actuated early by one-quarter of the period of the sinusoid and on the next packet, the switching valve is actuated late by one-quarter of the period of the sinusoid. The earlier switching time T<sub>1 </sub>is used for the first slice of the solvent and the later switching time T<sub>2 </sub>is used for the slice of the solvent in the next packet. Switching times T<sub>1 </sub>and T<sub>2 </sub>are alternated for subsequent packets. Thus the volume of the solvent introduced in the slice starting at the earlier switching time T<sub>1 </sub>is slightly greater than the amount necessary to maintain the desired proportion of solvents; however, the volume of the solvent introduced in the slice for the next packet starting at the later switching time T<sub>2 </sub>is slightly less than the proper amount. Consequently, the average volume of the solvent remains unchanged from that of an unmodulated pump system with no flow error. In a complementary manner, the volume of a solvent in the slice that immediately precedes the modulated switching events is first less than and then subsequently greater than the desired volume for that solvent such that its average volume is also the same as the volume of that solvent for a slice in an unmodulated pump system with no flow error. For embodiments in which the offset modulation uses three or more modulation points, there is no requirement for complimentary offset times as in the two-point offset modulation scheme; however, the average contributions of the solvents after utilizing all the modulation points are the same as the volumes of the solvents for respective slices in an unmodulated pump system without flow error.</p>
<p id="p-0029" num="0028">Although the times T<sub>1 </sub>and T<sub>2 </sub>are shown in the example based on <figref idref="DRAWINGS">FIG. 2</figref> to correspond to a maximum flow error and a subsequent minimum flow error, in other embodiments the switching times occur at other positions (times) in the intake response, although the difference in the switching times T<sub>1 </sub>and T<sub>2 </sub>remains the same. <figref idref="DRAWINGS">FIG. 4</figref> illustrates how this error varies in time for other positions of T<sub>1 </sub>and T<sub>2 </sub>relative to the intake response. Due to the decaying nature of the sinusoidal intake response, the error is generally not completely eliminated; however, the error is generally much less than the error that occurs in a system without switching time modulation. In effect, the determination of the switching times according to the invention is based on digital filtering. For a two-point modulation scheme the digital filter targets the dominant frequency of the sinusoidal intake response. In this case, the difference between times T<sub>1 </sub>and T<sub>2 </sub>is half the period of the sinusoidal intake response.</p>
<p id="p-0030" num="0029">In general, a more complex pattern of switching to accommodate a range of frequencies present in an intake response is preferred. The switching time offsets correspond to a digital filter implementation where the offsets are selected to achieve the desired filter frequency characteristic. Using more switching time offsets generally enables better filter frequency control; however, more switching time offsets requires more time to achieve the proper volume averages and therefore can make mixing more difficult. The sum of the switching time offsets are zero so that the average of the switching times matches the switching time in an unmodulated system with no flow error. Consequently, the desired solvent proportions are achieved. In effect, the method of the invention is based on a tradeoff: compositional noise is introduced to the pump system by inducing offsets in the switching times; however, the accuracy of the pump system as measured according to component volumes is improved.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 5</figref> shows an example of a linear gradient for a two solvent liquid phase (i.e., a binary gradient). The line <b>50</b> indicates the gradient achieved using a gradient proportioning valve with modulated switching times according to the method of the invention. The line <b>54</b> indicates the gradient achieved using a gradient proportioning valve with fixed (unmodulated) switching times. Although high frequency deviations from a linear gradient are observable for the modulated gradient <b>50</b>, these deviations are small with respect to deviation from a linear gradient for the unmodulated system.</p>
<p id="p-0032" num="0031">The desired frequency characteristic of the digital filter is determined by measurement for a range of solvents of interest and the switching times are selected based on the determined frequency characteristic. <figref idref="DRAWINGS">FIG. 6A</figref> shows an example of a six-point modulation scheme and <figref idref="DRAWINGS">FIG. 6B</figref> shows the corresponding frequency response. Switching is performed in sequence at the times T<sub>1</sub>, T<sub>2</sub>, T<sub>3</sub>, T<sub>4</sub>, T<sub>5 </sub>and T<sub>6</sub>. The unmodulated switching time T<sub>0 </sub>for a conventional pump system is shown for comparison and is the same as the average for the modulated switching times. Times T<sub>1</sub>, T<sub>3 </sub>and T<sub>5 </sub>represent delayed switching relative to the average switching time T<sub>0 </sub>and times T<sub>2</sub>, T<sub>4 </sub>and T<sub>6 </sub>are advanced relative to the average switching time T<sub>0</sub>.</p>
<p id="p-0033" num="0032">The switching time offsets shown in <figref idref="DRAWINGS">FIG. 6A</figref> are symmetrically distributed about the average switching time T<sub>0 </sub>so that the number of advanced switching events equals the number of delayed switching events. In other embodiments the number of switching time offsets can be odd so that there is no symmetry about the average switching time T<sub>0</sub>, although the average switching time is maintained at T<sub>0</sub>. Preferably, the switching time offsets are implemented in an order such that the average of any two switching time offsets is approximately zero to better shape the noise introduced in the modulation process.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 7</figref> is a timeline depiction for an embodiment of the method of the invention using a two-point modulation scheme. As illustrated, the method is used to control the switching of four solvents A, B, C and D per packet with one packet occurring for each pump stroke. Actuation of each switch to provide the corresponding solvent results in an intake response in the form of a decaying sinusoid as described above. On a first pump stroke, actuation of switch <b>1</b> for solvent B occurs at time T<sub>B1 </sub>and results in the intake response labeled Switch <b>1</b>-Packet <b>1</b>. On the next pump stroke, actuation of switch <b>1</b> for solvent B occurs at time T<sub>B2 </sub>and results in the intake response labeled Switch <b>1</b>-Packet <b>2</b>. The two offset intake responses resulting from the modulation of switch <b>1</b> for solvent B permits switch <b>2</b> for solvent C to be unmodulated. More specifically, a first actuation of switch <b>2</b> at time T<sub>C </sub>occurs at a relative low point in the Switch <b>1</b>-Packet <b>1</b> intake response of solvent B and the next actuation of switch <b>2</b> during the next packet at time T<sub>C </sub>occurs at a relative high point in the Switch <b>1</b>-Packet <b>2</b> intake response. Effectively, the actuation time of switch <b>2</b> is modulated with respect to the intake response of solvent B in an alternating manner about an average value without actually changing the modulation time T<sub>C </sub>relative to the intake initiation time T<sub>A</sub>. Thus the variation of the volume for each slice of solvent B is due only to the modulation of switch <b>1</b>. As switch <b>2</b> has no offset modulation, the actuation time T<sub>D </sub>of switch <b>3</b> is modulated to prevent the intake response for solvent D from always starting at the same position along the intake response of solvent C. As shown, switch <b>3</b> actuates first at a time T<sub>D1 </sub>and then during the next packet at a time T<sup>D2 </sup>with further switch actuations for subsequent packets occurring in an alternating fashion.</p>
<p id="p-0035" num="0034">It should be recognized that the switching time modulation described with reference to <figref idref="DRAWINGS">FIG. 7</figref> can be extended in a more general sense to any number of solvents. In particular, switching time modulation is applied to the switches providing &#x201c;even solvents&#x201d; (e.g., solvent B and solvent D) while no modulation of the switching times is necessary for &#x201c;odd solvents&#x201d; (e.g., solvent A and solvent C).</p>
<p id="p-0036" num="0035">The method of the invention can be described more generally as follows. The switching time offsets d are defined by a vector having n elements each indicating a switching time offset value (d<sub>1</sub>, d<sub>2</sub>, d<sub>3</sub>, . . . , d<sub>n</sub>). m is a variable representing the index of the elements of the vector. Once all switching time offsets values d are used (i.e., m&#x3e;n), the values d are used again in order starting with d<sub>1</sub>, (i.e., m=(m mod n)+1).</p>
<p id="p-0037" num="0036">The method is applied according to either of two rules where the particular rule selected is determined according to the number of packets per pump stroke and the number of slices per packet. The first rule is applied if the number of packets per pump stroke does not exceed one or if the number of slices per packet is an even number. According to the first rule, modulation is performed for the first switching event and every other switching event in a pump stroke. The occurrence of a new pump stroke resets the counting of the switching events for a pump stroke. For each new packet, the next value in sequential order in the switching time offset vector is used.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 8A</figref> to <figref idref="DRAWINGS">FIG. 8H</figref> illustrate the application of the first rule for different values of packets per pump stroke (PpS) and slices per packet (SpP). Dashed vertical lines are used to show the initiation of a pump stroke. Hashed areas depicted under the switching time offset &#x201c;d<sub>n</sub>&#x201d; are used to indicate the increase and decrease in time and volume for the adjacent slices.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 8A</figref> illustrates one packet per pump stroke and two slices per packet, and <figref idref="DRAWINGS">FIG. 8B</figref> illustrates two packets per pump stroke and two slices per packet. <figref idref="DRAWINGS">FIG. 8C</figref> illustrates one-half packet per pump stroke and two slices per packet. <figref idref="DRAWINGS">FIGS. 8D</figref>, <b>8</b>E and <b>8</b>F illustrate one, two and on-half packets per pump stroke, respectively, for four slices per packet. <figref idref="DRAWINGS">FIGS. 8G and 8H</figref> illustrate one and one-half packets per pump stroke, respectively, for three slices per packet. Either two or four elements are included in the switching time offset vector for the illustrated cases.</p>
<p id="p-0040" num="0039">The second rule is applied when the number of packets per pump stroke is greater than one and the number of slices per packet is an odd number. Similar to the first rule, modulation is performed for the first switching event and every other switching event in a pump stroke. The switching time offsets d are selected as d<sub>(st+dsw) </sub>from the switching time offset vector where st is the pump stroke number and dsw is the modulated switch number. The value of dsw resets to zero at the start of a pump stroke because the intake response in one intake of the dual head pump system does not have an effect on the following intake stroke at the other intake. An alternative technique is to apply a single switching time offset for each pump stroke; however, this alternative is not preferred as it generates longer term noise than is necessary to achieve the desired error reduction.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 9</figref> is an example application of the second rule for a case in which there are two packets per pump stroke and three slices per packet. The first switching occurrence between solvents B and C and the second switching occurrence between solvents A and B in a pump stroke are unmodulated because they are &#x201c;even-numbered&#x201d; switching events within the pump stroke. For the first and subsequent &#x201c;odd-numbered&#x201d; switching occurrences in a pump stroke the switching time offsets chosen from the switching time offset vector are incremented by one relative to the switching time offsets used in the previous stroke.</p>
<p id="p-0042" num="0041">Table 1 summarizes how the switching time offsets are applied in a more general sense. The number of switching time offsets that are used is determined by the number n of elements in the vector. When m increases so that it exceeds n, m is reset and the switching time offsets are again used in order of occurrence in the vector beginning with d<sub>1</sub>.</p>
<p id="p-0043" num="0042">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="28pt" align="center"/>
<colspec colname="2" colwidth="175pt" align="center"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="2" rowsep="1">TABLE 1</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Stroke</entry>
<entry/>
</row>
<row>
<entry/>
<entry>Number</entry>
<entry>Modulated Switching Number (dsw)</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="7">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="28pt" align="center"/>
<colspec colname="2" colwidth="21pt" align="center"/>
<colspec colname="3" colwidth="28pt" align="center"/>
<colspec colname="4" colwidth="49pt" align="center"/>
<colspec colname="5" colwidth="28pt" align="center"/>
<colspec colname="6" colwidth="49pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>(st)</entry>
<entry>1</entry>
<entry>2</entry>
<entry>3</entry>
<entry>4</entry>
<entry>m</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="6" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>1</entry>
<entry>d<sub>1</sub></entry>
<entry>d<sub>2</sub></entry>
<entry>d<sub>3</sub></entry>
<entry>d<sub>4</sub></entry>
<entry>d<sub>m</sub></entry>
</row>
<row>
<entry/>
<entry>2</entry>
<entry>d<sub>2</sub></entry>
<entry>d<sub>3</sub></entry>
<entry>d<sub>4</sub></entry>
<entry>d<sub>5</sub></entry>
<entry>d<sub>1 </sub>+ m</entry>
</row>
<row>
<entry/>
<entry>3</entry>
<entry>d<sub>3</sub></entry>
<entry>d<sub>4</sub></entry>
<entry>d<sub>5</sub></entry>
<entry>d<sub>6</sub></entry>
<entry>d<sub>2 </sub>+ m</entry>
</row>
<row>
<entry/>
<entry>4</entry>
<entry>d<sub>4</sub></entry>
<entry>d<sub>5</sub></entry>
<entry>d<sub>6</sub></entry>
<entry>d<sub>7</sub></entry>
<entry>d<sub>3 </sub>+ m</entry>
</row>
<row>
<entry/>
<entry>n</entry>
<entry>d<sub>n</sub></entry>
<entry>d<sub>n </sub>+ 1 </entry>
<entry>d<sub>n </sub>+ 2</entry>
<entry>d<sub>n </sub>+ 3</entry>
<entry>d<sub>n </sub>+ m</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="6" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0044" num="0043">Every switching event and the beginning and the end of pump strokes are occurrences which generally are accounted for when implementing the method of switching time modulation according to the invention. In particular, the minimum time for the actuation of a switch and the available time T<sub>AVAIL </sub>measured from the unmodulated switching time to the next event, such as the next switching time or the beginning of the next stroke, can limit application of the method. T<sub>0 </sub>accommodate such limitations, one embodiment of the method includes scaling, or &#x201c;collapsing,&#x201d; the vector of switching time offset values.</p>
<p id="p-0045" num="0044">To decide whether collapsing is to be performed, the available time T<sub>AVAIL </sub>about a switching time is determined. The value of a parameter K is given by
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>K=T</i><sub>AVAIL</sub>/max(abs(<i>d</i>))<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where the numerator is the maximum value determined from the absolute values of the switching time offset values in the vector. If K is equal to or greater than one, no collapsing is necessary as the available time T<sub>AVAIL </sub>accommodates all of the switching time offsets; however, if K is less than one, all elements of the vector are scaled by K so that the width of the switching time modulation range is effectively collapsed. Scaling of the switching offset times ensures that all switching time offsets can be used within the available time T<sub>AVAIL</sub>.
</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 10A</figref> and <figref idref="DRAWINGS">FIG. 10B</figref> graphically illustrate an example of a timeline for switching events based on switching time modulation and a modified timeline based on a collapsed vector of switching time offset values. In <figref idref="DRAWINGS">FIG. 10A</figref> there are six different switching times t<sub>1 </sub>to t<sub>6 </sub>corresponding to six switching time offsets d<sub>1 </sub>to d<sub>6</sub>, respectively. The time T<sub>AVAIL </sub>indicates the latest time in which a switching event is allowed to occur. Times t<sub>1 </sub>and t<sub>3 </sub>occur after the expiration of available time therefore the vector of switching time offset values is scaled by the constant K as shown in <figref idref="DRAWINGS">FIG. 10B</figref> so that all possible modulated switching times t&#x2032; are accommodated in the available time. The value of K is selected such that the full spread of possible switching times based on the vector fits into the available time.</p>
<p id="p-0047" num="0046">The frequency characteristic of the digital filtering performed with the collapsed switching time offsets scales according to the value of K. An example of this effect can be seen by again referring to <figref idref="DRAWINGS">FIG. 5</figref> where the modulation observed on the linear gradient <b>50</b> is significantly decreased in the lowest and highest concentration regions.</p>
<p id="p-0048" num="0047">In a preferred embodiment, the commanded switching times for the gradient proportioning valve are advanced (i.e., &#x201c;time-shifted&#x201d;) to ensure that valve actuation occurs at the proper time to overcome valve delay and thereby provide the desired volumes for the slices. As the pump works in the volume/motor position domain, the time shift is converted to motor steps. T<sub>0 </sub>reduce complexity, a constant intake velocity is assumed; therefore positional shift is equal to velocity multiplied by time shift. This assumption yields error when the time shifts occur on the acceleration and deceleration regions of the intake velocity profile. This error is generally small therefore the constant intake velocity assumption is sufficient in most cases.</p>
<p id="p-0049" num="0048">The above descriptions and embodiments are based on time and a constant pump velocity, therefore the volume variations for each slice due to switching time offset modulation are averaged out. In another preferred embodiment, the switching time offsets are converted into position steps of the pump motor. More specifically, the timing is mapped to stepper motor position to account for variation of the intake volume of the pump in time so that a volumetric average is achieved instead of a switching time offset average. This mapping is important when switching times occur early or late in a pump stroke when the pump velocity is accelerating or decelerating.</p>
<p id="p-0050" num="0049">While the invention has been shown and described with reference to specific embodiments, it should be understood by those skilled in the art that various changes in form and detail may be made therein without departing from the spirit and scope of the invention as recited in the accompanying claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for reducing composition error in the output flow of a mixing pump system, the method comprising, for each packet in a plurality of packets provided to an intake of the mixing pump system, modulating a switching time of at least one component in the packet according to an element in a vector having a number n of elements d in a sequence from d<sub>1 </sub>to d<sub>n</sub>, each of the elements indicating a switching time offset value, the modulation of the switching time of the at least one component defined according to the sequence of the elements in the vector, wherein the switching time offset values are determined in response to a frequency characteristic of an intake response of the mixing pump system and wherein an average of a component volume for each of the components equals a component volume predetermined to achieve a proportion of the respective component in the output flow.</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the modulation of the switching time of the at least one component includes repeating for one or more times the sequence of the elements in the vector.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein, if the number of packets in a pump stroke does not exceed one or if the number of components in a packet is an even number, modulating a switching time for a first switching event and every other switching event in a pump stroke and resetting a counting of the switching events for a pump stroke for an occurrence of a new pump stroke, wherein for each additional packet, a switching time offset value according to the next element in the sequence of elements in the vector is used.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein, if the number of packets in a pump stroke exceeds one and the number of components in a packet is an odd number, the elements d<sub>1 </sub>to d<sub>n </sub>in the vector being selected to control modulation according to d<sub>(st+dsw) </sub>wherein st is a pump stroke number and dsw is a modulated switch number, and wherein a value of dsw resets to zero at the start of a pump stroke.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A method for reducing composition error in the output flow of a mixing pump system, the method comprising:
<claim-text>for each packet in a plurality of packets provided to an intake of a mixing pump system, determining a plurality of switching time offsets for a modulation of a switching time of at least one component in a plurality of components in the packet, wherein the determination of the switching time offsets is based on a frequency characteristic of an intake response of the mixing pump system and wherein an average of a component volume for each of the components in the plurality of packets equals a component volume predetermined to achieve a proportion of the respective component in an output flow of the mixing pump system, the switching time offsets defining a switching time modulation range that includes an unmodulated switching time; and</claim-text>
<claim-text>determining a plurality of scaled switching time offsets if a difference in time between at least one of the switching time offsets and an unmodulated switching time is greater than an available switching time, wherein each of the scaled switching time offsets is proportionally decreased in value from a respective one of the switching time offsets and wherein, for each of the scaled switching time offsets, a difference in time between the scaled switching time offset and the unmodulated switching time does not exceed an available switching time.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the available switching time is based on a time for completion of a pump stroke. </claim-text>
</claim>
</claims>
</us-patent-grant>
