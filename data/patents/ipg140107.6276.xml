<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08627422-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08627422</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13288949</doc-number>
<date>20111103</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>29</main-group>
<subgroup>06</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20130101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>21</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726  5</main-classification>
<further-classification>713175</further-classification>
<further-classification>380358</further-classification>
</classification-national>
<invention-title id="d2e43">Authentication in secure user plane location (SUPL) systems</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6789078</doc-number>
<kind>B2</kind>
<name>Saitou et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7120675</doc-number>
<kind>B1</kind>
<name>Shupak et al.</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7729706</doc-number>
<kind>B2</kind>
<name>Kim et al.</name>
<date>20100600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7900039</doc-number>
<kind>B2</kind>
<name>Shim et al.</name>
<date>20110300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7929965</doc-number>
<kind>B2</kind>
<name>Shim et al.</name>
<date>20110400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>8068056</doc-number>
<kind>B2</kind>
<name>Wachter et al.</name>
<date>20111100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2005/0015595</doc-number>
<kind>A1</kind>
<name>Edwards et al.</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713168</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2005/0108520</doc-number>
<kind>A1</kind>
<name>Yamamoto et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713155</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2005/0125493</doc-number>
<kind>A1</kind>
<name>Chaskar et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2006/0058042</doc-number>
<kind>A1</kind>
<name>Shim</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2006/0143705</doc-number>
<kind>A1</kind>
<name>Sentoff</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2006/0242404</doc-number>
<kind>A1</kind>
<name>Su</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713150</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2006/0246919</doc-number>
<kind>A1</kind>
<name>Park et al.</name>
<date>20061100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2007/0135089</doc-number>
<kind>A1</kind>
<name>Edge et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2007/0238458</doc-number>
<kind>A1</kind>
<name>Shim</name>
<date>20071000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2007/0286212</doc-number>
<kind>A1</kind>
<name>Kim et al.</name>
<date>20071200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2008/0045237</doc-number>
<kind>A1</kind>
<name>Yan</name>
<date>20080200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4554561</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2008/0133762</doc-number>
<kind>A1</kind>
<name>Edge et al.</name>
<date>20080600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2008/0233931</doc-number>
<kind>A1</kind>
<name>Shim</name>
<date>20080900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2008/0254809</doc-number>
<kind>A1</kind>
<name>Kraufvelin et al.</name>
<date>20081000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>2009/0104904</doc-number>
<kind>A1</kind>
<name>Shim</name>
<date>20090400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>2009/0181698</doc-number>
<kind>A1</kind>
<name>Farmer et al.</name>
<date>20090700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2009/0209269</doc-number>
<kind>A1</kind>
<name>Shim et al.</name>
<date>20090800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>2010/0311439</doc-number>
<kind>A1</kind>
<name>Thomson et al.</name>
<date>20101200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>2010/0325702</doc-number>
<kind>A1</kind>
<name>Su</name>
<date>20101200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  4</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>2011/0035788</doc-number>
<kind>A1</kind>
<name>White et al.</name>
<date>20110200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  4</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>2011/0136472</doc-number>
<kind>A1</kind>
<name>Rector et al.</name>
<date>20110600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>2011/0264780</doc-number>
<kind>A1</kind>
<name>Reunamaeki et al.</name>
<date>20111000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00029">
<document-id>
<country>US</country>
<doc-number>2012/0173613</doc-number>
<kind>A1</kind>
<name>Bryan</name>
<date>20120700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00030">
<document-id>
<country>US</country>
<doc-number>2012/0202447</doc-number>
<kind>A1</kind>
<name>Edge et al.</name>
<date>20120800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00031">
<document-id>
<country>US</country>
<doc-number>2012/0202517</doc-number>
<kind>A1</kind>
<name>Edge et al.</name>
<date>20120800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00032">
<othercit>International Search Report and Written Opinion&#x2014;PCT/US2012/024003&#x2014;ISA/EPO&#x2014;May 24, 2012, 11 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00033">
<othercit>Lee Hunter: &#x201c;Emergency location for emergency call&#x201d;, Feb. 1, 2010, pp. 1-10, XP55026935, Retrieved from the Internet: URL:http://member.openmobilealliance.org/ftp/Public documents/LOC/2010/OMA-LOC-2010-0032<sub>&#x2014;</sub>INP<sub>&#x2014;</sub>SUPL3<sub>&#x2014;</sub>0<sub>&#x2014;</sub>emergency<sub>&#x2014;</sub>location<sub>&#x2014;</sub>for<sub>&#x2014;</sub>emergency<sub>&#x2014;</sub>call.zip [retrieved on May 9, 2012] pp. 5-9.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00034">
<othercit>Open Mobile Alliance: &#x201c;Secure User Plane Location Architecture, Draft Version 3.0&#x201d;, Jan. 3, 2011, pp. 1-40, XP55026688, Retrieved from the Internet: URL:http://member.openmobilealliance.org/ftp/Public documents/LOC/Permanent documentS/OMA-AD-SUPL-V3<sub>&#x2014;</sub>0-20110103-D.zip [retrieved on May 9, 2012 paragraph [5.2.2.1.1]; figure 1 paragraph [0B.5]; figure 11.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00035">
<othercit>Tcs Systems: &#x201c;SLP Discovery Models and Mechanisms&#x201d;, Dec. 15, 2010, pp. 1-11, XP55026932, Retrieved from the Internet: URL:http://member.openmobilealliance.org/ftp/Public documents/LOC/2010/OMA-LOC-2010-0316-INP<sub>&#x2014;</sub>SUPL<sub>&#x2014;</sub>3<sub>&#x2014;</sub>0<sub>&#x2014;</sub>TCS<sub>&#x2014;</sub>SLP<sub>&#x2014;</sub>Models<sub>&#x2014;</sub>and<sub>&#x2014;</sub>Discovery<sub>&#x2014;</sub>Mechanisms.zip [retrieved on May 11, 2012] pp. 1-6, 10.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00036">
<othercit>&#x201c;User Plane Location Protocol, Draft Version 3.0&#x2014;Nov. 22, 2010&#x201d;, pp. 1-185, XP55026734, Retrieved from the Internet: URL:http://member.openmobilealliance.org/ftp/Public documents/LOC/Permanent<sub>&#x2014;</sub>documents/OMA-TS-ULP-V3<sub>&#x2014;</sub>0-20101122-D.zip [retrieved on May 9, 2012] paragraphs [5.1.2]-[5.1.2.2] ; figures 3,4.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00037">
<othercit>Dierks, T., et al., &#x201c;The Transport Layer Security (TLS) Protocol Version 1.1; RFC 4346&#x201d;, IETF, Apr. 2006, XP015054952.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00038">
<othercit>International Search Report and Written Opinion&#x2014;PCT/US2011/059455&#x2014;ISA/EPO&#x2014;Mar. 21, 2012.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00039">
<othercit>Open Mobile Alliance: &#x201c;Enabler Release Definition for Secure User Plane Location (SUPL) Candidate Version 3.0 OMA-ERELDSUPL-V3<sub>&#x2014;</sub>0-20100921-D&#x201d;, Sep. 21, 2010, XP55019138, pp. 1-17.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00040">
<othercit>Open Mobile Alliance: &#x201c;User Plane Location Protocol, Candidate Version 2.0&#x201d;, OMA-TS-ULP-V2<sub>&#x2014;</sub>0-20100816-C, Aug. 16, 2010, XP55019043, pp. 1-410.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>22</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>11</number-of-drawing-sheets>
<number-of-figures>11</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61410882</doc-number>
<date>20101106</date>
</document-id>
</us-provisional-application>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61437184</doc-number>
<date>20110128</date>
</document-id>
</us-provisional-application>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61471048</doc-number>
<date>20110401</date>
</document-id>
</us-provisional-application>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61527341</doc-number>
<date>20110825</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20130067552</doc-number>
<kind>A1</kind>
<date>20130314</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Hawkes</last-name>
<first-name>Philip Michael</first-name>
<address>
<city>Warrimoo</city>
<country>AU</country>
</address>
</addressbook>
<residence>
<country>AU</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Wachter</last-name>
<first-name>Andreas</first-name>
<address>
<city>Menlo Park</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Escott</last-name>
<first-name>Adrian Edward</first-name>
<address>
<city>Reading</city>
<country>GB</country>
</address>
</addressbook>
<residence>
<country>GB</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Edge</last-name>
<first-name>Stephen William</first-name>
<address>
<city>Escondido</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Hawkes</last-name>
<first-name>Philip Michael</first-name>
<address>
<city>Warrimoo</city>
<country>AU</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Wachter</last-name>
<first-name>Andreas</first-name>
<address>
<city>Menlo Park</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Escott</last-name>
<first-name>Adrian Edward</first-name>
<address>
<city>Reading</city>
<country>GB</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Edge</last-name>
<first-name>Stephen William</first-name>
<address>
<city>Escondido</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Kilpatrick Townsend and Stockton LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Qualcomm Incorporated</orgname>
<role>02</role>
<address>
<city>San Diego</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Barron, Jr.</last-name>
<first-name>Gilberto</first-name>
<department>2432</department>
</primary-examiner>
<assistant-examiner>
<last-name>Cribbs</last-name>
<first-name>Malcolm</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A particular method includes storing, at a mobile device, at least one security credential that is specific to the mobile device. The method also includes transmitting the at least one security credential to a secure user plane location (SUPL) location platform (SLP) to authenticate the mobile device as associated with a SUPL user based on a comparison of the device identifier to a stored device identifier.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="191.01mm" wi="285.50mm" file="US08627422-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="296.76mm" wi="206.67mm" orientation="landscape" file="US08627422-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="269.07mm" wi="179.83mm" file="US08627422-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="279.32mm" wi="170.26mm" file="US08627422-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="274.49mm" wi="162.81mm" file="US08627422-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="294.98mm" wi="193.46mm" orientation="landscape" file="US08627422-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="273.81mm" wi="199.56mm" file="US08627422-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="276.61mm" wi="190.75mm" file="US08627422-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="284.06mm" wi="197.53mm" orientation="landscape" file="US08627422-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="280.67mm" wi="186.69mm" file="US08627422-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="275.25mm" wi="182.54mm" file="US08627422-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="284.06mm" wi="192.11mm" orientation="landscape" file="US08627422-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCES TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">The present application claims priority from U.S. Provisional Patent Application No. 61/410,882 filed Nov. 6, 2010, U.S. Provisional Patent Application No. 61/437,184 filed Jan. 28, 2011, U.S. Provisional Patent Application No. 61/471,048 filed Apr. 1, 2011, and U.S. Provisional Patent Application No. 61/527,341 filed Aug. 25, 2011, each of which is incorporated by reference in its entirety.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">1. Field of the Invention</p>
<p id="p-0004" num="0003">The present disclosure is generally related to authentication in secure user plane location (SUPL) systems.</p>
<p id="p-0005" num="0004">2. Description of the Related Art</p>
<p id="p-0006" num="0005">Advances in technology have resulted in smaller and more powerful computing devices. For example, there currently exist a variety of portable personal computing devices, including wireless computing devices, such as portable wireless telephones, personal digital assistants (PDAs), and paging devices that are small, lightweight, and easily carried by users. More specifically, portable wireless telephones, such as cellular telephones and Internet Protocol (IP) telephones, can communicate voice and data packets over wireless networks. Further, many such wireless telephones include other types of devices that are incorporated therein. For example, a wireless telephone can also include a digital still camera, a digital video camera, a digital recorder, and an audio file player.</p>
<p id="p-0007" num="0006">A wireless telephone may also be equipped with location determination hardware/software to enable location-based services. For example, the wireless telephone may include a global positioning system (GPS) transceiver. The wireless telephone may also receive network-assisted positioning information (e.g., positioning information based triangulating the wireless telephone's location between multiple network towers).</p>
<p id="p-0008" num="0007">Secure user plane location (SUPL) is a technology standard that may be used to enable location-based services in wireless communication systems. SUPL architecture may include two components: a SUPL enabled terminal (SET) and a SUPL location platform (SLP) that may be implemented as a network-accessible server. Prior to leveraging SUPL services, the SET and/or the SLP may be required to authenticate each other. However, security and authentication in SUPL may depend on what access network is used by the SET. For example, authentication on a 3<sup>rd </sup>Generation Partnership Project (3GPP) or 3GPP2 network may utilize a different security scheme than authentication on a Worldwide Interoperability for Microwave Access (WiMAX) network. Further, the use of other available networks, such as Institute of Electrical and Electronics Engineers (IEEE) 802.11 (Wi-Fi) networks, may not be fully supported by security mechanisms available in SUPL 2.0, which may make SUPL-based functionality unavailable to wireless telephones that are indoors or experiencing poor cellular network conditions.</p>
<heading id="h-0003" level="1">SUMMARY</heading>
<p id="p-0009" num="0008">Systems and methods of authentication in a SUPL system are disclosed. The disclosed systems and methods may support mutual authentication between a SET and a SLP for a variety of access networks, including 3GPP, 3GPP2, WiMAX, and Wi-Fi networks. The disclosed techniques may enable a SUPL server and a SET to negotiate which of a plurality of authentication methods is to be used. Authentication methods disclosed herein include, but are not limited to, certificate-based authentication independent of access network type. In particular implementations, certificate-based authentication may use transport layer security (TLS) to enable secure communications between a SET and a SLP during authentication. The disclosed techniques also apply security to SUPL session initiation and re-initiation. In additional embodiments, authentication may be performed via multiple identifier/password pairs instead of via certificate-based authentication.</p>
<p id="p-0010" num="0009">In a particular embodiment, a method includes storing, at a mobile device, at least one security credential that is specific to the mobile device, where the security credential includes a device identifier of the mobile device. The method also includes transmitting the at least one security credential to a secure user plane location (SUPL) location platform (SLP) to authenticate the mobile device as associated with a SUPL user based on a comparison of the device identifier to a stored device identifier.</p>
<p id="p-0011" num="0010">In another particular embodiment, a non-transitory processor-readable medium includes instructions that, when executed by a processor, cause the processor to generate, at a SUPL server, a message to be sent to a mobile device. The message includes a server certificate including an identifier of the SUPL server and a public key of the SUPL server, and a request for a device certificate of the mobile device. The instructions, when executed by the processor, also cause the processor to receive a reply from the mobile device that includes a device certificate of the mobile device. The instructions, when executed by the processor, further cause the processor to authenticate the mobile device as associated with a SUPL user based on the device certificate.</p>
<p id="p-0012" num="0011">In another particular embodiment, an apparatus includes a processor and a memory coupled to the processor. The memory stores instructions executable by the processor to receive, at a SUPL server, an indication from a mobile device of one or more TLS cipher suites supported by the mobile device. The instructions are also executable by the processor to determine whether the one or more TLS cipher suites include a TLS pre-shared key (TLS-PSK) cipher suite that is supported by the SUPL server. The instructions are further executable by the processor to, in response to determining that the one or more TLS cipher suites include the TLS-PSK cipher suite that is supported by the SUPL server, perform a generic bootstrapping architecture (GBA)-based authentication process to authenticate the mobile device. The instructions are executable by the processor to, in response to determining that the one or more TLS cipher suites do not include a TLS-PSK cipher suite that is supported by the SUPL server, determine whether the SUPL server supports a certificate-based authentication method. The instructions are also executable by the processor to, in response to determining that the SUPL server supports the certificate-based authentication method, perform the certificate-based authentication process that includes sending a server certificate to the mobile device and receiving a device certificate from the mobile device. The instructions may further be executable by the processor to, in response to determining that the SUPL server does not support the certificate-based authentication method, perform an alternative client authentication (ACA)-based authentication method when the mobile device is connected to a 3GPP network or a 3GPP2 network.</p>
<p id="p-0013" num="0012">In another particular embodiment, a method includes receiving, at a mobile device, a session initiation message (e.g., including a SUPL INIT message) from a SUPL server to initiate a SUPL session between the SUPL server and the mobile device. The method also includes, in response to the mobile device receiving a valid session initiation message key (e.g., including a SUPL_INIT_ROOT_KEY) from the SUPL server prior to the mobile device receiving the session initiation message, authenticating the session initiation message using the session initiation message key and initiating a SUPL session with the SUPL server in response to successful authentication of the session initiation message.</p>
<p id="p-0014" num="0013">In another particular embodiment, an apparatus includes a processor and a memory coupled to the processor. The memory stores instructions executable by the processor to receive, at a mobile device, a session re-initiation message (e.g., including a SUPL REINIT message) from a SUPL server to continue a SUPL session (e.g., a generic SUPL session (GSS)) between the SUPL server and the mobile device. The instructions are also executable by the processor to, in response to the mobile device receiving a valid session initiation message key from the SUPL server prior to the mobile device receiving the session re-initiation message, authenticate the session re-initiation message using the session initiation message key and continue the SUPL session with the SUPL server in response to successful authentication of the session re-initiation message.</p>
<p id="p-0015" num="0014">In another particular embodiment, a method includes transmitting a message from a mobile device to a SUPL server, where the message includes a SUPL INIT Root Key Status parameter (e.g., indicating a status of a SUPL_INIT_ROOT_KEY). For example, the SUPL INIT Root Key Status parameter may be included in a SET Capabilities parameter of the message. In yet another embodiment, a method includes transmitting a SUPL END message from a SUPL server to a mobile device, where the SUPL END message includes a SUPL INIT Key Response parameter (e.g., providing a new SUPL_INIT_ROOT_KEY). In another particular embodiment, a method includes transmitting a SUPL INIT message including a Protection Level parameter from a SUPL server to a mobile device. In yet another embodiment, a method includes transmitting a SUPL REINIT message including a Protection Level parameter from a SUPL server to a mobile device.</p>
<p id="p-0016" num="0015">In another particular embodiment, a method includes receiving, at a web server, a message from a SUPL-enabled mobile device, where the message includes a security credential of the mobile device. The method also includes receiving, at the web server, user identification information from the mobile device and authenticating the user identification information as identifying an authorized user of a SUPL service. The method further includes sending the security credential of the mobile device to a SUPL server to enable the SUPL server to authenticate the mobile device as associated with the authorized user of the SUPL service.</p>
<p id="p-0017" num="0016">In another particular embodiment, a method includes receiving, at a SUPL server, a first identifier and a first password from a mobile device. For example, the first identifier and the first password may be received during a user-mode TLS authentication procedure. The method also includes authenticating the first identifier and the first password as associated with an authorized user of a SUPL service. The method further includes sending a second identifier and a second password to the mobile device to replace the first identifier and the first password, where the SUPL server is configured to establish a SUPL session with the mobile device upon receiving the second identifier and the second password from the mobile device.</p>
<p id="p-0018" num="0017">Particular advantages provided by at least one of the disclosed embodiments include an ability to perform mutual authentication in SUPL systems independent of access network. For example, one or more of the disclosed embodiments may support various access networks, including 3GPP, 3GPP2, WiMAX, and Wi-Fi networks. As another example, one or more of the disclosed embodiments may apply security to SUPL session initiation and re-initiation.</p>
<p id="p-0019" num="0018">Other aspects, advantages, and features of the present disclosure will become apparent after review of the entire application, including the following sections: Brief Description of the Drawings, Detailed Description, and the Claims.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1</figref> is a diagram to illustrate a particular embodiment of a system that is operable to perform authentication in a SUPL environment;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 2</figref> is a flowchart to illustrate a particular embodiment of a method of negotiating authentication methods in a SUPL environment;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 3</figref> is a flowchart to illustrate a particular embodiment of a method of performing authentication in a SUPL environment using certificates;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart to illustrate another particular embodiment of a method of performing authentication in a SUPL environment using certificates;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 5</figref> is a diagram to illustrate particular embodiments of messaging between a SUPL server and a mobile device;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart to illustrate a particular embodiment of a method of authentication during session initiation in a SUPL environment;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 7</figref> is a flowchart to illustrate a particular embodiment of a method of authentication during session re-initiation in a SUPL environment;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 8</figref> is a diagram to illustrate a particular embodiment of authentication in a SUPL environment using a web server and multiple identifiers/passwords;</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 9</figref> is a flowchart to illustrate a particular embodiment of a method of authentication in a SUPL environment using a web server;</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 10</figref> is a flowchart to illustrate a particular embodiment of a method of authentication in a SUPL environment using multiple identifiers/passwords; and</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 11</figref> is a block diagram of a particular embodiment of a wireless device that implements a SET.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0031" num="0030">Referring to <figref idref="DRAWINGS">FIG. 1</figref>, a particular embodiment of a system that is operable to perform authentication in a secure user plane location (SUPL) environment is shown and generally designated <b>100</b>. The system <b>100</b> includes a SUPL server <b>110</b> communicably coupled to a mobile device <b>120</b> via one or more access networks (e.g., an illustrative access network <b>130</b>). In a particular embodiment, the SUPL server <b>110</b> may be a SUPL location platform (SLP) and the mobile device <b>120</b> may be a SUPL-enabled terminal (SET). The access network <b>130</b> may be a 3GPP network, a 3GPP2 network, a WiMAX network, a Wi-Fi network (e.g., a network that operates in accordance with an IEEE 802.11 standard), or some other wireless access network. In a particular embodiment, the mobile device <b>120</b> may be a wireless telephone.</p>
<p id="p-0032" num="0031">The SUPL server <b>110</b> may include a processor <b>111</b> and a memory <b>112</b> coupled to the processor <b>111</b>. In a particular embodiment, the memory <b>122</b> may store instructions executable by the processor <b>111</b>, where the instructions represent various logical modules, components, and applications. The memory <b>112</b> may also store one or more security credentials of the SUPL server <b>110</b>. For example, the memory <b>112</b> may store a server certificate <b>113</b> for the SUPL server <b>110</b>, where the server certificate <b>113</b> includes a public key <b>114</b> and a server identifier (ID) <b>115</b> (e.g., a globally unique identifier corresponding to the SUPL server <b>110</b>). The SUPL server <b>110</b> may also have a private key corresponding to the public key <b>114</b>. The memory <b>112</b> may also store executable instructions corresponding to authentication logic <b>116</b> and transport layer security (TLS) encryption/decryption logic <b>117</b>. The authentication logic <b>116</b> may be executable to authenticate the mobile device <b>120</b>. The TLS encryption/decryption logic <b>117</b> may be executable to encrypt messages transmitted from the SUPL server <b>110</b> to the mobile device <b>120</b> and to decrypt messages transmitted from the mobile device <b>120</b> to the SUPL server <b>110</b>. For example, outgoing messages from the mobile device <b>120</b> may be encrypted using the server public key <b>114</b> and incoming messages from the mobile device <b>120</b> may be decrypted using a private key corresponding to the server public key <b>114</b>.</p>
<p id="p-0033" num="0032">The mobile device <b>120</b> may include a processor <b>121</b> and a memory <b>122</b> coupled to the processor <b>121</b>. In a particular embodiment, the memory <b>122</b> stores instructions executable by the processor <b>121</b>, where the instructions may represent various logical modules, components, and applications. The memory <b>122</b> may also store one or more security credentials of the mobile device <b>120</b>. For example, the memory <b>122</b> may store a device certificate <b>123</b> for the mobile device <b>120</b>, where the device certificate <b>123</b> includes a public key <b>124</b> and a device identifier (ID) <b>125</b>. The mobile device <b>120</b> may also have a private key that corresponds to the public key <b>124</b>. The device ID <b>125</b> may be an international mobile equipment identity (IMEI), a mobile station identification (MSID), a serial number, or other identifier that may be globally unique. In a particular embodiment, the device certificate <b>123</b> may be stored at a universal integrated circuit card (UICC) of the mobile device <b>120</b> instead of, or in addition to, in the memory <b>122</b>. The memory <b>122</b> may store executable instructions corresponding to authentication logic <b>126</b> and transport layer security (TLS) encryption/decryption logic <b>127</b>. The authentication logic <b>126</b> may be executable to authenticate the SUPL server <b>110</b> at the mobile device <b>120</b>. The TLS encryption/decryption logic <b>127</b> may be executable to encrypt messages transmitted to the SUPL server <b>110</b> from the mobile device <b>120</b> and to decrypt messages transmitted to the mobile device <b>120</b> from the SUPL server <b>110</b>. For example, outgoing messages from the mobile device <b>120</b> may be encrypted using the device public key <b>124</b> and incoming messages to the mobile device <b>120</b> may be decrypted using a private key corresponding to the device public key <b>124</b>.</p>
<p id="p-0034" num="0033">In a particular embodiment, the SUPL server <b>110</b> and the mobile device <b>120</b> may engage in a mutual authentication procedure. For example, during operation, the authentication logic <b>126</b> at the mobile device <b>120</b> may determine whether the mobile device <b>120</b> supports generic bootstrapping architecture (GBA)-based authentication. If the mobile device <b>120</b> supports GBA-based authentication, the mobile device <b>120</b> and the SUPL server <b>110</b> may perform a GBA-based authentication process <b>134</b>. GBA-based authentication may be selected when the access network <b>130</b> is a 3GPP or 3GPP2 network. The mobile device <b>120</b> may initiate a TLS handshake procedure by transmitting a message <b>131</b> to the SUPL server <b>110</b>. The message <b>131</b> may indicate one or more TLS cipher suites that are supported by the TLS encryption/decryption logic <b>127</b> at the mobile device <b>120</b>. For example, the message <b>131</b> may be a ClientHello message and the supported TLS cipher suites may be indicated by a ClientHello.cipher_suites field.</p>
<p id="p-0035" num="0034">The SUPL server <b>110</b> may process the message <b>131</b> and determine whether any of the indicated TLS cipher suites are also supported by the SUPL server <b>110</b> (i.e., whether there are any commonly supported TLS cipher suites). If the mobile device <b>120</b> and the SUPL server <b>110</b> both support a TLS pre-shared key (TLS-PSK) cipher suite, GBA may be supported, and the SUPL server <b>110</b> may perform the GBA-based authentication process <b>134</b>. Otherwise, the SUPL server <b>110</b> may initiate certificate-based authentication via a message <b>132</b> or may initiate alternative client authentication (ACA). ACA may provide mutual authentication and may be dependent on the type of access network used. (e.g., GSM/UMTS and CDMA) During ACA authentication, the SUPL server <b>110</b> may verify the internet protocol (IP) address binding of the mobile device <b>120</b> by comparing an IP address provided by the mobile device <b>120</b> to an IP address corresponding to the mobile device <b>120</b> that is provided by the access network <b>130</b>. Certificate-based authentication may be independent of the type of the access network <b>130</b> and may be used when the access network <b>130</b> is a Wi-Fi network. The message <b>132</b> may include an indication of a non-PSK TLS cipher suite supported by the SUPL server <b>110</b> and the mobile device <b>120</b>, the server certificate <b>113</b> (which includes the server public key <b>114</b>), and a request for a device certificate. To illustrate, the message <b>132</b> may include a ServerHello message including a ServerHello.cipher_suite field indicating the commonly supported TLS cipher suite.</p>
<p id="p-0036" num="0035">In response to the message <b>132</b>, the mobile device <b>120</b> may transmit a message <b>133</b> including the device certificate <b>123</b>. The SUPL server <b>110</b> may attempt to identify a SUPL user associated with the mobile device <b>120</b> by comparing the device ID <b>125</b> in the device certificate <b>123</b> to a stored device ID (e.g., a stored device ID that was previously securely verified by the SUPL server <b>110</b> as associated with a SUPL user, as further described with reference to <figref idref="DRAWINGS">FIGS. 8-9</figref>). If no SUPL user is identified, the communication session between the SUPL server <b>110</b> and the mobile device <b>120</b> may be terminated. If a SUPL user is identified, the TLS handshake may complete and the SUPL server <b>110</b> may grant the mobile device <b>120</b> access to SUPL-based services (e.g., location-based services) that are provisioned for the SUPL user.</p>
<p id="p-0037" num="0036">In particular embodiments, different authentication methods may also be available. For example, when the mobile device <b>120</b> is a WiMAX-compatible device and/or the access network <b>130</b> is a WiMAX network, if the mobile device <b>120</b> and the SUPL server <b>110</b> both support a SUPL encryption key (SEK)-based authentication method, then the SEK-based authentication method may be preferred for mutual authentication of the SUPL server <b>110</b> and the mobile device <b>120</b>. As another example, if the SUPL server <b>110</b> does not support certificate-based authentication, the SUPL server <b>110</b> may transmit the message <b>132</b> without the request for the device certificate to initiate a different authentication method, such as ACA (which may provide access network-dependent mutual authentication when the mobile device <b>120</b> is on a 3GPP or 3GPP2 access network) or SLP-only authentication (which may provide non-mutual authentication and may generally be used only during emergency scenarios).</p>
<p id="p-0038" num="0037">The system <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref> may thus enable mutual authentication between a mobile device and a SUPL server independent of access network. For example, the access network <b>130</b> may be a 3GPP network, a 3GPP2 network, a WiMAX network, a Wi-Fi network, or some other network. The system <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref> may also provide support for multiple mutual authentication methods, including GBA-based authentication, SEK-based authentication, certificate-based authentication, ACA-based authentication, and SLP-only authentication.</p>
<p id="p-0039" num="0038">Referring to <figref idref="DRAWINGS">FIG. 2</figref>, a particular embodiment of a method of negotiating authentication methods in a SUPL environment is shown and generally designated <b>200</b>. In an illustrative embodiment, the method <b>200</b> may be performed by the SUPL server <b>110</b> of <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0040" num="0039">The method <b>200</b> may include receiving, at a SUPL server, an indication from a mobile device of one or more TLS cipher suites supported by the mobile device, at <b>202</b>. For example, in <figref idref="DRAWINGS">FIG. 1</figref>, the SUPL server <b>110</b> may receive the message <b>131</b> from the mobile device <b>120</b>, where the message <b>131</b> indicates one or more TLS cipher suites supported by the mobile device <b>120</b>.</p>
<p id="p-0041" num="0040">The method <b>200</b> may also include determining whether at least one TLS-PSK cipher suite indicated by the mobile device is also supported by the SUPL server, at <b>204</b>. For example, in <figref idref="DRAWINGS">FIG. 1</figref>, the SUPL server <b>110</b> may determine whether any TLS-PSK cipher suite supported by the mobile device <b>120</b> is also supported by the SUPL server <b>110</b>.</p>
<p id="p-0042" num="0041">In response to determining that a TLS-PSK cipher suite is commonly supported by the SUPL server and the mobile device, at <b>204</b>, a GBA-based authentication process may be performed to authenticate the mobile device, at <b>206</b>. For example, in <figref idref="DRAWINGS">FIG. 1</figref>, the SUPL server <b>110</b> may perform the GBA-based authentication procedure <b>134</b>. In response to determining that a TLS-PSK cipher suite is not commonly supported by the SUPL server and the mobile device, at <b>204</b>, a certificate-based authentication process may be performed, at <b>208</b>. The certificate-based process may include sending a server certificate to the mobile device and receiving a device certificate from the mobile device and may be independent of an access network used by the mobile device. For example, in <figref idref="DRAWINGS">FIG. 1</figref>, the SUPL server <b>110</b> may perform a certificate-based authentication procedure including transmitting the server certificate <b>113</b> to the mobile device <b>120</b> via the message <b>132</b> and receiving the device certificate <b>123</b> from the mobile device <b>120</b> via the message <b>133</b>.</p>
<p id="p-0043" num="0042">In particular embodiments, the method <b>200</b> of <figref idref="DRAWINGS">FIG. 2</figref> may be implemented via a field-programmable gate array (FPGA) device, an application-specific integrated circuit (ASIC), a processing unit such as a central processing unit (CPU), a digital signal processor (DSP), a controller, another hardware device, firmware device, or any combination thereof. As an example, the method <b>200</b> of <figref idref="DRAWINGS">FIG. 2</figref> can be performed by a processor that executes instructions.</p>
<p id="p-0044" num="0043">Referring to <figref idref="DRAWINGS">FIG. 3</figref>, a particular embodiment of a method of performing authentication in a SUPL environment using certificates is shown and generally designated <b>300</b>. In an illustrative embodiment, the method <b>300</b> may be performed by the mobile device <b>120</b> of <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0045" num="0044">The method <b>300</b> may include storing, at a mobile device, at least one security credential that is specific to the mobile device, at <b>302</b>. The at least one security credential may include a device identifier of the mobile device. For example, in <figref idref="DRAWINGS">FIG. 1</figref>, the mobile device <b>120</b> may store the device certificate <b>123</b> including the device ID <b>125</b> (e.g., an IMEI, a MSID, a serial number, or another globally unique identifier).</p>
<p id="p-0046" num="0045">The method <b>300</b> may also include transmitting the at least one security credential to a SUPL location platform (SLP) to authenticate the mobile device as associated with a SUPL user based on a comparison of the device identifier to a stored device identifier, at <b>304</b>. For example, in <figref idref="DRAWINGS">FIG. 1</figref>, the mobile device <b>120</b> may transmit the device certificate <b>123</b> to the SUPL server <b>110</b> (e.g., an SLP) via the message <b>133</b> so that the SUPL server <b>110</b> can authenticate the mobile device <b>120</b> as associated with a SUPL user based on a comparison of the device ID <b>125</b> to a stored device ID that was previously provided by another entity.</p>
<p id="p-0047" num="0046">In particular embodiments, the method <b>300</b> of <figref idref="DRAWINGS">FIG. 3</figref> may be implemented via a field-programmable gate array (FPGA) device, an application-specific integrated circuit (ASIC), a processing unit such as a central processing unit (CPU), a digital signal processor (DSP), a controller, another hardware device, firmware device, or any combination thereof. As an example, the method <b>300</b> of <figref idref="DRAWINGS">FIG. 3</figref> can be performed by a processor that executes instructions.</p>
<p id="p-0048" num="0047">Referring to <figref idref="DRAWINGS">FIG. 4</figref>, another particular embodiment of a method of performing authentication in a SUPL environment using certificates is shown and generally designated <b>400</b>. In an illustrative embodiment, the method <b>400</b> may be performed by the SUPL server <b>110</b> of <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0049" num="0048">The method <b>400</b> may include receiving, at a SUPL server from a mobile device, an indication of one or more TLS cipher suites supported by the mobile device, at <b>402</b>. For example, in <figref idref="DRAWINGS">FIG. 1</figref>, the SUPL server <b>110</b> may receive the message <b>131</b> from the mobile device <b>120</b>, where the message <b>131</b> indicates one or more TLS cipher suites supported by the mobile device <b>120</b>.</p>
<p id="p-0050" num="0049">The method <b>400</b> may also include sending a message from the SUPL server to the mobile device, at <b>404</b>. The message may include a server certificate that includes an identifier of the SUPL server and a public key of the SUPL server, a request for a device certificate of the mobile device, and a selection of at least one of the TLS cipher suites. For example, in <figref idref="DRAWINGS">FIG. 1</figref>, the SUPL server <b>110</b> may send the message <b>132</b> to the mobile device <b>120</b>, where the message <b>132</b> includes the server ID <b>115</b>, the server public key <b>114</b>, a request for the device certificate <b>123</b> of the mobile device <b>120</b>, and a selection of a commonly supported TLS cipher suite.</p>
<p id="p-0051" num="0050">The method <b>400</b> may further include receiving a reply from the mobile device that includes a device certificate of the mobile device, at <b>406</b>. For example, in <figref idref="DRAWINGS">FIG. 1</figref>, the SUPL server <b>110</b> may receive the message <b>133</b> that includes the device certificate <b>123</b>.</p>
<p id="p-0052" num="0051">The method <b>400</b> may include authenticating the mobile device as associated with a SUPL user based on the device certificate, at <b>408</b>. For example, in <figref idref="DRAWINGS">FIG. 1</figref>, the authentication logic <b>116</b> at the SUPL server <b>110</b> may authenticate the mobile device <b>120</b> as associated with a SUPL user based on the device certificate <b>123</b>.</p>
<p id="p-0053" num="0052">In particular embodiments, the method <b>400</b> of <figref idref="DRAWINGS">FIG. 4</figref> may be implemented via a field-programmable gate array (FPGA) device, an application-specific integrated circuit (ASIC), a processing unit such as a central processing unit (CPU), a digital signal processor (DSP), a controller, another hardware device, firmware device, or any combination thereof. As an example, the method <b>400</b> of <figref idref="DRAWINGS">FIG. 4</figref> can be performed by a processor that executes instructions.</p>
<p id="p-0054" num="0053">Regardless of which authentication method described with reference to <figref idref="DRAWINGS">FIGS. 1-4</figref> is used, once authentication is complete, a SUPL server (e.g., SLP) and a mobile device (e.g., SET) may communicate regarding SUPL-based services during a SUPL session. Referring to <figref idref="DRAWINGS">FIG. 5</figref>, a particular embodiment of messages that may be exchanged between a SUPL server <b>510</b> and a mobile device <b>520</b> is shown and generally designated <b>500</b>.</p>
<p id="p-0055" num="0054">In a particular embodiment, the SUPL server <b>510</b> and the mobile device <b>520</b> may communicate via user location protocol (ULP) messages in the context of a SUPL session. For example, the SUPL server <b>510</b> may be configured to transmit a SUPL INIT message <b>530</b> to the mobile device <b>520</b>. The SUPL INIT message <b>530</b> may represent a session initiation message that is transmitted by the SUPL server <b>110</b> to initiate a SUPL session. To protect against masquerading and re-play attacks, protection may be applied to the SUPL INIT message <b>530</b>. In a particular embodiment, the SUPL INIT message <b>530</b> may include a Protection Level parameter. The Protection Level parameter may include at least one of a Level parameter (indicating whether Null, Mode A, or Mode B SUPL INIT protection is implemented) and a Protection parameter (e.g., including at least one of a Key Identifier Type and a Key Identifier). In a particular embodiment, Null SUPL INIT protection may not provide end-to-end integrity or replay protection, Mode A SUPL INIT protection may provide end-to-end integrity and replay protection by use of a shared key transmitted to the mobile device <b>520</b> by the SUPL server <b>510</b> during a secured ULP session, and Mode B SUPL INIT protection may provide end-to-end integrity and replay protection using a shared key derived from PSK-based methods (e.g., GBA or SEK methods).</p>
<p id="p-0056" num="0055">In a particular embodiment, SUPL INIT protection may be implemented based on a session initiation key (e.g., a SUPL_INIT_ROOT_KEY). Upon receiving the SUPL INIT message <b>530</b>, the mobile device <b>520</b> may determine whether the mobile device <b>520</b> has previously received a valid SUPL_INIT_ROOT_KEY from the SUPL server <b>510</b>, and if so, whether the previously received SUPL_INIT_ROOT_KEY is still valid. If the mobile device <b>520</b> has a valid SUPL_INIT_ROOT_KEY, the mobile device <b>520</b> may authenticate the SUPL INIT message <b>530</b> using the SUPL_INIT_ROOT_KEY and may initiate a SUPL session with the SUPL server <b>510</b> in response to successful authentication of the SUPL INIT message <b>530</b>.</p>
<p id="p-0057" num="0056">In a particular embodiment, if the mobile device <b>520</b> does not have a valid SUPL_INIT_ROOT_KEY, the mobile device <b>520</b> may transmit a message to the SUPL server <b>510</b> and may receive a valid SUPL_INIT_ROOT_KEY in response to the message. For example, the mobile device <b>520</b> may transmit a message including a SUPL_INIT_KeyRequest parameter that represents a request for a valid SUPL_INIT_ROOT_KEY. Alternately, the mobile device <b>520</b> may indicate the presence of an invalid or out-of-sync SUPL_INIT_ROOT_KEY instead of requesting a new SUPL_INIT_ROOT_KEY. For example, the mobile device <b>520</b> may transmit a ULP message <b>540</b> including a SUPL INIT Root Key Status parameter <b>541</b> that indicates whether a &#x201c;current&#x201d; SUPL_INIT_ROOT_KEY possessed by the mobile device <b>520</b> is invalid or out-of-sync. In a particular embodiment, the SUPL INIT Root Key Status parameter <b>541</b> may be included within a SET Capabilities parameter of the ULP message <b>540</b>. It will be appreciated that including the SUPL INIT Root Key Status parameter <b>541</b> in the SET Capabilities parameter may enable transmission of SUPL_INIT_ROOT_KEY status information in messages defined in SUPL 2.0 that optionally or mandatorily include a SET Capabilities parameter without having to introduce a dedicated message for the purpose of transmitting SUPL_INIT_ROOT_KEY status information. In a particular embodiment, the SUPL INIT Root Key Status parameter <b>541</b> may be included within the SET Capabilities parameter for Mode A SUPL INIT protection, but not for NULL protection or Mode B SUPL INIT Protection.</p>
<p id="p-0058" num="0057">It should be noted that the mobile device <b>520</b> may not indicate an invalid SUPL_INIT_ROOT_KEY for every network-initiated SUPL session. The mobile device <b>520</b> may have been provided the SUPL_INIT_ROOT_KEY once, and the provided key may then be valid for multiple network-initiated SUPL sessions before the key expires.</p>
<p id="p-0059" num="0058">The SUPL server <b>510</b> may transmit a ULP message including a SUPL INIT Key Response parameter. For example, the SUPL Server <b>510</b> may transmit a SUPL END message <b>550</b> including a SUPL INIT Key Response parameter <b>551</b>. It should be noted that the SUPL INIT Key Response may not be sent in direct response to the SUPL INIT Root Key Status indication; the SUPL INIT Key Response may be in a &#x201c;regular&#x201d; SUPL END message that may not be in the same SUPL session (e.g., if the SUPL session is not ended by a SUPL END message from the SLP to the SET). The SUPL INIT Key Response parameter <b>551</b> may include at least one of a Mode A Key Identifier, a Temporary Mode A Key Identifier, a SUPL_INIT_ROOT_KEY (e.g., a &#x201c;new&#x201d; SUPL_INIT_ROOT_KEY), and a Mode A Key Lifetime.</p>
<p id="p-0060" num="0059">While a generic SUPL session (GSS) is active, the SLP (i.e., the SUPL server <b>510</b>) may initiate communication with the SET (i.e., the mobile device <b>520</b>). The SUPL server <b>510</b> may transmit a session re-initiation message (e.g., a SUPL REINIT message <b>560</b>). SUPL REINIT protection may be implemented as described herein with reference to SUPL INIT protection. For example, if the mobile device <b>520</b> does not possess a valid SUPL_INIT_ROOT_KEY (the SUPL_INIT_ROOT_KEY may serve as both a session initiation key as well as a session re-initiation key), the mobile device <b>520</b> may indicate a lack of valid SUPL_INIT_ROOT_KEY via the SUPL INIT Root Key Status parameter <b>541</b> and may receive the SUPL END message <b>550</b> (including the SUPL INIT Key Response parameter <b>551</b>) in response. When the mobile device <b>520</b> has a valid SUPL_INIT_ROOT_KEY, the mobile device <b>520</b> may authenticate the SUPL REINIT message <b>560</b> and may re-initiate the SUPL session with the SUPL server <b>510</b> in response to successful authentication of the SUPL REINIT message <b>560</b>. In a particular embodiment, the SUPL REINIT message <b>560</b> may also include a Protection Level parameter, such as described herein with reference to the SUPL INIT message <b>530</b>.</p>
<p id="p-0061" num="0060">In a particular embodiment, the mobile device <b>520</b> may apply Null SUPL INIT protection and Null SUPL REINIT protection when the mobile device <b>520</b> does not have a valid SUPL_INIT_ROOT_KEY (e.g., at power up or when a lifetime of the possessed SUPL_INIT_ROOT_KEY has elapsed). When Null protection is in place, the mobile device <b>520</b> may handle all SUPL INIT and SUPL REINIT messages. If the mobile device <b>520</b> has a valid SUPL_INIT_ROOT_KEY, Mode A or Mode B protection may be applied.</p>
<p id="p-0062" num="0061">Thus, as illustrated in <figref idref="DRAWINGS">FIG. 5</figref>, various messages and message parameters may be used to implement security in a SUPL system. For example, a Protection Level parameter may be used to indicate a level of SUPL INIT and SUPL REINIT protection. As another example, a SUPL INIT Root Key Status parameter may be used to indicate whether a current SUPL_INIT_ROOT_KEY is invalid or out-of-sync. As yet another example, a SUPL INIT Key Response parameter may be used to provide a &#x201c;new&#x201d; SUPL_INIT_ROOT_KEY.</p>
<p id="p-0063" num="0062">Referring to <figref idref="DRAWINGS">FIG. 6</figref>, a particular embodiment of a method of authentication during session initiation in a SUPL environment is shown and generally designated <b>600</b>. In an illustrative embodiment, the method <b>600</b> may be performed by the mobile device <b>520</b> of <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0064" num="0063">The method <b>600</b> may include receiving, at a mobile device, a session initiation message from a secure user plane location (SUPL) server to initiate a SUPL session between the SUPL server and the mobile device, at <b>602</b>. For example, in <figref idref="DRAWINGS">FIG. 5</figref>, the mobile device <b>520</b> may receive the SUPL INIT message <b>530</b> from the SUPL server <b>510</b>.</p>
<p id="p-0065" num="0064">The method <b>600</b> may also include determining whether the mobile device received a valid session initiation message key prior to receiving the session initiation message, at <b>604</b>. For example, in <figref idref="DRAWINGS">FIG. 5</figref>, the mobile device <b>520</b> may determine whether it possesses a valid SUPL_INIT_ROOT_KEY.</p>
<p id="p-0066" num="0065">When the mobile device has a valid session initiation message key, the method <b>600</b> may further include authenticating the session initiation message using the session initiation message key (e.g., SUPL_INIT_ROOT_KEY), at <b>606</b>, and initiating a SUPL session with the SUPL server in response to successful authentication of the session initiation message, at <b>608</b>. For example, in <figref idref="DRAWINGS">FIG. 5</figref>, the mobile device <b>520</b> may authenticate the SUPL INIT message <b>530</b> using the valid SUPL_INIT_ROOT_KEY and may initiate a SUPL session with the SUPL server <b>510</b>.</p>
<p id="p-0067" num="0066">When the mobile device does not have a valid session initiation message key, the method <b>600</b> may include sending a message to the SUPL server, at <b>610</b>, and receiving a session initiation message key from the SUPL server in response to the message, at <b>612</b>. To illustrate, the SLP and the SET may conduct a session with NULL SUPL INIT protection, and the SET may transmit an indication during the session that its SUPL_INIT_ROOT_KEY is invalid. For example, in <figref idref="DRAWINGS">FIG. 5</figref>, the mobile device <b>520</b> may transmit a message including the SUPL INIT Root Key Status parameter <b>541</b> to the SUPL server <b>510</b> and may receive a message in response that includes the SUPL INIT Key Response parameter <b>551</b>.</p>
<p id="p-0068" num="0067">In particular embodiments, the method <b>600</b> of <figref idref="DRAWINGS">FIG. 6</figref> may be implemented via a field-programmable gate array (FPGA) device, an application-specific integrated circuit (ASIC), a processing unit such as a central processing unit (CPU), a digital signal processor (DSP), a controller, another hardware device, firmware device, or any combination thereof. As an example, the method <b>600</b> of <figref idref="DRAWINGS">FIG. 6</figref> can be performed by a processor that executes instructions.</p>
<p id="p-0069" num="0068">Referring to <figref idref="DRAWINGS">FIG. 7</figref>, a particular embodiment of a method of authentication during session re-initiation in a SUPL environment is shown and generally designated <b>700</b>. In an illustrative embodiment, the method <b>700</b> may be performed by the mobile device <b>520</b> of <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0070" num="0069">The method <b>700</b> may include receiving, at a mobile device, a session re-initiation message from a secure user plane location (SUPL) server to continue a SUPL session between the SUPL server and the mobile device, at <b>702</b>. For example, in <figref idref="DRAWINGS">FIG. 5</figref>, the mobile device <b>520</b> may receive the SUPL REINIT message <b>560</b> from the SUPL server <b>510</b>. The SUPL REINIT message <b>560</b> may represent a network initiated attempt to continue an existing generic SUPL session (GSS) between the SUPL server <b>510</b> and the mobile device <b>520</b>.</p>
<p id="p-0071" num="0070">The method <b>700</b> may also include determining whether the mobile device received a valid session initiation message key prior to receiving the session re-initiation message, at <b>704</b>. For example, in <figref idref="DRAWINGS">FIG. 5</figref>, the mobile device <b>520</b> may determine whether it possesses a valid SUPL_INIT_ROOT_KEY.</p>
<p id="p-0072" num="0071">When the mobile device has a valid session initiation message key, the method <b>700</b> may further include authenticating the session re-initiation message using the session initiation message key, at <b>706</b>, and continuing the SUPL session with the SUPL server in response to successful authentication of the session re-initiation message, at <b>708</b>. For example, in <figref idref="DRAWINGS">FIG. 5</figref>, the mobile device <b>520</b> may authenticate the SUPL REINIT message <b>560</b> using the valid SUPL_INIT_ROOT_KEY and may re-initiate a SUPL session with the SUPL server <b>510</b>.</p>
<p id="p-0073" num="0072">When the mobile device does not have a valid session initiation message key, the method <b>700</b> may include sending a message to the SUPL server, at <b>710</b>, and receiving a session initiation message key from the SUPL server in response to the message, at <b>712</b>. To illustrate, the SLP and the SET may conduct a session with NULL SUPL INIT protection, and the SET may transmit an indication during the session that its SUPL_INIT_ROOT_KEY is invalid. For example, in <figref idref="DRAWINGS">FIG. 5</figref>, the mobile device <b>520</b> may transmit a message including the SUPL INIT Root Key Status parameter <b>541</b> to the SUPL server <b>510</b> and may receive a message in response that includes the SUPL INIT Key Response parameter <b>551</b>.</p>
<p id="p-0074" num="0073">In particular embodiments, the method <b>700</b> of <figref idref="DRAWINGS">FIG. 7</figref> may be implemented via a field-programmable gate array (FPGA) device, an application-specific integrated circuit (ASIC), a processing unit such as a central processing unit (CPU), a digital signal processor (DSP), a controller, another hardware device, firmware device, or any combination thereof. As an example, the method <b>700</b> of <figref idref="DRAWINGS">FIG. 7</figref> can be performed by a processor that executes instructions.</p>
<p id="p-0075" num="0074">In a particular embodiment, mutual authentication between a mobile device and a SUPL server may be performed via methods other than certificate-based, GBA-based, SEK-based, ACA-based, and SLP-only methods. For example, <figref idref="DRAWINGS">FIG. 8</figref> illustrates a particular embodiment of a system <b>800</b> operable to perform authentication in a SUPL environment using multiple identifiers/passwords. The system <b>800</b> includes a mobile device <b>810</b> (e.g., a SET) that is capable of communicating with a SUPL Server (e.g., a SLP) <b>820</b>.</p>
<p id="p-0076" num="0075">In addition to authentication based on multiple identifiers/passwords, the system <b>800</b> of <figref idref="DRAWINGS">FIG. 8</figref> also illustrates a particular example of binding a device certificate to a SUPL user. For example, the system <b>800</b> may include a web server <b>830</b> to provide a mechanism to create a binding between a device certificate and a SUPL user. It should be noted that the web server <b>830</b> may not provide authentication for SUPL sessions, but rather provide binding information that may subsequently be used by an SLP during SUPL authentication. This binding may typically be performed only once, and may be performed before a SET can engage in SUPL sessions. Once binding is performed, a combination of device certificate and user information may be sent to an SLP, and the SLP may store this information and use it for client authentication. Thus, after binding is performed, an SLP may &#x201c;know&#x201d; that a certain mobile device belongs to a particular SUPL user. The web server <b>830</b> may include a processor <b>831</b> and a memory <b>832</b> storing instructions executable by the processor <b>831</b>. For example, the instructions may represent authentication logic <b>833</b>. The web server <b>830</b> may also include a network interface <b>834</b> operable to communicate with the mobile device <b>810</b> and with the SUPL server <b>820</b>. It should be noted that the web server <b>830</b> is only one example of how to provide binding of a device certificate to a user. In other embodiments, other binding mechanisms may be used. Alternatively, the web server <b>830</b> may store the combination of device certificate and user information, and the SLP (upon performing mutual authentication of the device using the device certificate) may ask the web server <b>830</b> to provide the user information associated with that device certificate.</p>
<p id="p-0077" num="0076">The mobile device <b>810</b> may include authentication logic <b>811</b> (e.g., instructions stored in a memory of the mobile device <b>810</b> and executable by a processor of the mobile device <b>810</b>). The authentication logic <b>811</b> may be configured to communicate with corresponding authentication logic <b>833</b> at the web server <b>830</b> to associate (e.g., &#x201c;bind&#x201d; or &#x201c;register&#x201d;) the mobile device <b>810</b> to a particular SUPL user. For example, the binding process may begin with the mobile device <b>810</b> receiving a message <b>835</b> from the web server <b>830</b>, where the message <b>835</b> includes a server certificate of the web server <b>830</b> and a public key of the web server <b>830</b>. The mobile device <b>810</b> may respond by transmitting a message <b>813</b> to the web server <b>830</b>, where the message <b>813</b> includes a security credential of the mobile device <b>810</b>. For example, the security credential of the mobile device <b>810</b> may include a device certificate including a public key, an international mobile equipment identity (IMEI), a mobile station identification (MSID), and/or a serial number of the mobile device <b>810</b>. The mobile device <b>810</b> may also transmit a message <b>814</b> including user identification information (e.g., a user identifier and a password associated with a SUPL user) to the web server <b>830</b>. One or both of the messages <b>813</b>, <b>814</b> may be encrypted using the public key of the web server <b>830</b>, and the web server <b>830</b> may decrypt the encrypted message(s) using a private key of the web server <b>830</b>.</p>
<p id="p-0078" num="0077">The web server <b>830</b> may authenticate the user identification information provided by the mobile device <b>810</b> to determine whether or not the user identification information is associated with an authorized user of a SUPL service. For example, the web server <b>830</b> may compare the provided user identification information with a SUPL user database that is located at or accessible to the web server <b>830</b>. Upon verifying the user identification information, the web server <b>830</b> may complete the binding process by sending a message <b>836</b> to the SUPL server <b>820</b> to authenticate the mobile device <b>810</b> as associated with an authorized user of a SUPL service. The message <b>836</b> may include the security credential (e.g., a device certificate including device public key and IMEI, MSID, and/or serial number) of the mobile device <b>810</b>.</p>
<p id="p-0079" num="0078">The authentication logic <b>811</b> of the mobile device <b>810</b> may also be configured to communicate with corresponding authentication logic <b>821</b> at the SUPL server <b>820</b> to perform user-mode TLS-based mutual authentication prior to the start or re-start of a SUPL session. For example, the mobile device <b>810</b> may transmit a message <b>815</b> to the SUPL server <b>820</b>, where the message <b>815</b> includes a first identifier and a first password. In a particular embodiment, the first password may be user-selected and may have relatively low cryptographic strength. In an illustrative embodiment, the first identifier and first password may correspond to the identifier and password transmitted by the mobile device <b>810</b> to the web server <b>830</b> via the message <b>814</b>.</p>
<p id="p-0080" num="0079">Upon receiving the first identifier and first password, the authentication logic <b>821</b> may authenticate the first identifier and first password as associated with an authorized user of a SUPL server. For example, the authentication logic <b>821</b> may verify that the first identifier and first password correspond to the authorized user that was previously bound to the mobile device <b>810</b>. When authentication is successful, identifier/password generation logic <b>822</b> at the SUPL server <b>820</b> may generate a second identifier and a second password to replace the first identifier and the first password. In a particular embodiment, the second password may have greater cryptographic strength than the first password. The SUPL server <b>820</b> may transmit the second identifier and the second password to the mobile device <b>810</b> via a message <b>824</b>. Upon subsequent receipt of the second identifier and the second password from the mobile device <b>810</b>, the SUPL server <b>820</b> may establish a SUPL session with the mobile device <b>810</b>. In a particular embodiment, the second identifier and second password may be kept hidden from a user of the mobile device <b>810</b> for security purposes.</p>
<p id="p-0081" num="0080">Although the foregoing descriptions relate to a SUPL user being associated with a single mobile device (e.g., SET), a SUPL user may be associated with multiple devices. For example, the SUPL user associated with the mobile device <b>810</b> may also have access to a second mobile device <b>840</b>. To authorize the second mobile device <b>840</b>, the SUPL user may bind the second mobile device <b>840</b> to his or her account (e.g., SUPL account) in a manner similar to binding the first mobile device <b>810</b>. To perform mutual authentication after the second mobile device <b>840</b> is bound to the account of the SUPL user, the second mobile device <b>840</b> may transmit a message <b>841</b> including the first identifier and the first password to the SUPL server <b>820</b>. Upon authenticating the first identifier and the first password as associated with the authorized SUPL user, the SUPL server <b>820</b> may determine whether or not the second mobile device <b>840</b> should also be granted access to the SUPL service. For example, the SUPL server <b>820</b> may implement a devices-per-user limit and may determine whether allowing the second mobile device <b>840</b> to access the SUPL service would exceed a threshold number of mobile devices associated with the authorized user that are permitted to access the SUPL service. If allowing the second mobile device <b>840</b> to access the SUPL service would not exceed the threshold, the SUPL server <b>820</b> may send a message <b>825</b> including a third identifier and a cryptographically strong third password to the second mobile device <b>840</b>. The third identifier and third password may replace the first identifier and the first password, and may subsequently be used by the second mobile device <b>840</b> to start a SUPL session.</p>
<p id="p-0082" num="0081">In a particular embodiment, the third identifier and third password may be distinct from the second identifier and second password sent to the first mobile device <b>810</b>. By providing distinct identifier/password combinations to each mobile device of a SUPL user, the SUPL server <b>820</b> may implement monitoring on a per device basis. For example, monitoring logic <b>823</b> at the SUPL server <b>820</b> may be configured to monitor usage of the SUPL service by the first mobile device <b>810</b> using the second identifier and to monitor usage of the SUPL service by the second mobile device <b>840</b> using the third identifier.</p>
<p id="p-0083" num="0082">The system <b>800</b> of <figref idref="DRAWINGS">FIG. 8</figref> may thus provide a binding process by which one or more mobile devices may be bound, registered, and/or associated with a particular SUPL user. It will be appreciated that the described binding process may selectively supplement authentication processes described with reference to <figref idref="DRAWINGS">FIGS. 1-4</figref>. For example, as described with reference to <figref idref="DRAWINGS">FIG. 1</figref>, the SUPL server <b>110</b> may attempt to identify a SUPL user as associated with the mobile device <b>120</b> by comparing the device ID <b>125</b> of the mobile device to a stored device ID that was previously securely verified by the SUPL user. In an illustrative embodiment, the SUPL server <b>110</b> of <figref idref="DRAWINGS">FIG. 1</figref> may be the SUPL server <b>820</b>, the mobile device <b>120</b> of <figref idref="DRAWINGS">FIG. 1</figref> may be the mobile device <b>810</b>, and the stored device ID may be included in the device security credential provided to the SUPL server <b>820</b> via the message <b>836</b> during the binding process.</p>
<p id="p-0084" num="0083">In addition, the system <b>800</b> of <figref idref="DRAWINGS">FIG. 8</figref> may provide an authentication process that may selectively replace authentication processes described with reference to <figref idref="DRAWINGS">FIGS. 1-4</figref>. For example, particular embodiments may involve using the multiple identifiers/passwords authentication process of <figref idref="DRAWINGS">FIG. 8</figref> in lieu of GBA-based mutual authentication, SEK-based mutual authentication, and/or certificate-based mutual authentication.</p>
<p id="p-0085" num="0084">Referring to <figref idref="DRAWINGS">FIG. 9</figref>, a particular embodiment of a method of authentication in a SUPL environment using a web server is shown and generally designated <b>900</b>. In an illustrative embodiment, the method <b>900</b> may be performed by the web server <b>830</b> of <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0086" num="0085">The method <b>900</b> may include sending a server certificate from a web server to a SUPL-enabled mobile device, at <b>902</b>. The server certificate may include a public key of the web server. For example, in <figref idref="DRAWINGS">FIG. 8</figref>, the web server <b>830</b> may send the message <b>835</b> to the mobile device <b>810</b>, where the message <b>835</b> includes the certificate and the public key of the web server <b>830</b>.</p>
<p id="p-0087" num="0086">The method <b>900</b> may also include receiving, at the web server, a message from the mobile device that includes a security credential of the mobile device, at <b>904</b>. For example, in <figref idref="DRAWINGS">FIG. 8</figref>, the web server <b>830</b> may receive the message <b>813</b> from the mobile device <b>810</b>, where the message <b>813</b> includes the security credential (e.g., device certificate and device public key) of the mobile device <b>810</b>.</p>
<p id="p-0088" num="0087">The method <b>900</b> may further include decrypting the message using a private key of the web server, at <b>906</b>, and receiving user identification information from the mobile device, at <b>908</b>. For example, in <figref idref="DRAWINGS">FIG. 8</figref>, the web server <b>830</b> may decrypt the message <b>813</b> using a private key and may receive user identification information (e.g., an identifier and password) form the mobile device <b>810</b> via the message <b>814</b>. Alternately, or in addition, the user identification information may also be decrypted using the private key of the web server.</p>
<p id="p-0089" num="0088">The method <b>900</b> may include authenticating the user identification information as identifying an authorized user of a SUPL service, at <b>910</b>, and sending the security credential of the mobile device to a SUPL server to enable the SUPL server to authenticate the mobile device as associated with the authorized user of the SUPL service, at <b>912</b>. For example, in <figref idref="DRAWINGS">FIG. 8</figref>, the web server <b>830</b> may authenticate the user identification information as identifying an authorized SUPL user and may transmit the device security credential to the SUPL server <b>820</b> via the message <b>836</b>.</p>
<p id="p-0090" num="0089">In particular embodiments, the method <b>900</b> of <figref idref="DRAWINGS">FIG. 9</figref> may be implemented via a field-programmable gate array (FPGA) device, an application-specific integrated circuit (ASIC), a processing unit such as a central processing unit (CPU), a digital signal processor (DSP), a controller, another hardware device, firmware device, or any combination thereof. As an example, the method <b>900</b> of <figref idref="DRAWINGS">FIG. 9</figref> can be performed by a processor that executes instructions.</p>
<p id="p-0091" num="0090">Referring to <figref idref="DRAWINGS">FIG. 10</figref>, a particular embodiment of a method of authentication in a SUPL environment using multiple identifiers/passwords is shown and generally designated <b>1000</b>. In an illustrative embodiment, the method <b>1000</b> may be performed by the SUPL server <b>820</b> of <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0092" num="0091">The method <b>1000</b> may include receiving, at a SUPL server, a first identifier and a first password from a mobile device, at <b>1002</b>, and authenticating the first identifier and the first password as associated with an authorized user of a SUPL service, at <b>1004</b>. For example, in <figref idref="DRAWINGS">FIG. 8</figref>, the SUPL server <b>820</b> may receive the first identifier and the first password from the mobile device <b>810</b> via the message <b>815</b>, and may authenticate the first identifier and the first password as associated with an authorized user (e.g., an authorized user previously bound to the mobile device <b>810</b>).</p>
<p id="p-0093" num="0092">The method <b>1000</b> may also include sending a second identifier and a second password to the mobile device to replace the first identifier and the first password, at <b>1006</b>. The SUPL server may be configured to establish a SUPL session with the mobile device upon receiving the second identifier and the second password from the mobile device. For example, in <figref idref="DRAWINGS">FIG. 8</figref>, the SUPL server <b>820</b> may generate and send the second identifier and second password to the mobile device <b>810</b> via the message <b>824</b>, and may establish a SUPL session with the mobile device <b>810</b> upon subsequent receipt of the second identifier and the second password.</p>
<p id="p-0094" num="0093">The method <b>1000</b> may further include receiving, at the SUPL server, the first identifier and the first password from a second mobile device, at <b>1008</b>, and authenticating the first identifier and the first password as associated with the authorized user of the SUPL service, at <b>1010</b>. For example, in <figref idref="DRAWINGS">FIG. 8</figref>, the SUPL server <b>820</b> may receive the first identifier and the first password from the second mobile device <b>840</b> via the message <b>841</b> and may authenticate the first identifier and the first password as associated with the authorized user. To illustrate, the second mobile device <b>840</b> may also have previously been bound to the authorized user via the method <b>900</b> of <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0095" num="0094">The method <b>1000</b> may include determining whether allowing the second mobile device to access the SUPL service would exceed a threshold number of mobile devices associated with the authorized user that are permitted to access the SUPL service, at <b>1012</b>. For example, in <figref idref="DRAWINGS">FIG. 8</figref>, the web server <b>820</b> may determine whether allowing the second mobile device <b>840</b> to access the SUPL service would exceed the threshold. In a particular embodiment, when allowing the second mobile device <b>840</b> to access the SUPL service would not exceed the threshold, the web server <b>820</b> may transmit the third identifier and third password to the second mobile device via the message <b>825</b>. The web server <b>820</b> may also monitor usage of the SUPL service by the first mobile device <b>810</b> and the second mobile device <b>840</b>.</p>
<p id="p-0096" num="0095">In particular embodiments, the method <b>1000</b> of <figref idref="DRAWINGS">FIG. 10</figref> may be implemented via a field-programmable gate array (FPGA) device, an application-specific integrated circuit (ASIC), a processing unit such as a central processing unit (CPU), a digital signal processor (DSP), a controller, another hardware device, firmware device, or any combination thereof. As an example, the method <b>1000</b> of <figref idref="DRAWINGS">FIG. 10</figref> can be performed by a processor that executes instructions.</p>
<p id="p-0097" num="0096">Referring to <figref idref="DRAWINGS">FIG. 11</figref>, a block diagram of a particular illustrative embodiment of a wireless communication device is depicted and generally designated <b>1100</b>. For example, the device <b>1100</b> may be a SUPL-enabled terminal (SET), such as the mobile device <b>120</b> of <figref idref="DRAWINGS">FIG. 1</figref>, the mobile device <b>520</b> of <figref idref="DRAWINGS">FIG. 5</figref>, the first mobile device <b>810</b> of <figref idref="DRAWINGS">FIG. 8</figref>, or the second mobile device <b>840</b> of <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0098" num="0097">The device <b>1100</b> includes a processor <b>1110</b> coupled to a memory <b>1132</b>. The memory <b>1132</b> may include instructions <b>1160</b> executable by the processor <b>1110</b> to perform methods and processes disclosed herein, such as the method <b>300</b> of <figref idref="DRAWINGS">FIG. 3</figref>, the method <b>600</b> of <figref idref="DRAWINGS">FIG. 6</figref>, the method <b>700</b> of <figref idref="DRAWINGS">FIG. 7</figref>, or any combination thereof.</p>
<p id="p-0099" num="0098"><figref idref="DRAWINGS">FIG. 11</figref> also shows a display controller <b>1126</b> that is coupled to the processor <b>1110</b> and to a display <b>1128</b>. A CODEC <b>1134</b> may be coupled to the processor <b>1110</b> and to a speaker <b>1136</b> and a microphone <b>1138</b>. <figref idref="DRAWINGS">FIG. 11</figref> also indicates that one or more wireless controllers <b>1140</b> can be coupled to the processor <b>1110</b> and to wireless antennas <b>1142</b>, <b>1143</b>. In a particular embodiment, the antenna <b>1142</b> may be a 3GPP, 3GPP2, and/or WiMAX antenna and the antenna <b>1143</b> may be a Wi-Fi antenna. A card interface <b>1170</b> may also be coupled to the processor <b>1110</b> and to the wireless controller(s) <b>1140</b>. The card interface <b>1170</b> may be configured to accommodate a card <b>1172</b> (e.g., a subscriber identity module (SIM) card, a universal integrated circuit card (UICC), or other card) storing security credential(s) of the device <b>1100</b>. For example, the security credential may include a device certificate, a public/private key pair, an IMEI, a MSID, a serial number, a globally unique identifier, or any combination thereof. Alternately, or in addition, the security credential(s) of the device <b>1100</b> may be stored in a &#x201c;secure&#x201d; (e.g., not modifiable and/or not accessible by a user) location of the memory <b>1132</b>, such as security credential(s) <b>1161</b>.</p>
<p id="p-0100" num="0099">In a particular embodiment, the processor <b>1110</b>, the display controller <b>1126</b>, the memory <b>1132</b>, the CODEC <b>1134</b>, the wireless controller(s) <b>1140</b>, and the card interface <b>1170</b> are included in a system-in-package or system-on-chip device (e.g., a mobile station modem (MSM)) <b>1122</b>. In a particular embodiment, an input device <b>1130</b>, such as a touchscreen and/or keypad, and a power supply <b>1144</b> are coupled to the system-on-chip device <b>1122</b>. Moreover, in a particular embodiment, as illustrated in <figref idref="DRAWINGS">FIG. 11</figref>, the display <b>1128</b>, the input device <b>1130</b>, the speaker <b>1136</b>, the microphone <b>1138</b>, the wireless antennas <b>1142</b> and <b>1143</b>, and the power supply <b>1144</b> are external to the system-on-chip device <b>1122</b>. However, each of the display <b>1128</b>, the input device <b>1130</b>, the speaker <b>1136</b>, the microphone <b>1138</b>, the wireless antennas <b>1142</b> and <b>1143</b>, and the power supply <b>1144</b> can be coupled to a component of the system-on-chip device <b>1122</b>, such as an interface or a controller.</p>
<p id="p-0101" num="0100">In conjunction with the described embodiments, an apparatus is disclosed that includes means for storing at least one security credential that is specific to a mobile device. For example, the means for storing may be the memory <b>122</b> of <figref idref="DRAWINGS">FIG. 2</figref>, the memory <b>1132</b> of <figref idref="DRAWINGS">FIG. 11</figref>, the card <b>1172</b> of <figref idref="DRAWINGS">FIG. 11</figref>, one or more devices configured to store data, or any combination thereof. The apparatus may also include means for causing the mobile device to transmit the at least one security credential to a SLP to authenticate the mobile device as associated with a SUPL user. For example, the means for causing may be the processor <b>121</b> of <figref idref="DRAWINGS">FIG. 1</figref>, the processor <b>1110</b> of <figref idref="DRAWINGS">FIG. 11</figref>, the wireless controller(s) <b>1140</b> of <figref idref="DRAWINGS">FIG. 1</figref>, one or more devices configured to cause transmission of data, or any combination thereof.</p>
<p id="p-0102" num="0101">In addition, an apparatus is disclosed that includes means for receiving, at a web server, a message from a SUPL-enabled mobile device, where the message includes a security credential of the mobile device. For example, the means for receiving the message may be the network interface <b>834</b> of <figref idref="DRAWINGS">FIG. 8</figref>, one or more devices configured to receive data, or any combination thereof. The apparatus also includes means for receiving, at the web server, user identification information from the mobile device. For example, the means for receiving the user identification information may be the network interface <b>834</b> of <figref idref="DRAWINGS">FIG. 8</figref>, one or more devices configured to receive data, or any combination thereof. The apparatus also includes means for authenticating the user identification information as identifying an authorized user of a SUPL service. For example, the means for authenticating may be the processor <b>831</b> of <figref idref="DRAWINGS">FIG. 8</figref>, one or more devices configured to authenticate user identification information, or any combination thereof. The apparatus includes means for sending the security credential of the mobile device to a SUPL server to enable the SUPL server to authenticate the mobile device as associated with the authorized user of the SUPL service. For example, the means for sending may be the network interface <b>834</b> of <figref idref="DRAWINGS">FIG. 8</figref>, one or more devices configured to receive data, or any combination thereof.</p>
<p id="p-0103" num="0102">Further, an apparatus is disclosed that includes means for receiving, at a SUPL server, a first identifier and a first password from a mobile device. For example, the means for receiving may be a network interface of the SUPL server <b>820</b> of <figref idref="DRAWINGS">FIG. 8</figref>, one or more devices configured to receive data, or any combination thereof. The apparatus also includes means for authenticating the first identifier and the first password as associated with an authorized user of a SUPL service. For example, the means for authenticating may include a processor, such as the processor <b>111</b> of <figref idref="DRAWINGS">FIG. 1</figref>, programmed to execute the authentication logic <b>821</b> of <figref idref="DRAWINGS">FIG. 8</figref>, one or more devices configured to authenticate an identifier and a password, or any combination thereof. The apparatus further includes means for sending a second identifier and a second password to the mobile device to replace the first identifier and the first password, where the SUPL server is configured to establish a SUPL session with the mobile device upon receiving the second identifier and the second password from the mobile device. For example, the means for sending may be a network interface of the SUPL server <b>820</b>, one or more devices configured to send data, or any combination thereof. The apparatus may include means for generating the second identifier and the second password. For example, the means for generating may include a processor, such as the processor <b>111</b> of <figref idref="DRAWINGS">FIG. 1</figref>, programmed to execute the identifier/password generation logic <b>822</b> of <figref idref="DRAWINGS">FIG. 8</figref>, one or more devices configured to generate an identifier and a password, or any combination thereof.</p>
<p id="p-0104" num="0103">In particular embodiments, all or a portion of aforementioned systems and methods may be further described with reference to, and/or may be selectively replaced, individually or in combination, by systems and methods described with reference to the Additional Embodiments below:</p>
<p id="h-0006" num="0000">Additional Embodiment 1</p>
<p id="h-0007" num="0000">Introduction</p>
<p id="p-0105" num="0000">
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0104">Security in SUPL 2.0 is access network specific:
        <ul id="ul0003" list-style="none">
            <li id="ul0003-0001" num="0105">Alternative client authentication (ACA) requires access to core network to identify SET based on Source IP Address</li>
            <li id="ul0003-0002" num="0106">GBA only applicable to 3GPP/3GPP2 networks</li>
            <li id="ul0003-0003" num="0107">SEK only applicable to WiMAX networks</li>
        </ul>
        </li>
        <li id="ul0002-0002" num="0108">A new requirement in SUPL 3.0 calls for an authentication mechanism applicable to all access networks. This embodiment describes a new security mechanism applicable to all access networks:</li>
        <li id="ul0002-0003" num="0109">Simple framework supporting both GBA and &#x201c;username/password&#x201d; authentication</li>
        <li id="ul0002-0004" num="0110">A single TLS variant may be used</li>
        <li id="ul0002-0005" num="0111">Minimal changes to specification and implementation
<br/>
Concept Overview
</li>
        <li id="ul0002-0006" num="0112">ULP Security
        <ul id="ul0004" list-style="none">
            <li id="ul0004-0001" num="0113">TLS with Server certificates</li>
            <li id="ul0004-0002" num="0114">Two Client Authentication modes
            <ul id="ul0005" list-style="none">
                <li id="ul0005-0001" num="0115">(User mode): (User_ID, User_secret)=(Username, Password)</li>
                <li id="ul0005-0002" num="0116">(GBA Mode): (User_ID, User_secret)=(B-TID, Ks_NAF)</li>
            </ul>
            </li>
        </ul>
        </li>
        <li id="ul0002-0007" num="0117">(User_ID, Counter, Digest) added to all messages, with Digest computed as
        <ul id="ul0006" list-style="none">
            <li id="ul0006-0001" num="0118">A1=SLP_Domain&#x2225;ULP_Message,</li>
            <li id="ul0006-0002" num="0119">Digest=HMAC(User_secret, A1)</li>
            <li id="ul0006-0003" num="0120">Sender adds (User_ID, Counter, Digest) to all messages, Receiver verifies</li>
            <li id="ul0006-0004" num="0121">ULP used to update SUPL INIT credentials</li>
        </ul>
        </li>
        <li id="ul0002-0008" num="0122">SUPL INIT Protection [e.g., non-emergency only]
        <ul id="ul0007" list-style="none">
            <li id="ul0007-0001" num="0123">Mimics ULP v2.0 Basic SUPL INIT Protection</li>
            <li id="ul0007-0002" num="0124">Uses SUPL INIT credentials provided by SLP via ULP
<br/>
Setup Details
</li>
        </ul>
        </li>
        <li id="ul0002-0009" num="0125">Offline</li>
        <li id="ul0002-0010" num="0126">(User Mode) User and SLP agree on (Username, Password)</li>
        <li id="ul0002-0011" num="0127">SLP may provide (Username, Password) to User</li>
        <li id="ul0002-0012" num="0128">User may provide (Username, Password) to SLP</li>
        <li id="ul0002-0013" num="0129">This is available to both H-SLP or A-SLP.</li>
        <li id="ul0002-0014" num="0130">At SET start up</li>
        <li id="ul0002-0015" num="0131">(User Mode)</li>
        <li id="ul0002-0016" num="0132">User enters (Username, Password) to SUPL Client</li>
        <li id="ul0002-0017" num="0133">(GBA Mode)</li>
        <li id="ul0002-0018" num="0134">SET bootstraps with BSF to obtain (B-TID, Ks)</li>
        <li id="ul0002-0019" num="0135">Note, SET can refresh (B-TID, Ks) as often as required</li>
        <li id="ul0002-0020" num="0136">SUPL Client performs a ULP session with SLP to obtain fresh SUPL INIT credentials
<br/>
ULP Session Security Proposal
</li>
        <li id="ul0002-0021" num="0137">May use TLS with Server certificates</li>
        <li id="ul0002-0022" num="0138">Takes care of Server Authentication
        <ul id="ul0008" list-style="none">
            <li id="ul0008-0001" num="0139">Add new parameters to ULP messages</li>
        </ul>
        </li>
        <li id="ul0002-0023" num="0140">(User_ID, Req_Count, Req_Digest) to messages from SET,</li>
        <li id="ul0002-0024" num="0141">(User_ID, Resp_Count, Resp_Digest) to messages from SLP
        <ul id="ul0009" list-style="none">
            <li id="ul0009-0001" num="0142">SET originated messages</li>
        </ul>
        </li>
        <li id="ul0002-0025" num="0143">SET adds (User_ID, Req_Count, Req_Digest)</li>
        <li id="ul0002-0026" num="0144">SLP verifies Req_Count and Req_Digest before processing message contents
        <ul id="ul0010" list-style="none">
            <li id="ul0010-0001" num="0145">SLP originated messages</li>
        </ul>
        </li>
        <li id="ul0002-0027" num="0146">SLP adds (User_ID, RespCounter, Resp_Digest)</li>
        <li id="ul0002-0028" num="0147">SET verifies Resp_Count and Resp_Digest before processing message contents
<br/>
Req_Count/Resp_Count
</li>
        <li id="ul0002-0029" num="0148">Req_Count/Resp_Count have similar behavior</li>
        <li id="ul0002-0030" num="0149">Purpose of the counters are to enable replay detection</li>
        <li id="ul0002-0031" num="0150">Req_Count/Resp_Count is reset in receiver and sender every ULP Session</li>
        <li id="ul0002-0032" num="0151">That is, the counter is reset when Session Identifier is changed.
        <ul id="ul0011" list-style="none">
            <li id="ul0011-0001" num="0152">At Sender</li>
        </ul>
        </li>
        <li id="ul0002-0033" num="0153">Req_Count/Resp_Count is incremented every message and added to ULP message
        <ul id="ul0012" list-style="none">
            <li id="ul0012-0001" num="0154">At Receiver:</li>
        </ul>
        </li>
        <li id="ul0002-0034" num="0155">Receiver compares Req_Count/Resp_Count against the value they expected. If they detect replay, then they exit with an error. Otherwise, message passes replay protection
<br/>
Req_Digest/Resp_Digest Generation
</li>
        <li id="ul0002-0035" num="0156">Req_Digest/Resp_Digest generation may be identical
        <ul id="ul0013" list-style="none">
            <li id="ul0013-0001" num="0157">Insert all known values into ULP_Message fields.</li>
            <li id="ul0013-0002" num="0158">Form ULP_Message_Z as ULP_Message with Req_Digest/Resp_Digest field set to all zeroes</li>
            <li id="ul0013-0003" num="0159">Form DigestPayload=SLP_Domain &#x201c;:&#x201d; ULP_Message_Z</li>
            <li id="ul0013-0004" num="0160">Compute
            <ul id="ul0014" list-style="none">
                <li id="ul0014-0001" num="0161">Req_Digest/Resp_Digest=HMAC-SHA256-32(User_secret, DigestPayload)</li>
            </ul>
            </li>
            <li id="ul0013-0005" num="0162">Add Req_Digest/Resp_Digest to appropriate field in ULP_Message</li>
        </ul>
        </li>
        <li id="ul0002-0036" num="0163">(User mode)
        <ul id="ul0015" list-style="none">
            <li id="ul0015-0001" num="0164">Use (User_ID, User_secret):=(Username, Password)</li>
        </ul>
        </li>
        <li id="ul0002-0037" num="0165">(GBA Mode)
        <ul id="ul0016" list-style="none">
            <li id="ul0016-0001" num="0166">Use (User_ID, User_secret):=(B-TID, Ks_NAF), where</li>
            <li id="ul0016-0002" num="0167">[SET] Generate Ks_NAF from Ks and SLP URL</li>
            <li id="ul0016-0003" num="0168">[SLP] Once it extracts User_ID field, SLP provides B-TID to BSF and BSF returns with Ks_NAF. Ks_NAF will not change unless B-TID changes.
<br/>
SUPL_INIT Security Proposal
</li>
        </ul>
        </li>
        <li id="ul0002-0038" num="0169">Mimics Basic SUPL_INIT Protection already defined in ULP TS V2.0 Section 6.1.6.6:</li>
        <li id="ul0002-0039" num="0170">Adapted description from GBA-provisioned keys to SLP-Provisioned keys</li>
        <li id="ul0002-0040" num="0171">SLP updates (Key Identifier, SUPL_INIT_ROOT_KEY) during a ULP Session at initiative of Client or SLP</li>
        <li id="ul0002-0041" num="0172">BasicReplayCounter is reset when Key Identifier is reset</li>
        <li id="ul0002-0042" num="0173">Minimal standardization effort required.
<br/>
SUPL_INIT Credential Management
</li>
        <li id="ul0002-0043" num="0174">Occurs in first ULP exchange of any connection session.</li>
        <li id="ul0002-0044" num="0175">SET-Originated Messages</li>
        <li id="ul0002-0045" num="0176">First message of session should include either</li>
        <li id="ul0002-0046" num="0177">&#x201c;SUPL_INIT Credential_Req&#x201d; indicator if no credentials available, or</li>
        <li id="ul0002-0047" num="0178">Current_Key_Identifier to allow SLP to detect if SET and SLP are out of sync.
        <ul id="ul0017" list-style="none">
            <li id="ul0017-0001" num="0179">SLP-originated messages</li>
        </ul>
        </li>
        <li id="ul0002-0048" num="0180">If Current_Key_Identifier is correct, then add a &#x201c;SUPL_INIT_Credential_OK&#x201d; indicator to confirm.</li>
        <li id="ul0002-0049" num="0181">If Current_Key_Identifier is incorrect, or SET sent &#x201c;SUPL_INIT_Credential_Req&#x201d; indicator or Server wishes to update SUPL_INIT Credentials, then the SLP adds a field to ULP message for provisioning SUPL_INIT credentials</li>
        <li id="ul0002-0050" num="0182">Contains (Key Identifier, SUPL_INIT_ROOT_KEY)
<br/>
Example Call Flows&#x2014;SI Immediate Fix
</li>
        <li id="ul0002-0051" num="0183">Step A: The Target SET sets the req_count to 1234 (or any other running number as determined by the SET) and calculates the message digest (req_digest). The Target SET sends a SUPL START(user-id, req_count=1234, req_digest, . . . ) message to the H-SLP.</li>
        <li id="ul0002-0052" num="0184">Step B: The H-SLP checks the authenticity of SUPL START using the received message digest (req_digest) and also checks the replay counter (req_count). The H-SLP sets the res_count to 4321 (or any other running number as determined by the SET) and calculates the message digest (res_digest). The H-SLP sends a SUPL RESPONSE (user-id, res_count=4321, res_digest, . . . ) message to the Target SET. The period between SUPL START and SUPL RESPONSE at the Target SET=UT1.</li>
        <li id="ul0002-0053" num="0185">Step C: The Target SET checks the authenticity of SUPL RESPONSE using the received message digest (res_digest) and also checks the replay counter (res_count). The Target SET increments the req_count by one (1234+1) and calculates the message digest (req_digest). The Target SET sends a SUPL POS INIT (user-id, req_count=1234+1, req_digest . . . ) message to the H-SLP. The period between SUPL RESPONSE and SUPL POS INIT at the H-SLP=ST1.</li>
        <li id="ul0002-0054" num="0186">Step D: The Target SET and the H-SLP engage in a SUPL POS exchange. The period between SUPL POS INIT and SUPL POS at the Target SET=UT2. Each side checks the message authenticity based on the received message digest and replay integrity based on the message counter (req_count/res_count).</li>
        <li id="ul0002-0055" num="0187">Step E: The H-SLP checks the authenticity of the last SUPL POS message received using the received message digest (req_digest) and also checks the replay counter (req_count). The H-SLP increments req_count (4321+1) and calculates the message digest (res_digest). The H-SLP sends a SUPL END (user-id, res_count=4321+1, res_digest, . . . ) message to the Target SET. The Target SET checks the authenticity of SUPL END using the received message digest (res_digest) and also checks the replay counter (res_count). The period between SUPL POS and SUPL END at the Target SET=UT3.
<br/>
Example Call Flows&#x2014;NI Immediate Fix
</li>
        <li id="ul0002-0056" num="0188">Step A: The H-SLP sets the res_count to 1234 (or any other running number as determined by the H-SLP) and calculates the message digest (BasicMAC). The H-SLP sends a SUPL INIT (user-id, res_count=4321, BasicMAC, . . . ) message to the Target SET.</li>
        <li id="ul0002-0057" num="0189">Step B: The Target SET checks the authenticity of SUPL INIT using the received message digest (BasicMAC) and also checks the replay counter (res_count). The Target SET sets the req_count to 1234 (or any other running number as determined by the SET) and calculates the message digest (req_digest). The Target SET sends a SUPL POS INIT (user-id, req_count=1234, req_digest, . . . ) message to the H-SLP. The period between SUPL INIT and SUPL POS INIT at the H-SLP=ST1.</li>
        <li id="ul0002-0058" num="0190">Step C: The Target SET and the H-SLP engage in a SUPL POS exchange. The period between SUPL POS INIT and SUPL POS at the Target SET=UT2. Each side checks the message authenticity based on the received message digest and replay integrity based on the message counter (req_count/res_count).</li>
        <li id="ul0002-0059" num="0191">Step D: The H-SLP checks the authenticity of the last SUPL POS message received using the received message digest (req_digest) and also checks the replay counter (req_count). The H-SLP increments req_count (4321+1) and calculates the message digest (res_digest). The H-SLP sends a SUPL END (user-id, res_count=4321+1, res_digest, . . . ) message to the Target SET. The Target SET checks the authenticity of SUPL END using the received message digest (res_digest) and also checks the replay counter (res_count). The period between SUPL POS and SUPL END at the Target SET=UT3.
<br/>
Additional Embodiment 2
<br/>
Introduction
</li>
        <li id="ul0002-0060" num="0192">Security in SUPL 2.0 is access network specific:
        <ul id="ul0018" list-style="none">
            <li id="ul0018-0001" num="0193">ACA requires access to the core network to identify SET based on Source IP Address</li>
            <li id="ul0018-0002" num="0194">GBA only applicable to 3GPP/3GPP2 networks</li>
            <li id="ul0018-0003" num="0195">SEK only applicable to WiMAX networks</li>
        </ul>
        </li>
        <li id="ul0002-0061" num="0196">A new requirement in SUPL 3.0 calls for an authentication mechanism applicable to all access networks. This embodiment describes a new security mechanism applicable to all access networks:</li>
        <li id="ul0002-0062" num="0197">Simple framework supporting both GBA and &#x201c;username/password&#x201d; authentication</li>
        <li id="ul0002-0063" num="0198">A single TLS variant may be used</li>
        <li id="ul0002-0064" num="0199">Minimal changes to specification and implementation
<br/>
Concept Overview
</li>
        <li id="ul0002-0065" num="0200">ULP Security
        <ul id="ul0019" list-style="none">
            <li id="ul0019-0001" num="0201">TLS with Server certificates</li>
            <li id="ul0019-0002" num="0202">Two Client Authentication modes
            <ul id="ul0020" list-style="none">
                <li id="ul0020-0001" num="0203">(User Mode): (User_ID, User_secret)=(Username, Password)</li>
                <li id="ul0020-0002" num="0204">(GBA Mode): (User_ID, User_secret)=(B-TID, Ks_NAF)</li>
            </ul>
            </li>
        </ul>
        </li>
        <li id="ul0002-0066" num="0205">(User_ID, Counter, Digest) added to all messages, with Digest computed as
        <ul id="ul0021" list-style="none">
            <li id="ul0021-0001" num="0206">A1=SLP_Domain&#x2225;ULP_Message,</li>
            <li id="ul0021-0002" num="0207">Digest=HMAC(User_secret, A1)</li>
            <li id="ul0021-0003" num="0208">Sender adds (User_ID, Counter, Digest) to all messages, Receiver verifies</li>
            <li id="ul0021-0004" num="0209">ULP used to update SUPL INIT credentials (Key Identity, SUPL_INIT_ROOT_KEY)</li>
        </ul>
        </li>
        <li id="ul0002-0067" num="0210">SUPL INIT Protection [e.g., non-emergency only]
        <ul id="ul0022" list-style="none">
            <li id="ul0022-0001" num="0211">Uses ULP v2.0 Basic SUPL INIT Protection with SUPL INIT credentials generated by SLP (User Mode) or GBA (GBA Mode)</li>
            <li id="ul0022-0002" num="0212">Uses SUPL INIT credentials provided by SLP via ULP in User Mode
<br/>
Setup Details
</li>
        </ul>
        </li>
        <li id="ul0002-0068" num="0213">Offline</li>
        <li id="ul0002-0069" num="0214">(User Mode) User and SLP agree on (Username, Password)
        <ul id="ul0023" list-style="none">
            <li id="ul0023-0001" num="0215">SLP may provide (Username, Password) to User</li>
            <li id="ul0023-0002" num="0216">User may provide (Username, Password) to SLP</li>
            <li id="ul0023-0003" num="0217">This is available to both H-SLP or A-SLP.</li>
        </ul>
        </li>
        <li id="ul0002-0070" num="0218">At SET start up</li>
        <li id="ul0002-0071" num="0219">(User Mode)
        <ul id="ul0024" list-style="none">
            <li id="ul0024-0001" num="0220">User enters (Username, Password) to SUPL Client</li>
        </ul>
        </li>
        <li id="ul0002-0072" num="0221">(GBA Mode)
        <ul id="ul0025" list-style="none">
            <li id="ul0025-0001" num="0222">SET bootstraps with BSF to obtain (B-TID, Ks)</li>
            <li id="ul0025-0002" num="0223">Note, SET can refresh (B-TID, Ks) as often as required</li>
        </ul>
        </li>
        <li id="ul0002-0073" num="0224">SUPL Client performs a ULP session with SLP to obtain fresh SUPL INIT credentials
<br/>
ULP Session Security Proposal
</li>
        <li id="ul0002-0074" num="0225">May use TLS with Server certificates</li>
        <li id="ul0002-0075" num="0226">Takes care of Server Authentication
        <ul id="ul0026" list-style="none">
            <li id="ul0026-0001" num="0227">Add new parameters to ULP messages</li>
        </ul>
        </li>
        <li id="ul0002-0076" num="0228">(User_ID, Req_Count, Req_Digest) to messages from SET,</li>
        <li id="ul0002-0077" num="0229">(User_ID, Resp_Count, Resp_Digest) to messages from SLP
        <ul id="ul0027" list-style="none">
            <li id="ul0027-0001" num="0230">SET originated messages</li>
        </ul>
        </li>
        <li id="ul0002-0078" num="0231">SET adds (User_ID, Req_Count, Req_Digest)</li>
        <li id="ul0002-0079" num="0232">SLP verifies Req_Count and Req_Digest before processing message contents
        <ul id="ul0028" list-style="none">
            <li id="ul0028-0001" num="0233">SLP originated messages</li>
        </ul>
        </li>
        <li id="ul0002-0080" num="0234">SLP adds (User_ID, RespCounter, Resp_Digest)</li>
        <li id="ul0002-0081" num="0235">SET verifies Resp_Count and Resp_Digest before processing message contents
<br/>
Req_Count/Resp_Count
</li>
        <li id="ul0002-0082" num="0236">Req_Count/Resp_Count have similar behavior</li>
        <li id="ul0002-0083" num="0237">Purpose of the counters are to enable replay detection</li>
        <li id="ul0002-0084" num="0238">Req_Count/Resp_Count is reset in receiver and sender every ULP Session</li>
        <li id="ul0002-0085" num="0239">That is, the counter is reset when Session Identifier is changed.
        <ul id="ul0029" list-style="none">
            <li id="ul0029-0001" num="0240">At Sender</li>
        </ul>
        </li>
        <li id="ul0002-0086" num="0241">Req_Count/Resp_Count is incremented every message and added to ULP message
        <ul id="ul0030" list-style="none">
            <li id="ul0030-0001" num="0242">At Receiver:</li>
        </ul>
        </li>
        <li id="ul0002-0087" num="0243">Receiver compares Req_Count/Resp_Count against the value they expected. If they detect replay, then they exit with an error. Otherwise, message passes replay protection
<br/>
Req_Digest/Resp_Digest Generation
</li>
        <li id="ul0002-0088" num="0244">Req_Digest/Resp_Digest generation may be identical
        <ul id="ul0031" list-style="none">
            <li id="ul0031-0001" num="0245">Insert all known values into ULP_Message fields.</li>
            <li id="ul0031-0002" num="0246">Form ULP_Message_Z as ULP_Message with Req_Digest/Resp_Digest field set to all zeroes</li>
            <li id="ul0031-0003" num="0247">Form DigestPayload=SLP_Domain &#x201c;:&#x201d; ULP_Message_Z</li>
            <li id="ul0031-0004" num="0248">Compute Req_Digest/Resp_Digest=HMAC-SHA256-32(User_secret, DigestPayload)</li>
            <li id="ul0031-0005" num="0249">Add Req_Digest/Resp_Digest to appropriate field in ULP_Message</li>
        </ul>
        </li>
        <li id="ul0002-0089" num="0250">(User Mode)
        <ul id="ul0032" list-style="none">
            <li id="ul0032-0001" num="0251">Use (User_ID, User_secret):=(Username, Password)</li>
        </ul>
        </li>
        <li id="ul0002-0090" num="0252">(GBA Mode)
        <ul id="ul0033" list-style="none">
            <li id="ul0033-0001" num="0253">Use (User_ID, User_secret):=(B-TID, Ks_NAF), where</li>
            <li id="ul0033-0002" num="0254">[SET] Generate Ks_NAF from Ks and SLP URL</li>
            <li id="ul0033-0003" num="0255">[SLP] Once it extracts User_ID field, SLP provides B-TID to BSF and BSF returns with Ks_NAF. Ks_NAF will not change unless B-TID changes.
<br/>
SUPL_INIT Security Proposal
</li>
        </ul>
        </li>
        <li id="ul0002-0091" num="0256">Uses Basic SUPL_NIT Protection already defined in ULP TS V2.0 Section 6.1.6.6:</li>
        <li id="ul0002-0092" num="0257">Adapted description from GBA-provisioned keys to SLP-Provisioned keys in User Mode</li>
        <li id="ul0002-0093" num="0258">SLP updates (Key Identifier, SUPL_INIT_ROOT_KEY) during an ULP Session at initiative of Client or SLP in User Mode
        <ul id="ul0034" list-style="none">
            <li id="ul0034-0001" num="0259">BasicReplayCounter is reset when Key Identifier is reset</li>
        </ul>
        </li>
        <li id="ul0002-0094" num="0260">Minimal standardization effort required.
<br/>
SUPL_INIT Protection Parameter
</li>
        <li id="ul0002-0095" num="0261">A SUPL INIT Protector for Basic SUPL INIT Protection consists of:</li>
        <li id="ul0002-0096" num="0262">Key Identifier</li>
        <li id="ul0002-0097" num="0263">BasicReplayCounter (length=2 octets)</li>
        <li id="ul0002-0098" num="0264">BasicMAC (length=4 octets)
        <ul id="ul0035" list-style="none">
            <li id="ul0035-0001" num="0265">The BasicMAC parameter is generated as follows:</li>
        </ul>
        </li>
        <li id="ul0002-0099" num="0266">BasicMAC=HMAC-SHA256-32(SUPL_INIT_Basic_IK, &#x2018;SUPL_INIT&#x2019;)</li>
        <li id="ul0002-0100" num="0267">SUPL_INIT_Basic_IK=HMAC-SHA256-128(SUPL_INIT_ROOT_KEY, &#x201c;Basic IK&#x201d;)
        <ul id="ul0036" list-style="none">
            <li id="ul0036-0001" num="0268">BasicReplayCounter is reset when Key Identifier is reset</li>
            <li id="ul0036-0002" num="0269">Key Identifier and SUPL_INIT_ROOT_KEY are NOT the same as User_ID and User_secret i.e., SUPL INIT protection works independently from ULP message authentication.
<br/>
SUPL_INIT Credential Management
</li>
        </ul>
        </li>
        <li id="ul0002-0101" num="0270">Occurs in first ULP exchange of any connection session.</li>
        <li id="ul0002-0102" num="0271">SET-Originated Messages</li>
        <li id="ul0002-0103" num="0272">First message of session should include either
        <ul id="ul0037" list-style="none">
            <li id="ul0037-0001" num="0273">&#x201c;SUPL_INIT_Credential_Req&#x201d; indicator if no credentials available, or</li>
            <li id="ul0037-0002" num="0274">Current_Key_Identifier to allow SLP to detect if SET and SLP are out of sync.
            <ul id="ul0038" list-style="none">
                <li id="ul0038-0001" num="0275">SLP-originated messages</li>
            </ul>
            </li>
        </ul>
        </li>
        <li id="ul0002-0104" num="0276">If Current_Key_Identifier is correct, then add a &#x201c;SUPL_INIT_Credential_OK&#x201d; indicator to confirm.</li>
        <li id="ul0002-0105" num="0277">If Current_Key_Identifier is incorrect, or SET sent &#x201c;SUPL_INIT_Credential_Req&#x201d; indicator or Server wishes to update SUPL_INIT Credentials, then the SLP adds a field to ULP message for provisioning SUPL_INIT credentials</li>
        <li id="ul0002-0106" num="0278">Contains (Key Identifier, SUPL_INIT_ROOT_KEY)
<br/>
Example Call Flows&#x2014;SI Immediate Fix
</li>
        <li id="ul0002-0107" num="0279">Step A: The Target SET sets the req_count to 1234 (or any other running number as determined by the SET) and calculates the message digest (req_digest). The Target SET sends a SUPL START(user-id, req_count=1234, req_digest, . . . ) message to the H-SLP.</li>
        <li id="ul0002-0108" num="0280">Step B: The H-SLP checks the authenticity of SUPL START using the received message digest (req_digest) and also checks the replay counter (req_count). The H-SLP sets the res_count to 4321 (or any other running number as determined by the SET) and calculates the message digest (res_digest). The H-SLP sends a SUPL RESPONSE (user-id, res_count=4321, res_digest, . . . ) message to the Target SET. The period between SUPL START and SUPL RESPONSE at the Target SET=UT1.</li>
        <li id="ul0002-0109" num="0281">Step C: The Target SET checks the authenticity of SUPL RESPONSE using the received message digest (res_digest) and also checks the replay counter (res_count). The Target SET increments the req_count by one (1234+1) and calculates the message digest (req_digest). The Target SET sends a SUPL POS INIT (user-id, req_count=1234+1, req_digest . . . ) message to the H-SLP. The period between SUPL RESPONSE and SUPL POS INIT at the H-SLP=ST1.</li>
        <li id="ul0002-0110" num="0282">Step D: The Target SET and the H-SLP engage in a SUPL POS exchange. The period between SUPL POS INIT and SUPL POS at the Target SET=UT2. Each side checks the message authenticity based on the received message digest and replay integrity based on the message counter (req_count/res_count).</li>
        <li id="ul0002-0111" num="0283">Step E: The H-SLP checks the authenticity of the last SUPL POS message received using the received message digest (req_digest) and also checks the replay counter (req_count). The H-SLP increments req_count (4321+1) and calculates the message digest (res_digest). The H-SLP sends a SUPL END (user-id, res_count=4321+1, res_digest, . . . ) message to the Target SET. The Target SET checks the authenticity of SUPL END using the received message digest (res_digest) and also checks the replay counter (res_count). The period between SUPL POS and SUPL END at the Target SET=UT3.
<br/>
Example Call Flows&#x2014;NI Immediate Fix
</li>
        <li id="ul0002-0112" num="0284">Step A: The H-SLP sets the res_count to 1234 (or any other running number as determined by the H-SLP) and calculates the message digest (BasicMAC). The H-SLP sends a SUPL INIT (user-id, res_count=4321, BasicMAC, . . . ) message to the Target SET.</li>
        <li id="ul0002-0113" num="0285">Step B: The Target SET checks the authenticity of SUPL INIT using the received message digest (BasicMAC) and also checks the replay counter (res_count). The Target SET sets the req_count to 1234 (or any other running number as determined by the SET) and calculates the message digest (req_digest). The Target SET sends a SUPL POS INIT (user-id, req_count=1234, req_digest, . . . ) message to the H-SLP. The period between SUPL INIT and SUPL POS INIT at the H-SLP=ST1.</li>
        <li id="ul0002-0114" num="0286">Step C: The Target SET and the H-SLP engage in a SUPL POS exchange. The period between SUPL POS INIT and SUPL POS at the Target SET=UT2. Each side checks the message authenticity based on the received message digest and replay integrity based on the message counter (req_count/res_count).</li>
        <li id="ul0002-0115" num="0287">Step D: The H-SLP checks the authenticity of the last SUPL POS message received using the received message digest (req_digest) and also checks the replay counter (req_count). The H-SLP increments req_count (4321+1) and calculates the message digest (res_digest). The H-SLP sends a SUPL END (user-id, res_count=4321+1, res_digest, . . . ) message to the Target SET. The Target SET checks the authenticity of SUPL END using the received message digest (res_digest) and also checks the replay counter (res_count). The period between SUPL POS and SUPL END at the Target SET=UT3.
<br/>
Additional Embodiment 3
<br/>
Introduction
</li>
        <li id="ul0002-0116" num="0288">Security in SUPL 2.0 is access network specific:
        <ul id="ul0039" list-style="none">
            <li id="ul0039-0001" num="0289">ACA requires access to the core network to identify SET based on Source IP Address</li>
            <li id="ul0039-0002" num="0290">GBA only applicable to 3GPP/3GPP2 networks</li>
            <li id="ul0039-0003" num="0291">SEK only applicable to WiMAX networks</li>
        </ul>
        </li>
        <li id="ul0002-0117" num="0292">A new requirement in SUPL 3.0 calls for an authentication mechanism applicable to all access networks. This embodiment describes a new security mechanism applicable to all access networks:
        <ul id="ul0040" list-style="none">
            <li id="ul0040-0001" num="0293">Simple framework supporting both GBA and &#x201c;username/password&#x201d; authentication
<br/>
SUPL 3.0 Security Concept Overview I
</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0106" num="0294">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="28pt" align="left"/>
<colspec colname="2" colwidth="112pt" align="left"/>
<colspec colname="3" colwidth="77pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry>Security</entry>
<entry/>
<entry/>
</row>
<row>
<entry>Method</entry>
<entry>Description</entry>
<entry>Comments</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>A: ACA</entry>
<entry>Alternative Client Authentication as</entry>
<entry>For SUPL deployments</entry>
</row>
<row>
<entry/>
<entry>supported in SUPL 1.0 and 2.0.</entry>
<entry>with medium security</entry>
</row>
<row>
<entry/>
<entry>Server authentication and encryption</entry>
<entry>requirements and with</entry>
</row>
<row>
<entry/>
<entry>using server authenticated TLS.</entry>
<entry>access to IP Address</entry>
</row>
<row>
<entry/>
<entry>Client authentication using IP</entry>
<entry>client verification. This is</entry>
</row>
<row>
<entry/>
<entry>Address/MSISDN consistency</entry>
<entry>a legacy security method.</entry>
</row>
<row>
<entry/>
<entry>checking involving core network.</entry>
</row>
<row>
<entry>B: GBA</entry>
<entry>GBA based security as supported in</entry>
<entry>For SUPL deployments</entry>
</row>
<row>
<entry/>
<entry>SUPL 2.0. Only applicable to</entry>
<entry>with high security</entry>
</row>
<row>
<entry/>
<entry>3GPP/3GPP2 networks. Server and</entry>
<entry>requirements and with</entry>
</row>
<row>
<entry/>
<entry>client authentication and encryption</entry>
<entry>access to GBA</entry>
</row>
<row>
<entry/>
<entry>using PSK-TLS.</entry>
<entry>infrastructure. This is a</entry>
</row>
<row>
<entry/>
<entry/>
<entry>legacy security method.</entry>
</row>
<row>
<entry>C: User</entry>
<entry>Server authentication and encryption</entry>
<entry>For SUPL deployments</entry>
</row>
<row>
<entry>Mode</entry>
<entry>using server authenticated TLS.</entry>
<entry>with high security</entry>
</row>
<row>
<entry>ULP</entry>
<entry>Client authentication using</entry>
<entry>requirements and no</entry>
</row>
<row>
<entry/>
<entry>(Username, Password) and MAC</entry>
<entry>access to GBA</entry>
</row>
<row>
<entry/>
<entry>attached to each ULP message from</entry>
<entry>infrastructure. This</entry>
</row>
<row>
<entry/>
<entry>client to server.</entry>
<entry>is a new security method.</entry>
</row>
<row>
<entry>D: User</entry>
<entry>Server authentication and encryption</entry>
<entry>For SUPL deployments</entry>
</row>
<row>
<entry>Mode</entry>
<entry>using server authenticated TLS.</entry>
<entry>with high security</entry>
</row>
<row>
<entry>TLS</entry>
<entry>Client authentication using</entry>
<entry>requirements and no</entry>
</row>
<row>
<entry/>
<entry>(Username, Password) SRP TLS.</entry>
<entry>access to GBA</entry>
</row>
<row>
<entry/>
<entry/>
<entry>infrastructure. This is a</entry>
</row>
<row>
<entry/>
<entry/>
<entry>new security method.</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
SUPL 3.0 Security Concept Overview II
</p>
<p id="p-0107" num="0295">The following two options are considered for SUPL 3.0 security:</p>
<p id="p-0108" num="0296">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="91pt" align="left"/>
<colspec colname="2" colwidth="98pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Option I</entry>
<entry>Option II</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>ACA (A)</entry>
<entry>ACA (A)</entry>
</row>
<row>
<entry/>
<entry>GBA (B)</entry>
<entry>GBA (B)</entry>
</row>
<row>
<entry/>
<entry>User Mode ULP (C)</entry>
<entry>User Mode TLS (D)</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
Option I: Concept Overview
<ul id="ul0041" list-style="none">
    <li id="ul0041-0001" num="0000">
    <ul id="ul0042" list-style="none">
        <li id="ul0042-0001" num="0297">ULP Security</li>
        <li id="ul0042-0002" num="0298">GBA Mode: Use TLS-PSK as before</li>
        <li id="ul0042-0003" num="0299">User Mode ULP: Based on (Username, Password)
        <ul id="ul0043" list-style="none">
            <li id="ul0043-0001" num="0300">First perform TLS handshake with server certificates to establish a secure connection</li>
        </ul>
        </li>
        <li id="ul0042-0004" num="0301">(Username, Counter, Digest) added to all ULP messages sent by the SET, with Digest computed as
        <ul id="ul0044" list-style="none">
            <li id="ul0044-0001" num="0302">A1=SLP_Domain&#x2225;ULP_Message,</li>
            <li id="ul0044-0002" num="0303">Digest=HMAC(Password, A1)</li>
        </ul>
        </li>
        <li id="ul0042-0005" num="0304">SET adds (Username, Counter, Digest) to all messages, SLP verifies</li>
        <li id="ul0042-0006" num="0305">ULP used to update SUPL INIT credentials (Key Identity, SUPL_INIT_ROOT_KEY) required for SUPL INIT protection
<br/>
Option I: Offline Procedures
</li>
        <li id="ul0042-0007" num="0306">User Mode ULP (Offline)</li>
        <li id="ul0042-0008" num="0307">User and SLP operator agree on (Username, Password)
        <ul id="ul0045" list-style="none">
            <li id="ul0045-0001" num="0308">Other assumptions</li>
        </ul>
        </li>
        <li id="ul0042-0009" num="0309">SET has URL of SLP</li>
        <li id="ul0042-0010" num="0310">SET has appropriate root certificates for authenticating SLP
<br/>
Option I: Online Procedures
</li>
        <li id="ul0042-0011" num="0311">TLS with server certificates used for server authentication and encryption</li>
        <li id="ul0042-0012" num="0312">New parameters are added to ULP messages from the SET: (Username, Counter, Digest)</li>
        <li id="ul0042-0013" num="0313">SLP verifies Counter and Digest before processing ULP message content</li>
        <li id="ul0042-0014" num="0314">Purpose of the Counter is to enable replay detection</li>
        <li id="ul0042-0015" num="0315">Counter is reset in receiver and sender for every ULP Session</li>
        <li id="ul0042-0016" num="0316">At sender, the Counter is incremented every message and added to the ULP message</li>
        <li id="ul0042-0017" num="0317">At receiver, Counter is compared against the value expected. If replay detected, exit with error. Otherwise, message passes replay protection.
<br/>
Option II: Concept Overview
</li>
        <li id="ul0042-0018" num="0318">ULP Security</li>
        <li id="ul0042-0019" num="0319">GBA Mode: Use TLS-PSK as before</li>
        <li id="ul0042-0020" num="0320">User Mode TLS: Based on (Username, Password)
        <ul id="ul0046" list-style="none">
            <li id="ul0046-0001" num="0321">First perform TLS handshake with server certificates to establish a secure connection</li>
            <li id="ul0046-0002" num="0322">SLP sends &#x201c;Hello Request&#x201d; to initiate TLS renegotiation. Then SET &#x26; SLP perform TLS-SRP handshake (SRP=Secure Remote Password) to authenticate user using (Username, Password).</li>
            <li id="ul0046-0003" num="0323">The first secure connection is required to hide the username in TLS-SRP handshake.</li>
        </ul>
        </li>
        <li id="ul0042-0021" num="0324">ULP used to update Basic Protection SUPL INIT credentials (Key Identity, SUPL_INIT_ROOT_KEY) required for SUPL INIT protection
<br/>
Option II: Offline Procedures
</li>
        <li id="ul0042-0022" num="0325">User Mode TLS (Offline)</li>
        <li id="ul0042-0023" num="0326">User and SLP operator agree on (Username, Password)</li>
        <li id="ul0042-0024" num="0327">Other assumptions
        <ul id="ul0047" list-style="none">
            <li id="ul0047-0001" num="0328">SET has URL of SLP</li>
            <li id="ul0047-0002" num="0329">SET has appropriate root certificates for authenticating SLP
<br/>
Option II: Online Procedures
</li>
        </ul>
        </li>
        <li id="ul0042-0025" num="0330">SET initiates TLS Handshake, indicating in the TLS support for GBA and/or User Mode by selecting the appropriate cipher suites.</li>
        <li id="ul0042-0026" num="0331">SLP decides whether to proceed with GBA mode or User Mode</li>
        <li id="ul0042-0027" num="0332">If GBA mode, then
        <ul id="ul0048" list-style="none">
            <li id="ul0048-0001" num="0333">Continue TLS handshake as for TLS-PSK using GBA to establish secure tunnel
            <ul id="ul0049" list-style="none">
                <li id="ul0049-0001" num="0334">Mutual authentication</li>
            </ul>
            </li>
            <li id="ul0048-0002" num="0335">Exchange data in secure channel</li>
        </ul>
        </li>
        <li id="ul0042-0028" num="0336">If User mode, then
        <ul id="ul0050" list-style="none">
            <li id="ul0050-0001" num="0337">First continue TLS handshake with server certificates to establish secure channel
            <ul id="ul0051" list-style="none">
                <li id="ul0051-0001" num="0338">SET Authenticates the SLP</li>
            </ul>
            </li>
            <li id="ul0050-0002" num="0339">Performs TLS-SRP handshake (messages exchanged inside the secure channel)
            <ul id="ul0052" list-style="none">
                <li id="ul0052-0001" num="0340">SLP Authenticates the user</li>
                <li id="ul0052-0002" num="0341">Results in new session keys</li>
            </ul>
            </li>
            <li id="ul0050-0003" num="0342">Exchange data in secure tunnel protected by new session keys
<br/>
Option II: Online Procedure&#x2014;First TLS Handshake
</li>
        </ul>
        </li>
        <li id="ul0042-0029" num="0343">SET&#x2192;SLP: Client Hello:</li>
        <li id="ul0042-0030" num="0344">Indicates all supported cipher suites
        <ul id="ul0053" list-style="none">
            <li id="ul0053-0001" num="0345">If SET supports GBA, then indicate support for TLS-PSK cipher suite(s)</li>
            <li id="ul0053-0002" num="0346">If SET supports User Mode, then indicate support for TLS with server certificates and TLS SRP</li>
        </ul>
        </li>
        <li id="ul0042-0031" num="0347">SET does not provide username at this time, if required will be provided in the next TLS handshake
        <ul id="ul0054" list-style="none">
            <li id="ul0054-0001" num="0348">SLP&#x2192;SET: Server Hello:</li>
        </ul>
        </li>
        <li id="ul0042-0032" num="0349">Indicates chosen cipher suite
        <ul id="ul0055" list-style="none">
            <li id="ul0055-0001" num="0350">If SLP selects GBA mode, then SLP indicates a TLS-PSK cipher suite</li>
            <li id="ul0055-0002" num="0351">If SLP selects User Mode, the SLP indicates cipher suite for TLS with server certificates</li>
            <li id="ul0055-0003" num="0352">Call flow proceeds as for selected cipher suite
<br/>
Option II: Online Procedure&#x2014;After First TLS Handshake
</li>
        </ul>
        </li>
        <li id="ul0042-0033" num="0353">GBA Mode</li>
        <li id="ul0042-0034" num="0354">SET and SLP start communicating over secured channel
        <ul id="ul0056" list-style="none">
            <li id="ul0056-0001" num="0355">User Mode</li>
        </ul>
        </li>
        <li id="ul0042-0035" num="0356">SLP&#x2192;SET: Hello Request
        <ul id="ul0057" list-style="none">
            <li id="ul0057-0001" num="0357">Initiates renegotiation</li>
        </ul>
        </li>
        <li id="ul0042-0036" num="0358">SET&#x2192;SLP: Client Hello
        <ul id="ul0058" list-style="none">
            <li id="ul0058-0001" num="0359">Indicates support for TLS-SRP</li>
            <li id="ul0058-0002" num="0360">Includes Username as per TLS-SRP specifications</li>
        </ul>
        </li>
        <li id="ul0042-0037" num="0361">SET&#x2192;SLP: ServerHello
        <ul id="ul0059" list-style="none">
            <li id="ul0059-0001" num="0362">Indicates selection of TLS-SRP</li>
        </ul>
        </li>
        <li id="ul0042-0038" num="0363">Exchange continues as per TLS-SRP</li>
        <li id="ul0042-0039" num="0364">Following successful handshake, SET &#x26; SLP begin exchanging data over secured channel.
<br/>
SUPL INIT Protection
</li>
        <li id="ul0042-0040" num="0365">SUPL INIT protection in SUPL 3.0 is based on SUPL INIT protection mechanism in SUPL 2.0 and uses a Message Authentication Code (MAC) attached to SUPL INIT</li>
        <li id="ul0042-0041" num="0366">MAC is calculated using (Key Identity, SUPL_INIT_ROOT_KEY) provisioned over ULP in User Mode (GBA mode does not require provisioning)</li>
        <li id="ul0042-0042" num="0367">Two methods for calculating (Key Identity, SUPL_INIT_ROOT_KEY):</li>
        <li id="ul0042-0043" num="0368">GBA mode: (Key Identity, SUPL_INIT_ROOT_KEY)=(B-TID, Ks)
        <ul id="ul0060" list-style="none">
            <li id="ul0060-0001" num="0369">(B-TID, Ks) are bootstrapped off of BSF</li>
        </ul>
        </li>
        <li id="ul0042-0044" num="0370">User Mode: (Key Identity, SUPL_INIT_ROOT_KEY) is generated from (Username, Password)
        <ul id="ul0061" list-style="none">
            <li id="ul0061-0001" num="0371">SUPL INIT Protection is the same for Option I and Option II
<br/>
SUPL INIT Protection Mechanism
</li>
        </ul>
        </li>
        <li id="ul0042-0045" num="0372">Two Levels of Protection in SUPL v3.0:</li>
        <li id="ul0042-0046" num="0373">NULL
        <ul id="ul0062" list-style="none">
            <li id="ul0062-0001" num="0374">No security</li>
        </ul>
        </li>
        <li id="ul0042-0047" num="0375">Basic Protection
        <ul id="ul0063" list-style="none">
            <li id="ul0063-0001" num="0376">Based on shared Key Identity, SUPL_INIT_ROOT_KEY provisioned over ULP</li>
            <li id="ul0063-0002" num="0377">Mimics Basic Protection from SUPL v2.0</li>
            <li id="ul0063-0003" num="0378">Key Identifier and SUPL_INIT_ROOT_KEY are NOT the same as Username, Password</li>
            <li id="ul0063-0004" num="0379">Re-sync Protection Mechanism:</li>
        </ul>
        </li>
        <li id="ul0042-0048" num="0380">Based on digital signature that SET can verify from the SLP's certificate in SET</li>
        <li id="ul0042-0049" num="0381">May be only used when SLP is convinced that the Key Identity, SUPL_INIT_ROOT_KEY in the SLP and SET have become out of sync.</li>
        <li id="ul0042-0050" num="0382">May be expensive to compute: may be used sparingly.
<br/>
Basic SUPL INIT Protection Parameter
</li>
        <li id="ul0042-0051" num="0383">A SUPL INIT Protector for Basic SUPL INIT Protection consists of:</li>
        <li id="ul0042-0052" num="0384">Key Identifier</li>
        <li id="ul0042-0053" num="0385">BasicReplayCounter (length=2 octets)</li>
        <li id="ul0042-0054" num="0386">BasicMAC (length=4 octets)
        <ul id="ul0064" list-style="none">
            <li id="ul0064-0001" num="0387">The BasicMAC parameter is generated as follows:</li>
        </ul>
        </li>
        <li id="ul0042-0055" num="0388">BasicMAC=HMAC-SHA256-32(SUPL_INIT_Basic_IK, &#x2018;SUPL_INIT&#x2019;)</li>
        <li id="ul0042-0056" num="0389">SUPL_INIT_Basic_IK=HMAC-SHA256-128(SUPL_INIT_ROOT_KEY, &#x201c;Basic IK&#x201d;)
        <ul id="ul0065" list-style="none">
            <li id="ul0065-0001" num="0390">BasicReplayCounter is reset when Key Identifier is reset
<br/>
SUPL_INIT_ROOT_KEY Management
</li>
        </ul>
        </li>
        <li id="ul0042-0057" num="0391">Occurs in first ULP exchange of any SUPL session</li>
        <li id="ul0042-0058" num="0392">First SET originated message</li>
        <li id="ul0042-0059" num="0393">First message of session should include either
        <ul id="ul0066" list-style="none">
            <li id="ul0066-0001" num="0394">&#x201c;SUPL_INIT_Credential_Req&#x201d; indicator if no credentials available, or</li>
            <li id="ul0066-0002" num="0395">Current_Key_Identifier to allow SLP to detect if SET and SLP are out of sync.
            <ul id="ul0067" list-style="none">
                <li id="ul0067-0001" num="0396">SLP response</li>
            </ul>
            </li>
        </ul>
        </li>
        <li id="ul0042-0060" num="0397">If Current_Key_Identifier is correct, then add a &#x201c;SUPL_INIT_Credential_OK&#x201d; indicator to confirm.</li>
        <li id="ul0042-0061" num="0398">If Current_Key_Identifier is incorrect, or SET sent &#x201c;SUPL_INIT_Credential_Req&#x201d; indicator or SLP wishes to update SUPL_INIT Credentials, then the SLP adds a field to ULP message for provisioning SUPL_INIT credentials
        <ul id="ul0068" list-style="none">
            <li id="ul0068-0001" num="0399">Contains (Key Identifier, SUPL_INIT_ROOT_KEY)
<br/>
Comparison of User Modes
</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0109" num="0400">
<tables id="TABLE-US-00003" num="00003">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="56pt" align="left"/>
<colspec colname="1" colwidth="77pt" align="left"/>
<colspec colname="2" colwidth="84pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Plus</entry>
<entry>Delta</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="56pt" align="left"/>
<colspec colname="2" colwidth="77pt" align="left"/>
<colspec colname="3" colwidth="84pt" align="left"/>
<tbody valign="top">
<row>
<entry>Option I: User</entry>
<entry>Requires no change to</entry>
<entry>Security distributed</entry>
</row>
<row>
<entry>Mode ULP</entry>
<entry>existing TLS</entry>
<entry>over two layers: TLS</entry>
</row>
<row>
<entry/>
<entry>implementation</entry>
<entry>and ULP</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Security not transparent</entry>
</row>
<row>
<entry/>
<entry/>
<entry>to ULP layer</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Higher implementation</entry>
</row>
<row>
<entry/>
<entry/>
<entry>risk since ULP</entry>
</row>
<row>
<entry/>
<entry/>
<entry>implementation is</entry>
</row>
<row>
<entry/>
<entry/>
<entry>performed by non</entry>
</row>
<row>
<entry/>
<entry/>
<entry>security experts.</entry>
</row>
<row>
<entry>Option II:</entry>
<entry>Security provided by</entry>
<entry>More complex TLS</entry>
</row>
<row>
<entry>User Mode</entry>
<entry>transport layer (single</entry>
<entry>implementation</entry>
</row>
<row>
<entry>TLS</entry>
<entry>layer security) and</entry>
</row>
<row>
<entry/>
<entry>thus transparent to</entry>
</row>
<row>
<entry/>
<entry>ULP layer</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
Summary
<ul id="ul0069" list-style="none">
    <li id="ul0069-0001" num="0000">
    <ul id="ul0070" list-style="none">
        <li id="ul0070-0001" num="0401">Two new security models are considered in SUPL 3.0</li>
        <li id="ul0070-0002" num="0402">Option I: User Mode ULP</li>
        <li id="ul0070-0003" num="0403">Option II: User Mode TLS
        <ul id="ul0071" list-style="none">
            <li id="ul0071-0001" num="0404">The two new security models use (Username, Password) client authentication while server authentication and encryption are based on legacy server authenticated TLS.</li>
            <li id="ul0071-0002" num="0405">Both options are bearer agnostic security models and are thus suitable for SUPL 3.0.</li>
            <li id="ul0071-0003" num="0406">Legacy security models (ACA and GBA) may still be used where applicable and desirable.
<br/>
SRP Basics
</li>
        </ul>
        </li>
        <li id="ul0070-0004" num="0407">TLS-SRP [IETF RFC 5054] uses Secure Remote Password (SRP [RFC2945]) as the basis of authentication and key exchange</li>
        <li id="ul0070-0005" num="0408">Main steps</li>
        <li id="ul0070-0006" num="0409">The server doing the authentication does not need the password, instead it stores a triplet containing {Username, PasswordVerifier, Salt}
        <ul id="ul0072" list-style="none">
            <li id="ul0072-0001" num="0410">Typically the user's client generates triplet when registering offline with Server
            <ul id="ul0073" list-style="none">
                <li id="ul0073-0001" num="0411">Salt may be randomly chosen by user</li>
                <li id="ul0073-0002" num="0412">PasswordVerifier is computed from Username, Salt and the user's Password using tricky mathematics similar to Diffie-Hellman key exchange.</li>
            </ul>
            </li>
        </ul>
        </li>
        <li id="ul0070-0007" num="0413">The server uses the triplet in an interaction with the user to
        <ul id="ul0074" list-style="none">
            <li id="ul0074-0001" num="0414">Verify that the user knows the password and</li>
            <li id="ul0074-0002" num="0415">Establish a shared secret known only by the user and the server. This shared secret can then be used for generating keys for encryption and integrity protection (which is how it is used in TLS-SRP)
<br/>
Some Properties of SRP
</li>
        </ul>
        </li>
        <li id="ul0070-0008" num="0416">The triplet cannot be used to impersonate the user</li>
        <li id="ul0070-0009" num="0417">Server does not need to keep triplet confidential</li>
        <li id="ul0070-0010" num="0418">A server can provide the triplet to a third party to allow that party to verify the user, without the server being concerned that the third party will then try to impersonate the user</li>
        <li id="ul0070-0011" num="0419">For example, a H-SLP can provide the triplet to an A-SLP to allow the A-SLP to authenticate the user.
<br/>
Additional Embodiment 4
<br/>
Introduction
</li>
        <li id="ul0070-0012" num="0420">Security in SUPL 2.0 is access network specific:
        <ul id="ul0075" list-style="none">
            <li id="ul0075-0001" num="0421">ACA requires access to the core network to identify SET based on Source IP Address</li>
            <li id="ul0075-0002" num="0422">GBA only applicable to 3GPP/3GPP2 networks</li>
            <li id="ul0075-0003" num="0423">SEK only applicable to WiMAX networks</li>
        </ul>
        </li>
        <li id="ul0070-0013" num="0424">A new requirement in SUPL 3.0 calls for an authentication mechanism applicable to all access networks. This embodiment describes a new security mechanism applicable to all access networks:
        <ul id="ul0076" list-style="none">
            <li id="ul0076-0001" num="0425">Simple framework supporting both GBA and &#x201c;username/password&#x201d; authentication
<br/>
SUPL 3.0 Security Concept Overview I
</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0110" num="0426">
<tables id="TABLE-US-00004" num="00004">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="112pt" align="left"/>
<colspec colname="3" colwidth="105pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry>Security</entry>
<entry/>
<entry/>
</row>
<row>
<entry>Method</entry>
<entry>Description</entry>
<entry>Comments</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>A: ACA</entry>
<entry>Alternative Client Authentication as</entry>
<entry>For SUPL deployments with</entry>
</row>
<row>
<entry/>
<entry>supported in SUPL 1.0 and 2.0.</entry>
<entry>medium security requirements</entry>
</row>
<row>
<entry/>
<entry>Server authentication and encryption</entry>
<entry>and with access to IP Address</entry>
</row>
<row>
<entry/>
<entry>using server authenticated TLS.</entry>
<entry>client verification. This is a</entry>
</row>
<row>
<entry/>
<entry>Client authentication using IP</entry>
<entry>legacy security method.</entry>
</row>
<row>
<entry/>
<entry>Address/MSISDN consistency</entry>
</row>
<row>
<entry/>
<entry>checking involving core network.</entry>
</row>
<row>
<entry>B: GBA</entry>
<entry>GBA based security as supported in</entry>
<entry>For SUPL deployments with high</entry>
</row>
<row>
<entry/>
<entry>SUPL 2.0. Only applicable to</entry>
<entry>security requirements and with</entry>
</row>
<row>
<entry/>
<entry>3GPP/3GPP2 networks. Server and</entry>
<entry>access to GBA infrastructure.</entry>
</row>
<row>
<entry/>
<entry>client authentication and encryption</entry>
<entry>This is a legacy security method.</entry>
</row>
<row>
<entry/>
<entry>using PSK-TLS.</entry>
</row>
<row>
<entry>C: User</entry>
<entry>Server authentication and encryption</entry>
<entry>For SUPL deployments with high</entry>
</row>
<row>
<entry>Mode ULP</entry>
<entry>using server authenticated TLS.</entry>
<entry>security requirements and no</entry>
</row>
<row>
<entry/>
<entry>Client authentication using</entry>
<entry>access to GBA infrastructure.</entry>
</row>
<row>
<entry/>
<entry>(Username, Password) and MAC</entry>
<entry>This is a new security method.</entry>
</row>
<row>
<entry/>
<entry>attached to each ULP message from</entry>
</row>
<row>
<entry/>
<entry>client to server.</entry>
</row>
<row>
<entry>D: User</entry>
<entry>Server authentication and encryption</entry>
<entry>For SUPL deployments with high</entry>
</row>
<row>
<entry>Mode TLS</entry>
<entry>using server authenticated TLS.</entry>
<entry>security requirements and no</entry>
</row>
<row>
<entry/>
<entry>Client authentication using</entry>
<entry>access to GBA infrastructure.</entry>
</row>
<row>
<entry/>
<entry>(Username, Password) SRP TLS.</entry>
<entry>This is a new security method.</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
SUPL 3.0 Security Concept Overview II
</p>
<p id="p-0111" num="0427">The following two options are considered for SUPL 3.0 security</p>
<p id="p-0112" num="0428">
<tables id="TABLE-US-00005" num="00005">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="91pt" align="left"/>
<colspec colname="2" colwidth="98pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Option I</entry>
<entry>Option II</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>ACA (A)</entry>
<entry>ACA (A)</entry>
</row>
<row>
<entry/>
<entry>GBA (B)</entry>
<entry>GBA (B)</entry>
</row>
<row>
<entry/>
<entry>User Mode ULP (C)</entry>
<entry>User Mode TLS (D)</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0113" num="0429">The following discussion presents both options and discuss advantages and potential disadvantages of each approach</p>
<p id="h-0008" num="0000">User Mode Offline Procedures</p>
<p id="p-0114" num="0000">
<ul id="ul0077" list-style="none">
    <li id="ul0077-0001" num="0000">
    <ul id="ul0078" list-style="none">
        <li id="ul0078-0001" num="0430">User Mode (Offline)</li>
        <li id="ul0078-0002" num="0431">User and SLP operator agree on (Username, Password)
        <ul id="ul0079" list-style="none">
            <li id="ul0079-0001" num="0432">Other assumptions</li>
        </ul>
        </li>
        <li id="ul0078-0003" num="0433">SET has URL of SLP</li>
        <li id="ul0078-0004" num="0434">SET has appropriate root certificates for authenticating SLP
<br/>
User Mode ULP: Concept Overview I
</li>
        <li id="ul0078-0005" num="0435">User Mode ULP: Based on (Username, Password)</li>
        <li id="ul0078-0006" num="0436">First perform TLS handshake with server certificates to establish a secure connection</li>
        <li id="ul0078-0007" num="0437">(Username, Counter, Digest) added to all ULP messages sent by the SET, with Digest computed as
        <ul id="ul0080" list-style="none">
            <li id="ul0080-0001" num="0438">ULP_Message_Z is the ULP_Message with Digest field set to zeroes</li>
            <li id="ul0080-0002" num="0439">User_ULP_IK=SHA-256(Username&#x2225;&#x201c;:&#x201d;&#x2225;Password&#x2225;&#x201c;:&#x201d;&#x2225;SLP_Domain&#x2225;&#x201c;:SUPL30ULP&#x201d;)</li>
            <li id="ul0080-0003" num="0440">Digest=HMAC-SHA-256-32(User_ULP_IK, ULP_Message_Z)</li>
        </ul>
        </li>
        <li id="ul0078-0008" num="0441">SET adds (Username, Counter, Digest) to all messages, SLP verifies
<br/>
User Mode ULP: Concept Overview II
</li>
        <li id="ul0078-0009" num="0442">TLS with server certificates used for server authentication and encryption</li>
        <li id="ul0078-0010" num="0443">New parameters are added to ULP messages from the SET: (Username, Counter, Digest)</li>
        <li id="ul0078-0011" num="0444">SLP verifies Counter and Digest before processing ULP message content</li>
        <li id="ul0078-0012" num="0445">Purpose of the Counter is to enable replay detection</li>
        <li id="ul0078-0013" num="0446">Counter is reset in receiver and sender for every ULP Session</li>
        <li id="ul0078-0014" num="0447">At sender, the Counter is incremented every message and added to the ULP message</li>
        <li id="ul0078-0015" num="0448">At receiver, Counter is compared against the value expected. If replay detected, exit with error. Otherwise, message passes replay protection.
<br/>
User Mode TLS: Concept Overview
</li>
        <li id="ul0078-0016" num="0449">User Mode TLS: Based on (Username, Password)</li>
        <li id="ul0078-0017" num="0450">First perform TLS handshake with server certificates to establish a secure connection</li>
        <li id="ul0078-0018" num="0451">SLP sends &#x201c;Hello Request&#x201d; to initiate TLS renegotiation. Then SET &#x26; SLP perform TLS-SRP handshake (SRP=Secure Remote Password) to authenticate user using (Username, Password).</li>
        <li id="ul0078-0019" num="0452">The first secure connection is required to hide the username in TLS-SRP handshake.
<br/>
Option I: Online Procedures Overview
</li>
        <li id="ul0078-0020" num="0453">SET initiates TLS Handshake, indicating in the TLS support for GBA and/or User Mode by selecting the appropriate cipher suites.</li>
        <li id="ul0078-0021" num="0454">SLP decides whether to proceed with GBA mode or User Mode</li>
        <li id="ul0078-0022" num="0455">If GBA mode, then
        <ul id="ul0081" list-style="none">
            <li id="ul0081-0001" num="0456">Continue TLS handshake as for TLS-PSK using GBA to establish secure tunnel
            <ul id="ul0082" list-style="none">
                <li id="ul0082-0001" num="0457">Provides mutual authentication</li>
            </ul>
            </li>
            <li id="ul0081-0002" num="0458">Exchange data in secure channel</li>
        </ul>
        </li>
        <li id="ul0078-0023" num="0459">If User mode, then
        <ul id="ul0083" list-style="none">
            <li id="ul0083-0001" num="0460">Continue TLS handshake with server certificates to establish secure channel
            <ul id="ul0084" list-style="none">
                <li id="ul0084-0001" num="0461">SET Authenticates the SLP</li>
            </ul>
            </li>
            <li id="ul0083-0002" num="0462">Exchange data in secure channel
            <ul id="ul0085" list-style="none">
                <li id="ul0085-0001" num="0463">New parameters are added to ULP messages from the SET (Username, Counter, Digest) which allow the SLP to authenticate the User
<br/>
Option I: Online Procedure Details&#x2014;TLS Handshake
</li>
            </ul>
            </li>
        </ul>
        </li>
        <li id="ul0078-0024" num="0464">SET&#x2192;SLP: Client Hello:
        <ul id="ul0086" list-style="none">
            <li id="ul0086-0001" num="0465">Indicates all supported cipher suites
            <ul id="ul0087" list-style="none">
                <li id="ul0087-0001" num="0466">If SET supports GBA, then indicate support for TLS-PSK cipher suite(s)</li>
                <li id="ul0087-0002" num="0467">If SET supports User Mode, then indicate support for TLS with server certificates</li>
            </ul>
            </li>
        </ul>
        </li>
        <li id="ul0078-0025" num="0468">SLP&#x2192;SET: Server Hello:
        <ul id="ul0088" list-style="none">
            <li id="ul0088-0001" num="0469">Indicates chosen cipher suite
            <ul id="ul0089" list-style="none">
                <li id="ul0089-0001" num="0470">If SLP selects GBA mode, then SLP indicates a TLS-PSK cipher suite</li>
                <li id="ul0089-0002" num="0471">If SLP selects User Mode, the SLP indicates cipher suite for TLS with server certificates</li>
            </ul>
            </li>
            <li id="ul0088-0002" num="0472">Call flow proceeds as for selected cipher suite
<br/>
Option I: Online Procedure Details&#x2014;After TLS Handshake
</li>
        </ul>
        </li>
        <li id="ul0078-0026" num="0473">GBA Mode
        <ul id="ul0090" list-style="none">
            <li id="ul0090-0001" num="0474">SET and SLP start communicating over secure channel</li>
        </ul>
        </li>
        <li id="ul0078-0027" num="0475">User Mode
        <ul id="ul0091" list-style="none">
            <li id="ul0091-0001" num="0476">SET and SLP start communicating over secure channel</li>
            <li id="ul0091-0002" num="0477">New parameters are added to ULP messages from the SET: (Username, Counter, Digest)
            <ul id="ul0092" list-style="none">
                <li id="ul0092-0001" num="0478">SLP verifies Counter and Digest before processing ULP message content</li>
                <li id="ul0092-0002" num="0479">Purpose of the Counter is to enable replay detection
                <ul id="ul0093" list-style="none">
                    <li id="ul0093-0001" num="0480">Counter is reset in receiver and sender for every ULP Session</li>
                    <li id="ul0093-0002" num="0481">At sender, the Counter is incremented every message and added to the ULP message</li>
                    <li id="ul0093-0003" num="0482">At receiver, Counter is compared against the value expected. If replay detected, exit with error. Otherwise, message passes replay protection.
<br/>
Option II: Online Procedures Overview
</li>
                </ul>
                </li>
            </ul>
            </li>
        </ul>
        </li>
        <li id="ul0078-0028" num="0483">SET initiates TLS Handshake, indicating in the TLS support for GBA and/or User Mode by selecting the appropriate cipher suites.</li>
        <li id="ul0078-0029" num="0484">SLP decides whether to proceed with GBA mode or User Mode
        <ul id="ul0094" list-style="none">
            <li id="ul0094-0001" num="0485">If GBA mode, then
            <ul id="ul0095" list-style="none">
                <li id="ul0095-0001" num="0486">1. Continue TLS handshake as for TLS-PSK using GBA to establish secure tunnel
                <ul id="ul0096" list-style="none">
                    <li id="ul0096-0001" num="0487">Mutual authentication</li>
                </ul>
                </li>
                <li id="ul0095-0002" num="0488">2. Exchange data in secure channel</li>
            </ul>
            </li>
            <li id="ul0094-0002" num="0489">If User mode, then
            <ul id="ul0097" list-style="none">
                <li id="ul0097-0001" num="0490">1. First continue TLS handshake with server certificates to establish secure channel
                <ul id="ul0098" list-style="none">
                    <li id="ul0098-0001" num="0491">SET Authenticates the SLP</li>
                </ul>
                </li>
                <li id="ul0097-0002" num="0492">2. Performs TLS-SRP handshake (messages exchanged inside the secure channel)
                <ul id="ul0099" list-style="none">
                    <li id="ul0099-0001" num="0493">SLP Authenticates the user</li>
                    <li id="ul0099-0002" num="0494">Results in new session keys</li>
                </ul>
                </li>
                <li id="ul0097-0003" num="0495">3. Exchange data in secure tunnel protected by new session keys
<br/>
Option II: Online Procedure Details&#x2014;First TLS Handshake
</li>
            </ul>
            </li>
        </ul>
        </li>
        <li id="ul0078-0030" num="0496">SET&#x2192;SLP: Client Hello:
        <ul id="ul0100" list-style="none">
            <li id="ul0100-0001" num="0497">Indicates all supported cipher suites
            <ul id="ul0101" list-style="none">
                <li id="ul0101-0001" num="0498">If SET supports GBA, then indicate support for TLS-PSK cipher suite(s)</li>
                <li id="ul0101-0002" num="0499">If SET supports User Mode, then indicate support for TLS with server certificates and TLS SRP</li>
            </ul>
            </li>
            <li id="ul0100-0002" num="0500">SET does not provide username at this time, if required will be provided in the next TLS handshake</li>
        </ul>
        </li>
        <li id="ul0078-0031" num="0501">SLP&#x2192;SET: Server Hello:
        <ul id="ul0102" list-style="none">
            <li id="ul0102-0001" num="0502">Indicates chosen cipher suite
            <ul id="ul0103" list-style="none">
                <li id="ul0103-0001" num="0503">If SLP selects GBA mode, then SLP indicates a TLS-PSK cipher suite</li>
                <li id="ul0103-0002" num="0504">If SLP selects User Mode, the SLP indicates cipher suite for TLS with server certificates</li>
                <li id="ul0103-0003" num="0505">Call flow proceeds as for selected cipher suite
<br/>
Option II: Online Procedure Details&#x2014;After First TLS Handshake
</li>
            </ul>
            </li>
        </ul>
        </li>
        <li id="ul0078-0032" num="0506">GBA Mode
        <ul id="ul0104" list-style="none">
            <li id="ul0104-0001" num="0507">SET and SLP start communicating over secured channel</li>
        </ul>
        </li>
        <li id="ul0078-0033" num="0508">User Mode
        <ul id="ul0105" list-style="none">
            <li id="ul0105-0001" num="0509">SLP&#x2192;SET: Hello Request
            <ul id="ul0106" list-style="none">
                <li id="ul0106-0001" num="0510">Initiates renegotiation</li>
            </ul>
            </li>
            <li id="ul0105-0002" num="0511">SET&#x2192;SLP: Client Hello
            <ul id="ul0107" list-style="none">
                <li id="ul0107-0001" num="0512">Indicates support for TLS-SRP</li>
                <li id="ul0107-0002" num="0513">Includes Username as per TLS-SRP specifications</li>
            </ul>
            </li>
            <li id="ul0105-0003" num="0514">SET&#x2192;SLP: ServerHello
            <ul id="ul0108" list-style="none">
                <li id="ul0108-0001" num="0515">Indicates selection of TLS-SRP</li>
            </ul>
            </li>
            <li id="ul0105-0004" num="0516">Exchange continues as per TLS-SRP</li>
            <li id="ul0105-0005" num="0517">Following successful handshake, SET &#x26; SLP begin exchanging data over secured channel.
<br/>
SUPL NIT Protection
</li>
        </ul>
        </li>
        <li id="ul0078-0034" num="0518">SUPL INIT protection in SUPL 3.0 is based on SUPL INIT protection mechanism in SUPL 2.0 and uses a Message Authentication Code (MAC) attached to SUPL INIT</li>
        <li id="ul0078-0035" num="0519">Two methods for authentication
        <ul id="ul0109" list-style="none">
            <li id="ul0109-0001" num="0520">GBA mode: (Key Identity, SUPL_INIT_ROOT_KEY)=(B-TID, Ks)
            <ul id="ul0110" list-style="none">
                <li id="ul0110-0001" num="0521">(B-TID, Ks) are bootstrapped off of BSF</li>
            </ul>
            </li>
            <li id="ul0109-0002" num="0522">User Mode: authentication uses (Username, Password)</li>
        </ul>
        </li>
        <li id="ul0078-0036" num="0523">SUPL INIT Protection is the same for Option I and Option II
<br/>
SUPL INIT Protection Mechanism
</li>
        <li id="ul0078-0037" num="0524">Three types of Protection offered in SUPL v3.0:</li>
        <li id="ul0078-0038" num="0525">NULL
        <ul id="ul0111" list-style="none">
            <li id="ul0111-0001" num="0526">No security</li>
        </ul>
        </li>
        <li id="ul0078-0039" num="0527">GBA Mode Protection
        <ul id="ul0112" list-style="none">
            <li id="ul0112-0001" num="0528">Identical to SUPL v2.0 Basic Protection</li>
        </ul>
        </li>
        <li id="ul0078-0040" num="0529">User Mode Protection
        <ul id="ul0113" list-style="none">
            <li id="ul0113-0001" num="0530">Authentication based on (Username,Password)</li>
            <li id="ul0113-0002" num="0531">Adds random value to prevent dictionary attacks</li>
            <li id="ul0113-0003" num="0532">Adds time to prevent replay
<br/>
SUPL INIT GBA Mode Protection
</li>
        </ul>
        </li>
        <li id="ul0078-0041" num="0533">If using GBA authentication, then the SUPL INIT Protector parameter consists of:</li>
        <li id="ul0078-0042" num="0534">Key Identifier=GBA B-TID (length=variable).</li>
        <li id="ul0078-0043" num="0535">GBA_ReplayCounter (length=2 octets). Prevents replay</li>
        <li id="ul0078-0044" num="0536">SUPL_INIT_GBA_MAC (length=4 octets). Authenticates the message.
        <ul id="ul0114" list-style="none">
            <li id="ul0114-0001" num="0537">The SUPL_INIT_GBA_MAC parameter is generated as follows:</li>
        </ul>
        </li>
        <li id="ul0078-0045" num="0538">SUPL_INIT_GBA_MAC=HMAC-SHA256-32(SUPL_INIT_GBA_IK, SUPL_INIT_Z)</li>
        <li id="ul0078-0046" num="0539">SUPL_INIT_GBA_IK=HMAC-SHA256-128(SUPL_INIT_ROOT_KEY, &#x201c;GBA IK&#x201d;)
        <ul id="ul0115" list-style="none">
            <li id="ul0115-0001" num="0540">SUPL_INIT_ROOT_KEY is the GBA key Ks_(int/ext_)NAF corresponding to B-TID</li>
        </ul>
        </li>
        <li id="ul0078-0047" num="0541">SUPL_INIT_Z is the SUPL INIT message with the SUPL_INIT_GBA_MAC field set to all zeroes.
        <ul id="ul0116" list-style="none">
            <li id="ul0116-0001" num="0542">GBA_ReplayCounter is reset when Key Identifier is reset
<br/>
SUPL INIT User Mode Protection
</li>
        </ul>
        </li>
        <li id="ul0078-0048" num="0543">If using User Mode security, then the SUPL INIT Protector parameter consists of:</li>
        <li id="ul0078-0049" num="0544">SUPL_INIT_RAND (length=8 octets) This may be a random value unique for this message to prevent dictionary attacks on the password.</li>
        <li id="ul0078-0050" num="0545">SUPL_INIT_TIME (length=4 octets). Time of sending message. Stops replay.</li>
        <li id="ul0078-0051" num="0546">SUPL_INIT_USER_MAC (length=4 octets). Authenticates the message.
        <ul id="ul0117" list-style="none">
            <li id="ul0117-0001" num="0547">The SUPL_INIT_USER_MAC parameter is generated as follows:</li>
        </ul>
        </li>
        <li id="ul0078-0052" num="0548">SUPL_INIT_USER_MAC=HMAC-SHA256-32(SUPL_INIT_USER_IK, SUPL_INIT_Z)</li>
        <li id="ul0078-0053" num="0549">SUPL_INIT_USER_IK=SHA-256 (Username&#x2225;&#x201c;:&#x201d;&#x2225;Password &#x201c;:&#x201d;&#x2225;SLP_Domain&#x2225;&#x201c;:SUPL30INIT&#x201d;)</li>
        <li id="ul0078-0054" num="0550">SUPL_INIT_Z is the SUPL INIT message with the SUPL_INIT_USER_MAC field set to all zeroes.
<br/>
Comparison of User Modes
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0115" num="0551">
<tables id="TABLE-US-00006" num="00006">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="70pt" align="left"/>
<colspec colname="1" colwidth="56pt" align="left"/>
<colspec colname="2" colwidth="91pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Plus</entry>
<entry>Delta</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="56pt" align="left"/>
<colspec colname="2" colwidth="56pt" align="left"/>
<colspec colname="3" colwidth="91pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Option I: User</entry>
<entry>Requires no</entry>
<entry>Security distributed over</entry>
</row>
<row>
<entry/>
<entry>Mode ULP</entry>
<entry>change to</entry>
<entry>two layers: TLS and ULP</entry>
</row>
<row>
<entry/>
<entry/>
<entry>existing TLS</entry>
<entry>Security not transparent</entry>
</row>
<row>
<entry/>
<entry/>
<entry>implementation</entry>
<entry>to ULP layer</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>Potentially higher</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>implementation risk since</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>ULP implementation may</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>be performed by non</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>security experts.</entry>
</row>
<row>
<entry/>
<entry>Option II: User</entry>
<entry>Security</entry>
<entry>More complex TLS</entry>
</row>
<row>
<entry/>
<entry>Mode TLS</entry>
<entry>provided by</entry>
<entry>implementation</entry>
</row>
<row>
<entry/>
<entry/>
<entry>transport layer</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(single layer</entry>
</row>
<row>
<entry/>
<entry/>
<entry>security) and</entry>
</row>
<row>
<entry/>
<entry/>
<entry>thus</entry>
</row>
<row>
<entry/>
<entry/>
<entry>transparent to</entry>
</row>
<row>
<entry/>
<entry/>
<entry>ULP layer</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
Summary
<ul id="ul0118" list-style="none">
    <li id="ul0118-0001" num="0000">
    <ul id="ul0119" list-style="none">
        <li id="ul0119-0001" num="0552">Two new security models are considered in SUPL 3.0</li>
        <li id="ul0119-0002" num="0553">Option I: User Mode ULP</li>
        <li id="ul0119-0003" num="0554">Option II: User Mode TLS
        <ul id="ul0120" list-style="none">
            <li id="ul0120-0001" num="0555">The two new security models use (Username, Password) client authentication while server authentication and encryption are based on legacy server authenticated TLS.</li>
            <li id="ul0120-0002" num="0556">Both options are bearer agnostic security models and are thus suitable for SUPL 3.0.</li>
            <li id="ul0120-0003" num="0557">Legacy security models (ACA and GBA) may still be used where applicable and desirable.
<br/>
Additional Embodiment 5
<br/>
Introduction
</li>
        </ul>
        </li>
        <li id="ul0119-0004" num="0558">Security in OMA SUPL 2.0 is access network specific:
        <ul id="ul0121" list-style="none">
            <li id="ul0121-0001" num="0559">ACA (Alternative Client Authentication) requires access to the core network to identify SET based on Source IP Address</li>
            <li id="ul0121-0002" num="0560">GBA (Generic Bootstrapping Architecture) only applicable to 3GPP/3GPP2 networks</li>
            <li id="ul0121-0003" num="0561">SEK (SUPL Encryption Key) only applicable to WiMAX networks</li>
        </ul>
        </li>
        <li id="ul0119-0005" num="0562">A new requirement in OMA SUPL 3.0 calls for an authentication mechanism applicable to all access networks. This embodiment describes a new security mechanism applicable to all access networks:
        <ul id="ul0122" list-style="none">
            <li id="ul0122-0001" num="0563">Simple framework based on &#x201c;username/password&#x201d; authentication</li>
        </ul>
        </li>
        <li id="ul0119-0006" num="0564">Legacy ACA and GBA based security are also supported
<br/>
SUPL 3.0 Security Concept Overview I
<br/>
Security for SUPL 3.0 is Based on Three Security Methods:
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0116" num="0565">
<tables id="TABLE-US-00007" num="00007">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="119pt" align="left"/>
<colspec colname="3" colwidth="98pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry>Security</entry>
<entry/>
<entry/>
</row>
<row>
<entry>Method</entry>
<entry>Description</entry>
<entry>Comments</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>ACA</entry>
<entry>Alternative Client Authentication as</entry>
<entry>For SUPL deployments with</entry>
</row>
<row>
<entry/>
<entry>supported in SUPL 1.0 and 2.0. Server</entry>
<entry>medium security requirements</entry>
</row>
<row>
<entry/>
<entry>authentication and encryption using</entry>
<entry>and with access to IP address</entry>
</row>
<row>
<entry/>
<entry>server authenticated TLS. Client</entry>
<entry>client verification. This is a</entry>
</row>
<row>
<entry/>
<entry>authentication using IP</entry>
<entry>legacy security method.</entry>
</row>
<row>
<entry/>
<entry>address/MSISDN consistency checking</entry>
</row>
<row>
<entry/>
<entry>involving core network.</entry>
</row>
<row>
<entry>GBA</entry>
<entry>GBA based security as supported in</entry>
<entry>For SUPL deployments with</entry>
</row>
<row>
<entry/>
<entry>SUPL 2.0. Only applicable to</entry>
<entry>high security requirements and</entry>
</row>
<row>
<entry/>
<entry>3GPP/3GPP2 networks. Server and</entry>
<entry>with access to GBA</entry>
</row>
<row>
<entry/>
<entry>client authentication and encryption</entry>
<entry>infrastructure. This is a legacy</entry>
</row>
<row>
<entry/>
<entry>using PSK-TLS.</entry>
<entry>security method.</entry>
</row>
<row>
<entry>User Mode</entry>
<entry>Server authentication and encryption</entry>
<entry>For SUPL deployments with</entry>
</row>
<row>
<entry>TLS</entry>
<entry>using server authenticated TLS. Client</entry>
<entry>high security requirements and</entry>
</row>
<row>
<entry/>
<entry>authentication using (Username,</entry>
<entry>no access to GBA</entry>
</row>
<row>
<entry/>
<entry>Password) SRP TLS.</entry>
<entry>infrastructure. This is a new</entry>
</row>
<row>
<entry/>
<entry/>
<entry>security method.</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
SUPL 3.0 Security Concept Overview II
<ul id="ul0123" list-style="none">
    <li id="ul0123-0001" num="0000">
    <ul id="ul0124" list-style="none">
        <li id="ul0124-0001" num="0566">ACA and GBA are access network specific but may be used where applicable and depending on the SUPL operator's choice.</li>
        <li id="ul0124-0002" num="0567">User Mode TLS is access network independent and can be viewed as an enhancement of ACA.
<br/>
User Mode TLS&#x2014;Overview I
</li>
        <li id="ul0124-0003" num="0568">Public Key TLS Server Authentication&#x2014;H-SLP and SLP are connected secure; H-SLP is authenticated but SET is not.</li>
        <li id="ul0124-0004" num="0569">Username/Password TLS-SRP Client Authentication&#x2014;H-SLP and SLP are connected secure; both H-SLP and SET are authenticated.</li>
        <li id="ul0124-0005" num="0570">User Mode TLS
        <ul id="ul0125" list-style="none">
            <li id="ul0125-0001" num="0571">Server is first authenticated using public key TLS as in ACA producing a secure encrypted IP connection</li>
            <li id="ul0125-0002" num="0572">Client is next authenticated based on TLS-SRP (Secure Remote Password) using pre-provisioned Username/Password in both the SET and SLP
<br/>
User Mode TLS Overview II
</li>
        </ul>
        </li>
        <li id="ul0124-0006" num="0573">Simple Username/Password mechanism may pose problems and/or threats:
        <ul id="ul0126" list-style="none">
            <li id="ul0126-0001" num="0574">Username/Password may be stolen and used on different devices</li>
            <li id="ul0126-0002" num="0575">Username/Password may be voluntarily given away and used simultaneously on different devices</li>
        </ul>
        </li>
        <li id="ul0124-0007" num="0576">This can be solved by:
        <ul id="ul0127" list-style="none">
            <li id="ul0127-0001" num="0577">Use of Username/Password only for the first SUPL session immediately after SUPL service activation.</li>
            <li id="ul0127-0002" num="0578">During the first SUPL session, SLP creates new Username/Password and sends to the SET (using the secure IP connection created by the initial Username/Password).</li>
            <li id="ul0127-0003" num="0579">SET then replaces initial Username/Password with new Username/Password and deletes old Username/Password.</li>
        </ul>
        </li>
        <li id="ul0124-0008" num="0580">Device is then bound to SUPL subscription by user-invisible Username/Password created by the SLP.</li>
        <li id="ul0124-0009" num="0581">All future TLS sessions then use the new Username/Password created by the SLP.
        <ul id="ul0128" list-style="none">
            <li id="ul0128-0001" num="0582">Other devices can then not use the Username/Password
<br/>
User Mode TLS in 4 Steps
</li>
        </ul>
        </li>
        <li id="ul0124-0010" num="0583">Step 1: User and SLP operator agree on temporary username &#x26; password: (Username_temp, Password_temp).</li>
        <li id="ul0124-0011" num="0584">Step 2: The first SUPL session is established. Server authentication and ciphering are performed based on server authenticated TLS. Client authentication is performed based on TLS-SRP (SRP=Secure Remote Password) using the agreed (Username_temp, Password_temp).</li>
        <li id="ul0124-0012" num="0585">Step 3: Within the first SUPL session, the SLP generates new and cryptographically strong (Username, Password) which it sends to the SET. SET replaces (Username_temp, Password_temp) with (Username, Password). SET stores (Username, Password) in secure location.</li>
        <li id="ul0124-0013" num="0586">Step 4: all subsequent TLS sessions use server authentication and ciphering based on server authenticated TLS. Client authentication is performed based on TLS-SRP using (Username, Password).
<br/>
User Mode TLS Step 1&#x2014;Details
</li>
        <li id="ul0124-0014" num="0587">User and SLP operator agree on temporary username and password: (Username_temp, Password_temp)</li>
        <li id="ul0124-0015" num="0588">(Username_temp, Password_temp) may be provisioned in the SET in various ways:</li>
        <li id="ul0124-0016" num="0589">Over The Air provisioning by the operator</li>
        <li id="ul0124-0017" num="0590">Provisioning at an operator's store (flashing of the SET)</li>
        <li id="ul0124-0018" num="0591">Username and password sent by mail or obtained online and entered by SET user</li>
        <li id="ul0124-0019" num="0592">other</li>
        <li id="ul0124-0020" num="0593">SET has been provisioned with the URL of the SLP</li>
        <li id="ul0124-0021" num="0594">SET has been provisioned with the appropriate root certificates required for authenticating the SLP
<br/>
User Mode TLS Step 2&#x2014;Details
</li>
        <li id="ul0124-0022" num="0595">First TLS handshake of the first SUPL session to initiate server authentication and encryption:</li>
        <li id="ul0124-0023" num="0596">SET&#x2192;SLP: Client Hello indicating support for TLS with server certificates and TLS-SRP</li>
        <li id="ul0124-0024" num="0597">SLP&#x2192;SET: Server Hello indicating cipher suite for TLS with server certificates
        <ul id="ul0129" list-style="none">
            <li id="ul0129-0001" num="0598">Second TLS handshake to initiate client authentication</li>
        </ul>
        </li>
        <li id="ul0124-0025" num="0599">SLP&#x2192;SET: Hello Request to initiate renegotiation</li>
        <li id="ul0124-0026" num="0600">SET&#x2192;SLP: Client Hello indicating support for TLS-SRP and including Username_temp as per TLS-SRP specifications</li>
        <li id="ul0124-0027" num="0601">SLP&#x2192;SET: Server Hello indicating selection of TLS-SRP</li>
        <li id="ul0124-0028" num="0602">Client authentication is performed based on (Username_temp, Password_temp)</li>
        <li id="ul0124-0029" num="0603">New session keys are produced (for this session only)
        <ul id="ul0130" list-style="none">
            <li id="ul0130-0001" num="0604">SET and SLP can now conduct SUPL session over secured channel
<br/>
User Mode TLS Step 3&#x2014;Details
</li>
        </ul>
        </li>
        <li id="ul0124-0030" num="0605">SLP creates cryptographically strong (Username, Password) based on temporary username and password (Username_temp, Password_temp).</li>
        <li id="ul0124-0031" num="0606">First SUPL message from SLP to SET carries cryptographically strong (Username, Password).</li>
        <li id="ul0124-0032" num="0607">SET replaces temporary (Username_temp, Password_temp) with (Username, Password).</li>
        <li id="ul0124-0033" num="0608">SET discards temporary (Username_temp, Password_temp).</li>
        <li id="ul0124-0034" num="0609">SET stores (Username, Password) in secure location.</li>
        <li id="ul0124-0035" num="0610">NOTE 1: this step may not be performed if the SLP operator was able to provision the Username/Password securely in the SET without involving the user
        <ul id="ul0131" list-style="none">
            <li id="ul0131-0001" num="0611">NOTE 2: for 3GPP/3GPP2 initial access, the SLP can verify in the core network that the SET IP address is associated with the SET MSISDN or IMSI to further verify the SET belongs to the user
<br/>
User Mode TLS Step 4&#x2014;Details
</li>
        </ul>
        </li>
        <li id="ul0124-0036" num="0612">For subsequent TLS session establishment:
        <ul id="ul0132" list-style="none">
            <li id="ul0132-0001" num="0613">TLS handshake to initiate server authentication and encryption:
            <ul id="ul0133" list-style="none">
                <li id="ul0133-0001" num="0614">SET&#x2192;SLP: Client Hello indicating support for TLS with server certificates and TLS-SRP</li>
                <li id="ul0133-0002" num="0615">SLP&#x2192;SET: Server Hello indicating cipher suite for TLS with server certificates</li>
            </ul>
            </li>
            <li id="ul0132-0002" num="0616">Second TLS handshake to initiate client authentication:
            <ul id="ul0134" list-style="none">
                <li id="ul0134-0001" num="0617">SLP&#x2192;SET: Hello Request to initiate renegotiation</li>
                <li id="ul0134-0002" num="0618">SET&#x2192;SLP: Client Hello indicating support for TLS-SRP and including Username as per TLS-SRP specifications</li>
                <li id="ul0134-0003" num="0619">SLP&#x2192;SET: Server Hello indicating selection of TLS-SRP</li>
                <li id="ul0134-0004" num="0620">Client authentication is performed based on (Username, Password)</li>
                <li id="ul0134-0005" num="0621">New session keys are produced</li>
            </ul>
            </li>
            <li id="ul0132-0003" num="0622">SET and SLP can now conduct SUPL session over secured channel
            <ul id="ul0135" list-style="none">
                <li id="ul0135-0001" num="0623">NOTE: although PSK-TLS could be used for subsequent access once a cryptographically secure Username/Password is provided, reuse of TLS-SRP may be implemented with reduced complexity
<br/>
SUPL INIT Protection Overview
</li>
            </ul>
            </li>
        </ul>
        </li>
        <li id="ul0124-0037" num="0624">SUPL INIT protection in SUPL 3.0 is based on SUPL INIT protection mechanism in SUPL 2.0 and uses a Message Authentication Code (MAC) attached to SUPL INIT</li>
        <li id="ul0124-0038" num="0625">Two types of Protection offered in SUPL v3.0:</li>
        <li id="ul0124-0039" num="0626">GBA Mode Protection
        <ul id="ul0136" list-style="none">
            <li id="ul0136-0001" num="0627">Identical to SUPL v2.0 Basic Protection</li>
        </ul>
        </li>
        <li id="ul0124-0040" num="0628">User Mode Protection
        <ul id="ul0137" list-style="none">
            <li id="ul0137-0001" num="0629">Authentication based on (Username, Password) created by the SLP (i.e., not using initial Username/Password (Username_temp, Password_temp) used for service activation).</li>
        </ul>
        </li>
        <li id="ul0124-0041" num="0630">NULL Protection is also supported and may be used based on operator's choice.
<br/>
SUPL INIT User Mode Protection I
</li>
        <li id="ul0124-0042" num="0631">If using User Mode TLS security, then the SUPL INIT Protector parameter consists of:</li>
        <li id="ul0124-0043" num="0632">SUPL_INIT_TIME (length=4 octets). Time of sending message. Stops replay.</li>
        <li id="ul0124-0044" num="0633">SUPL_INIT_USER_MAC (length=4 octets). Authenticates the message.
        <ul id="ul0138" list-style="none">
            <li id="ul0138-0001" num="0634">The SUPL INIT Protector is added to each SUPL INIT message and allows the SET to check the authenticity of the received SUPL INIT message.</li>
            <li id="ul0138-0002" num="0635">For exception cases (e.g. SET and SLP out of synch) where an operator uses SUPL INIT protection, null SUPL INIT protection may be used temporarily to reprovision the SET as long as this is explicitly indicated to the SET (e.g. via a reset command) so that a Denial of Service attack cannot take advantage of this by sending unprotected SUPL INITs to a large number of SETs
<br/>
SUPL INIT User Mode Protection II
</li>
        </ul>
        </li>
        <li id="ul0124-0045" num="0636">The SUPL_INIT_USER_MAC parameter is generated as follows:</li>
        <li id="ul0124-0046" num="0637">SUPL_INIT_USER_MAC=HMAC-SHA256-32(SUPL_INIT_USER_IK, SUPL_INIT_Z)</li>
        <li id="ul0124-0047" num="0638">SUPL_INIT_USER_IK=SHA-256 (Username&#x2225;&#x201c;:&#x201d;&#x2225;Password &#x201c;:&#x201d;&#x2225;SLP_Domain&#x2225;&#x201c;:SUPL30INIT&#x201d;)</li>
        <li id="ul0124-0048" num="0639">SUPL_INIT_Z is the SUPL INIT message with the SUPL_INIT_USER_MAC field set to all zeroes.
<br/>
Summary
</li>
        <li id="ul0124-0049" num="0640">A new security model is described for SUPL 3.0: User Mode TLS.</li>
        <li id="ul0124-0050" num="0641">User Mode TLS uses (Username, Password) client authentication while server authentication and encryption are based on legacy server authenticated TLS.</li>
        <li id="ul0124-0051" num="0642">SUPL INIT protection supported also in User Mode TLS.</li>
        <li id="ul0124-0052" num="0643">User Mode TLS is a bearer agnostic security model and is thus suitable for SUPL 3.0.</li>
        <li id="ul0124-0053" num="0644">Legacy security models (ACA and GBA) may still be used depending on SUPL operator's choice.
<br/>
Recommendation
</li>
        <li id="ul0124-0054" num="0645">User Mode TLS may be adopted as security model for SUPL 3.0.</li>
        <li id="ul0124-0055" num="0646">Support may be maintained for legacy ACA and GBA security models.</li>
    </ul>
    </li>
</ul>
</p>
<heading id="h-0009" level="1">SUPL 3.0 Access SLP (A-SLP)</heading>
<p id="p-0117" num="0000">
<ul id="ul0139" list-style="none">
    <li id="ul0139-0001" num="0000">
    <ul id="ul0140" list-style="none">
        <li id="ul0140-0001" num="0647">For a roaming subscriber, support of precise positioning can be difficult for an H-SLP provider but much easier for a location provider in the local roaming area</li>
        <li id="ul0140-0002" num="0648">Operators may in some cases have business relationships with other operators and providers that could make temporary use of an H-SLP belonging to operator A beneficial to a subscriber of operator B</li>
        <li id="ul0140-0003" num="0649">SUPL 3.0 RD includes requirements oriented to more widespread availability of and easier access to SLPs:
        <ul id="ul0141" list-style="none">
            <li id="ul0141-0001" num="0650">SUPL-EMER-03: SUPL SHALL support SET Initiated and Network Initiated positioning for emergency location requests</li>
            <li id="ul0141-0002" num="0651">SUPL-HLF-18: SUPL SHALL support SLP service discovery</li>
        </ul>
        </li>
        <li id="ul0140-0004" num="0652">Some subscribers may not have an H-SLP&#x2014;e.g. home operator does not support SUPL&#x2014;or may have opted out of H-SLP SUPL support</li>
        <li id="ul0140-0005" num="0653">Some operators may wish to extend SUPL support to roaming subscribers&#x2014;e.g. those without an H-SLP or whose H-SLP cannot adequately support location in a particular roaming area
<br/>
Access SLP (A-SLP)
</li>
        <li id="ul0140-0006" num="0654">An A-SLP can belong to an access network provider, be associated with an access network or support the geographic area of an access network</li>
        <li id="ul0140-0007" num="0655">An A-SLP can support SUPL 3.0 in a manner almost identical to an H-SLP&#x2014;e.g. including all network and SET initiated services</li>
        <li id="ul0140-0008" num="0656">A SET will need to discover or be provided with information about an A-SLP (e.g. A-SLP address and security parameters)</li>
        <li id="ul0140-0009" num="0657">Possible information sources are the access network, H-SLP as well as independent (non-standardized) discovery
        <ul id="ul0142" list-style="none">
            <li id="ul0142-0001" num="0658">A-SLP security should reuse methods defined for an H-SLP&#x2014;e.g. avoid a different authentication method</li>
            <li id="ul0142-0002" num="0659">A SET and A-SLP can interact for a limited pre-agreed time period to support SUPL 3.0 services for both external SUPL Agents and the SET
<br/>
Possible A-SLP Usage
</li>
        </ul>
        </li>
        <li id="ul0140-0010" num="0660">SET communicates with SLP using ULP 3.0 messages via Access Network and communicates with H-SLP using ULP 3.0 messages via Home Network (optionally used to discover and verify A-SLP).</li>
        <li id="ul0140-0011" num="0661">A-SLP communicates with a SUPL Agent via MLP.
<br/>
Example User Cases
</li>
        <li id="ul0140-0012" num="0662">Example 1&#x2014;User visiting a new city, town, tourist site etc.</li>
        <li id="ul0140-0013" num="0663">H-SLP may only be able to support absolute location and not always accurately (e.g. if inside a building) and may not be able to provide ancillary information such as points of interest, maps, weather/traffic information etc.</li>
        <li id="ul0140-0014" num="0664">An A-SLP could provide more continuous precise location support together with application level services (not part of SUPL) such as direction finding, points of interest, maps, weather/traffic etc.
        <ul id="ul0143" list-style="none">
            <li id="ul0143-0001" num="0665">Example 2&#x2014;Emergency Call Support</li>
        </ul>
        </li>
        <li id="ul0140-0015" num="0666">If an A-SLP also supports E-SLP capability, the discovery of an A-SLP by a SET may assist a later IP based emergency call</li>
        <li id="ul0140-0016" num="0667">The SET then has the option of obtaining its approximate location from the A-SLP and including it in the emergency SIP INVITE thereby assisting call routing
        <ul id="ul0144" list-style="none">
            <li id="ul0144-0001" num="0668">The prior association between the SET and the A-SLP/E-SLP may also assist with later more accurate location for PSAP dispatch
<br/>
A-SLP Security-1
</li>
        </ul>
        </li>
        <li id="ul0140-0017" num="0669">Allow same security procedures as for an H-SLP</li>
        <li id="ul0140-0018" num="0670">A suitable security method is User Mode TLS as described in OMA-LOC-2010-0xyz-INP_SUPL<sub>&#x2014;</sub>3.0_Security&#x2014;e.g. this does not require support of GBA, 3GPP/3GPP2 only access, ability to directly configure the SET</li>
        <li id="ul0140-0019" num="0671">The A-SLP operator or H-SLP operator (where there is a business relationship between both operators) can assign the initial Username/Password</li>
        <li id="ul0140-0020" num="0672">The A-SLP can then replace the initial Username/Password with new values on the first SUPL session to avoid use of the Username/Password by other devices</li>
        <li id="ul0140-0021" num="0673">Although the A-SLP operator may not always be able to verify that the SET provisioned with the Username/Password belongs to the intended user, this may not matter for A-SLP services primarily focused on SET initiated service and charged at the same rate for all roaming users
        <ul id="ul0145" list-style="none">
            <li id="ul0145-0001" num="0674">NOTE: in most cases, the user may report loss of access to the A-SLP to the A-SLP provider (e.g. if the initial Username/Password is obtained and used by another user), allowing the current Username/Password to be deactivated and replaced by a new Username/Password
<br/>
A-SLP Security-2
</li>
        </ul>
        </li>
        <li id="ul0140-0022" num="0675">As an option, the H-SLP may be used to discover, verify and help support security for an A-SLP</li>
        <li id="ul0140-0023" num="0676">A SET could send a ULP request to the H-SLP with one of these parameters
        <ul id="ul0146" list-style="none">
            <li id="ul0146-0001" num="0677">(A) Current SET location or serving access network identity</li>
            <li id="ul0146-0002" num="0678">(B) An already discovered A-SLP address (e.g. found online or provided by the access network)</li>
        </ul>
        </li>
        <li id="ul0140-0024" num="0679">For (A), the H-SLP can return the address of a trusted A-SLP serving the local area</li>
        <li id="ul0140-0025" num="0680">For (B), the H-SLP can indicate if the A-SLP is trusted, not trusted or is unknown to the H-SLP
        <ul id="ul0147" list-style="none">
            <li id="ul0147-0001" num="0681">For (A) and for (B) in the trusted case, the H-SLP can optionally provide an initial Username/Password to the SET assigned either by the A-SLP or H-SLP (for which some additional interaction between either the A-SLP and H-SLP or the associated providers will then be required to transfer the Username/Password and user identification)
<br/>
SUPL 3.0 AD and TS Impacts
</li>
        </ul>
        </li>
        <li id="ul0140-0026" num="0682">Define an A-SLP (along with the existing H-SLP, V-SLP, E-SLP)</li>
        <li id="ul0140-0027" num="0683">Define or reference suitable discovery mechanisms</li>
        <li id="ul0140-0028" num="0684">Indicate use of User mode TLS security</li>
        <li id="ul0140-0029" num="0685">Add any suitable H-SLP support for A-SLP discovery, verification and security</li>
        <li id="ul0140-0030" num="0686">Allow a SET and A-SLP to restrict supported services to a subset of those used for H-SLP interaction (as already supported in existing SUPL 3.0 message flows where each end informs the other of the services it will support for a new session)</li>
        <li id="ul0140-0031" num="0687">Identify and support any new privacy requirements (if any)
<br/>
Relationship to H-SLP Services
</li>
        <li id="ul0140-0032" num="0688">An H-SLP provider may choose to support certain A-SLP providers with whom there is some business relationship</li>
        <li id="ul0140-0033" num="0689">An H-SLP provider may also offer support as an A-SLP provider to roaming subscribers from other operators</li>
        <li id="ul0140-0034" num="0690">SETs could be configured to control A-SLP access as follows:
        <ul id="ul0148" list-style="none">
            <li id="ul0148-0001" num="0691">a) Always use H-SLP and prohibit A-SLP use</li>
            <li id="ul0148-0002" num="0692">b) Prefer H-SLP but allow A-SLP use subject to H-SLP approval (e.g. allow A-SLP access only when there is a roaming agreement with the H-SLP provider)</li>
            <li id="ul0148-0003" num="0693">c) Allow the SET to freely decide H-SLP vs A-SLP use based on its own criteria, or</li>
            <li id="ul0148-0004" num="0694">d) Always use A-SLP (e.g. applicable when there is no H-SLP)</li>
        </ul>
        </li>
        <li id="ul0140-0035" num="0695">The net result may be to increase SUPL 3.0 usage and associated deployment which would benefit providers and users</li>
        <li id="ul0140-0036" num="0696">A-SLP support may be included as part of SUPL 3.0</li>
        <li id="ul0140-0037" num="0697">Reuse H-SLP security support and allow H-SLP to assist or control A-SLP access</li>
        <li id="ul0140-0038" num="0698">Allow for some level of non-SUPL support (e.g. regarding A-SLP discovery and interaction between A-SLP and H-SLP providers)
<br/>
Additional Embodiment 6
<br/>
Introduction
</li>
        <li id="ul0140-0039" num="0699">This embodiment uses device certificates for client authentication.
        <ul id="ul0149" list-style="none">
            <li id="ul0149-0001" num="0700">SUPL 3.0 Security Concept Overview I</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0118" num="0701">
<tables id="TABLE-US-00008" num="00008">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="84pt" align="left"/>
<colspec colname="3" colwidth="84pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>ACA</entry>
<entry>Alternative Client</entry>
<entry>For SUPL deployments</entry>
</row>
<row>
<entry/>
<entry>Authentication as supported</entry>
<entry>with medium security</entry>
</row>
<row>
<entry/>
<entry>in SUPL 1.0 and 2.0. Data</entry>
<entry>requirements and with</entry>
</row>
<row>
<entry/>
<entry>secured using TLS with</entry>
<entry>access to IP Address client</entry>
</row>
<row>
<entry/>
<entry>Server authentication based</entry>
<entry>verification. This is a</entry>
</row>
<row>
<entry/>
<entry>on server certificates.</entry>
<entry>legacy security method.</entry>
</row>
<row>
<entry/>
<entry>Client authentication using</entry>
</row>
<row>
<entry/>
<entry>IP Address/MSISDN</entry>
</row>
<row>
<entry/>
<entry>consistency checking</entry>
</row>
<row>
<entry/>
<entry>involving core network.</entry>
</row>
<row>
<entry>GBA</entry>
<entry>GBA based security as</entry>
<entry>For SUPL deployments</entry>
</row>
<row>
<entry/>
<entry>supported in SUPL 2.0.</entry>
<entry>with high security</entry>
</row>
<row>
<entry/>
<entry>Only applicable to</entry>
<entry>requirements and with</entry>
</row>
<row>
<entry/>
<entry>3GPP/3GPP2 networks.</entry>
<entry>access to GBA</entry>
</row>
<row>
<entry/>
<entry>Data secured using TLS-</entry>
<entry>infrastructure. This is a</entry>
</row>
<row>
<entry/>
<entry>PSK with mutual</entry>
<entry>legacy security method.</entry>
</row>
<row>
<entry/>
<entry>authentication based on a</entry>
</row>
<row>
<entry/>
<entry>shared key established</entry>
</row>
<row>
<entry/>
<entry>using GBA.</entry>
</row>
<row>
<entry>Device</entry>
<entry>Data secured using TLS</entry>
<entry>For SUPL deployments</entry>
</row>
<row>
<entry>Certificates</entry>
<entry>with mutual authentication</entry>
<entry>with high security</entry>
</row>
<row>
<entry/>
<entry>using server certificates for</entry>
<entry>requirements and no access</entry>
</row>
<row>
<entry/>
<entry>server authentication and</entry>
<entry>to GBA infrastructure. This</entry>
</row>
<row>
<entry/>
<entry>manufacturer-provisioned</entry>
<entry>is a new security method</entry>
</row>
<row>
<entry/>
<entry>device certificates for client</entry>
<entry>for SUPL v3.0.</entry>
</row>
<row>
<entry/>
<entry>authentication.</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
SUPL 3.0 Security Concept Overview II
<ul id="ul0150" list-style="none">
    <li id="ul0150-0001" num="0000">
    <ul id="ul0151" list-style="none">
        <li id="ul0151-0001" num="0702">ACA and GBA are access network specific but may be used where applicable and depending on the SUPL operator's choice.</li>
        <li id="ul0151-0002" num="0703">The new security model of this embodiment is client authentication using device certificates. Device certificate based client authentication is access network independent and can thus be used for all types of access networks and devices (i.e. non 3GPP/3GPP2 access networks and devices are supported).
<br/>
Device Pre-Provisioning
</li>
        <li id="ul0151-0003" num="0704">During manufacture, the Manufacturer provisions into the SET
        <ul id="ul0152" list-style="none">
            <li id="ul0152-0001" num="0705">A private key which is unique to that SET device</li>
            <li id="ul0152-0002" num="0706">A certificate that binds the corresponding public key to one or more globally-unique SET device identities (e.g. serial number, IMEI or MSID).</li>
        </ul>
        </li>
        <li id="ul0151-0004" num="0707">One or more chain of certificates back to well-known Certificate Authorities that would be trusted by the potential SLPs</li>
        <li id="ul0151-0005" num="0708">Note: If there is no chain back to a CA trusted by the SLP, then the SLP will not trust the SET authentication</li>
        <li id="ul0151-0006" num="0709">The SLP is responsible for ensuring that the SET is provisioned with one or more root certificates that can be used to verify the SLP's certificate
        <ul id="ul0153" list-style="none">
            <li id="ul0153-0001" num="0710">These root certificate(s) may be provisioned during manufacture or distribution of SET,</li>
            <li id="ul0153-0002" num="0711">These root certificate(s) may be bundled with the SUPL client software.</li>
            <li id="ul0153-0003" num="0712">Note: If there is no chain of certificates from the SLP certificate back to one of these root certificates, then the SET will be unable to authenticate the SLP</li>
        </ul>
        </li>
        <li id="ul0151-0007" num="0713">OMA-LOC may specify a common template or profile for certificates to simplify and unify implementation and testing
<br/>
Device Certificate Summary
</li>
        <li id="ul0151-0008" num="0714">Step 1: Subscriber Authorization (out of scope)
        <ul id="ul0154" list-style="none">
            <li id="ul0154-0001" num="0715">The subscriber securely verifies to the SLP that this device should be associated with their subscription</li>
        </ul>
        </li>
        <li id="ul0151-0009" num="0716">Step 2: Runtime TLS Handshakes
        <ul id="ul0155" list-style="none">
            <li id="ul0155-0001" num="0717">First: perform server authenticated TLS handshake using server certificate</li>
            <li id="ul0155-0002" num="0718">Next: inside encrypted TLS tunnel, perform mutually-authenticated TLS handshake using server certificate and client certificate.</li>
            <li id="ul0155-0003" num="0719">Now data can be exchanged securely
<br/>
(Out of Scope) Subscriber Authorization I
</li>
        </ul>
        </li>
        <li id="ul0151-0010" num="0720">The SLP knows which subscriber should be associated with an (authenticated) SET, since only the SET identity is authenticated, not the subscriber identity.</li>
        <li id="ul0151-0011" num="0721">This happens as often as the subscriber switches between SETs</li>
        <li id="ul0151-0012" num="0722">It may not be sufficient for the user to provide the SET identity to the SLP
        <ul id="ul0156" list-style="none">
            <li id="ul0156-0001" num="0723">Reason: User 1 can provide SET ID of User 2 to the SLP and say &#x201c;this is my SET&#x201d;. Then the SLP may provide details of User 2 location to User 1 without User 2 being aware what is happening.</li>
        </ul>
        </li>
        <li id="ul0151-0013" num="0724">A secure method is used to securely associate the subscriber with the SET ID
        <ul id="ul0157" list-style="none">
            <li id="ul0157-0001" num="0725">Method is left out-of-scope.</li>
            <li id="ul0157-0002" num="0726">Some systems already have mechanisms to securely associate device identity with subscriber (e.g. Apple, Blackberry)</li>
            <li id="ul0157-0003" num="0727">Example method provided below.
<br/>
(Out of Scope) Subscriber Authorization II
</li>
        </ul>
        </li>
        <li id="ul0151-0014" num="0728">An example method for securely associating a subscriber with device identity
        <ul id="ul0158" list-style="none">
            <li id="ul0158-0001" num="0729">SLP Operator prompts the subscriber to connect to an SLP-owned website while using the SET.</li>
            <li id="ul0158-0002" num="0730">Subscriber connects to website (possibly WAP) while using the SET.</li>
            <li id="ul0158-0003" num="0731">Web server requests TLS handshake with device certificate and web-server certificate
            <ul id="ul0159" list-style="none">
                <li id="ul0159-0001" num="0732">This certificate may be distinct from the SLP servicer</li>
            </ul>
            </li>
            <li id="ul0158-0004" num="0733">The subscriber performs some (out of scope) authentication with the website. For example, the website could request an SLP-specific username/password, or federated username/password or other subscriber details such as address, date of birth, etc.</li>
            <li id="ul0158-0005" num="0734">The SLP operator has now securely associated the subscriber with the device identity and should store this association in the SLP.
<br/>
Runtime TLS Handshakes Overview
</li>
        </ul>
        </li>
        <li id="ul0151-0015" num="0735">Device Certificate based client authentication
        <ul id="ul0160" list-style="none">
            <li id="ul0160-0001" num="0736">Server is first authenticated using public key TLS as in ACA producing a secure encrypted IP connection</li>
        </ul>
        </li>
        <li id="ul0151-0016" num="0737">This preserves anonymity by hiding device identity in device certificate
        <ul id="ul0161" list-style="none">
            <li id="ul0161-0001" num="0738">Next, the Client and Server perform mutually-authenticated TLS based on server certificates and device certificates
<br/>
Run-Time TLS Handshakes Details
</li>
        </ul>
        </li>
        <li id="ul0151-0017" num="0739">First TLS handshake of the first SUPL session to initiate server authenticated secured tunnel:
        <ul id="ul0162" list-style="none">
            <li id="ul0162-0001" num="0740">SET&#x2192;SLP: Client Hello indicating support for TLS with server certificates and device certificates</li>
            <li id="ul0162-0002" num="0741">SLP&#x2192;SET: Server Hello indicating cipher suite for TLS with server certificates</li>
            <li id="ul0162-0003" num="0742">SLP&#x2190;&#x2192;SET: complete TLS handshake to establish secured tunnel</li>
        </ul>
        </li>
        <li id="ul0151-0018" num="0743">Second TLS handshake to perform mutual authentication
        <ul id="ul0163" list-style="none">
            <li id="ul0163-0001" num="0744">SLP&#x2192;SET: Hello Request to initiate renegotiation</li>
            <li id="ul0163-0002" num="0745">SET&#x2192;SLP: Client Hello indicating support for TLS with server certificates and device certificates</li>
            <li id="ul0163-0003" num="0746">SLP&#x2192;SET: Server Hello indicating selection of TLS with server certificates and device certificates</li>
            <li id="ul0163-0004" num="0747">SLP&#x2190;&#x2192;SET: complete TLS handshake to establish secured tunnel</li>
        </ul>
        </li>
        <li id="ul0151-0019" num="0748">SET and SLP can now conduct SUPL session over secured channel
<br/>
Certificate Revocation
</li>
        <li id="ul0151-0020" num="0749">Both device and server certificates can be revoked</li>
        <li id="ul0151-0021" num="0750">Both device and server can use methods such as a Certificate Revocation List (e.g. [RFC3280]) or Online Certificate Status Protocol (OCSP) [RFC2560] to check if the device certificate has been revoked</li>
        <li id="ul0151-0022" num="0751">The specific method is a stage 3 consideration.
<br/>
SUPL INIT Protection Overview
</li>
        <li id="ul0151-0023" num="0752">SUPL INIT protection in SUPL 3.0 is based on SUPL INIT protection mechanism in SUPL 2.0 and uses a Message Authentication Code (MAC) attached to SUPL INIT
        <ul id="ul0164" list-style="none">
            <li id="ul0164-0001" num="0753">This security is to prevent denial of service attacks on the SLP.</li>
        </ul>
        </li>
        <li id="ul0151-0024" num="0754">SUPL v3.0 offers the same protection as SUPL v2.0:
        <ul id="ul0165" list-style="none">
            <li id="ul0165-0001" num="0755">Mode A Protection
            <ul id="ul0166" list-style="none">
                <li id="ul0166-0001" num="0756">Applies if using GBA-based client authentication</li>
                <li id="ul0166-0002" num="0757">Identical to Basic Protection from SUPL v2.0</li>
                <li id="ul0166-0003" num="0758">Uses GBA-based SUPL_INIT_ROOT_KEY</li>
            </ul>
            </li>
            <li id="ul0165-0002" num="0759">Mode B Protection
            <ul id="ul0167" list-style="none">
                <li id="ul0167-0001" num="0760">SUPL v3.0 adds support using SLP-provisioned SUPL_INIT_ROOT_KEY</li>
                <li id="ul0167-0002" num="0761">Supports ACA and Device-Certificate client authentication</li>
            </ul>
            </li>
            <li id="ul0165-0003" num="0762">NULL Protection is also supported and may be used based on operator's choice.</li>
        </ul>
        </li>
        <li id="ul0151-0025" num="0763">SUPL v3.0 adds mechanism for SLP to provision SUPL_INIT_ROOT_KEY
<br/>
Mode B Protection SUPL_INIT_ROOT_KEY
</li>
        <li id="ul0151-0026" num="0764">Mode B SUPL_INIT protection requires the SLP to provision a SUPL_INIT_ROOT_KEY to the device</li>
        <li id="ul0151-0027" num="0765">The SUPL_INIT_ROOT_KEY is unique to this combination of device and subscriber</li>
        <li id="ul0151-0028" num="0766">Note that the SUPL_INIT_ROOT_KEY can be used only for providing protection to the SLP against denial-of-service attack</li>
        <li id="ul0151-0029" num="0767">Disclosing the key will not reveal any user data</li>
        <li id="ul0151-0030" num="0768">Disclosing the key will only add one extra device that could be involved in a Denial of Service Attack</li>
        <li id="ul0151-0031" num="0769">Since each SUPL_INIT_ROOT_KEY has little value, the key can be effectively &#x201c;permanent&#x201d; and stored with other details associated with the subscription.</li>
        <li id="ul0151-0032" num="0770">That is, a special server is not necessary to secure these keys.</li>
        <li id="ul0151-0033" num="0771">Note: the SET deletes SUPL_INIT_ROOT_KEY if the UICC is removed, since this indicates a change of ownership.
<br/>
Mode B Procedures
</li>
        <li id="ul0151-0034" num="0772">Mode B Initiating Provisioning</li>
        <li id="ul0151-0035" num="0773">Procedures for initiating Mode B Provisioning</li>
        <li id="ul0151-0036" num="0774">Mode B Provisioning</li>
        <li id="ul0151-0037" num="0775">SLP provisions SUPL_INIT_ROOT_KEY to the SET</li>
        <li id="ul0151-0038" num="0776">Mode B Usage without a SUPL_INIT_ROOT_KEY</li>
        <li id="ul0151-0039" num="0777">If no SUPL_INIT_ROOT_KEY has been provisioned, then the SET accepts the first SUPL_INIT message it receives from the SLP without verifying the MAC.</li>
        <li id="ul0151-0040" num="0778">Mode B Usage with a SUPL_INIT_ROOT_KEY</li>
        <li id="ul0151-0041" num="0779">Once SUPL_INIT_ROOT_KEY has been provisioned, then the SET accepts SUPL_INIT message it receives from the SLP if the MAC and the time are verified correctly and does not accept SUPL_INIT message otherwise</li>
        <li id="ul0151-0042" num="0780">Mode B Exception&#x2014;Hard Reset
<br/>
Mode B Initiating Provisioning
</li>
        <li id="ul0151-0043" num="0781">Initiating SUPL_INIT_ROOT_KEY provisioning, and SUPL_INIT_ROOT_KEY provision occur during a (secured) ULP session between the SET and SLP</li>
        <li id="ul0151-0044" num="0782">Initiating SUPL_INIT_ROOT_KEY Provisioning
        <ul id="ul0168" list-style="none">
            <li id="ul0168-0001" num="0783">If, at the beginning of a secured ULP session, the SET notices that it does not have a SUPL_INIT_ROOT_KEY, then the SET initiates SUPL_INIT_ROOT_KEY provisioning by including a SUPL_INIT_ROOT_KEY_Request indicator in the first ULP message.</li>
        </ul>
        </li>
        <li id="ul0151-0045" num="0784">Note that the SET may be configured to originate a SUPL session (to request a SUPL_INIT_ROOT_KEY) after some number of SUPL INIT failures over a period of time if a session does not otherwise occur.</li>
        <li id="ul0151-0046" num="0785">If the SLP suspects that the SUPL_INIT_ROOT_KEY in the SET has been corrupted (e.g., if the SET has not been responding to SUPL_INIT messages for some time), then the SLP may initiate SUPL_INIT_ROOT_KEY Provisioning following receipt of the first ULP message from the SET
<br/>
Mode B Provisioning
</li>
        <li id="ul0151-0047" num="0786">Note: This procedure follows &#x201c;Mode B Initiating Provisioning&#x201d;</li>
        <li id="ul0151-0048" num="0787">If the SLP has chosen not to support Mode B Protection, then the SLP sends an appropriate indication to the SET</li>
        <li id="ul0151-0049" num="0788">Otherwise
        <ul id="ul0169" list-style="none">
            <li id="ul0169-0001" num="0789">The SLP obtains SUPL_INIT_ROOT_KEY</li>
        </ul>
        </li>
        <li id="ul0151-0050" num="0790">If the SLP has an existing SUPL_INIT_ROOT_KEY associated with this combination of SET and subscriber, then the SLP retrieves this value from its records</li>
        <li id="ul0151-0051" num="0791">If the SLP does not have an existing SUPL_INIT_ROOT_KEY associated with this combination of SET and subscriber, then the SLP generates a fresh SUPL_INIT_ROOT_KEY
        <ul id="ul0170" list-style="none">
            <li id="ul0170-0001" num="0792">The SLP sends the SUPL_INIT_ROOT_KEY to the SET as a parameter in a secured ULP message</li>
            <li id="ul0170-0002" num="0793">The SET stores the value of SUPL_INIT_ROOT_KEY.</li>
        </ul>
        </li>
        <li id="ul0151-0052" num="0794">The SET may apply some protection to the stored value that would allow the SET to later detect if the stored value of SUPL_INIT_ROOT_KEY had been corrupted. Examples of such protection include error correction and/or an integrity check.
<br/>
Mode B Usage without a SUPL_INIT_ROOT_KEY
</li>
        <li id="ul0151-0053" num="0795">The SET may be in a state where Mode B protection may be applied, but it has no SUPL_INIT_ROOT_KEY. Examples include:
        <ul id="ul0171" list-style="none">
            <li id="ul0171-0001" num="0796">At power-up, before a SUPL_INIT_ROOT_KEY has been provisioned.</li>
            <li id="ul0171-0002" num="0797">The SUPL_INIT_ROOT_KEY has been corrupted or deleted.</li>
        </ul>
        </li>
        <li id="ul0151-0054" num="0798">If the SET is in such a state, then the SET accepts the first SUPL_INIT message it receives from the SLP, without verifying the MAC
        <ul id="ul0172" list-style="none">
            <li id="ul0172-0001" num="0799">The SET establishes a TLS session with the SLP</li>
            <li id="ul0172-0002" num="0800">The SET performs Mode B Initiating Provisioning procedures above to request a SUPL_INIT_ROOT_KEY</li>
        </ul>
        </li>
        <li id="ul0151-0055" num="0801">If the SLP knows that the SET is in such a state, then the SLP sends SUPL_INIT messages using NULL Protection, with the knowledge that the SET will accept such messages anyway.
        <ul id="ul0173" list-style="none">
            <li id="ul0173-0001" num="0802">In the subsequent ULP session, the SET or SLP can use Mode B Initiating Provisioning procedures above to initiate provisioning of a SUPL_INIT_ROOT_KEY
<br/>
Mode B Usage with a SUPL_INIT_ROOT_KEY
</li>
        </ul>
        </li>
        <li id="ul0151-0056" num="0803">If the SLP believes that the SET has a SUPL_INIT_ROOT_KEY, then the SLP adds a SUPL INIT Protector to each SUPL INIT message&#x2014;this allows the SET to check the authenticity of the received SUPL INIT message.</li>
        <li id="ul0151-0057" num="0804">If using Mode B Protection, then the SUPL INIT Protector parameter consists of:</li>
        <li id="ul0151-0058" num="0805">SUPL_INIT_TIME (length=4 octets). Time of sending message. Stops replay.</li>
        <li id="ul0151-0059" num="0806">SUPL_INIT_MODE_B_MAC (length=4 octets). Authenticates the message.</li>
        <li id="ul0151-0060" num="0807">If the SET has a SUPL_INIT_ROOT_KEY, then the SET accepts the message only if the SUPL_INIT_TIME is valid and the SUPL_INIT_MODE_B_MAC provided in the SUPL INIT agrees with the value computed by the SET
<br/>
SUPL_INIT_MODE_B_MAC Computation
</li>
        <li id="ul0151-0061" num="0808">The SUPL_INIT_MODE_B_MAC parameter is generated as follows:</li>
        <li id="ul0151-0062" num="0809">SUPL_INIT_MODE_B_MAC=HMAC-SHA256-32(SUPL_INIT_ROOT_KEY, SUPL_INIT_Z)</li>
        <li id="ul0151-0063" num="0810">SUPL_INIT_Z is the SUPL INIT message with the SUPL_INIT_MODE_B_MAC field set to all zeroes.
<br/>
Mode B Exception&#x2014;Hard Reset
</li>
        <li id="ul0151-0064" num="0811">For exception cases (e.g. SET and SLP out of synch) where an operator uses SUPL INIT protection, null SUPL INIT protection may be used temporarily to reprovision the SET as long as this is explicitly indicated to the SET (e.g. via a reset command) so that a Denial of Service attack cannot take advantage of this by sending unprotected SUPL INITs to a large number of SETs</li>
        <li id="ul0151-0065" num="0812">This reset command is input directly to the SET to prevent introducing new threats.
<br/>
Summary
</li>
        <li id="ul0151-0066" num="0813">A new security model for SUPL 3.0: Client Authentication using device certificates.</li>
        <li id="ul0151-0067" num="0814">Device certificates are provisioned at manufacture</li>
        <li id="ul0151-0068" num="0815">SUPL INIT protection supported also in client authentication using device certificates.</li>
        <li id="ul0151-0069" num="0816">Device certificate based client authentication is a bearer agnostic security model and is thus suitable for SUPL 3.0.</li>
        <li id="ul0151-0070" num="0817">Legacy security models (ACA and GBA) may still be used depending on SUPL operator's choice.
<br/>
Recommendation
</li>
        <li id="ul0151-0071" num="0818">Client Authentication using device certificates as security model for SUPL 3.0.</li>
        <li id="ul0151-0072" num="0819">Maintain support for legacy ACA and GBA security models.
<br/>
Additional Embodiment 7
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0119" num="0820">Security solutions for SUPL 2.0 may not be available other than over 3GPP, 3GPP2 and WIMax access networks (e.g. may not support WiFi access) and include implementation of GBA in order to support strong security. In addition, the security solutions may not allow Access related SLPs (A-SLPs) to be supported instead of or in addition to home operator SLPs (H-SLPs).</p>
<p id="p-0120" num="0821">This embodiment makes use of a Username and Password assigned to a user or a user's SUPL Enabled Terminal (SET) by an SLP provider to support client (SET) authentication using TLS-SRP. A SUPL SET and SLP may use public key TLS to allow the SET to authenticate the SLP. This may produce a secure TLS/IP connection over which a second authentication occurs of the SET by the SLP using TLS-SRP (and the pre-agreed Username and Password). This may modify the initial secure IP/TLS connection which is then used to support a secure SUPL session. The SLP may then use this SUPL session to provide a new Username and password to the SET to replace the initially assigned Username and password. The new Username and Password may not be visible to the user; this may prevent a user from using the Username and Password in more than one device and may protect the user from accidental transfer of the initial Username password to other users. The solution may be used for both an H-SLP and an A-SLP and does not necessarily require use of 3GPP, 3GPP2 or WiMax access networks only.</p>
<p id="p-0121" num="0822">Thus, the described embodiments may extend SUPL security support to all IP access networks, provide stronger security than currently deployed solutions without having to support GBA, and may support an H-SLP and A-SLP (section numbers may refer to SUPL 3.0 section numbers).</p>
<p id="h-0010" num="0000">6. Security Considerations</p>
<p id="p-0122" num="0823">This section describes a SUPL Security function that enables the SUPL network to authenticate and authorize the SET and enables the SET to authenticate and authorize the SUPL network.</p>
<p id="p-0123" num="0824">NOTE: Unless otherwise specified, the use of the acronym TLS refers to any session that can be negotiated using a TLS handshake: this includes both TLS 1.1 ciphersuites and TLS-PSK ciphersuites.</p>
<p id="p-0124" num="0825">NOTE: In this section, the following definitions apply. A 3GPP bearer network is one for which the standards are maintained by 3GPP; these include GSM, GPRS, EDGE, WCDMA/TD-SCDMA, LTE and LTE-A bearer networks. A 3GPP2 bearer network is one for which the standards are maintained by 3GPP2; these include cdmaOne, cdma2000 1x andcdma200 EV-DO bearer networks. A 3GPP SET (3GPP2 SET respectively) is a SET whose home network operator principally supports data access via a 3GPP bearer network (3GPP2 bearer network respectively). A WiMAX SET is a SET whose home network operator principally supports data access via a WiMAX bearer network. In cases of ambiguity (e.g. an operator who supports multiple access types), the operator may decide the type of SET.</p>
<p id="p-0125" num="0826">NOTE: H-SLP operators should note that the authentication methods described herein remain valid for SET handover between access networks belonging to the same operator or where the SET IP address is not changed. The procedures do not take into account scenarios where the SET moves from one access network to another belonging to different operators or where the IP address changes. It is assumed in these scenarios, that after the hand over to another access system, the security context may not be available in the terminal and the network and the level of trust between the network and terminal may change.</p>
<p id="p-0126" num="0827">On powering up and shutting down, detection of a new UICC or removal of a UICC, the SET handset MUST delete any keys (aside form long-term keys) on the SET handset associated with SUPL 3.0, including
<ul id="ul0174" list-style="none">
    <li id="ul0174-0001" num="0000">
    <ul id="ul0175" list-style="none">
        <li id="ul0175-0001" num="0828">GBA Keys: such as Ks, Ks_NAF, Ks_ext_NAF</li>
        <li id="ul0175-0002" num="0829">WIMAX Keys: such as SEK</li>
        <li id="ul0175-0003" num="0830">TLS Keys: such as pre_master_secret, master_secret, and PSK values (aside from long-term keys).</li>
        <li id="ul0175-0004" num="0831">SUPL Specific Keys: such as keys associated with protection of SUPL INIT messages.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0127" num="0832">6.1 SUPL Authentication Methods</p>
<p id="h-0011" num="0000">Authentication support requirements for SUPL 3.0 are as follows:</p>
<p id="p-0128" num="0000">
<ul id="ul0176" list-style="none">
    <li id="ul0176-0001" num="0000">
    <ul id="ul0177" list-style="none">
        <li id="ul0177-0001" num="0833">Mutual authentication MAY be supported between a SET and an H-SLP.</li>
        <li id="ul0177-0002" num="0834">Mutual authentication MAY be supported between a SET and a D-SLP.</li>
        <li id="ul0177-0003" num="0835">Server authentication MAY be supported between a SET and an E-SLP, and mutual authentication MAY be supported between a SET and E-SLP.
<br/>
SUPL 3.0 supports two classes of SET authentication methods
</li>
        <li id="ul0177-0004" num="0836">AN-Dependent method, where the credentials are bound to the Access Network subscription of the SET User.</li>
        <li id="ul0177-0005" num="0837">AN-Independent methods, where the credentials are bound to the SET, but not directly bound to the Access Network subscription of the SET User. Binding such credentials to the Access Network subscription of the SET User may be achieved using out-of-scope procedures. See Section 6.6 for more discussion of out-of-scope procedures.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0129" num="0838">When mutual authentication is performed, the SET MAY act on behalf of the SET User via a SUPL Agent contained in the SET.
<ul id="ul0178" list-style="none">
    <li id="ul0178-0001" num="0000">
    <ul id="ul0179" list-style="none">
        <li id="ul0179-0001" num="0839">For AN-Dependent methods, the SET uses the security credentials associated with the SET User.</li>
        <li id="ul0179-0002" num="0840">For AN-Independent methods, the SET uses the security credentials associated with the SET.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0130" num="0841">Note that a successful authentication of the SET User MUST result in a successful identification of the SET User's ID (e.g., MSISDN, WIMAX user ID or AN-independent user identity).</p>
<p id="p-0131" num="0842">Note that when MSISDN is used for identification, the SLP MUST perform an IMSI to MSISDN binding before the MSISDN of the authenticated SET User is securely identified.</p>
<p id="p-0132" num="0843">The details of Key Management can be found in section 6.1.2.</p>
<p id="p-0133" num="0844">6.1.1 Authentication Methods</p>
<p id="p-0134" num="0845">Section 6.1.1.1 lists the authentication methods supported in this specification. An informative overview of these methods is provided in section 6.1.1.2. Section 6.1.1.3 describes which methods are mandatory or optional in the various SUPL 3.0 entities, and lists the protocols required in each entity if it is to support a given mutual-authentication method.</p>
<p id="p-0135" num="0846">6.1.1.1 List of Supported Mutual-Authentication Methods</p>
<p id="p-0136" num="0847">The SUPL Authentication model requires establishing shared secret keys between the SLP and the SET, bound to either a removable token such as a R-UIM/UICC/SIM/USIM or the SET handset.</p>
<p id="p-0137" num="0848">There are two classes of authentication methods specified in this document:
<ul id="ul0180" list-style="none">
    <li id="ul0180-0001" num="0000">
    <ul id="ul0181" list-style="none">
        <li id="ul0181-0001" num="0849">PSK-based methods, consisting of the following methods:
        <ul id="ul0182" list-style="none">
            <li id="ul0182-0001" num="0850">AN-dependent Generic Bootstrapping Architecture (GBA)-based method, providing mutual authentication;</li>
            <li id="ul0182-0002" num="0851">AN-dependent SEK based method (only applicable to a WIMAX SLP), providing mutual authentication;</li>
        </ul>
        </li>
        <li id="ul0181-0002" num="0852">Certificate based methods, consisting of the following methods:
        <ul id="ul0183" list-style="none">
            <li id="ul0183-0001" num="0853">AN-Independent Device-Certificate based (DCert) Method, providing mutual authentication;</li>
            <li id="ul0183-0002" num="0854">AN-dependent Alternative Client authentication (ACA)-based method, providing mutual authentication;</li>
            <li id="ul0183-0003" num="0855">AN-Independent SLP-only method (only applicable in emergency cases), providing SLP authentication only.</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0138" num="0856">6.1.1.2 Overview of Supported Authentication Methods (Informative)
<ul id="ul0184" list-style="none">
    <li id="ul0184-0001" num="0857">1. Generic Bootstrapping Architecture (GBA)-Based. TLS-PSK with Generic Bootstrapping Architecture (GBA) GBA provides mutual authentication capability based on shared secret that is derived using existing 3GPP/3GPP2 authentication mechanisms.
    <ul id="ul0185" list-style="none">
        <li id="ul0185-0001" num="0858">SET and SLP are mutually authenticated using TLS-PSK with Generic Bootstrapping Architecture (GBA).</li>
    </ul>
    </li>
    <li id="ul0184-0002" num="0859">2. SEK based (only applicable to WIMAX SLP).
    <ul id="ul0186" list-style="none">
        <li id="ul0186-0001" num="0860">SET and SLP are mutually authenticated using TLS-PSK with SEK. The details of SEK method can be found in section 6.1.2.1.2.</li>
    </ul>
    </li>
    <li id="ul0184-0003" num="0861">3. Device Certificate (DCert)-based. This AN-Independent method uses TLS with
    <ul id="ul0187" list-style="none">
        <li id="ul0187-0001" num="0862">RSA server certificate to authenticate the SLP to the SET,</li>
        <li id="ul0187-0002" num="0863">RSA client certificate to authenticate the SET to the SLP.</li>
    </ul>
    </li>
    <li id="ul0184-0004" num="0864">4. Alternative Client authentication (ACA)-based. This uses TLS with
    <ul id="ul0188" list-style="none">
        <li id="ul0188-0001" num="0865">RSA certificate to authenticate the SLP to the SET,</li>
        <li id="ul0188-0002" num="0866">Alternative Client authentication of the SET to the SLP (see section 6.1.4). In this case, the SLP authenticates the SET by getting the bearer network to confirm the IP address associated with the SET Identifier (MSISDN etc.).</li>
    </ul>
    </li>
    <li id="ul0184-0005" num="0867">5. SLP-only. This is used in scenarios where it is not possible for the SLP to authenticate the SET. This method MAY NOT be used for non-emergency cases. The SET cannot distinguish between this method and ACA-based. This uses TLS with
    <ul id="ul0189" list-style="none">
        <li id="ul0189-0001" num="0868">An RSA certificate to authenticate the SLP to the SET,</li>
        <li id="ul0189-0002" num="0869">The SET is not authenticated.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0139" num="0870">6.1.1.3 Support for Mutual-Authentication Methods and Protocols by Entity</p>
<p id="p-0140" num="0871">The four tables below describe what is optional and mandatory to support for SUPL 3.0 in various classes of SETs and SLP's supporting those SETs:
<ul id="ul0190" list-style="none">
    <li id="ul0190-0001" num="0000">
    <ul id="ul0191" list-style="none">
        <li id="ul0191-0001" num="0872">The first table indicates those methods that are mandatory and those methods that are optional to implement for SUPL 3.0 in
        <ul id="ul0192" list-style="none">
            <li id="ul0192-0001" num="0873">3GPP/3GPP2 SETs,</li>
            <li id="ul0192-0002" num="0874">SET (R-)UIM/SIM/USIM and</li>
            <li id="ul0192-0003" num="0875">SLPs supporting 3GPP/3GPP2 SETs;</li>
        </ul>
        </li>
        <li id="ul0191-0002" num="0876">The second table indicates those methods that are mandatory and those methods that are optional to implement for SUPL 3.0 in
        <ul id="ul0193" list-style="none">
            <li id="ul0193-0001" num="0877">WiMAX SETs and</li>
            <li id="ul0193-0002" num="0878">SLPs supporting those WiMAX SETs;</li>
        </ul>
        </li>
        <li id="ul0191-0003" num="0879">The third table indicate those methods that are mandatory and those methods that are optional to implement for SUPL 3.0 in
        <ul id="ul0194" list-style="none">
            <li id="ul0194-0001" num="0880">SETs that do not support 3GPP/3GPP2 or WiMAX, and</li>
            <li id="ul0194-0002" num="0881">SLPs supporting those SETS.</li>
        </ul>
        </li>
        <li id="ul0191-0004" num="0882">The fourth table lists the required protocols for the SLP, SET Handset and (where applicable) SET (R-)UIM/SIM/USIM for supporting each of the various authentication methods.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0141" num="0883">
<tables id="TABLE-US-00009" num="00009">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="42pt" align="left"/>
<colspec colname="1" colwidth="252pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Requirement Status for SUPL Authentication Method for 3GPP/3GPP2 SETs,</entry>
</row>
<row>
<entry/>
<entry>SET (R-) UIM/SIM/USIM and SLPs supporting 3GPP/3GPP2 SETs</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="42pt" align="left"/>
<colspec colname="1" colwidth="63pt" align="left"/>
<colspec colname="2" colwidth="189pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>PSK-based</entry>
<entry/>
</row>
<row>
<entry/>
<entry>methods</entry>
<entry>Certificate Based Methods</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="63pt" align="left"/>
<colspec colname="3" colwidth="56pt" align="left"/>
<colspec colname="4" colwidth="49pt" align="left"/>
<colspec colname="5" colwidth="84pt" align="left"/>
<tbody valign="top">
<row>
<entry>Entity</entry>
<entry>GBA-based</entry>
<entry>ACA-based</entry>
<entry>DCert</entry>
<entry>SLP-only (E-SLP only)</entry>
</row>
<row>
<entry namest="1" nameend="5" align="center" rowsep="1"/>
</row>
<row>
<entry>SET</entry>
<entry>Optional</entry>
<entry>Mandatory. See</entry>
<entry>Optional</entry>
<entry>Mandatory. See Note 1</entry>
</row>
<row>
<entry>Handset</entry>
<entry/>
<entry>Note 2 below.</entry>
<entry/>
<entry>below.</entry>
</row>
<row>
<entry>SET</entry>
<entry>SIM/USIM/(R)-</entry>
<entry>This entity is not</entry>
<entry>This entity is</entry>
<entry>This entity is not involved</entry>
</row>
<row>
<entry>SIM/USIM/</entry>
<entry>UIM is involved in</entry>
<entry>involved in this</entry>
<entry>not involved in</entry>
<entry>in this method</entry>
</row>
<row>
<entry>(R)-</entry>
<entry>this method, but it</entry>
<entry>method</entry>
<entry>this method</entry>
</row>
<row>
<entry>UIM</entry>
<entry>already supports</entry>
</row>
<row>
<entry/>
<entry>the necessary</entry>
</row>
<row>
<entry/>
<entry>algorithm</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="119pt" align="left"/>
<colspec colname="3" colwidth="49pt" align="left"/>
<colspec colname="4" colwidth="84pt" align="left"/>
<tbody valign="top">
<row>
<entry>H/D-SLP</entry>
<entry>Mandatory to support one of these two</entry>
<entry>Optional</entry>
<entry>Not supported</entry>
</row>
<row>
<entry/>
<entry>methods</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="63pt" align="left"/>
<colspec colname="3" colwidth="56pt" align="left"/>
<colspec colname="4" colwidth="49pt" align="left"/>
<colspec colname="5" colwidth="84pt" align="left"/>
<tbody valign="top">
<row>
<entry>E-SLP</entry>
<entry>Optional</entry>
<entry>Optional</entry>
<entry>Optional</entry>
<entry>Mandatory</entry>
</row>
<row>
<entry namest="1" nameend="5" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<heading id="h-0012" level="1">Requirement Status (Mandatory or Optional) of the Various Authentication Methods for 3GPP/3GPP2 SETs and SLPs Supporting these SETs</heading>
<p id="p-0142" num="0884">NOTE 1: SET Handset support for the SLP-only method may be required for emergency cases.</p>
<p id="p-0143" num="0885">NOTE 2: The SET procedures for the ACA-based method (only for 3GPP and 3GPP2) are identical to the SET procedures for SLP-only method. Consequently, 3GPP/3GPP2 SET Handset support the ACA-based method as a results of the SLP-only method being required for emergency cases.</p>
<p id="p-0144" num="0886">
<tables id="TABLE-US-00010" num="00010">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="42pt" align="left"/>
<colspec colname="1" colwidth="175pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Requirement Status for SUPL Authentication Method for</entry>
</row>
<row>
<entry/>
<entry>WiMAX SETs, and SLPs supporting these SETs</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="42pt" align="left"/>
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="133pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>PSK-based</entry>
<entry>Certificate Based Methods</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="42pt" align="left"/>
<colspec colname="3" colwidth="49pt" align="left"/>
<colspec colname="4" colwidth="35pt" align="left"/>
<colspec colname="5" colwidth="49pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>methods</entry>
<entry/>
<entry/>
<entry>SLP-only</entry>
</row>
<row>
<entry>Entity</entry>
<entry>SEK based</entry>
<entry>ACA-based</entry>
<entry>DCert</entry>
<entry>(E-SLP only)</entry>
</row>
<row>
<entry namest="1" nameend="5" align="center" rowsep="1"/>
</row>
<row>
<entry>SET</entry>
<entry>Mandatory</entry>
<entry>Not Supported</entry>
<entry>Optional</entry>
<entry>Mandatory</entry>
</row>
<row>
<entry>Handset</entry>
</row>
<row>
<entry>H/D-SLP</entry>
<entry>Mandatory</entry>
<entry>Not Supported</entry>
<entry>Optional</entry>
<entry>Not Supported</entry>
</row>
<row>
<entry>E-SLP</entry>
<entry>Optional</entry>
<entry>Not Supported</entry>
<entry>Optional</entry>
<entry>Mandatory</entry>
</row>
<row>
<entry namest="1" nameend="5" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<heading id="h-0013" level="1">Requirement Status (Mandatory or Optional) of the Various Authentication Methods for WiMAX SETs, and SLPs Supporting these WiMAX SETs</heading>
<p id="p-0145" num="0887">
<tables id="TABLE-US-00011" num="00011">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="35pt" align="left"/>
<colspec colname="1" colwidth="182pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Requirement Status for SUPL Authentication Method for</entry>
</row>
<row>
<entry/>
<entry>SETs not supporting 3GPP, 3GPP2 and WiMAX, and</entry>
</row>
<row>
<entry/>
<entry>SLPs supporting these SETs</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="35pt" align="left"/>
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="133pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>PSK-based</entry>
<entry/>
</row>
<row>
<entry/>
<entry>methods</entry>
<entry>Certificate Based Methods</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="49pt" align="left"/>
<colspec colname="3" colwidth="49pt" align="left"/>
<colspec colname="4" colwidth="35pt" align="left"/>
<colspec colname="5" colwidth="49pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>SEK/GBA</entry>
<entry/>
<entry/>
<entry>SLP-only</entry>
</row>
<row>
<entry>Entity</entry>
<entry>based</entry>
<entry>ACA-based</entry>
<entry>DCert</entry>
<entry>(E-SLP only)</entry>
</row>
<row>
<entry namest="1" nameend="5" align="center" rowsep="1"/>
</row>
<row>
<entry>SET</entry>
<entry>Not Supported</entry>
<entry>Not Supported</entry>
<entry>Mandatory</entry>
<entry>Mandatory</entry>
</row>
<row>
<entry>Handset</entry>
</row>
<row>
<entry>H/D-SLP</entry>
<entry>Not Supported</entry>
<entry>Not Supported</entry>
<entry>Mandatory</entry>
<entry>Not Supported</entry>
</row>
<row>
<entry>E-SLP</entry>
<entry>Not Supported</entry>
<entry>Not Supported</entry>
<entry>Optional</entry>
<entry>Mandatory</entry>
</row>
<row>
<entry namest="1" nameend="5" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<heading id="h-0014" level="1">Requirement Status (Mandatory or Optional) of the Various Authentication Methods for SETs not Supporting 3GPP, 3GPP2 or WiMAX, and SLPs Supporting these SETs</heading>
<p id="p-0146" num="0888">
<tables id="TABLE-US-00012" num="00012">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="42pt" align="left"/>
<colspec colname="1" colwidth="252pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Algorithms required to support the Authentication Method between SET and SLP</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="42pt" align="left"/>
<colspec colname="1" colwidth="91pt" align="center"/>
<colspec colname="2" colwidth="161pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>PSK-based methods</entry>
<entry>Certificate Based Methods</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="6">
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="49pt" align="left"/>
<colspec colname="3" colwidth="42pt" align="left"/>
<colspec colname="4" colwidth="63pt" align="left"/>
<colspec colname="5" colwidth="49pt" align="left"/>
<colspec colname="6" colwidth="49pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>GBA-based</entry>
<entry>SEK-based</entry>
<entry>ACA-based</entry>
<entry/>
<entry/>
</row>
<row>
<entry/>
<entry>(3GPP/3GPP</entry>
<entry>(WiMAX</entry>
<entry>(3GPP &#x26; 3GPP2</entry>
<entry/>
<entry>SLP-only</entry>
</row>
<row>
<entry>Entity</entry>
<entry>2 only)</entry>
<entry>only)</entry>
<entry>only)</entry>
<entry>DCert</entry>
<entry>(E-SLP only)</entry>
</row>
<row>
<entry namest="1" nameend="6" align="center" rowsep="1"/>
</row>
<row>
<entry>SLP</entry>
<entry>GBA &#x26;</entry>
<entry>SEK &#x26;</entry>
<entry>TLS using server</entry>
<entry>TLS using</entry>
<entry>TLS using</entry>
</row>
<row>
<entry/>
<entry>TLS-PSK</entry>
<entry>TLS-PSK</entry>
<entry>certificates &#x26; IP</entry>
<entry>server</entry>
<entry>server</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>Address/SET ID</entry>
<entry>certificates and</entry>
<entry>certificates</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>binding</entry>
<entry>client</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>certificates</entry>
</row>
<row>
<entry>SET</entry>
<entry>GBA &#x26;</entry>
<entry>SEK &#x26;</entry>
<entry>TLS using server</entry>
<entry>TLS using</entry>
<entry>TLS using</entry>
</row>
<row>
<entry>Handset</entry>
<entry>TLS-PSK</entry>
<entry>TLS-PSK</entry>
<entry>certificates</entry>
<entry>server</entry>
<entry>server</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>certificates and</entry>
<entry>certificates</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>client</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>certificates</entry>
</row>
<row>
<entry>SET R-</entry>
<entry>No additional</entry>
<entry>Not</entry>
<entry>No additional</entry>
<entry>Not applicable</entry>
<entry>Not applicable</entry>
</row>
<row>
<entry>UIM/UICC/</entry>
<entry>algorithms</entry>
<entry>applicable</entry>
<entry>algorithms required</entry>
</row>
<row>
<entry>SIM/USIM</entry>
<entry>required</entry>
</row>
<row>
<entry namest="1" nameend="6" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<heading id="h-0015" level="1">Required Protocols for the SLP, SET Handset and SET R-UIM/UICC/SIM/USIM for Supporting the Various Mutual Authentication Methods</heading>
<p id="p-0147" num="0889">Where the GBA-based method is supported, the BSF stores user security settings (USS) associated with the H-SLP applications. When the H-SLP requests the USS, the BSF must include a SET user identity (e.g. IMPI, IMSI or MSISDN) in the USS.</p>
<p id="p-0148" num="0890">NOTE: The GBA-based method is not dependent on using a 3GPP or 3GPP2 bearer network to transport the SUPL sessions. However, the SET must have a 3GPP or 3GPP home network operator in order to have the necessary credentials for performing GBA.</p>
<p id="p-0149" num="0891">6.1.1.4 Techniques for Minimizing the TLS Handshake Workload</p>
<p id="p-0150" num="0892">The procedures in this section minimize the workload associated with establishing TLS sessions between the SLP and SET. Where there is a conflict with TLS, TLS takes precedence.</p>
<p id="p-0151" num="0893">If a SET and SLP are communicating SUPL messages associated with more than one SUPL sessions simultaneously, then the SET and SLP SHOULD use a single TLS sessions to secure these messages; that is, the SET and SLP SHOULD NOT establish distinct TLS sessions if SUPL sessions are simultaneous.</p>
<p id="p-0152" num="0894">If the SET and SLP establish a TLS session, then the SLP MAY allow the session to be resumed using the abbreviated handshake. The advantage of resuming a TLS session is that resuming a TLS session based on server certificates does not require the public-key operations: only symmetric cryptographic algorithms are required (which require significantly less processing).</p>
<p id="p-0153" num="0895">NOTE: This approach is not recommended for E-SLP's since emergency SUPL sessions occur too occasionally to warrant storing the necessary data.</p>
<p id="p-0154" num="0896">NOTE: The SLP allows the session to be resumed by allocating a TLS SessionID.</p>
<p id="p-0155" num="0897">NOTE: There is no advantage to resuming a TLS-PSK session (as used for GBA and SEK-based authentication), since the same computations are performed. However, an SLP may still allow resuming a TLS-PSK session.</p>
<p id="p-0156" num="0898">NOTE: A SET indicates the choice to resume a TLS session by including the TLS SessionID (of the TLS session to be resumed) in the TLS SessionID parameter in the ClientHello message of the TLS Handshake. If the SET does not wish to resume a TLS session, then the SET sends the TLS ClientHello message without including the TLS SessionID, in which case the full handshake will be performed. If the TLS SessionID parameter is present in the TLS ClientHello message, the SLP then chooses whether or not to resume the TLS session. If no SessionID parameter is present in the TLS ClientHello message, then the SLP cannot associate the TLS handshake with a previous TLS Session, so the TLS handshake establishes a completely fresh TLS session using a full handshake.</p>
<p id="p-0157" num="0899">The SET chooses whether or not to resume a TLS session, using the following guidelines.
<ul id="ul0195" list-style="none">
    <li id="ul0195-0001" num="0000">
    <ul id="ul0196" list-style="none">
        <li id="ul0196-0001" num="0900">The SET MUST NOT resume a TLS session if the underlying credentials (Ks(_ext)_NAF or SLP certificate or SEK or Device Certificate) are expired.</li>
        <li id="ul0196-0002" num="0901">The SET MAY choose to not resume a TLS session earlier than the expiry of the underlying credentials, if desired.</li>
        <li id="ul0196-0003" num="0902">The SET MUST NOT resume a session that was established prior to power-up or detection of a new R-UIM/UICC/SIM/USIM.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0158" num="0903">The SLP chooses whether or not to resume a TLS session, using the following guidelines.
<ul id="ul0197" list-style="none">
    <li id="ul0197-0001" num="0000">
    <ul id="ul0198" list-style="none">
        <li id="ul0198-0001" num="0904">The SLP MUST NOT resume a TLS session if the underlying credentials (Ks(_ext)_NAF or SLP certificate or SEK or Device Certificate) are expired.</li>
        <li id="ul0198-0002" num="0905">The SLP MAY choose to not resume a TLS session earlier than the expiry of the underlying credentials if desired.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0159" num="0906">NOTE: Each SLP must decide for itself whether or not to allow abbreviated handshakes, and this decision can even be made on a SET-by-SET basis. The SLP is taking a small risk when it accepts to resume an existing TLS session. This risk is the possibility of a &#x201c;naughty&#x201d; SET distributing the master_secret (established during a full TLS handshake), so that others may resume that TLS session, thus allowing multiple SETs to obtain service that will be charged to a single SET. The &#x201c;naughty&#x201d; SET could be doing this without the knowledge of the SET owner (for example, a malicious code could be at fault). Note that the loss can be easily limited: if a SLP detects (or suspects) that such abuse is occurring, then the SLP can easily (a) end the TLS sessions using that master_secret, (b) identify the &#x201c;naughty&#x201d; SET and (c) re-authenticate the &#x201c;naughty&#x201d; SET using full handshake to allow the user to continue to have service if required. In summary, the benefit of resuming sessions (in terms of reduced computation) for the DCert method, ACA-based method and SLP-only method is thought to exceed the risk of attack.</p>
<p id="p-0160" num="0907">6.1.2 Key Management for SUPL Authentication</p>
<p id="p-0161" num="0908">The SUPL Authentication model requires establishing shared secret keys between the SLP and the SET, bound to either a removable token such as a R-UIM/UICC/SIM/USIM or the SET handset.</p>
<p id="p-0162" num="0909">6.1.2.1 PSK-Based Methods</p>
<p id="p-0163" num="0910">6.1.2.1.1 Deployments Supporting the GBA Method</p>
<p id="p-0164" num="0911">In the case of deployments supporting GBA, the shared keys are established as follows:
<ul id="ul0199" list-style="none">
    <li id="ul0199-0001" num="0000">
    <ul id="ul0200" list-style="none">
        <li id="ul0200-0001" num="0912">When the SLP requests key material form the BSF (for securing IP communication and for protecting SUPL INIT), the SLP MUST also request the USS (User security settings). The USS MUST include a permanent user identity (e.g. IMPI, IMSI or MSISDN).</li>
        <li id="ul0200-0002" num="0913">For securing IP communication between the SET and SLP, the SET and the SLP MUST derive a shared secret key and operate according to TLS-PSK using GBA. The SLP MUST have well defined domain name SLP Address_FQDN designating the SLP, e.g., slp.operator.com. The GBA Ua security protocol identifier that may be used for TLS-PSK is defined in OMNA Registry. The SLP MUST confirm that the permanent user identity provided by the BSF corresponds to the SET identity in SUPL messages received by the SLP over the corresponding secured connection.</li>
        <li id="ul0200-0003" num="0914">For MAC protection of SUPL INIT, keys are derived according to GBA. The GBA Ua security protocol identifier that may be used for SUPL INIT protection is defined in OMNA Registry. The keyIdentifier of the basicMAC included in the SUPL INIT message MUST be the B-TID of the Ks from which the Ks_NAF is generated. NOTE: The H/D-SLP request for SUPL INIT protection keys from the BSF would typically occur simultaneously with the H/D-SLP request for the keys securing IP communication.</li>
        <li id="ul0200-0004" num="0915">The SET MUST ensure that it is always provisioned with a valid Ks. If no valid Ks is present then the SET MUST initiate the GBA Bootstrapping procedure to provision Ks. A new Ks MUST be established each time a new UICC (USIM/SIM/R-UIM) is detected by the SET. Additionally, the SET MUST establish new shared keys when the Ks_NAFs lifetime (set by the Home Network operator) expires.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0165" num="0916">6.1.2.1.2 Deployments Supporting the SEK Method</p>
<p id="p-0166" num="0917">In the case of deployments supporting SEK, the shared keys are established as follows:
<ul id="ul0201" list-style="none">
    <li id="ul0201-0001" num="0000">
    <ul id="ul0202" list-style="none">
        <li id="ul0202-0001" num="0918">For securing IP communication between the SET and SLP, the SET and SLP MUST derive a shared secret key and confirm that the permanent user identity provided by the WiMAX AAA server corresponds to the SET identity in the SUPL messages received by the SLP over the corresponding secured connection. The shared keys are derived in the following way:
        <ul id="ul0203" list-style="none">
            <li id="ul0203-0001" num="0919">SEK=the 16 most significant (leftmost) octets of HMAC-SHA256(LSK, &#x201c;slp.operator.com&#x201d;) where &#x2018;operator.com&#x2019; is the FQDN of the WIMAX operator and LSK is derived as specified in WiMAX Network Protocols and Architecture for Location Based Services.</li>
            <li id="ul0203-0002" num="0920">SEK will inherit the Location Key Identifier (LSK-ID) (as defined in WiMAX Network Protocols and Architecture for Location Based Services) associated with the LSK and the key identity will be used as the B-TID for WiMAX deployments.</li>
        </ul>
        </li>
        <li id="ul0202-0002" num="0921">For MAC integrity protection of SUPL INIT, keys are derived the following way:
        <ul id="ul0204" list-style="none">
            <li id="ul0204-0001" num="0922">SEK_MAC=the 16 most significant (leftmost) octets of HMAC-SHA256(LSK, &#x201c;mac.slp.operator.com&#x201d;) where &#x2018;operator.com&#x2019; is the FQDN of the SLP operator and LSK is derived as specified in WiMAX Network Protocols and Architecture for Location Based Services.</li>
            <li id="ul0204-0002" num="0923">The keyIdentifier of the Mode AMAC included in the SUPL INIT message MUST be the B-TID of the LSK from which the SEK_MAC is generated. NOTE: The SLP request for SUPL INIT protection keys from the WiMAX AAA would typically occur simultaneously with SLP request for the keys securing IP communication.</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0167" num="0924">The SET MUST ensure that it is always provided with a valid SEK. If no valid SEK is present then the SET MUST derive the SEK as specified above. Additionally, the SET MUST establish new shared keys when the lifetime of the LSK expires. The interface between the SLP and the WiMAX AAA server is out of scope of SUPL 3.0.</p>
<p id="p-0168" num="0925">6.1.2.2 Server-Certificate Based Methods</p>
<p id="p-0169" num="0926">6.1.2.2.1 Deployments Supporting the DCert Method</p>
<p id="p-0170" num="0927">In the case of deployments supporting the DCert method, the shared keys are established as follows:
<ul id="ul0205" list-style="none">
    <li id="ul0205-0001" num="0000">
    <ul id="ul0206" list-style="none">
        <li id="ul0206-0001" num="0928">For securing IP communication between the SET and SLP, the SET and SLP MUST use TLS-RSA with a server-certificate authenticating the SLP and a client certificate authenticating the SET. The client certificate may provide a globally unique SET device identity:
        <ul id="ul0207" list-style="none">
            <li id="ul0207-0001" num="0929">3GPP SETs MAY use the IMEI as the globally unique SET device identity.</li>
            <li id="ul0207-0002" num="0930">3GPP2 SETs MAY use the MSID as the globally unique SET device identity.</li>
            <li id="ul0207-0003" num="0931">WiMAX SETs MAY use the SET serial number as the globally unique SET device identity.</li>
            <li id="ul0207-0004" num="0932">All other SETS MAY use a suitable global identifier (e.g. a serial number that includes the vendor identity) as the globally unique SET device identity.</li>
        </ul>
        </li>
        <li id="ul0206-0002" num="0933">The SUPL User must securely verify to the SLP that this device should be associated with their subscription. This secure verification is out of scope of this specification. See Section 6.5 for further discussion of this topic.</li>
        <li id="ul0206-0003" num="0934">For MAC integrity protection of SUPL INIT, keys are provided to the SET by the SLP in a ULP message. This is described in Section 6.3.5.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0171" num="0935">6.1.2.2.2 Deployments Supporting the ACA Method</p>
<p id="p-0172" num="0936">In the case of deployments supporting the ACA method, the shared keys are established as follows:
<ul id="ul0208" list-style="none">
    <li id="ul0208-0001" num="0000">
    <ul id="ul0209" list-style="none">
        <li id="ul0209-0001" num="0937">For securing IP communication between the SET and SLP, the SET and SLP MUST use TLS-RSA with a server-certificate authenticating the SLP. SET authentication (which binds the resulting shared secret keys to either the removable or integrated token discussed above) is described in section 6.1.4 for non-emergency cases and sections 6.2.5 for emergency cases.</li>
        <li id="ul0209-0002" num="0938">For MAC integrity protection of SUPL INIT, keys are provided to the SET by the SLP in a ULP message. This is described in Section 6.3.5.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0173" num="0939">6.1.2.2.3 Deployments Supporting the SLP-Only Method</p>
<p id="p-0174" num="0940">In the case of deployments supporting the SLP-Only Method, the shared keys are established as follows:
<ul id="ul0210" list-style="none">
    <li id="ul0210-0001" num="0000">
    <ul id="ul0211" list-style="none">
        <li id="ul0211-0001" num="0941">For securing IP communication between the SET and SLP, the SET and SLP MUST use TLS-RSA with a server-certificate authenticating the SLP. There is no SET authentication (which binds the resulting shared secret keys to either the R-UIM/UICC/SIM/USIM or the SET handset) as described in section 6.1.4 for non-emergency cases and section 6.2.5 for emergency cases.</li>
        <li id="ul0211-0002" num="0942">MAC protection of SUPL INIT is not supported in these cases.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0175" num="0943">6.1.3 TLS Handshake and Negotiation of Mutual-Authentication Method</p>
<p id="p-0176" num="0944">The SET and SLP need to agree on a mutually-supported authentication method to be applied.</p>
<p id="p-0177" num="0945">6.1.3.1 Regarding Negotiating a Mutual-Authentication Method (Informative)</p>
<p id="p-0178" num="0946">When establishing a TLS connection to the H-SLP, the SET first attempts to establish a connection using the mutually-supported authentication mechanism with highest preference, according to the following order of preference:
<ul id="ul0212" list-style="none">
    <li id="ul0212-0001" num="0000">
    <ul id="ul0213" list-style="none">
        <li id="ul0213-0001" num="0947">PSK-based methods: GBA or SEK-based method first preference (if supported);</li>
        <li id="ul0213-0002" num="0948">DCert method: second preference (if supported);</li>
        <li id="ul0213-0003" num="0949">ACA or SLP-only methods: third preference (from the SET's perspective there is no difference between the ACA-based method and the SLP-only method).</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0179" num="0950">If there is no mutually-supported authentication method, then the SET may be unable to perform SUPL session.</p>
<p id="p-0180" num="0951">A SET that supports PSK based methods may be unable to use the GBA or SEK-based method at a given point in time due to a BSF or WiMAX AAA experiencing problems. Therefore, an attempt by the SET to establish authentication using GBA or SEK does not guarantee that the SET may be able to establish GBA or SEK-based keys.</p>
<p id="p-0181" num="0952">Consequently, the SET may not always be able to use the mutually-supported authentication mechanism with highest preference. The SET may have to revert to a less preferable mutually-supported authentication mechanism if available.</p>
<p id="p-0182" num="0953">If only PSK based methods are indicated (in the H-SLP Certificate) as supported by the H-SLP, and the bootstrapping fails, then the SET may wait a little while before re-attempting the TLS handshake, in order to give the appropriate entities a chance to get back on-line.</p>
<p id="p-0183" num="0954">If the SLP supports only GBA or SEK, then the SLP is restricted to providing SUPL 3.0 services to subscribers of carriers that have deployed GBA or SEK. If the SLP supports only ACA, then SUPL 3.0 can only be used in circumstances discussed in detail in section 6.1.4. Note that in such a case, if the SET communicates via an alternative bearer (such as wireless LAN) for which the SLP cannot obtain IP binding, then the SLP will be unable to authenticate the SET.</p>
<p id="p-0184" num="0955">If the E-SLP supports only ACA, then there are caveats on SET authentication, as discussed in detail in section 6.2.5.</p>
<p id="p-0185" num="0956">6.1.3.2 Negotiating a Mutual-Authentication Method for Non-WiMAX SETs</p>
<p id="p-0186" num="0957">For non-WiMAX SETs, the negotiation of a mutual authentication method for SUPL sessions proceeds as follows:
<ul id="ul0214" list-style="none">
    <li id="ul0214-0001" num="0000">
    <ul id="ul0215" list-style="none">
        <li id="ul0215-0001" num="0958">1. The SET initiates negotiation
        <ul id="ul0216" list-style="none">
            <li id="ul0216-0001" num="0959">a. If the SET supports GBA, then the SET initiates negotiation according to the relevant GBA specifications.</li>
            <li id="ul0216-0002" num="0960">b. Otherwise (that is, if the SET does not support GBA) then the SET initiates a TLS handshake with a ClientHello message, with ClientHello.cipher_suites field indicating the supported TLS ciphersuites using RSA encryption for the TLS key exchange algorithm.</li>
        </ul>
        </li>
        <li id="ul0215-0002" num="0961">2. The SLP processes the received ClientHello message. The SLP examines the ClientHello.ciphersuites list and selects a mutually-supported ciphersuite.
        <ul id="ul0217" list-style="none">
            <li id="ul0217-0001" num="0962">a. If the SET and SLP both support a TLS-PSK ciphersuite, then this indicates support for GBA. The SLP responds with a ServerHello, ServerKeyExchange and ServerHelloDone message, with ServerHello.cipher_suite indicating a mutually-supported TLS-PSK ciphersuite.</li>
            <li id="ul0217-0002" num="0963">b. Otherwise, the SET and SLP must support a Certificate based method
            <ul id="ul0218" list-style="none">
                <li id="ul0218-0001" num="0964">i. If the SLP supports the DCert method, then the SLP responds with
                <ul id="ul0219" list-style="none">
                    <li id="ul0219-0001" num="0965">1. ServerHello with ServerHello.cipher_suite indicating a mutually-supported TLS ciphersuite using RSA encryption for the TLS key exchange algorithm,</li>
                    <li id="ul0219-0002" num="0966">2. Certificate,</li>
                    <li id="ul0219-0003" num="0967">3. CertificateRequest and</li>
                    <li id="ul0219-0004" num="0968">4. ServerHelloDone message.</li>
                </ul>
                </li>
                <li id="ul0218-0002" num="0969">ii. Otherwise, if the SET is a 3GPP/3GPP2 SET and the SLP supports the ACA method, then the SLP responds with
                <ul id="ul0220" list-style="none">
                    <li id="ul0220-0001" num="0970">1. ServerHello Certificate, with ServerHello.cipher_suite indicating a mutually-supported TLS ciphersuite using RSA encryption for the TLS key exchange algorithm.</li>
                    <li id="ul0220-0002" num="0971">2. Certificate,</li>
                    <li id="ul0220-0003" num="0972">3. (No CertificateRequest message is sent)</li>
                    <li id="ul0220-0004" num="0973">4. ServerHelloDone message</li>
                </ul>
                </li>
            </ul>
            </li>
        </ul>
        </li>
        <li id="ul0215-0003" num="0974">3. The SET processes ServerHello message and other messages appropriate to the selected indicates a ciphersuite to the SET
        <ul id="ul0221" list-style="none">
            <li id="ul0221-0001" num="0975">a. If ServerHello.cipher_suite indicates that GBA has been selected by the SLP, then the SET and SLP continue the GBA process. The details are outside the scope of this document.</li>
            <li id="ul0221-0002" num="0976">b. Otherwise, the ServerHello.cipher_suite indicates a mutually-supported TLS ciphersuite using RSA encryption for the TLS key exchange algorithm.
            <ul id="ul0222" list-style="none">
                <li id="ul0222-0001" num="0977">i. If the SET received a Certificate.Request then
                <ul id="ul0223" list-style="none">
                    <li id="ul0223-0001" num="0978">1. If the SET supports DCert method, then the SET provides a Device Certificate and the SET and Server complete the TLS handshake. The Server attempts to identify the SUPL User associated with the globally unique SET device identity in the Device Certificate. It is presumed that the SUPL User has already securely verified to the SLP that the SET device identity should be associated with their subscription.</li>
                    <li id="ul0223-0002" num="0979">&#x2003;a. If no SUPL User is identified, then the session must be terminated. Since we assume that the TLS handshake has already completed, the Server is capable of communicating at the ULP layer. The Server must send an appropriate ULP error message to terminate the ULP session and then close the TLS session.</li>
                    <li id="ul0223-0003" num="0980">&#x2003;b. If a SUPL User is identified, then the Server provides the SET with the same authorizations as the SUPL User.</li>
                    <li id="ul0223-0004" num="0981">2. Otherwise, the SET replies to the SLP, including an empty ClientCertificate message to implicitly indicate that it does not support the DCert method.</li>
                    <li id="ul0223-0005" num="0982">&#x2003;a. If the SLP supports the ACA, then the SLP and SET continues as per the ACA method. The SLP may continue using the ACA method</li>
                    <li id="ul0223-0006" num="0983">&#x2003;b. If the SLP does not support the ACA or SLP-only method (the SLP might have supported only the DCert method) then the SLP terminates the TLS handshake with the appropriate TLS alert message.</li>
                </ul>
                </li>
                <li id="ul0222-0002" num="0984">ii. If the Server does not send a Certificate.Request then the SET continues as per the ACA method. The SLP may continue using either the ACA method or SLP-only method.</li>
            </ul>
            </li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0187" num="0985">3GPP2 SETs MAY use a similar method for negotiation of the authentication method with selected differences.</p>
<p id="p-0188" num="0986">6.1.3.3 Principles for Authentication and Key Re-Negotiation for WiMAX SET and SLP (Informative)</p>
<p id="p-0189" num="0987">The key re-negotiation can happen in two ways:
<ul id="ul0224" list-style="none">
    <li id="ul0224-0001" num="0000">
    <ul id="ul0225" list-style="none">
        <li id="ul0225-0001" num="0988">1. when the Location Rootkey (as defined in WiMAX Network Protocols and Architecture for Location Based Services) expires the SET automatically re-authenticates itself with the wimax network and the SUPL associated root keys will be re-generated by the SET, or</li>
        <li id="ul0225-0002" num="0989">2. SLP notices that SEK or Location Rootkey (as defined in WiMAX Network Protocols and Architecture for Location Based Services) has expired and it will request a new key from the WiMAX AAA-server, or</li>
        <li id="ul0225-0003" num="0990">3. The SLP sends a &#x201c;psk_identity_unknown&#x201d; TLS alert message during the TLS handshake. This indicates to the SET that the SET needs to re-authenticates itself with the wimax network and the SUPL associated root keys will be re-generated by the SET.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0190" num="0991">6.1.3.3.1 Authentication procedure</p>
<p id="p-0191" num="0992">In WiMAX deployments, the PSK TLS handshake may be used with SEK as follows:
<ul id="ul0226" list-style="none">
    <li id="ul0226-0001" num="0000">
    <ul id="ul0227" list-style="none">
        <li id="ul0227-0001" num="0993">the ClientHello message may contain one or more PSK-based ciphersuites;</li>
        <li id="ul0227-0002" num="0994">the ClientHello message may contain the server_name TLS extension as specified in and it may contain the hostname of the SLP;</li>
        <li id="ul0227-0003" num="0995">the ServerHello message may contain a PSK-based ciphersuite selected by the SLP;</li>
        <li id="ul0227-0004" num="0996">the ServerKeyExchange may be sent by the server and it may contain the psk_identity_hint field and it may contain the static string &#x201c;SUPL WIMAX bootstrapping&#x201d;</li>
        <li id="ul0227-0005" num="0997">the ClientKeyExchange may contain the psk_identity field and it may contain a prefix &#x201c;SUPL WIMAX bootstrapping&#x201d;, a separator character &#x201c;;&#x201d; and the current B-TID as specified in section 6.1.2.1.2;</li>
        <li id="ul0227-0006" num="0998">the SET may derive the TLS premaster secret from the SLP specific key material i.e. SEK.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0192" num="0999">6.1.3.3.2 Authentication Failures</p>
<p id="p-0193" num="1000">Authentication failures may be handled as described in document(s) outside the scope of this document.</p>
<p id="p-0194" num="1001">6.1.3.3.3 Bootstrapping required indication</p>
<p id="p-0195" num="1002">During TLS handshake, the SLP may indicate to the SET that the SEK key may be required by sending a ServerHello message containing a PSK-based ciphersuite, and a ServerKeyExchange message containing the psk_identity_hint field, which contains a static string &#x201c;SUPL WIMAX bootstrapping&#x201d;. If the SET does not have a valid SEK this may trigger the SET to derive a new SEK as defined in section 6.1.2.1.2.</p>
<p id="p-0196" num="1003">6.1.3.3.4 Bootstrapping Renegotiation Indication</p>
<p id="p-0197" num="1004">During usage of TLS session, the SLP may indicate to the SET that SEK has expired by sending close_notify alert message to the SET. If the SET attempts to resume the old TLS session by sending a ClientHello message containing the old session ID. The SLP may refuse to use the old session ID by sending a ServerHello message with a new session ID. This will indicate to the SET that the SEK it used has expired.</p>
<p id="p-0198" num="1005">During TLS handshake, the SLP may indicate to the SET that the SEK has expired by sending handshake_failure message as a response to the finished message sent by the SET. This will indicate to the SET that the SEK it used has expired.</p>
<p id="p-0199" num="1006">6.1.4 Alternative Client Authentication (ACA) Mechanisms</p>
<p id="p-0200" num="1007">This section applies only to deployments supporting GSM/UMTS and CDMA SETs.</p>
<p id="p-0201" num="1008">NOTE: Throughout this section, SET JD refers to either the MSISDN (if the SET is on a 3GPP bearer network) or one of the MDN, MIN or IMSI (if the SET is on a 3GPP2 bearer network).</p>
<p id="p-0202" num="1009">Section 6.1.3 outlines the circumstances under which the ACA-based method may be selected by the SLP. If the SLP selects the ACA-method during the TLS handshake, then an SET_ID/IP Address Mapping based client authentication MAY be used by the SLPs to authenticate the SET. The rest of this section describes the details of this mechanism, known as the Alternative Client Authentication mechanism. If an SLP implements the Alternative Client Authentication mechanism, then the SLP is recommended to implement the method using PSK-TLS with GBA as well.</p>
<p id="p-0203" num="1010">Section 6.1.1.3 describes which entities must support the ACA-based method, and the algorithms that must be supported by an entity that supports ACA-based method. For informative purposes, this information is repeated here:
<ul id="ul0228" list-style="none">
    <li id="ul0228-0001" num="0000">
    <ul id="ul0229" list-style="none">
        <li id="ul0229-0001" num="1011">A bearer network may support the ACA-based method. A bearer network must support the ACA-based method if a H-SLP wishes to support the ACA-based method for the bearer network's subscribers.</li>
        <li id="ul0229-0002" num="1012">An SLP MAY support the ACA-based method.</li>
        <li id="ul0229-0003" num="1013">GSM/UMTS and CDMA SET handsets MUST support the ACA-based method.</li>
        <li id="ul0229-0004" num="1014">The ACA-based method does not involve the SET UICC/UIM/SIM/USIM.</li>
        <li id="ul0229-0005" num="1015">The ACA-based method does not involve SPC entities.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0204" num="1016">SETs that support Alternative Client Authentication MUST also support TLS 1.1 with certificate-based server (SLP) authentication. In addition, the SET MUST be provisioned with a root certificate enabling it to verify SLP server certificates. As various different methods exist for provisioning of root certificates to SETs no particular mechanism is defined by this specification. SUPL operators need to ensure that when TLS 1.1 is used for Alternative Client Authentication the relevant root certificates exist in the SET.</p>
<p id="p-0205" num="1017">SLPs that support Alternative Client Authentication MUST support TLS 1.1 and MUST have a valid TLS Server Certificate, which can be verified by the SETs that implement Alternative Client Authentication.</p>
<p id="p-0206" num="1018">The Alternative Client Authentication (ACA) mechanism is a mechanism where the SLP can check the binding of the SET's IP address to the SET_ID assigned to the SET. If the ACA mechanism is implemented, then the SLP MUST be able to map the source IP address of a SUPL message received from the SET to the SET_ID used by the SLP to address the SET. In order for an SLP to use the ACA mechanism, the bearer network MUST prevent IP Address Spoofing at the bearer level. A successful mapping between the source IP address and the SET's SET_ID would imply that the SET is securely identified (i.e., authenticated) on the bearer network. This solution does not require any specific client (SET) authentication implementation on the SET but requires the SLP to support acquiring the correct source IP address for a particular SET_ID from the bearer.</p>
<p id="p-0207" num="1019">3GPP-Bearer-Specific issues: The acquisition of the source IP address will not be possible in all cases&#x2014;e.g. for GPRS roaming access using a GGSN in the visited rather than home network. Therefore, the alternative client authentication mechanism should only be relied on when the home network assigns the source IP address or has access to it&#x2014;e.g. as applies for GPRS access when the SET may be required to use a GGSN in the home network.</p>
<p id="p-0208" num="1020">3GPP2-Bearer-Specific issues: The acquisition of the source IP address will not be possible in all cases&#x2014;e.g. for roaming HRPD access using simple IP or MIP access within the visited network. Therefore, the alternative client authentication mechanism should only be relied on when the home network assigns the source IP address or has access to it&#x2014;e.g. as applies for HRPD access when the SET may be required to use MIP to an HA in the home network.</p>
<p id="p-0209" num="1021">Section 6.1.4.1 describes how this mechanism is used for client authentication in SUPL 3.0.</p>
<p id="p-0210" num="1022">In the case that UDP/IP is used to transfer a SUPL INIT, SLP MAY first verify the IP address by querying the bearer network for the SET IP address using the SET_ID or by querying the bearer network for the SET_ID using the IP address.</p>
<p id="p-0211" num="1023">6.1.4.1 ACA Procedures</p>
<p id="p-0212" num="1024">Network-Initiated Scenarios: If, after receiving a SUPL INIT message from the SLP (and after applying the appropriate security mechanisms and notification/verification as described elsewhere in this document), the SET is authorized to continue with the corresponding SUPL sessions, then an existing, open mutually-authenticated TLS session SHOULD be used, or a previous resumable TLS session MAY be resumed as discussed in section 6.1.1.4. If there is no open TLS session, or the SET or SLP choose not to resume a session, then the SET and SLP require a fresh TLS session, and the SET and SLP perform the appropriate steps as described in section 6.1.3 for negotiating an authentication method.</p>
<p id="p-0213" num="1025">The following steps are used by the SLP when the Alternative Client Authentication Mechanism is to be applied for authenticating the SET in a Network-initiated scenario:
<ul id="ul0230" list-style="none">
    <li id="ul0230-0001" num="0000">
    <ul id="ul0231" list-style="none">
        <li id="ul0231-0001" num="1026">1. Note that the SUPL INIT message was sent in response to an MLP request that supplied a SET_ID. The SLP assigns a SLP Session ID for the MLP request and sends a SUPL INIT. The SLP associates the response from the SET with the request from the MLP using the SLP Session ID. However, the SLP must first verify that the responding SET corresponds to the correct SET_ID. The remaining steps describe this authentication process.</li>
        <li id="ul0231-0002" num="1027">2. The SET establishes a TLS 1.1 session with the SLP. The SET MUST check that the TLS server certificate presented by the SLP is bound to the FQDN of the SLP configured in the SET.</li>
        <li id="ul0231-0003" num="1028">3. The SLP determines if the SLP Session ID in the first SUPL message from the SET (in response to SUPL INIT) corresponds to a currently valid SLP Session ID assigned by the SLP. If the SLP Session ID in the first SUPL message does not correspond to a valid SLP Session ID, then the SLP ends the SUPL Session with the appropriate message. Otherwise, the SLP notes the corresponding SET ID.</li>
        <li id="ul0231-0004" num="1029">4. Prior to responding to the first SUPL Message from the SET (SUPL POS INIT, SUPL START, SUPL AUTH REQUEST, SUPL TRIGGERED START, SUPL REPORT or SUPL END), the SLP MUST verify the SET_ID of the SET. There are two methods for achieving this.
        <ul id="ul0232" list-style="none">
            <li id="ul0232-0001" num="1030">a. Requesting the SET_ID.
            <ul id="ul0233" list-style="none">
                <li id="ul0233-0001" num="1031">i. The SLP queries the underlying bearer network to find out the current SET_ID using the source IP address used by the SET.
                <ul id="ul0234" list-style="none">
                    <li id="ul0234-0001" num="1032">1. If a valid SET_ID is returned from the bearer for the source IP address of the first SUPL message sent by the SET then the SLP checks that the returned SET_ID is internally associated with the correct SET_ID (see Step 3). If this check fails, then the SLP ends the SUPL session with the appropriate message. Otherwise, the SET is considered authentic, and the SLP continues with the SUPL session.</li>
                    <li id="ul0234-0002" num="1033">2. If a valid SET_ID cannot be found, then the SLP MUST terminate the SUPL session with the relevant SUPL error messages.</li>
                </ul>
                </li>
            </ul>
            </li>
            <li id="ul0232-0002" num="1034">b. Requesting the IP address.
            <ul id="ul0235" list-style="none">
                <li id="ul0235-0001" num="1035">i. The SLP queries the underlying bearer network to find out the source IP address being used by the SET associated with this SET_ID (see Step 3).
                <ul id="ul0236" list-style="none">
                    <li id="ul0236-0001" num="1036">1. If the bearer network returns an IP address, then the SLP checks that this IP address corresponds to the Source IP address of the first SUPL message. If this check fails, then the SLP ends the SUPL session with the appropriate SUPL message. Otherwise, the SET is considered authentic and the SLP continues with the SUPL session.</li>
                    <li id="ul0236-0002" num="1037">2. If an IP address cannot be found, then the SLP MUST terminate the SUPL session with the relevant SUPL error messages.</li>
                </ul>
                </li>
            </ul>
            </li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0214" num="1038">NOTE: a bearer network might support only one of the two types of query (requesting IP address or requesting SET_ID) in Step 4 for obtaining an SET_ID/IP address binding. The SLP is responsible for conforming with the method supported by the bearer network.</p>
<p id="p-0215" num="1039">SET-Initiated Scenarios: When the SET wishes to initiate a SUPL session, an existing, open mutually-authenticated TLS session SHOULD be used, or a previous resumable TLS session MAY be resumed as discussed in section 6.1.1.4. If there is no open TLS session, or the SET or SLP chooses not to resume a session, then the SET and SLP require a fresh TLS session, and the SET and SLP perform the appropriate steps as described in section 6.1.3 for negotiating an authentication method.</p>
<p id="p-0216" num="1040">The following steps are used by the SLP when the Alternative Client Authentication Mechanism is to be applied for authenticating the SET in a SET-initiated scenario.
<ul id="ul0237" list-style="none">
    <li id="ul0237-0001" num="0000">
    <ul id="ul0238" list-style="none">
        <li id="ul0238-0001" num="1041">1. The SET establishes a TLS 1.1 session with the SLP. The SET MUST check that the TLS server certificate presented by the SLP is bound to the FQDN of the SLP configured in the SET.</li>
        <li id="ul0238-0002" num="1042">2. Prior to responding to the first SUPL Message (e.g. SUPL START, SUPL TRIGGERED START), the SLP MUST verify the SET_ID of the SET. There are two methods for achieving this.
        <ul id="ul0239" list-style="none">
            <li id="ul0239-0001" num="1043">a. Requesting the SET_ID.
            <ul id="ul0240" list-style="none">
                <li id="ul0240-0001" num="1044">i. The SLP queries the underlying bearer network to find out the current SET_ID using the source IP address used by the SET.
                <ul id="ul0241" list-style="none">
                    <li id="ul0241-0001" num="1045">1. If a valid SET_ID is returned from the bearer for the source IP address of the first SUPL message sent by the SET then the SLP checks that the returned SET_ID is same as provided by the SET. If this check fails, then the SLP ends the SUPL session with the appropriate message. Otherwise, the SET is considered authentic, and the SLP continues with the SUPL session.</li>
                    <li id="ul0241-0002" num="1046">2. If a valid SET_ID cannot be found the SLP MUST terminate the SUPL session with the relevant SUPL error messages.</li>
                </ul>
                </li>
            </ul>
            </li>
            <li id="ul0239-0002" num="1047">b. Requesting the IP address.
            <ul id="ul0242" list-style="none">
                <li id="ul0242-0001" num="1048">i. The SLP queries the underlying bearer network to find out the source IP address being used by the SET associated with this SET_ID.
                <ul id="ul0243" list-style="none">
                    <li id="ul0243-0001" num="1049">1. If the bearer network returns an IP address, then the SLP checks that this IP address corresponds to the Source IP address of the first SUPL message. If this check fails, then the SLP ends the SUPL session with the appropriate message. Otherwise, the SET is considered authentic and the SLP continues with the SUPL session.</li>
                    <li id="ul0243-0002" num="1050">2. If an IP address cannot be found the SLP MUST terminate the SUPL session with the relevant SUPL error messages.</li>
                </ul>
                </li>
            </ul>
            </li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0217" num="1051">NOTE: In both the SLP-Initiated and SET-Initiated scenarios, the SLP can re-authenticate the SET by sending an appropriate query to the bearer network to bind the SET_ID to the source IP address currently in use. There are various circumstances where this could be useful, for example: (A) if the IP address of the SET changes during a TLS session, then the SLP can send the appropriate query to the bearer network to ensure that the SET_ID is associated with the new IP address; (B) when resuming a TLS session, the SLP can re-use a previous TLS session as discussed in section 6.1.1.4, thereby saving computation, and simply send the appropriate query to the bearer network to authenticate the SET. Note that re-authenticating the SET in this manner does not involve interaction with the SET itself</p>
<p id="p-0218" num="1052">6.2 Authentication Mechanisms Applicable to an E-SLP</p>
<p id="p-0219" num="1053">6.2.1 Regarding Emergency-Services Regulatory Bodies</p>
<p id="p-0220" num="1054">SUPL 3.0 emergency SUPL session may be either Network-Initiated (using SUPL) or SET Initiated. The appropriate emergency services regulatory bodies will dictate support for these emergency sessions:
<ul id="ul0244" list-style="none">
    <li id="ul0244-0001" num="0000">
    <ul id="ul0245" list-style="none">
        <li id="ul0245-0001" num="1055">The appropriate emergency services regulatory bodies may not dictate support for either Network-Initiated or SET-Initiated sessions;</li>
        <li id="ul0245-0002" num="1056">The appropriate emergency services regulatory bodies may dictate only Network-Initiated sessions;</li>
        <li id="ul0245-0003" num="1057">The appropriate emergency services regulatory bodies may dictate only SET-Initiated sessions;</li>
        <li id="ul0245-0004" num="1058">The appropriate emergency services regulatory bodies may dictate support for both Network-Initiated and SET-Initiated sessions.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0221" num="1059">6.2.2 Prioritization of SUPL Resources During Emergency Sessions</p>
<p id="p-0222" num="1060">For the duration of an emergency SUPL session on a SET, all SUPL resources on the SET MUST be made available for that emergency session. Consequently:
<ul id="ul0246" list-style="none">
    <li id="ul0246-0001" num="0000">
    <ul id="ul0247" list-style="none">
        <li id="ul0247-0001" num="1061">When a SET begins an emergency SUPL session, any SUPL communication related to non-emergency sessions MUST be terminated immediately by the SET. If non-emergency SUPL INIT messages are being processed by the SET at this time (e.g. having MAC verified or obtaining user permission), then those processes MAY be aborted and the SUPL INIT messages MAY be discarded.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0223" num="1062">If a SET receives non-emergency SUPL INIT message(s) while in emergency SUPL session, these SUPL INIT message(s) MAY be discarded.</p>
<p id="p-0224" num="1063">6.2.3 E-SLP FQDN</p>
<p id="p-0225" num="1064">In Network-Initiated emergency SUPL sessions, the FQDN of the E-SLP may be:
<ul id="ul0248" list-style="none">
    <li id="ul0248-0001" num="0000">
    <ul id="ul0249" list-style="none">
        <li id="ul0249-0001" num="1065">1. The FQDN provided to the SET as E-SLP address in the SUPL INIT. The E-SLP FQDN may have format &#x201c;e-slp.xxx.xxx.xxx.xxx.xxx&#x201d; where &#x201c;xxx&#x201d; can be any valid string.</li>
        <li id="ul0249-0002" num="1066">2. If FQDN is not provided in SUPL INIT, the provisioned H-SLP address may be used.</li>
        <li id="ul0249-0003" num="1067">3. If FQDN is not available as per 1 or 2 above, the FQDN may be defaulted to one of the three alternatives below:
        <ul id="ul0250" list-style="none">
            <li id="ul0250-0001" num="1068">(if connected to a 3GPP bearer network) &#x201c;e-slp.mnc&#x3c;MNC&#x3e;.mcc&#x3c;MCC&#x3e;.pub.3gppnetwork.org&#x201d; if no FQDN is explicitly provided. In this case, the MCC and MNC correspond to the serving 3GPP network.</li>
            <li id="ul0250-0002" num="1069">(if connected to a 3GPP2 bearer network) &#x201c;e-slp.mnc&#x3c;MNC&#x3e;.mcc&#x3c;MCC&#x3e;.pub.3gpp2network.org&#x201d; if no FQDN is explicitly provided. In this case, the MCC and MNC correspond to the serving 3GPP2 network.</li>
            <li id="ul0250-0003" num="1070">(if connected to a WiMAX bearer network) &#x201c;e-slp.operator.com&#x201d; where operator.com is the FQDN of the H-SLP operator.</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0226" num="1071">In SET-Initiated emergency SUPL sessions, the FQDN of the E-SLP may be in order of preference:
<ul id="ul0251" list-style="none">
    <li id="ul0251-0001" num="0000">
    <ul id="ul0252" list-style="none">
        <li id="ul0252-0001" num="1072">1. (If applicable) the FQDN dictated by the appropriate emergency services regulatory bodies.</li>
        <li id="ul0252-0002" num="1073">2. An FQDN provided by the local access network or by other means that is verified by the H-SLP</li>
        <li id="ul0252-0003" num="1074">3. An FQDN provided by the H-SLP</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0227" num="1075">6.2.4 Processing Emergency SUPL INIT Messages</p>
<p id="p-0228" num="1076">SET based integrity verification and message origin authentication of SUPL INIT messages is not used by an E-SLP. Thus, the MAC field in an emergency SUPL INIT MUST NOT be populated.</p>
<p id="p-0229" num="1077">During an emergency call, a SET MAY NOT apply end-to-end protection of emergency SUPL INIT messages.</p>
<p id="p-0230" num="1078">Some protection is offered by the use of E-SLP whitelists. The E-SLP whitelist is based on the current position estimate of the SET (such as CellID and/or NetworkID). The E-SLP whitelist is used by a SET to determine the order in which the SET should process received emergency SUPL INIT messages: the E-SLP whitelist MAY NOT be used for discarding emergency SUPL INIT messages.</p>
<p id="p-0231" num="1079">6.2.4.1 E-SLP Whitelist</p>
<p id="p-0232" num="1080">If an emergency SUPL INIT message is received over a channel that is not secured end-to-end (such as SMS or OMA Push or UDP/IP) then the emergency SUPL INIT message may be fake or altered. The remainder of this section describes the security countermeasures used to ensure that the SET is able to contact the genuine E-SLP server as soon as possible.</p>
<p id="p-0233" num="1081">NOTE: regulatory requirements will dictate the conditions under which the SET should accept and process emergency SUPL INIT messages. For example, in many cases, the regulatory requirements only require the SET to accept and process emergency SUPL INIT messages if the SET is currently engaged in an emergency call. Consequently, the conditions (under which the SET should accept and process emergency SUPL INIT messages) are outside the scope of this document.</p>
<p id="p-0234" num="1082">When a SET receives an emergency SUPL INIT message, the SET MUST first verify that the conditions (under which the SET should accept emergency SUPL INIT messages) are currently satisfied. If the conditions are not satisfied, then the SET MAY ignore the SUPL INIT message. The description from hereon assumes that the conditions were satisfied when the SET received the emergency SUPL INIT message.</p>
<p id="p-0235" num="1083">NOTE: Attackers could send multiple (fake) emergency messages to the SET at the same time that the SET is expecting a genuine emergency SUPL INIT message. There may be cases where the SET could not be told (in advance) from which Emergency SLP to expect the emergency SUPL INIT message. This attack is motivation for the following procedures.</p>
<p id="p-0236" num="1084">For the period of time that the &#x201c;accept and process&#x201d; conditions are satisfied, the SET MUST NOT delete received emergency SUPL INIT messages even if the emergency SUPL INIT message lists an un-expected address for the E-SLP. Once the SET determines that the conditions are no longer satisfied (for example, once the correct E-SLP has been contacted, or sufficient time has passed after the emergency call) then the SET MUST silently discard any received emergency SUPL INIT messages.</p>
<p id="p-0237" num="1085">If the SET receives, accepts and processes a fake emergency SUPL INIT message (while the &#x201c;accept and process&#x201d; conditions are still satisfied), then the SET might not receive an indication that emergency SUPL INIT message is fake until after attempting to contact the E-SLP indicated in the emergency SUPL INIT message. The indication occurs when the E-SLP rejects the SUPL session. This process is not immediate, so it may be necessary for the SET to queue emergency SUPL INIT messages if it receives more than one emergency SUPL INIT message.</p>
<p id="p-0238" num="1086">An E-SLP whitelist contains a list of E-SLP FQDNs that the SET could expect to receive emergency SUPL INIT messages from. The SET uses the E-SLP whitelist to ensure that emergency SUPL INIT messages including an E-SLP FQDN that is on the whitelist SHOULD be processed before emergency SUPL INIT messages including an E-SLP FQDN that is not on the whitelist.</p>
<p id="p-0239" num="1087">Example: Emergency SUPL INIT messages containing an E-SLP FQDN on the whitelist are pushed forward on the emergency SUPL INIT queue to ensure that the message is processed before emergency SUPL INIT messages containing an E-SLP FQDN that is not on the whitelist. E-SLP Whitelisting should be the first criteria for ordering the Emergency SUPL INIT queue. The second criteria is the arrival time, using the first-in first-out principle:
<ul id="ul0253" list-style="none">
    <li id="ul0253-0001" num="0000">
    <ul id="ul0254" list-style="none">
        <li id="ul0254-0001" num="1088">If the SET has a current E-SLP whitelist for the SET's current locality, then the SET uses both criteria to order the queue.</li>
        <li id="ul0254-0002" num="1089">If the SET does not have a current E-SLP whitelist for the SET's current locality, then the SET uses the first-in-first-out principle to order the queue.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0240" num="1090">6.2.4.3 Procedures Regarding Emergency SUPL INIT Messages</p>
<p id="p-0241" num="1091">If an emergency SUPL INIT is received over a channel that is secured end-to-end (such as a secure SIP Push) then the emergency SUPL INIT message MAY be processed immediately. The remaining considerations of this subsection are ignored in this case.</p>
<p id="p-0242" num="1092">If an emergency SUPL INIT message is received over a channel that is not secured end-to-end (such as SMS or OMA Push or UDP/IP), then the message is queued as in section 6.2.4.1. The SET works its way through the messages in the queue, applying the appropriate verification and notification before attempting to connect to the E-SLP to respond.</p>
<p id="p-0243" num="1093">In responding to the SUPL INIT message, the SET may establish a secure TLS session (see sections 6.2.5) with the associated E-SLP (see section 6.2.3), and one of the following takes place:
<ul id="ul0255" list-style="none">
    <li id="ul0255-0001" num="0000">
    <ul id="ul0256" list-style="none">
        <li id="ul0256-0001" num="1094">If, after authenticating the SET (See section 6.2.5), the E-SLP cannot associate the SET with any outstanding SUPL sessions, then the E-SLP MAY end the session. If the TLS Handshake is not yet complete, then the E-SLP SHOULD end the session using a TLS error message, in order to save un-necessary computation. If the TLS handshake is complete, then the E-SLP MAY end the session using a SUPL error message indicating that the SET is not authorized. The SET MAY interpret either form of error message as indication that the SUPL INIT message was fraudulent. The SET then processed to the next SUPL INIT message in order of priority in the queue.</li>
        <li id="ul0256-0002" num="1095">If, after authenticating the SET (See section 6.2.5), the E-SLP can associate the SET with an outstanding SUPL session, then the SET and E-SLP continue as normal.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0244" num="1096">The SET continues responding to emergency SUPL INIT messages until the genuine message is found. The SET MAY discard any new or queued SUPL INIT messages once the correct E-SLP has been identified. New or queued SUPL INIT messages from the correct E-SLP may still be processed.</p>
<p id="p-0245" num="1097">The following two notes are suggestions that regulatory bodies may wish to consider.</p>
<p id="p-0246" num="1098">NOTE: Once the correct E-SLP has been identified, then the SET should ensure that it remembers the FQDN of this correct E-SLP until the SUPL session successfully completes. If the TLS session with the E-SLP ends prematurely (for example, if there is a loss of data connectivity), the SET should continue attempting to re-establish a TLS session with the E-SLP until the TLS session is re-established so that the SUPL session can continue to successful completion. In some circumstances, it is conceivable that the SET re-establishes the TLS session several times. If the SET is not having success at restablishing the TLS session, the SET should continue attempting regardless: since this is an emergency situation, the benefit of success outweighs the cost of a flat battery.</p>
<p id="p-0247" num="1099">NOTE: If the E-SLP loses contact with SET after authentication, but prior to successful completion of the SUPL session, then the E-SLP SHOULD leave the SUPL session open with the hope that the SET is able to re-establish contact and complete the SUPL session.</p>
<p id="p-0248" num="1100">6.2.5 Authentication for Emergency Sessions</p>
<p id="p-0249" num="1101">NOTE: the mutual-authentication methods that may be supported by an E-SLP are specified in section 6.1.1.3. The SET and E-SLP negotiate the mutual-authentication method during the TLS handshake, as specified in section 6.1.3.</p>
<p id="p-0250" num="1102">The order of preference for emergency sessions is
<ul id="ul0257" list-style="none">
    <li id="ul0257-0001" num="0000">
    <ul id="ul0258" list-style="none">
        <li id="ul0258-0001" num="1103">GBA or SEK method: first preference</li>
        <li id="ul0258-0002" num="1104">DCert method: second preference</li>
        <li id="ul0258-0003" num="1105">ACA method: third preference</li>
        <li id="ul0258-0004" num="1106">SLP-only method: last preference. The SLP-only method should be seen as a last resort.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0251" num="1107">The FQDN of the E-SLP for all these cases is discussed in section 6.2.3.</p>
<p id="p-0252" num="1108">GBA-Based Method (3GPP/3GPP2 SETs only): SETs and E-SLPs MAY perform PSK-TLS with GBA as described in section 6.1.3 with the E-SLP acting as the NAF. The Ks_NAF obtained by an E-SLP for a particular SET may be retained in association with the SET identity (e.g. IMSI, MSISDN) for the lifetime set by the home network operator.</p>
<p id="p-0253" num="1109">SEK Based Method (WiMAX SETs only): SET and E-SLPs MAY perform mutual authentication using PSK-TLS with SEK as described in section 6.1.3 with the E-SLP acting in the similar fashion as H-SLP. The FQDN of the E-SLP is discussed in section 6.2.3. The SEK obtained by an E-SLP for a particular SET may be retained in association with the SET identity (e.g. WiMAX user ID) for the lifetime set by the home network operator.</p>
<p id="p-0254" num="1110">DCert Method (All SETs): SET and E-SLPs MAY perform mutual authentication using the DCert method as described in section 6.1.2.2.1. The SET MAY authenticate the E-SLP using a root certificate of the E-SLP contained in the SET and the FQDN of the E-SLP as defined in section 6.2.3.</p>
<p id="p-0255" num="1111">ACA-Based Method (3GPP/3GPP2 SETs only while on corresponding bearer networks): For SUPL 3.0 implementations where both GBA with PSK-TLS and the DCert method ARE NOT supported in the E-SLP, the alternative client authentication mechanism defined in section 6.1.4 MAY be supported with the following differences. The E-SLP MAY authenticate the SET by binding the IP address used by the SET with the IP address for the SET provided to the E-SLP by the serving network&#x2014;e.g. by the LRF or E-CSCF in a 3GPP network, or in a 3GPP2 network.
<ul id="ul0259" list-style="none">
    <li id="ul0259-0001" num="0000">
    <ul id="ul0260" list-style="none">
        <li id="ul0260-0001" num="1112">Network-Initiated Sessions: Since the SET IP address is used to initiate any emergency VoIP call and can be verified by the serving network before SUPL is invoked, it may be considered to be reliable by the E-SLP. In the case of an emergency call initiated in circuit mode, the SET IP address may not be known to the serving network (e.g. may be assigned by the home network) in which case the E-SLP cannot be provided with the IP address by the serving network and cannot verify the IP address when received later from the SET.</li>
        <li id="ul0260-0002" num="1113">SET-Initiated Sessions: In order to use the ACA method, the serving bearer network MUST prevent IP Address Spoofing at the bearer level. It should be noted that the ACA method can be applied even whether or not the SET is registered an authenticated on the bearer network. This supports cases where there is no activated SIM/USIM/UICC/(R)UIM present in the SET.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0256" num="1114">SLP-Only Method (All SETS): If no other authentication method can be used, then the SET MAY establish a secure IP connection to an E-SLP using the SLP-only method. The SET MAY authenticate the E-SLP using a root certificate of the E-SLP contained in the SET and the FQDN of the E-SLP as defined in section 6.2.3. The ability to perform mutual authentication depends on where the session was SET initiated or Network-Initiated
<ul id="ul0261" list-style="none">
    <li id="ul0261-0001" num="0000">
    <ul id="ul0262" list-style="none">
        <li id="ul0262-0001" num="1115">Network Initiated Sessions: If the SUPL Session is Network Initiated, then the E-SLP can weakly authenticate the SET based on (e.g.) the session ID and the received hash of the SUPL INIT as discussed in section 6.2.6.</li>
        <li id="ul0262-0002" num="1116">SET Initiated Sessions: If the SUPL Session is SET Initiated</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0257" num="1117">It should be noted that the SLP-only method can be applied even whether or not the SET is registered an authenticated on the bearer network. This supports cases where there is no activated SIM/USIM/UICC/(R)UIM present in the SET.</p>
<p id="p-0258" num="1118">6.2.6 Integrity Protection of SUPL INIT for Emergency SUPL Sessions</p>
<p id="p-0259" num="1119">If the E-SLP is able to authenticate the SET as discussed in section 6.2.5, and the E-SLP can associate the SET with an outstanding SUPL sessions, then the E-SLP checks if the SUPL INIT message was altered. If the E-SLP detects that the SUPL INIT message was altered (for example, if a SUPL AUTH REQ message was received when Proxy mode was indicated, or if SLP Session ID is wrong or if VER fails verification as described in section 6.3.1) then the E-SLP MUST send SUPL INIT to the SET over the TLS session to ensure that the SET is provided with the correct parameters. In response, the SET will discard the SUPL session initiated using the SUPL INIT it originally received, and the SET may begin a new SUPL session using the SUPL INIT received over the TLS session. The SET may then process that SUPL INIT message immediately (that is, the SET does not evaluate the priority using an E-SLP whitelist), performing the appropriate actions for notification and verification, and provided the User does not reject the session, the SET then sends the appropriate message (SUPL POS INIT or SUPL AUTH REQ) to the E-SLP to continue the session.</p>
<p id="p-0260" num="1120">The ability to resend SUPL INIT is only intended for emergency sessions. In non-emergency sessions, if alteration of SUPL INIT is detected, then the SLP may end the SUPL session using SUPL END, as specified in the non-emergency call flows.</p>
<p id="p-0261" num="1121">6.3 Processing of the SUPL INIT Messages</p>
<p id="p-0262" num="1122">As network initiated SUPL sessions are triggered by a SUPL INIT message, it is essential to protect SUPL INIT messages against masquerading and (in some cases) against re-play attacks.</p>
<p id="p-0263" num="1123">SUPL 3.0 specifies the following protection for SUPL INIT messages:
<ul id="ul0263" list-style="none">
    <li id="ul0263-0001" num="0000">
    <ul id="ul0264" list-style="none">
        <li id="ul0264-0001" num="1124">Network-based security, in which the SLP may perform checks to ensure authentication (section 6.3.1) and replay protection (section 6.3.2) of SUPL INIT messages. This verification occurs after the SET has processed the content of the SUPL INIT message and established a secure TLS session with the SLP for the purposes of performing the SUPL session.</li>
        <li id="ul0264-0002" num="1125">End-to-End security, in which: the SLP may apply a combination of encryption, integrity protection and replay protection to the SUPL INIT message; and the SET applies the corresponding combination of decryption, integrity verification and replay detection. The SET applies these security measures before processing the content of the SUPL INIT message. This security is applied only to non-emergency SUPL INIT messages.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0264" num="1126">Network-based security is mandatory, while End-to-End security is optional.</p>
<p id="p-0265" num="1127">6.3.1 Network-Based Authentication of the SUPL INIT Message</p>
<p id="p-0266" num="1128">The SLP always performs network verification of the integrity of the SUPL INIT message. The first message sent in response to the SUPL INIT message (that is, a SUPL POS INIT, SUPL AUTH REQ or SUPL TRIGGERED START message) MUST contain a verification field (VER). When the SLP receives the first message sent in response to the SUPL INIT message the SLP MUST check the received VER field against the corresponding value calculated over the transmitted SUPL INIT message. If this verification fails the SLP MUST terminate the session with the SUPL END message that contains status code &#x2018;authSuplinitFailure&#x2019;.</p>
<p id="p-0267" num="1129">The value for the verification field MUST be calculated as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>VER=H</i>(<i>SLP XOR </i>opad, <i>H</i>(<i>SLP XOR </i>ipad, <i>SUPL INIT</i>))<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where SLP is the FQDN of the SLP address. SHA-256 MUST be used as the hash (H) function, with opad and ipad. The output of the SHA-256 HASH function MUST be truncated to 64 bits, i.e., the function MUST be implemented as HMAC-SHA256-64. Note that the SLP address is not considered secret. The HMAC construct used here does not provide any data authentication but is only used as an alternative to a HASH function.
</p>
<p id="p-0268" num="1130">6.3.2 Network-Based Re-Play Protection of SUPL INIT Message</p>
<p id="p-0269" num="1131">For Network Initiated cases, protection against re-play attacks MUST be provided by the SLPs. SLPs MUST ensure that no SUPL messages are accepted from an authenticated SET unless a previous, non-expired SUPL INIT message has been sent with an &#x201c;SLP Session Id&#x201d; that corresponds to the one received inside the SUPL message. SLPs MUST also ensure that the type of SUPL message (e.g. SUPL POS INIT, SUPL AUTH REQ, SUPL TRIGGERED START) agrees with the parameters sent in the SUPL INIT message. Implementations MUST ensure that an &#x201c;SLP Session Id&#x201d; is correctly associated with the SET User ID (e.g., MSISDN, WiMAX user ID or MDN) that has been authenticated.</p>
<p id="p-0270" num="1132">If the SET User authentication is performed using the Alternative Client Authentication method described in this document then a mapping between the source IP address of the response from the SET (SUPL POS INIT, SUPL AUTH REQ or SUPL TRIGGERED START) and the MSISDN or MDN of the SET User is already established and this MSISDN or MDN MUST be used as the authenticated MSISDN or MDN.</p>
<p id="p-0271" num="1133">Discarding of an erroneous SUPL POS INIT, SUPL AUTH REQ or SUPL TRIGGERED START MUST NOT generate a chargeable event for the SET.</p>
<p id="p-0272" num="1134">For Non-Proxy Network Initiated cases, SLPs MUST only create a chargeable event after receiving the confirmation from the SPC for the successful completion of the SUPL positioning.</p>
<p id="p-0273" num="1135">6.3.3 End-to-End Protection of SUPL INIT Messages</p>
<p id="p-0274" num="1136">NOTE: End-to-End Protection of SUPL INIT Messages applies only to non-emergency SUPL INIT messages.</p>
<p id="p-0275" num="1137">Three options of end-to-end SUPL INIT protection are provided for in this specification: Null, Mode A and Mode B&#x2014;
<ul id="ul0265" list-style="none">
    <li id="ul0265-0001" num="0000">
    <ul id="ul0266" list-style="none">
        <li id="ul0266-0001" num="1138">Null SUPL INIT protection provides no end-to-end integrity protection, no end-to-end replay protection and no confidentiality protection. The procedures for Null SUPL INIT protection are described in section 6.3.4.</li>
        <li id="ul0266-0002" num="1139">Mode A SUPL INIT protection provides end-to-end integrity protection and end-to-end replay protection using default algorithms. Mode A SUPL INIT protection uses a shared key sent to the SET by the SLP during a secured ULP Session. The procedures for Mode A SUPL INIT protection are described in section 6.3.5.</li>
        <li id="ul0266-0003" num="1140">Mode B SUPL INIT protection provides end-to-end integrity protection and end-to-end replay protection using default algorithms. Mode B SUPL INIT protection uses a shared key derived using the appropriate PSK-based Method (GBA or SEK methods). The procedures for Mode B SUPL INIT protection are described in section 6.3.6.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0276" num="1141">The order of preference for the level of protection is as follows:
<ul id="ul0267" list-style="none">
    <li id="ul0267-0001" num="0000">
    <ul id="ul0268" list-style="none">
        <li id="ul0268-0001" num="1142">Null SUPL INIT protection has least preference.</li>
        <li id="ul0268-0002" num="1143">Mode A SUPL INIT protection has higher preference than Null SUPL INIT protection.</li>
        <li id="ul0268-0003" num="1144">Mode B SUPL INIT protection has higher preference than Mode A SUPL INIT protection.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0277" num="1145">In a SUPL INIT message the Protection Level parameter (in the following table) is assigned according to the current level of protection.</p>
<p id="p-0278" num="1146">NOTE: this specification has been written to allow for more advanced levels of protection to be added in the future revisions. This advanced protection could allow the negotiation of other ways for securing SUPL INIT (for example, allowing encryption and allowing the negotiation of algorithms). The Protection Level parameter is included to aid the SET in determining whether it might be able to parse the SUPL INIT message or not: the Protection Level parameter may be required for extensibility.</p>
<p id="p-0279" num="1147">A SUPL INIT message may have a Protector parameter present for including security parameters: the presence of a Protector parameter is specified in the following table.</p>
<p id="p-0280" num="1148">
<tables id="TABLE-US-00013" num="00013">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="56pt" align="left"/>
<colspec colname="2" colwidth="105pt" align="left"/>
<colspec colname="3" colwidth="56pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry/>
<entry>Protector</entry>
</row>
<row>
<entry>Level of End-to-</entry>
<entry/>
<entry>parameter</entry>
</row>
<row>
<entry>End SUPL INIT</entry>
<entry/>
<entry>present in SUPL</entry>
</row>
<row>
<entry>Protection</entry>
<entry>Description</entry>
<entry>INIT?</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>Null</entry>
<entry>No end-to-end protection</entry>
<entry>Optional</entry>
</row>
<row>
<entry>Mode A</entry>
<entry>Integrity protection and replay</entry>
<entry>Mandatory</entry>
</row>
<row>
<entry/>
<entry>protection using default algorithms</entry>
</row>
<row>
<entry>Mode B</entry>
<entry>Integrity protection and replay</entry>
<entry>Mandatory</entry>
</row>
<row>
<entry/>
<entry>protection using default algorithms</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<heading id="h-0016" level="1">SUPL INIT Protection Level Parameter Values and Presence of the Protector Parameter in SUPL INIT</heading>
<p id="p-0281" num="1149">A SET or D-SLP or H-SLP that supports the ACA-based method MUST support Null SUPL INIT protection.</p>
<p id="p-0282" num="1150">All SETs must support Mode A SUPL INIT protection procedures.</p>
<p id="p-0283" num="1151">A D-SLP or H-SLP MAY support Mode A SUPL INIT protection procedures.</p>
<p id="p-0284" num="1152">A SET or D-SLP or H-SLP that supports the PSK-based method MUST support Mode B SUPL INIT protection procedures.</p>
<p id="p-0285" num="1153">The E-SLP entity is not involved in currently defined SUPL INIT protection.</p>
<p id="p-0286" num="1154">6.3.3.1 Negotiating the Level of SUPL INIT Protection</p>
<p id="p-0287" num="1155">The following processes apply only to SLP that are D-SLP and H-SLP; the processes do not apply to E-SLP.</p>
<p id="p-0288" num="1156">An informal description of how the SUPL INIT protection level is negotiated is as follows:
<ul id="ul0269" list-style="none">
    <li id="ul0269-0001" num="0000">
    <ul id="ul0270" list-style="none">
        <li id="ul0270-0001" num="1157">1. The SET must apply Null SUPL INIT protection when there is no valid SUPL_INIT_ROOT_KEY (e.g. at power-up or when the lifetime of the SUPL_INIT_ROOT_KEY has expired). The initial protection level is always Null SUPL INIT protection. In this state the SET handles all SUPL INIT messages, i.e. no messages are silently dropped. If a SUPL INIT message is parsed with a failure condition, the SET sends an error message to the SLP.</li>
        <li id="ul0270-0002" num="1158">2. If the SET has a valid SUPL_INIT_ROOT_KEY and valid ReplayCounter already negotiated using Mode A or Mode B SUPL INIT protection for a particular SLP, then the SET processes all SUPL INIT messages from that SLP using the negotiated mode (Mode A or Mode B).</li>
        <li id="ul0270-0003" num="1159">3. When the SET establishes a mutually-authenticated secure connection to the SLP,
        <ul id="ul0271" list-style="none">
            <li id="ul0271-0001" num="1160">a. If a PSK-based method (GBA or SEK) was used for mutual authentication, then Mode B SUPL INIT protection applies and the B-TID exchanged in the PSK-TLS handshake corresponds to the Ks (that will be used as a Ks_NAF in 3GPP and 3GPP2 deployments) or SEK that can be used to derive SUPL_INIT_ROOT_KEY that will be used as a Ks_NAF in 3GPP and 3GPP2 deployments. This Ks_NAF or SEK and the associated B-TID are used in the Mode B SUPL INIT protection until either:
            <ul id="ul0272" list-style="none">
                <li id="ul0272-0001" num="1161">i. the key expires, in which case the SET and SLP revert to Null SUPL INIT protection</li>
                <li id="ul0272-0002" num="1162">ii. the SET and SLP use the ACA-method in a non-emergency session, in which case the SET and SLP revert to either Mode A or Null SUPL INIT protection as discussed in step 3b below, or</li>
                <li id="ul0272-0003" num="1163">iii. the Set and H-SLP use GBA's or SEK's bootstrapping re-negotiation methods to establish TLS using a fresh B-TID, in which case the B-TID and corresponding Ks_NAF or SEK are now used for Mode B SUPL INIT protection.</li>
            </ul>
            </li>
            <li id="ul0271-0002" num="1164">b. Otherwise, the SET and SLP established a secure connection using the DCert or ACA method.
            <ul id="ul0273" list-style="none">
                <li id="ul0273-0001" num="1165">i. If the SET does not have a valid SUPL_INIT_ROOT_KEY, then the SET sends a SUPL_INIT_KeyRequest parameter to the SLP in the first ULP message.</li>
                <li id="ul0273-0002" num="1166">1. If the SLP support Mode A SUPL INIT protection, then the SLP responds by sending ModeAKeyIdentifier, TemporaryModeAKeyIdentifier, SUPL_INIT_ROOT_KEY and BasicReplayCounter parameters in the first ULP response to the SET. When the SET receives these parameters, then this indicates to the SET that Mode A SUPL INIT Protection applies.</li>
            </ul>
            </li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0289" num="1167">NOTE: The policy for updating SUPL_INIT_ROOT_KEY is a decision of the SLP Operator.
<ul id="ul0274" list-style="none">
    <li id="ul0274-0001" num="0000">
    <ul id="ul0275" list-style="none">
        <li id="ul0275-0001" num="1168">2. If the SLP does not support Mode A SUPL INIT protection (or does not support Mode A SUPL INIT protection at this particular time), then the SLP sends an indication to the SET (in a ULP message) that Null SUPL INIT Protection applies.</li>
        <li id="ul0275-0002" num="1169">ii. If the SET has a valid SUPL_INIT_ROOT_KEY, but does not have a valid TemporaryModeAKeyIdentifier or has lost synchronization regarding replay protection, then the SET sends a SUPL_INIT_ResynchRequest parameter to the SLP in the first ULP message.
        <ul id="ul0276" list-style="none">
            <li id="ul0276-0001" num="1170">1. If the SLP support Mode A SUPL INIT protection, then the SLP responds (in the first response to the SET) with a new TemporaryModeAKeyIdentifier using the procedure specified in section 6.3.6.1.1. When the SET receives this response, then this indicates to the SET that Mode A SUPL INIT Protection applies.</li>
            <li id="ul0276-0002" num="1171">2. If the SLP does not support Mode A SUPL INIT protection (or does not with to support Mode A SUPL INIT protection at this particular time), then the SLP sends an indication to the SET (in a ULP message) that Null SUPL INIT Protection applies.</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0290" num="1172">Note that this means that the protection level is renegotiated every time the SET sets up a fresh TLS connection to the H-SLP.</p>
<p id="p-0291" num="1173">6.3.3.2 Negotiation from the H-SLP Perspective</p>
<p id="p-0292" num="1174">If the most recent IP session with the SET was authenticated using the GBA or SEK method, and the H-SLP has a current B-TID and the associated key for the SET, then
<ul id="ul0277" list-style="none">
    <li id="ul0277-0001" num="0000">
    <ul id="ul0278" list-style="none">
        <li id="ul0278-0001" num="1175">If the B-TID is for a key obtained using GBA, then the H-SLP assigns SUPL_INIT_ROOT_KEY to be the Ks_(int/ext_)NAF corresponding to the most recent B-TID and generated as follows
        <ul id="ul0279" list-style="none">
            <li id="ul0279-0001" num="1176">The FQDN MAY be the H-SLP_FQDN</li>
            <li id="ul0279-0002" num="1177">The GBA Ua security protocol identifier that may be used for SUPL_INIT protection is defined in OMNA Registry.</li>
        </ul>
        </li>
        <li id="ul0278-0002" num="1178">If the B-TID is for a key derived using the SEK-method, then the SUPL_INIT_ROOT_KEY is the SEK as defined in 6.1.2.1.2.</li>
        <li id="ul0278-0003" num="1179">Assuming no other SUPL INIT protection has been negotiated, then the H-SLP assigns the Mode B SUPL INIT protection level for that SET.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0293" num="1180">Otherwise, if the H-SLP has a valid ModeAKeyIdentifier and associated key for the SET, then the H-SLP assigns Mode A SUPL INIT protection level for that SET. If no other level of protection is assigned, then the H-SLP assigns Null SUPL INIT protection level for that SET.</p>
<p id="p-0294" num="1181">The H-SLP applies the procedures (for processing SUPL INIT messages prior to delivery) corresponding to the currently assigned level of SUPL INIT protection. This includes assigning the appropriate value for the Protection Level parameter in SUPL INIT messages.</p>
<p id="p-0295" num="1182">6.3.3.3 Negotiation from the SET Perspective</p>
<p id="p-0296" num="1183">If the most recent IP session with the H-SLP was authenticated using the GBA or SEK method, and the SET has the current B-TID and associated key used for that IP session, then
<ul id="ul0280" list-style="none">
    <li id="ul0280-0001" num="0000">
    <ul id="ul0281" list-style="none">
        <li id="ul0281-0001" num="1184">If the B-TID is for a key obtained using GBA, then the SET assigns SUPL_INIT_ROOT_KEY to be the Ks_(int/ext_)NAF corresponding to the most recent B-TID and generated as follows
        <ul id="ul0282" list-style="none">
            <li id="ul0282-0001" num="1185">The FQDN MAY be the H-SLP_FQDN</li>
            <li id="ul0282-0002" num="1186">The GBA Ua security protocol identifier that may be used for SUPL_INIT protection is defined in OMNA Registry.</li>
        </ul>
        </li>
        <li id="ul0281-0002" num="1187">If the B-TID is for a key derived using the SEK-method, then the SUPL_INIT_ROOT_KEY is the SEK as defined in 6.1.2.1.2.</li>
        <li id="ul0281-0003" num="1188">Assuming no other SUPL INIT protection has been negotiated, then the SET assigns the Mode B SUPL INIT protection level.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0297" num="1189">Otherwise, if the SET has a valid ModeAKeyIdentifier, associated key and ModeAReplayCounter for the H-SLP, then the H-SLP assigns Mode A SUPL INIT protection level for that SET.</p>
<p id="p-0298" num="1190">If no other level of protection is assigned, then the SET assigns Null SUPL INIT protection level.</p>
<p id="p-0299" num="1191">The SET applies the procedures (for processing received SUPL INIT messages) corresponding to the currently assigned level of SUPL INIT protection.</p>
<p id="p-0300" num="1192">6.3.3.4 Exception Procedures</p>
<p id="p-0301" num="1193">If the SET determines that the SET-internal SUPL INIT protection parameters have become corrupted, then the SET must establish a TLS session with the H-SLP:
<ul id="ul0283" list-style="none">
    <li id="ul0283-0001" num="0000">
    <ul id="ul0284" list-style="none">
        <li id="ul0284-0001" num="1194">If GBA authentication is used, then the SET must initiate GBA bootstrapping to establish fresh keys;</li>
        <li id="ul0284-0002" num="1195">For SETs using the SEK method, the SET must initiate SEK bootstrapping to enable fresh keys.</li>
        <li id="ul0284-0003" num="1196">Otherwise, the SET sends a SUPL_INIT_KeyRequest in the first secured ULP message and follows the procedures in Step 3.b of section 6.3.3.1.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0302" num="1197">If the SLP loses security context (for example, massive loss of data) then the SLP will have no means of initiating positioning activities. The context would be re-established when the Ks_NAF or SEK expires, or the SET connects to the SLP. To prevent this &#x201c;block out window&#x201d; the SLP should ensure that all SUPL INIT security context information is stored with sufficient redundancy to recover from such a scenario.</p>
<p id="p-0303" num="1198">6.3.4 Specifications when Null Level of Protection is Assigned</p>
<p id="p-0304" num="1199">NOTE: There is no SUPL INIT Protector for Null SUPL INIT protection.</p>
<p id="p-0305" num="1200">6.3.4.1 H-SLP Procedures</p>
<p id="p-0306" num="1201">There are no security procedures for the SLP that are specific to Null SUPL INIT protection.</p>
<p id="p-0307" num="1202">6.3.4.2 SET Procedures</p>
<p id="p-0308" num="1203">When Null SUPL INIT protection is assigned and the SET receives a SUPL INIT message, then the SET applies the following procedure:
<ul id="ul0285" list-style="none">
    <li id="ul0285-0001" num="0000">
    <ul id="ul0286" list-style="none">
        <li id="ul0286-0001" num="1204">If the Protection Level parameter is correct, then the SET considers the message to be authentic, and no security related processing may be required.
        <ul id="ul0287" list-style="none">
            <li id="ul0287-0001" num="1205">Suppose the SLP and SET can support a higher level of protection, but the SET has not yet been in contact with the SLP since being powered up: in this case the SET will have Null SUPL INIT protection assigned. In the period of time until the SET contacts the SLP, the SET will consider any received SUPL INIT message (with the correct Protection Level parameter) to be authentic. When the SET first contacts the SLP (which may or may not be in response to a received SUPL INIT message), the SET and SLP will transition to a higher level of protection. Once the two entities transition to the higher level of protection, the SET can detect non-authenticatic SUPL INIT messages. In between when the SET is powered up and when the SET first contacts the SLP, there is a period of time when the SET could receive an non-authentic SUPL INIT message that is processed by the SET as if the SUPL INIT message where authentic. If the SET decides to proceed with the SUPL session associated with the non-authentication SUPL INIT message, then the SET will contact the SLP and establish a secure TLS session. The SLP will not allow the SUPL session since it was established using a non-authentic SUPL INIT message. If the SET and SLP support a higher level of protection, then this will be established at the same time and the SET will be able to detect non-authentic SUPL messages after this time. This means that, if the SET and SLP can support a higher level of protection, then there is a very small window of opportunity for the attacker to get the SET to accept a non-authentic SUPL INIT message, and the SET will only attempt to proceed with a SUPL session for at most one non-authentic SUPL INIT message.</li>
        </ul>
        </li>
        <li id="ul0286-0002" num="1206">If the Protection Level parameter is incorrect (that is, if the Protection Level parameter was anything other than Null), then the SET sends the appropriate error message to the SLP.
        <ul id="ul0288" list-style="none">
            <li id="ul0288-0001" num="1207">In the event that the Protection Levels at the SLP and SET lose synchronization, this procedure allows the SET and SLP to resynchronize on a common Protection Level.</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0309" num="1208">6.3.5 Specifications for Mode A SUPL INIT Protection Level</p>
<p id="p-0310" num="1209">6.3.5.1 Key Identifiers for Mode A SUPL INIT Protection</p>
<p id="p-0311" num="1210">Mode A SUPL INIT Protection uses two Key Identifiers that may be sent with SUPL INIT messages: ModeAKeyIdentifier and TemporaryModeAKeyIdentifier.
<ul id="ul0289" list-style="none">
    <li id="ul0289-0001" num="0000">
    <ul id="ul0290" list-style="none">
        <li id="ul0290-0001" num="1211">The ModeAKeyIdentifier is a globally-unique, long-term Key Identifier associated with the SUPL_INIT_ROOT_KEY. The SLP provides a new ModeAKeyIdentifer to the SET only when the SLP provisions a new value for SUPL_INIT_ROOT_KEY.</li>
        <li id="ul0290-0002" num="1212">The TemporaryModeAKeyIdentifier is a short-term identity (pseudonym) associated with the ModeAKeyIdentifier. The TemporaryModeAKeyIdentifier may be globally unique in the period that the TemporaryModeAKeyIdentifier is valid. The SET and SLP synchronize the value of TemporaryModeAKeyIdentifier as described in Sections 6.3.5.3 and 6.3.5.4.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0312" num="1213">The SLP will typically use TemporaryModeAKeyIdentifier as the KeyIdentifier in the Basic SUPL INIT Protector. The SET then uses TemporaryModeAKeyIdentifier to determine which SUPL_INIT_ROOT_KEY should be used to verify the Basic SUPL INIT Protector.</p>
<p id="p-0313" num="1214">The ModeAKeyIdentifier is not typically sent in a SUPL INIT message because this would allow an observer to associate multiple SUPL INIT messages are associated with a common SET User. The purpose of TemporaryModeAKeyIdentifier to prevent a Threat Agent from using the ModeAKeyIdentifier to associate multiple SUPL_INIT messages with a SET User. Only the SLP and SET should be able to associate the TemporaryModeAKeyIdentifier with the ModeAKeyIdentifier. The frequency of changing TemporaryModeAKeyIdentifier is primarily a decision of the SET User. An SLP may choose to establish a new value for TemporaryModeAKeyIdentifier based on SLP policy.</p>
<p id="p-0314" num="1215">However, there are circumstances in which the SLP may wish to use the longer-term ModeAKeyIdentifier as the KeyIdentifier in the Basic SUPL INIT Protector. For example, suppose a SET has not be responding to multiple SUPL INIT messages using TemporaryModeAKeyIdentifier in the Basic SUPL INIT Protector. The SLP may be concerned that the SET has lost synchronization regarding TemporaryModeAKeyIdentifier. The SET and SLP are more likely to remain synchronized on the long-term ModeAKeyIdentifier. Hence, the SLP can send a SUPL INIT message using ModeAKeyIdentifier in the Basic SUPL INIT Protector to ensure that lack of synchronization does not prevent the SET from verifying the SUPL INIT message.</p>
<p id="p-0315" num="1216">6.3.5.2 Mode A SUPL INIT Protection and the Basic SUPL INIT Protector</p>
<p id="p-0316" num="1217">Mode A SUPL INIT Protection uses the Basic SUPL INIT Protector and associated procedures as defined in section 6.3.7 with the following additional clarifications:
<ul id="ul0291" list-style="none">
    <li id="ul0291-0001" num="0000">
    <ul id="ul0292" list-style="none">
        <li id="ul0292-0001" num="1218">KeyIdentifierType: indicates either ModeAKeyIdentifier or a TemporaryModeAKeyIdentifier is used.</li>
        <li id="ul0292-0002" num="1219">KeyIdentifier: corresponds to either a ModeAKeyIdentifier or a TemporaryModeAKeyIdentifier as appropriate to ModeAKeyIdentifierType.</li>
        <li id="ul0292-0003" num="1220">BasicMAC is computed using SUPL_INIT_IK=HMAC-SHA256-128(SUPL_INIT_ROOT_KEY, &#x201c;Mode A IK&#x201d;), using SUPL_INIT_ROOT_KEY associated with the KeyIdentifier above.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0317" num="1221">6.3.5.3 H-SLP Procedures</p>
<p id="p-0318" num="1222">The only Mode-A-specific H-SLP procedures relate to maintaining synchronization between the SET and SLP.</p>
<p id="p-0319" num="1223">A new value for the TemporaryModeAKeyIdentifier is established by the SLP sending (in the first response message to the SET in a secured ULP session) a NewTemporaryModeAKeyIdentifier parameter followed by a new TemporaryModeAKeyIdentifier. Establishing a new TemporaryModeAKeyIdentifier results in resetting BasicLastReplayCounter to 0x0000, and the SET removes all information about &#x201c;played&#x201d; SUPL INIT messages.</p>
<p id="p-0320" num="1224">An SLP may establish a new TemporaryModeAKeyIdentifier either in response to a SUPL_INIT_ResynchRequest or an (out of scope) internal decision of the SLP. That is, the SLP can send a TemporaryModeAKeyIdentifier even when there is no corresponding SUPL_INIT_ResynchRequest from the SET.</p>
<p id="p-0321" num="1225">6.3.5.4 SET Procedures</p>
<p id="p-0322" num="1226">The only Mode-A-specific SET procedures relate to maintaining synchronization between the SET and SLP.</p>
<p id="p-0323" num="1227">A SET may trigger establishing a new value for TemporaryModeAKeyIdentifier by sending a SUPL_INIT_ResynchRequest in the first message of a ULP session.</p>
<p id="p-0324" num="1228">If Mode A SUPL INIT protection is assigned by the SET, then prior to the first time that the SET processes a SUPL INIT message with a given TemporaryModeAKeyIdentifier, the SET clears its cache of used values for BasicReplayCounter.</p>
<p id="p-0325" num="1229">6.3.6 Specifications for Mode B SUPL INIT Protection Level</p>
<p id="p-0326" num="1230">Mode B SUPL INIT Protection uses the Basic SUPL INIT Protector and associated procedures as defined in section 0, with the following additional clarifications:
<ul id="ul0293" list-style="none">
    <li id="ul0293-0001" num="0000">
    <ul id="ul0294" list-style="none">
        <li id="ul0294-0001" num="1231">KeyIdentifierType: Only B-TID identifiers are support for Mode B SUPL INIT Protection.</li>
        <li id="ul0294-0002" num="1232">KeyIdentifier: corresponds to the current B-TID.</li>
        <li id="ul0294-0003" num="1233">The BasicMAC parameter is computed using SUPL_INIT_IK=HMAC-SHA256-128(SUPL_INIT_ROOT_KEY, &#x201c;Mode A IK&#x201d;), where
        <ul id="ul0295" list-style="none">
            <li id="ul0295-0001" num="1234">For GBA-based deployments the SUPL_INIT_ROOT_KEY is the Ks_(int/ext_)NAF corresponding to the most recent B-TID and generated using the GBA Ua security protocol identifier for SUPL INIT protection as defined in OMNA Registry.</li>
            <li id="ul0295-0002" num="1235">For SEK-based deployments the SUPL_INIT_ROOT_KEY is the SEK_MAC as defined in section 6.1.2.1.2.</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0327" num="1236">6.3.6.1 H-SLP Procedures</p>
<p id="p-0328" num="1237">The only Mode-B-specific H-SLP procedures relate to maintaining synchronization between the SET and SLP.</p>
<p id="p-0329" num="1238">For Mode B SUPL INIT protection, the BasicReplayCounter in the SLP is reset to zero the first time a key is used and the SET removes all information about &#x201c;played&#x201d; SUPL INIT messages.</p>
<p id="p-0330" num="1239">In the unlikely event that the SLP determines that resynchronization may be required:
<ul id="ul0296" list-style="none">
    <li id="ul0296-0001" num="0000">
    <ul id="ul0297" list-style="none">
        <li id="ul0297-0001" num="1240">In the case of deployments supporting the GBA method, the SLP triggers resychronization by invalidating the GBA B-TID. When that SET next attempts to authenticate to the SLP, then SLP will respond with TLS-PSK alert &#x201c;psk_identity_unknown&#x201d;. This prompts establishing a new GBA key.</li>
        <li id="ul0297-0002" num="1241">In the case of deployments supporting the SEK method, the SLP triggers resychronization by invalidating the SEK B-TID. When that SET next attempts to authenticate to the SLP, then SLP will respond with TLS-PSK alert &#x201c;psk_identity_unknown&#x201d;. This prompts establishing a new SEK as described in section 6.1.3.3</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0331" num="1242">6.3.6.2 SET Procedures</p>
<p id="p-0332" num="1243">The only Mode-B-specific SET procedures relate to maintaining synchronization between the SET and SLP.</p>
<p id="p-0333" num="1244">If Mode B SUPL INIT protection is assigned by the SET, then
<ul id="ul0298" list-style="none">
    <li id="ul0298-0001" num="0000">
    <ul id="ul0299" list-style="none">
        <li id="ul0299-0001" num="1245">Prior to the first time that the SET processes a SUPL INIT message with a given SUPL_INIT_ROOT_KEY, the SET clears its cache of used values for BasicReplayCounter.</li>
        <li id="ul0299-0002" num="1246">The SET can trigger resynchronization by establishing new GBA Ks or new SEK as appropriate. The SLP will continue to use the old GBA Ks (or SEK) until the next successful authentication between the SET and SLP, so the SET should maintain the old GBA Ks (or SEK) until that time.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0334" num="1247">6.3.7 Specifications for Using the Basic SUPL INIT Protector</p>
<p id="p-0335" num="1248">A Basic SUPL INIT Protector is used for both Mode A and Mode B SUPL INIT Protection includes the following parameters:
<ul id="ul0300" list-style="none">
    <li id="ul0300-0001" num="0000">
    <ul id="ul0301" list-style="none">
        <li id="ul0301-0001" num="1249">KeyIdentifierType: length=1 octet.</li>
        <li id="ul0301-0002" num="1250">KeyIdentifier: variable length. Corresponds to the key used to compute the BasicMAC.</li>
        <li id="ul0301-0003" num="1251">BasicReplayCounter: length=2 octets.</li>
        <li id="ul0301-0004" num="1252">BasicMAC: length=4 octets.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0336" num="1253">The BasicMAC parameter is generated as follows:
<ul id="ul0302" list-style="none">
    <li id="ul0302-0001" num="0000">
    <ul id="ul0303" list-style="none">
        <li id="ul0303-0001" num="1254">BasicMAC=HMAC-SHA256-32(SUPL_INIT_Basic_IK, SUPL_INIT&#x2032;), where</li>
        <li id="ul0303-0002" num="1255">SUPL_INIT_Basic_IK is derived according to sections 6.3.5 and 6.3.6 for Mode A and Mode B SUPL INIT protection respectively.</li>
        <li id="ul0303-0003" num="1256">SUPL_INIT&#x2032; corresponding to the SUPL INIT message with all parameters except BasicMAC assigned, and with the MAC parameter set to all zeroes, and</li>
        <li id="ul0303-0004" num="1257">HMAC-SHA256-32 and HMAC-SHA256-128 are specified in document(s) outside the scope of this document.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0337" num="1258">6.3.7.1 H-SLP Procedures</p>
<p id="p-0338" num="1259">SLP procedures for synchronization of ModeALastReplayCounter are specified for Mode A and Mode B SUPL INIT protection elsewhere.</p>
<p id="p-0339" num="1260">If Mode A or Mode B SUPL INIT protection is assigned to a SET, then the H-SLP composes the SUPL INIT messages as follows:
<ul id="ul0304" list-style="none">
    <li id="ul0304-0001" num="0000">
    <ul id="ul0305" list-style="none">
        <li id="ul0305-0001" num="1261">1. Parameters outside the SUPL INIT Protector are assigned as described elsewhere.</li>
        <li id="ul0305-0002" num="1262">2. KeyIdentityType is set according to the type of KeyIdentity that the SLP will use for this message.</li>
        <li id="ul0305-0003" num="1263">3. KeyIdentity is set to a KeyIdentity associated with the SUPL_INIT_ROOT_KEY.</li>
        <li id="ul0305-0004" num="1264">4. H-SLP increases the current value of BasicLastReplayCounterValue (associated with this SET and the negotiated SUPL INIT protection Level) by 1, and inserts the new value into the BasicReplayCounter parameter.</li>
        <li id="ul0305-0005" num="1265">5. Finally, after all other parameters are assigned the BasicMAC is calculated from SUPL INIT and SUPL_INIT_ROOT_KEY as specified above.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0340" num="1266">The H-SLP may be required to store a BasicLastReplayCounterValue of length equal to the length of BasicReplayCounter parameter for each SET for which Mode A or Mode B SUPL INIT protection level is assigned.</p>
<p id="p-0341" num="1267">If BasicLastReplayCounterValue in the SLP is close to 65535=2<sup>16</sup>&#x2212;1 (which is highly unlikely), then the SLP must trigger resynchronization procedures (see sections 6.3.6.1 and 6.3.7.1).</p>
<p id="p-0342" num="1268">6.3.7.2 SET Procedures</p>
<p id="p-0343" num="1269">SET procedures for synchronization of ModeALastReplayCounter are specified for Mode A and Mode B SUPL INIT protection elsewhere.</p>
<p id="p-0344" num="1270">If Mode A or Mode B SUPL INIT protection is assigned, then the SET processes a received SUPL INIT message as follows:
<ul id="ul0306" list-style="none">
    <li id="ul0306-0001" num="0000">
    <ul id="ul0307" list-style="none">
        <li id="ul0307-0001" num="1271">1. The SET discards the SUPL INIT message if the following parameters fail the appropriate verification:
        <ul id="ul0308" list-style="none">
            <li id="ul0308-0001" num="1272">Protection Level: must be the assigned value for the negotiated SUPL INIT protection level.</li>
            <li id="ul0308-0002" num="1273">KeyIdentityType: Must be valid for the assigned SUPL INIT protection level</li>
        </ul>
        </li>
        <li id="ul0307-0002" num="1274">Key Identity: Must correspond to the current SUPL_INIT_ROOT_KEY for the negotiated SUPL INIT protection level.</li>
        <li id="ul0307-0003" num="1275">BasicReplayCounter: the SET uses this value to detect replay of messages. The technique may be implementation specific but must be robust enough to deal with situations where SUPL INIT messages are lost or delivered out of order.</li>
        <li id="ul0307-0004" num="1276">BasicMAC: The SET computes an expected BasicMAC from SUPL INIT and SUPL_INIT_ROOT_KEY (as described above) and compares this to the received BasicMAC: the values must be equal.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0345" num="1277">2. If the SUPL INIT was not discarded in the previous step, then it is considered authentic, and the SET considers the BasicReplayCounterValue to be used. If BasicReplayCounterValue is close to 65535=2<sup>16</sup>&#x2212;1 (which is highly unlikely), then the SET must establish a new SUPL_INIT_ROOT_KEY with the SLP to reset the counter.</p>
<p id="p-0346" num="1278">6.4 Providing the H-SLP Address to the Set</p>
<p id="p-0347" num="1279">Note: Provisioning H-SLP Address for Access-Network Independent H-SLP is FFS.</p>
<p id="p-0348" num="1280">The H-SLP address is made available to the SET by the provisioning of the H-SLP address in the UICC, SET or a default H-SLP address is derived as described below. This address MUST be in the form of a FQDN and SHOULD be securely provisioned by the Home Network of the SET.</p>
<p id="p-0349" num="1281">6.4.1 3GPP2 SETs</p>
<p id="p-0350" num="1282">For 3GPP2 SETs the H-SLP address MUST be securely provisioned in the UIM or R-UIM.</p>
<p id="p-0351" num="1283">6.4.2 3GPP SETs</p>
<p id="p-0352" num="1284">A 3GPP SET MUST read the H-SLP address (in FQDN form) as a parameter &#x201c;ADDR&#x201d; under the &#x201c;APPADDR/ADDR&#x201d; characteristic as specified in WAP PROVCONT. In addition, the H-SLP address MUST be securely stored in the bootstrap file as defined in OMA Smartcard Provisioning specification on a 3GPP compliant UICC (USIM/SIM) or in an equivalently secure area of the SET. The SET MUST support OMA Smartcard Provisioning mechanisms to read the H-SLP address. The bootstrap file in the USIM/SIM application or SET that stores the H-SLP address MUST not be user changeable. If the H-SLP address is configured in the UICC (USIM/SIM), the SET MUST first read the H-SLP address provisioned in the UICC. If there is no H-SLP address provisioned in the UICC then the SET MAY read the H-SLP address from the secure area on the SET.</p>
<p id="p-0353" num="1285">Provisioning of the H-SLP address in the SET: If the H-SLP address is to be stored in a secure location on the SET, it MUST be provisioned using OMA Device Management V1.2 or later. If the H-SLP address is provisioned using OMA DM the SET MUST authenticate the OMA DM Server based on the server side certificate presented by the DM Server during the TLS Handshake. If the SET supports storage of the H-SLP address it MUST NOT rely on the authentication scheme set forth in section 6.1.4, i.e., the Alternative Client authentication based on MSISDN/IP-Address mapping authentication. i.e. the SET MUST rely on the PSK-TLS mutual authentication method as described in section 6.1.1.</p>
<p id="p-0354" num="1286">Auto configuration of the H-SLP address: If the H-SLP address can not be found in the secure storage area of the UICC (USIM/SIM), or in a secure area on the SET, the SET MUST configure the default H-SLP address in the SET based on the IMSI stored in the USIM/SIM.</p>
<p id="p-0355" num="1287">In the case an H-SLP address has been found in the secure storage area of the UICC (USIM/SIM), or in a secure area on the SET, but its use has resulted in an authentication failure while initiating the SUPL session, the SET MUST configure the default H-SLP address in the SET based on the IMSI stored in the USIM/SIM.</p>
<p id="p-0356" num="1288">The mechanism to configure a default H-SLP address is defined below.</p>
<p id="p-0357" num="1289">Please note that the following example has been taken from 3GPP GBA specifications and adopted for the SUPL use case where a H-SLP address (based on a FQDN) is configured. Implementation of this default configuration mechanism does not require the implementation of the 3GPP GBA specification. The example below is given to illustrate the methodology only, and can be implemented independent of GBA.</p>
<p id="p-0358" num="1290">Configuration of H-SLP based on IMSI:
<ul id="ul0309" list-style="none">
    <li id="ul0309-0001" num="1291">Step 1) Take the first 5 or 6 digits of the IMSI, depending on whether a 2 or 3 digit MNC is used and separate them into MCC and MNC; if the MNC is 2 digits then a zero MAY be added at the beginning;</li>
    <li id="ul0309-0002" num="1292">Step 2) Use the MCC and MNC derived in step 1 to create the &#x201c;mnc&#x3c;MNC&#x3e;.mcc&#x3c;MCC&#x3e;.pub.3gppnetwork.org&#x201d; domain name; Add the label &#x201c;h-slp.&#x201d; to the beginning of the domain name.</li>
</ul>
</p>
<p id="p-0359" num="1293">Example 1: If IMSI in use is &#x201c;234150999999999&#x201d;, where MCC=234, MNC=15, and MSIN=0999999999, the H-SLP address would be &#x201c;h-slp.mnc015.mcc234.pub.3gppnetwork.org&#x201d;.</p>
<p id="p-0360" num="1294">If a new IMSI is detected by the SET during, or after power on, all previous H-SLP settings MUST be removed from the SET. More specifically, any H-SLP address stored in the SET MUST be removed.</p>
<p id="p-0361" num="1295">In cases where the IMSI is changed the SET MUST first read the H-SLP address from the UICC (USIM/SIM). If no H-SLP address is stored on the UICC (USIM/SIM) the SET MAY check if the H-SLP address is stored in the SET. If no H-SLP address is found in the UICC or SET, then a default H-SLP address MUST be configured by the SET based on the new IMSI as described above.</p>
<p id="p-0362" num="1296">Implementations MUST ensure that the address of the H-SLP cannot be changed via applications that are downloaded to the SET after the manufacturer software installation of the SET.</p>
<p id="p-0363" num="1297">The following flow illustrates H-SLP address storage.
<ul id="ul0310" list-style="none">
    <li id="ul0310-0001" num="0000">
    <ul id="ul0311" list-style="none">
        <li id="ul0311-0001" num="1298">1. Start. Go to 2.</li>
        <li id="ul0311-0002" num="1299">2. IMSI changed? If Yes go to 3. If No skip 3 and go directly to 4.</li>
        <li id="ul0311-0003" num="1300">3. Clear H-SLP from SET. Go to 4.</li>
        <li id="ul0311-0004" num="1301">4. UICC contains H-SLP Address? If No go to 5. If Yes go to 9.</li>
        <li id="ul0311-0005" num="1302">5. H-SLP Address on SET supported? If No go to 7. If Yes go to 6.</li>
        <li id="ul0311-0006" num="1303">6. H-SLP Address provisioned in SET? If No go to 7. If Yes go to 8.</li>
        <li id="ul0311-0007" num="1304">7. Create H-SLP Address from IMSI. Go to 10.</li>
        <li id="ul0311-0008" num="1305">8. Read Settings from the SET. Go to 10.</li>
        <li id="ul0311-0009" num="1306">9. Read H-SLP Address from UICC. Go to 10.</li>
        <li id="ul0311-0010" num="1307">10. Create TLS connection to H-SLP using H-SLP address. Go to 11.</li>
        <li id="ul0311-0011" num="1308">11. Authentication Successful? If No go to 12. If Yes go to 14.</li>
        <li id="ul0311-0012" num="1309">12. H-SLP Address created from IMSI? If No go to 7. If Yes go to 13.</li>
        <li id="ul0311-0013" num="1310">13. Abort SUPL Session and End.</li>
        <li id="ul0311-0014" num="1311">14. Run SUPL Session and End.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0364" num="1312">6.4.3 WIMAX Based Deployments</p>
<p id="p-0365" num="1313">When the SET attaches to the WiMAX network it MAY receive an updated H-SLP address via OMA DM. When the H-SLP address is provisioned in a secure manner to a WiMAX terminal and it must be stored in a protected environment.</p>
<p id="p-0366" num="1314">6.5 Confidentiality and Data Integrity Protocols</p>
<p id="p-0367" num="1315">TLS 1.1 or PSK-TLS MAY be used to provide Confidentiality and Data Integrity between a SET and an SLP. All SUPL Messages except &#x201c;SUPL INIT&#x201d; MUST be delivered within a TLS or PSK-TLS session between a SET and an SLP.</p>
<p id="p-0368" num="1316">Section 6.1.1.3 provides details for determining which entities in a SUPL 3.0 deployment have TLS with server-certificate authentication and/or TLS-PSK as mandatory or optional.</p>
<p id="p-0369" num="1317">6.5.1 TLS with Server-Certificates</p>
<p id="p-0370" num="1318">Implementations of TLS 1.1 with server-certificates may conform to and WAP Profile of TLS 1.1 with the following clarifications:</p>
<p id="p-0371" num="1319">SETs MAY implement:
<ul id="ul0312" list-style="none">
    <li id="ul0312-0001" num="0000">
    <ul id="ul0313" list-style="none">
        <li id="ul0313-0001" num="1320">TLS_RSA_WITH_AES<sub>&#x2014;</sub>128_CBC_SHA.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0372" num="1321">For SET implementations that prefer additional cipher suites SETs SHOULD implement:
<ul id="ul0314" list-style="none">
    <li id="ul0314-0001" num="0000">
    <ul id="ul0315" list-style="none">
        <li id="ul0315-0001" num="1322">TLS_RSA_WITH<sub>&#x2014;</sub>3DES_EDE_CBC_SHA.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0373" num="1323">SLPs supporting TLS 1.1 with server-certificates may implement the following ciphersuites:
<ul id="ul0316" list-style="none">
    <li id="ul0316-0001" num="0000">
    <ul id="ul0317" list-style="none">
        <li id="ul0317-0001" num="1324">TLS_RSA_WITH<sub>&#x2014;</sub>3DES_EDE_CBC_SHA.</li>
        <li id="ul0317-0002" num="1325">TLS_RSA_WITH_AES<sub>&#x2014;</sub>128_CBC_SHA.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0374" num="1326">For SLP implementations supporting TLS 1.1 with server-certificates that prefer to support NULL encryption SLPs MAY implement TLS_RSA_WITH_NULL_SHA. Note that the use of TLS_RSA_WITH_NULL_SHA is not recommended, as it does not provide any confidentiality protection. However, it still provides authentication and integrity protection.</p>
<p id="p-0375" num="1327">The WAP Certificate profile of TLS 1.1 MAY be supported by SLPs supporting TLS 1.1 with server-certificates and SETs.</p>
<p id="p-0376" num="1328">6.5.2 TLS-PSK</p>
<p id="p-0377" num="1329">TLS-PSK implementations MAY conform to PSK-TLS for the TLS Handshake, with Bulk Ciphering as defined for TLS 1.1</p>
<p id="p-0378" num="1330">SETs supporting TLS-PSK MAY implement:
<ul id="ul0318" list-style="none">
    <li id="ul0318-0001" num="0000">
    <ul id="ul0319" list-style="none">
        <li id="ul0319-0001" num="1331">TLS_PSK_WITH_AES<sub>&#x2014;</sub>128_CBC_SHA.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0379" num="1332">For SET implementations supporting TLS-PSK that prefer additional cipher suites, the SETs SHOULD implement:
<ul id="ul0320" list-style="none">
    <li id="ul0320-0001" num="0000">
    <ul id="ul0321" list-style="none">
        <li id="ul0321-0001" num="1333">TLS_PSK_WITH<sub>&#x2014;</sub>3DES_EDE_CBC_SHA.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0380" num="1334">The following cipher suites MAY be implemented by SLPs:
<ul id="ul0322" list-style="none">
    <li id="ul0322-0001" num="0000">
    <ul id="ul0323" list-style="none">
        <li id="ul0323-0001" num="1335">TLS_PSK_WITH_AES<sub>&#x2014;</sub>128_CBC_SHA.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0381" num="1336">For SLP implementations supporting TLS-PSK that prefer additional cipher suites, the SLPs SHOULD implement:
<ul id="ul0324" list-style="none">
    <li id="ul0324-0001" num="0000">
    <ul id="ul0325" list-style="none">
        <li id="ul0325-0001" num="1337">TLS_PSK_WITH<sub>&#x2014;</sub>3DES_EDE_CBC_SHA.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0382" num="1338">The following cipher suites MAY be implemented by SPCs that support non-proxy mode:
<ul id="ul0326" list-style="none">
    <li id="ul0326-0001" num="0000">
    <ul id="ul0327" list-style="none">
        <li id="ul0327-0001" num="1339">TLS_PSK_WITH_AES<sub>&#x2014;</sub>128_CBC_SHA.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0383" num="1340">For SPC implementations that support non-proxy mode that prefer additional cipher suites, the SPCs SHOULD implement:
<ul id="ul0328" list-style="none">
    <li id="ul0328-0001" num="0000">
    <ul id="ul0329" list-style="none">
        <li id="ul0329-0001" num="1341">TLS_PSK_WITH<sub>&#x2014;</sub>3DES_EDE_CBC_SHA.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0384" num="1342">6.6 DCert Method and User Binding</p>
<p id="p-0385" num="1343">The DCert method authenticates the SET handset, but (unlike the GBA, SEK and ACA methods) does not perform any authentication tied to Access Network credentials. If the SLP uses the DCert method for mutual authentication, the SLP Operator needs some other mechanism to verify which SUPL User should be associated with the SET. The term &#x201c;User Binding&#x201d; is used to describe associating a SUPL User with a SET Identity.</p>
<p id="p-0386" num="1344">If the SET ownership changes, then is the responsibility of the existing SUPL User to contact the SLP Operator to release the User Binding.</p>
<p id="p-0387" num="1345">SUPL 3.0 does not specify a User Binding procedure, although one possible procedure is shown in section 6.6.1. Some SLPs may incorporate a User Binding procedure as part of other services provided by the SLP Operator. In other cases, the User Binding may be part of the distribution chain.</p>
<p id="p-0388" num="1346">The SLP Operator may use any &#x201c;User Binding&#x201d; procedure they choose, but the following points should be kept in mind:
<ul id="ul0330" list-style="none">
    <li id="ul0330-0001" num="0000">
    <ul id="ul0331" list-style="none">
        <li id="ul0331-0001" num="1347">The SUPL User must be authenticated as part of the User Binding procedure.
        <ul id="ul0332" list-style="none">
            <li id="ul0332-0001" num="1348">Failure to authenticate the SUPL USER would allow theft of service, and allow the Threat Agent to mislead the SLP regarding the location of the identified SUPL User.</li>
            <li id="ul0332-0002" num="1349">We recommend that the SLP Operator apply their existing mechanisms and policies for User Authentication.</li>
        </ul>
        </li>
        <li id="ul0331-0002" num="1350">The SET must be authenticated as part of the User Binding procedure.
        <ul id="ul0333" list-style="none">
            <li id="ul0333-0001" num="1351">The reasons for this are subtle. Suppose that a Threat Agent wishes to follow the movements of Alice and Alice owns a SET with SET Identity &#x201c;SET_ID_A&#x201d;. The Threat Agent registers as a legitimate SUPL User and, after authenticating herself, claims to own the SET with SET Identity &#x201c;SET_ID_A&#x201d;. If the SLP Operator associates this SET with the Threat Agent's account, then the Threat Agent can authorize themselves to obtain periodic location updates from the SLP (via Network Initiated sessions). However, since Alice is using the SET, the Threat Agent is actually getting updates of Alice's location. Since the SLP Operator is expected to keep Alice's location confidential, it is in the SLP Operator's interest to prevent such an attack.</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0389" num="1352">6.6.1 An Example User Binding Procedure</p>
<p id="p-0390" num="1353">The DCert method is designed primarily for SETs that have web-browsing capabilities: examples include smart-phones, tablets or touch-screen multi-media players.</p>
<p id="p-0391" num="1354">Such SETs can use the following mechanism:
<ul id="ul0334" list-style="none">
    <li id="ul0334-0001" num="0000">
    <ul id="ul0335" list-style="none">
        <li id="ul0335-0001" num="1355">1. SLP Operator prompts the SUPL User to connect to the URL of an SLP-owned Web Server while using the SET.</li>
        <li id="ul0335-0002" num="1356">2. Subscriber connects to website (possibly WAP) while using the SET.</li>
        <li id="ul0335-0003" num="1357">3. Web Server and SET perform TLS
        <ul id="ul0336" list-style="none">
            <li id="ul0336-0001" num="1358">a. The Web Server provides a server certificate and requests a client certificate. The Web Server's certificate may be distinct from the certificate for the SLP server certificate used for SUPL service.</li>
            <li id="ul0336-0002" num="1359">b. The SET authenticates the Web Server</li>
            <li id="ul0336-0003" num="1360">c. The SET authenticates to the Web Server using the SET's Device Certificate.</li>
            <li id="ul0336-0004" num="1361">d. The Web-Server has now authenticated that the secure channel is associated with the SET Identity (e.g. IMEI, MEID or serial number) in the Device Certificate.</li>
        </ul>
        </li>
        <li id="ul0335-0004" num="1362">4. The SUPL User performs some (out of scope) authentication with the website. For example, the Web Server could request an SLP-specific username/password, or federated username/password or other subscriber details such as address, date of birth, etc.</li>
        <li id="ul0335-0005" num="1363">5. The SLP operator has now securely associated the subscriber with the device identity and should store this association in the SLP.
<br/>
Additional Embodiment 8
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0392" num="1364">SUPL 3.0 has defined Mode A and Mode B SUPL INIT protection. Mode A protection requires that the SLP has the ability to send a shared key to the SET during a secured ULP session. This embodiment describes the shared key parameter and indicates which ULP message(s) are to be used to request and send the shared key. Thus, this embodiment may be incorporated into SUPL 3.0, and section numbers may refer to SUPL 3.0 sections.</p>
<p id="p-0393" num="1365">6.3.3 End-to-End Protection of SUPL INIT/REINIT Messages</p>
<p id="p-0394" num="1366">NOTE: End-to-End Protection of SUPL INIT Messages applies only to non-emergency SUPL INIT/REINIT messages.</p>
<p id="p-0395" num="1367">The processes in Section 6.3.3 apply only to SLP that are D-SLP and H-SLP; the processes do not apply to E-SLP.</p>
<p id="p-0396" num="1368">The procedures for End-to-End protection protection of SUPL INIT and SUPL REINIT messages make no distinction between SUPL INIT and SUPL REINIT messages&#x2014;both SUPL INIT and SUPL REINIT messages are processed as though they were the same type of message. For simplicity, we refer to the procedures as SUPL INIT protection procedures&#x2014;both SUPL INIT and SUPL REINIT messages are processed using the as SUPL INIT protection procedures.</p>
<p id="p-0397" num="1369">Three options of end-to-end SUPL INIT protection are provided for in this specification: Null, Mode A and Mode B&#x2014;
<ul id="ul0337" list-style="none">
    <li id="ul0337-0001" num="0000">
    <ul id="ul0338" list-style="none">
        <li id="ul0338-0001" num="1370">Null SUPL INIT protection provides no end-to-end integrity protection, no end-to-end replay protection and no confidentiality protection. The procedures for Null SUPL INIT protection are described in section 6.3.4.</li>
        <li id="ul0338-0002" num="1371">Mode A SUPL INIT protection provides end-to-end integrity protection and end-to-end replay protection using default algorithms. Mode A SUPL INIT protection uses a shared key sent to the SET by the SLP during a secured ULP Session. The procedures for Mode A SUPL INIT protection are described in section 6.3.5.</li>
        <li id="ul0338-0003" num="1372">Mode B SUPL INIT protection provides end-to-end integrity protection and end-to-end replay protection using default algorithms. Mode B SUPL INIT protection uses a shared key derived using the appropriate PSK-based Method (GBA or SEK methods). The procedures for Mode B SUPL INIT protection are described in section 6.3.6.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0398" num="1373">The order of preference for the level of protection is as follows:
<ul id="ul0339" list-style="none">
    <li id="ul0339-0001" num="0000">
    <ul id="ul0340" list-style="none">
        <li id="ul0340-0001" num="1374">Null SUPL INIT protection has least preference.</li>
        <li id="ul0340-0002" num="1375">Mode A SUPL INIT protection has higher preference than Null SUPL INIT protection.</li>
        <li id="ul0340-0003" num="1376">Mode B SUPL INIT protection has higher preference than Mode A SUPL INIT protection.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0399" num="1377">In a SUPL INIT message the Protection Level parameter (in the following table) is assigned according to the current level of protection.</p>
<p id="p-0400" num="1378">NOTE: this specification has been written to allow for more advanced levels of protection to be added in the future revisions. This advanced protection could allow the negotiation of other ways for securing SUPL INIT/REINIT (for example, allowing encryption and allowing the negotiation of algorithms). The Protection Level parameter is included to aid the SET in determining whether it might be able to parse the SUPL INIT/REINIT message or not: the Protection Level parameter is required for extensibility.</p>
<p id="p-0401" num="1379">A SUPL INIT/REINIT message may have a Protector parameter present for including security parameters: the presence of a Protector parameter is specified in the following table.</p>
<p id="p-0402" num="1380">
<tables id="TABLE-US-00014" num="00014">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="56pt" align="left"/>
<colspec colname="2" colwidth="105pt" align="left"/>
<colspec colname="3" colwidth="56pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry/>
<entry>Protector</entry>
</row>
<row>
<entry>Level of End-to-</entry>
<entry/>
<entry>parameter</entry>
</row>
<row>
<entry>End SUPL NIT</entry>
<entry/>
<entry>present in SUPL</entry>
</row>
<row>
<entry>Protection</entry>
<entry>Description</entry>
<entry>INIT/REINIT?</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>Null</entry>
<entry>No end-to-end protection</entry>
<entry>Optional</entry>
</row>
<row>
<entry>Mode A</entry>
<entry>Integrity protection and replay</entry>
<entry>Mandatory</entry>
</row>
<row>
<entry/>
<entry>protection using default algorithms</entry>
</row>
<row>
<entry>Mode B</entry>
<entry>Integrity protection and replay</entry>
<entry>Mandatory</entry>
</row>
<row>
<entry/>
<entry>protection using default algorithms</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<heading id="h-0017" level="1">SUPL INIT Protection Level Parameter Values and Presence of the Protector Parameter in SUPL INIT and SUPL REINIT Messages</heading>
<p id="p-0403" num="1381">A SET or D-SLP or H-SLP that supports the ACA-based method MUST support Null SUPL INIT protection.</p>
<p id="p-0404" num="1382">All SETs SHOULD support Mode A SUPL INIT protection procedures.</p>
<p id="p-0405" num="1383">A D-SLP or H-SLP MAY support Mode A SUPL INIT protection procedures.</p>
<p id="p-0406" num="1384">A SET or D-SLP or H-SLP that supports the PSK-based method MUST support Mode B SUPL INIT protection procedures.</p>
<p id="p-0407" num="1385">The E-SLP entity is not involved in currently defined SUPL INIT protection.</p>
<p id="p-0408" num="1386">6.3.3.1 Negotiating the Level of SUPL INIT Protection</p>
<p id="p-0409" num="1387">The following processes apply only to SLP that are D-SLP and H-SLP; the processes do not apply to E-SLP.</p>
<p id="p-0410" num="1388">An informal description of how the SUPL INIT protection level is negotiated is as follows:
<ul id="ul0341" list-style="none">
    <li id="ul0341-0001" num="0000">
    <ul id="ul0342" list-style="none">
        <li id="ul0342-0001" num="1389">4. The SET must apply Null SUPL INIT protection when there is no valid SUPL_INIT_ROOT_KEY (e.g. at power-up or when the lifetime of the SUPL_INIT_ROOT_KEY has expired). The initial protection level is always Null SUPL INIT protection. In this state the SET handles all SUPL INIT/REINIT messages, i.e. no messages are silently dropped. If a SUPL INIT/REINIT message is parsed with a failure condition, the SET sends an error message to the SLP.</li>
        <li id="ul0342-0002" num="1390">5. If the SET has a valid SUPL_INIT_ROOT_KEY and valid ReplayCounter already negotiated using Mode A or Mode B SUPL INIT protection for a particular SLP, then the SET processes all SUPL INIT/REINIT messages from that SLP using the negotiated mode (Mode A or Mode B).</li>
        <li id="ul0342-0003" num="1391">6. When the SET establishes a mutually-authenticated secure connection to the SLP,
        <ul id="ul0343" list-style="none">
            <li id="ul0343-0001" num="1392">a. If a PSK-based method (GBA or SEK) was used for mutual authentication, then Mode B SUPL INIT protection applies and the B-TID exchanged in the PSK-TLS handshake corresponds to the Ks (that will be used as a Ks_NAF in 3GPP and 3GPP2 deployments) or SEK that can be used to derive SUPL_INIT_ROOT_KEY that will be used as a Ks_NAF in 3GPP and 3GPP2 deployments. This Ks_NAF or SEK and the associated B-TID are used in the Mode B SUPL INIT protection until either:
            <ul id="ul0344" list-style="none">
                <li id="ul0344-0001" num="1393">i. the key expires, in which case the SET and SLP revert to Null SUPL INIT protection</li>
                <li id="ul0344-0002" num="1394">ii. the SET and SLP use the ACA-method in a non-emergency session, in which case the SET and SLP revert to either Mode A or Null SUPL INIT protection as discussed in step 3b below, or</li>
                <li id="ul0344-0003" num="1395">iii. the SET and H-SLP use GBA's or SEK's bootstrapping re-negotiation methods to establish TLS using a fresh B-TID, in which case the B-TID and corresponding Ks_NAF or SEK are now used for Mode B SUPL INIT protection.</li>
            </ul>
            </li>
            <li id="ul0343-0002" num="1396">b. Otherwise, the SET and SLP established a secure connection using the DCert or ACA method.
            <ul id="ul0345" list-style="none">
                <li id="ul0345-0001" num="1397">i. If the SET does not have a valid SUPL_INIT_ROOT_KEY, it indicates this to the SLP in its SET Capabilities (sUPLINITRootKeyStatus=&#x201c;invalidSUPLINITRootKey&#x201d;) in the next ULP message carrying the SET Capabilities parameter following the secure session establishment.
                <ul id="ul0346" list-style="none">
                    <li id="ul0346-0001" num="1398">1. s Mode A SUPL INIT protection, then the SLP performs the Mode A SUPL_INIT_ROOT_KEY Establishment procedure (Section 6.3.5.2) in the next SUPL END message. A successful Mode A SUPL_INIT_ROOT_KEY Establishment procedure indicates to the SET that Mode A SUPL INIT Protection applies. Until a successful Mode A SUPL_INIT_ROOT_KEY Establishment procedure occurs, the SET SHALL use Null SUPL INIT Protection.</li>
                </ul>
                </li>
            </ul>
            </li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0411" num="1399">NOTE: The policy for updating SUPL_INIT_ROOT_KEY is a decision of the SLP Operator.
<ul id="ul0347" list-style="none">
    <li id="ul0347-0001" num="0000">
    <ul id="ul0348" list-style="none">
        <li id="ul0348-0001" num="1400">2. If the SLP does not support Mode A SUPL INIT protection (or does not support Mode A SUPL INIT protection at this particular time), then the SLP does not send ModeAKeyIdentifier, TemporaryModeAKeyIdentifier, SUPL_INIT_ROOT_KEY and ModeAKeyLifetime parameters which indicates that the SET SHALL use Null SUPL INIT Protection.</li>
        <li id="ul0348-0002" num="1401">ii. If the SET has a valid SUPL_INIT_ROOT_KEY, but does not have a valid TemporaryModeAKeyIdentifier or has lost synchronization regarding replay protection, it indicates this to the SLP in its SET Capabilities (sUPLINITRootKeyStatus=&#x201c;outofsyncSUPLINITRootKey&#x201d;) in the next ULP message carrying the SET Capabilities parameter following the secure session establishment.</li>
        <li id="ul0348-0003" num="1402">1. performs the Mode A Resynchronization procedure (Section 6.3.5.3) in the next SUPL END message. A successful Mode A Resynchronization procedure indicates to the SET that Mode A SUPL INIT Protection applies. Until a successful Mode A Resynchronization procedure occurs, the SET SHALL use Null SUPL INIT Protection.</li>
        <li id="ul0348-0004" num="1403">2. If the SLP does not support Mode A SUPL INIT protection (or does not wish to support Mode A SUPL INIT protection at this particular time), then the SLP does not perform Mode A Resynchronization (Section 6.3.5.3) which indicates that the SET SHALL use Null SUPL INIT Protection.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0412" num="1404">Note that this means that the protection level is renegotiated every time the SET sets up a fresh TLS connection to the SLP.</p>
<p id="p-0413" num="1405">6.3.3.2 Negotiation from the SLP Perspective</p>
<p id="p-0414" num="1406">If the most recent IP session with the SET was authenticated using the GBA or SEK method, and the SLP has a current B-TID and the associated key for the SET, then
<ul id="ul0349" list-style="none">
    <li id="ul0349-0001" num="0000">
    <ul id="ul0350" list-style="none">
        <li id="ul0350-0001" num="1407">If the B-TID is for a key obtained using GBA, then the SLP assigns SUPL_INIT_ROOT_KEY to be the Ks_(int/ext_)NAF corresponding to the most recent B-TID and generated as follows
        <ul id="ul0351" list-style="none">
            <li id="ul0351-0001" num="1408">The FQDN SHALL be the SLP_FQDN</li>
            <li id="ul0351-0002" num="1409">The GBA Ua security protocol identifier that shall be used for SUPL_INIT protection is defined in OMNA Registry [OMNA].</li>
        </ul>
        </li>
        <li id="ul0350-0002" num="1410">If the B-TID is for a key derived using the SEK-method, then the SUPL_INIT_ROOT_KEY is the SEK as defined in 6.1.2.1.2.</li>
        <li id="ul0350-0003" num="1411">Assuming no other SUPL INIT protection has been negotiated, then the SLP assigns the Mode B SUPL INIT protection level for that SET.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0415" num="1412">Otherwise, if the SLP has a valid ModeAKeyIdentifier and associated key for the SET, then the SLP assigns Mode A SUPL INIT protection level for that SET.</p>
<p id="p-0416" num="1413">If no other level of protection is assigned, then the SLP assigns Null SUPL INIT protection level for that SET.</p>
<p id="p-0417" num="1414">The SLP applies the procedures (for processing SUPL INIT/REINIT messages prior to delivery) corresponding to the currently assigned level of SUPL INIT/REINIT protection. This includes assigning the appropriate value for the Protection Level parameter in SUPL INIT messages.</p>
<p id="p-0418" num="1415">6.3.3.3 Negotiation from the SET Perspective</p>
<p id="p-0419" num="1416">If the most recent IP session with the SLP was authenticated using the GBA or SEK method, and the SET has the current B-TID and associated key used for that IP session, then
<ul id="ul0352" list-style="none">
    <li id="ul0352-0001" num="0000">
    <ul id="ul0353" list-style="none">
        <li id="ul0353-0001" num="1417">If the B-TID is for a key obtained using GBA, then the SET assigns SUPL_INIT_ROOT_KEY to be the Ks_(int/ext_)NAF corresponding to the most recent B-TID and generated as follows
        <ul id="ul0354" list-style="none">
            <li id="ul0354-0001" num="1418">The FQDN SHALL be the SLP_FQDN</li>
            <li id="ul0354-0002" num="1419">The GBA Ua security protocol identifier [3GPP 24.109] that shall be used for SUPL_INIT protection is defined in OMNA Registry [OMNA].</li>
        </ul>
        </li>
        <li id="ul0353-0002" num="1420">If the B-TID is for a key derived using the SEK-method, then the SUPL_INIT_ROOT_KEY is the SEK as defined in 6.1.2.1.2.</li>
        <li id="ul0353-0003" num="1421">Assuming no other SUPL INIT protection has been negotiated, then the SET assigns the Mode B SUPL INIT protection level.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0420" num="1422">Otherwise, if the SET has a valid ModeAKeyIdentifier, TemporaryModeAKeyIdentifier and associated SUPL_INIT_ROOT_KEY for the SLP, then the SET assigns Mode A SUPL INIT protection level for that SLP.</p>
<p id="p-0421" num="1423">If no other level of protection is assigned, then the SET assigns Null SUPL INIT protection level.</p>
<p id="p-0422" num="1424">The SET applies the procedures (for processing received SUPL INIT/REINIT messages) corresponding to the currently assigned level of SUPL INIT protection.</p>
<p id="p-0423" num="1425">6.3.3.4 Exception Procedures</p>
<p id="p-0424" num="1426">If the SET determines that the SET-internal SUPL INIT protection parameters have become corrupted, then the SET must establish a TLS session with the SLP:
<ul id="ul0355" list-style="none">
    <li id="ul0355-0001" num="0000">
    <ul id="ul0356" list-style="none">
        <li id="ul0356-0001" num="1427">If GBA authentication is used, then the SET must initiate GBA bootstrapping to establish fresh keys;</li>
        <li id="ul0356-0002" num="1428">For SETs using the SEK method, the SET must initiate SEK bootstrapping to enable fresh keys, as defined in 6.1.2.1.2.</li>
        <li id="ul0356-0003" num="1429">Otherwise, the SET follows the procedures in Step 3.b of section 6.3.3.1.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0425" num="1430">If the SLP loses security context (for example, massive loss of data) then the SLP will have no means of initiating positioning activities. The context would be re-established when the Ks_NAF or SEK expires, or the SET connects to the SLP. To prevent this &#x201c;block out window&#x201d; the SLP should ensure that all SUPL INIT protection security context information is stored with sufficient redundancy to recover from such a scenario.</p>
<p id="p-0426" num="1431">6.3.3.5 General Procedure for Processing a SUPL INIT Message at SET</p>
<p id="p-0427" num="1432">The following procedure is applied by the SET to determine how to process a received SUPL INIT message.
<ul id="ul0357" list-style="none">
    <li id="ul0357-0001" num="0000">
    <ul id="ul0358" list-style="none">
        <li id="ul0358-0001" num="1433">1. The SET identifies the Sending SLP (the SLP that sent the SUPL INIT message).
        <ul id="ul0359" list-style="none">
            <li id="ul0359-0001" num="1434">a. If a D-SLP FQDN parameter is present in the SUPL INIT message, then the SET SHALL identify the Sending SLP using this parameter.
            <ul id="ul0360" list-style="none">
                <li id="ul0360-0001" num="1435">i. If the SET has no existing relationship with identified D-SLP, then the SET silently SHALL discard the SUPL INIT message and exits the current procedure.</li>
                <li id="ul0360-0002" num="1436">ii. Otherwise, the SET proceeds to step 2.</li>
            </ul>
            </li>
            <li id="ul0359-0002" num="1437">b. If no D-SLP FQDN parameter is present in the SUPL INIT message, then the SET identifies the Sending SLP to be the SET's H-SLP.</li>
        </ul>
        </li>
        <li id="ul0358-0002" num="1438">2. The SET performs initial filtering based on the SUPL INIT Protection level assigned for the Sending SLP:
        <ul id="ul0361" list-style="none">
            <li id="ul0361-0001" num="1439">a. If Null SUPL INIT Protection is assigned for the Sending SLP, then the SET performs the Null SUPL INIT Protection procedures, and exits the current procedure.</li>
            <li id="ul0361-0002" num="1440">b. If Mode A or Mode B SUPL INIT Protection is assigned for the Sending SLP, then
            <ul id="ul0362" list-style="none">
                <li id="ul0362-0001" num="1441">i. If the SUPL INIT message contains no Protector Parameter, then the SET silently discards the SUPL INIT message and exits the current procedure.</li>
                <li id="ul0362-0002" num="1442">ii. If the SUPL INIT message contains a Protector Parameter, the SET performs the appropriate Mode A or Mode B SUPL INIT Protection procedures in Section 6.3.5 or Section 6.3.6 respectively. The SET uses the KeyIdentifier parameter in the Protector Parameter to identify which of the SUPL INIT ROOT Keys associated with the Sending SLP is to be used for processing the SUPL INIT message.</li>
            </ul>
            </li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0428" num="1443">6.3.5 Specifications for Mode A SUPL INIT Protection Level</p>
<p id="p-0429" num="1444">6.3.5.1 Key Identifiers for Mode A SUPL INIT Protection</p>
<p id="p-0430" num="1445">Mode A SUPL INIT Protection uses two Key Identifiers that may be sent with SUPL INIT/REINIT messages: ModeAKeyIdentifier and TemporaryModeAKeyIdentifier.
<ul id="ul0363" list-style="none">
    <li id="ul0363-0001" num="0000">
    <ul id="ul0364" list-style="none">
        <li id="ul0364-0001" num="1446">The ModeAKeyIdentifier is a globally-unique, long-term Key Identifier associated with the SUPL_INIT_ROOT_KEY. The SLP provides a new ModeAKeyIdentifer to the SET only when the SLP provisions a new value for SUPL_INIT_ROOT_KEY.</li>
        <li id="ul0364-0002" num="1447">The TemporaryModeAKeyIdentifier is a short-term identity (pseudonym) associated with the ModeAKeyIdentifier. The TemporaryModeAKeyIdentifier shall be globally unique in the period that the TemporaryModeAKeyIdentifier is valid. The SET and SLP synchronize the value of TemporaryModeAKeyIdentifier as described in Sections 6.3.5.5 and 6.3.5.6.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0431" num="1448">The SLP will typically use TemporaryModeAKeyIdentifier as the KeyIdentifier in the Basic SUPL INIT Protector. The SET then uses TemporaryModeAKeyIdentifier to determine which SUPL_INIT_ROOT_KEY should be used to verify the Basic SUPL INIT Protector.</p>
<p id="p-0432" num="1449">The ModeAKeyIdentifier is not typically sent in a SUPL INIT/REINIT message because this would allow an observer to associate multiple SUPL INIT/REINIT messages are associated with a common SET User. The purpose of TemporaryModeAKeyIdentifier to prevent a Threat Agent from using the ModeAKeyIdentifier to associate multiple SUPL INIT/REINIT messages with a SET User. Only the SLP and SET should be able to associate the TemporaryModeAKeyIdentifier with the ModeAKeyIdentifier. The frequency of changing TemporaryModeAKeyIdentifier is primarily a decision of the SET User. An SLP may choose to establish a new value for TemporaryModeAKeyIdentifier based on SLP policy.</p>
<p id="p-0433" num="1450">However, there are circumstances in which the SLP may wish to use the longer-term ModeAKeyIdentifier as the KeyIdentifier in the Basic SUPL INIT Protector. For example, suppose a SET has not been responding to multiple SUPL INIT/REINIT messages using TemporaryModeAKeyIdentifier in the Basic SUPL INIT Protector. The SLP may be concerned that the SET has lost synchronization regarding TemporaryModeAKeyIdentifier. The SET and SLP are more likely to remain synchronized on the long-term ModeAKeyIdentifier. Hence, the SLP can send a SUPL INIT/REINIT message using ModeAKeyIdentifier in the Basic SUPL INIT Protector to ensure that lack of synchronization does not prevent the SET from verifying the SUPL INIT/REINIT message.</p>
<p id="p-0434" num="1451">6.3.5.2 Mode A SUPL_INIT_ROOT_KEY Establishment Procedure</p>
<p id="p-0435" num="1452">A value for the SUPL_INIT_ROOT_KEY is established by the SLP sending (in a SUPL END message to the SET in a secure SUPL session) a new ModeAKeyIdentifier, TemporaryModeAKeyIdentifier, SUPL_INIT_ROOT_KEY and ModeAKeyLifetime parameters. If delivery is successful, then the SLP and SET considers this Mode A SUPL_INIT_ROOT_KEY Establishment Procedure to be a success.</p>
<p id="p-0436" num="1453">The ModeAKeyLifetime parameter contains the UTC time when the key ceases being valid.</p>
<p id="p-0437" num="1454">6.3.5.3 Mode A Resynchronization Procedure</p>
<p id="p-0438" num="1455">A SLP establishes a new value for the TemporaryModeAKeyIdentifier with the SET using the following steps:
<ul id="ul0365" list-style="none">
    <li id="ul0365-0001" num="0000">
    <ul id="ul0366" list-style="none">
        <li id="ul0366-0001" num="1456">1. The SLP sends to the SET (in a SUPL END message to the SET in a secure SUPL session) the current ModeAKeyIdentifier and a new TemporaryModeAKeyIdentifier parameter. If delivery is successful, then the SLP considers this Mode A Resynchronization Procedure to be a success.</li>
        <li id="ul0366-0002" num="1457">2. The SET compares the received ModeAKeyIdentifier against the ModeAKeyIdentifiers of the valid SUPL_INIT_ROOT_KEY values that the SET currently has assigned for that SLP.
        <ul id="ul0367" list-style="none">
            <li id="ul0367-0001" num="1458">a. If the ModeAkeyIdentifier values differ, then this indicates corruption of the value of ModeAKeyIdentifier assigned on the SET, and the following steps are performed:
            <ul id="ul0368" list-style="none">
                <li id="ul0368-0001" num="1459">i. The SET discards the TemporaryModeAKeyIdentifier and considers this Mode A Resynchronization to be a failure.</li>
                <li id="ul0368-0002" num="1460">ii. The SET initiates the Exception Procedures in Section 6.3.3.4.</li>
            </ul>
            </li>
            <li id="ul0367-0002" num="1461">b. If the received ModeAkeyIdentifier is equal to a valid ModeAKeyIdentifier, then:
            <ul id="ul0369" list-style="none">
                <li id="ul0369-0001" num="1462">i. The SET associates the new TemporaryModeAKeyIdentifier with the corresponding ModeAKeyIdentifier,</li>
                <li id="ul0369-0002" num="1463">ii. The SET considers this Mode A Resynchronization Procedure to be a success.</li>
            </ul>
            </li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0439" num="1464">6.3.5.4 Mode A SUPL INIT Protection and the Basic SUPL INIT Protector</p>
<p id="p-0440" num="1465">Mode A SUPL INIT Protection uses the Basic SUPL INIT Protector and associated procedures as defined in section 0 with the following additional clarifications:
<ul id="ul0370" list-style="none">
    <li id="ul0370-0001" num="0000">
    <ul id="ul0371" list-style="none">
        <li id="ul0371-0001" num="1466">KeyIdentifierType: indicates either ModeAKeyIdentifier or a TemporaryModeAKeyIdentifier is used.</li>
        <li id="ul0371-0002" num="1467">KeyIdentifier: corresponds to either a ModeAKeyIdentifier or a TemporaryModeAKeyIdentifier as appropriate to the ModeAKeyIdentifierType.</li>
        <li id="ul0371-0003" num="1468">BasicMAC is computed using SUPL_INIT_Basic_IK=HMAC-SHA256-128(SUPL_INIT_ROOT_KEY, &#x201c;Mode A IK&#x201d;), using SUPL_INIT_ROOT_KEY associated with the KeyIdentifier above.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0441" num="1469">6.3.5.5 SLP Procedures</p>
<p id="p-0442" num="1470">The only Mode-A-specific SLP procedures relate to SUPL_INIT_ROOT_KEY Establishment, expiry of a SUPL_INIT_ROOT_KEY, and maintaining synchronization between the SET and SLP.</p>
<p id="p-0443" num="1471">The Mode A SUPL_INIT_ROOT_KEY Establishment Procedure is specified in Section 6.3.5.2. An SLP may perform the Mode A SUPL_INIT_ROOT_KEY Establishment Procedure in response to an out of sync indication by the SET (in SET Capabilities (sUPLINITRootKeyStatus=&#x201c;invalidSUPLINITRootKey&#x201d;)) or an (out of scope) internal decision of the SLP. That is, the SLP can send a SUPL_INIT_ROOT_KEY (with associated parameters) even when there is no corresponding indication by the SET.</p>
<p id="p-0444" num="1472">A SUPL_INIT_ROOT_KEY and associated parameters SHALL cease being valid in the SLP after the earlier of
<ul id="ul0372" list-style="none">
    <li id="ul0372-0001" num="0000">
    <ul id="ul0373" list-style="none">
        <li id="ul0373-0001" num="1473">The lifetime of the associated ModeAKeyIdentifier, and</li>
        <li id="ul0373-0002" num="1474">The time of a later successful Mode A SUPL_INIT_ROOT_KEY Establishment (Section 6.3.5.2).</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0445" num="1475">The Mode A Resynchronization Procedure is specified in Section 6.3.5.3. An SLP may perform the Mode A Resynchronization Procedure in response to an out of sync indication by the SET (in SET Capabilities (sUPLINITRootKeyStatus=&#x201c;outofsyncSUPLINITRootKey&#x201d;)) or an (out of scope) internal decision of the SLP. That is, the SLP can send a TemporaryModeAKeyIdentifier even when there is no corresponding indication by the SET.</p>
<p id="p-0446" num="1476">Following a successful Mode A SUPL_INIT_ROOT_KEY Establishment Procedure or successful Mode A Resynchronization Procedure, the SLP resets BasicLastReplayCounter to 0x0000.</p>
<p id="p-0447" num="1477">6.3.5.6 SET Procedures</p>
<p id="p-0448" num="1478">The only Mode-A-specific SET procedures relate to SUPL INIT ROOT_KEY Establishment, expiry of a SUPL_INIT_ROOT_KEY, and maintaining synchronization between the SET and SLP.</p>
<p id="p-0449" num="1479">The Mode A SUPL_INIT_ROOT_KEY Establishment Procedure is specified in Section 6.3.5.2. A SET may attempt to trigger a Mode A SUPL_INIT_ROOT_KEY Establishment Procedure by indicating that it does not have a valid SUPL_INIT_ROOT_KEY in the SET (in SET Capabilities (sUPLINITRootKeyStatus=&#x201c;invalidSUPLINITRootKey&#x201d;)) in a ULP message carrying the SET Capabilities parameter following a secure session establishment.</p>
<p id="p-0450" num="1480">An established SUPL_INIT_ROOT_KEY and associated parameters SHALL be considered invalid in the SET after the earlier of the following times.
<ul id="ul0374" list-style="none">
    <li id="ul0374-0001" num="0000">
    <ul id="ul0375" list-style="none">
        <li id="ul0375-0001" num="1481">The lifetime of the associated ModeAKeyIdentifier.</li>
        <li id="ul0375-0002" num="1482">Five minutes after the time of a later successful Mode A SUPL_INIT_ROOT_KEY Establishment (Section 6.3.5.2). This time delay allows for delivery of any SUPL INIT messages sent prior to the latest Mode A SUPL_INIT_ROOT_KEY Establishment procedure as such SUPL INIT message would have be protected using the former SUPL_INIT_ROOT_KEY.</li>
        <li id="ul0375-0003" num="1483">Any time that the SET detects corruption of the values of SUPL_INIT_ROOT_KEY, ModeAKeyIdentifier and ModeAKeyLifetime. If corruption occurs, then the SET shall initiate Exception procedures in Section 6.3.3.4.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0451" num="1484">Mode A Resynchronization Procedure is specified in Section 6.3.5.3. A SET may attempt to trigger a Mode A Resynchronization Procedure by indicating loss of synchronization in the SET (in SET Capabilities (sUPLINITRootKeyStatus=&#x201c;outofsyncSUPLINITRootKey&#x201d;)) in a ULP message carrying the SET Capabilities parameter following a secure session establishment.</p>
<p id="p-0452" num="1485">successful Mode A SUPL_INIT_ROOT_KEY Establishment Procedure or successful Mode A Resynchronization Procedure, the SET clears its cache of used values for BasicReplayCounter (since the SLP will have also reset BasicLastReplayCounter to 0x0000).</p>
<p id="p-0453" num="1486">6.3.7 Specifications for Using the Basic SUPL INIT Protector</p>
<p id="p-0454" num="1487">A Basic SUPL INIT Protector is used for both Mode A and Mode B SUPL INIT Protection includes the following parameters:
<ul id="ul0376" list-style="none">
    <li id="ul0376-0001" num="0000">
    <ul id="ul0377" list-style="none">
        <li id="ul0377-0001" num="1488">KeyIdentifierType</li>
        <li id="ul0377-0002" num="1489">KeyIdentifier: length=8 octets.</li>
        <li id="ul0377-0003" num="1490">BasicReplayCounter: length=2 octets.</li>
        <li id="ul0377-0004" num="1491">BasicMAC: length=4 octets.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0455" num="1492">The BasicMAC parameter is generated as follows:
<ul id="ul0378" list-style="none">
    <li id="ul0378-0001" num="0000">
    <ul id="ul0379" list-style="none">
        <li id="ul0379-0001" num="1493">BasicMAC=HMAC-SHA256-32(SUPL_INIT_Basic_IK, SUPL_INIT/REINIT&#x2032;), where</li>
        <li id="ul0379-0002" num="1494">SUPL_INIT_Basic_IK is derived according to sections 6.3.5 and 6.3.6 for Mode A and Mode B SUPL INIT protection respectively.</li>
        <li id="ul0379-0003" num="1495">SUPL_INIT/REINIT&#x2032; corresponding to the SUPL INIT/REINIT message with all parameters except BasicMAC assigned, and with the MAC parameter set to all zeroes, and</li>
        <li id="ul0379-0004" num="1496">HMAC-SHA256-32 and HMAC-SHA256-128 are specified in [HMAC].</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0456" num="1497">6.1.1.2 Overview of Supported Authentication Methods (Informative)
<ul id="ul0380" list-style="none">
    <li id="ul0380-0001" num="1498">(1) Generic Bootstrapping Architecture (GBA)-Based. TLS-PSK with Generic Bootstrapping Architecture (GBA) [3GPP 33.220], [3GPP 33.222], [3GPP2 S.S0114], [3GPP 24.109]. GBA provides mutual authentication capability based on shared secret that is derived using existing 3GPP/3GPP2 authentication mechanisms.
    <ul id="ul0381" list-style="none">
        <li id="ul0381-0001" num="1499">SET and SLP are mutually authenticated using TLS-PSK with Generic Bootstrapping Architecture (GBA).</li>
    </ul>
    </li>
    <li id="ul0380-0002" num="1500">(2) SEK based (only applicable to WIMAX SLP).
    <ul id="ul0382" list-style="none">
        <li id="ul0382-0001" num="1501">SET and SLP are mutually authenticated using TLS-PSK with SEK. The details of SEK method can be found in section 6.1.2.1.2.</li>
    </ul>
    </li>
    <li id="ul0380-0003" num="1502">(3) Device Certificate (DCert)-based. This AN-Independent method uses TLS with
    <ul id="ul0383" list-style="none">
        <li id="ul0383-0001" num="1503">RSA server certificate to authenticate the SLP to the SET,</li>
        <li id="ul0383-0002" num="1504">RSA client certificate to authenticate the SET to the SLP.</li>
    </ul>
    </li>
    <li id="ul0380-0004" num="1505">(4) Alternative Client authentication (ACA)-based. This uses TLS with
    <ul id="ul0384" list-style="none">
        <li id="ul0384-0001" num="1506">RSA certificate to authenticate the SLP to the SET,</li>
        <li id="ul0384-0002" num="1507">Alternative Client authentication of the SET to the SLP (see section 6.1.4). In this case, the SLP authenticates the SET by getting the bearer network to confirm the IP address associated with the SET Identifier (MSISDN etc.).</li>
    </ul>
    </li>
    <li id="ul0380-0005" num="1508">(5) SLP-only. This is used in scenarios where it is not possible for the SLP to authenticate the SET. This method SHALL NOT be used for non-emergency cases. The SET cannot distinguish between this method and ACA-based. This uses TLS with
    <ul id="ul0385" list-style="none">
        <li id="ul0385-0001" num="1509">An RSA certificate to authenticate the SLP to the SET,</li>
        <li id="ul0385-0002" num="1510">The SET is not authenticated.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0457" num="1511">6.1.2.1.1 Deployments Supporting the GBA Method</p>
<p id="p-0458" num="1512">In the case of deployments supporting (GBA [3GPP 33.220], [3GPP 24.109],[3GPP2 S.S0109]), the shared keys are established as follows:
<ul id="ul0386" list-style="none">
    <li id="ul0386-0001" num="0000">
    <ul id="ul0387" list-style="none">
        <li id="ul0387-0001" num="1513">When the SLP requests key material from the BSF (for securing IP communication and for protecting SUPL INIT and/or SUPL REINIT), the SLP MUST also request the USS (User security settings). The USS MUST include a permanent user identity (e.g. IMPI, IMSI or MSISDN).</li>
        <li id="ul0387-0002" num="1514">For securing IP communication between the SET and SLP, the SET and the SLP MUST derive a shared secret key and operate according to TLS-PSK using GBA ([3GPP 33.220], [3GPP 24.109], [3GPP 33.222], [3GPP2 S.S0109]). The SLP MUST have well defined domain name SLP_Address_FQDN designating the SLP, e.g., slp.operator.com. The GBA Ua security protocol identifier that shall be used for TLS-PSK is defined in OMNA Registry [OMNA]. The SLP MUST confirm that the permanent user identity provided by the BSF corresponds to the SET identity in SUPL messages received by the SLP over the corresponding secured connection.</li>
        <li id="ul0387-0003" num="1515">For MAC protection of SUPL INIT and/or SUPL REINIT, keys are derived according to GBA ([3GPP 33.220], [3GPP2 S.S0109]). The GBA Ua security protocol identifier that shall be used for SUPL INIT protection is defined in OMNA Registry [OMNA]. The keyIdentifier of the basicMAC included in the SUPL INIT message (or SUPL REINIT message) MUST be the B-TID of the Ks from which the Ks_NAF is generated. NOTE: The D/H-SLP request for SUPL INIT protection keys from the BSF would typically occur simultaneously with the D/H-SLP request for the keys securing IP communication.</li>
        <li id="ul0387-0004" num="1516">The SET MUST ensure that it is always provisioned with a valid Ks. If no valid Ks is present then the SET MUST initiate the GBA Bootstrapping procedure to provision Ks. A new Ks MUST be established each time a new UICC (USIM/SIM/R-UIM) is detected by the SET. Additionally, the SET MUST establish new shared keys when the Ks_NAFs lifetime (set by the Home Network operator) expires.
<br/>
10.8 SET Capabilities
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0459" num="1517">
<tables id="TABLE-US-00015" num="00015">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="77pt" align="left"/>
<colspec colname="2" colwidth="42pt" align="left"/>
<colspec colname="3" colwidth="98pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry>Parameter</entry>
<entry>Presence</entry>
<entry>Value/Description</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>SET capabilities</entry>
<entry>&#x2014;</entry>
<entry>SET capabilities (not</entry>
</row>
<row>
<entry/>
<entry/>
<entry>mutually exclusive) in</entry>
</row>
<row>
<entry/>
<entry/>
<entry>terms of supported</entry>
</row>
<row>
<entry/>
<entry/>
<entry>positioning technologies</entry>
</row>
<row>
<entry/>
<entry/>
<entry>and positioning protocols.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>During a particular SUPL</entry>
</row>
<row>
<entry/>
<entry/>
<entry>session, a SET may send</entry>
</row>
<row>
<entry/>
<entry/>
<entry>its capabilities more than</entry>
</row>
<row>
<entry/>
<entry/>
<entry>once - specifically, in SET</entry>
</row>
<row>
<entry/>
<entry/>
<entry>initiated cases, the SET</entry>
</row>
<row>
<entry/>
<entry/>
<entry>capabilities are sent in</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SUPL START, SUPL</entry>
</row>
<row>
<entry/>
<entry/>
<entry>TRIGGERED START and</entry>
</row>
<row>
<entry/>
<entry/>
<entry>in SUPL POS INIT. For</entry>
</row>
<row>
<entry/>
<entry/>
<entry>immediate requests, the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SET capabilities MUST</entry>
</row>
<row>
<entry/>
<entry/>
<entry>NOT change during this</entry>
</row>
<row>
<entry/>
<entry/>
<entry>particular session. For</entry>
</row>
<row>
<entry/>
<entry/>
<entry>triggered requests, the SET</entry>
</row>
<row>
<entry/>
<entry/>
<entry>capabilities MAY change</entry>
</row>
<row>
<entry/>
<entry/>
<entry>during a session.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>The SET Capabilities</entry>
</row>
<row>
<entry/>
<entry/>
<entry>parameter MAY also be</entry>
</row>
<row>
<entry/>
<entry/>
<entry>used by the SET to inform</entry>
</row>
<row>
<entry/>
<entry/>
<entry>the H-SLP or D-SLP about</entry>
</row>
<row>
<entry/>
<entry/>
<entry>its service capabilities.</entry>
</row>
<row>
<entry>&#x3e;Pos Technology</entry>
<entry>M</entry>
<entry>This parameter does not apply</entry>
</row>
<row>
<entry/>
<entry/>
<entry>to SUPL 3.0</entry>
</row>
<row>
<entry>&#x3e;&#x3e;GANSS Position</entry>
<entry>O</entry>
<entry>This parameter is not</entry>
</row>
<row>
<entry>Methods</entry>
<entry/>
<entry>applicable in SUPL 3.0</entry>
</row>
<row>
<entry/>
<entry/>
<entry>and SHALL not be used.</entry>
</row>
<row>
<entry>&#x3e;Pref Method</entry>
<entry>M</entry>
<entry>This parameter is not</entry>
</row>
<row>
<entry/>
<entry/>
<entry>applicable in SUPL 3.0</entry>
</row>
<row>
<entry>&#x3e;Pos Protocol</entry>
<entry>M</entry>
<entry>Zero or more of the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>following positioning</entry>
</row>
<row>
<entry/>
<entry/>
<entry>protocols (bitmap):</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Appendix A. TIA-801</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Appendix B. LPP</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Appendix C. LPPe</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Flags for legacy positioning</entry>
</row>
<row>
<entry/>
<entry/>
<entry>protocols (RRLP and RRC)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SHALL be set to FALSE.</entry>
</row>
<row>
<entry>&#x3e;&#x3e;Pos Protocol</entry>
<entry>CV</entry>
<entry>Describes the protocol</entry>
</row>
<row>
<entry>Version TIA-801</entry>
<entry/>
<entry>version of 3GPP2 C.S0022</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(TIA-801) Positioning</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Protocol.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>It is required if TIA-801 is</entry>
</row>
<row>
<entry/>
<entry/>
<entry>identified in the Pos</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Protocol parameter.</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e;Supported Pos</entry>
<entry>M</entry>
<entry>Specifies a list of up to 8</entry>
</row>
<row>
<entry>Protocol Version</entry>
<entry/>
<entry>different supported 3GPP2</entry>
</row>
<row>
<entry>TIA-801</entry>
<entry/>
<entry>C.S0022 versions. This</entry>
</row>
<row>
<entry/>
<entry/>
<entry>parameter is required (with</entry>
</row>
<row>
<entry/>
<entry/>
<entry>at least one entry in the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>list) if TIA-801 is</entry>
</row>
<row>
<entry/>
<entry/>
<entry>identified in the Pos</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Protocol parameter.</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e;&#x3e;Revision</entry>
<entry>M</entry>
<entry>Revision part of document</entry>
</row>
<row>
<entry>Number</entry>
<entry/>
<entry>number for the specifications</entry>
</row>
<row>
<entry/>
<entry/>
<entry>of C.S0022 Positioning</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Protocol.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Value: [0, A-Z]</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e;&#x3e;Point Release</entry>
<entry>M</entry>
<entry>Point Release number for</entry>
</row>
<row>
<entry>Number</entry>
<entry/>
<entry>C.S0022, range: (0 . . . 255)</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e;Internal Edit</entry>
<entry>M</entry>
<entry>Internal Edit Level for</entry>
</row>
<row>
<entry>Level</entry>
<entry/>
<entry>C.S0022, range: (0 . . . 255)</entry>
</row>
<row>
<entry>&#x3e;&#x3e;Pos Protocol</entry>
<entry>CV</entry>
<entry>Describes the protocol</entry>
</row>
<row>
<entry>Version LPP</entry>
<entry/>
<entry>version of LPP Positioning</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Protocol.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>It is required if LPP is</entry>
</row>
<row>
<entry/>
<entry/>
<entry>identified in the Pos Protocol</entry>
</row>
<row>
<entry/>
<entry/>
<entry>parameter.</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e;Major Version</entry>
<entry>M</entry>
<entry>First (most significant)</entry>
</row>
<row>
<entry>Field</entry>
<entry/>
<entry>element of the version number</entry>
</row>
<row>
<entry/>
<entry/>
<entry>for LPP Positioning Protocol,</entry>
</row>
<row>
<entry/>
<entry/>
<entry>range: (0 . . . 255)</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e;Technical</entry>
<entry>M</entry>
<entry>Second element of the version</entry>
</row>
<row>
<entry>Version Field</entry>
<entry/>
<entry>number for LPP Positioning</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Protocol, range: (0 . . . 255)</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e;Editorial Version</entry>
<entry>M</entry>
<entry>Third (least significant)</entry>
</row>
<row>
<entry>Field</entry>
<entry/>
<entry>element of the version number</entry>
</row>
<row>
<entry/>
<entry/>
<entry>for LPP Positioning Protocol,</entry>
</row>
<row>
<entry/>
<entry/>
<entry>range: (0 . . . 255)</entry>
</row>
<row>
<entry>&#x3e;&#x3e;Pos Protocol</entry>
<entry>CV</entry>
<entry>Describes the protocol</entry>
</row>
<row>
<entry>Version LPPe</entry>
<entry/>
<entry>version of LPPe</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Positioning Protocol.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>It is required if LPPe is</entry>
</row>
<row>
<entry/>
<entry/>
<entry>identified in the Pos Protocol</entry>
</row>
<row>
<entry/>
<entry/>
<entry>parameter.</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e;Major Version</entry>
<entry>M</entry>
<entry>First (most significant)</entry>
</row>
<row>
<entry>Field</entry>
<entry/>
<entry>element of the version number</entry>
</row>
<row>
<entry/>
<entry/>
<entry>for LPPe Positioning Protocol,</entry>
</row>
<row>
<entry/>
<entry/>
<entry>range: (0 . . . 255)</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e;Minor Version</entry>
<entry>M</entry>
<entry>Second element of the version</entry>
</row>
<row>
<entry>Field</entry>
<entry/>
<entry>number for LPPe Positioning</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Protocol, range: (0 . . . 255)</entry>
</row>
<row>
<entry>&#x3e;Service Capabilities</entry>
<entry>O</entry>
<entry>The service capabilities of the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SET are described in this</entry>
</row>
<row>
<entry/>
<entry/>
<entry>parameter. The SET MAY</entry>
</row>
<row>
<entry/>
<entry/>
<entry>send this parameter in SUPL</entry>
</row>
<row>
<entry/>
<entry/>
<entry>START, SUPL POS INIT,</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SUPL TRIGGERED START</entry>
</row>
<row>
<entry/>
<entry/>
<entry>and SUPL END. The purpose</entry>
</row>
<row>
<entry/>
<entry/>
<entry>of this parameter is to inform</entry>
</row>
<row>
<entry/>
<entry/>
<entry>the H-SLP or D-SLP about the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>service capabilities of the SET</entry>
</row>
<row>
<entry>&#x3e;&#x3e;services supported</entry>
<entry>M</entry>
<entry>Defines the supported</entry>
</row>
<row>
<entry/>
<entry/>
<entry>services by the SET. Only</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Network Initiated services</entry>
</row>
<row>
<entry/>
<entry/>
<entry>are relevant in this context.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Zero or more of the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>following services are</entry>
</row>
<row>
<entry/>
<entry/>
<entry>supported:</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Periodic Trigger</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Area Event Trigger</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Velocity Event Trigger</entry>
</row>
<row>
<entry>&#x3e;&#x3e;reporting</entry>
<entry>CV</entry>
<entry>Defines the reporting</entry>
</row>
<row>
<entry>capabilities</entry>
<entry/>
<entry>capabilities of the SET. This</entry>
</row>
<row>
<entry/>
<entry/>
<entry>parameter is only required if</entry>
</row>
<row>
<entry/>
<entry/>
<entry>periodic triggers are supported</entry>
</row>
<row>
<entry/>
<entry/>
<entry>by the SET in which case the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>parameter is mandatory.</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e;minimum</entry>
<entry>M</entry>
<entry>Defines the minimum interval</entry>
</row>
<row>
<entry>interval between fixes</entry>
<entry/>
<entry>between fixes allowed by the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SET.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>This parameter is used by the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>H-SLP or D-SLP to avoid</entry>
</row>
<row>
<entry/>
<entry/>
<entry>conflict between the desired</entry>
</row>
<row>
<entry/>
<entry/>
<entry>interval between fixes and the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SET's capabilities. Range: 1</entry>
</row>
<row>
<entry/>
<entry/>
<entry>to 3600, Units in seconds.</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e;maximum</entry>
<entry>O</entry>
<entry>Defines the maximum interval</entry>
</row>
<row>
<entry>interval between fixes</entry>
<entry/>
<entry>between fixes allowed by the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SET.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>This parameter is used by the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>H-SLP or D-SLP to avoid</entry>
</row>
<row>
<entry/>
<entry/>
<entry>conflict between the desired</entry>
</row>
<row>
<entry/>
<entry/>
<entry>interval between fixes and the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SET's capabilities. This</entry>
</row>
<row>
<entry/>
<entry/>
<entry>parameter is optional. If not</entry>
</row>
<row>
<entry/>
<entry/>
<entry>present, no maximum interval</entry>
</row>
<row>
<entry/>
<entry/>
<entry>between fixes is specified.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Range: 1 to 1440, Units in</entry>
</row>
<row>
<entry/>
<entry/>
<entry>minutes.</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e;rep mode</entry>
<entry>M</entry>
<entry>Supported reporting</entry>
</row>
<row>
<entry/>
<entry/>
<entry>mode(s):</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Real time</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Quasi real time</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Batch reporting</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(At least one of the three</entry>
</row>
<row>
<entry/>
<entry/>
<entry>reporting modes must be</entry>
</row>
<row>
<entry/>
<entry/>
<entry>supported)</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e;batch rep cap</entry>
<entry>CV</entry>
<entry>Defines the type of batch</entry>
</row>
<row>
<entry/>
<entry/>
<entry>reporting capabilities</entry>
</row>
<row>
<entry/>
<entry/>
<entry>supported by the SET</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(only applicable to quasi</entry>
</row>
<row>
<entry/>
<entry/>
<entry>real time and batch</entry>
</row>
<row>
<entry/>
<entry/>
<entry>reporting):</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Report position (true if</entry>
</row>
<row>
<entry/>
<entry/>
<entry>reporting of position is</entry>
</row>
<row>
<entry/>
<entry/>
<entry>allowed, false otherwise)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Report measurements</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(true if reporting of</entry>
</row>
<row>
<entry/>
<entry/>
<entry>measurements is</entry>
</row>
<row>
<entry/>
<entry/>
<entry>supported, false</entry>
</row>
<row>
<entry/>
<entry/>
<entry>otherwise)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Maximum number of</entry>
</row>
<row>
<entry/>
<entry/>
<entry>positions (range: 1 to</entry>
</row>
<row>
<entry/>
<entry/>
<entry>1024)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Maximum number of</entry>
</row>
<row>
<entry/>
<entry/>
<entry>measurements (range: 1 to</entry>
</row>
<row>
<entry/>
<entry/>
<entry>1024)</entry>
</row>
<row>
<entry>&#x3e;&#x3e;event trigger</entry>
<entry>CV</entry>
<entry>Defines the event trigger</entry>
</row>
<row>
<entry>capabilities</entry>
<entry/>
<entry>capabilities of the SET. This</entry>
</row>
<row>
<entry/>
<entry/>
<entry>parameter is only required if</entry>
</row>
<row>
<entry/>
<entry/>
<entry>area event triggers are</entry>
</row>
<row>
<entry/>
<entry/>
<entry>supported by the SET in</entry>
</row>
<row>
<entry/>
<entry/>
<entry>which case the parameter is</entry>
</row>
<row>
<entry/>
<entry/>
<entry>mandatory.</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e; geo area shapes</entry>
<entry>M</entry>
<entry>This parameter defines the</entry>
</row>
<row>
<entry>supported</entry>
<entry/>
<entry>geographic target area shapes</entry>
</row>
<row>
<entry/>
<entry/>
<entry>supported by the SET in</entry>
</row>
<row>
<entry/>
<entry/>
<entry>addition to mandatory circular</entry>
</row>
<row>
<entry/>
<entry/>
<entry>area:</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Elliptical</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Polygon</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e; max number of</entry>
<entry>O</entry>
<entry>This parameter defines the</entry>
</row>
<row>
<entry>geographical target</entry>
<entry/>
<entry>maximum number of</entry>
</row>
<row>
<entry>areas supported</entry>
<entry/>
<entry>geographic target areas the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SET supports. (range: 1 to</entry>
</row>
<row>
<entry/>
<entry/>
<entry>32)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>This parameter is optional. If</entry>
</row>
<row>
<entry/>
<entry/>
<entry>not present, the SET does not</entry>
</row>
<row>
<entry/>
<entry/>
<entry>support geographical target</entry>
</row>
<row>
<entry/>
<entry/>
<entry>areas.</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e; max number of</entry>
<entry>O</entry>
<entry>This parameter defines the</entry>
</row>
<row>
<entry>Area Id Lists</entry>
<entry/>
<entry>maximum number of Area</entry>
</row>
<row>
<entry>supported</entry>
<entry/>
<entry>Id Lists the SET supports.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(range: 1 to 32)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>This parameter is optional. If</entry>
</row>
<row>
<entry/>
<entry/>
<entry>not present, the SET does not</entry>
</row>
<row>
<entry/>
<entry/>
<entry>support Area Ids.</entry>
</row>
<row>
<entry>&#x3e;&#x3e;&#x3e; max number of</entry>
<entry>CV</entry>
<entry>This parameter defines the</entry>
</row>
<row>
<entry>Area Ids supported</entry>
<entry/>
<entry>maximum number of Area</entry>
</row>
<row>
<entry>per Area Id List</entry>
<entry/>
<entry>Ids per Area Id List the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SET supports. (range: 1 to</entry>
</row>
<row>
<entry/>
<entry/>
<entry>256)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>This parameter is</entry>
</row>
<row>
<entry/>
<entry/>
<entry>conditional: if max</entry>
</row>
<row>
<entry/>
<entry/>
<entry>number of Area Id Lists is</entry>
</row>
<row>
<entry/>
<entry/>
<entry>present, then this</entry>
</row>
<row>
<entry/>
<entry/>
<entry>parameter MUST be</entry>
</row>
<row>
<entry/>
<entry/>
<entry>present. Otherwise this</entry>
</row>
<row>
<entry/>
<entry/>
<entry>parameter MUST NOT be</entry>
</row>
<row>
<entry/>
<entry/>
<entry>present.</entry>
</row>
<row>
<entry>&#x3e;&#x3e;session capabilities</entry>
<entry>M</entry>
<entry>Defines the session</entry>
</row>
<row>
<entry/>
<entry/>
<entry>capabilities of the SET:</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Total number of</entry>
</row>
<row>
<entry/>
<entry/>
<entry>simultaneous sessions</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(range: 1 to 128).</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Maximum number of</entry>
</row>
<row>
<entry/>
<entry/>
<entry>simultaneous periodic</entry>
</row>
<row>
<entry/>
<entry/>
<entry>triggered sessions (only</entry>
</row>
<row>
<entry/>
<entry/>
<entry>used for periodic triggers)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(range: 1 to 32).</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Maximum number of</entry>
</row>
<row>
<entry/>
<entry/>
<entry>simultaneous area event</entry>
</row>
<row>
<entry/>
<entry/>
<entry>triggered sessions (only</entry>
</row>
<row>
<entry/>
<entry/>
<entry>used for area event</entry>
</row>
<row>
<entry/>
<entry/>
<entry>triggers) (range: 1 to 32).</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Maximum number of</entry>
</row>
<row>
<entry/>
<entry/>
<entry>simultaneous velocity</entry>
</row>
<row>
<entry/>
<entry/>
<entry>event triggered sessions</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(only used for velocity</entry>
</row>
<row>
<entry/>
<entry/>
<entry>event triggers) (range: 1</entry>
</row>
<row>
<entry/>
<entry/>
<entry>to 32).</entry>
</row>
<row>
<entry>&#x3e; supported bearers</entry>
<entry>O</entry>
<entry>This parameter is not</entry>
</row>
<row>
<entry/>
<entry/>
<entry>applicable in SUPL 3.0.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>This parameter SHALL</entry>
</row>
<row>
<entry/>
<entry/>
<entry>NOT be used.</entry>
</row>
<row>
<entry>&#x3e;QoPCapabilities</entry>
<entry>O</entry>
<entry>This parameter defines the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>ability of the SET for</entry>
</row>
<row>
<entry/>
<entry/>
<entry>reporting and/or receiving</entry>
</row>
<row>
<entry/>
<entry/>
<entry>high accuracy position</entry>
</row>
<row>
<entry/>
<entry/>
<entry>and/or velocity results.</entry>
</row>
<row>
<entry>&#x3e;Civic Position</entry>
<entry>O</entry>
<entry>This parameter defines the</entry>
</row>
<row>
<entry>Capabilities</entry>
<entry/>
<entry>ability of the SET to</entry>
</row>
<row>
<entry/>
<entry/>
<entry>support absolute civic</entry>
</row>
<row>
<entry/>
<entry/>
<entry>positioning.</entry>
</row>
<row>
<entry>&#x3e;Relative Position</entry>
<entry>O</entry>
<entry>This parameter defines the</entry>
</row>
<row>
<entry>Capabilities</entry>
<entry/>
<entry>ability of the SET to</entry>
</row>
<row>
<entry/>
<entry/>
<entry>support relative</entry>
</row>
<row>
<entry/>
<entry/>
<entry>positioning.</entry>
</row>
<row>
<entry>&#x3e; D-SLP Provision</entry>
<entry>O</entry>
<entry>This field indicates</entry>
</row>
<row>
<entry>from H-SLP</entry>
<entry/>
<entry>whether the SET supports</entry>
</row>
<row>
<entry/>
<entry/>
<entry>provision of authorized D-</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SLP addresses from the H-</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SLP.</entry>
</row>
<row>
<entry>&#x3e; E-SLP Provision-</entry>
<entry>O</entry>
<entry>This field indicates</entry>
</row>
<row>
<entry>from-H-SLP</entry>
<entry/>
<entry>whether the SET supports</entry>
</row>
<row>
<entry/>
<entry/>
<entry>provision of authorized E-</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SLP addresses from the H-</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SLP.</entry>
</row>
<row>
<entry>&#x3e; D-SLP Provision</entry>
<entry>O</entry>
<entry>This field indicates</entry>
</row>
<row>
<entry>from Proxy D-SLP</entry>
<entry/>
<entry>whether the SET supports</entry>
</row>
<row>
<entry/>
<entry/>
<entry>provision of authorized D-</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SLP addresses from a</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Proxy D-SLP.</entry>
</row>
<row>
<entry>&#x3e; E-SLP Provision</entry>
<entry>O</entry>
<entry>This field indicates</entry>
</row>
<row>
<entry>from-Proxy-E-SLP</entry>
<entry/>
<entry>whether the SET supports</entry>
</row>
<row>
<entry/>
<entry/>
<entry>provision of authorized E-</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SLP addresses from a</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Proxy E-SLP.</entry>
</row>
<row>
<entry>&#x3e; D-SLP Notification</entry>
<entry>O</entry>
<entry>This field indicates</entry>
</row>
<row>
<entry>to H-SLP</entry>
<entry/>
<entry>whether the SET is able to</entry>
</row>
<row>
<entry/>
<entry/>
<entry>notify the H-SLP when the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SET changes access to a</entry>
</row>
<row>
<entry/>
<entry/>
<entry>D-SLP.</entry>
</row>
<row>
<entry>&#x3e; Sensor Support</entry>
<entry>CV</entry>
<entry>Defines whether the SET</entry>
</row>
<row>
<entry/>
<entry/>
<entry>is able to use sensors to</entry>
</row>
<row>
<entry/>
<entry/>
<entry>calculate location</entry>
</row>
<row>
<entry/>
<entry/>
<entry>estimates and/or velocity</entry>
</row>
<row>
<entry/>
<entry/>
<entry>estimates. If the SET</entry>
</row>
<row>
<entry/>
<entry/>
<entry>supports</entry>
</row>
<row>
<entry/>
<entry/>
<entry>positioning/velocity</entry>
</row>
<row>
<entry/>
<entry/>
<entry>sensors, this parameter</entry>
</row>
<row>
<entry/>
<entry/>
<entry>MUST be included.</entry>
</row>
<row>
<entry>SUPL INIT Root Key</entry>
<entry>CV</entry>
<entry>This parameter is</entry>
</row>
<row>
<entry>Status</entry>
<entry/>
<entry>conditional and MAY only</entry>
</row>
<row>
<entry/>
<entry/>
<entry>be used if Mode A SUPL</entry>
</row>
<row>
<entry/>
<entry/>
<entry>INIT protection is used.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>For NULL SUPL INIT</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Protection and Mode B</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SUPL INIT Protection,</entry>
</row>
<row>
<entry/>
<entry/>
<entry>this parameter SHALL</entry>
</row>
<row>
<entry/>
<entry/>
<entry>NOT be used.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>This parameter is used by</entry>
</row>
<row>
<entry/>
<entry/>
<entry>the SET to indicate to the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SLP one of the following</entry>
</row>
<row>
<entry/>
<entry/>
<entry>conditions:</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Invalid SUPL INIT</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Root Key</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Out of Sync SUPL</entry>
</row>
<row>
<entry/>
<entry/>
<entry>INIT Root Key</entry>
</row>
<row>
<entry/>
<entry/>
<entry>This parameter SHALL be</entry>
</row>
<row>
<entry/>
<entry/>
<entry>sent and set to &#x201c;Invalid</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SUPL INIT Root Key&#x201d; if</entry>
</row>
<row>
<entry/>
<entry/>
<entry>the SET does not have a</entry>
</row>
<row>
<entry/>
<entry/>
<entry>valid SUPL INIT Root</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Key. It SHALL be sent</entry>
</row>
<row>
<entry/>
<entry/>
<entry>and set to &#x201c;Out of Sync</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SUPL INIT Root Key&#x201d; if</entry>
</row>
<row>
<entry/>
<entry/>
<entry>the SET's SUPL INIT</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Root Key is out of sync. If</entry>
</row>
<row>
<entry/>
<entry/>
<entry>the SET has a valid SUPL</entry>
</row>
<row>
<entry/>
<entry/>
<entry>INIT Root Key which is in</entry>
</row>
<row>
<entry/>
<entry/>
<entry>sync, this parameter</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SHALL NOT be sent.</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<heading id="h-0018" level="1">SET Capabilities Parameter</heading>
<p id="p-0460" num="1518">9.2.8 SUPL END</p>
<p id="p-0461" num="1519">SUPL END is the message that ends the SUPL procedure, normally or abnormally.</p>
<p id="p-0462" num="1520">
<tables id="TABLE-US-00016" num="00016">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="70pt" align="left"/>
<colspec colname="2" colwidth="42pt" align="left"/>
<colspec colname="3" colwidth="91pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Parameter</entry>
<entry>Presence</entry>
<entry>Description</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>Position</entry>
<entry>O</entry>
<entry>Defines the position result</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>of the SET.</entry>
</row>
<row>
<entry/>
<entry>Status Code</entry>
<entry>O</entry>
<entry>Defines the Status of the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>message as either an error</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>indication or an</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>information indication.</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>Error indications have</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>values between 0 and 99,</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>information indications</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>have values between 100</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>and 199.</entry>
</row>
<row>
<entry/>
<entry>Ver</entry>
<entry>CV</entry>
<entry>This parameter contains the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>hash of the SUPL</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>INIT/SUPL REINIT</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>message and is calculated</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>by the SET. This parameter</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>MUST be present in</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>situations where the SUPL</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>END message is sent as a</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>direct response to a SUPL</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>INIT/SUPL REINIT</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>message.</entry>
</row>
<row>
<entry/>
<entry>SET Capabilities</entry>
<entry>O</entry>
<entry>Defines the SET</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>Capabilities of the SET.</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>This parameter MAY be</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>used if the SUPL END</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>message is sent from the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SET to the SLP.</entry>
</row>
<row>
<entry/>
<entry>Location URI Set</entry>
<entry>O</entry>
<entry>This parameter contains a</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>set of one or more location</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>URIs. This parameter</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>MAY only be included if</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>the SUPL END message is</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>sent from the SLP to the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SET and if the SET had</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>previously requested a</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>Location URI from the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SLP.</entry>
</row>
<row>
<entry/>
<entry>SLP Authorization</entry>
<entry>CV</entry>
<entry>This parameter is included</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>in a response to a D-SLP or</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>E-SLP Query from the SET</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>to the H-SLP, Proxy D-</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SLP or Proxy E-SLP. The</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>parameter may also be</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>included when terminating</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>a Session Info Query from</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>the H-SLP or a Proxy D-</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SLP. The parameter</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>provides one or more</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>authorized D-SLP and/or</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>E-SLP addresses and may</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>include limitations on the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>use of each address. The</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>parameter may also be used</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>to support unsolicited</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>provision of D-SLP and/or</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>E-SLP addresses by the H-</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SLP or by a Proxy D-SLP</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>at the end of any SUPL</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>session based on the SET</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>location, serving access</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>network and/or neighboring</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>access networks. This is</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>allowed whenever the SET</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>capabilities indicate</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>support for the particular</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>type of D-SLP or E-SLP</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>provision. Any D-SLP</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>addresses or E-SLP</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>addresses provided by an</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>H-SLP or Proxy D-SLP</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>then replace any previous</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>D-SLP or E-SLP addresses,</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>respectively, that were</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>provided earlier by the H-</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SLP or the same Proxy D-</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SLP, respectively. Other</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>provided D-SLP and E-</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SLP addresses are not</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>affected except that</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>removal of a Proxy D/E-</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SLP address also removes</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>all D-SLP or E-SLP</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>addresses that may have</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>been provided by the Proxy</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>D/E-SLP.</entry>
</row>
<row>
<entry/>
<entry>Relative Position</entry>
<entry>O</entry>
<entry>This parameter defines the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>position result relative to a</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>reference point or another</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SET (relative position).</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>This parameter is only</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>applicable when sent from</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>the SLP to the SET.</entry>
</row>
<row>
<entry/>
<entry>Civic Position</entry>
<entry>O</entry>
<entry>This parameter defines the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>position result as civic</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>address. This parameter is</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>only applicable when sent</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>from the SLP to the SET.</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>The presence of this</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>parameter is</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>implementation dependent.</entry>
</row>
<row>
<entry/>
<entry>SUPL INIT Key</entry>
<entry>CV</entry>
<entry>This parameter is</entry>
</row>
<row>
<entry/>
<entry>Response</entry>
<entry/>
<entry>conditional and SHALL</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>only be used for Mode A</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SUPL_INIT_ROOT_KEY</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>Establishment (see section</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>6.3.5.2).</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>This parameter SHALL</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>only be used if SUPL END</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>is sent from the SLP to the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>SET.</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<heading id="h-0019" level="1">SUPL END Message</heading>
<p id="p-0463" num="1521">10.x SUPL INIT Key Response</p>
<p id="p-0464" num="1522">The SUPL INIT Key Response parameter is used in the SUPL_INIT_ROOT_KEY Establishment procedure (see section 6.3.5.2) to send Keys for Mode A SUPL INIT Protection from the SLP to the SET.</p>
<p id="p-0465" num="1523">
<tables id="TABLE-US-00017" num="00017">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="98pt" align="left"/>
<colspec colname="2" colwidth="35pt" align="left"/>
<colspec colname="3" colwidth="126pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry>Parameter </entry>
<entry>Presence</entry>
<entry>Value/Description</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>SUPL INIT Key Response</entry>
<entry>&#x2014;</entry>
<entry>Used in the Mode A</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SUPL_INIT_ROOT_KEY</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Establishment Procedure</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(section 6.3.5.2) and the Mode</entry>
</row>
<row>
<entry/>
<entry/>
<entry>A Resynchronization Procedure</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(section 6.3.5.3)</entry>
</row>
<row>
<entry>&#x3e; Mode A Key Establishment</entry>
<entry>CV</entry>
<entry>This parameter is conditional</entry>
</row>
<row>
<entry/>
<entry/>
<entry>and SHALL be sent in case of Mode A</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SUPL_INIT_ROOT_KEY</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Establishment Procedure</entry>
</row>
<row>
<entry>&#x3e;&#x3e;Mode A Key Identifier</entry>
<entry>M</entry>
<entry>This parameter represents the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>ModeAKeyIdentifier (see section 6.3.5.1)</entry>
</row>
<row>
<entry>&#x3e;&#x3e;Temporary Mode A</entry>
<entry>M</entry>
<entry>This parameter represents the</entry>
</row>
<row>
<entry>Key Identifier</entry>
<entry/>
<entry>TemporaryModeAKeyIdentifier</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(see section 6.3.5.1)</entry>
</row>
<row>
<entry>&#x3e;&#x3e; SUPL_INIT_ROOT_KEY</entry>
<entry>M</entry>
<entry>This parameter represents the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SUPL_INIT_ROOT_KEY used</entry>
</row>
<row>
<entry/>
<entry/>
<entry>for SUPL Init Protection.</entry>
</row>
<row>
<entry>&#x3e;&#x3e; Mode A Key Lifetime</entry>
<entry>M</entry>
<entry>This parameter represents the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>ModeAKeyLifetime parameter</entry>
</row>
<row>
<entry/>
<entry/>
<entry>which defines the time when</entry>
</row>
<row>
<entry/>
<entry/>
<entry>the SUPL_INIT_ROOT_KEY</entry>
</row>
<row>
<entry/>
<entry/>
<entry>ceases being valid. The lifetime</entry>
</row>
<row>
<entry/>
<entry/>
<entry>value is expressed in UTC time.</entry>
</row>
<row>
<entry>&#x3e; Mode A Resync</entry>
<entry>CV</entry>
<entry>This parameter is conditional</entry>
</row>
<row>
<entry/>
<entry/>
<entry>and SHALL be sent in case of</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Mode A Resynchromization</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Procedure.</entry>
</row>
<row>
<entry>&#x3e;&#x3e; Mode A Key Identifier</entry>
<entry>M</entry>
<entry>This parameter represents the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>ModeAKeyIdentifier (see section 6.3.5.1)</entry>
</row>
<row>
<entry>&#x3e;&#x3e; Temporary Mode A</entry>
<entry>M</entry>
<entry>This parameter represents the</entry>
</row>
<row>
<entry>Key Identifier</entry>
<entry/>
<entry>TemporaryModeAKeyIdentifier</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(see section 6.3.5.1)</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<heading id="h-0020" level="1">SUPL INIT Key Response</heading>
<p id="p-0466" num="1524">11.4 Message Extensions (SUPL Version 3)</p>
<p id="p-0467" num="1525">
<tables id="TABLE-US-00018" num="00018">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="280pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>ULP-Version-3 -message-extensions DEFINITIONS AUTOMATIC TAGS ::=</entry>
</row>
<row>
<entry>BEGIN</entry>
</row>
<row>
<entry>EXPORTS</entry>
</row>
<row>
<entry>Ver3 -SUPL-INIT-extension, Ver3-SUPL-START-extension, Ver3-SUPL-POS-INIT-extension,</entry>
</row>
<row>
<entry>Ver3 -SUPL-END-extension, Ver3 -SUPL-RESPONSE-extension, Ver3-SUPL-TRIGGERED-</entry>
</row>
<row>
<entry>RESPONSE-extension, Ver3-SUPL-TRIGGERED-START-extension, Ver3-SUPL-TRIGGERED-</entry>
</row>
<row>
<entry>STOP-extension, Ver3-SUPL-SET-INIT-extension, Ver3 -SUPL-NOTIFY-extension, Ver3 -SUPL-</entry>
</row>
<row>
<entry>NOTIFY-RESPONSE-extension, Ver3 -SUPL-REPORT-extension, QoPCapabilities,</entry>
</row>
<row>
<entry>RelativePositioningCapabilities, CivicPositioningCapabilities;</entry>
</row>
<row>
<entry>IMPORTS</entry>
</row>
<row>
<entry>&#x2003;Ver, QoP, FQDN</entry>
</row>
<row>
<entry>FROM ULP-Components</entry>
</row>
<row>
<entry>&#x2003;CircularArea, EllipticalArea, PolygonArea</entry>
</row>
<row>
<entry>FROM Ver2-ULP-Components</entry>
</row>
<row>
<entry>&#x2003;PosProtocolVersion3GPP, PosProtocolVersion3GPP2</entry>
</row>
<row>
<entry>FROM ULP-Version-2-parameter-extensions</entry>
</row>
<row>
<entry>&#x2003;PosProtocolVersionOMA</entry>
</row>
<row>
<entry>FROM ULP-Version-3-parameter-extensions</entry>
</row>
<row>
<entry>&#x2003;PosPayLoad</entry>
</row>
<row>
<entry>FROM SUPL-POS</entry>
</row>
<row>
<entry>&#x2003;Notification</entry>
</row>
<row>
<entry>FROM SUPL-INIT</entry>
</row>
<row>
<entry>&#x2003;SessionID</entry>
</row>
<row>
<entry>FROM ULP-Components</entry>
</row>
<row>
<entry>&#x2003;NotificationResponse</entry>
</row>
<row>
<entry>FROM SUPL-NOTIFY-RESPONSE</entry>
</row>
<row>
<entry>&#x2003;maxnumSessions, SessionList</entry>
</row>
<row>
<entry>FROM SUPL-REPORT</entry>
</row>
<row>
<entry>&#x2003;OMA-LPPe-RelativeLocation, OMA-LPPe-ReferencePointUniqueID, OMA-LPPe-CivicLocation</entry>
</row>
<row>
<entry>FROM OMA-LPPE;</entry>
</row>
<row>
<entry>[Some unchanged portions removed for brevity]</entry>
</row>
<row>
<entry>Ver3-SUPL-END-extension ::= SEQUENCE {</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="147pt" align="left"/>
<colspec colname="2" colwidth="133pt" align="left"/>
<tbody valign="top">
<row>
<entry>&#x2003;locationURISet</entry>
<entry>LocationURISet OPTIONAL,</entry>
</row>
<row>
<entry>&#x2003;slpAuthorization</entry>
<entry>SLPAuthorization OPTIONAL,</entry>
</row>
<row>
<entry>&#x2003;relativePosition</entry>
<entry>OMA-LPPe-RelativeLocation OPTIONAL,</entry>
</row>
<row>
<entry>&#x2003;civicPosition</entry>
<entry>OMA-LPP-CivicLocation OPTIONAL,</entry>
</row>
<row>
<entry>&#x2003;sULPINITKeyResponse </entry>
<entry>SULPINITKeyResponse OPTIONAL,</entry>
</row>
<row>
<entry>. . .}</entry>
<entry/>
</row>
<row>
<entry>[Some unchanged portions removed for brevity]</entry>
<entry/>
</row>
<row>
<entry>SULPINITKeyResponse ::= CHOICE {</entry>
<entry/>
</row>
<row>
<entry>&#x2003;modeAKeyEstablishment</entry>
<entry>ModeAKeyEstablishment,</entry>
</row>
<row>
<entry>&#x2003;modeAResynch</entry>
<entry>ModeAResynch,</entry>
</row>
<row>
<entry>. . .}</entry>
<entry/>
</row>
<row>
<entry>ModeAKeyEstablishment ::= SEQUENCE {</entry>
<entry/>
</row>
<row>
<entry>&#x2003;modeAKeyIdentifier</entry>
<entry>OCTET STRING(SIZE (8)),</entry>
</row>
<row>
<entry>&#x2003;temporaryModeAKeyIdentifier</entry>
<entry>OCTET STRING(SIZE (8)),</entry>
</row>
<row>
<entry>&#x2003;sUPLINITROOTKEY</entry>
<entry>&#x2003;BIT STRING(SIZE (128)),</entry>
</row>
<row>
<entry>&#x2003;ModeAKeyLifetime</entry>
<entry>UTCTime,</entry>
</row>
<row>
<entry>. . .}</entry>
<entry/>
</row>
<row>
<entry>ModeAResynch ::= SEQUENCE {</entry>
<entry/>
</row>
<row>
<entry>&#x2003;modeAKeyIdentifier</entry>
<entry>OCTET STRING(SIZE (8)),</entry>
</row>
<row>
<entry>&#x2003;temporaryModeAKeyIdentifier</entry>
<entry>OCTET STRING(SIZE (8)),</entry>
</row>
<row>
<entry>. . .}</entry>
<entry/>
</row>
<row>
<entry>END</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0468" num="1526">11.6 Parameter Extensions (SUPL Version 3)</p>
<p id="p-0469" num="1527">
<tables id="TABLE-US-00019" num="00019">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="343pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>ULP-Version-3-parameter-extensions DEFINITIONS AUTOMATIC TAGS ::=</entry>
</row>
<row>
<entry>BEGIN</entry>
</row>
<row>
<entry>EXPORTS</entry>
</row>
<row>
<entry>Ver3-PosProtocol-extension, Ver3-SETCapabilities-extension, Ver3-SLPCapabilities-extension,</entry>
</row>
<row>
<entry>Ver3-TriggerParams-extension, Ver3-ServiceSupported-extensions;</entry>
</row>
<row>
<entry>IMPORTS</entry>
</row>
<row>
<entry>&#x2003;QoPCapabilities, RelativePositioningCapabilities, CivicPositioningCapabilities</entry>
</row>
<row>
<entry>FROM ULP-Version-3-message-extensions;</entry>
</row>
<row>
<entry>Ver3-PosProtocol-extension ::= SEQUENCE {</entry>
</row>
<row>
<entry>&#x2003;posProtocolVersionLPPe PosProtocolVersionOMA OPTIONAL,</entry>
</row>
<row>
<entry>. . .}</entry>
</row>
<row>
<entry>Ver3-SETCapabilities-extension ::= SEQUENCE {</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="224pt" align="left"/>
<colspec colname="2" colwidth="119pt" align="left"/>
<tbody valign="top">
<row>
<entry>&#x2003;&#x2003;qoPCapabilities</entry>
<entry>QoPCapabilities OPTIONAL,</entry>
</row>
<row>
<entry>&#x2003;&#x2003;civicPositioningCapabilities CivicPositioningCapabilities OPTIONAL,</entry>
<entry/>
</row>
<row>
<entry>&#x2003;&#x2003;relativePositioningCapabilities</entry>
<entry>RelativePositioningCapabilities</entry>
</row>
<row>
<entry>OPTIONAL,</entry>
<entry/>
</row>
<row>
<entry>&#x2003;&#x2003;d-SLP-Provision-from-H-SLP</entry>
<entry>&#x2003;&#x2003;BOOLEAN,</entry>
</row>
<row>
<entry>&#x2003;&#x2003;e-SLP-Provision-from-H-SLP</entry>
<entry>&#x2003;&#x2003;BOOLEAN,</entry>
</row>
<row>
<entry>&#x2003;&#x2003;d-SLP-Provision-from-Proxy-D-SLP</entry>
<entry>&#x2003;BOOLEAN,</entry>
</row>
<row>
<entry>&#x2003;&#x2003;e-SLP-Provision-from-Proxy-E-SLP</entry>
<entry>&#x2003;BOOLEAN,</entry>
</row>
<row>
<entry>&#x2003;&#x2003;d-SLP-Notification-to-H-SLP</entry>
<entry>&#x2003;&#x2003;BOOLEAN,</entry>
</row>
<row>
<entry>&#x2003;&#x2003;sensorSupport</entry>
<entry>&#x2003;&#x2003;BOOLEAN,</entry>
</row>
<row>
<entry>&#x2003;&#x2003;sUPLINITRootKeyStatus</entry>
<entry>SUPLINITRootKeyStatus OPTIONAL,</entry>
</row>
<row>
<entry>. . .}</entry>
<entry/>
</row>
<row>
<entry>SUPLINITRootKeyStatus ::= ENUMERATED {invalidSUPLINITRootKey(0),</entry>
<entry/>
</row>
<row>
<entry>outofsyncSUPLINITRootKey(1), . . .}</entry>
<entry/>
</row>
<row>
<entry>[Some unchanged portions removed for brevity]</entry>
<entry/>
</row>
<row>
<entry>END</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
Additional Embodiment 9
</p>
<p id="p-0470" num="1528">A prior definition of the Protection Level Parameter may not reflect the fact that Basic Protection has been changed to Mode A Protection and Mode B Protection (Mode B Protection being the same as the previous Basic Protection). A prior ASN.1 definition also may be updated. Thus, the following proposals may be incorporated into SUPL 3.0 to modify section 10.25 to reflect Mode A and Mode B protection and to update ASN.1 section 11.4 as well (section numbers may refer to SUPL 3.0 sections).</p>
<p id="p-0471" num="1529">10.22 Protection Level</p>
<p id="p-0472" num="1530">The Protection Level parameter defines the level of protection for the SUPL INIT/SUPL REINIT message.</p>
<p id="p-0473" num="1531">
<tables id="TABLE-US-00020" num="00020">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="35pt" align="left"/>
<colspec colname="3" colwidth="140pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry>Parameter</entry>
<entry>Presence</entry>
<entry>Value/Description</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>Protection</entry>
<entry>&#x2014;</entry>
<entry>This parameter defines the protection level of</entry>
</row>
<row>
<entry>Level</entry>
<entry/>
<entry>the SUPL INIT/SUPL REINIT protection. This</entry>
</row>
<row>
<entry/>
<entry/>
<entry>parameter is optional. If not present, Null</entry>
</row>
<row>
<entry/>
<entry/>
<entry>protection is assumed.</entry>
</row>
<row>
<entry>&#x3e; Level</entry>
<entry>M</entry>
<entry>Null Protection</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Basic Protection (not applicable in SUPL 3.0</entry>
</row>
<row>
<entry/>
<entry/>
<entry>i.e., the SLP SHALL NOT select this</entry>
</row>
<row>
<entry/>
<entry/>
<entry>protection level)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Mode A Protection</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Mode B Protection</entry>
</row>
<row>
<entry>&#x3e; Basic</entry>
<entry>CV</entry>
<entry>This parameter is only present if the protection</entry>
</row>
<row>
<entry>Protection</entry>
<entry/>
<entry>level is Basic Protection.</entry>
</row>
<row>
<entry>Parameters</entry>
<entry/>
<entry>Key-Identifier (= B-TID)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Basic Replay Counter</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Basic MAC</entry>
</row>
<row>
<entry/>
<entry/>
<entry>This parameter SHALL NOT be used since</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Basic Protection is not supported in SUPL 3.0.</entry>
</row>
<row>
<entry>&#x3e; Protection</entry>
<entry>CV</entry>
<entry>This value is only present if protection level is</entry>
</row>
<row>
<entry>Parameter</entry>
<entry/>
<entry>Mode A Protection or Mode B Protection.</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Key Identifier Type</entry>
</row>
<row>
<entry/>
<entry/>
<entry>ModeAKeyIdentifier</entry>
</row>
<row>
<entry/>
<entry/>
<entry>TemporaryModeAKeyIdentifier</entry>
</row>
<row>
<entry/>
<entry/>
<entry>ModeBKeyIdentifier</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Key Identifier</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Basic Replay Counter</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Basic MAC</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Note that the Key Identifier comes in three</entry>
</row>
<row>
<entry/>
<entry/>
<entry>different Types (Key Identifier Type): (1)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>ModeAKeyIdentifier, (2)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>TemporaryModeAKeyIdentifier and (3)</entry>
</row>
<row>
<entry/>
<entry/>
<entry>ModeBKeyIdentifier. (1) and (2) apply to</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Mode A Protection whereas (3) applies to</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Mode B Protection.</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0474" num="1532">11.3 Message Extensions (SUPL Version 2)</p>
<p id="p-0475" num="1533">
<tables id="TABLE-US-00021" num="00021">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="280pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>ULP-Version-2-message-extensions DEFINITIONS AUTOMATIC TAGS ::=</entry>
</row>
<row>
<entry>BEGIN</entry>
</row>
<row>
<entry>EXPORTS</entry>
</row>
<row>
<entry>Ver2-SUPL-INIT-extension, Ver2-SUPL-START-extension, Ver2-SUPL-RESPONSE-extension,</entry>
</row>
<row>
<entry>Ver2-SUPL-POS-INIT-extension, Ver2-SUPL-POS-extension, Ver2-SUPL-END-extension;</entry>
</row>
<row>
<entry>IMPORTS</entry>
</row>
<row>
<entry>&#x2003;SLPAddress, Position, Ver</entry>
</row>
<row>
<entry>FROM ULP-Components</entry>
</row>
<row>
<entry>&#x2003;SETCapabilities</entry>
</row>
<row>
<entry>FROM SUPL-START</entry>
</row>
<row>
<entry>&#x2003;SupportedNetworkInformation, GNSSPosTechnology, MultipleLocationIds, UTRAN-</entry>
</row>
<row>
<entry>GPSReferenceTimeResult, UTRAN-GANSSReferenceTimeResult, UTRAN-</entry>
</row>
<row>
<entry>GPSReferenceTimeAssistance, UTRAN-GANSSReferenceTimeAssistance, SPCSETKey,</entry>
</row>
<row>
<entry>SPCTID, SPCSETKeylifetime, ThirdParty, ApplicationID</entry>
</row>
<row>
<entry>FROM Ver2-ULP-Components</entry>
</row>
<row>
<entry>&#x2003;TriggerType</entry>
</row>
<row>
<entry>FROM SUPL-TRIGGERED-START</entry>
</row>
<row>
<entry>&#x2003;Ver3-ProtectionLevel-extension</entry>
</row>
<row>
<entry>FROM ULP-Version-3 -parameter-extensions;</entry>
</row>
<row>
<entry>[Some unchanged portions removed for brevity]</entry>
</row>
<row>
<entry>ProtectionLevel ::= SEQUENCE {</entry>
</row>
<row>
<entry>&#x2003;protlevel ProtLevel,</entry>
</row>
<row>
<entry>&#x2003;basicProtectionParams BasicProtectionParams OPTIONAL, -- not applicable in SUPL 3.0</entry>
</row>
<row>
<entry>. . .,</entry>
</row>
<row>
<entry>&#x2003;ver3-ProtectionLevel-extension Ver3-ProtectionLevel-extension OPTIONAL}</entry>
</row>
<row>
<entry>ProtLevel ::= ENUMERATED {</entry>
</row>
<row>
<entry>&#x2003;nullProtection(0), basicProtection(1), . . ., ver3-modeAProtection(2), ver3-modeBProtection(3)}-</entry>
</row>
<row>
<entry>basicProtection(1) is not applicable in SUPL 3.0</entry>
</row>
<row>
<entry>[Some unchanged portions removed for brevity]</entry>
</row>
<row>
<entry>END</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0476" num="1534">11.6 Parameter Extensions (SUPL Version 3)</p>
<p id="p-0477" num="1535">
<tables id="TABLE-US-00022" num="00022">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="371pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>ULP-Version-3-parameter-extensions DEFINITIONS AUTOMATIC TAGS ::=</entry>
</row>
<row>
<entry>BEGIN</entry>
</row>
<row>
<entry>EXPORTS</entry>
</row>
<row>
<entry>Ver3-PosProtocol-extension, Ver3-SETCapabilities-extension, Ver3-SLPCapabilities-extension,</entry>
</row>
<row>
<entry>Ver3-TriggerParams-extension, Ver3-ServiceSupported-extensions, Ver3-ProtectionLevel-</entry>
</row>
<row>
<entry>extension;</entry>
</row>
<row>
<entry>IMPORTS</entry>
</row>
<row>
<entry>&#x2003;QoPCapabilities, RelativePositioningCapabilities, CivicPositioningCapabilities</entry>
</row>
<row>
<entry>FROM ULP-Version-3-message-extensions;</entry>
</row>
<row>
<entry>[Some unchanged portions removed for brevity]</entry>
</row>
<row>
<entry>Ver3-ProtectionLevel-extension ::= SEQUENCE {</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="280pt" align="left"/>
<colspec colname="2" colwidth="91pt" align="left"/>
<tbody valign="top">
<row>
<entry>&#x2003;keyIdentifierType</entry>
<entry>KeyIdentifierType,</entry>
</row>
<row>
<entry>&#x2003;keyIdentifier</entry>
<entry>OCTET STRING(SIZE (8)),</entry>
</row>
<row>
<entry>&#x2003;basicReplayCounter </entry>
<entry>INTEGER(0..65535),</entry>
</row>
<row>
<entry>&#x2003;basicMAC</entry>
<entry>&#x2003;BIT STRING(SIZE (32)),</entry>
</row>
<row>
<entry>. . .}</entry>
<entry/>
</row>
<row>
<entry>KeyIdentifierType ::= ENUMERATED {</entry>
<entry/>
</row>
<row>
<entry>&#x2003;ModeAKeyIdentifier(0), TemporaryModeAKeyIdentifier(1), ModeBKeyIdentifier(2), . . .}</entry>
<entry/>
</row>
<row>
<entry>END</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0478" num="1536">Those of skill would further appreciate that the various illustrative logical blocks, configurations, modules, circuits, and algorithm steps described in connection with the embodiments disclosed herein may be implemented as electronic hardware, computer software executed by a processing device such as a hardware processor, or combinations of both. Various illustrative components, blocks, configurations, modules, circuits, and steps have been described above generally in terms of their functionality. Whether such functionality is implemented as hardware or executable software depends upon the particular application and design constraints imposed on the overall system. Skilled artisans may implement the described functionality in varying ways for each particular application, but such implementation decisions should not be interpreted as causing a departure from the scope of the present disclosure.</p>
<p id="p-0479" num="1537">The steps of a method or algorithm described in connection with the embodiments disclosed herein may be embodied directly in hardware, in a software module executed by a processor, firmware, or in a combination thereof. A software or logic module may reside in a non-transitory storage medium such as random access memory (RAM), magnetoresistive random access memory (MRAM), spin-torque transfer MRAM (STT-MRAM), flash memory, read-only memory (ROM), programmable read-only memory (PROM), erasable programmable read-only memory (EPROM), electrically erasable programmable read-only memory (EEPROM), registers, hard disk, a removable disk, a compact disc read-only memory (CD-ROM), digital versatile disc (DVD), Blu-ray disc, or any other form of storage medium known in the art. Combinations of the above should also be included within the scope of computer-readable media. Examples include computer-readable media encoded with a data structure and computer-readable media encoded with a computer program. Computer-readable media may take the form of an article of manufacture. An exemplary storage medium is coupled to the processor such that the processor can read information from, and write information to, the storage medium. In the alternative, the storage medium may be integral to the processor. The processor and the storage medium may reside in an application-specific integrated circuit (ASIC). The ASIC may reside in a computing device or a user terminal. In the alternative, the processor and the storage medium may reside as discrete components in a computing device or a user terminal. Thus, methodologies described herein can be implemented by various means depending upon the application. For example, these methodologies can be implemented in hardware, firmware, software, or a combination thereof.</p>
<p id="p-0480" num="1538">In addition, or as an alternative to ASICs and processors, hardware implementations may include digital signal processing devices (DSPDs), programmable logic devices (PLDs), field programmable gate arrays (FPGAs), processors, controllers, micro-controllers, microprocessors, electronic devices, other electronic units designed to perform the functions described herein, or a combination thereof. Herein, the term &#x201c;control logic&#x201d; encompasses logic implemented by software, hardware, firmware, or a combination.</p>
<p id="p-0481" num="1539">For an implementation involving firmware and/or software, the methodologies can be implemented with modules (e.g., procedures, functions, and so on) that perform the functions described herein. Any machine readable medium tangibly embodying instructions can be used in implementing the methodologies described herein. For example, software codes can be stored in a memory and executed by a processing unit. Memory can be implemented within the processing unit or external to the processing unit. As used herein the term &#x201c;memory&#x201d; refers to any type of long term, short term, volatile, nonvolatile, or other storage devices and is not to be limited to any particular type of memory or number of memories, or type of media upon which memory is stored. In an implementation involving firmware and/or software, the functions may be stored as one or more instructions or code on a computer-readable medium.</p>
<p id="p-0482" num="1540">The disclosure may be implemented in conjunction with Wi-Fi/WLAN or other wireless networks. In addition to Wi-Fi/WLAN signals, a wireless/mobile station may also receive signals from satellites, which may be from a Global Positioning System (GPS), Galileo, GLONASS, NAVSTAR, QZSS, a system that uses satellites from a combination of these systems, or any SPS developed in the future, each referred to generally herein as a Satellite Positioning System (SPS) or GNSS (Global Navigation Satellite System). The disclosure may also be implemented in conjunction with pseudolites or a combination of systems that includes pseudolites. The disclosure may be implemented in conjunction with femtocells or a combination of systems that includes femtocells.</p>
<p id="p-0483" num="1541">The disclosure may be implemented in conjunction with various wireless communication networks such as a wireless wide area network (WWAN), a wireless local area network (WLAN), a wireless personal area network (WPAN), and so on. The terms &#x201c;network&#x201d; and &#x201c;system&#x201d; are often used interchangeably. The terms &#x201c;position&#x201d; and &#x201c;location&#x201d; are often used interchangeably. A WWAN may be a Code Division Multiple Access (CDMA) network, a Time Division Multiple Access (TDMA) network, a Frequency Division Multiple Access (FDMA) network, an Orthogonal Frequency Division Multiple Access (OFDMA) network, a Single-Carrier Frequency Division Multiple Access (SC-FDMA) network, a Long Term Evolution (LTE) network, a WiMAX (IEEE 802.16) network and so on. A CDMA network may implement one or more radio access technologies (RATs) such as cdma2000, Wideband-CDMA (W-CDMA), and so on. Cdma2000 includes IS-95, IS-2000, and IS-856 standards. A TDMA network may implement Global System for Mobile Communications (GSM), Digital Advanced Mobile Phone System (D-AMPS), or some other RAT. GSM and W-CDMA are described in documents from a consortium named &#x201c;3rd Generation Partnership Project&#x201d; (3GPP). Cdma2000 is described in documents from a consortium named &#x201c;3rd Generation Partnership Project 2&#x201d; (3GPP2). 3GPP and 3GPP2 documents are publicly available. A WLAN may be an IEEE 802.11x network, and a WPAN may be a Bluetooth network, an IEEE 802.15x, or some other type of network. The techniques may also be implemented in conjunction with any combination of WWAN, WLAN and/or WPAN.</p>
<p id="p-0484" num="1542">A satellite positioning system (SPS) typically includes a system of transmitters positioned to enable entities to determine their location on or above the Earth based, at least in part, on signals received from the transmitters. Such a transmitter typically transmits a signal marked with a repeating pseudo-random noise (PN) code of a set number of chips and may be located on ground based control stations, user equipment and/or space vehicles. In a particular example, such transmitters may be located on Earth orbiting satellite vehicles (SVs). For example, a SV in a constellation of Global Navigation Satellite System (GNSS) such as Global Positioning System (GPS), Galileo, Glonass or Compass may transmit a signal marked with a PN code that is distinguishable from PN codes transmitted by other SVs in the constellation (e.g., using different PN codes for each satellite as in GPS or using the same code on different frequencies as in Glonass). In accordance with certain aspects, the techniques presented herein are not restricted to global systems (e.g., GNSS) for SPS. For example, the techniques provided herein may be applied to or otherwise enabled for use in various regional systems, such as, e.g., Quasi-Zenith Satellite System (QZSS) over Japan, Indian Regional Navigational Satellite System (IRNSS) over India, Beidou over China, etc., and/or various augmentation systems (e.g., an Satellite Based Augmentation System (SBAS)) that may be associated with or otherwise enabled for use with one or more global and/or regional navigation satellite systems. By way of example but not limitation, an SBAS may include an augmentation system(s) that provides integrity information, differential corrections, etc., such as, e.g., Wide Area Augmentation System (WAAS), European Geostationary Navigation Overlay Service (EGNOS), Multi-functional Satellite Augmentation System (MSAS), GPS Aided Geo Augmented Navigation or GPS and Geo Augmented Navigation system (GAGAN), and/or the like. Thus, as used herein an SPS may include any combination of one or more global and/or regional navigation satellite systems and/or augmentation systems, and SPS signals may include SPS, SPS-like, and/or other signals associated with such one or more SPS.</p>
<p id="p-0485" num="1543">The methodologies may be used with positioning determination systems that utilize pseudolites or a combination of satellites and pseudolites. Pseudolites are ground-based transmitters that broadcast a PN code or other ranging code (similar to a GPS or CDMA cellular signal) modulated on an L-band (or other frequency) carrier signal, which may be synchronized with GPS time. Each such transmitter may be assigned a unique PN code so as to permit identification by a remote receiver. Pseudolites are useful in situations where signals from an orbiting satellite might be unavailable, such as in tunnels, mines, buildings, urban canyons or other enclosed areas. Another implementation of pseudolites is known as radio-beacons. The term &#x201c;satellite&#x201d;, as used herein, is intended to include pseudolites, equivalents of pseudolites, and possibly others. The term &#x201c;SPS signals,&#x201d; as used herein, is intended to include SPS-like signals from pseudolites or equivalents of pseudolites.</p>
<p id="p-0486" num="1544">A mobile station (e.g., MS or STA) refers to a device such as a cellular or other wireless communication device, personal communication system (PCS) device, personal navigation device (PND), Personal Information Manager (PIM), Personal Digital Assistant (PDA), laptop, tablet, netbook, smartbook or other suitable mobile device which is capable of receiving wireless communication and/or navigation signals. The term &#x201c;mobile station&#x201d; is also intended to include devices which communicate with a personal navigation device (PND), such as by short-range wireless, infrared, wireline connection, or other connection&#x2014;regardless of whether satellite signal reception, assistance data reception, and/or position-related processing occurs at the device or at the PND. Also, &#x201c;mobile station&#x201d; is intended to include all devices, including wireless communication devices, computers, laptops, etc. which are capable of communication with a server, such as via the Internet, Wi-Fi, or other network, and regardless of whether satellite signal reception, assistance data reception, and/or position-related processing occurs at the device, at a server, or at another device associated with the network. Any operable combination of the above are also considered a &#x201c;mobile station.&#x201d; The terms &#x201c;mobile station&#x201d; and &#x201c;mobile device&#x201d; are often used interchangeably.</p>
<p id="p-0487" num="1545">This disclosure includes example embodiments; however, other implementations can be used. Designation that something is &#x201c;optimized,&#x201d; &#x201c;required&#x201d; or other designation does not indicate that the current disclosure applies only to systems that are optimized, or systems in which the &#x201c;required&#x201d; elements are present (or other limitation due to other designations). These designations refer only to the particular described implementation. Of course, many implementations are possible. The techniques can be used with protocols other than those discussed herein, including protocols that are in development or to be developed.</p>
<p id="p-0488" num="1546">The previous description of the disclosed embodiments is provided to enable a person skilled in the art to make or use the disclosed embodiments. Various modifications to these embodiments will be readily apparent to those skilled in the art, and the principles defined herein may be applied to other embodiments without departing from the scope of the disclosure. Thus, the present disclosure is not intended to be limited to the embodiments shown herein but is to be accorded the widest scope possible consistent with the principles and novel features as defined by the following claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of authentication, comprising:
<claim-text>receiving, at a mobile device, a server certificate including a public key of a secure user plane location (SUPL) location platform (SLP);</claim-text>
<claim-text>storing, at the mobile device, at least one security credential that is specific to the mobile device, wherein the at least one security credential includes a device identifier of the mobile device; and</claim-text>
<claim-text>transmitting the at least one security credential to the SLP to authenticate the mobile device as associated with a SUPL user based on a comparison of the device identifier to a stored device identifier, wherein the at least one security credential is transmitted in a message configured to be decrypted by a secret key of the SLP.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the at least one security credential includes a public key of the mobile device.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the device identifier includes at least one of an international mobile equipment identity (IMEI), a mobile station identification (MSID), and a serial number of the mobile device.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the at least one security credential includes a device certificate of the mobile device.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the at least one security credential is stored at a universal integrated smart card (UICC) of the mobile device, a secure portion of a memory of the mobile device, or any combination thereof.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the mobile device comprises a SUPL enabled terminal (SET).</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the mobile device transmits the at least one security credential to the SLP via a network that operates in accordance with an Institute of Electrical and Electronics Engineers (IEEE) 802.11 standard.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. An apparatus comprising:
<claim-text>a non-transitory memory configured to:
<claim-text>receive a server certificate including a public key of a secure user plane location (SUPL) location platform (SLP) and</claim-text>
<claim-text>store at least one security credential that is specific to a mobile device, wherein the at least one security credential includes a device identifier of the mobile device; and</claim-text>
</claim-text>
<claim-text>a processor configured to cause the mobile device to transmit the at least one security credential to the SLP to authenticate the mobile device as associated with a SUPL user based on a comparison of the device identifier to a stored device identifier, wherein the at least one security credential is configured to be transmitted in a message configured to be decrypted by a secret key of the SLP.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the at least one security credential includes at least one of a device certificate of the mobile device, a public key of the mobile device, an international mobile equipment identity (IMEI), a mobile station identification (MSID), and a serial number of the mobile device.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. An apparatus comprising:
<claim-text>means for receiving, at a mobile device, a server certificate including a public key of a secure user plane location (SUPL) location platform (SLP);</claim-text>
<claim-text>means for storing at least one security credential that is specific to a mobile device, wherein the at least one security credential includes a device identifier of the mobile device; and</claim-text>
<claim-text>means for causing the mobile device to transmit the at least one security credential to the SLP to authenticate the mobile device as associated with a SUPL user based on a comparison of the device identifier to a stored device identifier, wherein the at least one security credential is transmitted in a message configured to be decrypted by a secret key of the SLP.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The apparatus of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the mobile device comprises a SUPL enabled terminal (SET).</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A method comprising:
<claim-text>sending a server certificate including a public key of a web server to a secure user plane location (SUPL)-enabled mobile device;</claim-text>
<claim-text>receiving, at the web server, a message from the mobile device, wherein the message includes a security credential of the mobile device;</claim-text>
<claim-text>decrypting the message using a secret key of the web server;</claim-text>
<claim-text>receiving, at the web server, user identification information from the mobile device; and</claim-text>
<claim-text>authenticating the user identification information as identifying an authorized user of a SUPL service.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the security credential includes a device certificate that includes a public key of the mobile device.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the security credential includes at least one of an international mobile equipment identity (IMEI), a mobile station identification (MSID), and a serial number of the mobile device.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the user identification information includes an identifier and a password.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. An apparatus comprising:
<claim-text>a processor; and</claim-text>
<claim-text>a memory coupled to the processor, wherein the memory is configured to store instructions; and</claim-text>
<claim-text>wherein when the instructions are executed by the processor, the processor is configured to:</claim-text>
<claim-text>send a server certificate including a public key of a web server to a secure user plane location (SUPL)-enabled mobile device;</claim-text>
<claim-text>receive, at the web server, a message from the mobile device, wherein the message includes a security credential of the mobile device;</claim-text>
<claim-text>decrypt the message using a secret key of the web server;</claim-text>
<claim-text>receive, at the web server, user identification information from the mobile device; and</claim-text>
<claim-text>authenticate the user identification information as identifying an authorized user of a SUPL service.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The apparatus of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the security credential includes a device certificate that includes a public key of the mobile device.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. An apparatus, comprising:
<claim-text>means for sending a server certificate including a public key of a web server to a secure user plane location (SUPL)-enabled mobile device;</claim-text>
<claim-text>means for receiving, at the web server, a message from the mobile device, wherein the message includes a security credential of the mobile device;</claim-text>
<claim-text>means for decrypting the message using a secret key of the web server;</claim-text>
<claim-text>means for receiving, at the web server, user identification information from the mobile device; and</claim-text>
<claim-text>means for authenticating the user identification information as identifying an authorized user of a SUPL service.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The apparatus of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein the security credential includes a device certificate that includes a public key of the mobile device.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. A non-transitory processor-readable medium comprising instructions that, when executed by a processor, cause the processor to:
<claim-text>send a server certificate including a public key of a web server to a secure user plane location (SUPL)-enabled mobile device;</claim-text>
<claim-text>receive, at the web server, a message from the mobile device, wherein the message includes a security credential of the mobile device;</claim-text>
<claim-text>decrypt the message using a secret key of the web server;</claim-text>
<claim-text>receive, at the web server, user identification information from the mobile device; and</claim-text>
<claim-text>authenticate the user identification information as identifying an authorized user of a SUPL service.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The non-transitory processor-readable medium of <claim-ref idref="CLM-00020">claim 20</claim-ref>, wherein the security credential includes a device certificate that includes a public key of the mobile device.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. A non-transitory processor-readable medium comprising instructions that, when executed by a processor, cause the processor to:
<claim-text>receive a server certificate including a public key of a secure user plane location (SUPL) location platform (SLP) and store at least one security credential that is specific to a mobile device, wherein the at least one security credential includes a device identifier of the mobile device; and</claim-text>
<claim-text>transmit the at least one security credential to the SLP to authenticate the mobile device as associated with a SUPL user based on a comparison of the device identifier to a stored device identifier, wherein the at least one security credential is configured to be transmitted in a message configured to be decrypted by a secret key of the SLP. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
