<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08626974-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08626974</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13354018</doc-number>
<date>20120119</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<us-term-extension>150</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>13</main-group>
<subgroup>36</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>710306</main-classification>
</classification-national>
<invention-title id="d2e53">Methods and systems for reduced signal path count for interconnect signals within a storage system expander</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>7882509</doc-number>
<kind>B2</kind>
<name>Jones et al.</name>
<date>20110200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>8149704</doc-number>
<kind>B2</kind>
<name>Hasegawa et al.</name>
<date>20120400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370232</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>8219794</doc-number>
<kind>B1</kind>
<name>Wang et al.</name>
<date>20120700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713  2</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2006/0015654</doc-number>
<kind>A1</kind>
<name>Krantz et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710  5</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2006/0047908</doc-number>
<kind>A1</kind>
<name>Chikusa et al.</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711114</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2007/0073947</doc-number>
<kind>A1</kind>
<name>Lau et al.</name>
<date>20070300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710110</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2009/0119413</doc-number>
<kind>A1</kind>
<name>Seto</name>
<date>20090500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709245</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2010/0281172</doc-number>
<kind>A1</kind>
<name>Parry et al.</name>
<date>20101100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709228</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2011/0022736</doc-number>
<kind>A1</kind>
<name>Uddenberg et al.</name>
<date>20110100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2011/0032889</doc-number>
<kind>A1</kind>
<name>Lee et al.</name>
<date>20110200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370329</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2011/0099243</doc-number>
<kind>A1</kind>
<name>Keels et al.</name>
<date>20110400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709212</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2011/0131375</doc-number>
<kind>A1</kind>
<name>Noeldner et al.</name>
<date>20110600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711114</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2012/0054404</doc-number>
<kind>A1</kind>
<name>Day</name>
<date>20120300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710308</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2012/0240017</doc-number>
<kind>A1</kind>
<name>Uchida</name>
<date>20120900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714821</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2012/0311256</doc-number>
<kind>A1</kind>
<name>Nakajima et al.</name>
<date>20121200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711114</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>EP</country>
<doc-number>2163997</doc-number>
<kind>A1</kind>
<date>20100300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-cpc-text>G06F 13/40</classification-cpc-text>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>JP</country>
<doc-number>2009181317</doc-number>
<kind>A</kind>
<date>20090800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-cpc-text>G06F 3/06</classification-cpc-text>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>JP</country>
<doc-number>2010061665</doc-number>
<kind>A</kind>
<date>20100300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-cpc-text>G06F 13/14</classification-cpc-text>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>JP</country>
<doc-number>2012108905</doc-number>
<kind>A</kind>
<date>20120600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-cpc-text>G06F 13/14</classification-cpc-text>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>JP</country>
<doc-number>2012141943</doc-number>
<kind>A</kind>
<date>20120700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-cpc-text>G06F 13/10</classification-cpc-text>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>JP</country>
<doc-number>2012226736</doc-number>
<kind>A</kind>
<date>20121100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-cpc-text>G06F 3/00</classification-cpc-text>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>WO</country>
<doc-number>WO 2007006267</doc-number>
<kind>A1</kind>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-cpc-text>G06F 13/40</classification-cpc-text>
</us-citation>
<us-citation>
<nplcit num="00023">
<othercit>Cai, Y.; Fang, L.; Ratemo, R.; Liu, J.; Gross, K.; Kozma, M., &#x201c;A test case for 3Gbps serial attached SCSI (SAS),&#x201d; Test Conference, 2005. Proceedings. ITC 2005. IEEE International , pp. 9 pp. 660, Nov. 8-8, 2005.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00024">
<othercit>Mutnury, B.; Cases, M.; Nam Pham; De Araujo, D.N.; Matoglu, E.; Patel, P.; Hermann, B., &#x201c;Analysis of fully buffered DIMM interface in high-speed server applications,&#x201d;Electronic Components and Technology Conference, 2006. Proceedings. 56th , pp. 6.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00025">
<othercit>Nanju Na; Tao Wang; Baumgartner, S.; Mandrekar, R.; Yaping Zhou, &#x201c;Link analysis and design of high speed storage buses in backplane and cabling environments,&#x201d; Electronic Components and Technology Conference (ECTC), 2010 Proceedings 60th , pp. 1929,1934, Jun. 1-4, 2010.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00026">
<othercit>Wang, W.Y.H.; Tow Chong Chong, &#x201c;An Ethernet based data storage protocol for home network,&#x201d; Consumer Electronics, IEEE Transactions on , vol. 50, No. 2, pp. 543,551, May 2004.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
</us-references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>710306</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>5</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20130191573</doc-number>
<kind>A1</kind>
<date>20130725</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Raghavan</last-name>
<first-name>Ramprasad</first-name>
<address>
<city>Pune</city>
<country>IN</country>
</address>
</addressbook>
<residence>
<country>IN</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Bastimane</last-name>
<first-name>Alpana</first-name>
<address>
<city>Pune</city>
<country>IN</country>
</address>
</addressbook>
<residence>
<country>IN</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Raghavan</last-name>
<first-name>Ramprasad</first-name>
<address>
<city>Pune</city>
<country>IN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Bastimane</last-name>
<first-name>Alpana</first-name>
<address>
<city>Pune</city>
<country>IN</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Duft Bornsen &#x26; Fettig</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>LSI Corporation</orgname>
<role>02</role>
<address>
<city>Milpitas</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Zaman</last-name>
<first-name>Faisal M</first-name>
<department>2111</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Methods and systems for reducing the signal path count between circuits within a SAS expander used for establishing SAS connections. The system comprises a SAS expander. The SAS expander comprises a plurality of link layer control circuits, each link layer control circuit adapted to communicatively couple with a SAS device. The SAS expander further comprises a connection manager communicatively coupled with the link layer control circuits for routing communications between the link layer control circuits. Each of the plurality of link layer control circuits is adapted to establish a SAS connection with another link layer control circuit through the connection manager by segmenting a plurality of interconnect signals into multiple data segments for sequential transmission to the connection manager, (e.g., without impacting the performance of the connection manager). The connection manager interprets the data segments to extract the plurality of interconnect signals to establish the SAS connection.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="190.84mm" wi="229.79mm" file="US08626974-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="231.22mm" wi="189.91mm" orientation="landscape" file="US08626974-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="178.90mm" wi="142.32mm" file="US08626974-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="238.34mm" wi="179.49mm" orientation="landscape" file="US08626974-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="251.71mm" wi="174.50mm" orientation="landscape" file="US08626974-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="95.08mm" wi="119.30mm" file="US08626974-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The invention relates generally to Serial Attached SCSI (SAS) expanders and more specifically relates to method and systems for reducing the signal path count between circuits within a SAS expander used for establishing/initializing SAS connections.</p>
<p id="p-0004" num="0003">2. Discussion of Related Art</p>
<p id="p-0005" num="0004">SAS supports a number of features for initiating connections between communicatively coupled SAS devices (i.e., between SAS initiator devices and SAS target devices). Typically, the SAS initiator and target devices will not be directly coupled with each other, but rather will be coupled through a switched SAS fabric comprising one or more SAS expanders. The SAS expanders route communications between the SAS devices they are coupled with. Furthermore, the SAS expanders may manage multiple different SAS connections at substantially the same time.</p>
<p id="p-0006" num="0005">SAS expanders may (internally) comprise a connection manager circuit coupled with multiple link layer control circuits. The link layer control circuits may each be coupled for communication with a SAS device, and may be used by a coupled SAS device for requesting SAS expander operations to establish a connection with another device through another link layer control circuit of the expander. The connection manager circuit manages routing information at the SAS expander, and is capable of establishing SAS connections between various link layer control circuits. The connection manager circuit generally comprises a crossbar switch (or other switching circuitry) and associated logic to determine a route/path through the switch to couple one link layer control circuit to another for purposes of establishing a connection between two SAS devices through the expander.</p>
<p id="p-0007" num="0006">It is common for SAS expanders to be designed with varying numbers of link layer control circuits in order to allow for a family of expander products. Such products may even include custom expander designs for integration with other systems. Thus, it is desirable that the link layer control circuits exist as separate circuits from the common connection manager circuit to provide for flexibility in the design of the expander. To facilitate communications between the link layer control circuits and the common connection manager circuit, SAS expanders typically include a parallel bus structure that allows for simultaneous transmission of a very large number (e.g., thousands) of interconnect signals at once between link layer control circuits and the connection manager. The link layer control circuits and the connection manager circuit exchange signals over these large parallel bus structures. In this manner, the circuits can operate rapidly to provide the switched connections desired for several initiators to communicate with several targets. This significant number of interconnect signals allows the link layer control circuits and the common connection manager circuit to, in essence, exchange all logic signals in real time (i.e., updated signals are provided at each clock pulse of a clock used by the circuits).</p>
<p id="p-0008" num="0007">However, large parallel bus structures give rise to a number of issues that are undesirable. For example, large bus structures can result in significant increases in the complexity and size (e.g., die area) of integrated circuit packages for SAS expanders.</p>
<p id="p-0009" num="0008">Thus it is an ongoing challenge to maintain desired performance for a SAS expander servicing a number of SAS devices to establish connections while reducing the complexity and size of the circuits implementing the link layer control and the connection manager functions.</p>
<heading id="h-0002" level="1">SUMMARY</heading>
<p id="p-0010" num="0009">The present invention solves the above and other problems, thereby advancing the state of the useful arts, by providing methods and systems for reducing the signal path count for interconnect signals between link layer control circuits and a common connection manager circuit used to establish a SAS connection through a SAS expander. Specifically, the present invention takes advantage of known processing delays that occur while a connection manager is processing interconnect signals in various stages to establish a desired SAS connection. In other words, not all of the interconnect signals are required to be updated at all times between the link layer control circuits and the connection manager. Certain identified subsets of signals are used at each of various stages of the processing to establish a connection, and there is some processing delay within the circuits between these various stages of operation. Features and aspects hereof segment the signals into portions/segments and transfer the portions/segments sequentially over a smaller parallel bus structure. This transfer may occur as processing for each of the various stages occurs. For example, segments for the signals used at a first stage may be transferred in sequence. Other segments for the signals used at other stages may be transferred as required in advance of the processing of each stage. These features permit significant reduction in the size of the parallel bus structures coupling the link layer control circuits with the common connection manager circuit while maintaining the desired performance in establishing connections between link layers of the expander (and hence between initiator and target devices).</p>
<p id="p-0011" num="0010">In one aspect hereof, a method is provided for utilizing a reduced pathway count parallel bus structure of a SAS expander by sequentially transmitting groups of interconnect signals used for establishing a SAS connection. The method comprises detecting, at a first link layer control circuit of a SAS expander, a request to establish a SAS connection with a second link layer control circuit of the SAS expander through a connection manager that communicatively couples the link layer control circuits and is adapted to route communications between the link layer control circuits. The method further comprises segmenting a plurality of interconnect signals at the first link layer control circuit into multiple data segments for transmission to the connection manager, and transmitting, in sequence, the multiple data segments to the connection manager. The method additionally comprises interpreting the data segments at the connection manager to extract the plurality of interconnect signals to establish the SAS connection.</p>
<p id="p-0012" num="0011">Another aspect hereof provides a SAS expander which utilizes a reduced pathway count for a parallel bus structure by sequentially transmitting groups of interconnect signals used for establishing a SAS connection. The SAS expander comprises a plurality of link layer control circuits, each link layer control circuit adapted to communicatively couple with a SAS device. The SAS expander further comprises a connection manager communicatively coupled with the link layer control circuits for routing communications between the link layer control circuits. Each of the plurality of link layer control circuits is adapted to establish a SAS connection with another link layer control circuit through the connection manager by segmenting a plurality of interconnect signals into multiple data segments for sequential transmission to the connection manager. The connection manager is adapted to interpret the data segments to extract the plurality of interconnect signals to establish the SAS connection.</p>
<p id="p-0013" num="0012">A further aspect hereof comprises a non-transitory computer readable medium embodying programmed instructions which, when executed by a processing element of a SAS expander, are operable for performing a method for utilizing a reduced pathway count parallel bus structure of a SAS expander by sequentially transmitting groups of interconnect signals used for establishing a SAS connection. The method comprises detecting, at a first link layer control circuit of a SAS expander, a request to establish a SAS connection with a second link layer control circuit of the SAS expander through a connection manager that communicatively couples the link layer control circuits and is adapted to route communications between the link layer control circuits. The method further comprises segmenting a plurality of interconnect signals at the first link layer control circuit into multiple data segments for transmission to the connection manager, and transmitting, in sequence, the multiple data segments to the connection manager. The method additionally comprises interpreting the data segments at the connection manager to extract the plurality of interconnect signals to establish the SAS connection.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of an exemplary SAS expander utilizing a reduced pathway count for a parallel bus structure coupling link layer control circuits to a connection manager in accordance with features and aspects hereof.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 2</figref> is a flowchart describing an exemplary method in accordance with features and aspects hereof to reduce pathway count for a parallel bus structure of a SAS expander by segmenting interconnect signals used for establishing a SAS connection and transmitting the segments in sequence.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram illustrating an exemplary transmission of segmented interconnect signals, in sequence, from a link layer control circuit to a connection manager in accordance with features and aspects hereof.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 4</figref> is a diagram illustrating an exemplary segmenting of interconnect signals into data segments in accordance with features and aspects hereof.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 5</figref> is a diagram illustrating an exemplary default signals in accordance with features and aspects hereof.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of an exemplary SAS expander <b>120</b> utilizing a reduced pathway count for a parallel bus structure coupling link layer control circuits <b>122</b> to a connection manager <b>124</b> in accordance with features and aspects hereof.</p>
<p id="p-0020" num="0019">Expander <b>120</b> provides for reduced signal path count for interconnections among a plurality of link layer control circuits <b>122</b> and a common connection manager <b>124</b> in accordance with features and aspects hereof.</p>
<p id="p-0021" num="0020">According to <figref idref="DRAWINGS">FIG. 1</figref>, each SAS device <b>110</b> is coupled for communications with other SAS devices <b>110</b> via SAS expander <b>120</b>. Specifically, each SAS device <b>110</b> is adapted to be coupled (through a corresponding PHY <b>112</b>, which may be an internal feature of the SAS device <b>110</b>) with a corresponding PHY <b>126</b> of a link layer control circuit <b>122</b> of SAS expander <b>120</b> (PHY <b>126</b> may similarly be an internal feature of a link layer control circuit <b>122</b>. Each of link layer control circuits <b>122</b> is operable to communicate with connection manager <b>124</b> to establish a connection with another link layer control circuit <b>122</b> (through the switching features of connection manager circuit <b>124</b>) to thereby establish SAS connections between various SAS devices <b>110</b> based upon communications with link layer control circuits <b>122</b>.</p>
<p id="p-0022" num="0021">SAS devices <b>110</b> may comprise any type of SAS devices including target devices such as storage devices and storage controllers, initiator devices such as storage controllers (e.g., Host Bus Adapters (HBA's)), and other SAS expanders (forming a hierarchy of expanders that provide a switched fabric for interconnection of initiator and target devices).</p>
<p id="p-0023" num="0022">Link layer control circuits <b>122</b> comprise circuits of SAS expander <b>120</b> adapted for communicating with connection manager <b>124</b> for purposes of establishing a connection with another link layer control circuit <b>122</b> of expander <b>120</b>. Link layer control circuits <b>122</b> may utilize customized internal logic to perform SAS link layer control functions and to communicate with connection manager <b>124</b> for purposes of establishing a connection with another link layer control circuit <b>122</b>.</p>
<p id="p-0024" num="0023">Connection manager <b>124</b> comprises any system, component, or device operable to manage the operations of SAS expander <b>120</b> to facilitate communications between SAS devices <b>110</b>. In general, connection manager circuit <b>124</b> includes a crossbar switch that is programmed to connect link layer control circuits <b>122</b> with other link layer control circuits <b>122</b>. Connection manager circuit <b>124</b> further includes routing logic to determine which other link layer control circuit <b>122</b> is appropriate to establish the desired route for connecting a SAS device <b>110</b> with another SAS device <b>110</b>. Connection manager <b>124</b> is typically implemented as an integrated circuit, and is coupled with link layer control circuits <b>122</b> via communication channels <b>128</b>.</p>
<p id="p-0025" num="0024">Communication channels <b>128</b> comprise any suitable media for allowing electronic communicative coupling of connection manager <b>124</b> with link layer control circuits <b>122</b>. For example, communication channels <b>128</b> may comprise electrically connected traces of printed circuit board, wires, conductive paths within integrated circuit dies, etc. Communication channels <b>128</b> are implemented as an internal bus structure of SAS expander <b>120</b>. However, by comparison to prior solutions, the bus width is substantially smaller. Thus, the circuit interconnections may be simpler and circuit die area for SAS expander <b>120</b> may be correspondingly smaller.</p>
<p id="p-0026" num="0025">While in operation, link layer control circuits <b>122</b> are operable (responsive to a request from an attached SAS device <b>110</b>) to establish a SAS connection with connection manager <b>124</b> and thereby create a connection with another link layer control circuit <b>122</b> of expander <b>120</b>. This, in turn, allows a SAS device <b>110</b> coupled with a link layer circuit <b>122</b> to communicate with another SAS device <b>110</b>.</p>
<p id="p-0027" num="0026">Specifically, each link layer control circuit <b>122</b> is operable to partition interconnect signals (used to establish the connection) into data segments that can be sequentially transmitted to connection manager <b>124</b> via a communication channel <b>128</b>. Furthermore, the sequencing of the data segments takes advantage of known processing delays at connection manager <b>124</b>. Thus, the data segments, even though they are received sequentially, do not impose further delay at connection manager <b>124</b> than would normally be experienced if connection manager <b>124</b> received all of the interconnect signals simultaneously. Because the data segments are provided sequentially, communication channels <b>128</b> may be made smaller (e.g., by a factor of ten) than they would have be to support the transmission of all interconnect signals in parallel at once. This is beneficial because it reduces the physical complexity and size of SAS expander <b>120</b>.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 2</figref> is a flowchart describing an exemplary method <b>200</b> in accordance with features and aspects hereof to reduce pathway count for a parallel bus structure of a SAS expander by segmenting interconnect signals used for establishing a SAS connection and transmitting the segments in sequence. The method of <figref idref="DRAWINGS">FIG. 2</figref> may be operable in a SAS expander such as described above with regard to <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0029" num="0028">Step <b>202</b> includes detecting, at a link layer control circuit, a request from a SAS device to establish a SAS connection. For example, an initiator SAS device may request a SAS connection with a target SAS device which is available via a SAS expander implementing the link layer control circuit. The request may be detected in the normal course of SAS operations and may be communicated from a PHY of the initiator SAS device to a receiving PHY located at the link layer control circuit coupled with the initiator device.</p>
<p id="p-0030" num="0029">Step <b>204</b> includes segmenting a plurality of interconnect signals into data segments. The interconnect signals comprise data used by the connection manager to establish a SAS connection at the SAS expander. This connection in turn allows for the establishment of SAS communications between the initiator SAS device and the target SAS device. In one embodiment, each data segment comprises a set of signals that are transmitted in parallel across a bus of the SAS expander in a single clock pulse. Because the connection manager processes groups of signals received from link layer control circuits in a known sequence, it may be desirable to group data segments into stages. These stages may correspond to the order of processing that takes place at the connection manager. For example, one stage may be a sequence of data segments transmitted over the bus on consecutive clock pulses and used for identifying the requesting SAS device (e.g., an identification stage). Another stage may focus upon looking up a target SAS device. A third stage may involve arbitration wherein it is determined whether the device that initiated the request has permission to use the SAS connection.</p>
<p id="p-0031" num="0030">Step <b>206</b> includes transmitting, in sequence, the data segments to the connection manager. The data segments are transmitted via a bus structure that is narrower than a bus size required to transmit all of the interconnect signals of the data segments simultaneously. If the data segments are grouped into stages (e.g., identification, lookup, and arbitration), then data segments of the same stage may be transmitted on consecutive clock cycles. During this transmission process, the data segments may be sent so that while the connection manager is processing a current stage, it receives data segments for the next stage from a link layer control circuit. By the time that the connection manager is ready to process the next stage, it will have received the appropriate data segments for that stage and may extract the relevant interconnect signals. In this manner, no extra delay is caused in the connection manager than would normally be experienced in prior systems. Thus, a smaller bus structure may be used than in prior systems. Note that while transmission is occurring, data segments may be accompanied by signaling information indicating the current stage. For example, a dedicated signal between a link layer control circuit and the connection manager may be used to indicate the current stage associated with data segments that are being transmitted.</p>
<p id="p-0032" num="0031">Step <b>208</b> includes interpreting the data segments at the connection manager in order to extract the interconnect signals. The connection manager may perform this operation by analyzing each received data segment to find interconnect signaling information. If the data segments are grouped by stage, the connection manager may further associate the received interconnect signaling with the given stage. With the interconnect signaling information extracted, the connection manager may establish/initialize the SAS connection for the link layer control circuit.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram illustrating an exemplary transmission of segmented interconnect signals, in sequence, from a link layer control circuit to the connection manager in accordance with features and aspects hereof. According to <figref idref="DRAWINGS">FIG. 3</figref>, a uniform clock <b>300</b> synchronizes the actions of a link layer control circuit and the connection manager. During the sequential transmission of data segments <b>302</b>, data segments <b>302</b> that are part of the same stage are transmitted on consecutive clock pulses. Each data segment is accompanied by data type information <b>304</b> indicating the stage with which the data segment is associated. Assume, for this example, that data segments for an identification phase have already been transmitted to the connection manager. Thus, in this example, data segments A, B, and C, being part of the lookup stage (e.g., a stage wherein routing information for the target SAS device is determined), are transmitted on consecutive clock pulses. Once each of the data segments <b>302</b> of the lookup stage has been received, the connection manager initiates processing of the lookup stage to determine routing information for the target SAS device (e.g., to find an appropriate outgoing SAS channel to another link layer control circuit). While the connection manager is processing the lookup stage data, the link layer control circuit further transmits data segments D, E, F, and G, relating to an arbitration stage (wherein the priority of the initiating SAS device is determined and compared to other SAS devices attempting to use the same outgoing channel). By the time the connection manager has finished processing the lookup stage and is ready to initiate processing the arbitration stage, data segments D, E, F, and G for the arbitration stage have been received.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 4</figref> is a diagram illustrating an exemplary segmenting of interconnect signals <b>400</b> into data segments in accordance with features and aspects hereof. According to <figref idref="DRAWINGS">FIG. 4</figref>, the SAS interconnect signals are broken up into three distinct stages, and each stage includes one or more data segments of thirty two bits. The stages include an identification stage, a lookup stage, and an arbitration stage. In other embodiments, any number of different stages may be utilized, each stage including any number of data segments as a matter of design choice. Furthermore, the overall number of interconnect signals that are segmented, the number of signals included in each stage, and the size of each data segment may vary. For example, the number of data segments for each stage may be a function of the size of the bus used, and also a function of the anticipated processing time that will take place at the connection manager.</p>
<p id="p-0035" num="0034">According to <figref idref="DRAWINGS">FIG. 4</figref>, the identification stage is broken up into three data segments. In this example, the first data segment of the identification stage includes one half of an identifier for the requesting device (e.g., a World Wide Name (WWN), an identifier derived from a WWN, etc.). The second data segment includes the second half of the identifier for the requesting device. The third data segment includes attachment information, a speed rate, and a source group for the requesting device (not shown at the data segment). The attachment information describes the type of device that is connected to the associated port of the expander. The third data segment is also used to trigger a command to the connection manager to store received device information at a list of directly attached devices. Thus, upon processing the identification stage, the connection manager may determine the identity and nature of the requesting SAS device.</p>
<p id="p-0036" num="0035">The lookup stage includes interconnect signaling used to identify the target SAS device and also includes signaling for routing a SAS connection to the target SAS device. The lookup stage is broken up into three data segments. The first data segment includes one half of the identifier for the target device, and the second data segment includes the other half of the identifier for the target device. The third segment indicates a source group for the target device, and further indicates a speed rate. The source group information in SAS is used to determine permissions for accessing the target device using SAS expander zone permissioning information in accordance with the SAS standards. Thus, upon completion of the lookup stage, the connection manager may determine the identity and nature of the target SAS device as well as permissions relating to the target SAS device. Note that in this example, the lookup stage includes an inherent latency of a few clock pulses. During this latency, data for the next stage (here, the arbitration stage) can be sent.</p>
<p id="p-0037" num="0036">The arbitration stage includes interconnect signaling used to determine a priority of the initiating device for using a bus of the SAS expander. This priority may be compared to other SAS devices attempting to use the same route through the expander. Access may be granted or denied by the connection manager based upon this prioritization. The arbitration stage is broken up into four data segments. The first data segment includes PHY zone permissioning data. Note that in this example, T10 PHY based zoning is implemented at the link level, and T10 group based zoning is implemented at the connection manager. Thus, receiving PHY zone permission data allows for zone checks to be performed in a single operation at the connection manager during a single stage. The second data segment includes one half of an identifier for the initiating SAS device (e.g., a SAS device that initially requested a connection with the target device), and the third data segment includes the other half of the identifier. The initiating device may occasionally be directly coupled with the SAS expander. In this case, the initiating device and the requesting device are one and the same. However, in many cases, the initiating device is not directly coupled with the SAS expander, so it sends a request to a requesting device, which itself is directly coupled with the SAS expander. In this example, the fourth and final data segment includes an Arbitration Wait Timer (AWT) and a Pathway Block Count (PBC). These two values are used to determine the priority of an incoming request. For example, if two links request the same destination PHY, the values for AWT and PBC can be used to determine priority. If a link is waiting for a higher-priority request to complete, the AWT is incremented over time, thereby increasing the priority of the link that is waiting. This information may be used to determine the present availability of the SAS connection to the initiating device. Therefore, using these data segments, the connection manager may prioritize the bus and provide it to the appropriate requesting SAS device.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 5</figref> is a diagram illustrating exemplary default signals in accordance with features and aspects hereof. According to <figref idref="DRAWINGS">FIG. 5</figref>, the default signals are implemented at a data segment <b>500</b> and include a variety of signaling information which is used during the arbitration stage, but ignored during other stages. The default signals include an instruction to increment a PBC, an instruction to increment an AWT, and other signaling which may be used to manage the arbitration stage. For example, the signaling may request that information on a linked device be updated or altered at the connection manager, may indicate that a requesting link is in a switching state, may trigger resolution logic that clears deadlock conditions at the connection manager, or may release a connection with the connection manager. Data segment <b>500</b> may therefore provide relevant control signals for use while the connection manager processes the arbitration stage.</p>
<p id="p-0039" num="0038">While the invention has been illustrated and described in the drawings and foregoing description, such illustration and description is to be considered as exemplary and not restrictive in character. One embodiment of the invention and minor variants thereof have been shown and described. In particular, features shown and described as exemplary software or firmware embodiments may be equivalently implemented as customized logic circuits and vice versa. Protection is desired for all changes and modifications that come within the spirit of the invention. Those skilled in the art will appreciate variations of the above-described embodiments that fall within the scope of the invention. As a result, the invention is not limited to the specific examples and illustrations discussed above, but only by the following claims and their equivalents.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A Serial Attached SCSI (SAS) expander comprising:
<claim-text>a plurality of link layer control circuits, each link layer control circuit adapted to communicatively couple with a SAS device; and</claim-text>
<claim-text>a connection manager communicatively coupled with the link layer control circuits for routing communications between the link layer control circuits,</claim-text>
<claim-text>wherein each of the plurality of link layer control circuits is adapted to establish a SAS connection with another link layer control circuit through the connection manager by segmenting a plurality of interconnect signals into multiple data segments for sequential transmission to the connection manager,</claim-text>
<claim-text>wherein the connection manager is adapted to interpret the data segments to extract the plurality of interconnect signals to establish the SAS connection.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The SAS expander of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>each of the plurality of link layer control circuits is further adapted to transmit data segments in stages of multiple data segments, the segments for a stage transmitted on consecutive clock pulses of the SAS expander.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The SAS expander of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein:
<claim-text>each of the link layer control circuits is further adapted to transmit data segments for one of the stages during processing by the connection manager of interconnect signals for another stage.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The SAS expander of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein:
<claim-text>each data segment comprises thirty two bits.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The SAS expander of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein:
<claim-text>each data segment is accompanied by a data type indicating the stage to which the data segment belongs.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The SAS expander of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>each of the plurality of link layer control circuits is further adapted to segment the interconnect signals into data segments based upon a processing speed of the connection manager.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The SAS expander of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein:
<claim-text>each of the plurality of link layer control circuits is further adapted to segment the interconnect signals into data segments based upon a processing delay of the connection manager during a stage associated with establishing the SAS connection.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A method comprising:
<claim-text>detecting, at a first link layer control circuit of a SAS expander, a request to establish a SAS connection with a second link layer control circuit of the SAS expander through a connection manager that communicatively couples the link layer control circuits and is adapted to route communications between the link layer control circuits;</claim-text>
<claim-text>segmenting a plurality of interconnect signals at the first link layer control circuit into multiple data segments for transmission to the connection manager;</claim-text>
<claim-text>transmitting, in sequence, the multiple data segments to the connection manager; and</claim-text>
<claim-text>interpreting the data segments at the connection manager to extract the plurality of interconnect signals to establish the SAS connection.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, further comprising:
<claim-text>transmitting the data segments in stages of multiple data segments, the segments for a stage transmitted on consecutive clock pulses of the SAS expander.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein transmitting comprises:
<claim-text>transmitting data segments for one of the stages during processing by the connection manager of interconnect signals for another stage.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein:
<claim-text>each data segment comprises thirty two bits.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising:
<claim-text>accompanying each data segment with a data type that indicates the stage to which the data segment belongs.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein segmenting the interconnect signals comprises:
<claim-text>segmenting the interconnect signals into data segments based upon a processing speed of the connection manager.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein segmenting the interconnect signals further comprises:
<claim-text>segmenting the interconnect signals into data segments based upon a processing delay of the connection manager during a stage associated with establishing the SAS connection.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A non-transitory computer readable medium embodying programmed instructions which, when executed by a processing element of a SAS expander, are operable for performing a method comprising:
<claim-text>detecting, at a first link layer control circuit of a SAS expander, a request to establish a SAS connection with a second link layer control circuit of the SAS expander through a connection manager that communicatively couples the link layer control circuits and is adapted to route communications between the link layer control circuits;</claim-text>
<claim-text>segmenting a plurality of interconnect signals at the first link layer control circuit into multiple data segments for transmission to the connection manager;</claim-text>
<claim-text>transmitting, in sequence, the multiple data segments to the connection manager; and</claim-text>
<claim-text>interpreting the data segments at the connection manager to extract the plurality of interconnect signals to establish the SAS connection.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The medium of <claim-ref idref="CLM-00015">claim 15</claim-ref>, the method further comprising:
<claim-text>transmitting the data segments in stages of multiple data segments, the segments for a stage transmitted on consecutive clock pulses of the SAS expander.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The medium of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the transmitting comprises:
<claim-text>transmitting data segments for one of the stages during processing by the connection manager of interconnect signals for another stage.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The medium of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein:
<claim-text>each data segment comprises thirty two bits.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The medium of <claim-ref idref="CLM-00016">claim 16</claim-ref>, further comprising:
<claim-text>accompanying each data segment with a data type that indicates the stage to which the data segment belongs.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The medium of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein segmenting the interconnect signals comprises:
<claim-text>segmenting the interconnect signals into data segments based upon a processing speed of the connection manager. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
