<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08626292-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08626292</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12787558</doc-number>
<date>20100526</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>405</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>N</subclass>
<main-group>1</main-group>
<subgroup>37</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>607 20</main-classification>
<further-classification>607 18</further-classification>
<further-classification>607 19</further-classification>
</classification-national>
<invention-title id="d2e53">Respiration sensor processing for phrenic nerve activation detection</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4573481</doc-number>
<kind>A</kind>
<name>Bullara</name>
<date>19860300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5658318</doc-number>
<kind>A</kind>
<name>Stroetmann</name>
<date>19970800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6076015</doc-number>
<kind>A</kind>
<name>Hartley</name>
<date>20000600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6221011</doc-number>
<kind>B1</kind>
<name>Bardy</name>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6270457</doc-number>
<kind>B1</kind>
<name>Bardy</name>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6277072</doc-number>
<kind>B1</kind>
<name>Bardy</name>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6280380</doc-number>
<kind>B1</kind>
<name>Bardy</name>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6312378</doc-number>
<kind>B1</kind>
<name>Bardy</name>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6336903</doc-number>
<kind>B1</kind>
<name>Bardy</name>
<date>20020100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6358203</doc-number>
<kind>B2</kind>
<name>Bardy</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6368284</doc-number>
<kind>B1</kind>
<name>Bardy</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>6398728</doc-number>
<kind>B1</kind>
<name>Bardy</name>
<date>20020600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>6440066</doc-number>
<kind>B1</kind>
<name>Bardy</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>6772008</doc-number>
<kind>B2</kind>
<name>Zhu et al.</name>
<date>20040800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>6937901</doc-number>
<kind>B2</kind>
<name>Zhu et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>7299093</doc-number>
<kind>B2</kind>
<name>Zhu et al.</name>
<date>20071100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>7392086</doc-number>
<kind>B2</kind>
<name>Sathaye</name>
<date>20080600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2002/0087199</doc-number>
<kind>A1</kind>
<name>Bange et al.</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>607 27</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2002/0161412</doc-number>
<kind>A1</kind>
<name>Sun et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>607 19</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2006/0241711</doc-number>
<kind>A1</kind>
<name>Sathaye</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>607 28</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>2008/0071318</doc-number>
<kind>A1</kind>
<name>Brooke</name>
<date>20080300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>2008/0234556</doc-number>
<kind>A1</kind>
<name>Brooke et al.</name>
<date>20080900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>607  9</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2008/0294215</doc-number>
<kind>A1</kind>
<name>Sathaye</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>2008/0300644</doc-number>
<kind>A1</kind>
<name>Sathaye</name>
<date>20081200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>2009/0043351</doc-number>
<kind>A1</kind>
<name>Sathaye et al.</name>
<date>20090200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00026">
<othercit>U.S. Appl. No. 12/787,557, filed May 26, 2010, McCabe et al.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00027">
<othercit>U.S. Appl. No. 12/787,558, filed May 26, 2010, McCabe et al.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00028">
<othercit>U.S. Appl. No. 12/787,563, filed May 26, 2010, McCabe et al.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00029">
<othercit>Schuchert et al., &#x201c;Two-year performance of a preshaped lead for left ventricular stimulation&#x201d;, Pacing Clinical Electrophysiology, vol. 27 (12), 2004, pp. 1610-1614.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00030">
<othercit>Stellbrink et al., &#x201c;Technical considerations in implanting left ventricular pacing leads for cardiac resynchronization therapy&#x201d;, European Heart Journal Supp, vol. 6, 2004, pp. D43-D46.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00031">
<othercit>International Search Report and Written Opinion dated Oct. 1, 2010 from International Application No. PCT/US2010/036434, 19 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00032">
<othercit>File History for U.S. Appl. No. 12/787,557, 125 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00033">
<othercit>File History for U.S. Appl. No. 12/787,563, 158 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00034">
<othercit>File History for U.S. Appl. No. 12/787,557, 146 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00035">
<othercit>File History for U.S. Appl. No. 12/787,563, 183 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>607  2</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>607 17- 20</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>21</number-of-drawing-sheets>
<number-of-figures>21</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61181658</doc-number>
<date>20090527</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20100305637</doc-number>
<kind>A1</kind>
<date>20101202</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>McCabe</last-name>
<first-name>Aaron R.</first-name>
<address>
<city>Minneapolis</city>
<state>MN</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Rockweiler</last-name>
<first-name>Holly E.</first-name>
<address>
<city>Minneapolis</city>
<state>MN</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Laughner</last-name>
<first-name>Jacob L.</first-name>
<address>
<city>St. Louis</city>
<state>MO</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>McCabe</last-name>
<first-name>Aaron R.</first-name>
<address>
<city>Minneapolis</city>
<state>MN</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Rockweiler</last-name>
<first-name>Holly E.</first-name>
<address>
<city>Minneapolis</city>
<state>MN</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Laughner</last-name>
<first-name>Jacob L.</first-name>
<address>
<city>St. Louis</city>
<state>MO</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Seager, Tufte &#x26; Wickhem LLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Cardiac Pacemakers, Inc.</orgname>
<role>02</role>
<address>
<city>St. Paul</city>
<state>MN</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Dietrich</last-name>
<first-name>Joseph</first-name>
<department>3762</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An implantable cardiac device includes a sensor for sensing patient respiration and detecting phrenic nerve activation. A first filter channel attenuates first frequencies of the sensor signal to produce a first filtered output. A second filter channel attenuates second frequencies of the respiration signal to produce a second filtered output. Patient activity is evaluated using the first filtered output and phrenic nerve activation caused by cardiac pacing is detected using the second filtered output.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="145.80mm" wi="229.36mm" file="US08626292-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="189.23mm" wi="127.85mm" file="US08626292-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="247.48mm" wi="184.07mm" orientation="landscape" file="US08626292-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="195.24mm" wi="128.69mm" orientation="landscape" file="US08626292-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="190.75mm" wi="158.75mm" orientation="landscape" file="US08626292-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="212.94mm" wi="172.72mm" orientation="landscape" file="US08626292-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="243.33mm" wi="155.19mm" file="US08626292-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="242.32mm" wi="149.01mm" file="US08626292-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="169.59mm" wi="159.77mm" file="US08626292-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="241.22mm" wi="199.47mm" orientation="landscape" file="US08626292-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="227.84mm" wi="167.56mm" file="US08626292-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="234.53mm" wi="148.42mm" orientation="landscape" file="US08626292-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="249.00mm" wi="117.01mm" orientation="landscape" file="US08626292-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="265.01mm" wi="194.82mm" orientation="landscape" file="US08626292-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="258.23mm" wi="170.10mm" orientation="landscape" file="US08626292-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="253.66mm" wi="178.39mm" orientation="landscape" file="US08626292-20140107-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="255.69mm" wi="187.62mm" orientation="landscape" file="US08626292-20140107-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="244.86mm" wi="188.64mm" orientation="landscape" file="US08626292-20140107-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="246.89mm" wi="157.23mm" file="US08626292-20140107-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00019" num="00019">
<img id="EMI-D00019" he="272.71mm" wi="207.26mm" orientation="landscape" file="US08626292-20140107-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00020" num="00020">
<img id="EMI-D00020" he="255.19mm" wi="200.49mm" file="US08626292-20140107-D00020.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00021" num="00021">
<img id="EMI-D00021" he="142.83mm" wi="173.74mm" file="US08626292-20140107-D00021.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application claims the benefit of Provisional Patent Application Ser. No. 61/181,658, filed on May 27, 2009, to which priority is claimed pursuant to 35 U.S.C. &#xa7;119(e) and which is hereby incorporated herein by reference.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates generally to cardiac devices and methods, and, more particularly, to characterization of phrenic nerve activation and phrenic nerve activation avoidance during cardiac electrical therapy.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">When functioning normally, the heart produces rhythmic contractions and is capable of pumping blood throughout the body. The heart has specialized conduction pathways in both the atria and the ventricles that enable excitation impulses (i.e. depolarizations) initiated from the sino-atrial (SA) node to be rapidly conducted throughout the myocardium. These specialized conduction pathways conduct the depolarizations from the SA node to the atrial myocardium, to the atrio-ventricular node, and to the ventricular myocardium to produce a coordinated contraction of both atria and both ventricles.</p>
<p id="p-0005" num="0004">The conduction pathways synchronize the contractions of the muscle fibers of each chamber as well as the contraction of each atrium or ventricle with the opposite atrium or ventricle. Without the synchronization afforded by the normally functioning specialized conduction pathways, the heart's pumping efficiency is greatly diminished. Patients who exhibit pathology of these conduction pathways can suffer compromised cardiac output.</p>
<p id="p-0006" num="0005">Cardiac rhythm management (CRM) devices have been developed that provide pacing stimulation to one or more heart chambers in an attempt to improve the rhythm and coordination of atrial and/or ventricular contractions. CRM devices typically include circuitry to sense signals from the heart and a pulse generator for providing electrical stimulation to the heart. Leads extending into the patient's heart chamber and/or into veins of the heart are coupled to electrodes that sense the heart's electrical signals and deliver stimulation to the heart in accordance with various therapies for treating cardiac arrhythmias and dyssynchrony.</p>
<p id="p-0007" num="0006">Pacemakers are CRM devices that deliver a series of low energy pace pulses timed to assist the heart in producing a contractile rhythm that maintains cardiac pumping efficiency. Pace pulses may be intermittent or continuous, depending on the needs of the patient. There exist a number of categories of pacemaker devices, with various modes for sensing and pacing one or more heart chambers.</p>
<p id="p-0008" num="0007">A pace pulse must exceed a minimum energy value, or capture threshold, to &#x201c;capture&#x201d; the heart tissue, generating an evoked response that generates a propagating depolarization wave that results in a contraction of the heart chamber. If a pace pulse energy is too low, the pace pulses may not reliably produce a contractile response in the heart chamber and may result in ineffective pacing that does not improve cardiac function or cardiac output.</p>
<p id="p-0009" num="0008">Pacing pulses can unintentionally stimulate nerves or muscles, even if the pulse energy is not sufficient to capture cardiac tissue. For example, a delivered pacing pulse may stimulate a patient's phrenic nerve, which runs proximate to the heart and innervates the diaphragm. The present invention provides methods and systems using phrenic nerve to detect phrenic nerve activation and avoid phrenic nerve activation during cardiac pacing therapy.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0010" num="0009">The present invention involves approaches for sensing phrenic nerve activation in conjunction with sensing patient activity and/or metabolic demand. Some embodiments involve an implantable medical device including a pulse generator configured to deliver cardiac pacing to a heart. An impedance sensor generates a signal modulated by patient respiration, the sensor signal available at a sensor output terminal. A first filter channel is coupled to the sensor output and attenuates first frequencies of the sensor signal to produce a first filtered output. A second filter channel, separate from the first filter channel, is coupled to the sensor output. The second filter channel attenuates second frequencies of the sensor signal to produce a second filtered output. The medical device includes circuitry configured to evaluate patient respiration using the first filtered output and to detect phrenic nerve activation caused by cardiac pacing using the second filtered output.</p>
<p id="p-0011" num="0010">In some implementations, the second filter channel comprises a notch filter. For example, the filter characteristics of the notch filter can be dynamically alterable based on cardiac rate.</p>
<p id="p-0012" num="0011">In some implementations, the second filter channel comprises a high pass filter having a low frequency cut off of about 5 Hz.</p>
<p id="p-0013" num="0012">According to one aspect of the invention, analog circuitry is coupled between the sensor output and the first and second filter channels and the second filter channel includes a filter circuit that is substantially matched to an impulse response of the analog circuitry. For example, the filter circuit can substantially attenuate frequencies other than the impulse response frequencies of the analog circuitry. The characteristics of the filter circuitry may be individually mapped to the impulse response during device testing.</p>
<p id="p-0014" num="0013">In some implementations, the circuitry includes a timer configured to time a phrenic nerve activation detection interval which is started following delivery of a pacing pulse to a cardiac chamber and is stopped before delivery of a subsequent pacing pulse to the cardiac chamber. The circuitry is configured to sensor for phrenic nerve activation during the phrenic nerve detection interval.</p>
<p id="p-0015" num="0014">In some implementations, the device also includes pacing control circuitry configured to adapt a cardiac pacing rate based on evaluation of the patient respiration.</p>
<p id="p-0016" num="0015">The medical device may also include a second sensor configured to produce a sensor signal, wherein the circuitry is configured to use both the sensor signal and the second filtered output to detect the phrenic nerve activation.</p>
<p id="p-0017" num="0016">According to additional aspects of the invention, the medical device may include an accelerometer configured to generate a signal modulated by acceleration that is available at an accelerometer output terminal. A third filter channel is coupled to the accelerometer output terminal and is configured to attenuate third frequencies of the accelerometer signal to produce a third filtered output. A fourth filter channel is coupled to the accelerometer output, and is separate from the third filter channel. The fourth filter channel is configured to attenuate fourth frequencies of the accelerometer signal to produce a fourth filtered output, wherein the circuitry is configured to detect the phrenic nerve activation using the second filtered output and the fourth filtered output.</p>
<p id="p-0018" num="0017">The circuitry may develop a sensor indicated pacing rate based on one or both of the first filtered output and the third filtered output.</p>
<p id="p-0019" num="0018">According to some aspects, the circuitry may be configured to use the first filtered output to determine respiration phase and to use the second filtered output to detect the phrenic nerve activation in conjunction with the respiration phase.</p>
<p id="p-0020" num="0019">Yet another embodiment of the invention is directed to a method of operating an implantable medical device. Patient respiration is sensed and a sensor signal modulated by patient respiration is generated at a sensor output terminal. The sensor signal is processed through separate signal processing channels, including a first signal processing channel having first signal processing characteristics and a second signal processing channel having second signal processing characteristics. Patient respiration is evaluated using an output of the first signal processing channel. Phrenic nerve activation caused by cardiac pacing is detected using an output of the second signal processing channel.</p>
<p id="p-0021" num="0020">For example, the first signal processing channel may include first filter circuitry and the first signal processing characteristics are configured to attenuate a first set of frequencies from the sensor signal. The second signal processing channel may include second filter circuitry and the second signal processing characteristics are configured to attenuate a second set of frequencies from the sensor signal.</p>
<p id="p-0022" num="0021">According to some implementations, the second signal processing channel comprises a notch filter having characteristics that are adaptable based on cardiac rate.</p>
<p id="p-0023" num="0022">According to some implementations the second signal processing characteristics comprise a low frequency cut off that substantially attenuates respiration components and cardiac components from the output of the second signal processing channel.</p>
<p id="p-0024" num="0023">Another aspect of the invention involves starting a phrenic nerve activation detection interval upon or after delivery of a cardiac pace during a cardiac cycle. The phrenic nerve detection interval is ended during the cardiac cycle and sensing for the phrenic nerve activation occurs during the phrenic nerve detection interval.</p>
<p id="p-0025" num="0024">Determining the phrenic nerve activation may involve determining a transition zone for phrenic nerve activation. The cardiac pacing energy may be set to be above the cardiac capture threshold and below a transition zone threshold for phrenic nerve activation.</p>
<p id="p-0026" num="0025">According to certain implementations, switching from one cardiac pacing electrode configuration to another cardiac pacing electrode configuration may occur based on detection of the phrenic nerve stimulation.</p>
<p id="p-0027" num="0026">The above summary of the present invention is not intended to describe each embodiment or every implementation of the present invention. Advantages and attainments, together with a more complete understanding of the invention, will become apparent and appreciated by referring to the following detailed description and claims taken in conjunction with the accompanying drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 1</figref> is a flowchart illustrating a method of characterizing phrenic nerve activation relative to respiration in accordance with various embodiments of this disclosure;</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 2</figref> is a graph illustrating respiration phases in accordance with embodiments of this disclosure;</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIGS. 3-4</figref> illustrate accelerometer data plots in accordance with embodiments of this disclosure;</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 5</figref> is a multi-trace graph showing electrical cardiac, accelerometer, and impedance data collected during pulse delivery in accordance with embodiments of this disclosure;</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart illustrating a method of characterizing phrenic nerve activation in accordance with embodiments of this disclosure;</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 7</figref> is a flowchart illustrating a method of characterizing phrenic nerve activation in accordance with embodiments of this disclosure;</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 8</figref> is a graph illustrating various aspects of strength-duration pacing pulse parameters and a transition zone in accordance with embodiments of this disclosure;</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 9</figref> is a block diagram of a system incorporating phrenic nerve activation characterization and avoidance circuitry in accordance with embodiments of this disclosure;</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 10</figref> is a diagram illustrating a patient-internal device in accordance with embodiments of this disclosure;</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 11A</figref> is a block diagram of medical device circuitry configured to process a sensor signal output using separate signal processing channels for activity/metabolic demand sensing and phrenic nerve activation sensing in accordance with embodiments of this disclosure;</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 11B</figref> is a block diagram of medical device circuitry having a single signal processing channel configured to implement time-multiplexed signal processing functions in accordance with embodiments of this disclosure;</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 12</figref> illustrates the output of an accelerometer before and after processing by two different signal processing circuits;</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 13</figref> depicts three graphs representing a thoracic impedance signal that is produced using different three sets of signal processing characteristics;</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIGS. 14A-14C</figref> are block diagrams of medical devices configured to detect phrenic nerve activation and to use blended sensor outputs for rate adaptation in accordance with embodiments of this disclosure;</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 15</figref> is a flow diagram illustrating processes implementable in a cardiac device for detecting phrenic nerve activation using a phrenic nerve activation detection interval in accordance with embodiments of this disclosure;</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 16</figref> is a flow diagram illustrating various optional processes for phrenic nerve activation detection in conjunction with respiration rate sensing in accordance with embodiments of this disclosure; and</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIGS. 17A-B</figref> depict a flow diagram illustrating an algorithm for cardiac capture threshold testing that also includes a process for ensuring that the pacing voltage selected based on the cardiac capture threshold does not produce phrenic nerve activation in accordance with embodiments of this disclosure.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0045" num="0044">While the invention is amenable to various modifications and alternative forms, specifics thereof have been shown by way of example in the drawings and will be described in detail below. It is to be understood, however, that the intention is not to limit the invention to the particular embodiments described. On the contrary, the invention is intended to cover all modifications, equivalents, and alternatives falling within the scope of the invention as defined by the appended claims.</p>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF VARIOUS EMBODIMENTS</heading>
<p id="p-0046" num="0045">In the following description of the illustrated embodiments, references are made to the accompanying drawings forming a part hereof, and in which are shown by way of illustration, various embodiments by which the invention may be practiced. It is to be understood that other embodiments may be utilized, and structural and functional changes may be made without departing from the scope of the present invention.</p>
<p id="p-0047" num="0046">Systems, devices, or methods according to the present invention may include one or more of the features, structures, methods, or combinations thereof described herein. For example, a device or system may be implemented to include one or more of the advantageous features and/or processes described below in various different embodiments. It is intended that such a device or system need not include all of the features described herein, but may be implemented to include selected features that provide for useful structures and/or functionality. Such a device or system may be implemented to provide a variety of therapeutic or diagnostic functions.</p>
<p id="p-0048" num="0047">A wide variety of implantable cardiac monitoring and/or stimulation devices may be configured to implement phrenic nerve activation detection algorithms of the present invention. A non-limiting, representative list of such devices includes cardiac monitors, pacemakers, cardiovertors, defibrillators, resynchronizers, and other cardiac monitoring and therapy delivery devices. These devices may be configured with a variety of electrode arrangements, including transveneous, endocardial, and epicardial electrodes (i.e., intrathoracic electrodes), and/or subcutaneous, non-intrathoracic electrodes, including can, header, and indifferent electrodes, and subcutaneous array(s) or lead electrodes (i.e., non-intrathoracic electrodes).</p>
<p id="p-0049" num="0048">In multi-electrode pacing systems, multiple pacing electrodes may be disposed in a single heart chamber, in multiple heart chambers, and/or elsewhere in a patient's body. Electrodes used for delivery of pacing pulses may include one or more cathode electrodes and one or more anode electrodes. Pacing pulses are delivered via the cathode/anode electrode combinations, where the term &#x201c;electrode combination&#x201d; denotes that at least one cathode electrode and at least one anode electrode are used. An electrode combination may involve more than two electrodes, such as when multiple electrodes that are electrically connected are used as the anode and/or multiple electrodes that are electrically connected are used as the cathode.</p>
<p id="p-0050" num="0049">Typically, pacing energy is delivered to the heart tissue via the cathode electrode(s) at one or more pacing sites, with a return path provided via the anode electrode(s). If cardiac capture occurs, the energy injected at the cathode electrode site creates a propagating wavefront of depolarization which may combine with other depolarization wavefronts to trigger a contraction of the cardiac muscle. The cathode and anode electrode combination that delivers the pacing energy defines the pacing vector used for pacing.</p>
<p id="p-0051" num="0050">Pacing pulses may be applied through multiple electrodes (i.e., pacing vectors defined by various electrode combinations) in a single cardiac chamber in a timed sequence during the cardiac cycle to improve contractility and enhance the pumping action of the heart chamber. It is generally desirable for each pacing pulse delivered via the multiple electrode combinations to capture the cardiac tissue proximate to the cathode electrode. Capture of cardiac tissue depends upon, among other things, the vector used to deliver the pulse and various pulse parameters, such as the amplitude and duration of the pulse.</p>
<p id="p-0052" num="0051">A cardiac capture threshold can be determined using, among other methods, a step-down technique where a capture threshold is identified when loss of cardiac capture is detected after successive pacing cycles. A step-up technique can also be used, whereby a cardiac capture threshold is identified when cardiac capture is first detected after successive pacing cycles without cardiac capture. Cardiac capture can be detected using characteristics of an electrical cardiac signal indicating an intended cardiac response (e.g., a QRS complex).</p>
<p id="p-0053" num="0052">Cardiac capture detection allows the cardiac rhythm management system to adjust the energy level of pace pulses to correspond to the optimum energy expenditure that reliably produces a contraction. Further, cardiac capture detection allows the cardiac rhythm management system to initiate a back-up pulse at a higher energy level whenever a pace pulse does not produce a contraction.</p>
<p id="p-0054" num="0053">Stimulation characteristics of a cardiac pacing therapy are dependent on many factors, including the distance between the electrodes, proximity to targeted cardiac tissue, proximity to non-targeted tissue susceptible to unintended activation, type of tissue contacting and between the electrodes, impedance between the electrodes, resistance between the electrodes, and electrode type, among other factors. Such factors can influence the cardiac capture thresholds, as well as a patient's phrenic nerve activation thresholds. Stimulation characteristics can vary with physiologic changes, electrode migration, patient position, physical activity level, body fluid chemistry, hydration, and disease state, among other factors. Therefore, the stimulation characteristics for each electrode combination are unique and can change over time. As such, it can be useful to periodically determine the stimulation characteristics for each electrode combination for optimum pacing that avoids undesirable tissue activation.</p>
<p id="p-0055" num="0054">Bi-ventricular pacing provides therapy options for patients suffering from heart failure. However, new challenges have been presented by placement of the left-ventricular lead via the coronary sinus in bi-ventricular pacing systems. Due to the proximity of the coronary veins to the phrenic nerve, left ventricular pacing may result in undesirable phrenic nerve stimulation. The phrenic nerve innervates the diaphragm, so unintended activation of the phrenic nerve can cause a patient to experience rapid contraction of the diaphragm, similar to a hiccup. Unintended activation of the phrenic nerve via a cardiac pacing pulse can be uncomfortable for the patient, and can interfere with breathing. Therefore, phrenic nerve activation from cardiac pacing may cause the patient to exhibit uncomfortable breathing patterns timed with the left-ventricular pace.</p>
<p id="p-0056" num="0055">A phrenic nerve activation threshold for a pacing parameter (e.g., voltage, duration) for a particular electrode combination, above which the phrenic nerve will be activated by a pacing pulse, can be determined. One method for determining a phrenic nerve activation threshold includes sensing for some signature of phrenic nerve activation timed with the delivery of pacing pulses. If no change in phrenic nerve activation is sensed (e.g., is not lost or gained) using the level of electrical energy delivered, the energy level can be iteratively changed (e.g., decreased in a step down test or increased in a step up test) for subsequent trials of delivering electrical energy and monitoring for phrenic nerve activation until phrenic nerve activation is first lost (in the case of step-down scanning) or first detected (in the case of step-up scanning). The electrical energy level at which phrenic nerve activation is first detected or first lost can be the phrenic nerve activation threshold for the electrode combination tested. The energy delivered during such a scan could also be used to simultaneously perform other tests, such as searching for a cardiac capture threshold.</p>
<p id="p-0057" num="0056">Methods for evaluating phrenic nerve activation that may be incorporated in embodiments of the present disclosure are disclosed in U.S. Pat. Nos. 6,772,008 and 7,392,086, each of which are herein incorporated by reference in their respective entireties.</p>
<p id="p-0058" num="0057">Programming a pacing device to avoid undesirable stimulation, such as phrenic nerve activation, is not one dimensional, as many other factors can be important in setting appropriate pacing parameters. For example, a pace pulse must exceed a minimum energy value, or capture threshold, to produce an intended contraction of cardiac tissue. It is desirable for a pace pulse to have sufficient energy to stimulate capture of the heart without expending energy significantly in excess of the capture threshold. Thus, proper characterization of the various tissue activation thresholds provides efficient pace energy management. If the pace pulse energy is too low, the pace pulses may not reliably produce a contractile response in the heart and may result in ineffective pacing.</p>
<p id="p-0059" num="0058">Another complication in determining appropriate pacing pulse parameters concerns seemingly erratic phrenic activation behavior even when pacing parameters are held constant. For example, in a step down test it is possible to lower cardiac pacing pulse voltage until phrenic nerve activation is not detected, and if the pacing parameters are held constant subsequent pacing parameters may not cause phrenic nerve activation. However, in some cases, the subsequent pacing pulses will cause phrenic nerve activation despite the same pacing parameters not causing phrenic nerve activation in one or more previous pulses.</p>
<p id="p-0060" num="0059">The inventors have investigated this phenomenon and have linked the phases of respiration during which pacing pulses are delivered to increased and decreased susceptibility to phrenic nerve activation. For example, some subjects are more susceptible to phrenic nerve activation when the subjects are inhaling relative to other portions of the respiratory cycle, such as exhalation. Some subjects are more susceptible to phrenic nerve activation when they are at the deepest part of their breaths (at the point of maximum inhalation) relative to other portions of the respiratory cycle. Some subjects are less susceptible to phrenic nerve activation when the subject is exhaling or between breaths (e.g., not inhaling or exhaling) relative to other portions of the respiratory cycle. The particular susceptible phase for a particular patient may be influenced by the chosen pacing vector for pacing pulse delivery, or other pacing parameters, and could change chronically. The present disclosure concerns methods and systems for characterizing a patient's phrenic nerve activation response relative to respiration cycle and determining pacing parameters based on the characterization, among other things.</p>
<p id="p-0061" num="0060">The cardiac pace pulse parameter range within which phrenic nerve activation is dependent on respiration phase is herein referred to as the transition zone. The transition zone corresponds to the pulse parameter range within which a cardiac pacing pulse will reliably (e.g., always) cause phrenic nerve activation above an upper boundary and will not cause phrenic nerve activation below a lower boundary, and between the upper and lower boundaries will sometimes cause phrenic nerve activation dependent on respiration cycle phase.</p>
<p id="p-0062" num="0061">For example, if the cardiac pacing pulse parameter is voltage, then a transition zone can be the voltage range within which the respiratory phase influences whether a pulse having a voltage within the range causes phrenic nerve activation. Above the transition zone (e.g., voltages greater than the upper transition zone boundary), essentially all pulses will activate the phrenic nerve and below the transition zone (e.g., voltages less than the lower transition zone boundary) essentially no pulses will activate the phrenic nerve. Within the transition zone (e.g., voltage less than the upper transition zone boundary and greater than the lower transition zone boundary), any pulse having constant output parameters may or may not cause phrenic nerve activation, with phrenic nerve activation depending on the phase of the respiration cycle when the pulse was delivered. Different electrode combinations can have different thresholds and transitions zone ranges.</p>
<p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a method <b>100</b> for characterizing a patient's phrenic nerve activation response relative to respiration. The method <b>100</b> includes monitoring <b>110</b> a patient's respiration using an impedance signal.</p>
<p id="p-0064" num="0063"><figref idref="DRAWINGS">FIG. 2</figref> illustrates an impedance signal <b>200</b> that can be used in the method <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref>, as well in the other embodiments discussed herein. The impedance signal <b>200</b> is proportional to the transthoracic impedance illustrated as impedance <b>201</b> on the abscissa of the left side of the graph. The impedance <b>201</b> increases during any respiratory inspiration and decreases during any respiratory expiration. The impedance signal <b>200</b> is also proportional to the amount of air inhaled, denoted the tidal volume <b>202</b>, illustrated on the abscissa of the right side of the graph.</p>
<p id="p-0065" num="0064">The method <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref> further includes identifying <b>120</b> at least one of inhalation, peak inhalation, and exhalation phases of the patient respiration based on the monitored <b>110</b> impedance signal. In some embodiments, all of these phases will be identified <b>120</b>, and in some other embodiments only certain phases will be identified <b>120</b>, such as inspiration and expiration.</p>
<p id="p-0066" num="0065">A respiration cycle can be divided into an inspiration period corresponding to the patient inhaling, an expiration period corresponding to the patient exhaling, peak inhalation corresponding to the period after inhalation before exhalation, and a non-breathing period occurring after exhalation and before the next inhalation. Respiration phases can be established using an inspiration threshold <b>210</b> and an expiration threshold <b>220</b>. The inspiration threshold <b>210</b> marks the beginning of an inspiration period <b>230</b> and is determined by the transthoracic impedance signal <b>200</b> rising above the inspiration threshold <b>210</b>. The inspiration period <b>230</b> ends when the transthoracic impedance signal <b>200</b> is at maximum <b>240</b>. The maximum transthoracic impedance signal <b>240</b> corresponds to both the end of the inspiration interval <b>230</b> and the beginning of an expiration interval <b>250</b>. The expiration interval <b>250</b> continues until the transthoracic impedance <b>200</b> falls below an expiration threshold <b>220</b>. A non-breathing interval <b>260</b> starts from the end of the expiration period <b>250</b> and continues until the beginning of a next inspiration period <b>270</b>.</p>
<p id="p-0067" num="0066">Taking the derivative of the impedance signal <b>200</b> can also identify respiratory phases. For example, the time <b>203</b> during which the derivative value of the impedance signal <b>200</b> is positive can correspond to the inspiration phase <b>230</b>. The time <b>203</b> during which the derivative value of the impedance signal <b>200</b> is negative can correspond to the expiration phase <b>230</b>. The time <b>203</b> during which the derivative value of the impedance signal <b>200</b> turns zero after being positive (inspiration) can correspond to the peak inspiration phase <b>241</b>. A non-breathing phase <b>260</b> can be identified without use of a derivative as the time <b>203</b> during which the impedance signal <b>200</b> is below the expiration threshold <b>220</b>.</p>
<p id="p-0068" num="0067">The method <b>100</b> further includes delivering <b>130</b> one or more cardiac pacing pulses coinciding with one or more of the respiratory phases. For example, cardiac pacing pulses from a left ventricular lead electrode can be timed to be delivered within each of the respiration phases discussed herein, including during inspiration, peak inspiration, expiration, and non-breathing (peak expiration) phases.</p>
<p id="p-0069" num="0068">The method <b>100</b> can then determine <b>140</b> whether the patient's phrenic nerve was stimulated by any of the pacing pulses using an accelerometer signal. Such a method can be used to determine if the cardiac pacing pulse parameters are associated with phrenic stimulation during one or more phases of respiration. Such techniques can also indicate if a patient is more susceptible to phrenic nerve activation during particular respiratory phases, by tracking during which phase or phases of respiration pulse delivery was correlated with phrenic nerve activation.</p>
<p id="p-0070" num="0069">In method <b>100</b>, as well as in the others discussed herein, it can be useful to hold cardiac pacing pulse parameters constant (e.g., constant voltage, duration, vector etc.) so that the timing of the pulses during the various respiration phases can be isolated as a variable. For example, pulses having particular voltage and duration parameters can be delivered during inspiration, peak inspiration, and expiration phases to determine whether respiratory phase plays a role in whether the phrenic nerve is stimulated using the parameter settings. One or more of the parameters can then be iteratively changed and tested to determine at which parameter settings the respiratory cycle influences phrenic nerve activation, and which cardiac pace pulse energy parameter settings are not associated with phrenic nerve activation during any phase of respiration.</p>
<p id="p-0071" num="0070">A goal of various embodiments concerns finding cardiac pacing pulse parameter settings or ranges of settings that are not associated with phrenic nerve stimulation during any respiratory phase. Such settings can include pulse voltage, duration, and vector. Therefore, in various embodiments, different (and typically lower power) pacing pulse parameter settings are sought if any of the pulses delivered <b>130</b> during the various respiration phases were determined <b>140</b> to activate the patient's phrenic nerve. The method <b>100</b> can then be repeated until cardiac pacing pulse parameter settings are found that do not stimulate the patient's phrenic nerve during any of the respiratory phases.</p>
<p id="p-0072" num="0071">The diaphragmatic response due to phrenic nerve stimulation can be detected using an accelerometer signal or other vibration detection methods. An accelerometer can measure accelerations of the sensor in one, two, or three dimensions. Accelerometers are sensitive sufficient to output a signal indicating the quick, hiccup-like chest movement experienced during phrenic nerve activation.</p>
<p id="p-0073" num="0072"><figref idref="DRAWINGS">FIGS. 3-4</figref> illustrate overlayed accelerometer signals (XL), measured in units of gravity <b>310</b>. The accelerometer signals <b>300</b> of <figref idref="DRAWINGS">FIG. 3</figref> are relatively flat and illustrate periods with no phrenic nerve activation via cardiac pacing pulse. As such, <figref idref="DRAWINGS">FIG. 3</figref> shows very little deviation in the gravity signal <b>310</b> magnitude.</p>
<p id="p-0074" num="0073"><figref idref="DRAWINGS">FIG. 4</figref> shows accelerometer signals <b>400</b>. Signals <b>400</b> have been overlayed to show a signature acceleration patterns of phrenic nerve activation as measured in gravity <b>410</b>. In this example, acceleration associated with phrenic nerve activation is characterized by peaks <b>401</b> and <b>403</b>.</p>
<p id="p-0075" num="0074">Accelerometer signals could be evaluated in various ways to identify phrenic nerve activation. For example, a detection window can be initiated based on delivery <b>130</b> of a left ventricular pace pulse during a respiration phase of interest, the detection window focusing on accelerometer data. Such a window could open at the moment of pulse delivery or after a period of time after pulse delivery, such as a period of time that is slightly less than the estimated or tested amount of time for a pulse to cause diaphragmic motion perceivable by a sensor following delivery of the pulse. Other times to open a detection window are also contemplated. Such a detection window can have a length (measured in time, such as milliseconds) and satisfaction criteria (e.g., characteristics of the data indicative of phrenic nerve activation) that if met within the window indicate phrenic nerve activation by the cardiac pacing pulse. For example, if one or more peaks (e.g., peaks <b>401</b> and <b>403</b>) are sensed within the window then phrenic nerve activation associated with the left ventricular pulse can be identified. Peaks and other features of accelerometer signals associated with phrenic nerve activation can be identified by timing, energy, and frequency-based methods or morphology analysis, for example. Limited duration of the window (e.g., a time between opening and closing of the window following pulse delivery) can focus collection of data associated with delivery of the cardiac pacing pulse for the amount of time needed to collect the necessary amount of data for phrenic nerve activation detection. In some embodiments, detection of phrenic nerve activation is not limited to windows, but particular techniques and/or heightened sensitivity for the detection of phrenic nerve activation are used within the windows. The opening of detection windows based on delivery of a left ventricular pace pulse to aid in detection of phrenic nerve activation associated with the left ventricular pace pulse can be performed in any embodiment discussed herein, including <figref idref="DRAWINGS">FIGS. 1-10</figref>.</p>
<p id="p-0076" num="0075"><figref idref="DRAWINGS">FIG. 5</figref> represents a time <b>505</b> alignment of right ventricular electrical cardiac signal <b>501</b>, left ventricular electrical cardiac signal <b>502</b>, accelerometer signal <b>503</b>, and impendence signal <b>504</b>. Cardiac pace pulses <b>551</b>-<b>564</b> are periodically delivered and associated cardiac activity (e.g., events <b>510</b>, <b>520</b>, <b>530</b>) appears on the cardiac traces. The pulse voltage parameter <b>509</b> is increased between some of the pace pulses <b>551</b>-<b>564</b> from an initial 1.9 volts to 2.1 volts. Despite this continual pacing (increasing in voltage), continual phrenic nerve activation is not detected. Rather, the accelerometer signal <b>503</b> indicates that the occurrence of phrenic nerve activation is intermittent, and dependent on the respiratory phase in which the particular pulses <b>551</b>-<b>564</b> were delivered.</p>
<p id="p-0077" num="0076">For example, the accelerometer signal <b>503</b> signatures <b>521</b> and <b>531</b> indicate that the phrenic nerve was stimulated by evidence of the characteristic phrenic nerve activation patterns discussed herein. These phrenic nerve activation accelerometer signal <b>503</b> signatures <b>521</b> and <b>531</b> immediately follow delivery of pulses <b>554</b> and <b>563</b> during inspiration phases <b>522</b> and <b>532</b> as indicated by the impedance signal <b>504</b>. It is noted that for this particular subject, pulse <b>552</b> delivered during a non-breathing period, pulse <b>555</b> delivered during expiration, and pulse <b>564</b> delivered during peak inspiration, did not trigger phrenic nerve activation. As such, methods of the present disclosure indicate that this particular subject is particularly susceptible to phrenic nerve activation during inspiration periods relative to other respiration phases. Also, methods of the present disclosure indicate that this particular subject has a transition zone between at least 1.9 to 2.1 volts because phrenic nerve activation between these voltages is dependent on respiration phase.</p>
<p id="p-0078" num="0077">Without wishing to be bound by any particular theory, one possible reason why phrenic nerve activation may be respiratory phase dependent for a subject is that the dimensions between the pacing electrodes and the phrenic nerve may change during the respiratory cycle, thereby changing the tissue through which the current flows. For example, as a particular patient inhales the current path between pacing electrodes may be more likely to traverse an area proximate the phrenic nerve, such that the patient is more susceptible to phrenic nerve activation during inhalation.</p>
<p id="p-0079" num="0078"><figref idref="DRAWINGS">FIG. 6</figref> illustrates a method <b>600</b> for finding cardiac therapy pulse parameter settings that avoid phrenic nerve activation. The method <b>600</b> can be initiated periodically on a preprogrammed schedule (e.g., once daily, weekly, or monthly, etc.), in response to detection of an event (e.g., sensing phrenic nerve activation, capture loss, and/or electrode combination reconfiguring), as part of an automatic ventricular threshold test, and/or by reception of a command (e.g., an input by a doctor or patient requesting automatic testing).</p>
<p id="p-0080" num="0079">In some embodiments, one or more pacing parameters (e.g., pulse voltage, duration) will need to be set when the method <b>600</b> is initiated. The pacing parameter could be set at a previously used pacing value (e.g., when phrenic nerve activation was unexpectedly sensed), above a previously used value, a default value, or programmed by a physician. In the case of a step-up test, it can be preferable to have the pacing parameter initially set at a relatively low setting, below which it is thought that phrenic nerve activation is unlikely. In the case of a step-down test, it can be preferable to have the pacing parameter initially set at a relatively high setting at which it is thought phrenic nerve activation is likely. The method <b>600</b> is directed to a step-down test. However, the steps of the method <b>600</b> could be adapted and used in a step-up test.</p>
<p id="p-0081" num="0080">The method <b>600</b> includes monitoring <b>610</b> phases of patient respiration. Monitoring <b>610</b> can be performed using various techniques that can identify respiratory phases, such as by collecting an impedance signal in the manner of <figref idref="DRAWINGS">FIG. 2</figref>. Cardiac pacing pulses can be delivered <b>620</b> according to a cardiac pacing schedule concurrent or interspaced with monitoring <b>610</b>. During and/or after delivery <b>620</b> of each cardiac pacing pulse, phrenic nerve activation is monitored <b>630</b>, such that activation of the phrenic nerve by any of the delivered <b>620</b> cardiac pacing pulses is identified. Monitoring <b>630</b> for phrenic nerve activation can be done by any technique for identifying phrenic nerve stimulation, such as by using an accelerometer in the manner of <figref idref="DRAWINGS">FIGS. 3-5</figref>. Phrenic nerve activation can also be sensed using an impedance sensor, which may show an abrupt disruption in the impedance signal breathing pattern if the phrenic nerve is activated (e.g., such as an abrupt disruption in the rhythmic breathing patterns of the impedance signal <b>200</b> in <figref idref="DRAWINGS">FIG. 2</figref>).</p>
<p id="p-0082" num="0081">After delivery <b>620</b> of each pulse, or at other times (e.g., every minute, after delivery <b>620</b> of every 10 pulses, or after each respiratory phase or cycle), it is determined whether at least one pulse has been delivered during each respiratory phase of interest <b>640</b>. It is noted that step <b>640</b>, as well as the other techniques described herein, refer to pulse delivery in an occurrence of a phase of interest, not in each occurrence of each phase of interest. For example, if the respiratory phase of interest is inspiration, then 5 cycles of breathings will have 5 instances of inspiration. The methods described herein do no need to deliver (e.g., <b>620</b>) cardiac pacing pulses in each of the 5 instances of inspiration. Rather, the methods can be completed by delivering the prescribed number of pacing pulses in the respiratory phase of interest (inspiration) over the course of many cycles (e.g., 100 cycles). In this way, during some breathing cycles only cardiac support pacing is delivered and none of the pace pulses are intended as testing for phrenic nerve activation. Continuing with the example above, in may be that only 1 cardiac pacing pulse is delivered during inspiration over the course of the 5 breath cycles. In some cases, cardiac pacing pulses are delivered during several of the 5 inspiration phases, but only 1 of them is part of the test for phrenic nerve activation, wherein an accelerometer signal is analyzed for phrenic nerve stimulation only in association with this 1 test pulse. In some embodiments, a detection window is opened only in response to a pacing pulse that is considered to be part of the test.</p>
<p id="p-0083" num="0082">In some embodiments, all respiratory cycle phases are of interest, such that at least one pulse will need to be delivered <b>620</b> in each of inspiration, peak inspiration, expiration, and non-breathing phases to satisfy step <b>640</b> for a certain number of occurrences of these phases. However, in some other embodiments, not all respiration cycle phases will be of interest. For example, in some embodiments only inspiration and expiration, or peak inspiration, will be determined to be the phase or phases of interest, and in such embodiments step <b>640</b> would only check whether sufficient number of pulses (e.g., 1, 5, or 10) were delivered <b>630</b> coinciding with the phase or phases of interest.</p>
<p id="p-0084" num="0083">In some embodiments, step <b>640</b> will only be satisfied when a predetermined number of pulses have been delivered in each respiratory phase of interest. For example, a device could be programmed to check for phrenic nerve activation <b>650</b> only after 10 pulses have been delivered in each respiratory phase of interest (e.g., check whether any of the previously delivered 10 pulses activated the phrenic nerve). Such embodiments allow for repeatedly testing specific pacing parameters during one or more respiratory phases of interest, which in some circumstances may produce more reliable results then testing pacing parameters a fewer number of times.</p>
<p id="p-0085" num="0084">As discussed above, step <b>640</b> represents a check to determine whether a sufficient number of pulses having been delivered in satisfaction of predetermined criteria, where if not enough pulses have been delivered <b>620</b> then the method <b>600</b> continues or resumes delivering <b>620</b> cardiac pacing pulses according to the cardiac pacing schedule while holding pacing energy parameters constant until the criteria are satisfied. In this way, the method <b>600</b> essentially dwells at the current pacing parameter over one or more respiratory cycles and delivers <b>620</b> pacing pulses during various cycle phases to determine the influence of respiratory phase on phrenic nerve activation until pacing pulse parameter settings are found that reliably do not activate the phrenic nerve.</p>
<p id="p-0086" num="0085">If phrenic nerve activation is detected <b>650</b> for any of the delivered <b>620</b> pulses, then the method <b>600</b> decrements <b>660</b> the current pacing pulse parameter setting. For example, if the current pacing pulse parameter setting was 1.6 volts at delivery <b>620</b>, and phrenic nerve activation was detected <b>650</b> (e.g., phrenic nerve activation associated with one or more pulses delivered <b>620</b> during peak inspiration), then the pulse voltage setting can be decremented to 1.5 volts. Other parameters (e.g., pulse duration) can be scanned and decremented (or incremented in scan-up embodiments) in different amounts.</p>
<p id="p-0087" num="0086">Steps <b>620</b>-<b>630</b>-<b>640</b>-<b>650</b>-<b>660</b> can be executed in a loop, decrementing <b>660</b> the pacing parameter with each turn of the loop, until phrenic nerve activation is lost for all respiration cycle phases of interest. When phrenic nerve activation is detected <b>650</b> to be lost for all respiration cycle phases of interest, the parameter levels to which the cardiac pacing parameters were decremented <b>660</b> to can be set <b>670</b> as cardiac pacing parameters for subsequent therapy (or a further decremented value can be used to provide a safety margin). The set <b>670</b> cardiac pacing parameters can then be used for therapy delivery, which provides some assurance that phrenic nerve stimulation is unlikely. The method <b>600</b> can then be initiated once again as discussed above, such as by the detection of phrenic nerve stimulation months or years after the cardiac pacing parameters have been set <b>670</b> and used for therapy.</p>
<p id="p-0088" num="0087">In the method <b>600</b> of <figref idref="DRAWINGS">FIG. 6</figref>, the pacing pulses are delivered <b>620</b> according to a cardiac pacing schedule, such that a regimen of cardiac paces consistent with a prescribed cardiac therapy is maintained throughout testing for phrenic nerve activation. In this way, the coinciding of pulses and respiratory phases of interest occurs randomly, as alignment depends on the cardiac pacing schedule (which itself could be based on one or more physiologic parameters such as intrinsic atrial activity and/or patient activity level) and natural patient breathing. In this way, the timing of cardiac pacing pulse delivery is not based on the respiration cycle of the patient. In some other embodiments, the pulses can be delivered <b>620</b> in a manner specifically timed for the monitored <b>610</b> phases of interest, such as by changing an artioventricular delay. However, the method <b>600</b> as illustrated dwells in steps <b>620</b>-<b>640</b> through enough respiratory cycles until pulses are delivered during all phases of interest, wherein no pulse timing adjustment is made based on respiration (i.e. the pulse timing is dependent on cardiac parameters, such as the normal course of cardiac resynchronization therapy, and not respiratory parameters).</p>
<p id="p-0089" num="0088"><figref idref="DRAWINGS">FIG. 7</figref> illustrates a method <b>700</b> for characterizing a patient's phrenic nerve activation transition zone. The method <b>700</b> includes initiating <b>710</b> a phrenic nerve activation test. Initiation <b>710</b> can occur in the same manner as in the method <b>600</b> of <figref idref="DRAWINGS">FIG. 6</figref> (e.g., sensing phrenic nerve stimulation).</p>
<p id="p-0090" num="0089">Part of initiating <b>710</b> can include setting a current parameter level. The method <b>700</b> of <figref idref="DRAWINGS">FIG. 7</figref> is generally directed to a step-down test, although the method <b>700</b> could be adapted to a step-up test. The method <b>700</b> further includes delivering <b>720</b> at least one pacing pulse to the heart using the current pacing parameter settings, which can be the levels set in the initiation <b>710</b>. During and/or after delivery <b>720</b>, accelerometer signals can be obtained and evaluated <b>730</b>. Although step <b>720</b> pertains to the use of accelerometer signals, any type of signal that indicates phrenic nerve activation can additionally or alternatively be used. The accelerometer signal can be evaluated in any manner discussed herein to detect phrenic nerve activation <b>735</b> (e.g., in the manner of <figref idref="DRAWINGS">FIGS. 3-4</figref>).</p>
<p id="p-0091" num="0090">If phrenic nerve activation is not detected <b>735</b>, the method <b>700</b> advances to step <b>750</b>. If phrenic nerve stimulation is detected, the method <b>700</b> advances to step <b>740</b> where the current pacing parameter level is decremented (e.g., reduced in voltage and/or pulse duration). In this way, the method <b>700</b> can loop through steps <b>720</b>-<b>730</b>-<b>735</b>-<b>740</b> until phrenic nerve activation is not detected <b>735</b> and an upper transition zone boundary is identified <b>750</b> (e.g., the upper transition zone boundary is identified as the parameter level at which phrenic nerve activation is first lost in a step-down scan).</p>
<p id="p-0092" num="0091">In the embodiment of <figref idref="DRAWINGS">FIG. 7</figref>, respiration phase becomes particularly important once the decrementing scan reaches the upper transition boundary, as within the transition zone phrenic nerve activation becomes dependent on the respiratory cycle phase. As such, respiration signals are obtained <b>760</b> to identify respiration phases, such as using the techniques discussed herein. Such signals may include impedance, among other signals. Respiration signals can be obtained <b>760</b> at any time during the method <b>700</b>, including during step <b>770</b>.</p>
<p id="p-0093" num="0092">In step <b>770</b>, a least one cardiac pacing pulse is delivered in each type of respiration phase of interest using the current pacing parameter setting. For example, the phases of interest may be inspiration, peak inspiration, and expiration. Occurrence of these phases is identified based on the obtained <b>760</b> respiration signals. The goal is not to deliver a pacing pulse during each occurrence of these phases for each respiratory cycle, but rather to complete step <b>770</b> by at some point delivering one pacing pulse during one occurrence of each phase of interest, even if over many respiratory cycles. For example, if the phases of interest are inspiration, peak inspiration, and expiration, then step <b>770</b> could be complete when a first pulse is delivered during one instance of inspiration, a second pulse is delivered during one instance of peak inspiration, and a third pulse is delivered during one instance of expiration. It may take many respiration cycles while a device dwells at the current pulse parameter settings before the opportunity arises for a device to deliver the necessary pulses to complete step <b>770</b>.</p>
<p id="p-0094" num="0093">There are various ways to deliver a least one pacing pulse in each type of respiration phase of interest using the current pacing parameter setting. For example, the timing of the pace pulses of step <b>770</b> could be based on a cardiac therapy schedule, where the pacing parameters energy levels are held constant during normal pacing operation until cardiac pulses just happen to be delivered in each type of respiration phase of interest. Again, it may take many respiration cycles before the respiration phases of interest and cardiac therapy schedule naturally align. Waiting for alignment in this way can be safer for a patient, as this method prioritizes proper and consistent cardiac therapy over deviating from a cardiac therapy schedule to expedite completion of the scan.</p>
<p id="p-0095" num="0094">In some other embodiments, pacing pulse timing parameters, such as atrioventricular (AV) and left ventricular-right ventricular (VV) timing parameters, can be adjusted to cause alignment of a pacing pulse and a respiration phase of interest to complete step <b>770</b> (e.g., adjusting a cardiac therapy schedule to force alignment of a pulse and a respiratory cycle phase of interest). In some cases, a device may wait for natural alignment (e.g., according to a cardiac therapy schedule based on cardiac parameters and not based on respiration), but if a timer expires without completion of step <b>770</b>, then the AV delay or some other timing parameter may be slightly adjusted to force alignment.</p>
<p id="p-0096" num="0095">During step <b>770</b>, accelerometer or other data indicative of phrenic nerve activation can be taken and evaluated as in the manner of step <b>730</b>. Using this data, it can be determined whether phrenic nerve activation was detected <b>775</b> during any of the respiratory phases of interest corresponding to a delivered <b>770</b> pacing pulse. If phrenic nerve activation was detected <b>775</b> for any of the phases of interest in which a pacing pulse was delivered <b>770</b>, then the current pacing parameter is decremented <b>780</b> and step <b>770</b> is repeated. In this way, steps <b>770</b>-<b>775</b>-<b>780</b> can be repeated in a loop until a lower transition zone boundary is identified <b>790</b>. Identification <b>790</b> of the lower transition zone boundary is based on the current pacing parameter settings when no phrenic nerve activation was detected <b>775</b> from pacing pulses from <b>770</b>.</p>
<p id="p-0097" num="0096">In some embodiments, a set of cardiac pacing pulses (i.e. a predetermined number of pulses having common energy parameters) must be delivered <b>770</b> during each type of respiratory phase of interest without any pulses of the set activating the phrenic nerve. Successive sets of pulses decreasing in energy can be delivered until all of the pulses of one of the sets do not cause phrenic nerve activation (e.g., 10 pulses must be delivered <b>770</b> during 10 occurrences of each type of phase of interest to satisfy step <b>770</b>). For the energy parameters of the set that did not activate the phrenic nerve, it can be determined that the parameters are below the lower transition zone boundary <b>790</b>. Sets of cardiac pacing pulses can also be used in the same manner in the other methods discussed herein (e.g., the methods of <figref idref="DRAWINGS">FIGS. 2 and 6</figref>).</p>
<p id="p-0098" num="0097">In the method <b>700</b> of <figref idref="DRAWINGS">FIG. 7</figref>, a scan is conducted of one or more cardiac pacing pulse parameters in steps <b>720</b>-<b>730</b>-<b>735</b>-<b>740</b> without regard to respiration phase because phrenic nerve activation is not supposed to be respiration phase dependent above the transition zone. Once the upper transition zone boundary is identified <b>750</b>, the subsequent scanning takes into account respiratory phase until the lower zone boundary is identified <b>790</b>, because phrenic nerve activation is respiratory phase dependent within the transition zone. Although not illustrated, subsequent scanning below the lower transition zone boundary (e.g., step-down scan to identify the cardiac capture threshold) may not take into account respiratory phase, because phrenic nerve activation should not be dependent on respiratory phase below the lower transition zone boundary.</p>
<p id="p-0099" num="0098">Some patients may not have a transition zone. In such cases, a device could carryout the methods discussed herein by equating the upper boundary with the lower boundary and this value would be deemed the phrenic nerve activation threshold. Some embodiments may not seek to define both an upper and lower limit of a transition zone. For example, in a scan-down embodiment, only the lower zone boundary may be of interest, such that cardiac therapy pacing parameters can be set below the lower zone boundary once the lower zone boundary is found. Some embodiments may not seek to identify transition zone boundaries, but instead just check whether phrenic nerve activation is dependent on respiration phase for a pacing parameter level of interest by testing all respiration phases of interest at the pacing parameter level of interest (e.g., as if only steps <b>770</b>-<b>775</b>-<b>780</b> were performed).</p>
<p id="p-0100" num="0099">The methods and devices disclosed herein can characterize a transition zone within a strength-duration relationship. Cardiac capture is produced by pacing pulses having sufficient energy to produce a propagating wavefront of electrical depolarization that results in a contraction of the heart tissue. Generally speaking, the energy of the pacing pulse is a product of two energy parameters&#x2014;the amplitude of the pacing pulse and the duration of the pulse. Thus, the capture threshold voltage over a range of pulse widths may be expressed in a capture strength-duration plot <b>810</b> as illustrated in <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0101" num="0100">Phrenic nerve activation by a pacing pulse is also dependent on the pulse energy. The phrenic nerve activation strength-duration plot <b>820</b> for reliable undesirable activation may have a different characteristic from the capture strength-duration plot <b>810</b> and may have a relationship between pacing pulse voltage and pacing pulse width.</p>
<p id="p-0102" num="0101"><figref idref="DRAWINGS">FIG. 8</figref> provides graphs illustrating a capture strength-duration plot <b>810</b> associated with cardiac capture and a phrenic nerve activation strength-duration plot <b>820</b> associated with reliable undesirable diaphragmic activation (e.g., phrenic nerve activation regardless of respiratory phase). A pacing pulse having a pulse width of W<sub>1 </sub>requires a pulse amplitude of V<sub>c1 </sub>to produce capture. A pacing pulse having pulse width W<sub>1 </sub>and pulse amplitude V<sub>c1 </sub>exceeds the voltage threshold, V<sub>u1</sub>, for an undesirable diaphragmic activation through phrenic nerve stimulation. If the pulse width is increased to W<sub>2</sub>, the voltage required for capture, V<sub>c2</sub>, is less than the voltage required for undesirable diaphragmic activation, V<sub>u2</sub>. Therefore, pacing pulses can be delivered at the pacing energy associated with W<sub>2</sub>, V<sub>c2 </sub>to provide capture of the heart without causing the phrenic nerve activation.</p>
<p id="p-0103" num="0102">The area to the right of the intersection <b>851</b> of the capture and phrenic nerve activation strength-duration plots <b>810</b>, <b>820</b>, between the phrenic nerve activation strength-duration <b>820</b> and capture strength-duration <b>810</b> plots, defines a set of energy parameter values that produce capture while avoiding phrenic nerve activation. Pacing pulses within this region produce a more ideal therapy response (capture without undesirable stimulation).</p>
<p id="p-0104" num="0103">The capture and phrenic nerve activation strength-duration plots <b>810</b>, <b>820</b> of <figref idref="DRAWINGS">FIG. 8</figref> may be generated by delivering a number of test pulses at various amplitudes and pulse widths and evaluating whether cardiac capture and undesirable stimulation occurred (e.g., using the methods of <figref idref="DRAWINGS">FIGS. 1</figref>, <b>6</b>, and/or <b>7</b>). The capture and phrenic nerve activation strength-duration plots <b>810</b>, <b>820</b> can then be completed by interpolation and extrapolation based on, for example, an exponential fit. Such methods can minimize the number of test pulses required to fully characterize the relationships between pulse parameters and stimulation, thereby minimizing battery consumption and uncomfortable testing. Extrapolation and interpolation can also allow the relationships between pulse parameters and stimulation for a particular device configuration to be characterized beyond what the device itself is programmed to, or capable of, performing. Methods and systems for determining and using strength-duration relationships are described in U.S. Pat. No. 8,209,013, which is incorporated herein by reference in its entirety.</p>
<p id="p-0105" num="0104"><figref idref="DRAWINGS">FIG. 8</figref> also illustrates a transition zone <b>890</b> outlined by dashed lines and the phrenic nerve activation strength-duration plot <b>820</b>. The transition zone <b>890</b> is the parameter range inside of which phrenic nerve activation is dependent on the phase of the patient's respiration cycle. The transition zone <b>890</b> could be determined by scanning techniques, such as by the method of <figref idref="DRAWINGS">FIG. 7</figref> performed for both pulse voltage and duration parameters.</p>
<p id="p-0106" num="0105">In programming a therapy device, it is generally desirable to program a pacing device so as to not risk causing undesirable stimulation, such as phrenic nerve activation. Therefore, it can be desirable to select pacing parameters that are not within a transition zone. Moreover, it can be desirable to select pacing parameter settings below a transition zone because the lower the pulse voltage and pulse duration the less battery energy is used for therapy. These aspects of therapy programming can make use of a strength-duration curve and transition zone, such as that of <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0107" num="0106">For example, a doctor or system analyzing <figref idref="DRAWINGS">FIG. 8</figref> may select a pacing pulse parameter (e.g., voltage) above the capture strength-duration plot <b>810</b> but below the transition zone <b>890</b> as a setting that will reliably capture the appropriate chamber (e.g., left ventricle) without occasionally activating the phrenic nerve.</p>
<p id="p-0108" num="0107">A doctor or system may select a voltage parameter based on the voltage range above the capture strength-duration plot <b>810</b> and below the transition zone <b>890</b>. For example, some pacing protocols will vary the pulse voltage between pulses for various reasons during the normal course of therapy. A greater parameter range between capture strength-duration plot <b>810</b> and the transition zone <b>890</b> indicates a greater parameter range within which a protocol (e.g., automatic ventricular capture test) has to operate to vary a parameter (e.g., pulse voltage). In the case of <figref idref="DRAWINGS">FIG. 8</figref>, a doctor or system may be more likely to select a shorter pulse width because the shorter pulse widths are associated with a greater range between the capture strength-duration plot <b>810</b> and the transition zone <b>890</b> relative to longer pulse widths. In this way, a doctor or system can select a pacing pulse parameter level (e.g., voltage or duration) based on that parameter level having a greater range between a transition zone and a threshold (e.g., cardiac capture or phrenic nerve activation threshold) relative to other parameter levels.</p>
<p id="p-0109" num="0108">If a doctor or system wanted or needed to use a parameter setting within a transition zone (e.g., if preferred therapy parameters were only possible within a transition zone) then the methods described herein could inform the doctor that the device would need to be programmed to time pacing pulses (e.g., left ventricular pulses) with the respiration cycle to minimize phrenic nerve activation by avoiding delivering pulses when the respiration cycle is in the phase most susceptible to phrenic nerve activation identified for that particular patient and pace pulse settings (e.g., vector and energy parameters) using the methods and systems discussed herein. In some embodiments, a system could automatically avoid delivering pulses during respiratory phase or phases that are identified by the methods and systems discussed herein as most susceptible to phrenic nerve activation for a particular patient.</p>
<p id="p-0110" num="0109">Multiple strength-duration plots having transition zones like the one illustrated in <figref idref="DRAWINGS">FIG. 8</figref> can be generated for multiple different electrode combinations. Based on the strength-duration plots, a preferred electrode combination can be selected for delivering therapy. For example, if one electrode combination is associated with a smaller transition zone then it may be preferable to select for therapy delivery versus an electrode combination having a larger transition zone. In many cases, the electrode combination with the smaller transition zone would likely correspond to the configuration having the greatest amount of flexibility in an operation that achieves a desired therapy outcome (e.g., capture without phrenic nerve activation). Parameter and electrode selection in the ways described herein may be performed by a human or automatically by a processor executing stored program instructions. Methods and systems for electrode combination selection are described in United States Patent Application Publication No. 2009/0043351, which is incorporated herein by reference in its entirety.</p>
<p id="p-0111" num="0110">In some embodiments, a preferred electrode combination for delivering pacing therapy can be selected (e.g., by a human or controller) on the basis of which combination has the greatest range between the capture strength-duration plot <b>810</b> and the detected pacing settings at which phrenic nerve activation is not detected for any respiratory phases (e.g., as determined by the methods of <figref idref="DRAWINGS">FIGS. 1</figref>, <b>6</b>, and/or <b>7</b>). Selecting on the basis of such a range gives an automated therapy program the most range in which to modify a parameter (e.g., voltage) as needed over time.</p>
<p id="p-0112" num="0111">Various embodiments not only test various energy parameters to characterize a patient's phrenic nerve activation response, but also test various electrode combinations used for pace pulse delivery. For example, an embodiment according to <figref idref="DRAWINGS">FIG. 6</figref> could additionally or alternatively switch electrode combinations for step <b>660</b>, cycling through various electrode combinations by repeating steps <b>620</b>-<b>620</b>-<b>640</b>-<b>650</b>-<b>660</b> until a vector is found that is not associated with phrenic nerve activation for any phases of respiration. An electrode combination can then be selected and used for cardiac therapy delivery based on which electrode combination has preferable energy parameters (e.g., lowest capture threshold) that is not associated with phrenic nerve activation for any phases of respiration at those preferable energy parameters. The other embodiments discussed herein (e.g., <figref idref="DRAWINGS">FIGS. 1-10</figref>) can likewise test different electrode combinations and facilitate vector selection based on which vector or vectors provide a beneficial therapeutic response using preferable energy parameters that are not associated with phrenic nerve activation for any phases of respiration at those preferable energy parameters.</p>
<p id="p-0113" num="0112">In some embodiments, the particular phase or phases of a patient's respiration cycles in which phrenic nerve stimulation occurs can be identified. For example, only during certain phases of the respiratory cycle are some patients particularly susceptible to phrenic nerve stimulation at certain pacing parameter settings. As such, various embodiments can determine which respiratory phase(s) are associated with phrenic nerve activation and which are not, such as by using the methods described herein in connection with <figref idref="DRAWINGS">FIGS. 1-10</figref>. Therefore, pacing pulses can only be delivered during those phases which are not associated with phrenic nerve stimulation and/or pacing therapy timing parameters can be adjusted (e.g., artioventricular delay and/or biventricular delay) can be automatically adjusted as needed to avoid delivering a pacing pulse during a respiratory phase determined to be associated with phrenic nerve stimulation.</p>
<p id="p-0114" num="0113">The methods and techniques described herein can be used to identify different thresholds for different respiration phases. For example, the scanning aspects of <figref idref="DRAWINGS">FIGS. 1</figref>, <b>6</b>, and/or <b>7</b> can be used to identify a phrenic nerve activation threshold for each phase of interest, such as inspiration, peak inspiration, expiration, and non-breathing, by delivering cardiac pacing pulse during these phases and scanning across one or more pulse energy parameters. For example, <figref idref="DRAWINGS">FIG. 1</figref> can be used to determine at which voltage a patient's phrenic nerve will be activated by a cardiac pacing pulse delivered during inspiration. The same can be done for the other respiratory phases, such that 4 different phrenic nerve activation thresholds will be identified, one for each phase of respiration. This information can then be used for therapy delivery. For example, the 4 phrenic nerve activation thresholds can be automatically programmed for use during CRM therapy delivery. During therapy delivery a device can monitor respiratory phase, and depending on which respiratory phase a patient is in when it is desired to deliver a cardiac pacing pulse, pulse energy level can be varied in accordance with the phrenic nerve activation threshold of the current respiratory phase. Considering that heart rate is typically faster than respiratory rate, several cardiac pacing pulses could be delivered during a single respiratory cycle, the energy level of each pulse adjusted to be below the phrenic nerve activation threshold of the current respiratory phase.</p>
<p id="p-0115" num="0114">A cardiac rhythm management system configured to carry out such methods can comprise an implantable cardiac pacing device having a plurality of electrodes configured for implantation in a patient; circuitry configured to output a plurality of cardiac pacing pulses through the electrodes and modify one or more pacing parameters of the plurality of cardiac pacing pulses; a phrenic nerve activation sensor configured to output a phrenic nerve activation signal indicative of activation of the patient's phrenic nerve; a respiration sensor configured to output a respiration signal indicative of inhalation and exhalation respiratory activity of the patient; and a controller configured to execute program instructions stored in memory to cause the system to identify a plurality of different respiratory phases based on the respiration signal for multiple respiratory cycles of the patient, deliver the plurality of cardiac pacing pulses within each of the identified plurality of different respiratory phases, analyze the phrenic nerve stimulation signal to identify respective phrenic nerve activation thresholds for a plurality of different respiratory phases based on the phrenic nerve activation signal, identify cardiac pacing pulse parameters for each of the plurality of respiratory phases based on the respective phrenic nerve activation thresholds for the plurality of respiratory phases, and deliver a cardiac pacing pulse therapy by varying pulse energy output based on which respiratory phase each pacing pulse of the therapy is to be delivered in using the identified cardiac pacing pulse parameters.</p>
<p id="p-0116" num="0115"><figref idref="DRAWINGS">FIG. 9</figref> is a block diagram of a CRM device <b>900</b> that may incorporate circuitry employing phrenic nerve activation detection algorithms in accordance with embodiments of the present invention. The CRM device <b>900</b> includes pacing therapy circuitry <b>930</b> that delivers pacing pulses to a heart. The CRM device <b>900</b> may optionally include defibrillation/cardioversion circuitry <b>935</b> configured to deliver high energy defibrillation or cardioversion stimulation to the heart for terminating dangerous tachyarrhythmias.</p>
<p id="p-0117" num="0116">The pacing pulses are delivered via multiple cardiac electrodes <b>905</b> (using electrode combinations), which can be disposed at multiple locations within a heart, among other locations. Two or more electrodes may be disposed within a single heart chamber, such as the left ventricle. The electrodes <b>905</b> are coupled to switch matrix <b>925</b> circuitry used to selectively couple electrodes <b>905</b> of various pacing configurations to signal processor <b>901</b>, pacing therapy circuitry <b>930</b>, defibrillation/cardioversion circuitry <b>935</b>, and/or other components of the CRM device <b>900</b>.</p>
<p id="p-0118" num="0117">The CRM <b>900</b> device also includes a phrenic nerve activation sensor <b>910</b>. The phrenic nerve activation sensor <b>910</b> can output a signal and/or other information to signal processor <b>901</b> and control processor <b>940</b>. Phrenic nerve activation sensor <b>910</b> may include an accelerometer, electrical signal sensors (e.g., EMG, impedance), pressure sensor, acoustic sensors, and/or any other sensor that can detect phrenic nerve activation. Phrenic nerve activation sensor <b>910</b> may be implemented using a discrete sensor or via software executed by a processor (e.g., control processor <b>940</b>) of the CRM device.</p>
<p id="p-0119" num="0118">The control processor <b>940</b> can use information received from the signal processor <b>901</b>, the phrenic nerve activation sensor <b>910</b>, memory <b>945</b>, and other components to implement phrenic nerve activation characterization and avoidance algorithms, as disclosed herein.</p>
<p id="p-0120" num="0119">For example, the pacing therapy circuitry <b>930</b> can provide information regarding when a pacing pulse was delivered and the parameters of the pacing pulse, the phrenic nerve activation sensor <b>910</b> can provide information regarding sensed phrenic nerve activation, and signal processor <b>901</b> can provide information regarding transthoracic impedance (measured between electrodes <b>905</b>). This information can be used to identify respiratory cycle phases, phrenic nerve activation, phrenic nerve activation transition zones, and manage therapy delivery to avoid phrenic nerve activation, among other things.</p>
<p id="p-0121" num="0120">Amplitude, peak timing, and/or correlation of delivered pulses to phrenic nerve activation (beat-to-beat and/or over time) can be used with a phrenic nerve activation signal in either the time or frequency domain to determine whether one or more pacing pulses caused phrenic nerve stimulation.</p>
<p id="p-0122" num="0121">A CRM device <b>900</b> typically includes a battery power supply (not shown) and communications circuitry <b>950</b> for communicating with an external device programmer <b>960</b> or other patient-external device. Information, such as data, parameter information, evaluations, comparisons, data, and/or program instructions, and the like, can be transferred between the device programmer <b>960</b> and patient management server <b>970</b>, CRM device <b>900</b> and the device programmer <b>960</b>, and/or between the CRM device <b>900</b> and the patient management server <b>970</b> and/or other external system. In some embodiments, the processor <b>940</b>, memory <b>945</b>, and/or signal processor <b>901</b> may be components of the device programmer <b>960</b>, patient management server <b>970</b>, and/or other patient external system.</p>
<p id="p-0123" num="0122">The CRM device <b>900</b> also includes memory <b>945</b> for storing executable program instructions and/or data, accessed by and through the control processor <b>940</b>. In various configurations, the memory <b>945</b> may be used to store information related to thresholds, parameters, measured values, transitions zones, phrenic nerve activation patterns, program instructions, and the like.</p>
<p id="p-0124" num="0123">The circuitry represented in <figref idref="DRAWINGS">FIG. 9</figref> can be used to perform the various methodologies and techniques discussed herein. Memory <b>945</b> can be a computer readable medium encoded with a computer program, software, firmware, computer executable instructions, instructions capable of being executed by a computer, etc. to be executed by circuitry, such as control processor <b>940</b>. For example, memory <b>945</b> can be a computer readable medium storing a computer program, execution of the computer program by control processor <b>940</b> causing delivery of pacing pulses directed by the pacing therapy circuitry, reception of one or more signals from phrenic nerve activation sensors <b>910</b> and/or signal processor <b>901</b> to identify phrenic nerve activation transition zones and manage therapy parameters to avoid phrenic nerve activation in accordance with the various methods and techniques made known or referenced by the present disclosure. In similar ways, the other methods and techniques discussed herein can be performed using the circuitry represented in <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0125" num="0124">The methods and devices discussed herein can collect electrical signals, such as impedance signals indicative of respiration and electrical cardiac signals indicative of heart activity, using electrodes. Such electrodes can include implanted electrodes <b>905</b> and/or external electrodes, such as skin electrodes (not shown).</p>
<p id="p-0126" num="0125">The therapy device <b>1000</b> illustrated in <figref idref="DRAWINGS">FIG. 10</figref> employs circuitry capable of implementing phrenic nerve activation detection algorithm techniques described herein. The therapy device <b>1000</b> includes CRM circuitry enclosed within an implantable housing <b>1001</b>. The CRM circuitry is electrically coupled to an intracardiac lead system <b>1010</b>. Although an intracardiac lead system <b>1010</b> is illustrated in <figref idref="DRAWINGS">FIG. 10</figref>, various other types of lead/electrode systems may additionally or alternatively be deployed. For example, the lead/electrode system may comprise an epicardial lead/electrode system including electrodes outside the heart and/or cardiac vasculature, such as a heart sock, an epicardial patch, and/or a subcutaneous system having electrodes implanted below the skin surface but outside the ribcage.</p>
<p id="p-0127" num="0126">Portions of the intracardiac lead system <b>1010</b> are shown inserted into the patient's heart. The lead system <b>1010</b> includes cardiac pace/sense electrodes <b>1051</b>-<b>1056</b> positioned in, on, or about one or more heart chambers for sensing electrical signals from the patient's heart and/or delivering pacing pulses to the heart. The intracardiac sense/pace electrodes, such as those illustrated in <figref idref="DRAWINGS">FIG. 10</figref>, may be used to sense and/or pace one or more chambers of the heart, including the left ventricle, the right ventricle, the left atrium and/or the right atrium. The CRM circuitry controls the delivery of electrical stimulation pulses delivered via the electrodes <b>1051</b>-<b>1056</b>. The electrical stimulation pulses may be used to ensure that the heart beats at a hemodynamically sufficient rate, may be used to improve the synchrony of the heart beats, may be used to increase the strength of the heart beats, and/or may be used for other therapeutic purposes to support cardiac function consistent with a prescribed therapy while avoiding phrenic nerve activation.</p>
<p id="p-0128" num="0127">The lead system <b>1010</b> may include defibrillation electrodes <b>1041</b>, <b>1042</b> for delivering defibrillation/cardioversion pulses to the heart.</p>
<p id="p-0129" num="0128">The left ventricular lead <b>1005</b> incorporates multiple electrodes <b>1054</b><i>a</i>-<b>1054</b><i>d </i>and <b>1055</b> positioned at various locations within the coronary venous system proximate the left ventricle. Stimulating the ventricle at multiple locations in the left ventricle or at a single selected location may provide for increased cardiac output in patients suffering from heart failure (HF), for example, and/or may provide for other benefits. Electrical stimulation pulses may be delivered via the selected electrodes according to a timing sequence and output configuration that enhances cardiac function. Although <figref idref="DRAWINGS">FIG. 10</figref> illustrates multiple left ventricle electrodes, in other configurations, multiple electrodes may alternatively or additionally be provided in one or more of the right atrium, left atrium, and right ventricle.</p>
<p id="p-0130" num="0129">Portions of the housing <b>1001</b> of the implantable device <b>1000</b> may optionally serve as one or more multiple can <b>1081</b> or indifferent <b>1082</b> electrodes. The housing <b>1001</b> is illustrated as incorporating a header <b>1089</b> that may be configured to facilitate removable attachment between one or more leads and the housing <b>1001</b>. The housing <b>1001</b> of the therapy device <b>1000</b> may include one or more can electrodes <b>1081</b>. The header <b>1089</b> of the therapy device <b>1000</b> may include one or more indifferent electrodes <b>1082</b>. The can <b>1081</b> and/or indifferent <b>1082</b> electrodes may be used to deliver pacing and/or defibrillation stimulation to the heart and/or for sensing electrical cardiac signals of the heart. One or more accelerometers can be provided on and/or within the housing <b>1001</b>, header <b>1001</b>, or lead system <b>1010</b> for sensing phrenic nerve activation.</p>
<p id="p-0131" num="0130">Communications circuitry is disposed within the housing <b>1001</b> for facilitating communication between the CRM circuitry and a patient-external device, such as an external programmer or advanced patient management (APM) system. The therapy device <b>1000</b> may also include sensors and appropriate circuitry for sensing a patient's metabolic need and adjusting the pacing pulses delivered to the heart to accommodate the patient's metabolic need.</p>
<p id="p-0132" num="0131">Impedance can be measured to track respiration phases. In some embodiments, measurement of impedance involves an electrical stimulation source, such as an exciter. The exciter delivers an electrical excitation signal, such as a strobed sequence of current pulses or other measurement stimuli, to the heart between the electrodes. In response to the excitation signal provided by an exciter, a response signal, e.g., voltage response value, is sensed by impedance detector circuitry, such as that in a signal processor. From the measured voltage response value and the known current value, the impedance of the electrode combination may be calculated.</p>
<p id="p-0133" num="0132">For example, a small current can be injected through electrodes <b>905</b> (of <figref idref="DRAWINGS">FIG. 9</figref>) by pacing therapy circuitry <b>930</b> or other components. The impedance between two or more electrodes <b>905</b> is then measured, changes in which can reflect the phases of respiration as shown in <figref idref="DRAWINGS">FIG. 2</figref>. The electrodes could be skin surface electrodes or subcutaneous electrodes. Different electrode pairs could be used. For example, any pair or grouping of electrodes of <figref idref="DRAWINGS">FIG. 10</figref> can be used to measure impedance, including lead-to-lead (e.g., <b>1055</b>-<b>1041</b>), lead-to-can (e.g., <b>1053</b>-<b>1081</b>), and can-to-can (e.g., <b>1081</b>-<b>1082</b>) measurements.</p>
<p id="p-0134" num="0133">Techniques and circuitry for determining the impedance of an electrode combination is described in commonly owned U.S. Pat. No. 6,076,015 which is incorporated herein by reference in its entirety.</p>
<p id="p-0135" num="0134">In some implementations, an APM system may be used to perform some of the processes discussed herein, including evaluating, estimating, comparing, detecting, selecting, and updating, among others. Methods, structures, and/or techniques described herein, may incorporate various APM related methodologies, including features described in one or more of the following references: U.S. Pat. Nos. 6,221,011; 6,270,457; 6,277,072; 6,280,380; 6,312,378; 6,336,903; 6,358,203; 6,368,284; 6,398,728; and 6,440,066, which are hereby incorporated herein by reference in each of their respective entireties.</p>
<p id="p-0136" num="0135">In certain embodiments, the therapy device <b>1000</b> may include circuitry for detecting and treating cardiac tachyarrhythmia via defibrillation therapy and/or anti-tachyarrhythmia pacing (ATP). Configurations providing defibrillation capability may make use of defibrillation coils <b>1041</b>, <b>1042</b> for delivering high energy pulses to the heart to terminate or mitigate tachyarrhythmia.</p>
<p id="p-0137" num="0136">CRM devices using multiple electrodes, such as illustrated herein, are capable of delivering pacing pulses to multiple sites of the atria and/or ventricles during a cardiac cycle. Certain patients may benefit from activation of parts of a heart chamber, such as a ventricle, at different times in order to distribute the pumping load and/or depolarization sequence to different areas of the ventricle. A multi-electrode pacemaker has the capability of switching the output of pacing pulses between selected electrode combinations within a heart chamber during different cardiac cycles.</p>
<p id="p-0138" num="0137">Commonly owned U.S. Pat. No. 6,772,008, which is incorporated herein by reference, describes methods and systems that may be used in relation to detecting undesirable tissue stimulation. Muscle stimulation may be detected, for example, through the use of an accelerometer and/or other circuitry that senses accelerations indicating muscle movements (e.g., diaphragmatic) that coincide with the output of the stimulation pulse. Other methods of measuring tissue stimulation (e.g., phrenic nerve activation) may involve, for example, the use of an electromyogram sensor (EMG), microphone, and/or other sensors. For example, phrenic nerve activation may be automatically detected using a microphone to detect the patient's expiration response to undesirable diaphragmic activation due to electrical phrenic nerve activation.</p>
<p id="p-0139" num="0138">Undesirable nerve or muscle stimulation may be detected by sensing a parameter that is directly or indirectly responsive to the stimulation. Undesirable nerve stimulation, such as stimulation of the vagus or phrenic nerves, for example, may be directly sensed using electroneurogram (ENG) electrodes and circuitry to measure and/or record nerve spikes and/or action potentials in a nerve. An ENG sensor may comprise a neural cuff and/or other type or neural electrodes located on or near the nerve of interest. For example, systems and methods for direct measurement of nerve activation signals are discussed in U.S. Pat. Nos. 4,573,481 and 5,658,318 which are incorporated herein by reference in their respective entireties. The ENG may comprise a helical neural electrode that wraps around the nerve (e.g., phrenic nerve) and is electrically connected to circuitry configured to measure the nerve activity. The neural electrodes and circuitry operate to detect an electrical activation (action potential) of the nerve following application of the cardiac pacing pulse.</p>
<p id="p-0140" num="0139">Neural activation can be detected by sensing a surrogate parameter that is indirectly responsive to nerve stimulation. Lung pressure, pleural pressure, thoracic pressure, airway pressure, and thoracic impedance are examples of parameters that change responsive to stimulation of the phrenic nerve. In some embodiments, a patient's airway pressure may be measured during and/or closely following delivery of electrical stimulation. The detected change in pressure may be related to stimulation of the phrenic nerve.</p>
<p id="p-0141" num="0140">Undesirable stimulation threshold measuring may be performed by iteratively increasing, decreasing, or in some way changing a voltage, current, duration, energy level, and/or other therapy parameter between a series of test pulses. One or more sensors can monitor for undesirable activation immediately after each test pulse is delivered. Using these methods, the point at which a parameter change causes undesirable stimulation can be identified as a stimulation threshold.</p>
<p id="p-0142" num="0141">By way of example and not by way of limitation, the undesirable stimulation threshold for a particular electrode combination may be measured by delivering a first test pulse using the initial electrode combination. During and/or after each test pulse is delivered, sensors can monitor for undesirable stimulation. For example, an accelerometer may monitor for movement of the diaphragm indicating that the test pulse stimulated the phrenic nerve and/or diaphragm muscle. If no phrenic nerve and/or diaphragm muscle stimulation is detected after delivery of a test pulse, then the test pulse is increased a predetermined amount and another test pulse is delivered. This scanning process of delivering, monitoring, and incrementing is repeated until phrenic nerve and/or diaphragm muscle stimulation is detected. One or more of the test pulse parameters at which the first undesirable stimulation is detected can be considered to be the undesirable stimulation threshold.</p>
<p id="p-0143" num="0142">The various steps of <figref idref="DRAWINGS">FIGS. 1</figref>, <b>6</b>, and <b>7</b>, as well as the other steps and methods disclosed herein, can be performed automatically, such that no direct human assistance (e.g., physician and/or patient) is needed to initiate or perform the various discrete steps. Alternatively, the various steps of this disclosure can be performed semi-automatically requiring some amount of human interaction to initiate or conduct one or more steps.</p>
<p id="p-0144" num="0143">The various steps of <figref idref="DRAWINGS">FIGS. 1</figref>, <b>6</b>, and <b>7</b>, as well as other methods and steps discussed herein, can be initiated upon implant, by a physician, upon detection of a change in condition, and/or periodically. Condition changes that could initiate the processes include detection of phrenic nerve activation, loss of capture, change in posture, change in disease state, detection of non-therapeutic activation, and/or short or long term change in patient activity state, for example.</p>
<p id="p-0145" num="0144">Periodic and/or condition initiated testing to update capture threshold, phrenic nerve activation threshold, and device relationship information can be useful to monitor for certain conditions that might not otherwise be readily apparent but warrant attention and/or a therapy change. Device and/or physiologic changes may alter the effect of pacing pulses. For example, device component defects, lead migration, electrode encapsulation, and/or physiologic changes may increase the pacing pulse amplitude needed to reliably produce capture and/or decrease the pacing pulse amplitude needed to stimulate the phrenic nerve, leading to uncomfortable and ineffective pacing therapy. Updated capture threshold, phrenic nerve activation threshold, transition zones, and device relationship information can be used to automatically reprogram the therapy device and/or alert a physician to reconfigure the therapy device.</p>
<p id="p-0146" num="0145">The various processes illustrated and/or described herein (e.g., the processes of <figref idref="DRAWINGS">FIGS. 1</figref>, <b>6</b>, and <b>7</b>) can be performed using a single device embodiment configured to perform each of the processes (e.g., the circuitry of <figref idref="DRAWINGS">FIG. 9</figref> in the configuration of <figref idref="DRAWINGS">FIG. 10</figref>) that concern the concepts illustrated and discussed in connection with <figref idref="DRAWINGS">FIGS. 2-5</figref> and <b>8</b>.</p>
<p id="p-0147" num="0146">Sensors that can be used for detection of phrenic nerve activation are also used for rate-adaptive pacing. Rate-adaptive pacemakers are typically used to treat patients who are chronotropically incompetent. In these devices, patient activity and/or metabolic demand are determined and the patient activity/metabolic demand information can be used to control the pacing rate. A number of sensor types have been used for rate control. Motion sensors, such as accelerometers, piezoelectric sensors, and/or magnetic ball sensors, are widely used for detecting the vibration caused by patient activity. Accelerometers sense motion of the patient's body and are used in systems that have the capability to provide rapid rate responsiveness based on patent activity. However, accelerometer-based activity sensors can be fooled by motion that is not related to patient activity, such as riding in a car on a bumpy road, which may trigger inappropriate increases in pacing rate.</p>
<p id="p-0148" num="0147">Although sometimes more complex than accelerometer-based activity sensors, minute ventilation (MV) sensors are also frequently used to control pacing rate. MV sensors detect patient respiration and derive from the respiration signal the amount of air moved in one minute. MV sensors offer several advantages over accelerometers because MV sensors can appropriately increase pacing rate during periods that heart rate would naturally increase without a concurrent increase in patient activity, such as during periods that the patient experiences intense emotion. Other types of sensors have also been used or proposed for rate-adaptive pacing, e.g., sensors based on QT interval, peak endocardial acceleration, pre-ejection interval, etc. Pacing rate control using multiple sensors may also be used, such as by blending the sensor outputs.</p>
<p id="p-0149" num="0148">The output of a rate-adaptation sensor is used to generate a sensor indicated rate (SIR) which controls the pacing rate when the pacemaker is operating in a rate-responsive pacing mode. The output of the rate-adaptation sensor is processed with characteristics of the processing, e.g., sampling rate, gain, offset, and filtering characteristics, selected to enhance the detection of changes in activity and/or metabolic demand.</p>
<p id="p-0150" num="0149">Some types of sensors used to control rate-adaptive pacing, e.g., MV sensors and accelerometers, also respond to skeletal muscle contractions caused by phrenic nerve activation. Because sensors used to control rate-adaptive pacing are already well known and are readily available in a large number of cardiac devices, it is desirable to use the same sensor for both rate-adaptive pacing control and detection of phrenic nerve stimulation. However, the signal processing requirements for optimally sensing rate-adaptation parameters, such as activity or metabolic demand, are different from the signal processing requirements for optimally detecting phrenic nerve activation.</p>
<p id="p-0151" num="0150">Embodiments of the invention are directed to approaches employing a single sensor that is used both for sensing rate-adaptation parameters, such as patient activity or metabolic demand and for detecting phrenic nerve activation. The sensor signal is processed using first signal processing characteristics that are selected for optimal sensing of a rate-adaptation parameter, e.g., MV or activity. The sensor signal is processed using second signal processing characteristics that are selected for optimal phrenic nerve activation detection.</p>
<p id="p-0152" num="0151">In some implementations, the sensor signal <b>1107</b> is processed using two separate signal processing channels as illustrated in <figref idref="DRAWINGS">FIG. 11A</figref>. The output terminal <b>1106</b> of the sensor <b>1105</b> (e.g., MV sensor, activity sensor) used to control rate-adaptive pacing is coupled to a first signal processing channel <b>1110</b> and to a second signal processing channel <b>1120</b>. The first and second signal processing channels <b>1110</b>, <b>1120</b> include first and second signal processing circuitry <b>1111</b>, <b>1121</b>, respectively. The first signal processing circuitry <b>1111</b> has a first set of signal processing characteristics that are selected for determining patient activity or metabolic demand and which are used to process the sensor signal <b>1107</b>. The second signal processing circuitry <b>1121</b> has a second set of signal processing characteristics that are selected for detecting phrenic nerve activation and which are used to process the sensor signal <b>1107</b>. The signal processing channels <b>1110</b>, <b>1120</b> may include analog components, digital components or a mixture of analog and digital components.</p>
<p id="p-0153" num="0152">In one example, the first signal processing circuitry <b>1111</b> includes one or more filters configured to attenuate certain frequencies of the sensor signal. The second signal processing circuitry <b>1121</b> may also include one or more filters configured to attenuate frequencies of the sensor signal. The filter characteristics of the first filters are different from those of the second filters. In some implementations, the first signal processing circuitry <b>1111</b> includes amplifier circuitry that has different amplifier characteristics from the amplifier characteristics of the second signal processing circuitry <b>1121</b>. In some implementations, one or both of the first signal processing circuitry <b>1111</b> and the second signal processing circuitry may include an A/D converter for converting the analog sensor signal <b>1107</b> to a digital signal. The A/D conversion characteristics of the first signal processing circuitry (n-bit resolution, sampling rate, etc.) may be different from the A/D conversion characteristics of the second signal processing circuitry. In some implementations, only one of the signal processing channels <b>1110</b>, <b>1120</b> includes an A/D converter, so that the signal processing performed by one of the channels <b>1110</b>, <b>1120</b> is achieved predominantly by analog signal processing and the signal processing performed by the other of the channels <b>1120</b>, <b>1110</b> is achieved by digital signal processing.</p>
<p id="p-0154" num="0153">In some configurations, pre-processing circuitry <b>1109</b>, e.g., amplifiers, analog and/or digital filter components, and/or an A/D converter may be interposed in the signal path <b>1107</b> between the sensor output terminal <b>1106</b> and the signal processing channels <b>1110</b>, <b>1120</b>. The pre-processing circuitry may provide A/D conversion, pre-filtering or pre-amplification functions applied to the output of the sensor to produce the signal <b>1107</b>.</p>
<p id="p-0155" num="0154">Consider an implementation that uses an accelerometer (e.g., single axis or multi-axis accelerometer) to determine patient activity which in turn is used to develop a sensor indicated rate (SIR) for adapting the pacing rate. As the patient engages in activity, such as running or walking, the output of the accelerometer tracks the patient movement. The modulation in the accelerometer signal caused by patient movement includes relatively low frequency components, typically between about 1 and 10 Hz. Therefore, frequencies less than about 1 Hz and greater than about 10 Hz are noise with respect to patient activity and it is desirable to remove these signals from the activity signal, such as by using a band pass filter.</p>
<p id="p-0156" num="0155">On the other hand, activation of the phrenic nerve causes an abrupt contraction of the skeletal muscle of the diaphragm similar to a hiccup reflex. This abrupt contraction produces an accelerometer signal having frequency components which are greater than about 5 Hz, and are discernibly higher than the frequency components associated with patient activity signal. Thus, it is desirable to filter out lower frequencies predominantly associated with patient motion to enhance detection of the higher frequency components associated with phrenic nerve activation. If a signal processed for activity sensing is used for phrenic nerve activation, low frequency deflections in a signal filtered for activity sensing, e.g., signal spikes on the order of about 4-6 Hz, can cause erroneous phrenic nerve activation detection. Optimally processing the accelerometer signal for detection of phrenic nerve activation involves at least filtering to attenuate frequencies less than about 5 Hz.</p>
<p id="p-0157" num="0156">In some cases, additional filtering may further enhance the signal for phrenic nerve activation detection. For example, heart sounds can modulate the accelerometer signal and may interfere with phrenic nerve activation detection. In some embodiments, one or more notch filters may be used to attenuate noise frequencies in the sensor signal. For example, a notch filter which is adaptive based on cardiac rate may be used to attenuate the band of frequencies associated with heart sounds in the accelerometer signal.</p>
<p id="p-0158" num="0157"><figref idref="DRAWINGS">FIG. 12</figref> illustrates the output of an activity sensor (accelerometer) before and after processing by two different signal processing circuits. Graph <b>1210</b> shows the unfiltered accelerometer signal. Graph <b>1220</b> shows the accelerometer signal using filter characteristics suitable for activity sensing. Graph <b>1230</b> shows the accelerometer signal processed using filter characteristics selected for detection of phrenic nerve activation. At times t<sub>1 </sub>and t<sub>3</sub>, phrenic nerve activations <b>1201</b>, <b>1202</b> occur. Graphs <b>1210</b> and <b>1220</b> show deflections <b>1211</b>, <b>1221</b>, <b>1212</b>, <b>1222</b> that are marginally detectable over background noise. At time t<sub>2 </sub>the patient moves, causing a deflection <b>1215</b> in graph <b>1210</b> and a deflection <b>1225</b> in graph <b>1220</b> associated with the patient motion. The deflections <b>1215</b> and <b>1225</b> in graphs <b>1210</b>, <b>1220</b> caused by patient motion could result in an erroneous phrenic nerve activation detection if the signal <b>1220</b> filtered for activity sensing was used.</p>
<p id="p-0159" num="0158">Graph <b>1230</b> illustrates the accelerometer signal processed using filter characteristics selected for optimal detection of phrenic nerve activation. As can be seen in <figref idref="DRAWINGS">FIG. 12</figref>, the phrenic nerve activations <b>1201</b>, <b>1202</b> that occur at times t<sub>1 </sub>and t<sub>3 </sub>cause deflections <b>1231</b> and <b>1232</b> which have a much higher signal to noise ratio than deflections <b>1211</b>, <b>1212</b> in the unfiltered activity signal <b>1210</b> or deflections <b>1221</b>, <b>1222</b> in the activity signal. Additionally, the patient movement at time t<sub>2 </sub>is attenuated and does not cause a deflection in graph <b>1230</b>, thus avoiding the potential for an erroneous detection of phrenic nerve activation.</p>
<p id="p-0160" num="0159">Consider an implementation that uses an MV sensor to determine the patient's metabolic demand for adapting the pacing rate. An MV sensor can be implemented by measuring thoracic impedance which is modulated by respiration. Thoracic impedance measurement circuitry includes drive circuitry and impedance measuring circuitry. The drive circuitry supplies a current signal of a specified amplitude, such as one or more constant current pulses, to drive electrodes that are disposed in the patient's thorax. Voltage sense electrodes are disposed at locations within the thorax so that the difference in potential between the voltage sense electrodes during the current pulses is representative of the thoracic impedance between the voltage sense electrodes. Cardiac electrodes, including intracardiac electrodes and/or the conductive housing or can of an implantable pacemaker or defibrillator, can be used as drive electrodes and/or voltage sense electrodes. The impedance measuring circuitry processes the voltage sense signal from the voltage sense electrodes to derive the impedance signal. The impedance signal is modulated by respiration and thus provides the respiration signal as illustrated in <figref idref="DRAWINGS">FIG. 2</figref>. Minute ventilation (MV) is derived from the respiration signal as the amount of air inhaled or exhaled in one minute.</p>
<p id="p-0161" num="0160">As the patient engages in physical activity, or otherwise experiences an increase in metabolic demand, the depth and/or rate of respiration increases which causes an increase in the measured MV. The value of the MV is used in rate-adaptive pacing to calculate the sensor indicated rate (SIR). The respiration signal from which MV and the SIR are calculated, includes relatively low frequency components. For example, normal breathing at about 12 breaths/minute causes oscillations in the thoracic impedance signal at about 0.2 Hz. In contrast, phrenic nerve activation produces a reflex having frequency components similar to a hiccup reflex, with modulation of the thoracic impedance signal at frequencies that are substantially higher than normal breathing. For example, the inspiratory duration of the phrenic nerve activation may be less than about 150 ms, whereas the inspiratory duration of normal breathing is closer to about 1 to 2 sec.</p>
<p id="p-0162" num="0161"><figref idref="DRAWINGS">FIG. 13</figref> depicts three graphs <b>1310</b>, <b>1320</b>, <b>1330</b> representing the thoracic impedance signal that is produced using different three sets of signal processing characteristics. The first graph <b>1310</b> illustrates a respiration signal processed by circuitry that is selected to detect respiration cycles and determine MV. For example, to obtain signal <b>1310</b>, the output of the thoracic impedance sensor may be digitized using a sampling rate of about 20 Hz and filtered to remove noise including the cardiac component of the signal. In <figref idref="DRAWINGS">FIG. 1310</figref>, the thoracic impedance sensor is filtered using a bandpass filter. The low frequency cut off may be about 0.1 Hz. The high pass cut off frequency of the bandpass filter may be adaptable to substantially attenuate the cardiac component and/or other noise from the sensor signal. The high frequency cut off may be adaptable in a range, e.g., from about 0.5 Hz to up to about 4 Hz. For example, an upper frequency cutoff of about 1.5 Hz may be used to substantially attenuate the cardiac component for heart rates up to about 90 bpm. An upper frequency cutoff of about 4 Hz may be used to substantially attenuate the cardiac component for heart rates up to about 220 bpm. Other high frequency cut offs may be used for other cardiac rates. Processing the thoracic impedance signal using signal processing characteristics suitable for respiration sensing produces a signal that is under-sampled and over-filtered for detecting the altered respiratory state during phrenic nerve activation.</p>
<p id="p-0163" num="0162">Graph <b>1320</b> represents a thoracic impedance signal processed to obtain the higher frequency deflections <b>1301</b>, <b>1302</b>, <b>1303</b>, <b>1304</b> in the impedance signal caused by phrenic nerve activations. The signal illustrated in graph <b>1320</b> is digitized by sampling at a higher rate than that used for graph <b>1310</b>, e.g., about 100 Hz, to allow reconstruction of the higher frequencies. The high frequency cutoff of the filtering used to acquire graph <b>1320</b> is extended beyond that used to obtain graph <b>1310</b>, so that the higher frequency phrenic nerve activation components are not substantially attenuated. Additionally, one or more notch filters may be used to attenuate the cardiac component and/or other noise frequencies from the sensor signal. The notch filter may be adaptable based on cardiac rate. In various implementations, the notch filter may attenuate frequencies in the range of about 0.5 to about 4 Hz. For example, notch filtering in the range of about 0.5 Hz to about 1.5 Hz may be used to attenuate the cardiac component for a cardiac rate of about 90 bpm. An upper notch frequency of about 4 Hz may be used to attenuate the cardiac component for a cardiac rate of about 220 bpm.</p>
<p id="p-0164" num="0163">The signal represented by graph <b>1320</b> could be used for both respiration sensing and phrenic nerve activation sensing. However, it can be appreciated that the deflections <b>1301</b>, <b>1302</b>, <b>1303</b>, <b>1304</b> caused by phrenic nerve activation superimposed on the respiration signal may be difficult to discern and that additional filtering could enhance the signal for phrenic nerve activation detection.</p>
<p id="p-0165" num="0164">Using a high pass filter, the respiration and cardiac components of the MV signal can be substantially removed, as illustrated in graph <b>1330</b>. In one example, filtering for phrenic nerve activation sensing may involve the use of a filter having a low frequency cut off of about 5 Hz and a high frequency cut off of about 20 Hz. This filtering implementation substantially attenuates low frequency noise, the respiration component, and the cardiac component from the thoracic impedance signal, while retaining frequencies indicative of the phrenic nerve activations <b>1301</b>, <b>1302</b>, <b>1303</b>, <b>1304</b>.</p>
<p id="p-0166" num="0165">Returning now to <figref idref="DRAWINGS">FIG. 11A</figref>, the output <b>1112</b> of the first signal processing circuitry <b>1111</b> may comprise an activity or metabolic demand signal which is optimally filtered for that purpose and is used by rate adaptive pacing control circuitry <b>1115</b> to determine a sensor indicated rate (SIR) <b>1117</b>. The output <b>1112</b> of the first signal processing circuitry <b>1111</b>, e.g., respiration signal or patient activity signal, etc., may also be used to track the parameters sensed directly using the sensor or derived from the sensor signal for diagnostic or other purposes.</p>
<p id="p-0167" num="0166">The output <b>1122</b> from the second signal processing circuitry <b>1121</b> is optimally filtered for detection of phrenic nerve activation as described, for example, in connection with <figref idref="DRAWINGS">FIGS. 12 and 13</figref>. The output <b>1122</b> is coupled to phrenic nerve activation detection circuitry <b>1125</b>. The phrenic nerve activation detection circuitry <b>1125</b> analyzes the signal <b>1122</b> and provides an output <b>1127</b> indicating the presence or absence of phrenic nerve activation. The output <b>1127</b> from the phrenic nerve activation detection circuitry can be used in conjunction with a cardiac capture threshold test to determine a cardiac pacing threshold or pacing output configuration that avoids phrenic nerve activation.</p>
<p id="p-0168" num="0167">The filters used in the first signal processing circuitry <b>1111</b> and the filters used in the second signal processing circuitry <b>1121</b> may be of any suitable type, including any combination of high pass, low pass, band pass, and/or notch filters. In some implementations, for example, a number of filters may be arranged in series. The filters may use various technology implementations including any combination of analog and/or, digital filters, e.g., 1<sup>st</sup>, 2<sup>nd</sup>, or Nth-order filters, non-recursive (finite impulse response (FIR)), recursive (infinite input response (IIR)), Chebyshev, Bessel, Butterworth, etc.</p>
<p id="p-0169" num="0168">Some embodiments use filter circuitry in the second signal processing circuitry <b>1121</b> that is matched to the analog front-end filter circuitry, which may be implemented in the pre-processing circuitry <b>1109</b>. Since the diaphragmatic &#x201c;hiccup&#x201d; caused by phrenic nerve activation resembles an impulse function, the resultant sensor signal <b>1107</b> after the analog filtering is applied in the pre-processing circuitry will be close to the impulse response of the pre-processing analog filtering. The filter circuitry in the second signal processing circuitry <b>1121</b> may include a filter with characteristics matched to the impulse response of the analog filtering of the pre-processing circuitry <b>1109</b>. The matched filter would pass phrenic nerve activation signals and substantially reject non-phrenic nerve activation signals, including non-impulse responses along with low frequency noise. In some implementations, the characteristics of the matched filter would be predesignated based on the design of the system. In some implementations, the characteristics of the matched filter could be individually mapped based on an example impulse response during device testing.</p>
<p id="p-0170" num="0169">In some embodiments, the medical device does not have physically separate channels for processing the sensor signal for detecting the rate adaptation parameter and processing the sensor signal for phrenic nerve activation detection. In these embodiments, as illustrated by <figref idref="DRAWINGS">FIG. 11B</figref>, a single signal processing channel <b>1130</b>, including signal processing circuitry <b>1131</b> is used to implement time-multiplexed signal processing functions. The signal processing circuitry <b>1131</b> may include an A/D converter, filters, amplifiers, etc. The single channel <b>1130</b> is programmable to apply different signal processing characteristics to the sensor signal <b>1107</b> during different time periods. The output <b>1139</b> of the signal processing circuitry <b>1131</b> is a data stream that includes a first portion of the signal <b>1132</b> that is optimal for phrenic nerve activation detection during time interval, T<sub>1</sub>, and includes a second portion of the signal <b>1133</b> that is optimal for activity/metabolic demand sensing for rate-adaptive pacing during a second time period, T<sub>2</sub>. A first set of signal processing characteristics (A/D conversion characteristics, amplifier characteristics, filter characteristics, etc.) is applied by the signal processing circuitry <b>1131</b> to the sensor signal <b>1107</b> to produce the portion of the signal <b>1132</b> tailored for phrenic nerve activation detection which is output during T<sub>1</sub>. A second set of signal processing characteristics is applied by the signal processing circuitry <b>1131</b> to the sensor signal <b>1107</b> to produce the portion of the signal <b>1133</b> tailored for activity/metabolic demand sensing for rate-adaptive pacing and/or other functions during T<b>2</b>.</p>
<p id="p-0171" num="0170">The embodiment of <b>11</b>B reduces the circuitry required to apply different signal processing characteristics for activity/metabolic demand determination and phrenic nerve activation detection. The phrenic nerve activation detection functionality may be unused other than during a cardiac capture threshold test and/or during periods wherein sensing for phrenic nerve activation is desirable.</p>
<p id="p-0172" num="0171">The use of both an activity sensor (e.g., accelerometer) and a metabolic demand sensor (e.g., MV sensor) for rate-adaptive pacing has been used to exploit the strengths of both sensor types and achieve a more physiologic adaptation of pacing rate. In some configurations, the outputs of an accelerometer and an MV sensor are blended such that the accelerometer is used during an initial phase of rate adaptation and the MV sensor is used during a second phase of rate adaptation. For example, the accelerometer output alone may be initially used to adapt the pacing rate, with the influence of the accelerometer output decreasing with time as the output of the MV sensor becomes more predominantly used for rate adaptation.</p>
<p id="p-0173" num="0172">Medical devices that use blended sensor outputs for rate adaptation are illustrated in <figref idref="DRAWINGS">FIGS. 14A-C</figref>. The illustrated devices include an accelerometer <b>1401</b> and an MV sensor <b>1402</b>. The outputs from the accelerometer <b>1401</b> and the MV sensor <b>1402</b> are processed by first signal conditioning channels <b>1410</b>, <b>1440</b> having circuitry <b>1411</b>, <b>1441</b> designed for activity sensing and respiration sensing, respectively. The output of the first accelerometer signal processing circuitry <b>1412</b> and the output of the first impedance signal processing circuitry <b>1442</b> are used by rate-adaptive pacing control circuitry <b>1450</b> to develop a sensor indicated rate signal <b>1451</b>.</p>
<p id="p-0174" num="0173">One or both of the accelerometer signal <b>1403</b> and the impedance sensor signal <b>1404</b> may additionally be processed using a separate channel <b>1430</b>, <b>1420</b> having circuitry <b>1431</b>, <b>1421</b> designed for enhanced detection of phrenic nerve activation. The signal output(s) <b>1432</b>, <b>1422</b> of the second signal processing circuitry <b>1431</b>, <b>1421</b>, are used by the phrenic nerve activation detection circuitry <b>1460</b> to detect phrenic nerve activation. Based on one or both signals <b>1432</b>, <b>1422</b>, the phrenic nerve activation circuitry <b>1460</b> outputs a signal <b>1461</b> indicative of phrenic nerve activation (PNA).</p>
<p id="p-0175" num="0174"><figref idref="DRAWINGS">FIG. 14C</figref> illustrates a medical device that detects phrenic nerve activation based on signal deflections caused by phrenic nerve activation in the signal output <b>1432</b> from the second accelerometer signal processing circuitry <b>1431</b>. <figref idref="DRAWINGS">FIG. 14B</figref> illustrates a medical device that detects phrenic nerve activation based on signal deflections caused by phrenic nerve activation in the signal output <b>1422</b> from the second impedance signal processing circuitry <b>1421</b>.</p>
<p id="p-0176" num="0175"><figref idref="DRAWINGS">FIG. 14A</figref> illustrates a medical device that detects phrenic nerve activation based on both the output <b>1432</b> of the second accelerometer signal processing circuitry <b>1431</b> and the output <b>1422</b> of the second impedance signal processing circuitry <b>1421</b>. Using both outputs <b>1432</b>, <b>1422</b> to detect phrenic nerve activation may involve, for example, comparing each output <b>1432</b>, <b>1422</b>, respectively, to a threshold and detecting phrenic nerve activation based on the comparison of both signals <b>1432</b>, <b>1422</b> to their respective thresholds. In some implementations, the signal <b>1432</b>, <b>1422</b> derived from one sensor, e.g., accelerometer <b>1401</b>, thoracic impedance <b>1402</b>, may be used to initially detect phrenic nerve activation, and the signal <b>1422</b>, <b>1432</b> derived from the other sensor, e.g., thoracic impedance <b>1402</b>, <b>1401</b>, accelerometer, may be used to confirm the initial detection of phrenic nerve activation.</p>
<p id="p-0177" num="0176">As previously discussed above, the threshold for phrenic nerve activation may be lower during certain phases of the respiration cycle making phrenic nerve activation more prevalent during these respiration cycle phases. In these situations, phrenic nerve activation detection may be enhanced by taking into account the phase of the respiration cycle. As indicated in <figref idref="DRAWINGS">FIGS. 14A-C</figref>, the signal output <b>1442</b> from the first impedance signal processing circuitry, which is designed for sensing respiration cycles, may be used by the phrenic nerve activation detection circuitry <b>1460</b> to detect phrenic nerve activation based on respiration cycle phase.</p>
<p id="p-0178" num="0177">The flow diagram of <figref idref="DRAWINGS">FIG. 15</figref> illustrates processes implementable in a CRM device for detecting phrenic nerve activation. <figref idref="DRAWINGS">FIG. 15</figref> illustrates an implementation for PNA detection based on acquiring <b>1510</b> a sensor signal which is modulated by a physiological parameter modulated by hemodynamic requirements of the patient, e.g., activity or MV. The sensor signal is processed <b>1515</b> using a first channel having a first set of signal processing characteristics to develop a rate-adaptation signal. The sensor signal is processed <b>1520</b> using a second channel having a second set of signal processing characteristics to develop a phrenic nerve activation signal. After delivery <b>1525</b> of a pacing pulse to a cardiac chamber, a PNA detection interval is initiated <b>1530</b>. The PNA detection interval may extend for 500 ms, ending before the next pacing pulse to the cardiac chamber is delivered. The device senses <b>1535</b> for an indication of PNA in the PNA signal during the PNA detection interval. If PNA is not detected <b>1540</b>, pacing continues. However, if PNA is detected <b>1540</b>, the pacing output configuration may be altered <b>1545</b> to reduce PNA, or other action may be taken.</p>
<p id="p-0179" num="0178">The medical devices and processes illustrated in any of <figref idref="DRAWINGS">FIGS. 11 and 15</figref> can be implemented in the CRM device of <figref idref="DRAWINGS">FIG. 10</figref> and can be used in conjunction with determination of phrenic nerve activation based on respiration phase, as illustrated, for example, in <figref idref="DRAWINGS">FIGS. 1-9</figref>. The approaches outlined by the flow diagrams of <figref idref="DRAWINGS">FIGS. 1 and 6</figref> may use the enhanced signal processing for the phrenic nerve activation signal as described herein. These techniques are particularly useful for left ventricular (LV) capture threshold determination since the position of the LV electrodes is more likely to cause phrenic nerve activation.</p>
<p id="p-0180" num="0179">Although some implementations previously described use an accelerometer signal for phrenic nerve activation detection based on respiration phase, it will be appreciated after reading this disclosure that similar techniques may also be implemented using a phrenic nerve activation signal derived from the thoracic impedance signal. The use of a thoracic impedance sensor for PNA detection may be advantageous in some situations because only one sensor is required to develop the respiration signal, determine a SIR for rate adaptive pacing, and detect phrenic nerve activation based on respiration phase.</p>
<p id="p-0181" num="0180">The flow diagram of <figref idref="DRAWINGS">FIG. 16</figref> illustrates various optional processes <b>1610</b> that may be used in connection with detection of phrenic nerve activation. In this example, a thoracic impedance signal and/or an accelerometer signal are acquired <b>1620</b>. The thoracic impedance signal is processed <b>1630</b> using first signal processing characteristics to develop a respiration signal. Optionally, the thoracic impedance signal may be processed using second signal processing characteristics to develop a phrenic nerve activation signal. If an accelerometer signal is used, the accelerometer signal may be processed <b>1640</b> using first signal processing characteristics to develop a patent activity signal, for example. The accelerometer signal may alternatively or additionally be processed using second signal processing characteristics to develop a phrenic nerve activation signal.</p>
<p id="p-0182" num="0181">The respiration phase is determined <b>1650</b> using the respiration signal, which in this example is developed from the thoracic impedance signal, but in other implementations may be developed using sensors other than a thoracic impedance sensor. A cardiac pacing pulse is delivered <b>1660</b> during the respiration phase. The algorithm determines <b>1670</b> whether the phrenic nerve was stimulated by the pacing pulse during the respiration phase using one or both of the phrenic nerve activation signal developed from the thoracic impedance signal and the phrenic nerve activation signal developed from the accelerometer.</p>
<p id="p-0183" num="0182"><figref idref="DRAWINGS">FIGS. 17A-B</figref> depict a flow diagram illustrating an algorithm for capture threshold testing that also includes a process for ensuring that the pacing voltage does not produce phrenic nerve activation. The patient's thoracic impedance signal is acquired <b>1702</b> by a CRM device. The thoracic impedance signal may be processed using <b>1703</b> first thoracic impedance signal processing characteristics to develop the respiration signal. Optionally, the thoracic impedance signal may also be processed using <b>1704</b> second thoracic impedance signal processing characteristics to develop a phrenic nerve activation signal.</p>
<p id="p-0184" num="0183">A signal is acquired <b>1706</b> from an accelerometer. The accelerometer signal may be processed using <b>1707</b> first accelerometer signal processing characteristics to produce a respiration signal. Alternately or additionally, the accelerometer signal may be processed using <b>1708</b> second accelerometer signal processing characteristics to produce a phrenic activation signal.</p>
<p id="p-0185" num="0184">Normal pacing may involve rate adaptation based on patient activity and/or metabolic need. A sensor indicated rate (SIR) is determined <b>1710</b> based on one or both of the respiration signal and the patent activity signal. The SIR is used to adjust <b>1712</b> pacing rate based on patient activity and/or metabolic need.</p>
<p id="p-0186" num="0185">At periodic intervals, on command, or triggered by sensed events, cardiac capture threshold testing is initiated <b>1714</b>. A cardiac capture threshold test may implement a step-down threshold search, a step-up threshold search, or may use binomial or other search patterns. In the example of <figref idref="DRAWINGS">FIG. 17A</figref>, a step-down search is illustrated. The test pacing voltage is decremented <b>1718</b> until loss of capture (LOC) is detected <b>1720</b>. The pacing voltage just above the test voltage at which LOC is detected is identified <b>1722</b> as the cardiac capture threshold for the particular pacing electrode combination under test.</p>
<p id="p-0187" num="0186">In a process such as the one illustrated in <figref idref="DRAWINGS">FIG. 7</figref>, the transition zone for the electrode configuration is determined <b>1724</b>. The phrenic nerve activation signal(s) used in determining the transition zone may be one or both of the PNA signal developed using the accelerometer as in block <b>1708</b> and the PNA signal developed using the thoracic impedance signal as in block <b>1704</b>. After the cardiac capture threshold is identified, the algorithm checks <b>1726</b> to determine the relationship of the pacing voltage (the cardiac capture threshold plus a safety margin) to the transition zone. In one implementation, if pacing voltage is below the lower boundary of the transition zone, then the pacing voltage is used for pacing. If the pacing voltage is above the lower boundary of the transition zone, then the algorithm may continue searching for an acceptable pacing output configuration by changing a pacing output configuration parameter such as the pulse width or electrode combination, for example. Some implementations may not require that the pacing voltage be below the transition zone boundary and may use the pacing voltage if the pacing voltage falls within a lower portion the transition zone.</p>
<p id="p-0188" num="0187">The components, functionality, and structural configurations depicted herein are intended to provide an understanding of various features and combination of features that may be incorporated in an implantable pacemaker/defibrillator. It is understood that a wide variety of cardiac monitoring and/or stimulation device configurations are contemplated, ranging from relatively sophisticated to relatively simple designs. As such, particular cardiac device configurations may include particular features as described herein, while other such device configurations may exclude particular features described herein.</p>
<p id="p-0189" num="0188">Various modifications and additions can be made to the preferred embodiments discussed hereinabove without departing from the scope of the present invention. Accordingly, the scope of the present invention should not be limited by the particular embodiments described above, but should be defined only by the claims set forth below and equivalents thereof.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>We claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An implantable medical device, comprising:
<claim-text>a pulse generator configured to deliver cardiac pacing to a heart;</claim-text>
<claim-text>a single impedance sensor configured to generate a signal modulated by patient respiration, the sensor signal available at a sensor output terminal;</claim-text>
<claim-text>a first filter channel coupled to the sensor output terminal, the first filter channel configured to attenuate first frequencies of the sensor signal to produce a first filtered output;</claim-text>
<claim-text>a second filter channel, separate from the first filter channel, coupled to the same sensor output terminal, the second filter channel configured to attenuate second frequencies of the sensor signal to produce a second filtered output; and</claim-text>
<claim-text>circuitry configured to evaluate patient respiration using the first filtered output and to detect phrenic nerve activation caused by cardiac pacing using the second filtered output.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the second filtered output substantially comprises phrenic activation signal components and does not substantially include respiration signal components.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein second filter channel comprises a filter having one or more cut off frequencies that are dynamically alterable.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein second filter channel comprises a high pass filter having a low frequency cut off of about 5 Hz.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising analog circuitry coupled between the sensor output and the first and second filter channels, wherein the second filter channel includes a filter circuit that is substantially matched to an impulse response of the analog circuitry.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The device of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the filter circuit substantially attenuates frequencies other than the impulse response frequencies of the analog circuitry.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The device of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the filter circuitry is individually mapped to the impulse response during device testing.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the circuitry includes a timer configured to time a phrenic nerve activation detection interval which is started following delivery of a pacing pulse to a cardiac chamber and is stopped before delivery of a subsequent pacing pulse to the cardiac chamber and the circuitry is configured to sense for phrenic nerve activation during the phrenic nerve detection interval.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising pacing control circuitry configured to adapt a cardiac pacing rate based on evaluation of the patient respiration.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising a second sensor configured to produce a sensor signal, wherein the circuitry is configured to use both the sensor signal and the second filtered output to detect the phrenic nerve activation.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>an accelerometer configured to generate a signal modulated by acceleration that is available at an accelerometer output terminal;</claim-text>
<claim-text>a third filter channel coupled to the accelerometer output terminal, the third filter channel configured to attenuate third frequencies of the accelerometer signal to produce a third filtered output; and</claim-text>
<claim-text>a fourth filter channel coupled to the accelerometer output, separate from the third filter channel, the fourth filter channel configured to attenuate fourth frequencies of the accelerometer signal to produce a fourth filtered output, wherein the circuitry is configured to detect the phrenic nerve activation using the second filtered output and the fourth filtered output.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The device if <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the circuitry is configured to develop a sensor indicated pacing rate based on one or both of the first filtered output and the third filtered output.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the circuitry is configured to use the first filtered output to determine respiration phase and is configured to use the second filtered output to detect the phrenic nerve activation in conjunction with the respiration phase.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A method of operating an implantable medical device, comprising:
<claim-text>sensing patient respiration and generating a single sensor signal modulated by patient respiration at a sensor output terminal;</claim-text>
<claim-text>processing the single sensor signal through separate signal processing channels, the separate signal processing channels comprising a first signal processing channel having first signal processing characteristics and a second signal processing channel having second signal processing characteristics;</claim-text>
<claim-text>evaluating patient respiration using an output of the first signal processing channel; and</claim-text>
<claim-text>detecting phrenic nerve activation caused by cardiac pacing using an output of the second signal processing channel.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein:
<claim-text>the first signal processing channel comprises first filter circuitry and the first signal processing characteristics are configured to attenuate a first set of frequencies from the sensor signal; and</claim-text>
<claim-text>the second signal processing channel comprises a second filter circuitry and the second signal processing characteristics are configured to attenuate a second set of frequencies from the sensor signal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the second signal processing channel comprises a notch filter having characteristics that are adaptable based on cardiac rate.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the second signal processing characteristics comprise a low frequency cut off that substantially attenuates respiration components and cardiac components from the output of the second signal processing channel.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein detecting the phrenic nerve activation comprises:
<claim-text>starting a phrenic nerve activation detection interval upon or after delivery of a cardiac pace during a cardiac cycle;</claim-text>
<claim-text>ending the phrenic nerve activation detection interval during the cardiac cycle; and</claim-text>
<claim-text>sensing for the phrenic nerve activation during the phrenic nerve detection interval.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, further comprising:
<claim-text>determining a transition zone for phrenic nerve activation;</claim-text>
<claim-text>determining a cardiac capture threshold; and</claim-text>
<claim-text>setting a cardiac pacing energy above the cardiac capture threshold and below a transition zone threshold for phrenic nerve activation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, further comprising switching from one cardiac pacing electrode configuration to another cardiac pacing electrode configuration based on detection of the phrenic nerve stimulation. </claim-text>
</claim>
</claims>
</us-patent-grant>
