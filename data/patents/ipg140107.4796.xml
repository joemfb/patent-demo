<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625889-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625889</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12981634</doc-number>
<date>20101230</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>118</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>9</main-group>
<subgroup>34</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>382165</main-classification>
<further-classification>382164</further-classification>
</classification-national>
<invention-title id="d2e53">System for food recognition method using portable devices having digital cameras</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6215893</doc-number>
<kind>B1</kind>
<name>Leshem et al.</name>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382128</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>8363913</doc-number>
<kind>B2</kind>
<name>Boushey et al.</name>
<date>20130100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382128</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2003/0076983</doc-number>
<kind>A1</kind>
<name>Cox</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2006/0008140</doc-number>
<kind>A1</kind>
<name>Imamura et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382164</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2007/0116338</doc-number>
<kind>A1</kind>
<name>Fidrich et al.</name>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382128</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2008/0240558</doc-number>
<kind>A1</kind>
<name>Li et al.</name>
<date>20081000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382167</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2008/0260226</doc-number>
<kind>A1</kind>
<name>Moriya</name>
<date>20081000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382128</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2008/0292169</doc-number>
<kind>A1</kind>
<name>Wang et al.</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382131</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2009/0033622</doc-number>
<kind>A1</kind>
<name>Kalpaxis</name>
<date>20090200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345158</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2009/0147992</doc-number>
<kind>A1</kind>
<name>Tong et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382103</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2010/0098331</doc-number>
<kind>A1</kind>
<name>Meng et al.</name>
<date>20100400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382164</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2010/0104261</doc-number>
<kind>A1</kind>
<name>Liu et al.</name>
<date>20100400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>386 95</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2010/0111383</doc-number>
<kind>A1</kind>
<name>Boushey</name>
<date>20100500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2010/0173269</doc-number>
<kind>A1</kind>
<name>Puri</name>
<date>20100700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2010/0202684</doc-number>
<kind>A1</kind>
<name>Mattausch et al.</name>
<date>20100800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382164</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2012/0224755</doc-number>
<kind>A1</kind>
<name>Wu</name>
<date>20120900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382131</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2012/0250984</doc-number>
<kind>A1</kind>
<name>Taylor</name>
<date>20121000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382162</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2012/0321159</doc-number>
<kind>A1</kind>
<name>Keller et al.</name>
<date>20121200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382131</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2013/0129177</doc-number>
<kind>A1</kind>
<name>Meinel</name>
<date>20130500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382131</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2013/0182922</doc-number>
<kind>A1</kind>
<name>Kil, David H.</name>
<date>20130700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382128</main-classification></classification-national>
</us-citation>
<us-citation>
<nplcit num="00021">
<othercit>Pass, G., &#x201c;Comparing Images Using Color Coherence Vectors,&#x201d; Proc. the 4th ACM Int. Conf. on Multimedia, pp. 65-73 (1997).</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00022">
<othercit>F. Zhu, M. Bosch, I. Woo, S. Kim, C. Boushey, D. Ebert, and E. Delp, &#x201c;The use of mobile devices in aiding dietary assessment and evaluation,&#x201d; IEEE Journal of Selected Topics in Signal Processing, vol. 4, No. 4, pp. 756-766, Aug. 2010.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00023">
<othercit>D. Comaniciu and P. Meer. Robust Analysis of Feature Spaces: Color Image Segmentation. In Proceedings of IEEE Conference on Computer Vision and Pattern.pp. 750-755 1997.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00024">
<othercit>8 pages&#x2014;entitled &#x201c;Food Recognition Using Statistics of Pairwise Local Features,&#x201d; by Yang et al, published in IEEE Intl. Conference on Computer Vision and Pattern Recognition, published on Jun. 13, 2010.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00025">
<othercit>4 pages&#x2014;entitled &#x201c;PFID: Pittsburgh Fast-Food Image data sets,&#x201d; Intl. Conference on Image Processing, published on Nov. 10, 2009, by Chen et al to assess the quality of their food recognition system.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>4</number-of-drawing-sheets>
<number-of-figures>4</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120170801</doc-number>
<kind>A1</kind>
<date>20120705</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>De Oliveira</last-name>
<first-name>Luciano Reboucas</first-name>
<address>
<city>Salvador/BA</city>
<country>BR</country>
</address>
</addressbook>
<residence>
<country>BR</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>De Freitas Jorge</last-name>
<first-name>Eduardo Manuel</first-name>
<address>
<city>Salvador/BA</city>
<country>BR</country>
</address>
</addressbook>
<residence>
<country>BR</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>De Azevedo Filho</last-name>
<first-name>Alberto Almeida</first-name>
<address>
<city>Lauro de Freitas-Bahia</city>
<country>BR</country>
</address>
</addressbook>
<residence>
<country>BR</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Franco Costa</last-name>
<first-name>Victor</first-name>
<address>
<city>Salvador/BA</city>
<country>BR</country>
</address>
</addressbook>
<residence>
<country>BR</country>
</residence>
</us-applicant>
<us-applicant sequence="005" app-type="applicant" designation="us-only">
<addressbook>
<last-name>De Almeida Neves</last-name>
<first-name>Gustavo</first-name>
<address>
<city>Salvador-Bahia</city>
<country>BR</country>
</address>
</addressbook>
<residence>
<country>BR</country>
</residence>
</us-applicant>
<us-applicant sequence="006" app-type="applicant" designation="us-only">
<addressbook>
<last-name>De Oliveira</last-name>
<first-name>Talmai Brand&#xe4;o</first-name>
<address>
<city>Cincinnati</city>
<state>OH</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="007" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Anunciac&#xe4;o</last-name>
<first-name>Geovane Dos Santos</first-name>
<address>
<city>Salvador/BA</city>
<country>BR</country>
</address>
</addressbook>
<residence>
<country>BR</country>
</residence>
</us-applicant>
<us-applicant sequence="008" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Fonseca Santos</last-name>
<first-name>Eduardo Telmo</first-name>
<address>
<city>Salvador/Bahia</city>
<country>BR</country>
</address>
</addressbook>
<residence>
<country>BR</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>De Oliveira</last-name>
<first-name>Luciano Reboucas</first-name>
<address>
<city>Salvador/BA</city>
<country>BR</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>De Freitas Jorge</last-name>
<first-name>Eduardo Manuel</first-name>
<address>
<city>Salvador/BA</city>
<country>BR</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>De Azevedo Filho</last-name>
<first-name>Alberto Almeida</first-name>
<address>
<city>Lauro de Freitas-Bahia</city>
<country>BR</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Franco Costa</last-name>
<first-name>Victor</first-name>
<address>
<city>Salvador/BA</city>
<country>BR</country>
</address>
</addressbook>
</inventor>
<inventor sequence="005" designation="us-only">
<addressbook>
<last-name>De Almeida Neves</last-name>
<first-name>Gustavo</first-name>
<address>
<city>Salvador-Bahia</city>
<country>BR</country>
</address>
</addressbook>
</inventor>
<inventor sequence="006" designation="us-only">
<addressbook>
<last-name>De Oliveira</last-name>
<first-name>Talmai Brand&#xe4;o</first-name>
<address>
<city>Cincinnati</city>
<state>OH</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="007" designation="us-only">
<addressbook>
<last-name>Anunciac&#xe4;o</last-name>
<first-name>Geovane Dos Santos</first-name>
<address>
<city>Salvador/BA</city>
<country>BR</country>
</address>
</addressbook>
</inventor>
<inventor sequence="008" designation="us-only">
<addressbook>
<last-name>Fonseca Santos</last-name>
<first-name>Eduardo Telmo</first-name>
<address>
<city>Salvador/Bahia</city>
<country>BR</country>
</address>
</addressbook>
</inventor>
</inventors>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Samsung Electronics Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Suwon-Si</city>
<country>KR</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Drennan</last-name>
<first-name>Barry</first-name>
<department>2665</department>
</primary-examiner>
<assistant-examiner>
<last-name>Niu</last-name>
<first-name>Feng</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method for automatic food recognition by using portable devices equipped with digital cameras. With this system, it is possible to identify a previously established food menu. To this purpose, a semi-automated method of segmentation is applied to delineate the regions in which each type of food in an image of a plate of food, captured by a user. Pattern recognition techniques are used in images, integrated into a system whose goal is to label each type of food contained in the photo of a plate of food. No type of preprocessing is performed to correct deficiencies in capturing the image, just using the auto-focus component present in the portable device to capture a clear image.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="212.77mm" wi="139.36mm" file="US08625889-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="155.79mm" wi="164.59mm" file="US08625889-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="213.28mm" wi="140.38mm" file="US08625889-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="129.20mm" wi="169.50mm" file="US08625889-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="108.54mm" wi="107.53mm" file="US08625889-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present invention relates to a method for automatic food recognition by means of portable devices equipped with digital cameras.</p>
<p id="p-0003" num="0002">With this system, it is possible to identify a previously established food menu. To this end, a semi-automated method of segmentation is applied to delineate the regions of each type of food in an image of a plate of food, captured by a user.</p>
<p id="p-0004" num="0003">Pattern recognition techniques are used in images, integrated into a system whose goal is to label each type of food contained in the photo of a plate of food. No type of preprocessing is performed to correct deficiencies in capturing the image, just using the auto-focus component present in the portable device to capture a clear image.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0005" num="0004">Food recognition is a relatively new research field, which uses techniques of visual pattern recognition to identify a picture of food in a plate of food.</p>
<p id="p-0006" num="0005">In the problem of food recognition, the great challenge is to target and identify the various foods on the plate considering environmental issues such as changing lighting, great variability of patterns even within a class of foods (e.g. green, red or black beans, roasted beef, with different sauces on top, cooked, etc.) and possible mixing. Even using known methods of image segmentation and pattern classification, it is still difficult to obtain a high recognition of objects when the problems mentioned are present.</p>
<p id="p-0007" num="0006">The document titled: &#x201c;Food Recognition Using Statistics of Pairwise Local Features,&#x201d; by Yang et al, published in IEEE Inti. Conference on Computer Vision and Pattern Recognition, published on Jun. 13, 2010, uses a data set of the document entitled: &#x201c;PFID: Pittsburgh Fast-Food Image data sets,&#x201d; Inti. Conference on Image Processing, published on Nov. 10, 2009, by Chen et al to assess the quality of their food recognition system. It is important to note that the data sets of food images are eminently snacks, making it easier to be recognized as belonging to classes with more structured standards, for example, sandwiches, French fries, etc.</p>
<p id="p-0008" num="0007">The patent document U.S. 2003/0076983, entitled: Personal Food Analyzer, published on Apr. 24, 2003, proposes a system for identifying foods in the image. This patent document employs a system of lights mounted on different angles on the portable device in which the food recognition system can be found. From a central camera, with the lights at its ends, two images illuminated by each of the two light sources are captured sequentially. With the two images, the foods are identified, their volumes estimated and their calories obtained from a database of nutritional information of pre-registered food. The two sequential images are used to target the food and estimate the volume of each food from the outline of its shadows. Soon after, only the first image is sent to the food identifier, consisting of a food reference tree. The reference tree is used to estimate the type of food from similar characteristics of color, shape and size. From the description of this patent document, it is understood that the method of identification of too is not robust to variations in food (and even lighting), since they expect food colors, shapes and sizes previously estimated, not being adaptive. In addition, the automatic decision by a plate of food can lead to huge errors, not allowing the user to change the type of food, if it is misidentified. Nothing is reported still on the automatic method to segment the image of the plate of food. Also, there are no details on the method of identifying food.</p>
<p id="p-0009" num="0008">The patent document 2010/0173269, published on Jul. 8, 2010, makes use of voice and visual patterns to identify a picture of food. In front of a picture of food taken by the user, the latter presents a description of each item in the plate, along with visual patterns, the modules of voice recognition and image recognition identify each food in the picture. The voice recognition step can help to identify any problems with it. With regard to the method proposed in this document for visual pattern recognition, it also employs characteristic of colors and textures, and classify them by support vector machines. The food colors are featured in the color space CIE L*a*b* and for textures are used the histograms of oriented gradients. It is known that the characterization of an object by only basic features, even if the concatenation of two or more characteristics is insufficient to determine the wide variation in standards of food in an image, and so limitations to identify are expected. Integration with voice recognition by identifying a list of characteristics of the food plate in the photo must therefore distinguish a series of visual limitations of the proposed methods.</p>
<p id="p-0010" num="0009">The patent document U.S. 2010/0111383, published on May 6, 2010, proposes a system to record calories from automatic recognition of pictures of food taken by a portable camera. The photo of a plate of food is taken before and after eating, for the calculation of food eaten. The proposed application provides several ways to do it, as manually from the photo of captured food up to automatically from lists of suggested foods for each food recognized segment of image. The automatic recognizer presented in this document is executed on a computer, causing the portable device to be connected via the network to this server application. Thus, after the picture is taken, it is sent to the server, where an idealized system of pattern recognition is performed to segment each type of food. The requirement to be connected to a computer network makes use of the method proposed by the document U.S. 2010/0111383 limited to local access network and the existence of a network computer application for recognition. In addition, the use of Gabor filters also makes high computational cost for responding to input images, which can annoy most users of portable devices. Additionally, the segmentation based on threshold methods does not make the application suitable for all types of lighting problems.</p>
<p id="p-0011" num="0010">Therefore, to address these problems, the present invention provides a method for food recognition by extracting features based on colors and textures. The first, we use the color space CIE L*a*b*, HSV and RGB in order to represent the colors of the foods in way that it is as invariant as possible to different types of lighting environment. With the concatenation of robust features of textures using Gaussian difference and coefficient of spatial variation, it was possible to obtain multiple spaces of hypotheses which are classified by robust classifiers based on support vector machines (SVM) with radial based kernel-type function. By means of multiple &#x2018;classification hypotheses, it is obtained therefore a method capable of dealing with the problems mentioned above.</p>
<p id="p-0012" num="0011">Despite technological advances, portable devices still have relatively limited hardware resources to run algorithms that perform advanced calculations. To address these limitations, the present invention applied parallel execution techniques aiming to reduce the computational cost, allowing a reduction in decode time and minimizing the use of the processor of the portable device. These techniques also provide an increased robustness of the food identifier, since it was possible to use stronger methods without increasing the computational cost, besides allowing the identification in a timely manner.</p>
<p id="p-0013" num="0012">To prevent the image from the plate of being captured in a distorted or unfocused, auto-focus of the device is triggered, preventing this problem.</p>
<p id="p-0014" num="0013">In order to increase the robustness of the identification of the object and its corresponding segmentation in the image, we used a combination of the method of segmentation and identification so that the two work in order to help each other. The segmentation method operates in three different and robust color spaces under certain image conditions. Then, color and texture features are extracted for each segment-hypothesis established by the segmenting method, and a probability of being a list of foods is listed for each data segment. A reclassifier based on contexts previously listed is used to reorder the list provided by the classifier of patterns. The choice of the segment and list of foods with a better chance is finally provided to the end user, so that he can reaffirm the best chance of the list or simply choose a food that best identifies the image on the plate. With this, the problems on variation of the same pattern in the image are handled due to different lighting environments in which the pictures will be taken. The volume of each food on the plate is estimated by approaching its area. At the end, the calorie relationship between volume and type of food is obtained through a pre-registered table of values.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0015" num="0014">The objects and advantages of the present invention will become apparent from the following detailed description of an exemplary embodiment of the invention and attached drawings by way of non-limiting example, in which:</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 1</figref> represents the hardware architecture of the food recognition method.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2</figref> shows the execution flow of the method in a portable device.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 3</figref> illustrates the architecture of a portable device.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 4</figref> illustrates the structure of cut-offs within a segment.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF PREFERRED EMBODIMENTS OF THE INVENTION</heading>
<p id="p-0020" num="0019">The method of the present invention segments each food on a plate of food image, identifying these foods segmented from a pre-set menu. The method runs on a portable device equipped with a digital camera, and therefore it is provided a device designed for human utility for identification and recording of foods and their calories over a period. In a preferred embodiment of the invention, the method segments and identifies food in an image of a top of a food plate, running in a small space-time.</p>
<p id="p-0021" num="0020">The present invention enables a portable device equipped with a digital camera to identify food. To this purpose, methods to segment and identify the food on the plate of food were designed.</p>
<p id="p-0022" num="0021">The hardware needed is a portable device, where its main features are illustrated in <figref idref="DRAWINGS">FIG. 1</figref>. The CPU (<b>110</b>) (Central Processing Unit) is responsible for executing the necessary instructions for managing the camera, and make the computations for processing the image with the food, the camera (<b>111</b>) to capture images and have a sufficient focus for the captured image maintaining its clearness and yet, according to the preferred embodiment of the invention, having auto-focus. The storage medium {<b>112</b>) serves to store information and data, viewed item, among others. The hardware also consists of information input devices (<b>113</b>) and audio components (<b>114</b>). Through some connectivity component (<b>115</b>) it is possible to communicate between the application and a remote database that has information about the products. The display means (<b>116</b>) is used to view images captured by the camera device.</p>
<p id="p-0023" num="0022">When the user runs the application from a portable device with an architecture similar to that of <figref idref="DRAWINGS">FIG. 1</figref>, in which the application was previously installed.</p>
<p id="h-0005" num="0000">Technical/Functional Advantages of the Invention</p>
<p id="p-0024" num="0023">Low computational cost: seeking to improve the method of identification of food were used programming practices that optimize the performance of computer instructions, for example, using fixed point instead of floating point, use bit manipulation to perform certain operations, use the minimum possible instructions to scan or copy the pixels of an image, approximating the Euclidean distances to the integer values in the module and using buffer for characteristic of the object in the image.</p>
<p id="p-0025" num="0024">Identification of food effectively: Identification of food is carried out effectively, since it succeeds in most attempts to identify foods separated on the plate, being possible to identify even in different lighting environments. Use of concurrent programming: concurrent, robust and agile computing techniques were used and communication between processes, causing the system to display the results immediately after the choice of the center of the image of the food. Using this technique, it is possible to perform the entire process of food identification without affecting the exhibition rate of the camera's preview.</p>
<p id="p-0026" num="0025">Semi-automatic segmentation: it is known that fully automatic segmentation methods are still inefficient for use in images taken in different lighting situations. Thus, a semi-automated method to segment objects in the photo of the plate was employed. For this purpose, the user must choose the centers of the image of each food, and then a method based on region broadening is applied. Thus, it was possible to obtain robust results in segmentation from the user control.</p>
<p id="p-0027" num="0026">A new method of integration between the segmentation and identification from multiple hypotheses: in the present invention a method based on the integration between segmentation and identification through multiple hypotheses is proposed. Thus, a segmentation method based on region broadening is applied to three different and robust color spaces to different situations in the image (HSV, L*a*b* and ROB). Then, a classifier based on support vector machine (SVM) with radial based kernel-type function, with optimal parameters obtained through a cross validation method is used on each segmentation hypothesis. For each segment, several fixed-size cutouts are extracted. For each cut-off, features of color, texture and shape are extracted. These characteristics are used as input to SVM for said identification of a segment containing food, as it will be detailed below.</p>
<p id="p-0028" num="0027">Aim to take pictures of the plate: it was created aim designed in the preview image of the photo of the plate. With this, we establish a standard distance to take pictures through the framework of the plate in the circle of aim, making it possible to estimate more efficiently the volume of food from the plate.</p>
<p id="p-0029" num="0028">Use of hardware device with high mobility: the present invention can be performed on any portable device, equipped with camera, small and light that can be carried to different places without taking up much space. With this, we obtained a portable device and immediate and effective identification of foods.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 2</figref> shows the sequence of steps beginning at the capture of the photo of the top of the plate (<b>210</b>) to the suggestion of a list of foods for each food plate (<b>217</b>). After initialization, the digital camera device is triggered by the user and it will show in the &#x201c;display&#x201d; the photo from the top of a plate of food (<b>210</b>). Then, the user chooses the center of the food in each photo (<b>211</b>). The centers being set, the region broadening method is applied to each center and on different color spaces (HSV, RGB and LAB) (<b>212</b>), providing three hypotheses of segments chosen for each center (<b>214</b>). With each segment obtained at (<b>214</b>), an SVM is trained with a radial based kernel-type function (<b>215</b>), and from a predetermined menu of food images, a list of foods likely to be obtained for each segment. In the end, the segment with highest probability is chosen (<b>216</b>) and the results of targeted food and their possible identifications (<b>217</b>) are shown.</p>
<p id="p-0031" num="0030">The method proposed by the present invention to integrate the segmentation and identification of foods is shown in <figref idref="DRAWINGS">FIG. 3</figref>. Three hypotheses (<b>310</b>, <b>311</b>, <b>312</b>) are generated by the segmentator based on broadening the region, from three color spaces: RGB, HSV and CIE L*a*b*. For each color space, coefficients of spatial variation (CV) are computed, where effectively the segmentation method is applied. The CV is responsible, therefore, for defining the texture of each color, and is obtained from the two following equations:</p>
<p id="p-0032" num="0031">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mover>
          <mi>x</mi>
          <mi>_</mi>
        </mover>
        <mo>=</mo>
        <mfrac>
          <mrow>
            <munderover>
              <mo>&#x2211;</mo>
              <mrow>
                <mi>i</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>n</mi>
            </munderover>
            <mo>&#x2062;</mo>
            <mi>xi</mi>
          </mrow>
          <mi>n</mi>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mi>where</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mtext>:</mtext>
        </mstyle>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>2</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>CV</mi>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mi>DP</mi>
              <mover>
                <mi>x</mi>
                <mi>_</mi>
              </mover>
            </mfrac>
            <mo>&#x2062;</mo>
            <mn>100</mn>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mstyle>
        <mspace width="0.3em" height="0.3ex"/>
      </mstyle>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0033" num="0032"> <o ostyle="single">x</o> is the average color of a pixel region;</p>
<p id="p-0034" num="0033">DP is the standard deviation of the pixels belonging to the region under analysis; and</p>
<p id="p-0035" num="0034">CV is the variation coefficient.</p>
<p id="p-0036" num="0035">The three color spaces used were chosen from ten initial color spaces. The selection process was determined as follows:</p>
<p id="p-0037" num="0036">1) By means of a manual segmentation tool, twelve images of plates of food were segmented and duly noted;</p>
<p id="p-0038" num="0037">2) Next, it was created an index to determine the quality of automatic segmentation based on broadening the region by means of:</p>
<p id="p-0039" num="0038">a. S=A<sub>GT</sub>&#x2229;A<sub>RG</sub>+A<sub>RG</sub>&#x2212;(A<sub>GT </sub>&#x2229;A<sub>RG</sub>), where A<sub>GT </sub>is the area of the segment manually given (ground truth), A<sub>RG </sub>is the area of the segment given by the automatic segmentator based on broadening the region, the higher the score S, the higher the quality the automatic segment;</p>
<p id="p-0040" num="0039">3) After finding the value of S to ten different color spaces, the spaces with the three highest values of S were obtained (in this case, HSV, RGB and L*a*b with CVs for each space).</p>
<p id="p-0041" num="0040">It is important to indicate that in segmenting by broadening regions, the regions of the image are grouped based on the minimum difference between the moving average on the given region and its neighbors. This minimum difference is attributed empirically and consists of the threshold that defines the sensitivity level. After selection by the user of the centers of the regions of the image containing foods, the following steps are applied:</p>
<p id="p-0042" num="0041">1. Initializing the parameters L, (x0, y0), M0, D0 and V0 corresponding, respectively, to the threshold, position of the center of the image region, the initial moving average, an array of pixels neighboring the current region, ignoring pixels on the diagonal, and finally, a vector of differences between the neighbors below the threshold L (given by the Euclidean distance between the values of pixels). In this first iteration, the moving average corresponds to the initial value of this pixel at position (x<b>0</b>, y<b>0</b>), which, according to the present invention, are the three components of the color spaces used for each hypothesis segment;</p>
<p id="p-0043" num="0042">2. At each iteration, the position of the last neighbor (xi, yi), stored in the vector Vi, is stored in order to compute the new values of the parameters Mi, Vi and Di. The moving average is given by (M<sub>(i-1)</sub>*Si)+V<sub>(i-1)</sub>/(Si+1);</p>
<p id="p-0044" num="0043">3. The final region to be segmented is found when all the pixels within the vector V have values less than the threshold L.</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 4</figref> shows a segment of a food in one image. For each segment obtained by the method of automatic broadening the region, a set of square regions of the image size of 30&#xd7;30 pixels, called cut-off (<b>410</b>) are obtained throughout the area found within the segment. For each cut-off, features of color (RGB and CIE L*a*b*), form (difference of Gaussians [DOG]) and texture (CV on doGs) are extracted. The feature vector is composed as follows for each cut-off:</p>
<p id="p-0046" num="0045">It is applied a DoG in each RGB channel, and obtained a CV for each space in the doG; in this step, there are therefore three elements;</p>
<p id="p-0047" num="0046">It calculated the average of the R, G and 8 of each cut-off, and there are therefore three elements;</p>
<p id="p-0048" num="0047">It is computed the average across the channel L*a*b&#x201d;, obtaining three more elements;</p>
<p id="p-0049" num="0048">For each color channel L*a*b*, it is calculated CV, finally, obtaining three more elements.</p>
<p id="p-0050" num="0049">Therefore, a vector of twelve elements (<b>313</b>) is classified by an SVM (<b>314</b>) using a radial based kernel-type function. In turn, the SVMs will be responsible for turning the input space into a higher dimensional space, however, linearly separable. This feature, along with the fact that the learning function is convex and quadratic, makes a SVM one of the best known classification methods, as it allows obtaining, in most cases, an overall minimum for separation of input objects having maximal margin of separation. To turn the input space into a linearly separable space, the SVMs use a kernel function that is applied from an operation of internal space, ie, it increases the input data to a higher dimensional space only virtually (without necessarily effect the mentioned transformation). The choice of kernel function is dependent on the input space. In general, the radial based kernel-type function provides the best results and is defined by:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>K</i>(<i>x</i><sub>i</sub><i>,x</i><sub>j</sub>)=exp(&#x2212;&#x3b3;&#x2225;<i>x</i><sub>i</sub><i>&#x2212;x</i><sub>j</sub>&#x2225;<sup>2</sup>), &#x3b3;&#x3e;0&#x2003;&#x2003;(3)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where xi and xj are elements of the input space and &#x3b3;, a kernel parameter. The parameter &#x3b3; is obtained by cross-validation, dividing the training data set into five disjoint sets, and using one for training and the remainder for validation, and repeating until all the subsets of the set of initial data have been used for training and the classification error is minimal.
</p>
<p id="p-0051" num="0050">After obtaining the parameter, the entire data set used for cross-validation is now used to train the classification model. This data set consists of feature vectors (with twelve elements, as mentioned above) obtained from cut-offs of multiple segments manually set and containing foods. At the end, it is obtained a model of multi-classification. Such model is obtained from a menu of pre-determined food and can be updated over time.</p>
<p id="p-0052" num="0051">In the prediction phase (or identification itself), the SVM classifies each cut-off present in one segment, providing a &#x201c;score&#x201d;, calculated by the distance between the vector to be classified and the separation hyperplane, which is given by:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>y</i>(<i>x</i>)=<i>w</i><sup>t</sup><i>k</i>(<i>x</i>)+<i>b</i>&#x2003;&#x2003;(4),<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where y is the output function, x is the input vector, w is the weight matrix obtained during training, k is the kernel function and b is the polarization vector (bias).
</p>
<p id="p-0053" num="0052">In the case of multi-classification, the method used is the &#x201c;one-versus-one&#x201d;, where C (C&#x2212;1)/2 binary classifiers are trained from the training data, obtaining the combination of all data from two to two classes. The &#x201c;score&#x201d; obtained by the distance between the point to be classified and the separating hyperplanes is given in the interval [0, &#x221e;). To convert the current value into probability, it was used a logistic function given by:</p>
<p id="p-0054" num="0053">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>f</mi>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mi>s</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mfrac>
          <mn>1</mn>
          <mrow>
            <mn>1</mn>
            <mo>-</mo>
            <mrow>
              <mi>exp</mi>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>As</mi>
                  <mo>+</mo>
                  <mi>B</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>5</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where s is the score given by the SVM, and A and B are parameters obtained in training and approach 1 and 0, respectively, in practice. After that, the outputs of the classifiers are probabilistic, i.e., in the range between 0 and 1.
</p>
<p id="p-0055" num="0054">As in a given segment there are several cut-offs, the final probability of a segment is a specific element is given by the average of the probabilities of all the cut-offs for a given food. At the end, it will be obtained probabilities for various foods. Since some cut-offs can be wrongly classified, the food with the highest probability will define the segment. It is important to mention that the final probability is given by:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>p</i><sub>final</sub>=max(<i>p</i><sub>i</sub>)<sub>i=1</sub><sup>3</sup>&#x2003;&#x2003;(6)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
which corresponds to the probability obtained for each hypothesis segment of the segmentator.
</p>
<p id="p-0056" num="0055">Rather than just providing a final food hypothesis, the identification system of food off obtaining this list of SVMs, a reordering of the list based on context is applied.</p>
<p id="p-0057" num="0056">In the solution to the problem of food recognition, the final classification made by SVMs presents an ordered list of possible foods. In this list, however, due to several factors, there is still the possibility of errors in classification. So, to deal with these uncertainties, minimizing the misclassification, the MMR method is used. This method is responsible for reordering the final list of SVMs from previously listed requirements and contexts. The MMR method belongs to the class of methods for solving problems of making decisions. For the food recognition, the decision to be made is the choice of food among all the possible alternatives present in the pre-defined food menu. The great advantage of MMR method with regard to other methods is the fact that these contexts do not need to be defined precisely. Therefore, parameters and situations can be modeled loosely, giving flexibility and robustness to the method, while the results generated continue to be deterministic.</p>
<p id="p-0058" num="0057">Given the mobile environment with limited processing and strict timing requirements from the user, it presents the following solution to a contextual handling of the uncertainties in the classifications made by SVMs.</p>
<p id="p-0059" num="0058">Even considering robust classifiers as SVMs, it is not possible to guarantee that the food recognizer, with the structure described so far, will succeed in every situation, since foods with similar color and texture may belong to different categories. A decision would need robust computationally expensive methods to distinguish all kinds of food similar to texture, color or shape. For this reason, after classification with SVMs, contextual information is used in order to increase the robustness of decisions in naming foods. This step was called contextual reclassification.</p>
<p id="p-0060" num="0059">The process of automatic food recognition presents an imprecise nature as to the process of capturing and manipulating images in portable devices, or as to the decisions made in the classification process by SVMs. For the latter situation, an ordered list of probabilities provided by SVMs can provide an incorrect answer. Additionally, food can vary in color and texture from country to country, and methods need to adapt dynamically to unknown factors. This makes a universal solution makes the final application difficult to be managed by the end user when the user demands vary, the rating performance is lower than expected or when the user's preferences change. In view of the aforementioned, the problem of decision making in the food recognitions can be considered as a selection of the best alternatives based on partial uncertainties (SVMs outputs). Such uncertainties will be resolved in the final step, from the MinMax method Regret (MMR), under the approach to reclassify the list provided by SVMs.</p>
<p id="p-0061" num="0060">The MMR method works by constructing a regret matrix (regret), which elements show the &#x201c;regret&#x201d; of the decision maker in solving an alternative Ai, for a given attribute Cj associated with a weight wij, as in table below:</p>
<p id="p-0062" num="0061">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mrow>
  <mtable>
    <mtr>
      <mtd>
        <msub>
          <mi>A</mi>
          <mn>1</mn>
        </msub>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <msub>
          <mi>A</mi>
          <mn>2</mn>
        </msub>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mi>&#x22ee;</mi>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <msub>
          <mi>A</mi>
          <mi>m</mi>
        </msub>
      </mtd>
    </mtr>
  </mtable>
  <mo>&#x2062;</mo>
  <mover>
    <mrow>
      <mo>(</mo>
      <mtable>
        <mtr>
          <mtd>
            <msub>
              <mi>w</mi>
              <mn>11</mn>
            </msub>
          </mtd>
          <mtd>
            <msub>
              <mi>w</mi>
              <mn>12</mn>
            </msub>
          </mtd>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
          <mtd>
            <msub>
              <mi>w</mi>
              <mrow>
                <mn>1</mn>
                <mo>&#x2062;</mo>
                <mi>n</mi>
              </mrow>
            </msub>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub>
              <mi>w</mi>
              <mn>21</mn>
            </msub>
          </mtd>
          <mtd>
            <msub>
              <mi>w</mi>
              <mn>22</mn>
            </msub>
          </mtd>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
          <mtd>
            <msub>
              <mi>w</mi>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>n</mi>
              </mrow>
            </msub>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub>
              <mi>w</mi>
              <mrow>
                <mi>m</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mn>1</mn>
              </mrow>
            </msub>
          </mtd>
          <mtd>
            <msub>
              <mi>w</mi>
              <mrow>
                <mi>m</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mn>2</mn>
              </mrow>
            </msub>
          </mtd>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
          <mtd>
            <msub>
              <mi>w</mi>
              <mi>mn</mi>
            </msub>
          </mtd>
        </mtr>
      </mtable>
      <mo>)</mo>
    </mrow>
    <mtable>
      <mtr>
        <mtd>
          <msub>
            <mi>C</mi>
            <mn>1</mn>
          </msub>
        </mtd>
        <mtd>
          <msub>
            <mi>C</mi>
            <mn>2</mn>
          </msub>
        </mtd>
        <mtd>
          <mi>&#x2026;</mi>
        </mtd>
        <mtd>
          <msub>
            <mi>C</mi>
            <mi>n</mi>
          </msub>
        </mtd>
      </mtr>
    </mtable>
  </mover>
</mrow>
</math>
</maths>
</p>
<p id="p-0063" num="0062">For each alternative, we compute the maximal regret and the effective range of the score is obtained by selecting the maximal remorse. The aim of the method is to choose the results that show the minimum remorse, with the following steps:</p>
<p id="p-0064" num="0063">Calculating Wj=Max [w ij] for each Cj and all Ai's;</p>
<p id="p-0065" num="0064">Calculating rij=Wj&#x2212;wij for each combination of Ai's and CJ's;</p>
<p id="p-0066" num="0065">Computing Ri=Max [rij) for each Ai's and all Cj's;</p>
<p id="p-0067" num="0066">Selecting A*I*R such that i=Min [Ri].</p>
<p id="p-0068" num="0067">In the steps listed, rij represents the elements of regret matrix; Ri is the maximal regret obtained for each alternative Ai and R*i is the minimum maximal remorse. The regret matrix is normalized to unity, as follows: N (rij)=rij/(Wjmax&#x2212;Wjmin) Finally, the maximal regret is given by: Ri=Maxi [rij]. Instead of using a food on each element rij, it was a class of foods grouped by similarity of color and texture. Thus, after reclassification, not only those particular foods will be reordered, but also groups of objects with similar visual characteristics. This will make the next phase, in which the user manually distinguishes possible recognition errors more accurate, making the final application more reliable.</p>
<p id="p-0069" num="0068">It is important to note that even though this method of food recognition in some ways, shows some incorrect result, the user can still correct identifications of food through a manual note tool, available in this application that incorporates such a food recognition method.</p>
<p id="p-0070" num="0069">Although a preferred embodiment of the present invention is shown and described, those skilled in the art will understand that various modifications can be made without departing from the spirit and scope of the present invention, as defined in the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08625889-20140107-M00001.NB">
<img id="EMI-M00001" he="24.38mm" wi="76.20mm" file="US08625889-20140107-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08625889-20140107-M00002.NB">
<img id="EMI-M00002" he="7.03mm" wi="76.20mm" file="US08625889-20140107-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08625889-20140107-M00003.NB">
<img id="EMI-M00003" he="18.37mm" wi="76.20mm" file="US08625889-20140107-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US08625889-20140107-M00004.NB">
<img id="EMI-M00004" he="18.37mm" wi="76.20mm" file="US08625889-20140107-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for food recognition using a portable device equipped with a digital camera to record food and calories, the method comprising:
<claim-text>segmenting items of food of a top-view photo of a plate of food into regions using the centers, selected by a user, of each item of food;</claim-text>
<claim-text>broadening the regions based on each center and on different color spaces (HSV, RGB, and LAB);</claim-text>
<claim-text>providing three hypotheses of segments chosen for each center to obtain robust results from the segmentation;</claim-text>
<claim-text>training, for each hypothesis, a Support Vector Machine (SVM) having a radial based kernel-type function;</claim-text>
<claim-text>obtaining, from a predetermined menu of food images, a list of probabilities for each segment of food;</claim-text>
<claim-text>choosing the segment with the highest probability; and</claim-text>
<claim-text>showing the results of segmented food and their possible identifications.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein coefficients of spatial variation (CV) are computed for each color space the segmentation method is applied to, and the CV defines a texture of each color.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein, for each segment obtained by the broadening of regions, a set of square regions of the image having 30&#xd7;30 pixels in size are obtained throughout the area found within the segment.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein, for each feature are extracted features of color (RGB and CIE L*a*b*), form (difference of Gaussians [DOGs]) and texture (CV on doGs).</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the feature vector is composed as follows for each cut-off:
<claim-text>a DoG is applied to each RGB channel, and a CV is obtained for each space in the DoG, generating three elements;</claim-text>
<claim-text>the average of the R, G and B channels of each cut-off is computed, generating three more elements;</claim-text>
<claim-text>the average across the channel L*a*b* is computed, obtaining three more elements;</claim-text>
<claim-text>a CV is computed for each color channel L*a*b*, obtaining three more elements, being the vector composed of twelve elements sorted by an SVM using a radial based kernel-type function, and the SVMs will be responsible for transforming the input space into a higher dimensional space, however, linearly separable.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein at the stage of prediction, the SVM classifies each cut-off present in one segment, providing a &#x201c;score&#x201d; obtained by the distance between the vector to be classified and the separation hyperplane.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the probability of a final segment is given by the average of the probabilities of all cut-offs of a given food, and at the end, the probabilities of various foods are obtained.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein, since some cut-offs can be classified incorrectly, the food with the highest probability will be used for the segment.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein instead of providing only a hypothesis of the final food, the food identification system provides a list of foods in decreasing order by probability.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein, after obtaining this list of SVMs, a reordering of the list based on context is applied.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein in that ordered list of possible food, there is still the possibility of errors in classification.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein to deal with uncertainties, minimizing the classification errors, a MMR method, which is responsible for reordering the final list of SVMs from requirements and contexts listed previously is used.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein, after qualifying with SVMs, using contextual information in order to increase the robustness of naming food.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the decision on the food recognition is made from the best selection of alternatives based on partial uncertainty, SVMs outputs, and these uncertainties are solved, in the final stage, from the MinMax method Regret (MMR), under the approach of reclassifying the list provided by SVMs.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the MMR method works from the construction of an regret matrix whose elements show the &#x201c;regret&#x201d; of the decision maker in solving an alternative Ai, for a given attribute Cj associated with a weight wij, as follows:</claim-text>
<claim-text>
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mrow>
  <mtable>
    <mtr>
      <mtd>
        <msub>
          <mi>A</mi>
          <mn>1</mn>
        </msub>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <msub>
          <mi>A</mi>
          <mn>2</mn>
        </msub>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mi>&#x22ee;</mi>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <msub>
          <mi>A</mi>
          <mi>m</mi>
        </msub>
      </mtd>
    </mtr>
  </mtable>
  <mo>&#x2062;</mo>
  <mover>
    <mrow>
      <mo>(</mo>
      <mtable>
        <mtr>
          <mtd>
            <msub>
              <mi>w</mi>
              <mn>11</mn>
            </msub>
          </mtd>
          <mtd>
            <msub>
              <mi>w</mi>
              <mn>12</mn>
            </msub>
          </mtd>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
          <mtd>
            <msub>
              <mi>w</mi>
              <mrow>
                <mn>1</mn>
                <mo>&#x2062;</mo>
                <mi>n</mi>
              </mrow>
            </msub>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub>
              <mi>w</mi>
              <mn>21</mn>
            </msub>
          </mtd>
          <mtd>
            <msub>
              <mi>w</mi>
              <mn>22</mn>
            </msub>
          </mtd>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
          <mtd>
            <msub>
              <mi>w</mi>
              <mrow>
                <mn>2</mn>
                <mo>&#x2062;</mo>
                <mi>n</mi>
              </mrow>
            </msub>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub>
              <mi>w</mi>
              <mrow>
                <mi>m</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mn>1</mn>
              </mrow>
            </msub>
          </mtd>
          <mtd>
            <msub>
              <mi>w</mi>
              <mrow>
                <mi>m</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mn>2</mn>
              </mrow>
            </msub>
          </mtd>
          <mtd>
            <mi>&#x2026;</mi>
          </mtd>
          <mtd>
            <msub>
              <mi>w</mi>
              <mi>mn</mi>
            </msub>
          </mtd>
        </mtr>
      </mtable>
      <mo>)</mo>
    </mrow>
    <mtable>
      <mtr>
        <mtd>
          <msub>
            <mi>C</mi>
            <mn>1</mn>
          </msub>
        </mtd>
        <mtd>
          <msub>
            <mi>C</mi>
            <mn>2</mn>
          </msub>
        </mtd>
        <mtd>
          <mi>&#x2026;</mi>
        </mtd>
        <mtd>
          <msub>
            <mi>C</mi>
            <mi>n</mi>
          </msub>
        </mtd>
      </mtr>
    </mtable>
  </mover>
</mrow>
</math>
</maths>
<claim-text>and for each alternative, the maximal regret is computed and the score of the effective range is obtained by selecting the maximal remorse.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the results are chosen to show the minimal remorse, from the following:
<claim-text>calculating Wj=Max[wij] for each Cj and all Ai's;</claim-text>
<claim-text>calculating rij=Wj&#x2212;wij for each combination of Ai's and CJ's;</claim-text>
<claim-text>calculating Ri=Max[rij] for each Ai's and all Cj's; and</claim-text>
<claim-text>selecting A*I*R such that i=min[Ri], with the maximal regret given by: Ri=Maxi[rij].</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein instead of using a food on each element rij, a class of foods grouped by similarity, color, and texture is used.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein, after reclassification, not only particular foods will be reordered, but also groups of objects with similar visual characteristics.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein the user manually distinguishes possible recognition errors.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the user can further correct identifications of food through a manual note tool, if any incorrect result is displayed.</claim-text>
</claim>
</claims>
</us-patent-grant>
