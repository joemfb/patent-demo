<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625872-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625872</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13686879</doc-number>
<date>20121127</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2009-277916</doc-number>
<date>20091207</date>
</priority-claim>
<priority-claim sequence="02" kind="national">
<country>JP</country>
<doc-number>2010-248678</doc-number>
<date>20101105</date>
</priority-claim>
</priority-claims>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>01</class>
<subclass>N</subclass>
<main-group>23</main-group>
<subgroup>223</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>382131</main-classification>
<further-classification>382274</further-classification>
<further-classification>378 46</further-classification>
</classification-national>
<invention-title id="d2e79">Medical image processing apparatus and medical image processing method</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>7236622</doc-number>
<kind>B2</kind>
<name>Chen et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382132</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7778453</doc-number>
<kind>B2</kind>
<name>Camus et al.</name>
<date>20100800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382128</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7792346</doc-number>
<kind>B2</kind>
<name>Lienard et al.</name>
<date>20100900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382130</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>8081812</doc-number>
<kind>B2</kind>
<name>Kreiser</name>
<date>20111200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382132</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2007/0036405</doc-number>
<kind>A1</kind>
<name>Lienard et al.</name>
<date>20070200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382128</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2010/0215237</doc-number>
<kind>A1</kind>
<name>Ohishi</name>
<date>20100800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382131</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>JP</country>
<doc-number>2009-153870</doc-number>
<kind>A</kind>
<date>20090700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00008">
<othercit>&#x201c;C-Arm CT Measurement of Cerebral Blood Volume: An Experimental Study in Canines&#x201d;, AJNR Am. J. Neuroradiol., May 2009: 30, pp. 917-922.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>16</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>382100</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382106-107</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382128-134</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382154-155</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382162</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382168</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382173</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382181</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382199</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382232</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382254</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382274</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382276</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382291</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382294</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382305</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382312</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>378  6</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>378 20</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>378 21</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>378 23</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>378 25</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>378 28</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>378 46</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>7</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>12961879</doc-number>
<date>20101207</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>8340382</doc-number>
</document-id>
</parent-grant-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13686879</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20130089251</doc-number>
<kind>A1</kind>
<date>20130411</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only" applicant-authority-category="assignee">
<addressbook>
<orgname>Kabushiki Kaisha Toshiba</orgname>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only" applicant-authority-category="assignee">
<addressbook>
<orgname>Toshiba Medical Systems Corporation</orgname>
<address>
<city>Otawara</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Ohishi</last-name>
<first-name>Satoru</first-name>
<address>
<city>Otawara</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Yoshida &#x26; Associates, LLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Kabushiki Kaisha Toshiba</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
<assignee>
<addressbook>
<orgname>Toshiba Medical Systems Corporation</orgname>
<role>03</role>
<address>
<city>Tochigi-ken</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Azarian</last-name>
<first-name>Seyed</first-name>
<department>2667</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">In a medical image processing apparatus according to an embodiment, an image inverting unit generates a first inverted image obtained by inverting a first medical image in a left-and-right direction of an examined subject and generates a second inverted image obtained by inverting a second medical image that is different from the first medical image in the left-and-right direction of the examined subject. A displacement detecting unit detects a displacement between the first medical image and the first inverted image. A registration unit generates, based on the displacement detected by the displacement detecting unit, a corrected image obtained by correcting the second medical image or a corrected inverted image obtained by correcting the second inverted image. A difference image generating unit generates a difference image between the second inverted image and the corrected image or a difference image between the second medical image and the corrected inverted image.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="237.32mm" wi="144.27mm" file="US08625872-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="235.71mm" wi="189.57mm" file="US08625872-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="259.93mm" wi="167.05mm" file="US08625872-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="130.22mm" wi="158.67mm" file="US08625872-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="195.66mm" wi="149.52mm" file="US08625872-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="114.47mm" wi="149.52mm" file="US08625872-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is based upon and claims the benefit of priority from Japanese Patent Application No. 2009-277916, filed on Dec. 7, 20.09; and Japanese Patent Application No. 2010-248678, filed on Nov. 5, 2010, the entire contents of all of which are incorporated herein by reference.</p>
<heading id="h-0002" level="1">FIELD</heading>
<p id="p-0003" num="0002">Embodiments described herein relate generally to a medical image processing apparatus and a medical image processing method.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">Generally speaking, to make a diagnosis of a cerebral infarction, images that are obtained by performing, for example, Magnetic Resonance Imaging (MRI), Computed Tomography (CT), Single Photon Emission Computed Tomography (SPECT), and Positron Emission Tomography (PET) are used. Unless the circulation in an infarction site is resumed within three hours of an onset, the damage to the brain becomes significant, and part of the body functions of the patient may be lost or the brain damage may result in death.</p>
<p id="p-0005" num="0004">One of the techniques that are known to be used for treating a lesion is to insert a catheter up to the lesion while viewing an X-ray transmission image. This technique is called an intervention. Examples of intervention treatments that can be applied to the blood vessels that have a direct impact on the head include a treatment by which a catheter is put through a stenosis site in the neck, before the balloon provided around the catheter is blown up so as to expand the stenosis site, and a treatment for a cerebral aneurysm by which a catheter is advanced to a closer end of the cerebral aneurysm, and the aneurysm is filled with a coil ejected from a tip of the catheter, so as to prevent the blood streams from entering the aneurysm. During these treatments, some of the plaques adhering to a blood clot or a stenosis site may flow toward the periphery and may block a peripheral blood vessel so as to cause a cerebral infarction. If such an infarction has occurred in a relatively large blood vessel, it is possible to recognize the occurrence of the infarction during a check-up imaging examination that is performed after the intervention treatment. However, in the case where an infarction has occurred in a small blood vessel, it is difficult, in many cases, to recognize the occurrence of the infarction during a check-up imaging examination. In those situations, according to a currently-used workflow, it is determined, whether an infarction has occurred by performing a CT examination, an MRI examination, or the like when three hours or one day has passed since the completion of the intervention treatment. According to this workflow, however, it is extremely difficult to resume the circulation in the infarction site within three hours of an onset.</p>
<p id="p-0006" num="0005">To cope with this problem, a function has recently been proposed with which it is possible to check the manner in which blood is perfused by employing an X-ray angiography apparatus used for performing intervention treatments. When this function is used, images are taken while a C-arm is rotated around a patient at a high speed before and after a contrast media is injected into the patient. A three-dimensional image indicating an opacification degree of the contrast media is generated by reconstructing an image while using a subtraction image between the images taken before and after the injection of the contrast media, and also, a three-dimensional image indicating a body structure of the patient is generated from the image taken before the injection. After that, an area that has a CT value corresponding to the brain tissue is extracted from the three-dimensional image indicating the body structure. Further, by eliminating the areas other than the extracted area from the three-dimensional image indicating the opacification degree of the contract agent, it is possible to extract only the opacification degree of the contrast media in the brain tissue. There is a possibility that a part of the brain tissue that exhibits a low degree of opacification from the contrast media may be an infarction site. It is also possible to determine that the parts that exhibit a high degree of opacification from the contrast media have normal bloodstreams. It should be noted, however, that this imaging process is not supposed to be performed as a routine. Thus, the amount of contrast media used in the imaging process and the radiation exposure dose for the patient cause an additional burden upon the patient. In particular, according to this method, it is necessary to visualize the veins using a contrast media, the capillary vessels, and the arteries altogether, and the amount of the contrast media being used is very large.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0007" num="0006"><figref idref="DRAWINGS">FIG. 1</figref> is a diagram of an example of a medical image processing system according to a first embodiment;</p>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 2</figref> is a functional block diagram of a medical image processing apparatus according to the first embodiment;</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 3</figref> is a flowchart of a process performed by the medical image processing apparatus according to the first embodiment;</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 4</figref> is a chart depicting profiles of an area of an artery part and an area of a vein part that have been generated by a subtraction unit according to the first embodiment; and</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIGS. 5 to 7</figref> are charts for explaining a time difference correcting process and a difference image generating process that are performed by an index image generating unit <b>1</b><i>h </i>according to a second embodiment.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0012" num="0011">A medical image processing apparatus according to an embodiment includes an image inverting unit, a displacement detecting unit, a registration unit, and a difference image generating unit. The image inverting unit generates a first inverted image obtained by inverting a first medical image in a left-and-right direction of an examined subject and generates a second inverted image obtained by inverting a second medical image that is different from the first medical image in the left-and-right direction of the examined subject. The displacement detecting unit detects a displacement between the first medical image and the first inverted image. The registration unit, based on the displacement that has been detected by the displacement detecting unit, generates one of a corrected image obtained by correcting the second medical image and a corrected inverted image obtained by correcting the second inverted image. The difference image generating unit generates one of a difference image between the second inverted image and the corrected image and a difference image between the second medical image and the corrected inverted image.</p>
<p id="p-0013" num="0012">In the following sections, exemplary embodiments of a medical image processing apparatus and a medical image processing method will be explained in detail with reference to the accompanying drawings. However, embodiments of the medical image processing apparatus and the medical image processing method are not limited to the exemplary embodiments described below. In the exemplary embodiments described below, a medical image processing system that includes a medical image processing apparatus according to any of the exemplary embodiments and various types of medial image collecting apparatuses will be explained.</p>
<p id="p-0014" num="0013">First, an example of a medical image processing system according to a first embodiment will be explained.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> is a diagram of the example of the medical image processing system according to the first embodiment. As shown in <figref idref="DRAWINGS">FIG. 1</figref>, a medical image processing apparatus <b>1</b> according to the first embodiment is connected to an X-ray angiography apparatus <b>3</b> and a Picture Archiving and Communication System (PACS) <b>4</b> via a network <b>2</b>.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 2</figref> is a functional block diagram of the medical image processing apparatus <b>1</b> according to the first embodiment. As shown in <figref idref="DRAWINGS">FIG. 2</figref>, the medical image processing apparatus <b>1</b> includes an input unit <b>1</b><i>a</i>, a display unit <b>1</b><i>b</i>, a network interface (I/F) unit <b>1</b><i>c</i>, a subtraction unit <b>1</b><i>d</i>, an affine transformation unit <b>1</b><i>e</i>, a displacement detecting unit <b>1</b><i>f</i>, a registration unit <b>1</b><i>g</i>, an index image generating unit <b>1</b><i>h</i>, a spatial filter transforming unit <b>1</b><i>i</i>, a Look-Up Table (LUT) unit <b>1</b><i>j</i>, and a controlling unit <b>1</b><i>k. </i></p>
<p id="p-0017" num="0016">The input unit <b>1</b><i>a </i>receives various types of operations performed on the medical image processing apparatus <b>1</b> from an operator thereof. For example, the input unit <b>1</b><i>a </i>may be configured with any of the following: a mouse, a keyboard, a trackball, and a pointing device.</p>
<p id="p-0018" num="0017">The display unit <b>1</b><i>b </i>displays various types of images that have been processed by the medical image processing apparatus <b>1</b> and various types of information such as a Graphical User Interface (GUI). For example, the display unit <b>1</b><i>b </i>may be configured with a Cathode Ray Tube (CRT) monitor or a liquid crystal display monitor.</p>
<p id="p-0019" num="0018">The network I/F unit <b>1</b><i>c </i>controls transmissions and receptions of various types of information that are transmitted or received via the network <b>2</b>. The network I/F unit <b>1</b><i>c </i>obtains a medical image that has been taken by the X-ray angiography apparatus <b>3</b>.</p>
<p id="p-0020" num="0019">The subtraction unit <b>1</b><i>d </i>generates a difference image such as a Digital Subtraction Angiography (DSA) image. For example, the subtraction unit <b>1</b><i>d </i>generates a DSA image from the medical image that has been obtained by the network I/F unit <b>1</b><i>c. </i></p>
<p id="p-0021" num="0020">The affine transformation unit <b>1</b><i>e </i>enlarges or reduces the size of images, and moves and inverts images. For example, the affine transformation unit <b>1</b><i>e </i>generates an inverted image by applying a left/right inversion to the medical image that has been obtained by the network I/F unit <b>1</b><i>c. </i></p>
<p id="p-0022" num="0021">The displacement detecting unit <b>1</b><i>f </i>detects a displacement between the medical image that has been obtained by the network I/F unit <b>1</b><i>c </i>and the inverted image that has been generated by the affine transformation unit <b>1</b><i>e. </i></p>
<p id="p-0023" num="0022">The registration unit <b>1</b><i>g </i>corrects the medical image based on the displacement that has been detected by the displacement detecting unit <b>1</b><i>f</i>. For example, based on the displacement that has been detected by the displacement detecting unit <b>1</b><i>f</i>, the registration unit <b>1</b><i>g </i>generates a corrected original image obtained by correcting the medical image that has been obtained by the network I/F unit <b>1</b><i>c </i>and generates a corrected inverted image obtained by correcting the inverted image that has been generated by the affine transformation unit <b>1</b><i>e. </i></p>
<p id="p-0024" num="0023">The index image generating unit <b>1</b><i>h </i>generates an index image that serves as an index indicating the bloodstreams. For example, the index image generating unit <b>1</b><i>h </i>generates, as an index image, a difference image between the medical image that has been obtained by the network I/F unit <b>1</b><i>c </i>and the corrected inverted image that has been generated by the registration unit <b>1</b><i>g. </i></p>
<p id="p-0025" num="0024">The spatial filter transforming unit <b>1</b><i>i </i>performs, for example, a frequency emphasizing process or a low-pass filtering process on an image. The Look-Up Table (LUT) unit <b>1</b><i>j </i>transforms the gray level of an image.</p>
<p id="p-0026" num="0025">The controlling unit <b>1</b><i>k </i>controls various types of processing that are performed by the medical image processing apparatus <b>1</b>. For example, the controlling unit <b>1</b><i>k </i>moves the control from one of the functional units included in the medical image processing apparatus <b>1</b> to another one of the functional units, and also, forwards data from one of the functional units to another one of the functional units.</p>
<p id="p-0027" num="0026">Next, a flow in a process performed in the medical image processing system according to the first embodiment will be explained more specifically. In the following sections, an example in which the head of a subject is examined by using the X-ray angiography apparatus <b>3</b> will be explained.</p>
<p id="p-0028" num="0027">During a head examining process performed by using an X-ray angiography apparatus, diagnoses are primarily made regarding the shapes of the blood vessels such as cerebral aneurysms, stenoses, and anomalies as well as regarding the bloodstreams. Generally speaking, a diagnosis of a cerebral infarction, which is caused when one or more of the capillary vessels in the brain have an infarction, is made by using an X-ray CT apparatus or an MRI apparatus, because it is not possible to recognize the capillary vessels by using an X-ray angiography apparatus.</p>
<p id="p-0029" num="0028">For example, examples of treatments of the head using an X-ray angiography apparatus include a treatment by which a catheter is inserted up to a stenosis site and a balloon provided around the catheter is blown up so as to expand the stenosis site. This treatment is called an intervention. During an intervention, when the balloon is blown up, there is a possibility that some of the plaques in the stenosis site may move to the peripheries, and the plaques may cause an infarction in the capillary vessels in the brain. In that situation, the infarction is discovered when an examination is performed by using an X-ray CT apparatus, after the intervention has been finished.</p>
<p id="p-0030" num="0029">Normally, however, it takes at least approximately three hours or even about one day in some cases, before the examination is performed by using an X-ray CT apparatus, after an intervention has been finished. If it is possible to treat infarctions in a short period of time, there will be hardly any damage to the brain; however, the longer period of time it takes, the lower the rate of recovery becomes. In particular, the rate of recovery drastically drops after three hours. Thus, to improve the Quality of Life (QOL) of patients, it is desirable to be able to check on infarctions while an intervention is being performed or at the end of intervention.</p>
<p id="p-0031" num="0030">According to the first embodiment, it becomes possible to diagnose a cerebral infarction caused by an infarction of the capillary vessels, which has not conventionally been diagnosable by using an X-ray angiography apparatus. In the following sections, a method therefor will be specifically explained.</p>
<p id="p-0032" num="0031">First, a process performed by the X-ray angiography apparatus <b>3</b> will be explained.</p>
<p id="p-0033" num="0032">Normally, when a treatment procedure has been completed, four blood vessels that are the major blood vessels in the brain are visualized using a contrast media and images thereof are taken, so as to make a diagnosis to determine whether an infarction has occurred in each of the four blood vessels. In this situation, the four blood vessels are the right internal carotid artery, the left internal carotid artery, the right vertebral artery, and the left vertebral artery. The right internal carotid artery nourishes the frontal part, the temporal part, and the parietal part of the right brain. The left internal carotid artery nourishes the frontal part, the temporal part, and the parietal part of the left brain. The right vertebral artery and the left vertebral artery nourish the base part and the occipital part of the brain.</p>
<p id="p-0034" num="0033">While visualizing using a contrast media the right internal carotid artery, the left internal carotid artery, the right vertebral artery, and the left vertebral artery, the X-ray angiography apparatus <b>3</b> generates a DSA image of each of these blood vessels. More specifically, the X-ray angiography apparatus <b>3</b> generates an average image of the images corresponding to a plurality of frames that are taken before the vessels are visualized using a contrast media, as a mask image. Further, the X-ray angiography apparatus <b>3</b> sequentially takes contrast images while a contrast media is flowing through the blood vessels.</p>
<p id="p-0035" num="0034">After that, the X-ray angiography apparatus <b>3</b> generates the DSA images by subtracting the mask image from each of the frames of the contrast images that have been taken. For example, the X-ray angiography apparatus <b>3</b> generates each of the DSA images by using Expression (1) shown below:</p>
<p id="p-0036" num="0035">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>DSA</mi>
            <mi>n</mi>
          </msub>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>i</mi>
              <mo>,</mo>
              <mi>j</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <msub>
            <mi>log</mi>
            <mi>e</mi>
          </msub>
          <mo>&#x2062;</mo>
          <mfrac>
            <mrow>
              <mi>mask</mi>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mrow>
              <msub>
                <mi>constrast</mi>
                <mi>n</mi>
              </msub>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mfrac>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0037" num="0036">In Expression (1), (i,j) denotes coordinates in the image. &#x201c;DSA<sub>n</sub>(i,j)&#x201d; denotes a DSA image in an n'th frame, whereas &#x201c;contrast<sub>n</sub>(i,j)&#x201d; denotes a contrast image in an n'th frame. Further, &#x201c;mask(i,j) denotes a mask image.</p>
<p id="p-0038" num="0037">When having generated the DSA images, the X-ray angiography apparatus <b>3</b> displays the generated DSA images on the display unit. Also, the X-ray angiography apparatus <b>3</b> transfers the mask image and all the contrast images to the medical image processing apparatus <b>1</b> via the network <b>2</b>. In this situation, the X-ray angiography apparatus <b>3</b> transfers the mask image and the contrast images of each of the arteries, i.e., the right internal carotid artery, the left internal carotid artery, the right vertebral artery, and the left vertebral artery to the medical image processing apparatus <b>1</b>.</p>
<p id="p-0039" num="0038">The X-ray angiography apparatus <b>3</b> may transfer the angiography examination images according to an instruction from an operator or may transfer all the angiography examination images automatically. Alternatively, for example, an arrangement is acceptable in which an analysis described herein is optional at acquisition program in the X-ray angiography apparatus <b>3</b> in advance so that, only when the acquisition program which has the option has been selected by an operator, the X-ray angiography apparatus <b>3</b> transfers the angiography examination images to the medical image processing apparatus <b>1</b>.</p>
<p id="p-0040" num="0039">Next, a process performed by the medical image processing apparatus <b>1</b> will be explained.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 3</figref> is a flowchart of a process performed by the medical image processing apparatus <b>1</b> according to the first embodiment. As shown in <figref idref="DRAWINGS">FIG. 3</figref>, the medical image processing apparatus <b>1</b> is configured so that the network I/F unit <b>1</b><i>c </i>obtains mask images each of which is expressed as mask(i,j) and contrast images that are expressed as contrast<sub>n</sub>(i,j) that have been transferred from the X-ray angiography apparatus <b>3</b> (step S<b>101</b>).</p>
<p id="p-0042" num="0041">In this situation, the network I/F unit <b>1</b><i>c </i>obtains mask(i,j) and contrast<sub>n</sub>(i,j) of each of the following arteries: the right internal carotid artery, the left internal carotid artery, the right vertebral artery, and the left vertebral artery. Further, the network I/F unit <b>1</b><i>c </i>stores the mask images and the contrast images that have been received into a storage unit (not shown).</p>
<p id="p-0043" num="0042">After that, the subtraction unit <b>1</b><i>d </i>reads mask(i,j) and contrast<sub>n</sub>(i,j) from the storage unit and generates DSA images from mask(i,j) and contrast<sub>n</sub>(i,j) that have been read (step S<b>102</b>).</p>
<p id="p-0044" num="0043">In this situation, for example, the subtraction unit <b>1</b><i>d </i>generates the images expressed as DSA<sub>n</sub>(i,j) for each of the blood vessels by using Expression (1), in the same manner as the X-ray angiography apparatus <b>3</b> does. The DSA<sub>n</sub>(i,j) images can be roughly classified into three types of temporal phases. The first temporal phase is an artery phase in which the arteries are dominant; the following temporal phase is a capillary vessel phase in which the capillary vessels are dominant, while the entirety of the brain cells are opacified, and there is hardly any influence of the arteries and the veins; and the last temporal phase is a vein phase in which the veins are dominant.</p>
<p id="p-0045" num="0044">Subsequently, after having generated DSA<sub>n</sub>(i,j) for each of the blood vessels, the subtraction unit <b>1</b><i>d </i>identifies frames that are in the capillary vessel phase, out of the DSA<sub>n</sub>(i,j) images that have been generated (step S<b>103</b>). In this situation, for example, the subtraction unit <b>1</b><i>d </i>receives a selecting operation to select the capillary vessel phase frames from the operator via the input unit <b>1</b><i>a </i>and identifies the capillary vessel phase frames based on the received selecting operation.</p>
<p id="p-0046" num="0045">After that, the subtraction unit <b>1</b><i>d </i>generates a capillary vessel phase image by calculating the arithmetic average of the capillary vessel phase frames that have been identified (step S<b>104</b>). In this situation, for example, the subtraction unit <b>1</b><i>d </i>generates the capillary vessel phase image by using Expression (2) shown below:</p>
<p id="p-0047" num="0046">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>DSA</mi>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>i</mi>
              <mo>,</mo>
              <mi>j</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mfrac>
          <mrow>
            <munderover>
              <mo>&#x2211;</mo>
              <mrow>
                <mi>n</mi>
                <mo>=</mo>
                <mrow>
                  <mi>N</mi>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mn>1</mn>
                </mrow>
              </mrow>
              <mrow>
                <mi>N</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mn>2</mn>
              </mrow>
            </munderover>
            <mo>&#x2062;</mo>
            <mrow>
              <msub>
                <mi>DSA</mi>
                <mi>n</mi>
              </msub>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mrow>
                <mi>N</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mn>2</mn>
              </mrow>
              <mo>-</mo>
              <mrow>
                <mi>N</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mn>1</mn>
              </mrow>
              <mo>+</mo>
              <mn>1</mn>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>2</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0048" num="0047">In Expression (2), N<b>1</b> and N<b>2</b> denote the frames at the beginning and at the end of the capillary vessel phase, respectively.</p>
<p id="p-0049" num="0048">It should be noted that the subtraction unit <b>1</b><i>d </i>generates the capillary vessel phase image described above for each of the vessels. For example, the subtraction unit <b>1</b><i>d </i>generates a capillary vessel phase image of the right internal carotid artery expressed as DSA<sub>RICA</sub>(i,j) and a capillary vessel phase image of the left internal carotid artery expressed as DSA<sub>LICA</sub>(i,j). The subtraction unit <b>1</b><i>d </i>then stores the capillary vessel phase images that have been generated into the storage unit.</p>
<p id="p-0050" num="0049">Subsequently, the affine transformation unit <b>1</b><i>e </i>reads the mask image of the right internal carotid artery expressed as mask<sub>RICA</sub>(i,j) and the mask image of the left internal carotid artery expressed as mask<sub>LiCA</sub>(i,j) from the storage unit. After that, the affine transformation unit <b>1</b><i>e </i>generates an inverted image expressed as Rmask<sub>RICA</sub>(i,j) obtained by applying a left/right inversion to mask<sub>RICA</sub>(i,j) that has been read (step S<b>105</b>). Subsequently, the affine transformation unit <b>1</b><i>e </i>stores the generated inverted image expressed as Rmask<sub>RICA</sub>(i,j) into the storage unit. Further, the affine transformation unit <b>1</b><i>e </i>forwards mask<sub>LICA</sub>(i,j) and Rmask<sub>RICA</sub>(i,j) to the displacement detecting unit <b>1</b><i>f. </i></p>
<p id="p-0051" num="0050">Subsequently, the displacement detecting unit <b>1</b><i>f </i>detects a displacement between mask<sub>LICA</sub>(i,j) and Rmask<sub>RICA</sub>(i,j) that have been forwarded from the affine transformation unit <b>1</b><i>e </i>(step S<b>106</b>). For example, the displacement detecting unit <b>1</b><i>f </i>detects the displacement between mask<sub>LICA</sub>(i,j) and Rmask<sub>RICA</sub>(i,j) by using Expression (3) shown below:</p>
<p id="p-0052" num="0051">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>MR</mi>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mrow>
                <mi>&#x394;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>i</mi>
              </mrow>
              <mo>,</mo>
              <mrow>
                <mi>&#x394;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>j</mi>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>&#x2211;</mo>
            <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>N</mi>
          </munderover>
          <mo>&#x2062;</mo>
          <mrow>
            <munderover>
              <mo>&#x2211;</mo>
              <mrow>
                <mi>j</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>N</mi>
            </munderover>
            <mo>&#x2062;</mo>
            <msup>
              <mrow>
                <mo>{</mo>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>mask</mi>
                      <mi>LICA</mi>
                    </msub>
                    <mo>&#x2061;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>,</mo>
                        <mi>j</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>-</mo>
                  <mrow>
                    <mi>&#x3b1;</mi>
                    <mo>&#x2062;</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>&#x2062;</mo>
                    <mi>R</mi>
                    <mo>&#x2062;</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>&#x2062;</mo>
                    <mrow>
                      <msub>
                        <mi>mask</mi>
                        <mi>RICA</mi>
                      </msub>
                      <mo>&#x2061;</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mrow>
                            <mi>i</mi>
                            <mo>-</mo>
                            <mrow>
                              <mi>&#x394;</mi>
                              <mo>&#x2062;</mo>
                              <mstyle>
                                <mspace width="0.3em" height="0.3ex"/>
                              </mstyle>
                              <mo>&#x2062;</mo>
                              <mi>i</mi>
                            </mrow>
                          </mrow>
                          <mo>,</mo>
                          <mrow>
                            <mi>j</mi>
                            <mo>-</mo>
                            <mrow>
                              <mi>&#x394;</mi>
                              <mo>&#x2062;</mo>
                              <mstyle>
                                <mspace width="0.3em" height="0.3ex"/>
                              </mstyle>
                              <mo>&#x2062;</mo>
                              <mi>j</mi>
                            </mrow>
                          </mrow>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>}</mo>
              </mrow>
              <mn>2</mn>
            </msup>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>3</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0053" num="0052">In Expression (3), MR(&#x394;i,&#x394;j) denotes a degree of divergence between mask<sub>LICA </sub>(i,j) and &#x3b1;Rmask<sub>RICA </sub>(i&#x2212;&#x394;i,j&#x2212;&#x394;j). Further, &#x3b1; denotes a correcting coefficient used for correcting changes in the luminance caused by the conditions under which the images have been taken, between the image of the right internal carotid artery and the image of the left internal carotid artery. Further, N denotes the image size.</p>
<p id="p-0054" num="0053">The displacement detecting unit <b>1</b><i>f </i>searches for such a value of (&#x394;i,&#x394;j) that makes the value of MR(&#x394;i,&#x394;j) smallest, while varying the value of (&#x394;i,&#x394;j) by using an iterative algorithm. After that, the displacement detecting unit <b>1</b><i>f </i>forwards the value of (&#x394;i,&#x394;j) that has been found in the search to the registration unit <b>1</b><i>g</i>, as a displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>). In the present example, to simplify the explanation, a situation in which the displacement in a two-dimensional direction is detected is explained; however, it is desirable to further detect a displacement in a rotational direction.</p>
<p id="p-0055" num="0054">Subsequently, the affine transformation unit <b>1</b><i>e </i>reads the capillary vessel phase image of the right internal carotid artery expressed as DSA<sub>RICA</sub>(i,j) from the storage unit and generates an inverted image expressed as RDSA<sub>RICA</sub>(i,j) obtained by applying a left/right inversion to DSA<sub>RICA</sub>(i,j) that has been read (step S<b>107</b>). After that, the affine transformation unit <b>1</b><i>e </i>stores RDSA<sub>RICA</sub>(i,j) that has been generated into the storage unit.</p>
<p id="p-0056" num="0055">Subsequently, the registration unit <b>1</b><i>g </i>reads RDSA<sub>RICA</sub>(i,j) from the storage unit. Further, the registration unit <b>1</b><i>g </i>generates a corrected inverted image expressed as RDSA<sub>RICA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) obtained by correcting RDSA<sub>RICA</sub>(i,j), based on the displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>) that has been forwarded from the displacement detecting unit <b>1</b><i>f </i>(step S<b>108</b>). After that, the registration unit <b>1</b><i>g </i>forwards RDSA<sub>RICA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that has been generated to the index image generating unit <b>1</b><i>h. </i></p>
<p id="p-0057" num="0056">Subsequently, the index image generating unit <b>1</b><i>h </i>reads the capillary vessel phase image of the left internal carotid artery expressed as DSA<sub>LICA</sub>(i,j) from the storage unit. After that, the index image generating unit <b>1</b><i>h </i>generates a difference image between DSA<sub>LICA</sub>(i,j) that has been read and RDSA<sub>RICA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that has been forwarded from the registration unit <b>1</b><i>g</i>, as an index image indicating an index for the bloodstreams (step S<b>109</b>).</p>
<p id="p-0058" num="0057">For example, the index image generating unit <b>1</b><i>h </i>generates a difference image expressed as PF<sub>LICA-RICA</sub>(i,j) by subtracting RDSA<sub>RICA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) from DSA<sub>LiCA</sub>(i,j) as shown in Expression (4) below:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>PF</i><sub>LICA-RICA</sub>(<i>i,j</i>)=<i>DSA</i><sub>LICA</sub>(<i>i,j</i>)&#x2212;<i>RDSA</i><sub>RICA</sub>(<i>i&#x2212;&#x394;i</i><sub>0</sub><i>,j&#x2212;&#x394;j</i><sub>0</sub>)&#x2003;&#x2003;(4)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0059" num="0058">After that, the index image generating unit <b>1</b><i>h </i>displays PF<sub>LICA-RICA</sub>(i,j) that has been generated on the display unit <b>1</b><i>b </i>(step S<b>110</b>). In this situation, the index image generating unit <b>1</b><i>h </i>may display PF<sub>LICA-RICA</sub>(i,j) as a black-and-white image or as a color image.</p>
<p id="p-0060" num="0059">For example, in the case where there is no infarction site at all, the bloodstreams on the left and on the right are substantially the same as each other. Thus, the index image is an image that is substantially uniform throughout the image. In other words, the pixel value of each of all the pixels in PF<sub>LICA-RICA</sub>(i,j) is &#x201c;0&#x201d;. In contrast, in the case where an infarction has occurred in the right internal carotid artery system, a high positive signal is detected in a region that is positioned bilaterally symmetric to the infarction site, within PF<sub>LICA-RICA</sub>(i,j).</p>
<p id="p-0061" num="0060">As explained above, according to the first embodiment, for example, the affine transformation unit <b>1</b><i>e </i>generates the inverted image expressed as Rmask<sub>RICA</sub>(i,j) obtained by applying a left/right inversion to the mask image of the right internal carotid artery expressed as mask<sub>RICA</sub>(i,j) and generates the inverted image expressed as RDSA<sub>RICA</sub>(i,j) obtained by applying a left/right inversion to the capillary vessel phase image of the right internal carotid artery expressed as DSA<sub>RICA</sub>(i,j). Further, the displacement detecting unit <b>1</b><i>f </i>detects the displacement between the mask image of the left internal carotid artery expressed as mask<sub>LICA</sub>(i,j) and the inverted image expressed as Rmask<sub>RICA</sub>(i,j) that has been generated by the affine transformation unit <b>1</b><i>e</i>. Further, the registration unit <b>1</b><i>g </i>generates the corrected inverted image expressed as RDSA<sub>RICA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) obtained by correcting the inverted image expressed as RDSA<sub>RICA</sub>(i,j), based on the detected displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>). After that, the index image generating unit <b>1</b><i>h </i>generates the difference image expressed as PF<sub>LICA-RICA</sub>(i,j) between the capillary vessel phase image of the left internal carotid artery expressed as DSA<sub>LICA</sub>(i,j) and the corrected inverted image expressed as RDSA<sub>RICA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>), as the index image indicating an index for the bloodstreams.</p>
<p id="p-0062" num="0061">Alternatively, another arrangement is acceptable in which the registration unit <b>1</b><i>g </i>generates a corrected image expressed as DSA<sub>LICA</sub>(i+&#x394;i<sub>0</sub>,j+&#x394;j<sub>0</sub>) obtained by correcting the capillary Vessel phase image of the left internal carotid artery expressed as DSA<sub>LICA</sub>(i,j), based on the displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>) that has been detected by the displacement detecting unit <b>1</b><i>f</i>. In that situation, the index image generating unit <b>1</b><i>h </i>generates, as an index image indicating an index for the bloodstreams, a difference image between the corrected image expressed as DSA<sub>LICA</sub>(i+&#x394;j<sub>0</sub>,j+&#x394;j<sub>0</sub>) and the inverted image expressed as RDSA<sub>RICA</sub>(i,j), as PF<sub>LICA-RICA</sub>(i,j).</p>
<p id="p-0063" num="0062">With the configuration described above, in the case where an infarction site has occurred in the right internal carotid artery system, the infarction site is shown with an emphasis in the difference image expressed as PF<sub>LICA-RICA</sub>(i,j). Consequently, it is possible to present, with a high level of precision, a lesion area of the examined subject within the medical images.</p>
<p id="p-0064" num="0063">In the exemplary embodiment described above, the example is explained in which the subtraction unit <b>1</b><i>d </i>identifies the frames that are in the capillary vessel phase, based on the selecting operation performed by the operator; however, the embodiment is not limited to this example. For example, another arrangement is acceptable in which the subtraction unit <b>1</b><i>d </i>automatically identifies the frames that are in the capillary vessel phase, without receiving the selecting operation from the operator.</p>
<p id="p-0065" num="0064">Normally, in the case where the injection period of a contrast media is 2 seconds, a large part of an artery is visualized within approximately 0.5 seconds from the start of the injection of the contrast media. For this reason, the subtraction unit <b>1</b><i>d </i>generates an arithmetic average image of the frames that are taken between 0.5 seconds later and 2.5 seconds later and extracts an artery part by performing threshold value processing on the generated arithmetic average image. Further, the subtraction unit <b>1</b><i>d </i>generates an arithmetic average image of the frames that are taken between 2 seconds earlier than the completion of an image-taking process and the completion time of the image-taking process. The subtraction unit <b>1</b><i>d </i>then extracts a vein part by performing threshold value processing on the generated arithmetic average image.</p>
<p id="p-0066" num="0065">After that, the subtraction unit <b>1</b><i>d </i>sets an area having a predetermined size around the center of the image as a Region Of Interest (ROI) and identifies the area within the ROI that is neither the artery part nor the vein part as a capillary vessel part. For example, an arrangement is acceptable in which the subtraction unit <b>1</b><i>d </i>has stored in advance, in a storage unit, information indicating an appropriate ROI for each of different Fields Of View (FOVS) (i.e., sizes of the viewing fields), so that the subtraction unit <b>1</b><i>d </i>can set the ROI based on the stored information.</p>
<p id="p-0067" num="0066">After the capillary vessel part has been identified in this manner, the subtraction unit <b>1</b><i>d </i>generates profiles for the area of the artery part, for the area of the vein part, and for the area of the capillary vessel part that are contained in DSA (i,j).</p>
<p id="p-0068" num="0067"><figref idref="DRAWINGS">FIG. 4</figref> is a chart depicting the profiles of the area of the artery part and the area of the vein part that have been generated by the subtraction unit <b>1</b><i>d </i>according to the first embodiment. In <figref idref="DRAWINGS">FIG. 4</figref>, the curve drawn with a solid line indicates the profile of the area of the artery part, whereas the curve drawn with a dashed line indicates the profile of the area of the vein part. Also, in <figref idref="DRAWINGS">FIG. 4</figref>, Ta denotes an artery phase, whereas Tv denotes a vein phase. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, in the profile of the area of the artery part, the pixel value increases in the artery phase, while no change is observed in the pixel value when the artery phase is over. In the profile of the area of the vein part, no change is observed in the pixel value for a certain period of time after the image taking process is started, although the pixel value subsequently increases in the vein phase.</p>
<p id="p-0069" num="0068">Accordingly, for example, the subtraction unit <b>1</b><i>d </i>detects such a temporal phase within the profile of the area of the artery part where no change is observed after the pixel value has increased. Also, the subtraction unit <b>1</b><i>d </i>detects such a temporal phase within the profile of the area of the vein part where the pixel value increases. After that, the subtraction unit <b>1</b><i>d </i>sets the range between the two detected temporal phases as a capillary vessel phase Tc and identifies the frames corresponding to the capillary vessel phase Tc that has been set, as the frames that are in the capillary vessel phase.</p>
<p id="p-0070" num="0069">Further, in the description of the first embodiment above, the example is explained in which the index image generating unit <b>1</b><i>h </i>generates, as shown in Expression (4), the difference image expressed as PF<sub>LICA-RICA</sub>(i,j) by subtracting the inverted image expressed as RDSA<sub>RICA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that has been obtained by applying a left/right inversion to the capillary vessel phase image of the right internal carotid artery from the capillary vessel phase image of the left internal carotid artery expressed as DSA<sub>LICA</sub>(i,j); however, the embodiment is not limited to this example.</p>
<p id="p-0071" num="0070">Alternatively, another arrangement is acceptable in which, for example, the index image generating unit <b>1</b><i>h </i>generates a difference image expressed as PF<sub>RICA-LICA</sub>(i,j) by subtracting the inverted image expressed as RDSA<sub>LICA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j+&#x394;j<sub>0</sub>) that has been obtained by applying a left/right inversion to the capillary vessel phase image of the left internal carotid artery from the capillary vessel phase image of the right internal carotid artery expressed as DSA<sub>RICA</sub>(i,j). In the PF<sub>RICA-LICA</sub>(i,j) image, in the case where an infarction has occurred in the right internal carotid artery system, a high negative signal is detected in the infarction site.</p>
<p id="p-0072" num="0071">In addition, it is also possible to obtain, for example, an index for the bloodstreams in the vertebral artery system. In that situation, the subtraction unit <b>1</b><i>d </i>generates a capillary vessel phase image of the right vertebral artery expressed as DSA<sub>RVA</sub>(i,j) and a capillary vessel phase image of the left vertebral artery expressed as DSA<sub>LVA</sub>(i,j).</p>
<p id="p-0073" num="0072">Subsequently, the affine transformation unit <b>1</b><i>e </i>reads a mask image of the right vertebral artery expressed as mask<sub>RVA</sub>(i,j) and a mask image of the left vertebral artery expressed as mask<sub>RVA</sub>(i,j) from the storage unit. Further, the affine transformation unit <b>1</b><i>e </i>generates an inverted image expressed as Rmask<sub>RVA</sub>(i,j) that is obtained by applying a left/right inversion to mask<sub>RVA</sub>(i,j). After that, the affine transformation unit <b>1</b><i>e </i>forwards mask<sub>LVA</sub>(i,j) and Rmask<sub>RVA</sub>(i,j) to the displacement detecting unit <b>1</b><i>f. </i></p>
<p id="p-0074" num="0073">Subsequently, the displacement detecting unit <b>1</b><i>f </i>detects a displacement between mask<sub>LVA</sub>(i,j) and Rmask<sub>RVA</sub>(i,j) that have been forwarded from the affine transformation unit <b>1</b><i>e</i>. For example, the displacement detecting unit <b>1</b><i>f </i>detects the displacement between mask<sub>LVA</sub>(i,j) and Rmask<sub>RVA</sub>(i,j) by using Expression (5) shown below:</p>
<p id="p-0075" num="0074">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>MR</mi>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mrow>
                <mi>&#x394;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>i</mi>
              </mrow>
              <mo>,</mo>
              <mrow>
                <mi>&#x394;</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>j</mi>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>&#x2211;</mo>
            <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>N</mi>
          </munderover>
          <mo>&#x2062;</mo>
          <mrow>
            <munderover>
              <mo>&#x2211;</mo>
              <mrow>
                <mi>j</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>N</mi>
            </munderover>
            <mo>&#x2062;</mo>
            <msup>
              <mrow>
                <mo>{</mo>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>mask</mi>
                      <mi>LVA</mi>
                    </msub>
                    <mo>&#x2061;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>,</mo>
                        <mi>j</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>-</mo>
                  <mrow>
                    <mi>&#x3b1;</mi>
                    <mo>&#x2062;</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>&#x2062;</mo>
                    <mi>R</mi>
                    <mo>&#x2062;</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>&#x2062;</mo>
                    <mrow>
                      <msub>
                        <mi>mask</mi>
                        <mi>RVA</mi>
                      </msub>
                      <mo>&#x2061;</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mrow>
                            <mi>i</mi>
                            <mo>-</mo>
                            <mrow>
                              <mi>&#x394;</mi>
                              <mo>&#x2062;</mo>
                              <mstyle>
                                <mspace width="0.3em" height="0.3ex"/>
                              </mstyle>
                              <mo>&#x2062;</mo>
                              <mi>i</mi>
                            </mrow>
                          </mrow>
                          <mo>,</mo>
                          <mrow>
                            <mi>j</mi>
                            <mo>-</mo>
                            <mrow>
                              <mi>&#x394;</mi>
                              <mo>&#x2062;</mo>
                              <mstyle>
                                <mspace width="0.3em" height="0.3ex"/>
                              </mstyle>
                              <mo>&#x2062;</mo>
                              <mi>j</mi>
                            </mrow>
                          </mrow>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>}</mo>
              </mrow>
              <mn>2</mn>
            </msup>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>5</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0076" num="0075">In Expression (5), MR(&#x394;i,&#x394;j) denotes a degree of divergence between mask<sub>LvA</sub>(i,j) and &#x3b1;Rmask<sub>RVA</sub>(i&#x2212;&#x394;i,j&#x2212;&#x394;i). Further, &#x3b1; denotes a correcting coefficient used for correcting changes in the luminance caused by the conditions under which the images have been taken, between the image of the right vertebral artery and the image of the left vertebral artery. Further, N denotes the image size.</p>
<p id="p-0077" num="0076">The displacement detecting unit <b>1</b><i>f </i>searches for such a value of (&#x394;i,&#x394;j) that makes the value of MR(&#x394;i,&#x394;j) smallest, while varying the value of (&#x394;i,&#x394;j) by using an iterative algorithm. After that, the displacement detecting unit <b>1</b><i>f </i>forwards the value of (&#x394;i,&#x394;j) that has been found in the search to the registration unit <b>1</b><i>g</i>, as the displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>).</p>
<p id="p-0078" num="0077">Subsequently, the affine transformation unit <b>1</b><i>e </i>reads the capillary vessel phase image of the right vertebral artery expressed as DSA<sub>RVA</sub>(i,j) from the storage unit and generates an inverted image expressed as RDSA<sub>RVA</sub>(i,j) obtained by applying a left/right inversion to DSA<sub>RVA</sub>(i,j) that has been read. After that, the affine transformation unit <b>1</b><i>e </i>stores RDSA<sub>RVA</sub>(i,j) that has been generated into the storage unit.</p>
<p id="p-0079" num="0078">Subsequently, the registration unit <b>1</b><i>g </i>reads RDSA<sub>RVA</sub>(i,j) from the storage unit. Further, the registration unit <b>1</b><i>g </i>generates a corrected inverted image expressed as RDSA<sub>RVA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) obtained by correcting RDSA<sub>RVA</sub>(i,j), based on the displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>) that has been forwarded from the displacement detecting unit <b>1</b><i>f</i>. After that, the registration unit <b>1</b><i>g </i>forwards RDSA<sub>RVA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that has been generated to the index image generating unit <b>1</b><i>h. </i></p>
<p id="p-0080" num="0079">Subsequently, the index image generating unit <b>1</b><i>h </i>reads the capillary vessel phase image of the left vertebral artery expressed as DSA<sub>LVA</sub>(i,j) from the storage unit. After that, the index image generating unit <b>1</b><i>h </i>generates a difference image between DSA<sub>LVA</sub>(i,j) that has been read and RDSA<sub>RVA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that has been forwarded from the registration unit <b>1</b><i>g</i>, as an index image indicating an index for the bloodstreams.</p>
<p id="p-0081" num="0080">For example, the index image generating unit <b>1</b><i>h </i>generates a difference image expressed as PF<sub>LVA-RVA</sub>(i,j) by subtracting RDSA<sub>RVA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) from DSA<sub>LVA</sub>(i,j) as shown in Expression (6) below:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>PF</i><sub>LVA-RVA</sub>(<i>i,j</i>)=<i>DSA</i><sub>LVA</sub>(<i>i,j</i>)&#x2212;<i>RDSA</i><sub>RVA</sub>(<i>i&#x2212;&#x394;i</i><sub>0</sub><i>,j&#x2212;&#x394;j</i><sub>0</sub>)&#x2003;&#x2003;(6)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0082" num="0081">Alternatively, another arrangement is acceptable in which, for example, the index image generating unit <b>1</b><i>h </i>generates a difference image expressed as PF<sub>RVA-LVA</sub>(i,j) by subtracting an inverted image expressed as RDSA<sub>LVA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j+&#x394;j<sub>0</sub>) that has been obtained by applying a left/right inversion to the capillary vessel phase image of the left vertebral artery from the capillary vessel phase image of the right vertebral artery expressed as DSA<sub>RVA</sub>(i,j).</p>
<p id="p-0083" num="0082">The combinations of the images and the effects of the index images that have been explained above can be summarized as shown in Table 1 below. In Table 1, the images in the &#x201c;mask&#x201d; column and the images in the &#x201c;Rmask&#x201d; column are used by the displacement detecting unit <b>1</b><i>f </i>to detect the displacements. Further, either the image in the &#x201c;DSA&#x201d; column or the image in the &#x201c;RDSA&#x201d; column is corrected by the registration unit <b>1</b><i>g</i>. The images shown in the &#x201c;DSA&#x201d; column and the images shown in the &#x201c;RDSA&#x201d; column are used by the index image generating unit <b>1</b><i>h </i>to generate the difference images. These images are obtained during a check-up imaging process that is performed on the blood vessels as a routine, after the treatment has been completed. Consequently, the burdens on the patients that are caused by contrast medias or radiation exposure doses do not increase.</p>
<p id="p-0084" num="0083">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="6">
<colspec colname="1" colwidth="49pt" align="center"/>
<colspec colname="2" colwidth="42pt" align="center"/>
<colspec colname="3" colwidth="49pt" align="center"/>
<colspec colname="4" colwidth="42pt" align="center"/>
<colspec colname="5" colwidth="49pt" align="center"/>
<colspec colname="6" colwidth="91pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="6" rowsep="1">TABLE 1</entry>
</row>
<row>
<entry namest="1" nameend="6" align="center" rowsep="1"/>
</row>
<row>
<entry>PF</entry>
<entry>mask</entry>
<entry>Rmask</entry>
<entry>DSA</entry>
<entry>RDSA</entry>
<entry>Effects</entry>
</row>
<row>
<entry namest="1" nameend="6" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>PF<sub>LICA-RICA </sub>(i, j)</entry>
<entry>mask<sub>LICA </sub>(i, j)</entry>
<entry>Rmask<sub>RICA </sub>(i, j)</entry>
<entry>DSA<sub>LICA </sub>(i, j)</entry>
<entry>RDSA<sub>RICA </sub>(i, j)</entry>
<entry>The difference in the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>bloodstreams in the right brain</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>through the right internal</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>carotid artery system, from the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>bloodstreams in the left brain</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>through the left internal</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>carotid artery system</entry>
</row>
<row>
<entry>PF<sub>RICA-LICA </sub>(i, j)</entry>
<entry>mask<sub>RICA </sub>(i, j)</entry>
<entry>Rmask<sub>LICA </sub>(i, j)</entry>
<entry>DSA<sub>RICA </sub>(i, j)</entry>
<entry>RDSA<sub>LICA </sub>(i, j)</entry>
<entry>The difference in the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>bloodstreams in the left brain</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>through the left internal</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>carotid artery system, from the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>bloodstreams in the right brain</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>through the right internal</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>carotid artery system</entry>
</row>
<row>
<entry>PF<sub>LVA-RVA </sub>(i, j)</entry>
<entry>mask<sub>LVA </sub>(i, j)</entry>
<entry>Rmask<sub>RVA </sub>(i, j)</entry>
<entry>DSA<sub>LVA </sub>(i, j)</entry>
<entry>RDSA<sub>RVA </sub>(i, j)</entry>
<entry>The difference in the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>bloodstreams in the left and</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>right brains through the right</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>vertebral artery system, from</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>the bloodstreams in the left and</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>right brains through the left</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>vertebral artery system</entry>
</row>
<row>
<entry>PF<sub>RVA-LVA </sub>(i, j)</entry>
<entry>mask<sub>RVA </sub>(i, j)</entry>
<entry>Rmask<sub>LVA </sub>(i, j)</entry>
<entry>DSA<sub>RVA </sub>(i, j)</entry>
<entry>RDSA<sub>LVA </sub>(i, j)</entry>
<entry>The difference in the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>bloodstreams in the left and</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>right brains through the left</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>vertebral artery system, from</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>the bloodstreams in the left and</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>right brains through the right</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>vertebral artery system</entry>
</row>
<row>
<entry namest="1" nameend="6" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0085" num="0084">The left and the right vertebral arteries supply blood to the left brain and to the right brain at the same time. For this reason, another arrangement is acceptable in which, for example, an index image for the bloodstreams is generated only from one of the images i.e., either an image of the right vertebral artery or an image of the left vertebral artery, instead of using both of the images.</p>
<p id="p-0086" num="0085">In that situation, for example, the affine transformation unit <b>1</b><i>e </i>generates the inverted image expressed as Rmask<sub>RVA</sub>(i,j) by applying a left/right inversion to the mask image of the right vertebral artery expressed as mask<sub>RVA</sub>(i,j). After that, the displacement detecting unit <b>1</b><i>f </i>detects the displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>) between mask<sub>RVA</sub>(i,j) and Rmask<sub>RVA</sub>(i,j).</p>
<p id="p-0087" num="0086">Subsequently, the affine transformation unit <b>1</b><i>e </i>generates the inverted image RDSA<sub>RVA</sub>(i,j) obtained by applying a left/right inversion to the capillary vessel phase image of the right vertebral artery expressed as DSA<sub>RVA</sub>(i,j). Further, the registration unit <b>1</b><i>g </i>generates a corrected inverted image expressed as RDSA<sub>RVA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) obtained by correcting RDSA<sub>RVA</sub>(i,j), based on the displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>) that has been detected by the displacement detecting unit <b>1</b><i>f. </i></p>
<p id="p-0088" num="0087">After that, the index image generating unit <b>1</b><i>h </i>generates a difference image between the capillary vessel phase image of the right vertebral artery expressed as DSA<sub>RVA</sub>(i,j) and RDSA<sub>RVA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that has been generated by the registration unit <b>1</b><i>g</i>. For example, the index image generating unit <b>1</b><i>h </i>generates a difference image expressed as PF<sub>RVA</sub>(i,j) between the capillary vessel phase image of the right vertebral artery expressed as DSA<sub>RVA</sub>(i,j) and RDSA<sub>RVA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that has been generated by the registration unit <b>1</b><i>g</i>, by using Expression (7) shown below:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>PF</i><sub>RVA</sub>(<i>i,j</i>)=<i>DSA</i><sub>RVA</sub>(<i>i,j</i>)&#x2212;<i>RDSA</i><sub>RVA</sub>(<i>i&#x2212;&#x394;i</i><sub>0</sub><i>,j&#x2212;&#x394;j</i><sub>0</sub>)&#x2003;&#x2003;(7)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0089" num="0088">The pixel values of PF<sub>RVA</sub>(i,j) and PF<sub>LICA-RICA</sub>(i,j) are each expected to be an extremely small value and are therefore susceptible to impacts of noises. To cope with this situation, an arrangement is acceptable in which, for example, the spatial filter transforming unit <b>1</b><i>i </i>applies a spatial smoothing filter to PF<sub>RVA</sub>(i,j). With this arrangement, it is possible to eliminate, from PF<sub>RVA</sub>(i,j), noises that may be a cause of obstruction to diagnoses.</p>
<p id="p-0090" num="0089">Alternatively, by using the same method as described above, another arrangement is acceptable in which, for example, the index image generating unit <b>1</b><i>h </i>generates a difference image expressed as PF<sub>LVA</sub>(i,j) by subtracting the inverted image expressed as RDSA<sub>LvA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that has been obtained by applying a left/right inversion to the capillary vessel phase image of the left vertebral artery from the capillary vessel phase image of the left vertebral artery expressed as DSA<sub>LVA</sub>(i,j). In that situation, for example, the affine transformation unit <b>1</b><i>e </i>generates an inverted image expressed as Rmask<sub>LVA</sub>(i,j) by applying a left/right inversion to the mask image of the left vertebral artery expressed as mask<sub>LVA</sub>(i,j). Further, the displacement detecting unit <b>1</b><i>f </i>detects the displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>) between mask<sub>LVA</sub>(i,j) and Rmask<sub>LVA</sub>(i,j).</p>
<p id="p-0091" num="0090">Furthermore, similarly, it is also possible to generate an index image for the bloodstreams only from one of the images i.e., either an image of the right internal carotid artery or an image of the left internal carotid artery. In that situation, for example, the medical doctor presses the blood vessels positioned on the side that is not visualized using a contrast media by pressing the neck of the examined subject. As a result of the pressing, the blood pressure from the blood vessels that are being pressed becomes lower, so that the bloodstream starts flowing into the blood vessels on the opposite side, from the visualized blood vessels via the anterior communicating artery.</p>
<p id="p-0092" num="0091">Further, another arrangement is acceptable in which, for example, the index image generating unit <b>1</b><i>h </i>generates a difference image expressed as PF<sub>RICA</sub>(i,j) by subtracting the inverted image expressed as RDSA<sub>RICA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that has been obtained by applying a left/right inversion to the capillary vessel phase image of the right internal carotid artery from the capillary vessel phase image of the right internal carotid artery expressed as DSA<sub>RICA</sub>(i,j). In that situation, for example, the affine transformation unit <b>1</b><i>e </i>generates the inverted image expressed as Rmask<sub>RICA</sub>(i,j) by applying a left/right inversion to the mask image of the right internal carotid artery expressed as mask<sub>RICA</sub>(i,j). Further, the displacement detecting unit <b>1</b><i>f </i>detects the displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>) between mask<sub>RICA</sub>(i,j) and Rmask<sub>RICA</sub>(i,j).</p>
<p id="p-0093" num="0092">Further, yet another arrangement is acceptable in which, for example, the index image generating unit <b>1</b><i>h </i>generates a difference image expressed as PF<sub>LICA</sub>(i,j) by subtracting the inverted image expressed as RDSA<sub>LICA</sub>(i&#x2212;&#x394;<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that has been obtained by applying a left/right inversion to the capillary vessel phase image of the left internal carotid artery from the capillary vessel phase image of the left internal carotid artery expressed as DSA<sub>LICA</sub>(i,j). In that situation, for example, the affine transformation unit <b>1</b><i>e </i>generates the inverted image expressed as Rmask<sub>LICA</sub>(i,j) by applying a left/right inversion to the mask image of the left internal carotid artery expressed as mask<sub>LICA</sub>(i,j). Further, the displacement detecting unit <b>1</b><i>f </i>detects the displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>) between mask<sub>LICA</sub>(i,j) and Rmask<sub>LICA</sub>(i,j).</p>
<p id="p-0094" num="0093">As explained above, by using PF<sub>LICA</sub>(i,j) and PF<sub>LICA</sub>(i,j), it is possible to make a diagnosis regarding the bloodstreams into the left brain through the left internal carotid artery or regarding the bloodstreams into the right brain through the right internal carotid artery, by visualizing using a contrast media only one of the arteries i.e., either the left internal carotid artery or the right internal carotid artery. As a result, the contrast media does not have to be injected into the patient (who is the examined subject) more than once, and also, it is possible to make a diagnosis in a short period of time.</p>
<p id="p-0095" num="0094">Furthermore, in the description above, the example in which each of the four major blood vessel systems in the brain is visualized using a contrast media individually is explained; however, the embodiment is not limited to this example. For example, it is acceptable to visualize using a contrast media all the four major blood vessel systems at one time through the aorta. In that situation, the affine transformation unit <b>1</b><i>e </i>generates an inverted image expressed as Rmask<sub>A</sub>(i,j) by applying a left/right inversion to a mask image of each of the arteries expressed as mask<sub>A</sub>(i,j). Further, the displacement detecting unit <b>1</b><i>f </i>detects the displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>) between mask<sub>A</sub>(i,j) and Rmask<sub>A</sub>(i,j). After that, the index image generating unit <b>1</b><i>b </i>generates a difference image expressed as PF<sub>A</sub>(i,j) by subtracting an inverted image expressed as RDSA<sub>A</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that has been obtained by applying a left/right inversion to a capillary vessel phase image of each of the arteries, from the capillary vessel phase image of the corresponding one of the arteries expressed as DSA<sub>A</sub>(i,j). With this arrangement, by injecting a contrast media to the aorta only once, it is possible to make a diagnosis to determine whether an infarction has occurred in the blood vessel systems all at one time.</p>
<p id="p-0096" num="0095">The combinations of the images and the effects of the index images that have been explained above beneath Table 1 can be summarized as shown in Table 2 below. In Table 2, the images in the &#x201c;mask&#x201d; column and the images in the &#x201c;Rmask&#x201d; column are used by the displacement detecting unit <b>1</b><i>f </i>to detect the displacements. Further, either the image in the &#x201c;DSA&#x201d; column or the image in the &#x201c;RDSA&#x201d; column is corrected by the registration unit <b>1</b><i>g</i>. The images shown in the &#x201c;DSA&#x201d; column and the images shown in the &#x201c;RDSA&#x201d; column are used by the index image generating unit <b>1</b><i>h </i>to generate the difference images.</p>
<p id="p-0097" num="0096">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="6">
<colspec colname="1" colwidth="35pt" align="center"/>
<colspec colname="2" colwidth="42pt" align="center"/>
<colspec colname="3" colwidth="49pt" align="center"/>
<colspec colname="4" colwidth="42pt" align="center"/>
<colspec colname="5" colwidth="49pt" align="center"/>
<colspec colname="6" colwidth="105pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="6" rowsep="1">TABLE 2</entry>
</row>
<row>
<entry namest="1" nameend="6" align="center" rowsep="1"/>
</row>
<row>
<entry>PF</entry>
<entry>mask</entry>
<entry>Rmask</entry>
<entry>DSA</entry>
<entry>RDSA</entry>
<entry>Effects</entry>
</row>
<row>
<entry namest="1" nameend="6" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>PF<sub>LVA </sub>(i, j)</entry>
<entry>mask<sub>LVA </sub>(i, j)</entry>
<entry>Rmask<sub>LVA </sub>(i, j)</entry>
<entry>DSA<sub>LVA </sub>(i, j)</entry>
<entry>RDSA<sub>LVA </sub>(i, j)</entry>
<entry>The difference in the bloodstreams</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>through the left vertebral artery</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>system between in the left brain</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>and in the right brain</entry>
</row>
<row>
<entry>PF<sub>RVA </sub>(i, j)</entry>
<entry>mask<sub>RVA </sub>(i, j)</entry>
<entry>Rmask<sub>RVA </sub>(i, j)</entry>
<entry>DSA<sub>RVA </sub>(i, j)</entry>
<entry>RDSA<sub>RVA </sub>(i, j)</entry>
<entry>The difference in the bloodstreams</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>through the right vertebral artery</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>system between in the left brain</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>and in the right brain</entry>
</row>
<row>
<entry>PF<sub>RICA </sub>(i, j)</entry>
<entry>mask<sub>RICA </sub>(i, j)</entry>
<entry>Rmask<sub>RICA </sub>(i, j)</entry>
<entry>DSA<sub>RICA </sub>(i, j)</entry>
<entry>RDSA<sub>RICA </sub>(i, j)</entry>
<entry>The difference in the bloodstreams</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>in the left brain through the right</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>internal carotid artery system from</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>the bloodstreams in the right brain</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>through the right internal carotid</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>artery system (while the left</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>internal carotid artery is being</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>pressed)</entry>
</row>
<row>
<entry>PF<sub>LICA </sub>(i, j)</entry>
<entry>mask<sub>LICA </sub>(i, j)</entry>
<entry>Rmask<sub>LICA </sub>(i, j)</entry>
<entry>DSA<sub>LICA </sub>(i, j)</entry>
<entry>RDSA<sub>LICA </sub>(i, j)</entry>
<entry>The difference in the bloodstreams</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>in the left brain through the left</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>internal carotid artery system from</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>the bloodstreams in the right brain</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>through the left internal carotid</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>artery system (while the right</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>internal carotid artery is being</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>pressed)</entry>
</row>
<row>
<entry>PF<sub>A </sub>(i, j)</entry>
<entry>mask<sub>A </sub>(i, j)</entry>
<entry>Rmask<sub>A </sub>(i, j)</entry>
<entry>DSA<sub>A </sub>(i, j)</entry>
<entry>RDSA<sub>A </sub>(i, j)</entry>
<entry>The difference between the blood</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>streams in the left brain and in</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>the right brain through the artery</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>system</entry>
</row>
<row>
<entry namest="1" nameend="6" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0098" num="0097">As explained above, for example, the affine transformation unit <b>1</b><i>e </i>generates the inverted image expressed as Rmask<sub>RVA</sub>(i,j) obtained by applying a left/right inversion to the mask image of the right vertebral artery expressed as mask<sub>RVA</sub>(i,j) and generates the inverted image expressed as RDSA<sub>RVA</sub>(i,j) obtained by applying a left/right inversion to the capillary vessel phase image of the right vertebral artery expressed as DSA<sub>RVA</sub>(i,j). Further, the displacement detecting unit <b>1</b><i>f </i>detects the displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>) between the mask image of the right vertebral artery expressed as mask<sub>RVA</sub>(i,j) and the inverted image expressed as Rmask<sub>RVA</sub>(i,j). Further, the registration unit <b>1</b><i>g </i>generates the corrected inverted image expressed as RDSA<sub>RVA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) obtained by correcting the inverted image expressed as RDSA<sub>RVA</sub>(i,j), based on the detected displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>). After that, the index image generating unit <b>1</b><i>h </i>generates the difference image expressed as PF<sub>RVA</sub>(i,j) between the capillary vessel phase image of the right vertebral artery expressed as DSA<sub>RVA</sub>(i,j) and the inverted image expressed as RDSA<sub>RVA</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>), as the index image indicating an index for the bloodstreams.</p>
<p id="p-0099" num="0098">Alternatively, another arrangement is acceptable in which the registration unit <b>1</b><i>g </i>generates a corrected image expressed as DSA<sub>RVA</sub>(i+&#x394;i<sub>0</sub>,j+&#x394;j<sub>0</sub>) obtained by correcting the capillary vessel phase image of the right vertebral artery expressed as DSA<sub>RVA</sub>(i,j), based on the displacement expressed as (&#x394;i<sub>0</sub>,&#x394;j<sub>0</sub>) that has been detected by the displacement detecting unit <b>1</b><i>f</i>. In that situation, the index image generating unit <b>1</b><i>h </i>generates a difference image between the corrected image expressed as DSA<sub>RVA</sub>(i+&#x394;i<sub>0</sub>,j+&#x394;j<sub>0</sub>) and the inverted image expressed as RDSA<sub>RVA</sub>(i,j), as PF<sub>RVA</sub>(i,j).</p>
<p id="p-0100" num="0099">With the configuration described above, it is possible to reduce the burden on the patient who is the examined subject, because it is possible to obtain the index image indicating an index for the bloodstreams by visualizing using a contrast media only one blood vessel. In addition, it is also possible to shorten the time period it takes to make the diagnosis.</p>
<p id="p-0101" num="0100">In the description of the first embodiment above, the example is explained in which the capillary vessel phase image is generated by calculating the arithmetic average of the capillary vessel phase frames that have been identified out of the plurality of DSA images taken in a time sequence so that the difference image between the capillary vessel phase image and the inverted image obtained by applying an inversion to the capillary vessel phase image is generated. In other words, according to the first embodiment, the capillary vessel phase image and the inverted image being used are taken at mutually the same point in time at which a certain period of time has elapsed since the contrast media was injected into the examined subject.</p>
<p id="p-0102" num="0101">However, in the case where, for example, an infarction has occurred either in a blood vessel positioned on the right side of the brain or in a blood vessels positioned on the left side of the brain, there is a possibility that the point in time at which the blood vessels positioned on the right side are visualized using a contrast media may be different from the point in time at which the blood vessels positioned on the left side are visualized using a contrast media. To cope with this situation, an arrangement is acceptable in which, for example, a difference image is generated after the time difference between the left and the right is corrected based on profiles related to contrast media densities. In the following sections, an example in which the time difference between the left and the right is corrected will be explained as a second embodiment.</p>
<p id="p-0103" num="0102">In the second embodiment, the subtraction unit <b>1</b><i>d </i>generates a plurality of DSA images of the right internal carotid artery expressed as DSA<sub>RICAn</sub>(i,j) by generating a difference image between each of a plurality of contrast images expressed as contrast<sub>RICAn</sub>(i,j) that have sequentially been taken after the right internal carotid artery is visualized using a contrast media and the mask image of the right internal carotid artery expressed as mask<sub>RICA</sub>(i,j). Also, the subtraction unit <b>1</b><i>d </i>generates a plurality of DSA images of the left internal carotid artery expressed as DSA<sub>LICAn</sub>(i,j) by generating a difference image between each of a plurality of contrast images expressed as contrast<sub>LICAn</sub>(i,j) that have sequentially been taken after the left internal carotid artery is visualized using a contrast media and the mask image of the left internal carotid artery, expressed as mask<sub>LICA</sub>(i,j).</p>
<p id="p-0104" num="0103">Further, the affine transformation unit <b>1</b><i>e </i>generates an inverted image expressed as Rmask<sub>RICA</sub>(i,j) obtained by applying a left/right inversion to mask<sub>RICA</sub>(i,j) and generates a plurality of inverted images expressed as RDSA<sub>RICAn</sub>(i,j) obtained by inverting the plurality of images expressed as DSA<sub>RICAn</sub>(i,j) that have been generated by the subtraction unit <b>1</b><i>d</i>. Further, in the same manner as in the first embodiment, the displacement detecting unit <b>1</b><i>f </i>detects a displacement between mask<sub>LICA</sub>(i,j) and Rmask<sub>RICA</sub>(i,j).</p>
<p id="p-0105" num="0104">Further, based on the displacement that has been detected by the displacement detecting unit <b>1</b><i>f</i>, the registration unit <b>1</b><i>g </i>generates a plurality of corrected images expressed as DSA<sub>LICAn</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that are obtained by correcting the plurality of images expressed as DSA<sub>LICAn</sub>(i,j) that have been generated by the subtraction unit <b>1</b><i>d</i>. Alternatively, another arrangement is acceptable in which the registration unit <b>1</b><i>g </i>generates a plurality of corrected inverted images expressed as RDSA<sub>RICAn</sub>(i+&#x394;i<sub>0</sub>,j+&#x394;j<sub>0</sub>) that are obtained by correcting the plurality of images expressed as RDSA<sub>RICAn</sub>(i,j) that have been generated by the affine transformation unit <b>1</b><i>e. </i></p>
<p id="p-0106" num="0105">Further, with respect to an image group made up of the plurality of images expressed as RDSA<sub>RICAn</sub>(i,j) that have been generated by the affine transformation unit <b>1</b><i>e </i>and another image group made up of the plurality of images expressed as DSA<sub>RICAn</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that have been generated by the registration unit <b>1</b><i>g</i>, the index image generating unit <b>1</b><i>h </i>generates a difference image between these two image groups after correcting, for each set of pixels in mutually the same position, a time difference between a temporal change in the contrast media density in one of the image groups and a temporal change in the contrast media density in the other of the image groups. Alternatively, another arrangement is acceptable in which, with respect to an image group made up of the plurality of images expressed as DSA<sub>LICAn</sub>(i,j) that have been generated by the subtraction unit <b>1</b><i>d </i>and another image group made up of the plurality of images expressed as RDSA<sub>RICAn</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) that have been generated by the registration unit <b>1</b><i>g</i>, the index image generating unit <b>1</b><i>h </i>generates a difference image between these two image groups after correcting a time difference for each set of pixels in mutually the same position.</p>
<p id="p-0107" num="0106"><figref idref="DRAWINGS">FIGS. 5 to 7</figref> are charts for explaining a time difference correcting process and a difference image generating process that are performed by the index image generating unit <b>1</b><i>h </i>according to the second embodiment. In <figref idref="DRAWINGS">FIGS. 5 to 7</figref>, the vertical axis P expresses a contrast media density, whereas the horizontal axis t expresses an elapsed time period since a contrast media is injected into an examined subject. A curve <b>11</b> drawn with a solid line expresses a temporal change in the contrast media density in an image group made up of the images expressed as RDSA<sub>RICAn</sub>(i,j). Further, a curve <b>12</b> drawn with a broken line expresses a temporal change in the contrast media density in an image group made up of the images expressed as DSA<sub>LICAn</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>). The curve <b>11</b> and the curve <b>12</b> express the changes in the contrast media densities in positions that are bilaterally symmetric to each other in the brain. For example, in the case where an infarction has occurred in a blood vessel supplying blood to the left internal carotid artery, the left internal carotid artery is visualized using a contrast media later than the right internal carotid artery, as shown in <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0108" num="0107">In that situation, the index image generating unit <b>1</b><i>h </i>corrects the times of either RDSA<sub>RICAn</sub>(i,j) or DSA<sub>LICAn</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) in such a manner that the difference between the curve <b>11</b> and the curve <b>12</b> becomes smallest in a ROI which has predetermined size at center of image. For example, the index image generating unit <b>1</b><i>h </i>performs a correcting process to change the times of DSA<sub>LICAn</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) in such a manner that the difference between the curve <b>11</b> and the curve <b>12</b> becomes smallest in the ROI, as shown in <figref idref="DRAWINGS">FIG. 6</figref>. For example, in the situation where the time of each of the images RDSA<sub>RICAn</sub>(i,j) is expressed as t<sub>0 </sub>whereas the time of each of the images DSA<sub>LICAn</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) is expressed as t<sub>0</sub>&#x2212;&#x394;t, the index image generating unit <b>1</b><i>h </i>calculates the degree of correlation between the curve <b>11</b> and the curve <b>12</b> while varying the value of &#x394;t. Further, by identifying such a value of &#x394;t that makes the degree of correlation between the curve <b>11</b> and the curve <b>12</b> highest, the index image generating unit <b>1</b><i>h </i>corrects the times of DSA<sub>LICAn</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>). A value of &#x394;t is determined with maximum frequency of &#x394;t in the ROI. Alternatively, the index image generating unit <b>1</b><i>h </i>may correct the times of RDSA<sub>RICAn</sub>(i,j).</p>
<p id="p-0109" num="0108">After that, the index image generating unit <b>1</b><i>h </i>extracts, for each set of pixels in mutually the same position, the maximum value among the differences between the contrast media densities in one of the image groups and the contrast media densities in the other of the image groups and generates a difference image by using the extracted maximum values. For example, as shown in <figref idref="DRAWINGS">FIG. 6</figref>, after correcting the times of DSA<sub>LICAn</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) in such a manner that the difference between the curve <b>11</b> and the curve <b>12</b> becomes smallest, the index image generating unit <b>1</b><i>h </i>calculates, for each set of pixels in mutually the same position, a difference in the contrast media densities between RDSA<sub>RICAn</sub>(i,j) and DSA<sub>LICAn</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>). After that, the index image generating unit <b>1</b><i>h </i>generates a difference image by using a maximum value d among the contrast media densities that has been calculated for each of the pixels. As a result, it is possible to obtain the difference image in which the part that has a large difference in the contrast media density between the left and the right is emphasized.</p>
<p id="p-0110" num="0109">Alternatively, another arrangement is acceptable in which the index image generating unit <b>1</b><i>h </i>calculates, for each set of pixels in mutually the same position, a total sum of the differences between the contrast media densities in one of the image groups and the contrast media densities in the other of the image groups and generates a difference image by using the calculated total sums. For example, as shown in <figref idref="DRAWINGS">FIG. 7</figref>, after correcting the times of DSA<sub>LICAn</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>) in such a manner that the difference between the curve <b>11</b> and the curve <b>12</b> becomes smallest, the index image generating unit <b>1</b><i>h </i>calculates, for each set of pixels in mutually the same position, a total sum S of differences in the contrast media densities between RDSA<sub>RICAn</sub>(i,j) and DSA<sub>LICAn</sub>(i&#x2212;&#x394;i<sub>0</sub>,j&#x2212;&#x394;j<sub>0</sub>). Subsequently, the index image generating unit <b>1</b><i>h </i>generates a difference image by using the total sum S of the differences in the contrast media densities that has been calculated for each of the pixels. As a result, it is possible to obtain the difference image in which the part that has a large difference in the contrast media density between the left and the right is emphasized.</p>
<p id="p-0111" num="0110">Alternatively, another arrangement is acceptable in which, with respect to an image group made up of the plurality of images expressed as DSA<sub>LICAn</sub>(i,j) and another image group made up of the plurality of images expressed as RDSA<sub>RICAn</sub>(i,j), the index image generating unit <b>1</b><i>h </i>generates a difference image between these two image groups after correcting the time difference between these two image groups.</p>
<p id="p-0112" num="0111">As explained above, according to the second embodiment, the difference image is generated after the time difference between the left and the right is corrected based on the profiles related to the contrast media densities, it is possible to render a lesion area of the examined subject in a medical image, with a higher level of precision. In the description above, the example in which the time difference between the left and the right is corrected based on the profiles related to the contrast media densities is explained; however, another arrangement is acceptable in which, for example, the time difference between the left and the right is corrected based on profiles related to speeds at which the contrast media densities change.</p>
<p id="p-0113" num="0112">In the description of the second embodiment above, the example is explained in which, as shown in <figref idref="DRAWINGS">FIGS. 6 and 7</figref>, the contrast media densities on the left and on the right change in such a manner that the curve <b>11</b> and the curve <b>12</b> intersect each other in the latter half portion where the contrast media densities become lower; however, there may be a situation in which the curve <b>11</b> and the curve <b>12</b> do not intersect each other in the latter half portion, if the time period of visualizing using a contrast media is significantly different between the left and the right. In that situation, another arrangement is acceptable in which, for example, after correcting the time differences of the images in such a manner that the difference between the curve <b>11</b> and the curve <b>12</b> becomes smallest, the index image generating unit <b>1</b><i>h </i>calculates either the maximum value d or the total sum S of the differences in the contrast media densities in the time period before one of the curves reaches a peak.</p>
<p id="p-0114" num="0113">Furthermore, in the description of the second embodiment above, the example in which the DSA images of both the right internal carotid artery and the left internal carotid artery are used is explained. It is, however, possible to similarly implement the second embodiment described above by, for example, using the DSA images of either the right internal carotid artery or the left internal carotid artery, or using the DSA images of one or both of the right vertebral artery and the left vertebral artery.</p>
<p id="p-0115" num="0114">While certain embodiments have been described, these embodiments have been presented by way of example only, and are not intended to limit the scope of the inventions. Indeed, the novel embodiments described herein may be embodied in a variety of other forms; furthermore, various omissions, substitutions and changes in the form of the embodiments described herein may be made without departing from the spirit of the inventions. The accompanying claims and their equivalents are intended to cover such forms or modifications as would fall within the scope and spirit of the inventions.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08625872-20140107-M00001.NB">
<img id="EMI-M00001" he="7.03mm" wi="76.20mm" file="US08625872-20140107-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08625872-20140107-M00002.NB">
<img id="EMI-M00002" he="12.02mm" wi="76.20mm" file="US08625872-20140107-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08625872-20140107-M00003.NB">
<img id="EMI-M00003" he="9.14mm" wi="76.20mm" file="US08625872-20140107-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US08625872-20140107-M00004.NB">
<img id="EMI-M00004" he="9.14mm" wi="76.20mm" file="US08625872-20140107-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A medical image processing apparatus comprising:
<claim-text>an image inverting unit obtaining a masking image for a first medical image that generates a first inverted image obtained by inverting the first medical image in a left-and-right direction of an examined subject and generates a second inverted image obtained by inverting a second medical image that is different from the first medical image in the left-and-right direction of the examined subject;</claim-text>
<claim-text>a displacement detecting unit that detects a displacement between the first medical image and the first inverted image;</claim-text>
<claim-text>a registration unit that, based on the displacement that has been detected by the displacement detecting unit, generates one of a corrected image obtained by correcting the second medical image and a corrected inverted image obtained by correcting the second inverted image; and</claim-text>
<claim-text>a difference image generating unit that generates one of a difference image between the second inverted image and the corrected image and a difference image between the second medical image and the corrected inverted image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The medical image processing apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein
<claim-text>the first medical image is an X-ray image taken before a blood vessel is visualized using a contrast media, and</claim-text>
<claim-text>the second medical image is a difference image that has been generated from an X-ray image taken after the blood vessel is visualized using a contrast media and the first medical image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The medical image processing apparatus according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising: a medical image generating unit that generates a plurality of second medical images by generating a difference image between each of a plurality of X-ray images that are sequentially taken after the blood vessel is visualized using a contrast media and the first medical image, wherein
<claim-text>the image inverting unit generates the first inverted image and a plurality of second inverted images that are obtained by inverting the plurality of second medical images,</claim-text>
<claim-text>the registration unit, based on the displacement that has been detected by the displacement detecting unit, generates one of the following: a plurality of corrected images obtained by correcting the plurality of second medical images; and a plurality of corrected inverted images obtained by correcting the plurality of second inverted images, and</claim-text>
<claim-text>the difference image generating unit generates, either with respect to one image group made up of the plurality of second inverted images and another image group made of up the plurality of corrected images or with respect to one image group made up of the plurality of second medical images and another image group made up of the plurality of corrected inverted images, a difference image between the one image group and said another image group after correcting, for each set of pixels in a mutually same position, a time difference between a temporal change in a contrast media density in the one image group and a temporal change in a contrast media density in said another image group.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The medical image processing apparatus according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the difference image generating unit extracts, for each set of pixels in a mutually same position, a maximum value among differences between contrast media densities in the one image group and contrast media densities in said another image group and generates the difference image by using the extracted maximum values.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The medical image processing apparatus according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the difference image generating unit calculates, for each set of pixels in a mutually same position, a total sum of differences between contrast media densities in the one image group and contrast media densities in said another image group and generates the difference image by using the calculated total sums.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The medical image processing apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the medical image processing apparatus includes a X-ray computer tomography (CT) device and a magnetic resonance imaging (MRI) device.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A medical image processing apparatus comprising:
<claim-text>an image inverting unit obtaining a masking image for a first medical image that generates a first inverted image obtained by inverting the first medical image in a left-and-right direction of an examined subject and generates a second inverted image obtained by inverting, in the left-and-right direction of the examined subject, a second medical image that is taken by performing a procedure that forms a series of procedures together with a procedure for taking the first medical image;</claim-text>
<claim-text>a displacement detecting unit that detects a displacement between a third medical image that is different from the first medical image and the first inverted image;</claim-text>
<claim-text>a registration unit that, based on the displacement that has been detected by the displacement detecting unit, generates one of the following: a corrected image obtained by correcting a fourth medical image that is taken by performing a procedure that forms a series of procedures together with a procedure for taking the third medical image;</claim-text>
<claim-text>and a corrected inverted image obtained by correcting the second inverted image; and</claim-text>
<claim-text>a difference image generating unit that generates one of a difference image between the second inverted image and the corrected image and a difference image between the fourth medical image and the corrected inverted image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The medical image processing apparatus according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein
<claim-text>the first medical image is an X-ray image taken before a first blood vessel is visualized using a contrast media,</claim-text>
<claim-text>the second, medical image is a difference image that has been generated from an X-ray image taken after the first blood vessel is visualized using a contrast media and the first medical image,</claim-text>
<claim-text>the third medical image is an X-ray image taken before a second blood vessel that is different from the first blood vessel is visualized using a contrast media, and</claim-text>
<claim-text>the fourth medical image is a difference image that has been generated from an X-ray image taken after the second blood vessel is visualized using a contrast media and the third medical image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The medical image processing apparatus according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, further comprising: a medical image generating unit that generates a plurality of second medical images by generating a difference image between each of a plurality of X-ray images that are sequentially taken after the first blood vessel is visualized using a contrast media and the first medical image and generates a plurality of fourth medical images by generating a difference image between each of a plurality of X-ray images that are sequentially taken after the second blood vessel is visualized using a contrast media and the third medical image, wherein
<claim-text>the image inverting unit generates the first inverted image and a plurality of second inverted images that are obtained by inverting the plurality of second medical images,</claim-text>
<claim-text>the registration unit, based on the displacement that has been detected by the displacement detecting unit, generates one of the following: a plurality of corrected images obtained by correcting the plurality of fourth medical images; and a plurality of corrected inverted images obtained by correcting the plurality of second inverted images, and</claim-text>
<claim-text>the difference image generating unit generates, either with respect to one image group made up of the plurality of second inverted images and another image group made of up the plurality of corrected images or with respect to one image group made up of the plurality of fourth medical images and another image group made up of the plurality of corrected inverted images, a difference image between the one image group and said another image group after correcting, for each set of pixels in a mutually same position, a time difference between a temporal change in a contrast media density in the one image group and a temporal change in a contrast media density in said another image group.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The medical image processing apparatus according to <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the difference image generating unit extracts, for each set of pixels in a mutually same position, a maximum value among differences between contrast media densities in the one image group and contrast media densities in said another image group and generates the difference image by using the extracted maximum values.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The medical image processing apparatus according to <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the difference image generating unit calculates, for each set of pixels in a mutually same position, a total sum of differences between contrast media densities in the one image group and contrast media densities in said another image group and generates the difference image by using the calculated total sums.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The medical image processing apparatus according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the medical image processing apparatus includes a X-ray computer tomography (CT) device and a magnetic resonance imaging (MRI) device.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A medical image processing method comprising:
<claim-text>obtaining a masking image for a first medical image and generating a first inverted image obtained by inverting the first medical image in a left-and-right direction of an examine subject and generating a second inverted image obtained by inverting, in the left-and-right direction of the examined subject, a second medical image that is taken by performing a procedure that forms a series of procedures together with a procedure for taking the first medical image;</claim-text>
<claim-text>detecting a displacement between a third medical image that is different from the first medical image and the first inverted image; generating, based on the displacement that has been detected, one of the following: a corrected image obtained by correcting a fourth medical image that is taken by performing a procedure that forms a series of procedures together with a procedure for taking the third medical image;</claim-text>
<claim-text>and a corrected inverted image obtained by correcting the second inverted image; and</claim-text>
<claim-text>generating one of a difference image between the second inverted image and the corrected image and a difference image between the fourth medical image and the corrected inverted image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The medical image processing apparatus according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the medical image processing apparatus includes a X-ray computer tomography (CT) device and a magnetic resonance imaging (MRI) device.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A medical image processing method comprising:
<claim-text>obtaining a masking image for a first medical image and generating a first inverted image obtained by inverting the first medical image in a left-and-right direction of an examined subject and generating a second inverted image obtained by inverting, in the left-and-right direction of the examined subject, a second medical image that is taken by performing a procedure that forms a series of procedures together with a procedure for taking the first medical image;</claim-text>
<claim-text>detecting a displacement between a third medical image that is different from the first medical image and the first inverted image;</claim-text>
<claim-text>generating, based on the displacement that has been detected, one of the following: a corrected image obtained by correcting a fourth medical image that is taken by performing a procedure that forms a series of procedures together with a procedure for taking the third medical image; and a corrected inverted image obtained by correcting the second inverted image ; and</claim-text>
<claim-text>generating one of a difference image between the second inverted image and the corrected image and a difference image between the fourth medical image and the corrected inverted image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The medical image processing apparatus according to <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the medical image processing apparatus includes a X-ray computer tomography (CT) device and a magnetic resonance imaging (MRI) device.</claim-text>
</claim>
</claims>
</us-patent-grant>
