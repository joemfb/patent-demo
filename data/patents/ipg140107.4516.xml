<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625599-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625599</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13235598</doc-number>
<date>20110919</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<us-term-extension>116</us-term-extension>
<disclaimer>
<text>This patent is subject to a terminal disclaimer.</text>
</disclaimer>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>12</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>370392</main-classification>
<further-classification>370473</further-classification>
<further-classification>370474</further-classification>
</classification-national>
<invention-title id="d2e55">Method and system for dynamic secured group communication</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6038322</doc-number>
<kind>A</kind>
<name>Harkins</name>
<date>20000300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6215878</doc-number>
<kind>B1</kind>
<name>Harkins</name>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6484257</doc-number>
<kind>B1</kind>
<name>Ellis</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6590885</doc-number>
<kind>B1</kind>
<name>Jorgensen</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6611872</doc-number>
<kind>B1</kind>
<name>McCanne</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6678828</doc-number>
<kind>B1</kind>
<name>Pham et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6680922</doc-number>
<kind>B1</kind>
<name>Jorgensen</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6789118</doc-number>
<kind>B1</kind>
<name>Rao</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6798782</doc-number>
<kind>B1</kind>
<name>Caronni et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6826616</doc-number>
<kind>B2</kind>
<name>Larson et al.</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6839346</doc-number>
<kind>B1</kind>
<name>Kametani</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370389</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>6839759</doc-number>
<kind>B2</kind>
<name>Larson et al.</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>7509491</doc-number>
<kind>B1</kind>
<name>Wainner et al.</name>
<date>20090300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2002/0010866</doc-number>
<kind>A1</kind>
<name>McCullough et al.</name>
<date>20020100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2002/0136223</doc-number>
<kind>A1</kind>
<name>Ho</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2002/0188871</doc-number>
<kind>A1</kind>
<name>Noehring et al.</name>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2003/0053464</doc-number>
<kind>A1</kind>
<name>Chen et al.</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2003/0108041</doc-number>
<kind>A1</kind>
<name>Aysan et al.</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370389</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2003/0188159</doc-number>
<kind>A1</kind>
<name>Josset et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2004/0001508</doc-number>
<kind>A1</kind>
<name>Zheng et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370466</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>2009/0034557</doc-number>
<kind>A1</kind>
<name>Fluhrer et al.</name>
<date>20090200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00022">
<othercit>Derfler, Frank J., Jr. and Freed, Les, How Networks Work, Sep. 2000, Que Corporation, pp. 188-189.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>22</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>370389</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370392</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370393</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370396</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370397</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370400</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370409</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370471</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370473</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370474</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370475</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370476</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>8</number-of-drawing-sheets>
<number-of-figures>10</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>12210821</doc-number>
<date>20080915</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>8036221</doc-number>
</document-id>
</parent-grant-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13235598</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<continuation-in-part>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>10867266</doc-number>
<date>20040614</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>7509491</doc-number>
<date>20090324</date>
</document-id>
</parent-grant-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>12210821</doc-number>
</document-id>
</child-doc>
</relation>
</continuation-in-part>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120060029</doc-number>
<kind>A1</kind>
<date>20120308</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Fluhrer</last-name>
<first-name>Scott</first-name>
<address>
<city>North Attleboro</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Wainner</last-name>
<first-name>Warren Scott</first-name>
<address>
<city>Sterling</city>
<state>VA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Rowles</last-name>
<first-name>Sheela</first-name>
<address>
<city>Cupertino</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Kamarthy</last-name>
<first-name>Kavitha</first-name>
<address>
<city>Milpitas</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="005" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Khalid</last-name>
<first-name>Mohamed</first-name>
<address>
<city>Cary</city>
<state>NC</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="006" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Niazi</last-name>
<first-name>Haseeb</first-name>
<address>
<city>Cary</city>
<state>NC</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="007" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Sethi</last-name>
<first-name>Pratima</first-name>
<address>
<city>Maharashtra</city>
<country>IN</country>
</address>
</addressbook>
<residence>
<country>IN</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Fluhrer</last-name>
<first-name>Scott</first-name>
<address>
<city>North Attleboro</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Wainner</last-name>
<first-name>Warren Scott</first-name>
<address>
<city>Sterling</city>
<state>VA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Rowles</last-name>
<first-name>Sheela</first-name>
<address>
<city>Cupertino</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Kamarthy</last-name>
<first-name>Kavitha</first-name>
<address>
<city>Milpitas</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="005" designation="us-only">
<addressbook>
<last-name>Khalid</last-name>
<first-name>Mohamed</first-name>
<address>
<city>Cary</city>
<state>NC</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="006" designation="us-only">
<addressbook>
<last-name>Niazi</last-name>
<first-name>Haseeb</first-name>
<address>
<city>Cary</city>
<state>NC</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="007" designation="us-only">
<addressbook>
<last-name>Sethi</last-name>
<first-name>Pratima</first-name>
<address>
<city>Maharashtra</city>
<country>IN</country>
</address>
</addressbook>
</inventor>
</inventors>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Cisco Technology, Inc.</orgname>
<role>02</role>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Ngo</last-name>
<first-name>Ricky</first-name>
<department>2464</department>
</primary-examiner>
<assistant-examiner>
<last-name>Kao</last-name>
<first-name>Wei-Po</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A system and method directed to carrying out dynamic secured group communication is provided. The method includes: obtaining a first packet that includes a first header; forming a frame that includes the first header in encrypted form; combining the first header and the frame to form a second packet and forming a second header; encapsulating the second packet with the second header to form a third packet, and communicating the third packet into the second network from the second source node for termination to the second-destination node. The first header includes a first source address of a first source node of a first network, and a first destination address of a first destination node of the first network. The second header includes a second source address of a second source node of a second network, and a second destination address of a second destination node of the second network.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="147.40mm" wi="215.90mm" file="US08625599-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="200.32mm" wi="140.04mm" orientation="landscape" file="US08625599-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="218.44mm" wi="157.48mm" orientation="landscape" file="US08625599-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="242.15mm" wi="167.05mm" orientation="landscape" file="US08625599-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="230.29mm" wi="147.57mm" orientation="landscape" file="US08625599-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="240.54mm" wi="167.05mm" orientation="landscape" file="US08625599-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="233.60mm" wi="156.80mm" orientation="landscape" file="US08625599-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="218.44mm" wi="158.16mm" orientation="landscape" file="US08625599-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="222.42mm" wi="138.68mm" orientation="landscape" file="US08625599-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is a continuation of U.S. patent application Ser. No. 12/210,821, filed Sep. 15, 2008, entitled &#x201c;Method and System for Dynamic Secured Group Communication,&#x201d; which in turn is a continuation-in-part application of U.S. patent application Ser. No. 10/867,266, filed Jun. 14, 2004 (now U.S. Pat. No. 7,509,491, which issued on Mar. 24, 2009), the entirety of each of which is incorporated herein by reference.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">1. Field</p>
<p id="p-0004" num="0003">The present invention relates to communication and/or computer networks, and more particularly to Virtual Private Networks.</p>
<p id="p-0005" num="0004">2. Related Art</p>
<p id="p-0006" num="0005">A physical network, such as a service provider network topology, may include a large number of nodes. These nodes may include peripherally located provider edge routers, each of which couples to one or multiple customer edge routers. The customer edge routers, in turn, may couple to private local area networks associated with one or multiple customers. Typically, the service provider network selectively couples the local area networks to each other through links created between its provider edge routers.</p>
<p id="p-0007" num="0006">A Virtual Private Network (&#x201c;VPN&#x201d;) enables a secure exchange of certain traffic between nodes of the physical network without having to dedicate such nodes to only carrying out the secure exchange. The VPN enables such secure exchange by encrypting the certain traffic (&#x201c;secured traffic&#x201d;) to protect against eavesdropping and tampering by unauthorized parties. Because resources of the network are shared between the secured traffic and un-secured traffic, costs of using the resources are generally reduced for each of many users of the network.</p>
<heading id="h-0003" level="1">SUMMARY</heading>
<p id="p-0008" num="0007">A system and method directed to carrying out dynamic secured group communication is provided. The method includes obtaining a first packet that includes a first header. The first header includes a first source address of a first source node of a first network, and a first destination address of a first destination node of the first network. The method also includes forming a frame that includes the first header in encrypted form, combining the first header and the frame to form a second packet, and forming a second header. This second header includes a second source address of a second source node of a second network, and a second destination address of a second destination node of the second network. The method further includes encapsulating the second packet with the second header to form a third packet, and communicating the third packet into the second network from the second-source node for termination to the second-destination node.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0009" num="0008">So the manner in which the above recited features are attained and can be understood in detail, a more detailed description is described below with reference to Figures illustrated in the appended drawings.</p>
<p id="p-0010" num="0009">The Figures in the appended drawings, like the detailed description, are examples. As such, the Figures and the detailed description are not to be considered limiting, and other equally effective examples are possible and likely. Furthermore, like reference numerals in the Figures indicate like elements, and wherein:</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram illustrating a first example network architecture for carrying out a dynamic secured group communication;</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram illustrating a first structure of a communication packet for carrying out a dynamic secured group communication;</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 3</figref> is a flow diagram illustrating a first example communication flow for carrying out a dynamic secured group communication;</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram illustrating a second example network architecture for carrying out a dynamic secured group communication;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram illustrating a second example structure of a communication packet for carrying out a dynamic secured group communication;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 6</figref> is a flow diagram illustrating a second example communication flow for carrying out a dynamic secured group communication is shown;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 7</figref> is a flow diagram illustrating a third example communication flow for carrying out a dynamic secured group communication;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 8</figref> is a block diagram illustrating a tunnel packet formed in accordance with the authentication protocol;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 9</figref> is a block diagram illustrating a third example network architecture for carrying out a dynamic secured group communication; and</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 10</figref> is a block diagram illustrating an example network node for use with carrying out a dynamic secured group communication.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0021" num="0020">In the following detailed description, numerous specific details are set forth in order to provide a thorough understanding of exemplary embodiments or other examples described herein. However, it will be understood that these embodiments and examples may be practiced without the specific details. In other instances, well-known methods, procedures, components and circuits have not been described in detail, so as not to obscure the following description. Further, the embodiments and/or examples disclosed are for exemplary purposes only and other embodiments and/or examples may be employed in lieu of or in combination with of the embodiments disclosed. As summarized above and described in more detail below, a method and system for dynamic secured group communication is provided.</p>
<p id="p-0022" num="0021">Example Architecture</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram illustrating example network architecture <b>100</b> for carrying out a dynamic secured group communication. The network architecture <b>100</b> includes a non-publicly accessible (&#x201c;private&#x201d;) network <b>102</b>; four sub-networks (&#x201c;subnets&#x201d;), namely, a first subnet <b>104</b>, a second subnet <b>106</b>, a third subnet <b>108</b> and a fourth subnet <b>110</b>; and a virtual private network (&#x201c;VPN&#x201d;) <b>112</b>. The private network <b>102</b> may be, for example, an enterprise or service-provider managed wide-area network (&#x201c;WAN&#x201d;) that is adapted to interconnect the first, second, third and fourth subnets <b>104</b>-<b>110</b>, which may be local-area networks (&#x201c;LANs&#x201d;) residing at respective enterprise installations.</p>
<p id="p-0024" num="0023">Typically, the private network <b>102</b> includes a large number of network nodes; most of which are not shown for simplicity of exposition. As shown, the private network <b>102</b> includes four network nodes, namely, a first node <b>102</b><sub>1</sub>, a second node <b>102</b><sub>2</sub>, a third node <b>102</b><sub>3 </sub>and a fourth node <b>102</b><sub>4</sub>. The first, second, third and fourth nodes <b>102</b><sub>1</sub>, <b>102</b><sub>2</sub>, <b>102</b><sub>3 </sub>and <b>102</b><sub>4 </sub>(or referred to herein collectively as &#x201c;network nodes <b>102</b><sub>1</sub>-<b>102</b><sub>4</sub>&#x201d;) communicatively couple to the private network <b>102</b> and to the first, second, third and fourth subnets <b>104</b>, <b>106</b>, <b>108</b> and <b>110</b>, respectively. The network nodes <b>102</b><sub>1</sub>-<b>102</b><sub>4 </sub>may, for example, be embodied as and/or function as routers or, alternatively, gateways (collectively &#x201c;routers&#x201d;).</p>
<p id="p-0025" num="0024">In general, the network nodes <b>102</b><sub>1</sub>-<b>102</b><sub>4 </sub>route, transit or otherwise transport (collectively &#x201c;route&#x201d;) to the respective subnets <b>104</b>-<b>110</b> and/or forward traffic obtained from the private network <b>102</b> (&#x201c;network traffic&#x201d;). In addition, the network nodes <b>102</b><sub>1</sub>-<b>102</b><sub>4 </sub>route to the private network <b>102</b> traffic obtained from their respective subnets <b>104</b>-<b>110</b> (collectively &#x201c;subnet traffic&#x201d;).</p>
<p id="p-0026" num="0025">The VPN <b>112</b>, because it is partitioned from resources of, formed over, established within or via, etc. the private network <b>102</b>, may utilize some or all of the network nodes of the private network <b>102</b> as nodes (&#x201c;VPN nodes&#x201d;). For simplicity of exposition, however, the first, second, third and fourth nodes <b>102</b><sub>1</sub>-<b>102</b><sub>4 </sub>double as first, second, third and fourth VPN nodes <b>112</b><sub>1</sub>-<b>112</b><sub>4</sub>, respectively.</p>
<p id="p-0027" num="0026">The network architecture <b>100</b> also includes a security-management node <b>114</b> that communicatively couples to the private network <b>102</b>. The security-management node <b>114</b> may manage, administer and/or assist in establishing and/or maintaining the VPN <b>112</b>.</p>
<p id="p-0028" num="0027">The VPN <b>112</b> may, for example, function, operate and/or behave in accordance with descriptions and/or teachings provided in the above-incorporated U.S. patent application Ser. No. 10/867,266 filed Jun. 14, 2004 (now U.S. Pat. No. 7,509,491). Alternatively and/or additionally, the VPN <b>112</b> may function, operate and/or behave in accordance with descriptions and/or teachings provided in (i) <i>Cisco Group Encrypted Transport VPN </i>(<i>Cisco IOS Security Configuration Guide</i>), Cisco Systems, Inc. Nov. 17, 2006, (ii) <i>Cisco Group Encrypted Transport VPN Data Sheet and/or Technical Overview</i>, Cisco Systems, Inc., December 2006, all of which are incorporated herein by reference. In addition, the VPN <b>112</b> may include elements set forth in the above-incorporated descriptions and teachings that are not shown in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0029" num="0028">In accordance with the above-incorporated descriptions and teachings, the security-management node <b>114</b> includes information for configuring and/or provisioning the network nodes <b>102</b><sub>1</sub>-<b>102</b><sub>4 </sub>to function as the VPN nodes <b>112</b><sub>1</sub>-<b>112</b><sub>4</sub>. This information (&#x201c;VPN information&#x201d;) may include a security policy for the VPN <b>112</b> (&#x201c;VPN security policy&#x201d;).</p>
<p id="p-0030" num="0029">The VPN security policy may define one or more security policies for cryptographically securing one or more groups of subnet traffic, respectively, in accordance with group domain of interpretation (&#x201c;GDOI&#x201d;) as set forth in IETF RFC 3547 and above-incorporated descriptions and teachings. These security policies (&#x201c;group-security polices&#x201d;) may include, for example, first and second group-security policies.</p>
<p id="p-0031" num="0030">The first group-security policy may include a first cipher (or first set of ciphers) for cryptographically securing a first group of the subnet traffic (&#x201c;first group traffic&#x201d;). The second group-security policy may include a second cipher (or second set of ciphers) for cryptographically securing a second group of the subnet traffic (&#x201c;second group traffic&#x201d;). The security-management node <b>114</b> may be adapted to dynamically adjust the VPN security policy to include additional or to fewer group-security polices responsive to a need for cryptographically securing more or fewer groups of the subnet traffic.</p>
<p id="p-0032" num="0031">The security-management node <b>114</b> generally provides the VPN information to the network nodes <b>102</b><sub>1</sub>-<b>102</b><sub>4 </sub>by way of a negotiation with or registration of the network nodes <b>102</b><sub>1</sub>-<b>102</b><sub>4</sub>. The negotiation may include the security-management node <b>114</b> receiving from the network nodes <b>102</b><sub>1</sub>-<b>102</b><sub>4 </sub>respective requests for the VPN information, and obtaining from the network nodes <b>102</b><sub>1</sub>-<b>102</b><sub>4 </sub>valid security credentials. Alternatively, the negotiation may include the security-management node <b>114</b> providing the VPN information to the network nodes <b>102</b><sub>1</sub>-<b>102</b><sub>4 </sub>without receiving the requests and/or obtaining the valid security credentials.</p>
<p id="p-0033" num="0032">The VPN nodes <b>112</b><sub>1</sub>-<b>112</b><sub>4</sub>, responsive to obtaining the VPN information, may configure, provision and/or otherwise cause themselves to form a number of different groups. These different groups may include (i) a first group having a number of members (&#x201c;first group members&#x201d;) for cryptographically securing the first group traffic and for routing such traffic in the VPN <b>112</b>; and (ii) a second group having a number of members (&#x201c;second group members&#x201d;) for cryptographically securing the second group traffic and for routing such traffic in the VPN <b>112</b>. The first group members may include, for example, the first, second and third VPN nodes <b>112</b><sub>1</sub>-<b>112</b><sub>3</sub>, and the first group traffic may include the subnet traffic that the first, second and third VPN nodes <b>112</b><sub>1</sub>-<b>112</b><sub>3 </sub>exchange. The second group members may include, for example, the first and fourth VPN nodes <b>112</b><sub>1</sub>, <b>112</b><sub>4</sub>, and the second group traffic may include the subnet traffic that the first and fourth and fourth VPN nodes <b>112</b><sub>1</sub>, <b>112</b><sub>4 </sub>exchange.</p>
<p id="p-0034" num="0033">To facilitate cryptographically securing the first group traffic, each of the first group members (VPN nodes <b>112</b><sub>1</sub>-<b>112</b><sub>4</sub>) forms respective first group-encrypted traffic. To form the first group-encrypted traffic, each of the first group members encrypts its first group traffic using the first cipher and encapsulates such traffic with a first group-security association formed in accordance with the first group-security policy. This way, only the first group members can decipher the first group-encrypted traffic.</p>
<p id="p-0035" num="0034">Analogously, each of the second-group members (VPN nodes <b>112</b><sub>1 </sub>and <b>112</b><sub>4</sub>) forms respective second group-encrypted traffic. To form the second group-encrypted traffic, each of the second group members encrypts its second group traffic using the second cipher and encapsulates this traffic with a second group-security association formed in accordance with the second group-security policy. This way, only the second group members can decipher the second group-encrypted traffic.</p>
<p id="p-0036" num="0035">In addition to cryptographically securing and routing the first-group traffic, each of the first group members may forward the second group-encrypted traffic routed by any of the second group members. Analogously, each of the second group members may forward the first group-encrypted traffic routed by any of the first group members. To facilitate this, the first-group members and second-group members may use a given communication packet structure, such as shown in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0037" num="0036">Referring now to <figref idref="DRAWINGS">FIG. 2</figref>, a block diagram illustrating a structure of a communication packet <b>200</b> for carrying out a dynamic secured group communication is shown. For convenience, the structure of the communication packet <b>200</b> is described with reference to the example network architecture <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref>, and in particular to communicating the first group traffic from one of the first group members, e.g., the first VPN node <b>112</b><sub>1 </sub>to another of the first group members, e.g., the second VPN node <b>112</b><sub>2</sub>. The communication packet structure <b>200</b> may be used with other architectures, other group traffic, and between the other VPN nodes as well.</p>
<p id="p-0038" num="0037">The communication packet <b>200</b> includes a first payload <b>202</b> encapsulated by a security-encapsulating header <b>204</b> and a first IP header <b>206</b>. The first payload <b>202</b> may include, in encrypted form, a packet of the first group traffic (&#x201c;encrypted-subnet packet&#x201d;). The encrypted-subnet packet may be encrypted by the first VPN node <b>112</b><sub>1 </sub>using the first cipher. Underlying the encryption of the encrypted-subnet packet may be a packet of the first group traffic (&#x201c;subnet packet&#x201d;). The subnet packet may originate from a node in the first subnet <b>104</b> (&#x201c;originating node&#x201d;) for termination to a node in the second subnet <b>106</b> (&#x201c;terminating node&#x201d;).</p>
<p id="p-0039" num="0038">The subnet packet, in turn, includes a second payload <b>212</b> and a second IP header <b>210</b>. The second payload <b>212</b> generally includes information (e.g., data, control information, etc.) for transfer to the terminating node. The second IP header <b>210</b> includes a source address <b>214</b> and a destination address <b>216</b>. The source address <b>214</b> is an IP address of the originating node, and the destination address <b>216</b> is an IP address of the terminating node.</p>
<p id="p-0040" num="0039">The security-encapsulating header <b>204</b> may include an identifier for identifying to the VPN nodes <b>112</b><sub>2</sub>-<b>112</b><sub>4 </sub>that the VPN node <b>112</b><sub>1 </sub>secured the subnet packet (including the second IP header <b>212</b> and the second payload <b>210</b>) in accordance with the first group-security policy. Because only the first group members (e.g., the VPN nodes <b>112</b><sub>2 </sub>and/or <b>112</b><sub>3</sub>) are configured and/or provisioned with the first group-security policy and the first cipher, only the first group members are able to decipher the encrypted-subnet packet. In addition to the identifier (&#x201c;group-SA identifier&#x201d;), the security-encapsulating header <b>204</b> may include a message-authentication code, such as a keyed-Hash Message-Authentication Code (&#x201c;HMAC&#x201d;). The message-authentication code may be used by the terminating node to authenticate the encrypted-subnet packet prior to decryption. This way, the termination node can discover and properly manage unauthorized modification of the encrypted-subnet packet</p>
<p id="p-0041" num="0040">To facilitate routing and forwarding in the VPN <b>112</b>, the first IP header <b>206</b> is a copy of the second IP header <b>212</b>. As such, the first IP header <b>206</b> includes a copy <b>218</b> of the source address <b>214</b> and a copy <b>220</b> of the destination address <b>216</b>.</p>
<p id="p-0042" num="0041">Advantageously, the structure of communication packet <b>200</b> allows the encrypted-subnet packet to follow an optimal routed path in the private network <b>102</b> without requiring an overlay routing protocol. In addition, the VPN node <b>112</b><sub>1 </sub>(as one of the first group members) can replicate the encrypted-subnet packet and follow an optimal multicast distribution tree in the private network <b>102</b>.</p>
<p id="p-0043" num="0042">Referring now to <figref idref="DRAWINGS">FIG. 3</figref>, a flow diagram illustrating an example communication flow <b>300</b> for carrying out a dynamic secured group communication is shown. For convenience, the example communication flow <b>300</b> is described with reference to the structure of the communication packet <b>200</b> of <figref idref="DRAWINGS">FIG. 2</figref>, to the example network architecture <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref>, and in particular, to communicating first group traffic from one of the first group members, e.g., the first VPN node <b>112</b><sub>1 </sub>to the another of the first group members, e.g., the second VPN node <b>112</b><sub>2</sub>. The communication flow <b>300</b> may be used with other architectures, other group traffic, and between the other VPN nodes as well.</p>
<p id="p-0044" num="0043">As shown at flow indicator <b>302</b>, the originating node forms the second payload <b>212</b>. To form the second payload, the originating node may obtain the information for transfer to the terminating node, and place this information in the second payload <b>212</b>. After placing the information in the second payload <b>212</b>, the originating node may form a transport-layer packet as shown at flow indicator <b>304</b>. To form the transport-layer packet, the originating node may encapsulate the second payload <b>212</b> in headers of a transport-layer protocol, such as a user-datagram protocol (&#x201c;UDP&#x201d;) or a Transmission Control Protocol (&#x201c;TCP&#x201d;).</p>
<p id="p-0045" num="0044">After such encapsulation, the originating node forms the subnet packet, as shown at flow indicator <b>306</b>. To form the subnet packet, the originating node applies the second IP header <b>210</b> to the transport-layer packet.</p>
<p id="p-0046" num="0045">As shown at flow indicator <b>308</b>, the originating node transmits the subnet packet into the first subnet toward the destination node. The first VPN node <b>112</b><sub>1 </sub>obtains the subnet packet from the first subnet, as shown at flow indicator <b>310</b>.</p>
<p id="p-0047" num="0046">After obtaining the subnet packet, the first VPN node <b>112</b><sub>1 </sub>(as one of the first group members) forms a first group-encrypted frame, as shown at flow indicator <b>312</b>. To form the first group-encrypted frame, the first VPN node <b>112</b><sub>1 </sub>encrypts the subnet packet with the first cipher, and encapsulates such subnet packet with the security-encapsulating header <b>204</b>, which includes the first group-security association and the message-authentication code. In addition, the first VPN node <b>112</b><sub>1 </sub>applies the first IP header <b>206</b> to the first group-encrypted frame to form a first group-encrypted packet, as shown at flow indicator <b>314</b>.</p>
<p id="p-0048" num="0047">As shown at flow indicator <b>316</b>, the first VPN node <b>112</b><sub>1 </sub>routes and forwards the first group-encrypted packet into the VPN <b>112</b> towards the second VPN node <b>112</b><sub>2</sub>. As indicated by flow indicator <b>318</b>, the first group-encrypted packet traverses the VPN <b>112</b> in accordance with the routing by the first VPN node <b>112</b><sub>1</sub>. After traversing the VPN <b>112</b>, the second VPN node <b>112</b><sub>2 </sub>obtains the first group-encrypted packet, as shown at flow indicator <b>320</b>.</p>
<p id="p-0049" num="0048">After obtaining the first group-encrypted packet, the second VPN node <b>112</b><sub>2 </sub>authenticates the first group-encrypted packet, as shown at flow indicator <b>322</b>. To authenticate the group-encrypted packet, the second VPN node <b>112</b><sub>2 </sub>obtains the message-authentication code from the security-encapsulating header <b>204</b>; and then uses it to ensure that the group-encrypted packet is precisely the same as when it left the first VPN node <b>112</b><sub>1</sub>. This may include the second VPN node <b>112</b><sub>2 </sub>applying, for example, the HMAC along with a second cipher (that is pre-negotiated between the VPN nodes <b>112</b><sub>1</sub>-<b>112</b><sub>4</sub>). Alternatively, the VPN node <b>112</b><sub>2 </sub>may apply the HMAC along with the first cipher, which the second VPN node <b>112</b><sub>2 </sub>obtains responsive to obtaining the group-SA identifier from the security-encapsulating header <b>204</b>.</p>
<p id="p-0050" num="0049">After authenticating the first group-encrypted packet, the second VPN node <b>112</b><sub>2 </sub>extracts the subnet packet from the group-encrypted packet, as shown at flow indicator <b>324</b>. To extract the subnet packet, the second VPN node <b>112</b><sub>2 </sub>obtains the group-SA identifier from the security-encapsulating header <b>204</b>. Using the group-SA identifier, the second VPN node <b>112</b><sub>2 </sub>obtains the first cipher associated with the first group-security association. After obtaining the first cipher, the second VPN node <b>112</b><sub>2 </sub>applies the first cipher to decrypt the encryption applied to the first group-encrypted frame to yield the subnet packet.</p>
<p id="p-0051" num="0050">In addition, the second VPN node <b>112</b><sub>2 </sub>authenticates the subnet packet, as shown at flow indicator <b>326</b>. As part of authenticating the subnet packet, the second VPN node <b>112</b><sub>2 </sub>ensures that the source and destination nodes conform to the first group-security policy. This may include ensuring that the source and destination addresses <b>214</b>, <b>216</b> are listed as belonging to the first group. In addition, the second VPN node <b>112</b><sub>2 </sub>may compare a hash of the first IP header <b>206</b> with a hash of the second IP header <b>210</b>. This may include comparing a hash of the source and destination addresses <b>214</b>, <b>216</b> with a hash of the source-address and destination-address copies <b>218</b>, <b>220</b> to ensure that they are the same.</p>
<p id="p-0052" num="0051">As shown at flow indicator <b>328</b>, the second VPN node <b>112</b><sub>2 </sub>forwards the subnet packet to the terminating node. As shown at flow indicator <b>330</b>, the terminating node obtains the subnet packet. After obtaining the subnet packet, the terminating node extracts the information from the second payload <b>212</b>, as shown at flow indicator <b>332</b>. The terminating node may extract the information from the second payload <b>212</b> by reversing the functions carried out by the originating node shown at the flow indicators <b>306</b>, <b>304</b>, and <b>302</b>.</p>
<p id="p-0053" num="0052"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram illustrating example network architecture <b>400</b> for carrying out a dynamic secured group communication. The network architecture <b>400</b> includes the network architecture <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref>, an access node <b>402</b>, a publicly-accessible network (&#x201c;public network&#x201d;) <b>406</b>, and a peer node <b>408</b>.</p>
<p id="p-0054" num="0053">The public network <b>406</b> may be a partial or full deployment of most any telecommunication network, computer network or convergence thereof to which any interested member of the public can be provided with (e.g., served) communication services, including, for example, services for exchanging data. As such, the public network <b>406</b> may be or include any part of a public, terrestrial wireless or satellite, and/or wireline telecommunications and/or computer network. For example, the public network <b>406</b> may include all or portions of the Internet, proprietary public networks, other public wired and/or wireless packet-data networks, etc. Accordingly, the public network <b>406</b> may include a number of packet-data elements. These packet-data elements include one or more nodes (not shown) that employ network address translation (&#x201c;NAT nodes&#x201d;). These NAT nodes may employ one or more types of NAT, including network address and port translation (&#x201c;NAPT&#x201d;) and basic NAT (i.e., network address translation without port mapping).</p>
<p id="p-0055" num="0054">The access node <b>402</b> is communicatively coupled to both the public and private networks <b>102</b>, <b>406</b>. The access node <b>402</b> may, for example, be embodied as and/or function as a router for routing and/or forwarding the private network traffic and/or public network traffic in and/or between the private and public networks <b>102</b>, <b>106</b>. In addition, the access node <b>402</b> may apply NAT to the private network traffic routed and/or forwarded between the private and public networks <b>102</b>, <b>406</b>.</p>
<p id="p-0056" num="0055">The access node <b>402</b> may also double as a fifth VPN node. Typically, the access node <b>402</b> does not maintain any of the group-security policies, and as such, is not a member of any group of the VPN <b>112</b>. The access node <b>402</b>, like the other VPN nodes <b>112</b><sub>1</sub>-<b>112</b><sub>4</sub>, may forward the first and second group-encrypted traffic in accordance with the routing associated therewith. In addition, the VPN access node <b>402</b>, as described in more detail below, functions to provide egress from or ingress to the VPN <b>112</b> for the first and/or second group-encrypted traffic originated from and/or terminated to the peer node <b>406</b>.</p>
<p id="p-0057" num="0056">The peer node <b>408</b> is communicatively coupled to the public network <b>406</b>, and may, for example, be embodied as and/or function as a router. Alternatively, the peer node <b>408</b> may be customer premises equipment (e.g., a desktop, laptop or other type of computer). The peer node <b>408</b> may route and/or forward into the public network <b>406</b> traffic it obtains or generates (&#x201c;peer traffic&#x201d;).</p>
<p id="p-0058" num="0057">In addition, the peer node <b>408</b> may originate the first group-encrypted traffic to and/or terminate the first group-encrypted traffic from the first group members. Alternatively, the peer node <b>408</b> may originate the second group-encrypted traffic to and/or terminate the second group-encrypted traffic from the second group members. For simplicity of exposition, the following describes the peer node <b>408</b> with respect to the first group-encrypted traffic. The description, however, applies equally to the second group-encrypted traffic.</p>
<p id="p-0059" num="0058">To facilitate originating and/or terminating the first group-encrypted traffic, the peer node <b>408</b> and the first group members form a first security relationship, and the peer node <b>408</b> and the access node <b>402</b> form a second security relationship. Through the first security relationship, the peer node <b>408</b> and the first group members form the first group-encrypted traffic. Through the second security relationship, the peer node <b>408</b> and the access node <b>402</b> securely transport or tunnel the first group-encrypted traffic through the public network <b>406</b>.</p>
<p id="p-0060" num="0059">To facilitate forming the first security relationship, the peer node <b>408</b> may, responsive to the VPN information, configure, provision and/or otherwise cause itself to function as one of the first group members. This way, the peer node <b>408</b> may use the first group-security policy to (i) form the first group-encrypted traffic for origination to the first group members, and/or (Ii) disassemble the first group-encrypted traffic for termination.</p>
<p id="p-0061" num="0060">The peer node <b>408</b> may be manually configured and/or provisioned with the VPN information. Alternatively, the peer node <b>408</b> may obtain the VPN information from security-management node <b>114</b> by way of a negotiation through a secured channel, such as a tunnel formed in accordance with Internet Protocol security (&#x201c;IPSec&#x201d;) as set forth in Internet Engineering Task Force (&#x201c;IETF&#x201d;) Request for Comments (&#x201c;RFC&#x201d;) 4301-4309.</p>
<p id="p-0062" num="0061">To facilitate forming the second security association, the peer node <b>408</b> and the access node <b>402</b> may negotiate or otherwise form a secure channel or tunnel (collectively &#x201c;tunnel&#x201d;) <b>410</b>. To facilitate forming the tunnel <b>410</b>, the peer node <b>408</b> and the access node <b>402</b> may apply a tunneling protocol to the first group-encrypted traffic. The tunneling protocol may apply (i) encryption and authentication, (ii) encryption alone or (ii) authentication alone to the first group-encrypted traffic. Examples of the tunneling protocol include IPSec and/or IPSec as extended, varied, modified and/or changed by IETF RFC 3947, namely, Negotiation of Network-Address-Translator Traversal (&#x201c;NAT-T&#x201d;). Other examples of the tunneling protocol are described below.</p>
<p id="p-0063" num="0062">Referring now to <figref idref="DRAWINGS">FIG. 5</figref>, a block diagram illustrating an example structure of a communication packet <b>500</b> for carrying out a dynamic secured group communication is shown. For convenience, the structure of the communication packet <b>500</b> is described with reference to the example network architecture <b>400</b> of <figref idref="DRAWINGS">FIG. 4</figref>, and in particular to communicating the first group-encrypted traffic between the peer node <b>408</b> and one of the first group members, e.g., the second VPN node <b>112</b><sub>2</sub>. The structure of the communication packet <b>500</b> may be used with other architectures, other group traffic, between other group members, and between other VPN nodes as well.</p>
<p id="p-0064" num="0063">The communication packet <b>500</b> defines a packet for tunneling a first group-encrypted packet through the tunnel <b>410</b>. This tunnel packet includes a first payload <b>502</b> encapsulated by a first security-encapsulating header <b>504</b>, a UDP/NAT-T header <b>505</b> and a first IP header <b>506</b>. The first payload <b>502</b> may include, as encrypted and/or authenticated in accordance with the tunneling protocol, the first group-encrypted packet. The first group-encrypted packet underlying the tunneling protocol originates from the peer node <b>408</b> for termination to the terminating node in the second subnet <b>106</b>.</p>
<p id="p-0065" num="0064">The first group-encrypted packet, in turn, includes a second payload <b>510</b>, a second security-encapsulating header <b>512</b>, and a second IP header <b>514</b>. The second payload <b>510</b> may include a packet of the peer traffic (&#x201c;peer-traffic packet&#x201d;) encrypted and/or authenticated in accordance with the first group-security policy. The peer-traffic packet underlying such encryption and/or authentication originates from the peer node <b>408</b> for termination to the terminating node in the second subnet <b>106</b>.</p>
<p id="p-0066" num="0065">The peer-traffic packet, in turn, includes a third payload <b>518</b> and a third IP header <b>520</b>. The third payload <b>518</b> generally includes information (e.g., data, control information, etc.) for transfer to the terminating node. The third IP header <b>520</b> includes a source address <b>522</b> and a destination address <b>524</b>. The source address <b>522</b> is an IP address of the peer node <b>408</b>, and the destination address <b>524</b> is the IP address of the terminating node.</p>
<p id="p-0067" num="0066">The second security-encapsulating header <b>512</b> may include an group-SA identifier for identifying to the VPN nodes <b>112</b><sub>2</sub>-<b>112</b><sub>4 </sub>that the peer node <b>408</b> secured the peer-traffic packet (including the third IP header <b>520</b> and the third payload <b>518</b>) in accordance with the first group-security policy. Because only the first group members (e.g., the VPN nodes <b>112</b><sub>1</sub>-<b>112</b><sub>3</sub>) are configured and/or provisioned with the first group-security policy and the first cipher, only the first group members are able to decipher the first group-encrypted packet and extract the peer-traffic packet.</p>
<p id="p-0068" num="0067">To facilitate routing and forwarding in the VPN <b>112</b>, the second IP header <b>514</b> is a copy of the third IP header <b>520</b>. As such, the second IP header <b>514</b> includes a copy <b>526</b> of the source address <b>522</b> and a copy <b>528</b> of the destination address <b>524</b>.</p>
<p id="p-0069" num="0068">The first security-encapsulating header <b>504</b> may include an identifier for identifying to the access node <b>402</b> that the peer node <b>408</b> secured the first group-encrypted packet in accordance with the tunneling protocol. Because only the peer and access nodes <b>402</b>, <b>408</b> are configured and/or provisioned to carry out the tunneling protocol, only the peer and access nodes <b>402</b>, <b>408</b> are able to decipher the encryption applied to the first group-encrypted packet and extract the first group-encrypted packet from the tunnel packet.</p>
<p id="p-0070" num="0069">To facilitate routing and forwarding through the tunnel <b>410</b>, the first IP header <b>506</b> includes a source address <b>530</b> and a destination address <b>532</b>. The source address <b>530</b> is the IP address of the peer node <b>408</b>, and the destination address is the IP address of the access node <b>402</b>. The UDP/NAT-T header <b>505</b> may be used by the access node <b>402</b> to authenticate the tunnel packet given that the tunnel packet may undergo NAT as it traverses the tunnel <b>410</b>.</p>
<p id="p-0071" num="0070">Advantageously, the structure of the communication packet <b>500</b> allows the first group-encrypted packets to traverse the public network while allowing the first-group encrypted packets to follow an optimal routed path in the private network <b>102</b> without requiring the overlay routing protocol. In addition, the peer node <b>408</b>, as one of the first group members, can replicate the first group-encrypted packet and follow an optimal multicast distribution tree in the private network <b>102</b>.</p>
<p id="p-0072" num="0071">Referring now to <figref idref="DRAWINGS">FIG. 6</figref>, a flow diagram illustrating an example communication flow <b>600</b> for carrying out a dynamic secured group communication is shown. For convenience, the example communication flow <b>600</b> is described with reference to the structure of the communication packet <b>500</b> of <figref idref="DRAWINGS">FIG. 5</figref>, to the example network architecture <b>400</b> of <figref idref="DRAWINGS">FIG. 1</figref>, and in particular, to communicating the first group-encrypted traffic between the peer node <b>408</b> and one of the first group members, e.g., the second VPN node <b>112</b><sub>2</sub>. The communication flow <b>600</b> may be used with other architectures, other group traffic, and between the other VPN nodes as well.</p>
<p id="p-0073" num="0072">As shown at flow indicator <b>602</b>, the peer node <b>408</b> and the access node <b>402</b> establish the tunnel <b>406</b> via a negotiation carried out in accordance with one or more protocols for securing IP communications (&#x201c;security protocols&#x201d;). These security protocols may include, for example, IPSec; one or more extensions, variations, modifications, and/or changes to IPSec; sub-protocols of IPSec, such as Internet Key Exchange (&#x201c;IKE&#x201d;); and/or one or more extensions, variations, modifications, and/or changes to IKE. This includes such extensions, variations, modifications, and/or changes that are (i) described herein and/or (ii) consistent with or logical or otherwise reasonable extensions of the extensions, variations, modifications, and/or changes described herein or described elsewhere in the public domain.</p>
<p id="p-0074" num="0073">In general, either of the peer node <b>408</b> or the access node <b>402</b> may begin or otherwise initiate the negotiation. Alternatively, one or more rules set forth in the security protocols may dictate which of the peer node <b>408</b> or the access node <b>402</b> is to initiate the negotiation. The rules may dictate, for example, that, by default, only the peer node <b>408</b> or only the access node <b>402</b> may initiate the negotiation.</p>
<p id="p-0075" num="0074">Alternatively, the rules may dictate (as described in more detail below) that the peer node <b>408</b> is to initiate the negotiation when (i) it encounters the information for transfer to the terminating node (&#x201c;terminating-node information&#x201d;) and/or the first group-encrypted traffic, and (ii) the tunnel <b>410</b> is not already established. Alternatively, but analogously, the rules may dictate that access node <b>402</b> is to initiate the negotiation when (i) it encounters the terminating-node information and/or first group-encrypted traffic, and (ii) the tunnel <b>410</b> is not already established. The rules may dictate other ways for the peer node <b>408</b> and the access node <b>402</b> to initiate the first-security negotiation as well.</p>
<p id="p-0076" num="0075">For ease of exposition, the following assumes that the rules dictate that the peer node <b>408</b> initiates the negotiation after it encounters the terminating-node information and the tunnel <b>410</b> is not already established. Responsive to encountering the terminating-node information, the peer node <b>408</b> initiates a communication session with the access node <b>402</b> in accordance with phase one (1) of IKE as extended, varied, modified and/or changed by IETF RFC 3947, namely, Negotiation of Network-Address-Translator Traversal (&#x201c;NAT-T&#x201d;). Responsive to this (&#x201c;phase 1 IKE/NAT-T&#x201d;) session, the peer and access nodes <b>408</b>, <b>402</b> establish a secure channel for negotiating matching IPSec security associations in accordance with phase two (2) of IKE. Responsive to completing negotiation of the matching IPSec security associations, the peer and access nodes <b>408</b>, <b>402</b> establish the tunnel <b>410</b>.</p>
<p id="p-0077" num="0076">As shown at flow indicator <b>604</b>, the peer node <b>408</b> forms the third payload <b>518</b>. To form the third payload <b>518</b>, the peer node <b>408</b> may obtain the terminating-node information, and place this information in the third payload <b>518</b>. After placing the terminating-node information in the third payload <b>518</b>, the peer node <b>408</b> may form a transport-layer packet as shown at flow indicator <b>606</b>. To form the transport-layer packet, the peer node <b>408</b> may encapsulate the third payload <b>518</b> in headers of a transport-layer protocol, such as UDP or TCP.</p>
<p id="p-0078" num="0077">After such encapsulation, the peer node <b>408</b> forms the peer-traffic packet, as shown at flow indicator <b>408</b>. To form the peer-traffic packet, the peer node applies the third IP header <b>520</b> to the transport-layer packet.</p>
<p id="p-0079" num="0078">As shown at flow indicator <b>610</b>, the peer node <b>408</b> (as one of the first group members) forms a first group-encrypted frame. To form the first group-encrypted frame, the peer node <b>408</b> encrypts the peer-traffic packet with the first cipher, and encapsulates such peer-traffic packet with the security-encapsulating header <b>512</b>, which includes the first group-security association and the message-authentication code. In addition, the peer node <b>408</b> applies the second IP header <b>514</b> to the first group-encrypted frame to form a first group-encrypted packet, as shown at flow indicator <b>612</b>.</p>
<p id="p-0080" num="0079">As shown at flow indicator <b>614</b>, the peer node <b>408</b> forms the tunnel packet for transport to the access node <b>402</b>. To form the tunnel packet, the peer node <b>408</b> applies the IPSec security association to the first group-encrypted packet to encrypt and/or authenticate the first group-encrypted packet in accordance with IPSec's encapsulating security payload (&#x201c;ESP&#x201d;) protocol. This may include the peer node <b>408</b> encapsulating the first group-encrypted packet, as so encrypted, in the second security-encapsulation header <b>512</b>, which may be, for example, the ESP protocol, so as to form an ESP frame.</p>
<p id="p-0081" num="0080">In addition, the peer node <b>408</b> encapsulates the ESP frame in the UDP/NAT-T headers <b>505</b>, and applies the first IP header <b>506</b> to the UDP/NAT-T encapsulated ESP frame. The UDP/NAT-T headers <b>505</b> enable the access node <b>402</b> to authenticate the tunnel packet after traversing one or more of the NAT nodes of the public network <b>406</b>.</p>
<p id="p-0082" num="0081">After forming the tunnel packet, the peer node <b>408</b> routes and forwards the tunnel packet into the tunnel <b>410</b> towards the access node <b>402</b>, as shown at flow indicator <b>616</b>. As indicated by flow indicator <b>618</b>, the tunnel packet traverses the tunnel <b>410</b> in accordance with the routing by the peer node <b>408</b>. After traversing the tunnel <b>410</b>, the access node <b>402</b> obtains the tunnel packet, as shown at flow indicator <b>620</b>.</p>
<p id="p-0083" num="0082">As shown at flow indicator <b>622</b>, the access node <b>402</b> authenticates the tunnel packet. The access node <b>402</b> may authenticate the tunnel packet as a function of UDP/NAT-T headers <b>505</b>. After authenticating the tunnel packet, the access node <b>402</b> extracts the first group-encrypted packet from the tunnel packet. To extract the first group-encrypted packet, the access node <b>402</b> obtains from the first security-encapsulating header <b>504</b> an identifier for identifying the IPSec matching security association (&#x201c;IPSec-SA identifier&#x201d;). Using the IPSec-SA identifier, the access node <b>402</b> decrypts the encryption applied to the first group-encrypted packet so as to yield the first group-encrypted packet.</p>
<p id="p-0084" num="0083">After extraction, the access node <b>402</b> forwards the first group-encrypted packet to the second VPN node <b>112</b><sub>2</sub>, via the VPN <b>112</b>, as shown at flow indicator <b>626</b>. The second VPN node <b>112</b><sub>2 </sub>obtains the first group-encrypted packet, as shown at flow indicator <b>628</b>.</p>
<p id="p-0085" num="0084">After obtaining the first group-encrypted packet, the second VPN node <b>112</b><sub>2 </sub>authenticates the first group-encrypted packet, as shown at flow indicator <b>630</b>. To authenticate the group-encrypted packet, the second VPN node <b>112</b><sub>2 </sub>obtains the message-authentication code from the security-encapsulating header <b>504</b>; and then uses it to ensure that the group-encrypted packet is precisely the same as when it left the first VPN node <b>112</b><sub>1</sub>. This may include the second VPN node <b>112</b><sub>2 </sub>applying, for example, the HMAC along with the second cipher that is pre-negotiated between the VPN nodes <b>112</b><sub>1</sub>-<b>112</b><sub>4</sub>. Alternatively, the VPN node <b>112</b><sub>2 </sub>may apply the HMAC along with the first cipher, which the second VPN node <b>112</b><sub>2 </sub>obtains responsive to obtaining the group-SA identifier from the security-encapsulating header <b>504</b>.</p>
<p id="p-0086" num="0085">After authenticating the first group-encrypted packet, the second VPN node <b>112</b><sub>2 </sub>extracts the peer-traffic packet from the first group-encrypted packet, as shown at flow indicator <b>632</b>. To extract the peer-traffic packet, the second VPN node <b>112</b><sub>2 </sub>obtains from the second security-encapsulating header <b>512</b> the identifier for identifying the first group-security association. Using the identifier, the second VPN node <b>112</b><sub>2 </sub>obtains the first cipher associated with the first group-security association. After obtaining the first cipher, the second VPN node <b>112</b><sub>2 </sub>applies the first cipher to decrypt the encryption applied to the first group-encrypted frame to yield the peer-traffic packet.</p>
<p id="p-0087" num="0086">In addition, the second VPN node <b>112</b><sub>2 </sub>authenticates the peer-traffic packet, as shown at flow indicator <b>634</b>. As part of authenticating the peer-traffic packet, the second VPN node <b>112</b><sub>2 </sub>ensures that the source and destination nodes conform to the first group-security policy. This may include ensuring that the source and destination addresses <b>214</b>, <b>216</b> are listed as belonging to the first group. In addition, the second VPN node <b>112</b><sub>2 </sub>may compare a hash of the second IP header <b>514</b> with a hash of the third IP header <b>520</b>. This may include comparing a hash of the source and destination addresses <b>522</b>, <b>524</b> with a hash of the source-address and destination-address copies <b>526</b>, <b>528</b> to ensure that they are the same.</p>
<p id="p-0088" num="0087">As shown at flow indicator <b>636</b>, the second VPN node <b>112</b><sub>2 </sub>forwards the peer-traffic packet to the terminating node. As shown at flow indicator <b>638</b>, the terminating node obtains the peer-traffic packet. After obtaining the peer-traffic packet, the terminating node extracts the information from the third payload <b>518</b>, as shown at flow indicator <b>640</b>. The terminating node may extract the information from the third payload <b>518</b> by reversing the functions carried out by the peer node <b>408</b> shown at the flow indicators <b>608</b>, <b>606</b>, and <b>604</b>.</p>
<p id="p-0089" num="0088">Referring now to <figref idref="DRAWINGS">FIG. 7</figref>, a flow diagram illustrating an example communication flow <b>700</b> for carrying out a dynamic secured group communication is shown. For convenience, the example communication flow <b>700</b> is described with reference to the structure of the communication packet <b>500</b> of <figref idref="DRAWINGS">FIG. 5</figref>, to the example network architecture <b>400</b> of <figref idref="DRAWINGS">FIG. 1</figref>, and in particular, to communicating the first group-encrypted traffic between the peer node <b>408</b> and one of the first group members, e.g., the first VPN node <b>112</b><sub>1</sub>. The communication flow <b>700</b> may be used with other architectures, other group traffic, and between the other VPN nodes as well.</p>
<p id="p-0090" num="0089">As shown at flow indicator <b>702</b>, the originating node in the first subnet <b>104</b> forms the third payload <b>518</b>. To form the third payload <b>518</b>, the originating node may obtain the information for transfer to the peer node <b>408</b>, and place this information in the third payload <b>518</b>. After placing the information in the third payload <b>518</b>, the originating node may form a transport-layer packet as shown at flow indicator <b>704</b>. To form the transport-layer packet, the originating node may encapsulate the third payload <b>518</b> in headers of a transport-layer protocol, such as UDP or TCP.</p>
<p id="p-0091" num="0090">After such encapsulation, the originating node forms the subnet packet, as shown at flow indicator <b>706</b>. To form the subnet packet, the originating node applies the third IP header <b>520</b> to the transport-layer packet.</p>
<p id="p-0092" num="0091">As shown at flow indicator <b>708</b>, the originating node transmits the subnet packet into the first subnet toward the first VPN node <b>112</b><sub>1</sub>. The first VPN node <b>112</b><sub>1 </sub>obtains the subnet packet, as shown at flow indicator <b>710</b>.</p>
<p id="p-0093" num="0092">After obtaining the subnet packet, the first VPN node <b>112</b><sub>1 </sub>(as one of the first group members) forms a first group-encrypted frame, as shown at flow indicator <b>712</b>. To form the first group-encrypted frame, the first VPN node <b>112</b><sub>1 </sub>encrypts the subnet packet with the first cipher, and encapsulates such subnet packet with the second security-encapsulating header <b>512</b>, which includes the first group-security association. In addition, the first VPN node <b>112</b><sub>1 </sub>applies the second IP header <b>514</b> to the first group-encrypted frame to form a first group-encrypted packet, as shown at flow indicator <b>714</b>.</p>
<p id="p-0094" num="0093">As shown at flow indicator <b>716</b>, the first VPN node <b>112</b><sub>1 </sub>routes and forwards the first group-encrypted packet into the VPN <b>112</b> towards the access node <b>402</b>. As indicated by flow indicator <b>718</b>, the first group-encrypted packet traverses the VPN <b>112</b> in accordance with the routing by the first VPN node <b>112</b><sub>1</sub>. After traversing the VPN <b>112</b>, the access node <b>402</b> obtains the first group-encrypted packet, as shown at flow indicator <b>720</b>.</p>
<p id="p-0095" num="0094">As shown at flow indicator <b>722</b>, the access node <b>402</b> and the peer node <b>408</b> establish the tunnel <b>406</b> via a negotiation carried out in accordance with the security protocols. This negotiation may be carried out as described above with respect to flow indicator <b>612</b> (<figref idref="DRAWINGS">FIG. 6</figref>), except that the access node <b>402</b> may initiate the negotiation responsive to obtaining the first group-encrypted packet.</p>
<p id="p-0096" num="0095">As shown at flow indicator <b>724</b>, the access node <b>402</b> forms the tunnel packet for transport to the peer node <b>408</b>. To form the tunnel packet, the access node <b>402</b> applies the IPSec security association to the first group-encrypted packet to encrypt and/or authenticate first group-encrypted packet in accordance with IPSec's encapsulating security payload (&#x201c;ESP&#x201d;) protocol. This may include the access node <b>402</b> encapsulating the first group-encrypted packet, as so encrypted, in the second security-encapsulation header <b>512</b>, which may be, for example, the ESP protocol, so as to form the ESP frame.</p>
<p id="p-0097" num="0096">In addition, the access node <b>402</b> encapsulates the ESP frame in the UDP/NAT-T headers <b>505</b>, and applies the first IP header <b>506</b> to the UDP/NAT-T encapsulated ESP frame. The UDP/NAT-T headers enable the peer node <b>408</b> to authenticate the tunnel packet after traversing one or more of the NAT nodes of the public network <b>406</b>. After forming the tunnel packet, the access node <b>402</b> routes and forwards the tunnel packet into the tunnel <b>410</b> towards the peer node <b>408</b>, as shown at flow indicator <b>726</b>.</p>
<p id="p-0098" num="0097">As indicated by flow indicator <b>728</b>, the tunnel packet traverses the tunnel <b>410</b> in accordance with the routing by the access node <b>402</b>. After traversing the tunnel <b>410</b>, the peer node <b>408</b> obtains the tunnel packet, as shown at flow indicator <b>730</b>.</p>
<p id="p-0099" num="0098">As shown at flow indicator <b>732</b>, the peer node <b>408</b> authenticates the tunnel packet. The peer node <b>408</b> may authenticate the tunnel packet as a function of UDP/NAT-T headers <b>505</b>. After authenticating the tunnel packet, the peer node <b>408</b> extracts the first group-encrypted packet from the tunnel packet, as shown at flow indicator <b>734</b>. To extract the first group-encrypted packet, the peer node <b>408</b> obtains from the first security-encapsulating header <b>504</b> an identifier for identifying the IPSec matching security association. Using the identifier, the peer node <b>408</b> decrypts the encryption applied to the first group-encrypted packet to yield the first group-encrypted packet.</p>
<p id="p-0100" num="0099">After extraction, the peer node <b>408</b> extracts the subnet packet from the first group-encrypted packet, as shown at flow indicator <b>734</b>. To extract the subnet packet, the peer node <b>408</b> obtains from the second security-encapsulating header <b>512</b> the identifier for identifying the first group-security association. Using the identifier, the peer node <b>408</b> obtains the first cipher associated with the first group-security association. After obtaining the first cipher, the peer node <b>408</b> applies the first cipher to decrypt the encryption applied to the first group-encrypted frame to yield the subnet packet.</p>
<p id="p-0101" num="0100">In addition, the peer node <b>408</b> authenticates the subnet packet, as shown at flow indicator <b>738</b>. As part of authenticating the subnet packet, the peer node <b>408</b> may compare a hash of the second IP header <b>514</b> with a hash of the third IP header <b>520</b>. This may include comparing a hash of the source and destination addresses <b>522</b>, <b>524</b> with a hash of the source-address and destination-address copies <b>526</b>. <b>528</b> to ensure that they are the same.</p>
<p id="p-0102" num="0101">As shown at flow indicator <b>740</b>, the peer node <b>408</b> extracts the information from the third payload <b>518</b>. The peer node <b>408</b> may extract the information from the third payload <b>518</b> by reversing the functions carried out by the originating node shown at the flow indicators <b>706</b>, <b>704</b>, and <b>702</b>.</p>
<p id="p-0103" num="0102">As an alternative to tunneling the tunnel packet through the tunnel <b>410</b> in accordance with IPSec and to attendant costs for encrypting and authenticating under IPSec, the tunneling protocol that the peer and access nodes <b>408</b>, <b>402</b> employ may be an authentication protocol, which may be reflected in the first security-encapsulating header <b>504</b> of the communication packet. The authentication protocol may be defined so as to minimize encapsulation of the first group-encrypted traffic. Without encryption, the tunnel packet may traverse the public network <b>406</b> under conditions in which observation of the first group-encrypted traffic are viable. Although the contents of each of the first group-encrypted packets are encrypted in accordance with the first group-security policy, the relationship between the peer node <b>408</b> and the access node <b>402</b> may be clear text.</p>
<p id="p-0104" num="0103">As an alternative to minimal authentication, the authentication protocol may define a time-based window for authenticating the tunnel packet. The time-based window may define a point in time that signifies a beginning or start of the time-based window (&#x201c;start time&#x201d;) and a duration of time (&#x201c;time duration&#x201d;). The time duration is an amount of time to be counted from the start time; an expiration of which defines a time that signifies an end or termination of the time-based window (&#x201c;end time&#x201d;). The start time and the time duration may be formed (e.g., hashed or otherwise secured) to prevent unwarranted detection.</p>
<p id="p-0105" num="0104">Both of the start time and the time duration may be synchronized to a time system maintained by the peer and access nodes <b>408</b>, <b>402</b>. Each of the peer and access nodes <b>408</b>, <b>402</b> may maintain accuracies of the time system using protocols for maintaining the time system, such as Network Time Protocol (&#x201c;NTP&#x201d;), Daytime Protocol, Internet Control Message Protocol (&#x201c;ICMP&#x201d;), Hypertext Transfer Protocol (&#x201c;HTTP&#x201d;) Time Protocol (&#x201c;HTP&#x201d;), Time protocol, and the like. Alternatively, neither or only one of the peer and access nodes <b>408</b>, <b>402</b> may maintain accuracies of the time system. In this case, the start time and the time duration may be synchronized to the time system maintained by either peer node <b>408</b> or the access node <b>402</b>. An example of a tunnel packet formed in accordance with the authentication protocol is shown in <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0106" num="0105">Referring now to <figref idref="DRAWINGS">FIG. 8</figref>, a block diagram illustrating a tunnel packet <b>800</b> formed in accordance with the authentication protocol is shown. This tunnel packet <b>800</b> may be used to carry out a dynamic secured group communication. For convenience, the tunnel packet <b>800</b> is described with reference to the structure of the communication packet <b>500</b> of <figref idref="DRAWINGS">FIG. 5</figref>, to the example network architecture <b>400</b> of <figref idref="DRAWINGS">FIG. 1</figref>. The tunnel packet <b>800</b> may be used with other architectures, other group traffic, and between the other VPN nodes as well. In addition, the tunnel packet <b>800</b> of <figref idref="DRAWINGS">FIG. 8</figref> is similar to the communication packet <b>500</b> of <figref idref="DRAWINGS">FIG. 5</figref>, except as described herein below.</p>
<p id="p-0107" num="0106">The first security-encapsulation header <b>504</b> includes a token <b>802</b> for authenticating the tunnel packet <b>800</b>. The token includes a hashed time-stamp, denoted as c_tag <b>804</b>, which is carried between peer node <b>408</b> and the access node <b>402</b>. The c_tag <b>804</b> may be used by the access node <b>408</b> to ensure that the tunnel packet obtained by the access node <b>402</b> is only generated by the peer node <b>402</b>. Using the time-based window, the peer and access nodes <b>408</b>, <b>402</b> are synchronized such that the c_tag changes according the system time yet the access node <b>402</b> and/or the peer node <b>408</b> can authenticate the hashed time-stamp. This may be represented as follows:</p>
<p id="p-0108" num="0107">possible c_tag values=a keyed-Hash Message Authentication Code&#x2014;HMAC(key, timestamp)</p>
<p id="p-0109" num="0108">where:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0109">the key is key distributed from the access node <b>402</b> to the peer node;</li>
        <li id="ul0002-0002" num="0110">the time stamp is a pseudotime.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0110" num="0111">To validate the tunnel packet, the access node <b>402</b> pre-computes a number of c-tag values by applying N number of time stamps that are currently within the time-based window (e.g., 10 seconds with 1 second increments) to the HMAC(key, timestamp) function. Upon receipt of the tunnel packet, the access node <b>402</b> searches the possible c_tag values for a c_tag value that matches the c_tag <b>804</b>. A successful match indicates that the tunnel packet was generated by peer node.</p>
<p id="p-0111" num="0112">As another alternative, the c_tag values may be defined as:</p>
<p id="p-0112" num="0113">the possible c_tag values=DESX(key, timestamp&#x2225;destination_address)</p>
<p id="p-0113" num="0114">where:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0115">DESX is the variant of the Data Encryption Standard (&#x201c;DESX&#x201d;) function;</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0114" num="0116">the key is a key distributed from the access node <b>402</b> to the peer node <b>408</b>;</p>
<p id="p-0115" num="0117">the time stamp is the pseudotime; and</p>
<p id="p-0116" num="0118">the destination_address may be the second destination address <b>528</b> or some portion thereof.</p>
<p id="p-0117" num="0119">As yet another alternative, the access node <b>402</b> may, responsive to obtaining the VPN information, configure, provision and/or otherwise cause itself to function as one of the first group members to obtain the first cipher. The access node <b>402</b> may use first cipher to simply authenticate (but not decrypt) the tunnel packet.</p>
<p id="p-0118" num="0120">Analogous to the access node <b>402</b>, the peer node <b>408</b> may employ the authentication protocol. Employing the authentication protocol at the peer node <b>408</b> may be optional as the peer node <b>408</b> may decrypt and authenticate the first group-encrypted packet underlying the authentication protocol.</p>
<p id="p-0119" num="0121">As an alternative to the access node <b>408</b> distributing the key for either the HMAC or DESX function, the key may be synchronized between the peer node <b>408</b> and the access node <b>402</b> in other ways. For example, the peer node <b>408</b> and access node <b>402</b> may use traditional mechanisms such as per-peer pre-shared keys or certificates, and/or establish a secure channel through which the peer node <b>408</b> and the access node <b>408</b> may exchange the time stamp and key. The peer node <b>408</b> may, for example, synchronizes its c_tag <b>820</b> using the time stamp provide by the access node <b>402</b> and use the key to authenticate the tunnel packet. Since a time clock of the peer node <b>408</b> may drift, the access node <b>402</b> may include the c_tag <b>804</b> to enable the peer node <b>408</b> to maintain time synchronization.</p>
<p id="p-0120" num="0122"><figref idref="DRAWINGS">FIG. 9</figref> is a block diagram illustrating example network architecture <b>900</b> for carrying out a dynamic secured group communication. The network architecture <b>900</b> is similar to the network architecture <b>400</b> of <figref idref="DRAWINGS">FIG. 4</figref>, except as described herein below.</p>
<p id="p-0121" num="0123">As shown, the network architecture <b>900</b> includes a number of peer nodes <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>in addition to the peer node <b>408</b>. Each of these peer nodes <b>902</b><sub>1</sub>&#x2014;is communicatively coupled to the public network <b>406</b>, and may, for example, be embodied as and/or function as a router. Alternatively, each of the peer nodes <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>may be customer premises equipment (e.g., a desktop, laptop or other type of computer). Like the peer node <b>408</b>, each of the peer nodes <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>may route and/or forward into the public network <b>406</b> traffic it's peer traffic.</p>
<p id="p-0122" num="0124">In addition, each of the peer nodes <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>functions in the same way as the peer node <b>408</b>. As such, each of the peer nodes <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>may tunnel, in accordance with IPSec or other tunneling protocol that uses encryption, the first group-encrypted traffic via respective tunnels <b>904</b><sub>1</sub>-<b>904</b><sub>n </sub>negotiated with the access node <b>402</b>. Alternatively, each of the peer nodes <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>may use the authentication protocol to securely transport the first group-encrypted traffic via the tunnels <b>904</b><sub>1</sub>-<b>904</b><sub>n </sub></p>
<p id="p-0123" num="0125">When using the authentication protocol, each of the peer nodes <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>may use the same c_tag, key and/or other authentication parameters given that each of the peer nodes <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>securely transport only first group-encrypted traffic. If, however, one or more of the peer nodes <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>securely transport second group-encrypted traffic, then the c_tag, key and/or other authentication parameters may be different for such peer nodes <b>902</b><sub>1</sub>-<b>902</b><sub>n</sub>.</p>
<p id="p-0124" num="0126">An advantage of the foregoing is that the access node <b>402</b> may replicate the first group-encrypted traffic for multicast to each of the peer nodes <b>408</b> and <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>without having to encrypt or authenticate each tunnel packet with a unique pair-wise attribute (e.g., IPSec's matching security associations). As noted above, the access node <b>402</b> may use the HMAC(key, timestamp) or DESX(key, timestamp&#x2225;destination_address) functions to calculate the c_tag <b>804</b> to ensure that each tunnel packet exchanged between the each of the peer nodes <b>408</b> and <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>and the access node <b>408</b> are valid without having to perform encryption and/or decryption at the peer nodes <b>408</b> and <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>and/or the access node <b>408</b>. Since all the clients are synchronized with the tunnel aggregator, the tunnel aggregator can use the same c_tag for all the frames encapsulated in the NAT-T UDP/IP headers <b>505</b> for a given time frame in that group.</p>
<p id="p-0125" num="0127">Another advantage is that the peer nodes <b>408</b> and <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>and the access node <b>408</b> allow the first group-encrypted packet to traverse the public network <b>406</b> that include NAT nodes. Yet another advantage is that routing adjacencies established between each of the peer nodes <b>408</b> and <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>and the access node <b>408</b> can pass through the tunnels <b>410</b>, and <b>904</b><sub>1</sub>-<b>904</b><sub>n </sub>in an authenticated manner while not requiring encryption of such routing adjacencies.</p>
<p id="p-0126" num="0128">Although not shown, the network architecture <b>900</b> may include additional access nodes. Advantageously, each of the peer nodes <b>408</b> and <b>902</b><sub>1</sub>-<b>902</b><sub>n </sub>may establish additional tunnels to such additional access nodes. This allows for diverse routing via such tunnel overlay while continuing to use the first security relationship on any of the tunnels. This, in turn, facilitates stateful fail-over paths using such tunnels to the access nodes. Since the access nodes do not typically maintain state for the group-encryption policies; any of the access nodes still operating may be used for transport access to VPN <b>112</b>.</p>
<p id="p-0127" num="0129">Example Network Node Architecture</p>
<p id="p-0128" num="0130"><figref idref="DRAWINGS">FIG. 10</figref> is a block diagram illustrating an example network node <b>1000</b> for use with carrying out a dynamic secured group communication. This network node <b>1000</b> may embody any of the network nodes discussed above.</p>
<p id="p-0129" num="0131">The network node <b>1000</b> may include a number of elements, many of which are not shown for simplicity of exposition. The network node <b>1000</b> may be formed as or in a single unitary device and concentrated on a single server, client, peer or other type node. Alternatively, the network node <b>1000</b> may be formed in or from one or more separate devices, and as such, may be distributed among a number of server, client, peer or other type nodes. The network node <b>1000</b> may be scalable (i.e., may employ scale-up and/or scale-out approaches). In addition, the network node <b>1000</b> may be integrated into or otherwise combined with another apparatus.</p>
<p id="p-0130" num="0132">As shown, the network node <b>1000</b> includes logic <b>1002</b>, memory <b>1004</b> and an input/output (&#x201c;I/O interface&#x201d;) <b>1006</b>; some or all of which may be coupled together via one or more communication links <b>1008</b>. The logic <b>1002</b> is operable to control, manipulate or otherwise interact with the memory <b>1004</b> and/or the I/O interface <b>1006</b> via the respective communication links <b>1008</b>.</p>
<p id="p-0131" num="0133">To facilitate this, the logic <b>1002</b> may include one or more processing units (collectively &#x201c;processor&#x201d;) <b>1010</b> and support circuits <b>1012</b>. The processor <b>1010</b> may be one or more conventional processors, microprocessors, multi-core processors and/or microcontrollers. The support circuits <b>1012</b> facilitate operation of the processor <b>1010</b> and may include well-known circuitry or circuits, including, for example, an I/O interface; cache; clock circuits; power supplies; and the like.</p>
<p id="p-0132" num="0134">The memory <b>1004</b> may store and/or receive requests from the processor <b>1010</b> to obtain and/or store the VPN information. In addition, the memory <b>1004</b> may store and/or receive requests from the processor <b>1010</b> to obtain various software packages, such as an operating system <b>1014</b> and software for carrying out one or more of the security policies (&#x201c;security-policy software <b>1016</b>&#x201d;). The memory <b>1004</b> may also store and receive requests from the processor <b>1010</b> to obtain operands, operators, dimensional values, configurations, and other data that are used by the operating system <b>1014</b> and the security-policy software <b>1016</b> to control operation of and/or to facilitate performing the functions of the network node <b>1000</b>. To facilitate the foregoing, the memory <b>1004</b> may be or employ random access memory, read-only memory, optical storage, magnetic storage, removable storage, erasable programmable read only memory and variations thereof, content addressable memory and variations thereof, flash memory, disk drive storage, removable storage, any combination thereof, and the like.</p>
<p id="p-0133" num="0135">The communication links <b>1008</b> provide for transmissions of analog or digital information among the logic <b>1002</b>, the memory <b>1004</b>, the I/O interface <b>1006</b> and other portions of the network node <b>1000</b> (shown and not shown). The I/O interface <b>1006</b> is adapted to control transmissions of information, such as the VPN information, between (shown and not shown) elements of the network node <b>1000</b>, such as the logic <b>1002</b> and the memory <b>1004</b>.</p>
<p id="p-0134" num="0136">In addition, the I/O interface <b>1006</b> is adapted to control transmissions of information, such as the VPN information, between elements of the network node <b>1000</b>, an external data source and other I/O devices disposed within, associated with or otherwise attached or coupled to the network node <b>1000</b>. Examples of the I/O devices include (i) a monitor, (ii) any or any combination of storage devices, including but not limited to, a tape drive, a floppy drive, a hard disk drive or a compact disk drive, (iii) a receiver and/or a transmitter, (iv) a speaker, (v) a display, (vi) a speech synthesizer, (vii) an output port, and (viii) the like. The external data source may be, for example, a key management server (not shown) as provided in the above-incorporated U.S. patent application Ser. No. 10/867,266 filed Jun. 14, 2004 (now U.S. Pat. No. 7,509,491), and/or in the above-incorporated <i>Cisco Group Encrypted Transport VPN </i>(<i>Cisco IOS Security Configuration Guide</i>), Cisco Systems, Inc. Nov. 17, 2006, (ii) <i>Cisco Group Encrypted Transport VPN Data Sheet and/or Technical Overview. </i></p>
<p id="p-0135" num="0137">The operating system <b>1014</b> may include code for operating the network node <b>1000</b> and for providing a platform onto which the security-policy software <b>1016</b> can be executed. The security-policy software <b>1016</b> may be in any of a standalone, client/server, peer-to-peer and other format. In addition, the security-policy software <b>1026</b> may include code for facilitating the forming of the first and second security relationships. The security-policy software <b>1016</b> may also include code to facilitate carrying out of any of the communication flows <b>300</b>, <b>600</b> and <b>800</b>.</p>
<heading id="h-0006" level="1">CONCLUSION</heading>
<p id="p-0136" num="0138">Those skilled in the art will appreciate that the present invention, according to its various embodiments, Variations of the method, apparatus and system described above are possible without departing from the scope of the invention. In view of the wide variety of embodiments that can be applied, it should be understood that the illustrated embodiments are exemplary only, and should not be taken as limiting the scope of the following claims. For instance, in the exemplary embodiments described herein include handheld devices, which may include or be utilized with any appropriate voltage source, such as a battery and the like, providing any appropriate voltage.</p>
<p id="p-0137" num="0139">In addition to the tunneling protocol discussed above, the tunneling protocol may include any or any combination of Internet Protocol security (&#x201c;IPSec&#x201d;); Generic Routing Encapsulation (&#x201c;GRE&#x201d;); IP in IP tunneling; Layer 2 Tunneling Protocol (&#x201c;L2TP&#x201d;); Multi-protocol Label Switching (&#x201c;MPLS&#x201d;); General-Packet-Radio Service (&#x201c;GPRS&#x201d;) Tunneling Protocol (&#x201c;GTP&#x201d;); Point-to-Point Tunneling Protocol (&#x201c;PPTP&#x201d;); Point-to-Point Protocol over Ethernet (&#x201c;PPPoE&#x201d;); Point-to-Point Protocol over ATM (&#x201c;PPPoA&#x201d;); Institute of Electrical and Electronic Engineers (&#x201c;IEEE&#x201d;) 802.1Q; IPversion 6 (&#x201c;IPv6&#x201d;) tunneling, such as 6 to 4, 6 in4, Teredo; Anything In Anything (&#x201c;AYIYA&#x201d;) such as IPv6 over UDP over IPv4, IPv4 over IPv6, IPv6 over TCP IPv4, etc.); and/or modifications, revisions, versions and/or changes thereto (as described above or otherwise known or documented).</p>
<p id="p-0138" num="0140">Moreover, in the embodiments described above, processing platforms, computing systems, controllers, and other devices containing processors are noted. These devices may contain at least one Central Processing Unit (&#x201c;CPU&#x201d;) and memory. In accordance with the practices of persons skilled in the art of computer programming, reference to acts and symbolic representations of operations or instructions may be performed by the various CPUs and memories. Such acts and operations or instructions may be referred to as being &#x201c;executed,&#x201d; &#x201c;computer executed&#x201d; or &#x201c;CPU executed.&#x201d;</p>
<p id="p-0139" num="0141">One of ordinary skill in the art will appreciate that the acts and symbolically represented operations or instructions include the manipulation of electrical signals by the CPU. An electrical system represents data bits that can cause a resulting transformation or reduction of the electrical signals and the maintenance of data bits at memory locations in a memory system to thereby reconfigure or otherwise alter the CPU's operation, as well as other processing of signals. The memory locations where data bits are maintained are physical locations that have particular electrical, magnetic, optical, or organic properties corresponding to or representative of the data bits. It should be understood that the exemplary embodiments are not limited to the above-mentioned platforms or CPUs and that other platforms and CPUs may support the described methods.</p>
<p id="p-0140" num="0142">The data bits may also be maintained on a computer readable medium including magnetic disks, optical disks, and any other volatile (e.g., Random Access Memory (&#x201c;RAM&#x201d;)) or non-volatile (e.g., Read-Only Memory (&#x201c;ROM&#x201d;)) mass storage system readable by the CPU. The computer readable medium may include cooperating or interconnected computer readable medium, which exist exclusively on the processing system or are distributed among multiple interconnected processing systems that may be local or remote to the processing system. It should be understood that the exemplary embodiments are not limited to the above-mentioned memories and that other platforms and memories may support the described methods.</p>
<p id="p-0141" num="0143">Exemplary embodiments have been illustrated and described. Further, the claims should not be read as limited to the described order or elements unless stated to that effect. In addition, use of the term &#x201c;means&#x201d; in any claim is intended to invoke 35 U.S.C. &#xa7;112, &#xb6; 6, and any claim without the word &#x201c;means&#x201d; is not so intended.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. One or more non-transitory computer readable storage media encoded with software comprising computer executable instructions and when the software is executed operable to:
<claim-text>obtain a first packet that includes a first Internet Protocol (IP) header and a first payload, wherein the first IP header includes a first source address of a first source node of a first private network and a first destination address of a first destination node of the first private network, and the first payload includes a second packet that has a second IP header and a second payload, the second IP header having a second source address of a second source node of a second virtual private network partitioned from resources of, formed over, established within or via, the first private network and a second destination address of a second destination node of the second virtual private network;</claim-text>
<claim-text>encrypt the first packet to form an encrypted-subnet packet;</claim-text>
<claim-text>encapsulate the encrypted-subnet packet with a group-security association formed in accordance with a group-security policy to generate a group-encrypted packet using a tunneling protocol for tunneling the group-encrypted packet between the first source node of the first network and the first destination node of the first private network such that only the first source node of the first private network and the first destination node of the first private network are able to decipher the encrypted-subnet packet that is encapsulated in the group-encrypted packet with a message-authentication code identified for the encrypted-subnet packet, wherein the encrypted-subnet packet comprises a first security-encapsulating header configured with identifiers of the first source node, the first destination node, the second source node, and the second destination node;</claim-text>
<claim-text>replicate the group-encrypted packet at the first source node of the first private network such that the group-encrypted packet follows a multicast distribution tree in the first private network; and</claim-text>
<claim-text>transmit the group-encrypted packet into the second virtual private network from the second source node for delivery to the second destination node.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The computer readable storage media of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising computer executable instructions operable to:
<claim-text>encrypt the second packet in the first payload; and</claim-text>
<claim-text>encapsulate the second packet with a security policy to create a second security-encapsulating header configured with identifiers of the second source node and the second destination node.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The computer readable storage media of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the instructions operable to encrypt comprise instructions operable to encrypt the first packet with a security association for securing the first packet using a cipher, wherein the cipher is pre-negotiated to be associated to (i) a security credential established by at least one node of the first network and (ii) an indicator that indicates that the first source node and the first destination node belong to the first private network.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The computer readable storage media of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the instructions operable to encrypt comprise instructions operable to encrypt the second IP header with a security association for authenticating the second source node.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The computer readable storage media of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the instructions operable to encrypt comprise instructions operable to encrypt the second IP header with the security association that comprises a token used for authenticating the group-encrypted packet by the tunneling protocol.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The computer readable storage media of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the instructions operable to encrypt comprise instructions operable to encrypt the second IP header using the token that is based on (i) a time system maintained by the second destination node, and (ii) a shared secret maintained by the second destination node.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. One or more non-transitory computer readable storage media encoded with software comprising computer executable instructions and when the software is executed operable to:
<claim-text>obtain a first packet that includes a first Internet Protocol (IP) header, a security-encapsulating header and a first payload, wherein the first IP header includes a first source address of a first source node of a first private network and a first destination address of a first destination node of the first network, the first payload includes a second packet that has a second IP header and a second payload, the second IP header having a second source address of a second source node of a second virtual private network partitioned from resources of, formed over, established within or via, the first private network and an encrypted second destination address of a second destination node of the second virtual private network;</claim-text>
<claim-text>encrypt the first packet to form an encrypted-subnet packet;</claim-text>
<claim-text>encapsulate the encrypted-subnet packet with a group-security association formed in accordance with a group-security policy to generate a group-encrypted packet using a tunneling protocol for tunneling the group-encrypted packet between the first source node of the first network and the first destination node of the first private network such that only the first source node of the first private network and the first destination node of the first private network are able to decipher the encrypted-subnet packet that is encapsulated in the group-encrypted packet with a message-authentication code identified for the encrypted-subnet packet, wherein the encrypted-subnet packet comprises a first security-encapsulating header configured with identifiers of the first source node, the first destination node, the second source node, and the second destination node;</claim-text>
<claim-text>replicate the group-encrypted packet at the first source node of the first private network such that the group-encrypted packet follows a multicast distribution tree in the first private network; and</claim-text>
<claim-text>transmit the group-encrypted packet into the second virtual private network from the first private network for delivery to the second destination node.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The computer readable storage media of <claim-ref idref="CLM-00007">claim 7</claim-ref>, further comprising computer executable instructions operable to:
<claim-text>encrypt the second packet in the first payload; and</claim-text>
<claim-text>encapsulate the second packet with a security policy to create a second security-encapsulating header configured with identifiers of the second source node and the second destination node.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The computer readable storage media of <claim-ref idref="CLM-00007">claim 7</claim-ref>, further comprising computer executable instructions operable to:
<claim-text>authenticate the group-encrypted packet based on the identifiers in the security-encapsulating header;</claim-text>
<claim-text>extract the encrypted-subnet packet from the group-encrypted packet; and</claim-text>
<claim-text>obtain the first packet from the encrypted-subnet packet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The computer readable storage media of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the instructions operable to encrypt comprise instructions operable to encrypt the first packet with a security association for securing the first packet using a cipher, wherein the cipher is pre-negotiated to be associated to (i) a security credential established by at least one node of the second network and (ii) an indicator that indicates that the second source node and the second destination node belong to the first private network.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The computer readable storage media of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the instructions operable to encrypt comprise instructions operable to encrypt the second IP header with a security association for authenticating the second source node.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The computer readable storage media of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the instructions operable to encrypt comprise instructions operable to encrypt the second IP header with the security association that comprises a token used for authenticating the group-encrypted packet by the tunneling protocol.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The computer readable storage media of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the instructions operable to encrypt comprise instructions operable to encrypt the second IP header with a security association for authenticating the second source node.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The computer readable storage media of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the instructions operable to encrypt comprise instructions operable to encrypt the second IP header using the token that is based on (i) a time system maintained by the first source node, and (ii) a shared secret maintained by the first source node.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. One or more non-transitory computer readable storage media encoded with software comprising computer executable instructions and when the software is executed operable to:
<claim-text>obtain a first packet that includes a first Internet Protocol (IP) header and a first payload, wherein the first IP header includes a first source address of a first source node of a first private network and a first destination address of a first destination node of the first network, the first payload includes a second packet that has a second IP header and a second payload, the second IP header having a second source address of a second source node of a second virtual private network partitioned from resources of, formed over, established within or via, the first private network and a second destination address of a second destination node of the second network;</claim-text>
<claim-text>encrypt the second packet to form a first encrypted-subnet packet;</claim-text>
<claim-text>encapsulate the first encrypted-subnet packet with a first group-security association formed in accordance with a first group-security policy to form a first group-encrypted packet using a tunneling protocol for tunneling the group-encrypted packet between the first source node of the first network and the first destination node of the first private network such that only the first source node of the first private network and the first destination node of the first private network are able to decipher the encrypted-subnet packet that is encapsulated in the group-encrypted packet with a message-authentication code identified for the encrypted-subnet packet, wherein the first encrypted-subnet packet comprises a first security-encapsulating header configured with identifiers of the first source node, the first destination node, the second source node, and the second destination node;</claim-text>
<claim-text>encrypt the first group-encrypted packet to form a second encrypted-subnet packet;</claim-text>
<claim-text>encapsulate the second encrypted-subnet packet with a second group-security association formed in accordance with a second group-security policy to form a second group-encrypted packet using a tunneling protocol for tunneling the second group-encrypted packet between the second source node of the second private network and the second destination node of the second virtual private network such that only the second source node of the second virtual private network and the second destination node of the second virtual private network are able to decipher the second encrypted-subnet packet that is encapsulated in the second group-encrypted packet with a message-authentication code identified for the second encrypted-subnet packet, wherein the second encrypted-subnet packet comprises a security-encapsulating header configured with identifiers of the second source node, the second destination node, the second source node, and the second destination node;</claim-text>
<claim-text>replicate the first group-encrypted packet at the first source node of the first private network such that the first group-encrypted packet follows a multicast distribution tree in the first private network; and</claim-text>
<claim-text>transmit the second group-encrypted packet for delivery to the second destination node of the second virtual private network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The one or more computer readable storage media of <claim-ref idref="CLM-00015">claim 15</claim-ref>, further comprising computer instructions operable to:
<claim-text>encrypt the second packet in the first payload; and</claim-text>
<claim-text>encapsulate the second packet with a security policy to create a second security-encapsulating header configured with identifiers of the second source node and the second destination node.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. An apparatus comprising:
<claim-text>an input-output (I/O) interface unit;</claim-text>
<claim-text>a memory; and</claim-text>
<claim-text>a processor coupled to the I/O interface unit and the memory and configured to:
<claim-text>obtain a first packet that includes a first Internet Protocol (IP) header and a first payload, wherein the first IP header includes a first source address of a first source node of a first private network and a first destination address of a first destination node of the first private network, and the first payload includes a second packet that has a second IP header and a second payload, the second IP header having a second source address of a second source node of a second virtual private network partitioned from resources of, formed over, established within or via, the first private network and a second destination address of a second destination node of the second virtual private network;</claim-text>
<claim-text>encrypt the first packet to form an encrypted-subnet packet;</claim-text>
<claim-text>encapsulate the encrypted-subnet packet with a group-security association formed in accordance with a group-security policy to generate a group-encrypted packet using a tunneling protocol for tunneling the group-encrypted packet between the first source node of the first network and the first destination node of the first private network such that only the first source node of the first private network and the first destination node of the first private network are able to decipher the encrypted-subnet packet that is encapsulated in the group-encrypted packet with a message-authentication code identified for the encrypted-subnet packet, wherein the encrypted-subnet packet comprises a first security-encapsulating header configured with identifiers of the first source node, the first destination node, the second source node, and the second destination node;</claim-text>
<claim-text>replicate the group-encrypted packet at the first source node of the first private network such that the group-encrypted packet follows a multicast distribution tree in the first private network; and</claim-text>
<claim-text>transmit the group-encrypted packet into the second virtual private network from the second source node for delivery to the second destination node.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The apparatus of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein the processor is further configured to:
<claim-text>encrypt the second packet in the first payload; and</claim-text>
<claim-text>encapsulate the second packet with a security policy to create a second security-encapsulating header configured with identifiers of the second source node and the second destination node.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. An apparatus comprising:
<claim-text>an input-output (I/O) interface unit;</claim-text>
<claim-text>a memory; and</claim-text>
<claim-text>a processor coupled to the I/O interface unit and the memory and configured to:
<claim-text>obtain a first packet that includes a first Internet Protocol (IP) header, a security-encapsulating header and a first payload, wherein the first IP header includes a first source address of a first source node of a first private network and a first destination address of a first destination node of the first network, the first payload includes a second packet that has a second IP header and a second payload, the second IP header having a second source address of a second source node of a second virtual private network partitioned from resources of, formed over, established within or via, the first private network and an encrypted second destination address of a second destination node of the second virtual private network;</claim-text>
<claim-text>encrypt the first packet to form an encrypted-subnet packet;</claim-text>
<claim-text>encapsulate the encrypted-subnet packet with a group-security association formed in accordance with a group-security policy to generate a group-encrypted packet using a tunneling protocol for tunneling the group-encrypted packet between the first source node of the first network and the first destination node of the first private network such that only the first source node of the first private network and the first destination node of the first private network are able to decipher the encrypted-subnet packet that is encapsulated in the group-encrypted packet with a message-authentication code identified for the encrypted-subnet packet, wherein the encrypted-subnet packet comprises a first security-encapsulating header configured with identifiers of the first source node, the first destination node, the second source node, and the second destination node;</claim-text>
<claim-text>replicate the group-encrypted packet at the first source node of the first private network such that the group-encrypted packet follows a multicast distribution tree in the first private network; and</claim-text>
<claim-text>transmit the group-encrypted packet into the second virtual private network from the first private network for delivery to the second destination node.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The apparatus of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the processor is further configured to:
<claim-text>authenticate the group-encrypted packet based on the identifiers in the security-encapsulating header;</claim-text>
<claim-text>extract the encrypted-subnet packet from the group-encrypted packet; and</claim-text>
<claim-text>obtain the first packet from the encrypted-subnet packet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. An apparatus comprising:
<claim-text>an input-output (I/O) interface unit;</claim-text>
<claim-text>a memory; and</claim-text>
<claim-text>a processor coupled to the I/O interface unit and the memory and configured to:
<claim-text>obtain a first packet that includes a first Internet Protocol (IP) header and a first payload, wherein the first IP header includes a first source address of a first source node of a first private network and a first destination address of a first destination node of the first network, the first payload includes a second packet that has a second IP header and a second payload, the second IP header having a second source address of a second source node of a second virtual private network partitioned from resources of, formed over, established within or via, the first private network and a second destination address of a second destination node of the second network;</claim-text>
<claim-text>encrypt the second packet to form a first encrypted-subnet packet;</claim-text>
<claim-text>encapsulate the first encrypted-subnet packet with a first group-security association formed in accordance with a first group-security policy to form a first group-encrypted packet using a tunneling protocol for tunneling the group-encrypted packet between the first source node of the first network and the first destination node of the first private network such that only the first source node of the first private network and the first destination node of the first private network are able to decipher the encrypted-subnet packet that is encapsulated in the group-encrypted packet with a message-authentication code identified for the encrypted-subnet packet, wherein the first encrypted-subnet packet comprises a first security-encapsulating header configured with identifiers of the first source node, the first destination node, the second source node, and the second destination node;</claim-text>
<claim-text>encrypt the first group-encrypted packet to form a second encrypted-subnet packet;</claim-text>
<claim-text>encapsulate the second encrypted-subnet packet with a second group-security association formed in accordance with a second group-security policy to form a second group-encrypted packet using a tunneling protocol for tunneling the second group-encrypted packet between the second source node of the second private network and the second destination node of the second virtual private network such that only the second source node of the second virtual private network and the second destination node of the second virtual private network are able to decipher the second encrypted-subnet packet that is encapsulated in the second group-encrypted packet with a message-authentication code identified for the second encrypted-subnet packet, wherein the second encrypted-subnet packet comprises a security-encapsulating header configured with identifiers of the second source node, the second destination node, the second source node, and the second destination node;</claim-text>
<claim-text>replicate the first group-encrypted packet at the first source node of the first private network such that the first group-encrypted packet follows a multicast distribution tree in the first private network; and</claim-text>
<claim-text>transmit the second group-encrypted packet for delivery to the second destination node of the second virtual private network.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The apparatus of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the processor is further configured to:
<claim-text>encrypt the second packet in the first payload; and</claim-text>
<claim-text>encapsulate the second packet with a security policy to create a second security-encapsulating header configured with identifiers of the second source node and the second destination node.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
