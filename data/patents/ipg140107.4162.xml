<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625231-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625231</doc-number>
<kind>B1</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13672567</doc-number>
<date>20121108</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>11</class>
<subclass>B</subclass>
<main-group>5</main-group>
<subgroup>596</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>360 7704</main-classification>
<further-classification>360 75</further-classification>
</classification-national>
<invention-title id="d2e43">Adjusting VGA analog gain for misaligned servo sectors in a disk drive</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4549232</doc-number>
<kind>A</kind>
<name>Axmear et al.</name>
<date>19851000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7707</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5117408</doc-number>
<kind>A</kind>
<name>Weispfenning et al.</name>
<date>19920500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7814</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5136439</doc-number>
<kind>A</kind>
<name>Weispfenning et al.</name>
<date>19920800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5182682</doc-number>
<kind>A</kind>
<name>Weispfenning et al.</name>
<date>19930100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>5774298</doc-number>
<kind>A</kind>
<name>Cheung et al.</name>
<date>19980600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>5796535</doc-number>
<kind>A</kind>
<name>Tuttle et al.</name>
<date>19980800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>5818659</doc-number>
<kind>A</kind>
<name>Cheung et al.</name>
<date>19981000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>5966258</doc-number>
<kind>A</kind>
<name>Bliss</name>
<date>19991000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6052804</doc-number>
<kind>A</kind>
<name>Thowe et al.</name>
<date>20000400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6078445</doc-number>
<kind>A</kind>
<name>Serrano et al.</name>
<date>20000600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6144513</doc-number>
<kind>A</kind>
<name>Reed et al.</name>
<date>20001100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>6195220</doc-number>
<kind>B1</kind>
<name>Ellis et al.</name>
<date>20010200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>6324030</doc-number>
<kind>B1</kind>
<name>Cheung et al.</name>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>6469849</doc-number>
<kind>B1</kind>
<name>Ellis et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>6873483</doc-number>
<kind>B2</kind>
<name>Hetzler et al.</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>6967808</doc-number>
<kind>B1</kind>
<name>Bandic et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>6975471</doc-number>
<kind>B2</kind>
<name>Bandic et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>7016140</doc-number>
<kind>B1</kind>
<name>Schultz et al.</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 75</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>7268969</doc-number>
<kind>B2</kind>
<name>Schultz</name>
<date>20070900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7704</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>7551390</doc-number>
<kind>B1</kind>
<name>Wang et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>7663835</doc-number>
<kind>B1</kind>
<name>Yu et al.</name>
<date>20100200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>8446687</doc-number>
<kind>B2</kind>
<name>Hironaka et al.</name>
<date>20130500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 75</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2005/0248873</doc-number>
<kind>A1</kind>
<name>Coker et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 75</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>2005/0249106</doc-number>
<kind>A1</kind>
<name>Coker et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>3692751</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>2005/0254156</doc-number>
<kind>A1</kind>
<name>Bandic et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>2005/0254160</doc-number>
<kind>A1</kind>
<name>Bandic et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>2011/0188147</doc-number>
<kind>A1</kind>
<name>Cho et al.</name>
<date>20110800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>2012/0014011</doc-number>
<kind>A1</kind>
<name>Wilson</name>
<date>20120100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>17</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>19</number-of-drawing-sheets>
<number-of-figures>31</number-of-figures>
</figures>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only" applicant-authority-category="assignee">
<addressbook>
<orgname>HGST Netherlands B.V.</orgname>
<address>
<city>Amsterdam</city>
<country>NL</country>
</address>
</addressbook>
<residence>
<country>NL</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Dhanda</last-name>
<first-name>Abhishek</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Hirano</last-name>
<first-name>Toshiki</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Semba</last-name>
<first-name>Tetsuo</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Knight</last-name>
<first-name>G. Marlin</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>HGST Netherlands B.V.</orgname>
<role>03</role>
<address>
<city>Amsterdam</city>
<country>NL</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Nguyen</last-name>
<first-name>Hoa T</first-name>
<department>2686</department>
</primary-examiner>
<assistant-examiner>
<last-name>Habermehl</last-name>
<first-name>James L</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Embodiments of the invention include data storage system with a servo system with a VGA feedback loop that corrects gain errors for servo bursts arising from track phase misalignment and difference in frequencies between AGC and servo bursts for seamed and seamless servo patterns. After the servo fields have been written as part of the manufacturing process, in one embodiment measurements of phase misalignment are made and recorded in nonvolatile memory for use during normal operation of the drive. One embodiment includes measuring misalignment using relative signal magnitudes from test bursts with various linear densities written in a data area during the self-servo writing process. In an alternative embodiment the measurements of phase misalignment can be made real-time during normal operation of the drive.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="220.39mm" wi="187.79mm" file="US08625231-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="240.88mm" wi="192.79mm" file="US08625231-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="215.82mm" wi="191.77mm" file="US08625231-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="206.25mm" wi="193.38mm" file="US08625231-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="219.79mm" wi="193.38mm" file="US08625231-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="202.27mm" wi="193.72mm" file="US08625231-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="163.41mm" wi="194.06mm" file="US08625231-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="186.52mm" wi="187.79mm" file="US08625231-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="237.57mm" wi="175.60mm" file="US08625231-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="219.79mm" wi="189.15mm" file="US08625231-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="168.99mm" wi="175.26mm" file="US08625231-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="228.01mm" wi="180.26mm" file="US08625231-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="235.29mm" wi="171.62mm" file="US08625231-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="143.34mm" wi="181.19mm" file="US08625231-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="241.81mm" wi="170.01mm" file="US08625231-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="156.46mm" wi="184.15mm" file="US08625231-20140107-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="238.51mm" wi="192.45mm" file="US08625231-20140107-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="205.57mm" wi="194.73mm" file="US08625231-20140107-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="180.59mm" wi="198.71mm" file="US08625231-20140107-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00019" num="00019">
<img id="EMI-D00019" he="202.27mm" wi="186.52mm" file="US08625231-20140107-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present invention relates generally to disk drive technology, and more particularly to means for processing servo signals generated by magnetic servo patterns on a rotating disk.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">Magnetic disk drive systems typically include one or more sliders that contain read and write heads that are used to read and write data in thin film magnetic media on one of more rotating disks. The sliders are mounted on a movable actuator that is positioned by a servo system over the rotating disk using a VCM. The information in the thin film magnetic material on each disk surface is organized into concentric circular tracks that are further divided into angularly spaced servo sectors. Each sector has servo information permanently recorded therein as a part of the manufacturing process. The user data in the sector follows the servo information. The servo information typically includes track and sector location information, automatic gain control (AGC) fields, timing sync signals, and servo bursts. The servo bursts are arranged in specially designed patterns to generate a read head signal that gives fractional track centerline information from which the drive's controller can determine where the read head is in relation to the center of the track. One typical servo burst pattern includes four bursts referred to as A, B, C and D and is called a quad-burst pattern. <figref idref="DRAWINGS">FIG. 1A</figref> is a block diagram illustrating the allocated linear positioning of fields in a quad burst servo pattern according to the prior art. The actual cross-track positions of the A, B, C and D bursts are arranged in a repeating pattern that provides the fractional track centerline information. Depending upon the SNR requirements, the burst pattern may be written at lower linear densities than the AGC field. The cross-track widths of the servo bursts can be equal to one-track width, but other widths can be used such as two-thirds or one-half of a track width. An alternate servo system using a &#x201c;null pattern&#x201d; using P and Q bursts is illustrated in <figref idref="DRAWINGS">FIG. 1B</figref>. <figref idref="DRAWINGS">FIG. 1C</figref> illustrates two adjacent tracks that have a servo burst pattern written at one-half of a track width. The &#x201c;+&#x201d; and &#x201c;&#x2212;&#x201d; symbols represent the two magnetic orientations that have been previously written in the thin film magnetic material on the disk during the manufacturing process.</p>
<p id="p-0004" num="0003">Seamless servo writing techniques use independent positioning of the bursts and AGC fields during servo writing process such that different regions of a servo pattern are written in different steps or passes. Seamless and seamed servo burst patterns using P and Q bursts have also been developed.</p>
<p id="p-0005" num="0004"><figref idref="DRAWINGS">FIG. 1D</figref> illustrates two adjacent tracks that have a servo burst pattern written at one-half of a track width with both AGC and servo burst fields written in a seamed manner in four passes which are represented by the circled numbers 1-4. <figref idref="DRAWINGS">FIG. 1E</figref> illustrates the write gate pattern for the four phases of the writing process for two tracks k and k+1 illustrated in <figref idref="DRAWINGS">FIG. 1D</figref>. In each of the four phases the AGC, P and Q are written as one-half track width.</p>
<p id="p-0006" num="0005"><figref idref="DRAWINGS">FIGS. 1F and 1G</figref> illustrate the four phases of writing a seamed AGC with seamless P and Q bursts on two adjacent tracks. In each of the four phases the AGC is written, but the P burst is only written on the first and third phase and the Q burst is only written on the second and fourth phase. In this example and the following ones, the two track pattern is repeated for the entire set of tracks.</p>
<p id="p-0007" num="0006"><figref idref="DRAWINGS">FIGS. 1H and 1I</figref> illustrate the four phases of writing a seamless AGC with seamed P and Q bursts on two adjacent tracks. In each of the four phases the P and Q bursts are written, but the AGC is only written on the first and third phase. <figref idref="DRAWINGS">FIGS. 1J and 1K</figref> illustrate the four phases of writing a seamed AGC with seamless P and Q bursts on two adjacent tracks. The AGC is only written on the first and third phase. The P bursts are written on the first and third phase, and the Q bursts are written on the second and fourth phase.</p>
<p id="p-0008" num="0007">The servo fields define the track width and the pitch. Ideally each track will have the same width and the track pitch will be constant as illustrated in <figref idref="DRAWINGS">FIG. 1L</figref>. The width of the track is defined during the servo writing process. <figref idref="DRAWINGS">FIG. 1M</figref> illustrates a problem case in which the track pitch in one track (k+1) has a narrower width than the other tracks. This is called track squeeze.</p>
<p id="p-0009" num="0008">The signals generated in the read head by the servo fields are processed by the drive's electronics that include a pre-amplifier and a read/write channel. In US patent application 20110188147 by Cho, et al. (Aug. 4, 2011) a method of adjusting gain of a variable gain amplifier (VGA) of a read/write channel is described. The VGA amplifies a signal provided by the pre-amplifier based on a gain control signal of the AGC.</p>
<p id="p-0010" num="0009">US patent application 20120014011 by Wilson (Jan. 19, 2012) describes a magnetic recording system with a read channel that includes a variable gain amplifier (VGA) and continuous-time filter (CTF), and an analog-to-digital converter (ADC) <b>122</b> connected in series to produce an input signal for a digital signal processing (DSP) block. The input signal for the read channel comes from the preamp which includes a loopback channel that allows a user to characterize frequency response at selected frequencies, and to derive a correction factor to remove gain changes. The loopback channel supports low-nm fly-height measurement. The loopback channel also allows write data-to-read data timing to be measured, in support of bit-patterned media (BPM).</p>
<p id="p-0011" num="0010">U.S. Pat. No. 7,551,390 to Wang, et al. (Jun. 23, 2009) describes a method to characterize misaligned servo wedges. The servo controller is used to characterize misaligned servo wedges by implementing operations including: commanding the head to track follow on a track; measuring wedge-to-wedge time (WTWT) values corresponding to time intervals between identified servo wedges; calculating wedge-to-wedge time (WTWT) variations for the measured WTWT values; and characterizing the calculated WTWT variations, wherein, characterizing the calculated WTWT variations for the track includes utilizing a WTWT variation modeling function to model the WTWT variations.</p>
<p id="p-0012" num="0011">In U.S. Pat. No. 7,663,835 (Feb. 16, 2010) Yu, et al. describe a method of measuring track squeeze based on ABCD burst readback profile. The method is based on using head read-out signal for servo bursts (A, B, C, D) to estimate the servo written-in errors or track squeeze by comparing measured burst readings to nominal values. This method requires an accurate burst readback profile. The voltage readback will vary based on the amount of phase misalignment and thereby introduce error in burst readback measurement.</p>
<p id="p-0013" num="0012">Track misalignment refers to finite circumferential shift in servo sector locations between adjacent tracks. Misalignment arises from disturbance in servo writing process (SSW) which results in deviation from ideal servo sector location. <figref idref="DRAWINGS">FIGS. 2A-D</figref> illustrate a track misalignment problem in the prior art in various combinations of seamed and seamless AGC and P-Q burst servo formats.</p>
<p id="p-0014" num="0013">Track misalignment causes magnetic signal loss, which is addressed by the present invention. As illustrated in <figref idref="DRAWINGS">FIG. 3</figref>, for the same physical misalignment, signal loss is different for 1T versus 2T servo patterns (where T is related to the linear bit density of the signal).</p>
<p id="p-0015" num="0014">As illustrated in <figref idref="DRAWINGS">FIGS. 4A-B</figref>, track misalignment in seamless patterns is further complicated where AGC, P and Q bursts can have different misalignment. This results in further distortion in burst profile where one burst has same misalignment as AGC while other burst does not. VGA gain adjustment follows AGC misalignment.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0016" num="0015">Embodiments of the invention include data storage system with a servo system with a VGA feedback loop that corrects gain errors for servo bursts arising from track phase misalignment and difference in frequencies between AGC and servo bursts for seamed and seamless servo patterns. After the servo fields have been written as part of the manufacturing process, in one embodiment measurements of phase misalignment are made and recorded in a table in nonvolatile memory for use during normal operation of the drive. In an alternative embodiment the measurements of phase misalignment can be made real-time during normal operation of the drive. One embodiment measures the phase mismatch by opening the burst gate a fixed time delay after the sync mark. Another embodiment writes selected test bursts with differing linear bit density in the user data as part of the manufacturing process and then measures the relative magnitude of the readback signals to determine misalignment. The test bursts are written at the same time as servo fields during self-servo writing (SSW) and, therefore, will have same misalignment, if any, as the functional servo burst fields. Once the misalignment test is done, these additional test bursts are overwritten when user data is written in the standard way. The measured misalignments are used to separately correct the VGA gain, for example, for the P and Q bursts.</p>
<p id="p-0017" num="0016">The invention addresses the problem of phase mismatch causing different gain loss for 1T versus 2T versus 4T signals where T is the time period corresponding to the linear bit density. VGA gain is corrected (adjusted) for difference in AGC versus burst frequencies for misaligned tracks. The VGA feedback loop makes adjustments for gain errors induced by phase mismatch. The invention provides correct cross-track burst profiles for servo sectors with significant phase mismatch with respect to adjacent tracks. Gain for the burst signal is adjusted to take into account half-frequency of ABCD or PQ burst signals. The results are reduced measurement noise for servo metrics that are based on cross-track burst profile/VGA values and direct improvement in track squeeze measurement. The contribution of down-track phase shift from squeeze metric is removed. The invention provides accurate measurement of VGA change due to fly height/magnetic effects and removes VGA gain change arising from phase mismatch. Since 2T or 4T bursts can result in voltage saturation if large erroneous gain is selected in VGA loop, AGC saturation for servo with large phase mismatch is prevented which allows more accurate tuning of VGA gain.</p>
<p id="p-0018" num="0017">An embodiment of the invention makes proportional scaling adjustments to VGA-multiplier based upon factors that can include location of read-head within the servo field; phase misalignment/mismatch of adjacent servo tracks, and length of AGC magnets. For the location of read-head within the servo field the gray code field can have one VGA-multiplier, for example, and the null servo fields can have separate VGA-multiplier because they have different dimension from gray code field and they are affected more by servo track misalignment and mismatch. For seamless servo patterns, independent writing can result in different misalignments occurring in the AGC, P, and Q bursts. This necessitates using different VGA multiplier for AGC, P and Q bursts. It should be noted that AGC field can still be used for initial VGA calibration test. For the phase misalignment/mismatch of adjacent servo tracks, misalignments can be determined during manufacturing tests and a lookup table of drive parameters can be saved for reference during field operation, but misalignments can also be determined in the field. The length of AGC magnets (e.g. 1T versus 2T AGC) can be compared to null burst magnets (e.g., 1T versus 2T burst). For example, null bursts magnets are written at lower frequency and thus may need different VGA-multiplier. In addition misalignment will affect lower frequency magnetic bursts less due to larger dimensions.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE FIGURES</heading>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 1A</figref> is a block diagram illustrating fields in a quad burst servo pattern according to the prior art.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1B</figref> is a block diagram illustrating fields in a null servo pattern according to the prior art.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 1C</figref> illustrates two adjacent tracks that have a servo burst pattern written at one-half of a track width according to the prior art.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 1D</figref> illustrates two adjacent tracks that have a servo burst pattern written at one-half of a track width with both AGC and servo burst fields written in a seamed manner according to the prior art. <figref idref="DRAWINGS">FIG. 1E</figref> illustrates the write gate pattern for the four phases of the writing process for two tracks k and k+1 illustrated in <figref idref="DRAWINGS">FIG. 1D</figref>.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIGS. 1F and 1G</figref> illustrate the four phases of writing a seamed AGC with seamless P and Q bursts on two adjacent tracks according to the prior art.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIGS. 1H and 1I</figref> illustrate the four phases of writing a seamless AGC with seamed P and Q bursts on two adjacent tracks according to the prior art.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIGS. 1J and 1K</figref> illustrate the four phases of writing a seamed AGC with seamless P and Q bursts on two adjacent tracks according to the prior art.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 1L</figref> illustrates the ideal track pitch in which each track has the same width according to the prior art.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 1M</figref> illustrates a problem case in which the track pitch in which one track has a narrower width than the other tracks according to the prior art.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 1N</figref> illustrates the effect on the burst signal readback for the track squeeze problem case according to the prior art.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 1O</figref> illustrates the read/write (Rd/Wr) offset based on the burst crossing signal which can be based on a selected function of the P-Q burst amplitudes measured at selected points.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 1P</figref> illustrates the read/write (Rd/Wr) offset based on the burst crossing signal which can be based on a selected function of the ABCD burst amplitudes measured at selected points.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 1Q</figref> is a block diagram illustrating a general servo VGA adjustment loop based on AGC according to the prior art.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 1R</figref> is a block diagram illustrating General description of servo VGA adjustment loop based on AGC.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 1S</figref> is an illustration showing how VGA loop makes adjustment according to fly height and linear density changes according to the prior art. Inner diameter (ID) side produces smaller magnetic signal due to higher linear densities, so AGC gain is higher as compared to outer diameter (OD) side. Likewise when TFC is applied, head is flying closer to disk and magnetic signal is stronger which thereby requires smaller VGA gain.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 2A</figref> illustrates track misalignment in seamed AGC, seamed P-Q burst format.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 2B</figref> illustrates track misalignment in seamed AGC, seamless P-Q burst format.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 2C</figref> illustrates track misalignment in seamless AGC, seamless P-Q burst format.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 2D</figref> illustrates track misalignment in seamless AGC, seamed P-Q burst format.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 3</figref> illustrates that track misalignment causes magnetic signal loss for the same physical misalignment signal loss is different for 1T versus 2T servo patterns.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIGS. 4A-B</figref> illustrate track misalignment in seamless patterns where AGC, P and Q bursts can have different misalignment.</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 5A</figref> is a simplified flow chart of the servo VGA adjustment loop based on AGC according to an embodiment the invention.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 5B</figref> is a more detailed flow chart of the servo VGA adjustment loop based on AGC according to an embodiment the invention.</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 6</figref> illustrates a first method of measuring track misalignment in an embodiment of the invention.</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 7</figref> illustrates a second method of measuring track misalignment in an embodiment of the invention using a selected calibration pattern written in the user data area.</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a method of measuring phase mismatch information in an embodiment of the invention using a selected calibration pattern written in the user data area.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0045" num="0044">Accurate cross-track servo burst (ABCD) profile is required for various servo related error scans. For example, track squeeze measurement is based on change in burst profile due to cross-track squeeze as shown in <figref idref="DRAWINGS">FIGS. 1L</figref>, <b>1</b>M, <b>1</b>N which describe the squeeze measurement technique based on recording the changes in burst profile induced by cross-track squeeze. A squeeze error occurs when the width of a data track is too narrow and causes partial erasure of adjacent data tracks. As shown in graph in <figref idref="DRAWINGS">FIG. 1N</figref>, the amplitude of the P and Q burst signals is reduced by the track squeeze.</p>
<p id="p-0046" num="0045">Other examples of servo calibration steps that are based on servo burst profiles include estimation of read/write head offset and determination of servo metric as shown in <figref idref="DRAWINGS">FIGS. 1O</figref>, <b>1</b>P. In these processes, burst crossing signal and ratio of burst amplitudes are used to adjust servo related parameters. <figref idref="DRAWINGS">FIG. 1O</figref> illustrates the read/write (Rd/Wr) offset based on the burst crossing signal which can be based on a selected function of the P-Q burst amplitudes measured at selected points. <figref idref="DRAWINGS">FIG. 1P</figref> illustrates the read/write (Rd/Wr) offset based on the burst crossing signal which can be based on a selected function of the ABCD burst amplitudes measured at selected points.</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 1Q</figref> is a block diagram illustrating a general servo VGA adjustment loop based on AGC according to the prior art. The variable gain amplifier (VGA) circuit adjusts the gain such that output signal stays above limits (Vh, Vl). The goal is to compensate the effects of fly height and other magnetic variations in order to maintain consistent SNR in the output signal. This operation in performed on AGC field. VGA gain is adjusted to cancel any variation in AGC signal.</p>
<p id="p-0048" num="0047">There is a relationship between the VGA gain adjusting loop for servo AGC and servo burst readback signal. A flowchart of this operation for the system illustrated in <figref idref="DRAWINGS">FIG. 1Q</figref> in given in <figref idref="DRAWINGS">FIG. 1R</figref>. VGA gain calibration is conventionally done using AGC field. The input signal comes from the standard preamp and is initially processed a filter which feeds variable gain amplifier (VGA). Gain is adjusted to maintain the signal above the required threshold limits (V<sub>h</sub>,V<sub>l</sub>). The role of VGA loop is to compensate the effects of fly height and other magnetic variations in order to maintain consistent SNR in the output burst signal.</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 1S</figref> is an illustration showing how VGA loop makes adjustment according to fly height and linear density changes according to the prior art. Inner diameter (ID) side produces smaller magnetic signal due to higher linear densities, so AGC gain is higher as compared to outer diameter (OD) side. Likewise when thermal fly-height control (TFC) is applied, the head is flying closer to disk and magnetic signal is stronger which thereby requires smaller VGA gain.</p>
<p id="p-0050" num="0049">In conventional disk drives, servo patterns are written at monotonically increasing linear densities from ID to OD with highest linear density at the ID. As a result ID tracks produces smaller magnetic signal. Hence AGC gain is higher as compared to OD tracks. Likewise when TFC is applied, head is flying closer to disk and magnetic signal is stronger which thereby requires smaller VGA gain.</p>
<p id="p-0051" num="0050">At the end of VGA gain adjustment process (<figref idref="DRAWINGS">FIG. 1R</figref>), burst VGA gain is computed based on the calibrated AGC gain:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>Burst gain=<i>AGC </i>gain&#xd7;<i>f</i>(<i>T</i>).<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where f(T) is a known function of linear density T. Since bursts are written with lower density, they produce stronger magnetic signal than AGC fields. The function f(T) lowers the gain for 2T bursts to prevent ADC signal saturation. This function is selected offline during the design phase based on magnetic signal modeling of 1T vs 2T signals. Measured burst signals are scaled internally by burst gain. Burst values (and cross-track burst profile) are a function of VGA loop gain.
</p>
<p id="p-0052" num="0051">A problem being addressed by the present invention is that phase misalignment also contributes to signal drop. Track misalignment refers to finite error in servo sector locations of two adjacent tracks. Misalignment arises from write-gate jitter and timing disturbances during the servo writing process (SSW) which results in small deviation in servo sectors from ideal locations. Examples of servo pattern with track misalignment for seamed and seamless writing are shown in <figref idref="DRAWINGS">FIGS. 2A-D</figref>.</p>
<p id="p-0053" num="0052">Track misalignment results in phase mismatch between adjacent tracks. The following discusses the behavior of the general VGA feedback loop for misaligned servo sectors, especially with difference in AGC/burst frequencies as illustrated in <figref idref="DRAWINGS">FIG. 3</figref> where 1/T=225 MHz and the period for AGC is 1T and the period for servo burst is 2T. For same phase shift, 1T period AGC has more magnitude drop as compared to 2T period burst. VGA calibrated using AGC, so VGA gain is proportional to inverse of gain drop observed in AGC field. VGA loop will see more gain drop (lower line) as an effect of phase mismatch. As a result the VGA loop will increase the AGC gain in order to compensate the drop in AGC field signal. Since the burst gain is proportional to the AGC, VGA gain for fixed f(T), the burst gain is increased accordingly, which amplifies the corresponding servo bursts (upper line: 2T Burst w/VGA). The ideal VGA gain for burst is, however, the inverse of the center line, 2T Burst. Hence phase mismatch induced by track misalignment results in wrong gain for the servo burst. For example, for &#x2212;0.4 nsec phase mismatch between adjacent tracks can result in AGC field magnitude drop by 4%, while burst magnitude drops by &#x2dc;1%. However VGA loop will adjust to cancel 4% drop in AGC field but will also amplify the burst gain by 4% which will result in 3% net amplification in the burst signal.</p>
<p id="p-0054" num="0053">The effect of phase mismatch is worse for seamless patterns where AGC, P, and Q bursts have different phase mismatch because they are written independently in different writing steps as described above. As a result, VGA gain calibrated based on AGC phase mismatch may distort one burst more than the other. An example is shown in <figref idref="DRAWINGS">FIGS. 4A-B</figref> for servo pattern with seamless AGC and seamless PQ bursts where P burst is written at the same time as AGC while Q burst is written in separate write step. Accordingly the P burst has same phase mismatch as AGC (location 2 in <figref idref="DRAWINGS">FIG. 4B</figref>) while Q may have entirely different misalignment error. Due to linear density difference between 1T AGC and 2T PQ bursts, both P and Q bursts will show smaller signal drop due to mismatch. However due to seamless architecture, Q burst has much smaller misalignment effect at track boundaries where AGC and P burst are most sensitive (location (2) in <figref idref="DRAWINGS">FIG. 4B</figref>). At the same time, Q burst will show signal drop at location (1) where AGC and P see no signal drop. This will result in burst signal distortion as shown in cross track burst profile on <figref idref="DRAWINGS">FIG. 4B</figref> where P and Q have different sensitivity to phase mismatch and AGC gain.</p>
<p id="p-0055" num="0054">Thus, using same (proportional) gain for servo bursts introduces error in cross-track burst profile and corresponding servo calibration processes. In particular, wrong VGA gain results for misaligned bursts and phase mismatch introduces error in squeeze measurement. Change in cross-track profile is due to phase mismatch and A, B, C, D or P, Q magnitude change due to phase mismatch. In testing drives down-track shift is wrongly recorded as cross-track squeeze, but only cross-track squeeze is harmful to data integrity. The result is unnecessary yield loss and non-optimal performance.</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. 5A</figref> is a simplified flow chart of the servo VGA adjustment loop based on AGC according to an embodiment the invention. The AGC gain is first determined according to standard principles. This AGC gain is then used along with AGC, P and Q phase misalignment measured values to compute an adjustment or scaling value for the P and Q burst signals. The AGC, P and Q phase misalignment values can be supplied from real-time measurements or can be retrieved from a table of previously measured values that was created as part of the manufacturing process using a technique described below.</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 5B</figref> is a more detailed flow chart of the servo VGA adjustment loop based on AGC according to an embodiment the invention. The standard VGA adjustment loop described above is modified to include phase mismatch information while computing the burst gains. Conventional VGA gain calibration is performed based on the AGC field signal first to provide adjusted gain g<sub>AGC</sub>. When the head is over the AGC field <b>51</b>, the VGA loop adjustment is performed <b>53</b> using supplied limits for V<sub>h </sub>and V<sub>l </sub><b>52</b>. Next, P and Q burst gains are computed <b>54</b> based by scaling AGC gain by F( ) and H( ) which are now functions of phase mismatch in AGC (&#x3b8;<sub>AGC</sub>), phase mismatch in burst P (&#x3b8;<sub>P</sub>), phase mismatch in burst Q (&#x3b8;<sub>Q</sub>), and linear density difference between 1T AGC and 2T bursts. Methods to measure phase mismatch in AGC, P, and Q bursts are described below. Phase mismatch calibration can be done during manufacturing and stored in look-up table, or can be performed during drive operation.</p>
<p id="p-0058" num="0057">Functions F( ) and H( ) are designed to use the phase mismatch information to compute VGA gain change solely due to phase mismatch for 1T AGC (M&#x2032;) and 2T bursts (N&#x2032;). Head response data similar to that shown in <figref idref="DRAWINGS">FIG. 3</figref> can be used. The phase misalignment value can be converted into servo VGA loop gain using a predetermined table of values of readback signal values for AGC and servo bursts at a set of selected phase mismatch values. The bursts are then scaled with corrected VGA gain to obtain correct burst profile using AGC gain scaled by M&#x2032;/N&#x2032; where M&#x2032; is the signal drop in AGC due to phase mismatch &#x3b8;<sub>AGC</sub>, while N&#x2032; is the drop in 2T burst due to phase mismatch &#x3b8;<sub>P </sub>and &#x3b8;<sub>Q</sub>).
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>Burst gain=<i>g</i><sub>AGC</sub>&#xd7;(<i>M&#x2032;/N</i>&#x2032;)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Depending upon servo pattern writing process, AGC and PQ bursts may have same phase mismatch as in seamed pattern wherein
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3b8;<sub>AGC</sub>=&#x3b8;<sub>P</sub>=&#x3b8;<sub>Q </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
or the phase mismatch can be different (&#x3b8;<sub>AGC</sub>, &#x3b8;<sub>P</sub>, &#x3b8;<sub>Q</sub>) as in seamless patterns. Accordingly we may have different burst gain for P (g<sub>P</sub>) and Q (g<sub>Q</sub>). When the Q burst is processed, the signal is scaled by g<sub>Q </sub><b>55</b> the derived the final Q burst readback signal. When the P burst is processed, the signal is scaled by g<sub>P </sub><b>56</b> the derived the final P burst readback signal. At the end of this process, each burst is scaled appropriately providing more accurate burst readback signal. The resulting burst profile can be used to improve squeeze detection and other servo calibration processes. When the neither the P or Q bursts are being processed the signal is scaled by adjusted gain g<sub>AGC </sub><b>57</b>.
</p>
<p id="p-0059" num="0058">A similar process can be applied for ABCD-burst pattern embodiment.</p>
<p id="h-0006" num="0000">Servo Sector Misalignment Detection</p>
<p id="p-0060" num="0059">The objective is to detect track misalignment and resulting phase mismatch in AGC, P and Q bursts in both seamed as well as seamless patterns. Phase mismatch in AGC can be obtained by recording the change in sector-to-sector timing interval across the actuator stroke based on U.S. Pat. No. 7,551,390 described above. In a conventional servo pattern, sector timing reference is provided by the sync mark which is phase aligned with AGC. As a result, this method can only provide AGC phase mismatch information. For seamed patterns, this method can be used for burst phase mismatch detection because AGC and bursts have same misalignment for seamed servo patterns.</p>
<p id="p-0061" num="0060">In an embodiment of this invention, the phase of PQ bursts in addition to magnitude is recorded to measure the phase mismatch of AGC and PQ bursts. <figref idref="DRAWINGS">FIG. 6</figref> illustrates an embodiment with a seamless 2T null servo burst pattern using a seamed AGC field. The burst gate is opened a fixed time delay after the sync mark and phase of PQ bursts are measured with respect of the burst gate. Since the sync mark follows the AGC phase mismatch, burst gate can be used as the equivalent of the AGC phase. In seamless burst patterns, where one burst is written per AGC write during servo writing, phase mismatch is a function of measured phase difference between bursts. For example, phase of P burst at boundary of (1) and (2) in <figref idref="DRAWINGS">FIG. 6</figref> directly provides information about AGC and Q burst phase mismatch at that location. Similarly, phase of Q burst at boundary of (2) and (3) provides information about AGC and P burst mismatch. Accordingly, this method can be used to measure AGC as well as PQ burst mismatch, especially for seamless bursts written with seamed AGC.</p>
<p id="p-0062" num="0061">In another embodiment of the invention, special temporary test burst patterns are written along with the standard servo sectors during the self-servo writing (SSW) process as illustrated in <figref idref="DRAWINGS">FIG. 7</figref>. The test burst patterns are written in the user data and are used only for track misalignment detection. The test bursts are written at the same time as the standard servo fields during SSW and, therefore, will have same misalignment, if any, as the original servo burst fields. Once the misalignment test is done, these additional test bursts are automatically overwritten when user data is written in the standard way in subsequent operations.</p>
<p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. 7</figref> illustrates an embodiment for use in a disk drive with 2T Null pattern with seamless AGC and seamless bursts, which are illustrated on the left side of the figure. In this embodiment SSW will initially write the PQ bursts followed by the EFG bursts as shown. After the calibration test only PQ will remain, so normal drive operation still uses only P and Q bursts. The additional temporary burst patterns (E, F, G) shown on the right side of <figref idref="DRAWINGS">FIG. 7</figref> are written in seamed manner, and have linear density of 1T for burst E; 2T for burst F; and 4T for burst G. The PQ bursts both have linear density of 2T.</p>
<p id="p-0064" num="0063">Phase mismatch information is obtained from relative magnitude to 1T, 2T, and 4T signals as shown in <figref idref="DRAWINGS">FIG. 8</figref> for 165 MHz servo pattern. In an embodiment of this invention, additional burst patterns may have different linear densities and phase mismatch information is obtained from comparison of signal drop in 1T vs 2T vs 4T signal for same misalignment based on the signal sensitivity plots as shown in <figref idref="DRAWINGS">FIG. 8</figref>. Since these patterns were written in seamed manner, they provide phase mismatch information for (1) to (6) locations. Using this data, phase mismatch for AGC, P, and Q bursts can be derived for either seamed or seamless patterns. As an example for the seamed 2T null pattern with seamless AGC and seamless bursts shown in <figref idref="DRAWINGS">FIG. 7</figref>, phase mismatch of burst Q at track boundary of (1)-(2) is equal to the phase mismatch of EFG bursts at (1)-(2). Likewise, phase mismatch of AGC and P burst at location (2)-(3) is directly obtained from phase mismatch of EFG bursts at (2)-(3).</p>
<p id="p-0065" num="0064">In an embodiment of this invention, phase information can be additionally recorded for special calibration bursts EFG. Accordingly, phase mismatch information is obtained from both magnitude and phase of EFG bursts.</p>
<p id="p-0066" num="0065">In an embodiment, the phase mismatch measurements for AGC and PQ bursts using any of the methods described above are done offline during manufacturing process and the resulting data is stored in a table in nonvolatile memory. The phase data may be interpolated to obtain higher resolution information at all radial locations.</p>
<p id="p-0067" num="0066">In another embodiment of this invention the methods described above are used during the self-servo write operation to detect and correct track misalignment such that servo pattern are written with minimal phase mismatch.</p>
<p id="p-0068" num="0067">These methods can be suitably modified to detect phase mismatch in seamed or seamless ABCD burst patterns. Accordingly, the embodiments of this invention are not restricted to PQ burst patterns.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of operating a disk drive, the disk drive having a disk with servo information arranged in concentric tracks that include a plurality of servo sectors having an automatic gain control (AGC) field followed by servo bursts, the method comprising:
<claim-text>determining an AGC gain for a signal generated by an AGC field in a servo sector on a rotating disk passing under a read head; and</claim-text>
<claim-text>calculating a first burst signal adjustment value for a first servo burst field using the AGC gain and a selected function of a set of inputs including an AGC field phase misalignment value and phase misalignment value for the first servo burst field.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the set of inputs includes the period of the selected burst field.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the AGC field phase misalignment value and phase misalignment value for the first servo burst field are measured during real time operation of the disk drive.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the AGC field phase misalignment value and phase misalignment value for the first servo burst field are read from a table measured values created during a manufacturing process and stored in nonvolatile memory.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref> wherein AGC field phase misalignment value and phase misalignment value for the first servo burst field are measured by a calibration process that includes writing and then reading a set of test bursts in a data area, the set of test bursts including bursts written at first and second linear densities.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein the first linear density is T and the second linear density is 2T and the set of test bursts includes test bursts written at linear density 4T and the calibration process includes determining the phase misalignment value from relative magnitude differences for readback signals for the test bursts having first and second linear densities.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising calculating a second burst signal adjustment value for a second servo burst field using the AGC gain and a selected function of a set of inputs including an AGC field phase misalignment value and phase misalignment value for the second servo burst field.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the AGC field is seamed and the servo bursts are seamed.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the AGC field is seamed and the servo bursts are seamless.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the AGC field is seamless and the servo bursts are seamless.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the AGC field is seamless and the servo bursts are seamed.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the AGC field phase misalignment value is derived from a location of a sync mark and phase of the first servo burst is measured with respect to a burst gate which is opened a fixed time delay after the sync mark.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the first burst signal adjustment value corrects for cross-track squeeze.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the AGC field has linear density of T and first burst signal has linear density of 2T.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein the AGC field phase misalignment value and phase misalignment value for the first servo burst field are read from a table measured values created during a manufacturing process and stored in nonvolatile memory.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref> wherein AGC field phase misalignment value and phase misalignment value for the first servo burst field are measured by a calibration process that includes a) writing a set of test bursts in a data area during a self-servo writing process, the set of test bursts including test bursts written at first and second linear densities, and b) determining the phase misalignment value from relative magnitude differences for readback signals for the test bursts having first and second linear densities.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the set of test bursts includes test bursts written at linear density T, 2T, and 4T. </claim-text>
</claim>
</claims>
</us-patent-grant>
