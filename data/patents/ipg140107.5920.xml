<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08627029-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08627029</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11806705</doc-number>
<date>20070604</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<us-term-extension>208</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>12</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>711163</main-classification>
<further-classification>711103</further-classification>
<further-classification>711147</further-classification>
<further-classification>711E12038</further-classification>
</classification-national>
<invention-title id="d2e53">Methods for managing files according to application</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5902352</doc-number>
<kind>A</kind>
<name>Chou et al.</name>
<date>19990500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>718102</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6907421</doc-number>
<kind>B1</kind>
<name>Keshav et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  2</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6910210</doc-number>
<kind>B1</kind>
<name>Chew</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>718103</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7020668</doc-number>
<kind>B2</kind>
<name>Matsuda et al.</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707206</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7099869</doc-number>
<kind>B1</kind>
<name>Forstall et al.</name>
<date>20060800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707 10</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7203737</doc-number>
<kind>B2</kind>
<name>Starbuck et al.</name>
<date>20070400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709219</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7328217</doc-number>
<kind>B2</kind>
<name>Borthakur et al.</name>
<date>20080200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707100</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2002/0152229</doc-number>
<kind>A1</kind>
<name>Peng</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2003/0225801</doc-number>
<kind>A1</kind>
<name>Devarakonda et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707205</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2004/0143736</doc-number>
<kind>A1</kind>
<name>Cross et al.</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713165</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2005/0027754</doc-number>
<kind>A1</kind>
<name>Gajjar et al.</name>
<date>20050200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707200</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2005/0160428</doc-number>
<kind>A1</kind>
<name>Ayachitula et al.</name>
<date>20050700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>718104</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2005/0193025</doc-number>
<kind>A1</kind>
<name>Mosek</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2005/0256838</doc-number>
<kind>A1</kind>
<name>Lasser</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2006/0064488</doc-number>
<kind>A1</kind>
<name>Ebert</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709225</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2007/0143768</doc-number>
<kind>A1</kind>
<name>Inami et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>718104</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2007/0283115</doc-number>
<kind>A1</kind>
<name>Freeman et al.</name>
<date>20071200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711163</main-classification></classification-national>
</us-citation>
</us-references-cited>
<number-of-claims>9</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>711154</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>4</number-of-drawing-sheets>
<number-of-figures>4</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60893635</doc-number>
<date>20070308</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20080222208</doc-number>
<kind>A1</kind>
<date>20080911</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Mosek</last-name>
<first-name>Amir</first-name>
<address>
<city>Tel Aviv</city>
<country>IL</country>
</address>
</addressbook>
<residence>
<country>IL</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Mosek</last-name>
<first-name>Amir</first-name>
<address>
<city>Tel Aviv</city>
<country>IL</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Martine Penilla Group, LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>SanDisk IL Ltd.</orgname>
<role>03</role>
<address>
<city>Kfar Saba</city>
<country>IL</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Bradley</last-name>
<first-name>Matthew</first-name>
<department>2182</department>
</primary-examiner>
<assistant-examiner>
<last-name>Talukdar</last-name>
<first-name>Arvind</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The present invention discloses systems for managing files according to an application. A method for accessing files in a digital storage device, the method including steps of: providing an application having an application identity; and adjusting a storage mode of a file according to the application identity upon the application accessing the file. Preferably, the step of providing includes providing a process identifier (PID) that is an indicator of the application identity. Preferably, the step of adjusting includes adjusting the storage mode according to a storage command associated with an application scenario of the application. Preferably, the step of adjusting is performed using a storage attributes table (SAT). Preferably the step of adjusting is performed using an application scenario table (AST).</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="157.90mm" wi="192.79mm" file="US08627029-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="116.16mm" wi="167.64mm" orientation="landscape" file="US08627029-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="193.38mm" wi="176.45mm" orientation="landscape" file="US08627029-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="209.47mm" wi="186.35mm" orientation="landscape" file="US08627029-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="171.70mm" wi="181.95mm" orientation="landscape" file="US08627029-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This patent application claims priority under 35 U.S.C. &#xa7;119(e) to U.S. Provisional Application No. 60/893,635, filed Mar. 8, 2007, which is hereby incorporated by reference in its entirety.</p>
<p id="p-0003" num="0002">This patent application is related to U.S. patent application Ser. No. 11/806,704 of the same inventors, which is entitled &#x201c;METHOD FOR MANAGING FILES ACCORDING TO APPLICATION&#x201d; and filed on the same day as the present application. This patent application, also claiming priority to U.S. Provisional Application No. 60/893,635, is incorporated in its entirety as if fully set forth herein.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD AND BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">The present invention relates to methods for managing files according to application.</p>
<p id="p-0005" num="0004">File-storage management is a well-known function in the art of computer engineering. Substantial effort is made to optimize the way files are stored and managed in non-volatile storage systems in order to optimize the speed, reliability, power consumption, and security level of the stored files.</p>
<p id="p-0006" num="0005">Traditional storage devices are unable to discriminate between different storage circumstances, and therefore treat the stored files in a generally-optimal way, without adapting the file management to parameters that may vary among different storage-access scenarios.</p>
<p id="p-0007" num="0006">Two patent applications, U.S. patent application Ser. No. 10/849,234 and U.S. patent application Ser. No. 10/952,837, both of SanDisk IL Ltd., Kefar Saba, Israel, significantly improve the performance of storage devices by making the flash-management attributes dependent upon the content of the stored data. Such an approach is clearly described in detail in the abovementioned applications. The abovementioned prior art indeed teach how to adapt the storage management of a file, based on attributes derived from the file type, such that a streaming music file (e.g. MP3 extension), for example, is treated differently than a text file (e.g. DOC extension).</p>
<p id="p-0008" num="0007">However, according to the prior art, a file is always treated in the same way, regardless of which application accessed the file. Such a situation leaves much to be desired in terms of optimal storage management.</p>
<p id="p-0009" num="0008">The following example shows how a file type (e.g. MP3 file) has different storage requirements when accessed by one application (e.g. music-player application) versus another application (e.g. a file-copying application). A music-rendering application (e.g. Microsoft&#x2122; Windows&#x2122; Media Player) requires that an MP3 file be treated with a fixed reading bit rate and low power consumption, but could tolerate a lower reliability.</p>
<p id="p-0010" num="0009">In contrast, a file-copying application (e.g. Microsoft ActiveSync) would prefer to have the same MP3 file be treated with a fast reading speed and a high reliability, but could tolerate an unstable bit rate.</p>
<p id="p-0011" num="0010">Therefore, it is clear that different applications would be optimally served by application-specific file management with respect to read and write performance, reliability level (e.g. error-correction algorithms), security, housekeeping, wear leveling, and the mapping of the logical files to physical pages and blocks in flash memory, for example. Unfortunately, in the prior-art systems, the identity of an application that accesses a file is not taken into consideration by flash-management systems.</p>
<p id="p-0012" num="0011">It would be desirable to have methods for taking into consideration the application that issues a storage-access command when fulfilling the command.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0013" num="0012">It is the purpose of the present invention to provide methods for managing files according to application.</p>
<p id="p-0014" num="0013">For the purpose of clarity, several terms which follow are specifically defined for use herein. The term &#x201c;file&#x201d; is used herein to refer to a digital data file, or any data object, that is managed by a storage system. The term &#x201c;block&#x201d; is used herein to refer to a basic storage sub-area that can be read, written, and erased. Some storage technologies enable some of the three operations (i.e. read, write, and erase) to be performed on parts of a block (e.g. pages).</p>
<p id="p-0015" num="0014">The terms &#x201c;digital rights management&#x201d; and &#x201c;DRM&#x201d; are used herein to refer to a secure technology that enables the copyright owner of a piece of intellectual property (e.g. music, video, and text files) to specify what a user is allowed to do with the property. In DRM, a DRM entity (e.g. a song file) is associated with a &#x201c;rights object&#x201d; file or header.</p>
<p id="p-0016" num="0015">The terms &#x201c;operating system&#x201d; and &#x201c;OS&#x201d; are used herein to refer to a software program, executed by a host-system, capable of providing file-system services, via API (application programming interfaces), to other applications (e.g. Windows). The terms &#x201c;file system&#x201d; and &#x201c;FS&#x201d; are used herein to refer to a software module included in OS software. The FS is responsible for managing memory (both non-volatile and volatile) using logical addresses that index files using an FS-specific format. APIs for deleting, creating, renaming, reading, and writing files and directories by their names, without knowing the storage-device type, the data format of the FS, and the physical locations of the files in the memory, are exported by the FS to applications.</p>
<p id="p-0017" num="0016">The term &#x201c;application launch&#x201d; is used herein to refer to a process that occurs when an OS (e.g. Windows Mobile by Microsoft, Seattle, Wash., USA) reads an application file from an NVM (non-volatile memory), converts the application file format to an OS-specific process format, and writes the newly-formatted application file into the NVM. When the application launch is completed, the file is ready to be executed by the OS. The term &#x201c;application identity&#x201d; is used herein to refer to a name of an application that specifies what the application is.</p>
<p id="p-0018" num="0017">The terms &#x201c;single-level cell&#x201d; and &#x201c;SLC&#x201d; are used herein to refer to a memory that stores one bit in each cell. A bit can be stored in a cell by charging the cell at one out of two available voltage levels. One voltage level represents one-logic and the other voltage level represents zero-logic. An SLC device provides faster transfer speeds, lower power consumption, and higher cell endurance. SLC flash-memory technology is used in high-performance memory cards.</p>
<p id="p-0019" num="0018">The terms &#x201c;multi-level cell&#x201d; and &#x201c;MLC&#x201d; are used herein to refer to a flash memory that stores two or more bits in each cell. Two or more bits can be stored in one cell by charging the cell in one of four (or more) available voltage levels. For example, if the MLC stores two bits per cell, then one voltage level (of the combined two bits in the cell) represents zero-logic, the second voltage level represents one-logic, the third voltage level represents two-logic, and the fourth voltage level represents three-logic. By storing more bits per cell, an MLC memory card achieves slower transfer speeds, higher power consumption, and lower cell endurance than an SLC memory card. However, MLC manufacturing costs are lower than SLC manufacturing costs. MLC flash-memory technology is mostly used in standard memory cards.</p>
<p id="p-0020" num="0019">The term &#x201c;storage sub-area&#x201d; is used herein to refer to a collection of logical blocks in a storage device. The term &#x201c;physical sub-area&#x201d; is used herein to refer to a collection of contiguous physical block addresses having uniform storage attributes. The term &#x201c;logical sub-area&#x201d; is used herein to refer to a collection of sequential logical block addresses having uniform storage attributes. The term &#x201c;virtual sub-area&#x201d; is used herein to refer to a not-necessarily-sequential collection of logical block addresses having uniform storage attributes.</p>
<p id="p-0021" num="0020">The term &#x201c;storage attributes&#x201d; is used herein to refer to parameters that describe the performance of sub-areas in a storage device. Examples of such storage attributes include read speed, endurance, power consumption, and reliability. The terms &#x201c;storage attribute table&#x201d; and &#x201c;SAT&#x201d; are used herein to refer to a table that lists attributes of sub-areas in a storage device.</p>
<p id="p-0022" num="0021">The term &#x201c;application scenario&#x201d; is used herein to refer to a combination of: (1) one or more application identities, (2) one or more file types, and (3) one or more storage operations or commands that are associated with specific storage requirements in a storage system. Each of these three elements is called an &#x201c;application-scenario parameter&#x201d; (e.g. the identity of an application is an application-scenario parameter). Any application has an application scenario under which operations and commands are executed. The terms &#x201c;storage operation&#x201d; and &#x201c;storage command&#x201d; are used herein to refer to a command that involves a host system accessing one of its storage devices.</p>
<p id="p-0023" num="0022">The terms &#x201c;application scenario table&#x201d; and &#x201c;AST&#x201d; are used herein to refer to a table that matches application scenarios with storage requirements. The term &#x201c;storage mode&#x201d; is used herein to refer to a collection of parameters that determine the way a file is read from and written to an NVM. These parameters include the priority of the execution of the storage operation, the timing punctuality required, the buffer size for accessing the storage device, the need to run or suspend housekeeping operations during read/write operations, the use of DMA (direct memory access), and the need to save power in the storage device. The storage mode also determines a preferred storage sub-area and the writing mode, such as sequential writing (i.e. writing to sequential logical or physical addresses).</p>
<p id="p-0024" num="0023">The present invention teaches methods for optimizing a flash-memory management system based on the recognition of the application scenario or at least the identity of the application that issues a storage-access command, and accesses files stored in the flash memory.</p>
<p id="p-0025" num="0024">An essential feature of the present invention is the use of application-related information when processing storage-access commands. In preferred embodiments of the present invention, the storage sub-areas and storage modes allocated to the data are selected in accordance with the identity of the application or the application scenario.</p>
<p id="p-0026" num="0025">For clarity, the description below refers to a narrow application scenario, which is combining one application, one file type, and one storage command. However, it should be noted that application scenario is defined to cover any combination of values for each of the application-scenario parameters including the combination of one application with any file type and any storage command.</p>
<p id="p-0027" num="0026">Tables 1A and 1B highlight the differences between the present invention and the prior art (mentioned in the Background section) by showing how a file is handled differently in different application scenarios. Details are provided in the Description section below.</p>
<p id="p-0028" num="0027">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 1A</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Preferred storage attributes of two applications for an MP3</entry>
</row>
<row>
<entry>file, according to a preferred embodiment of the present invention.</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="1" colwidth="14pt" align="left"/>
<colspec colname="2" colwidth="77pt" align="left"/>
<colspec colname="3" colwidth="112pt" align="center"/>
<colspec colname="4" colwidth="14pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>File Type</entry>
<entry>Application Scenario</entry>
<entry/>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="1" colwidth="14pt" align="left"/>
<colspec colname="2" colwidth="77pt" align="left"/>
<colspec colname="3" colwidth="56pt" align="left"/>
<colspec colname="4" colwidth="70pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>MP3 File</entry>
<entry>ActiveSync</entry>
<entry>Media Player</entry>
</row>
<row>
<entry/>
<entry>Main Requirement:</entry>
<entry>Fast read</entry>
<entry>Constant bit rate</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0029" num="0028">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 1B</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Preferred storage attributes of two applications for a DOC file,</entry>
</row>
<row>
<entry>according to a preferred embodiment of the present invention.</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="1" colwidth="21pt" align="left"/>
<colspec colname="2" colwidth="77pt" align="left"/>
<colspec colname="3" colwidth="98pt" align="center"/>
<colspec colname="4" colwidth="21pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>File Type</entry>
<entry>Application Scenario</entry>
<entry/>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="1" colwidth="21pt" align="left"/>
<colspec colname="2" colwidth="77pt" align="left"/>
<colspec colname="3" colwidth="63pt" align="left"/>
<colspec colname="4" colwidth="56pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>DOC File</entry>
<entry>ActiveSync</entry>
<entry>Word</entry>
</row>
<row>
<entry/>
<entry>Main Requirement:</entry>
<entry>Fast write</entry>
<entry>Endurance</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0030" num="0029">In preferred embodiments of the present invention, the storage device exports an SAT, which lists the relevant attributes of its storage sub-areas, to the FS of the host system. Such an SAT is shown in Tables 1A and 1B. The FS uses such an SAT to allocate an optimal storage sub-area in the storage device for each application scenario. In order to do accomplish such a task, the host system has an AST database that specifies the preferred storage attributes for each application scenario.</p>
<p id="p-0031" num="0030">Such an AST database can be generated during development or customized during use in any of the following situations:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0031">(1) provided as a default setting by the OS (e.g. pre-installed in Windows);</li>
        <li id="ul0002-0002" num="0032">(2) created by the FS developer (e.g. SureFS available from SanDisk IL Ltd.);</li>
        <li id="ul0002-0003" num="0033">(3) created by the system integrator during developm65 vvmx b ent (e.g. N60 mobile-phone series available from Nokia Corporation, New York); and</li>
        <li id="ul0002-0004" num="0034">(4) customized by the application during application run-time (e.g. Activision in the Doom videogame, available from id Software, Mesquite, Tex.).</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0032" num="0035">In a preferred embodiment of the present invention, when an application uses the FS-services API of the OS to access the storage device, the OS carries out the following process:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0036">(1) the OS launches an application, creates a process, and gives the process a process ID (or PID);</li>
        <li id="ul0004-0002" num="0037">(2) when a process attempts to access the storage device for the first time, and calls the FS-services API of the OS, the OS receives the request, and attaches the PID (from a task manager list) to the request;</li>
        <li id="ul0004-0003" num="0038">(3) the FS asks the OS for the identity of the application that is associated with the PID;</li>
        <li id="ul0004-0004" num="0039">(4) the FS then updates the appropriate PID in a PID field in each of the lines of the AST that refers to the identified application;</li>
        <li id="ul0004-0005" num="0040">(5) for every subsequent storage operation of the designated PID, the FS then locates the relevant line in the AST according to the file type and the operation; and</li>
        <li id="ul0004-0006" num="0041">(6) the FS then retrieves the storage requirements from the AST that are suitable for the application scenario (note that in doing so, the present invention makes use of the file name as taught by the prior art mentioned above).</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0033" num="0042">At this stage, the storage requirements for the current storage operation are known to the FS. The process continues according to one of two alternative methods. In the first method, the storage device provides the SAT information to the host system, and in the second method, the host system provides the AST information to the storage device. The next step according to the first method is the following:
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0043">(7a) the SAT resides in the host system, and the FS matches the storage requirements of the AST and the storage attributes of the SAT. The FS selects the preferred sub-area, and instructs the storage device to use that storage sub-area with the storage command.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0034" num="0044">The step of 7a is preferred when predetermined physical and logical areas are used, and the SAT is not dynamic.</p>
<p id="p-0035" num="0045">The second method does not export the SAT to the host system. Thus, the host system does not specify the storage sub-area. The next step according to the second method is the following:
<ul id="ul0007" list-style="none">
    <li id="ul0007-0001" num="0000">
    <ul id="ul0008" list-style="none">
        <li id="ul0008-0001" num="0046">(7b) the SAT resides in the storage device, and the host system sends the storage requirements with the storage command. A device controller then applies the SAT to select the storage sub-area.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0036" num="0047">The step of 7b is preferred when the storage device selects the appropriate storage sub-areas internally without the knowledge of the host system. It should be noted that such a method is not transparent to the host system (i.e. the host system must know that the storage device is managing an SAT, and must provide the storage requirements with every storage command). It should be noted that the FS is executed in the storage device, as in object-oriented storage using MTP (media transfer protocol by Microsoft), and that both the AST and the SAT are managed on the storage device. The host system only needs to provide the application name with the storage command.</p>
<p id="p-0037" num="0048">It should be noted that the present invention does not require the use of all three application-scenario parameters (i.e. application, file type, storage operation). The system can take into consideration only the application, the file type, the storage operation, or any combination thereof. This is performed when populating the AST.</p>
<p id="p-0038" num="0049">Therefore, according to the present invention, there is provided for the first time a method for accessing files in a digital storage device, the method including the steps of: (a) providing an application having an application identity; and (b) adjusting a storage mode of a file according to the application identity upon the application accessing the file.</p>
<p id="p-0039" num="0050">Preferably, the step of providing includes providing a PID that is an indicator of the application identity.</p>
<p id="p-0040" num="0051">Preferably, the step of adjusting includes adjusting the storage mode according to a storage command associated with an application scenario of the application.</p>
<p id="p-0041" num="0052">Preferably, the step of adjusting is performed using an SAT.</p>
<p id="p-0042" num="0053">Preferably, the step of adjusting is performed using an AST.</p>
<p id="p-0043" num="0054">These and further embodiments will be apparent from the detailed description and examples that follow.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0044" num="0055">The present invention is herein described, by way of example only, with reference to the accompanying drawings, wherein:</p>
<p id="p-0045" num="0056"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic block diagram of a storage system having application access to a storage device, according to the prior art;</p>
<p id="p-0046" num="0057"><figref idref="DRAWINGS">FIG. 2</figref> is a simplified flowchart of an FS that automatically updates an associated AST PID field with the relevant PID, according to a preferred embodiment of the present invention;</p>
<p id="p-0047" num="0058"><figref idref="DRAWINGS">FIG. 3</figref> is a simplified flowchart of application-scenario parameters that are sent by a process, and are updated during application run-time, according to a preferred embodiment of the present invention;</p>
<p id="p-0048" num="0059"><figref idref="DRAWINGS">FIG. 4</figref> is a simplified flowchart of the processing of a storage request, according to a preferred embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0049" num="0060">The present invention relates to methods for managing files according to application. The principles and operation for managing files according to application, according to the present invention, may be better understood with reference to the accompanying description and the drawings.</p>
<p id="p-0050" num="0061">Referring now to the drawings, <figref idref="DRAWINGS">FIG. 1</figref> is a schematic block diagram of a storage system having application access to a storage device, according to the prior art. An application <b>10</b> is executed on a host system <b>12</b>, and tries to access a storage device <b>14</b>. Application <b>10</b> calls the FS-services API of an operating system <b>16</b> in order to send an access request to storage device <b>14</b> through a file system <b>18</b>. The operations of application <b>10</b> are executed on host system <b>12</b>.</p>
<p id="p-0051" num="0062">The role of operating system <b>16</b> in host system <b>12</b> is to manage all the software executed on host system <b>12</b> (including applications and device drivers). Host system <b>12</b> is responsible for executing the processes and allocating CPU time to each process when multiple processes are executed simultaneously (e.g. multi-threading and multi-tasking). In order to do so, operating system <b>16</b> maintains a list of all current &#x201c;live&#x201d; processes on host system <b>12</b>. Such live processes are processes that have been launched and have not yet been terminated.</p>
<p id="p-0052" num="0063">The processes list includes the process ID (or PID, a number that a process gets every time it is launched by operating system <b>16</b>), the application file name (from which the process was generated during application launch), the priority (according to which) operating system <b>16</b> allocates CPU time to the process, the number of threads in the process, the stack, the heap size, and other parameters. All of these parameters enable operating system <b>16</b> to execute the process in a system that handles more than one process.</p>
<p id="p-0053" num="0064">Operating system <b>16</b> is responsible for executing all the software modules (known in the art as software applications and software device drivers). Device drivers such as file system <b>18</b>, which communicates with storage device <b>14</b> by sending commands via a physical interface I, are responsible for accessing hardware peripherals (known in the art as hardware devices or drives) connected to host system <b>12</b>. Operating system <b>16</b> is also responsible for providing an interface between applications and drivers that are executed on host system <b>12</b>. In order to provide this capability, every call to a driver is received by operating system <b>16</b>, and is directed to the relevant driver. It will be appreciated that device drivers such as file system <b>18</b> might be implemented as software or firmware, e.g., a program stored on one or more computer-readable media which are non-transitory, in an example embodiment.</p>
<p id="p-0054" num="0065">When application <b>10</b> tries to access storage device <b>14</b>, the FS-services API of operating system <b>16</b> is called and exported by file system <b>18</b> to operating system <b>16</b>. Operating system <b>16</b>, which is responsible for executing processes on host system <b>12</b>, receives the PID of the currently-executed process. Operating system <b>16</b> then attaches the PID to the request received from application <b>10</b>, and sends the request to file system <b>18</b>.</p>
<p id="p-0055" num="0066">Application <b>10</b>, which uses the FS-services API of operating system <b>16</b>, designates a file or directory to be deleted, renamed, created, read, or written, and provides the file name or directory name as an input parameter. When file system <b>18</b> gets a request (from operating system <b>16</b>) to open a file to read or write, file system <b>18</b> finds the location of the file in storage device <b>14</b>, reads the file attributes, and collects relevant information about the file (e.g. size and security attributes).</p>
<p id="p-0056" num="0067">File system <b>18</b> creates a specific data structure for the open file from the collected data. A pointer to the data structure (known in the art as a &#x201c;file handle&#x201d;) is passed to application <b>10</b> through operating system <b>16</b>. The next time that application <b>10</b> tries to access (e.g. read or write) the open file, application <b>10</b> sends the file handle (as opposed to the file name) as an input parameter.</p>
<p id="p-0057" num="0068">The above description is a typical and well-known data-management process of the prior art, and is presented as background for understanding the present invention and the terminology that is used herein.</p>
<p id="p-0058" num="0069">Tables 1A and 1B above help to highlight problems with methods of the prior art that determine storage attributes of a command based solely on file type. Tables 1A and 1B show two examples in which a single file type should be handled differently by the host system in different application scenarios.</p>
<p id="p-0059" num="0070">Table 1A shows how two different application scenarios that need to read the same file would preferably differ from each other in buffer size, DMA use, and reading sequence. The ActiveSync application executed on a handset/PDA is responsible for moving data from handset/PDA local storage to PC local storage. ActiveSync is executed from the handset/PDA, and communicates with the PC via a USB connection. In Table 1A, the ActiveSync application scenario includes reading an MP3 data file located on the handset/PDA local storage, and sending the file to the PC. ActiveSync prefers, from a user perspective, to read an MP3 file as fast as possible, and send the file as fast as possible to the PC. As a result, ActiveSync prefers high-speed reading from the handset/PDA local storage.</p>
<p id="p-0060" num="0071">The Windows Media Player (WMP) application scenario includes accessing the same MP3 file. The WMP application is executed on a handset/PDA. The WMP application is responsible for reading MP3 and MPEG files from handset/PDA local storage, and sending the files to an audio/video player. Since MP3-playing performance requires 16 KB/sec, the WMP would expect a very low read performance (unlike ActiveSync), but may require a constant bit rate from the handset/PDA local storage, so that the user will not hear &#x201c;hiccups&#x201d; (e.g. skips and pauses) when the song is playing.</p>
<p id="p-0061" num="0072">Hiccups occur if the storage is performing a housekeeping operation while the WMP requests new data. Such a conflict causes the WMP to get the data with a delay (until the storage completes or suspends the housekeeping operation). Due to such delays, the WMP is unable to provide the player with the content on time, and the missing data sounds to the user like an undesirable noise or hiccup. In this scenario, the WMP would greatly prefer, prior to reading the MP3 file, to request that the storage refrain from performing any housekeeping operation until the WMP completes the reading of the MP3 file. When the WMP completes reading the MP3 file, the WMP sends the storage a &#x201c;release&#x201d; to continue the housekeeping operation.</p>
<p id="p-0062" num="0073">Table 1B shows another example of an application-dependent storage requirement. The ActiveSync application scenario includes receiving a Microsoft Word document from the PC (via a USB connection), and trying to write the data as fast as possible into the handset/PDA local storage, requiring fast-write performance.</p>
<p id="p-0063" num="0074">The MS-Word application scenario includes executing the Word editor on the handset/PDA local storage. The Word editor tries to write only a part of the document at a time (e.g. the modified part that has just been updated by the handset user). Since Word documents are frequently updated, the Word editor would prefer to write the partial Word document to a storage sub-area that supports high endurance (i.e. a high number of erase cycles and a low error probability). Storing Word document to a low-endurance storage sub-area might cause unrecoverable errors in the file. In contrast, since the user's input is manual and slow, a high write-speed is not needed in the Word application scenario.</p>
<p id="p-0064" num="0075">
<tables id="TABLE-US-00003" num="00003">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 2</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>An exemplary SAT (Storage Attributes Table), according to a</entry>
</row>
<row>
<entry>preferred embodiment of the present invention.</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="70pt" align="left"/>
<colspec colname="2" colwidth="70pt" align="left"/>
<colspec colname="3" colwidth="77pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Storage Sub-Area A:</entry>
<entry>Storage Sub-Area B:</entry>
</row>
<row>
<entry/>
<entry>Cache Sub-Area</entry>
<entry>Multimedia Sub-Area</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry>Range of Logical or</entry>
<entry>Virtual Sub-Area</entry>
<entry>Sector 0-Sector 800</entry>
</row>
<row>
<entry>Virtual Sub-Area:</entry>
<entry>of 8 MB</entry>
<entry>Sector 1000-Sector 1200</entry>
</row>
<row>
<entry>Read Performance</entry>
<entry>N/A</entry>
<entry>Low, but constant bit rate</entry>
</row>
<row>
<entry>Write Performance</entry>
<entry>Fast</entry>
<entry>Low, but constant bit rate</entry>
</row>
<row>
<entry>Endurance</entry>
<entry>High</entry>
<entry>Low</entry>
</row>
<row>
<entry>Power Saving</entry>
<entry>Low</entry>
<entry>High</entry>
</row>
<row>
<entry>Security</entry>
<entry>Lowest</entry>
<entry>DRM type</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0065" num="0076">Table 2 is an exemplary SAT for two storage sub-areas provided by a storage device. Table 2 presents the different attributes (e.g. read performance, endurance, and security) of the virtual or logical sub-areas of the storage device. Storage sub-area A, called &#x201c;cache sub-area&#x201d;, is intended for cache data (i.e. data that is written to the storage device at a very high speed). Examples of cache-data applications include capturing multi-shot images in a digital camera, and storing the images without any delay. In some cases, the storage device cannot meet the high write-performance required of the application scenario, but can overcome the problem by trading storage-density for storage-speed performance.</p>
<p id="p-0066" num="0077">Writing x bytes of data at a very high speed can be done if 2&#xd7; bytes are allocated for the data (e.g. by using an SLC sub-area instead of an MLC sub-area). Using the example of an SLC sub-area, the virtual cache sub-area is limited to 8 MB (which are derived from 16 MB by allocation of 2&#xd7; bytes for every x bytes that are actually written). Consequently, when an application scenario needs to write data at high speed, the data can be directed to the cache sub-area. When the storage operation is completed, the storage device can move the data internally from the cache sub-area to a different storage sub-area (e.g. to economize on storage space). Reading or writing to the cache sub-area is a very intensive operation (i.e. the storage resources are working at full speed). Therefore, storage power-consumption is very high. An application scenario that seeks a low power-consuming operation would avoid using the cache sub-area.</p>
<p id="p-0067" num="0078">Table 2 indicates that the cache sub-area is not used for read operations. The cache sub-area also provides high endurance (typically 10,000 erase cycles as compared to 1,000 erase cycles in low-endurance storage sub-areas). The cache sub-area is typically a low-security storage sub-area because encryption processes are not fast, and because the cache sub-area is typically accessible by many applications.</p>
<p id="p-0068" num="0079">Storage sub-area B in Table 2, called &#x201c;multimedia sub-area&#x201d;, is used for reading and writing data to storage at a low speed, but with a constant bit rate and for a long period of time (e.g. from a few minutes up to two hours). Video capture and playback each require a bit-rate performance of 250 KB per second. MP3 playback requires a bit-rate performance of up to 16 KB per second.</p>
<p id="p-0069" num="0080">In the example of storage sub-area B of Table 2, the multimedia sub-area includes two sequential logical sub-areas. The first logical sub-area starts with sector and ends in sector <b>800</b>; the second sequential logical sub-area starts with sector <b>1000</b> and ends in sector <b>1200</b>. These properties make the multimedia sub-area suitable for writing and reading multimedia files. The storage device manages the multimedia sub-area without &#x201c;hiccups&#x201d; by ensuring that the read and write operations are not interrupted by housekeeping operations.</p>
<p id="p-0070" num="0081">Since multimedia files are typically written once and archived for playing, and are never updated or modified until they are deleted, the multimedia sub-area provides low endurance (e.g. 1,000 erase cycles compared to 10,000 for high endurance), while still enabling the life expectancy of multimedia content on a storage device to be relatively long. Furthermore, since multimedia files are recorded and played back repeatedly (requiring, as mentioned above, a very low read/write performance), the multimedia sub-area provides the feature of very low power-consumption (e.g. by decreasing the clock frequency of the storage controller to a magnetic disk or flash memory). A multimedia sub-area that handles DRM files would be required to provide a higher security level (e.g. encryption/decryption of written/read data).</p>
<p id="p-0071" num="0082">Table 2 exemplifies how two different storage sub-areas in the same storage device differ significantly in storage attributes, and are used in different application scenarios, according to preferred embodiments of the present invention. Methods of the prior art do not provide any ability to customize a storage sub-area to an application scenario.</p>
<p id="p-0072" num="0083">
<tables id="TABLE-US-00004" num="00004">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="441pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 3</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>The data structure of an exemplary AST (Applications Scenario</entry>
</row>
<row>
<entry>Table), according to a preferred embodiment of the present invention.</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="56pt" align="center"/>
<colspec colname="2" colwidth="119pt" align="center"/>
<colspec colname="3" colwidth="266pt" align="center"/>
<tbody valign="top">
<row>
<entry>Section A</entry>
<entry>Section B</entry>
<entry>Section C</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="13">
<colspec colname="1" colwidth="28pt" align="center"/>
<colspec colname="2" colwidth="28pt" align="center"/>
<colspec colname="3" colwidth="49pt" align="left"/>
<colspec colname="4" colwidth="35pt" align="left"/>
<colspec colname="5" colwidth="35pt" align="left"/>
<colspec colname="6" colwidth="28pt" align="left"/>
<colspec colname="7" colwidth="28pt" align="left"/>
<colspec colname="8" colwidth="28pt" align="center"/>
<colspec colname="9" colwidth="42pt" align="left"/>
<colspec colname="10" colwidth="35pt" align="left"/>
<colspec colname="11" colwidth="28pt" align="left"/>
<colspec colname="12" colwidth="28pt" align="left"/>
<colspec colname="13" colwidth="49pt" align="left"/>
<tbody valign="top">
<row>
<entry>Line</entry>
<entry>Process</entry>
<entry>Application</entry>
<entry/>
<entry>Storage</entry>
<entry>Read</entry>
<entry>Write</entry>
<entry>Priority</entry>
<entry>Timing</entry>
<entry/>
<entry>Power</entry>
<entry/>
<entry>Buffer Size per</entry>
</row>
<row>
<entry>Number</entry>
<entry>ID List</entry>
<entry>Name</entry>
<entry>File Type</entry>
<entry>Operation</entry>
<entry>Speed</entry>
<entry>Speed</entry>
<entry>(1-10)</entry>
<entry>Punctuality</entry>
<entry>Endurance</entry>
<entry>Saving</entry>
<entry>Security</entry>
<entry>Transaction</entry>
</row>
<row>
<entry namest="1" nameend="13" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="13">
<colspec colname="1" colwidth="28pt" align="center"/>
<colspec colname="2" colwidth="28pt" align="center"/>
<colspec colname="3" colwidth="49pt" align="left"/>
<colspec colname="4" colwidth="35pt" align="left"/>
<colspec colname="5" colwidth="35pt" align="left"/>
<colspec colname="6" colwidth="28pt" align="left"/>
<colspec colname="7" colwidth="28pt" align="left"/>
<colspec colname="8" colwidth="28pt" align="char" char="."/>
<colspec colname="9" colwidth="42pt" align="left"/>
<colspec colname="10" colwidth="35pt" align="left"/>
<colspec colname="11" colwidth="28pt" align="left"/>
<colspec colname="12" colwidth="28pt" align="left"/>
<colspec colname="13" colwidth="49pt" align="left"/>
<tbody valign="top">
<row>
<entry>1</entry>
<entry>23, 34</entry>
<entry>MS Word in</entry>
<entry>DOC</entry>
<entry>Write</entry>
<entry>N/A</entry>
<entry>Low</entry>
<entry>3</entry>
<entry>Low</entry>
<entry>High</entry>
<entry>Low</entry>
<entry>High</entry>
<entry>Small</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Office Pro</entry>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
</row>
<row>
<entry>2</entry>
<entry>12</entry>
<entry>ActiveSync</entry>
<entry>JPG</entry>
<entry>Write</entry>
<entry>N/A</entry>
<entry>High</entry>
<entry>8</entry>
<entry>Med</entry>
<entry>Low</entry>
<entry>Low</entry>
<entry>High</entry>
<entry>Large</entry>
</row>
<row>
<entry>3</entry>
<entry>12</entry>
<entry>ActiveSync</entry>
<entry>PST</entry>
<entry>Write</entry>
<entry>N/A</entry>
<entry>High</entry>
<entry>8</entry>
<entry>Med</entry>
<entry>High</entry>
<entry>High</entry>
<entry>High</entry>
<entry>Small</entry>
</row>
<row>
<entry>4</entry>
<entry>54, 7</entry>
<entry>Media Player</entry>
<entry>MPG</entry>
<entry>Write</entry>
<entry>N/A</entry>
<entry>High</entry>
<entry>7</entry>
<entry>Low</entry>
<entry>Low</entry>
<entry>Low</entry>
<entry>High</entry>
<entry>Large</entry>
</row>
<row>
<entry/>
<entry/>
<entry>(DRM Support)</entry>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
</row>
<row>
<entry>5</entry>
<entry>54</entry>
<entry>Media Player</entry>
<entry>MPG</entry>
<entry>Read</entry>
<entry>Low</entry>
<entry>N/A</entry>
<entry>10</entry>
<entry>High</entry>
<entry>Low</entry>
<entry>High</entry>
<entry>High</entry>
<entry>Large</entry>
</row>
<row>
<entry>6</entry>
<entry>26</entry>
<entry>Video Recorder</entry>
<entry>MPG</entry>
<entry>Write</entry>
<entry>N/A</entry>
<entry>Low</entry>
<entry>9</entry>
<entry>High</entry>
<entry>Low</entry>
<entry>High</entry>
<entry>Low</entry>
<entry>Small</entry>
</row>
<row>
<entry>7</entry>
<entry>44</entry>
<entry>Photo Album</entry>
<entry>JPG</entry>
<entry>Read</entry>
<entry>High</entry>
<entry>N/A</entry>
<entry>6</entry>
<entry>Med</entry>
<entry>Low</entry>
<entry>High</entry>
<entry>Low</entry>
<entry>Large</entry>
</row>
<row>
<entry namest="1" nameend="13" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0073" num="0084">Table 3 shows the data structure of an exemplary AST, according to a preferred embodiment of the present invention The rows of Table 3 represent individual application scenarios (e.g. MS-Word running in Office Pro for writing documents; and ActiveSync for receiving data from a PC, and writing the data into a storage device).</p>
<p id="p-0074" num="0085">The columns of Table 3 are divided into three sections: a section A contains line numbers used for administrative purposes, and a list of PIDs that link the running processes to the associated applications since there can be more than one instance of an application running at the same time for each application scenario (e.g. lines 2 and 3 are multiple processes of the same application); a section B contains the three application-scenario parameters that determine the application scenario; and a section C contains the required attributes of the application scenario for optimal access of the storage device.</p>
<p id="p-0075" num="0086">Application-scenario parameters required by the application scenario of the storage mode that are exemplified in the AST of Table 3 are:
<ul id="ul0009" list-style="none">
    <li id="ul0009-0001" num="0000">
    <ul id="ul0010" list-style="none">
        <li id="ul0010-0001" num="0087">Read speed&#x2014;aspects of the speed required for reading data for the specified application (e.g. average speed, peak speed, and constant bit rate).</li>
        <li id="ul0010-0002" num="0088">Write speed&#x2014;aspects of the speed required for writing data for the specified application (e.g. average speed, peak speed, and constant bit rate).</li>
        <li id="ul0010-0003" num="0089">Priority (on an arbitrary scale, e.g. 1-10)&#x2014;a ranking of the specified application scenario to be served relative to other application scenarios (given other factors being equal). According to this parameter, the FS determines in what order of priority are application-scenario access-requests executed for requests that require access to storage at the same time. For example, in line 5, the Media Player (description of the application scenario is detailed below), which reads a song from the storage (in order to play the song), has the highest priority. Thus, any other application scenario that tries to access the storage at the same time as the Media Player is blocked until the request from the Media Player is served by the storage.</li>
        <li id="ul0010-0004" num="0090">Timing punctuality&#x2014;relative criticality that commands are carried out &#x201c;just in time&#x201d; for various application scenarios. According to this parameter, the FS defines which storage command to execute prior to other storage commands competing for service. In some cases, the FS may suspend a request coming from an application scenario with a lower timing punctuality in order to meet the timing punctuality of an application scenario with a higher timing punctuality. For example, in line 5, the Media Player, which reads a song from the storage (in order to play the song), has a high timing punctuality (since a song should be played at a constant bit rate; otherwise, the user will hear the song with interruptions). When the ActiveSync application scenario of line 2 tries to access the storage at the same time that the Media Player tries to access the storage, ActiveSync will be blocked or suspended until the request from the Media Player is served by the storage.</li>
        <li id="ul0010-0005" num="0091">Endurance&#x2014;the number of updates (i.e. re-writing to the same sectors) that the specified application scenario is expected to apply to the stored data.</li>
        <li id="ul0010-0006" num="0092">Power saving&#x2014;a ranking of whether the specified application scenario should be served when the device is in a low power mode (e.g. operating on a battery).</li>
        <li id="ul0010-0007" num="0093">Security&#x2014;a ranking of whether the specified application scenario deals with secure data, and therefore, needs security-protected storage including encryption, for example.</li>
        <li id="ul0010-0008" num="0094">Buffer size per transaction&#x2014;a ranking of the typical size of data (in bytes) that the specified application scenario uses when sending data requests to storage. For example, a video-capturing application scenario sends data requests of 8 KB.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0076" num="0095">It is important to note that the PID field is the only dynamic field in Table 3. The PID field is updated once during application run-time (as described in <figref idref="DRAWINGS">FIG. 5</figref>).</p>
<p id="p-0077" num="0096">Table 3 includes an application scenario generated during application launch from the &#x201c;Office Pro&#x201d; version of MS-Word (line 1). PID <b>23</b> is added to the PID field that already contains PID <b>34</b> from a concurrent instance of the application. This application scenario is characterized by the application (&#x201c;Word in Office Pro&#x201d;), by the operation (write), and by the content type (a Word document with the &#x201c;DOC&#x201d; file extension).</p>
<p id="p-0078" num="0097">As described in Table 1B above, such an application scenario does not require high read-performance. The application scenario requires low write-performance, small buffer size for document updates (due to the possibility of frequent minor update scenarios), and high endurance. Word Office Pro is used by organizations that require enforcement of a security policy with regard to updating and distributing Word documents. Therefore, such an application scenario requires a high security level.</p>
<p id="p-0079" num="0098">Table 3 includes an application scenario generated during application launch from ActiveSync (line 2). The application has a PID <b>12</b>. This application scenario is characterized by the application (ActiveSync), the operation (write), and the content type (a picture file with the &#x201c;JPEG&#x201d; file extension).</p>
<p id="p-0080" num="0099">As described in Table 1B above, such an application scenario requires no read-performance, high write-performance, a large buffer size during document updates (due to large sequential data-writing operations with no minor updates), and low endurance. ActiveSync is used to synchronize PCs with handsets/PDAs, and therefore requires enforcement of a security policy with regard to personal-data transfer operations (to ensure that not every handset can move personal data to every PC). As a result, the application scenario requires a high security level.</p>
<p id="p-0081" num="0100">Table 3 includes an application scenario generated during application launch from ActiveSync (line 3). This instance of ActiveSync has the same PID <b>12</b> as specified in line 2. This application scenario is characterized by the application (ActiveSync), the operation (write), and the content type (a &#x201c;PST&#x201d; e-mail database file).</p>
<p id="p-0082" num="0101">As described in Table 1B above, such an application scenario requires no read-performance, high write-performance; However, in contrast to the application scenario specified in line 2, this application scenario uses a small buffer size during database updates (due to small data-writing operations caused by frequent updates), and a very high endurance due to massive updates of the e-mail database. Due to the security policy of synchronizing e-mails from PCs to handsets/PDAs as mentioned with regard to line 2, the application scenario requires a high security level.</p>
<p id="p-0083" num="0102">Table 3 includes two application scenarios generated during application launch from Windows Media Player (WMP) (lines 4 and 5, each having the same PID <b>54</b>). Both applications are characterized by the WMP application and by the same content type (an &#x201c;MPEG&#x201d; video file). However, the application scenario in line 4 is characterized by the &#x201c;write&#x201d; operation; whereas, the application scenario in line 5 is characterized by the &#x201c;read&#x201d; operation.</p>
<p id="p-0084" num="0103">The application scenario in line 4 represents a scenario of downloading a video file from the network, and writing the file into storage as fast as possible (read performance is not applicable in this case). Due to the requirement that the process of downloading and storing the file into storage should be completed as fast as possible, storage of the file cannot be performed in a power-saving mode, but rather with high write speed. Storage of the file requires large buffers due to the large amounts of data received from the network. Since an MPEG file is not usually modified during its lifetime (until deleted), neither updates nor modifications to the file are expected. For this reason, the application scenario can tolerate low endurance. The WMP application scenario that deals with DRM video files (line 4) should meet DRM protocols, requiring a high security level.</p>
<p id="p-0085" num="0104">The application scenario mentioned in line number 5 describes an application scenario generated during application launch from the WMP application with PID <b>54</b>. This application scenario consists of reading a file from storage, and sending the data to an audio speaker. The application scenario is characterized by the operation (read), and the content type (an MPEG file with the &#x201c;MPG&#x201d; file extension). It requires a low read speed of about 16 KB/sec (write performance is not applicable in this case), low endurance, high power saving, and a large buffer size. This application scenario requires a high security level for the same reason as the application scenario of line 4.</p>
<p id="p-0086" num="0105">Table 3 includes an application scenario generated during application launch from Video Recorder (VR) with PID <b>26</b> (line 6). This application scenario is characterized by the application (VR), the operation (write), and the content type (an MPEG file with the &#x201c;MPG&#x201d; file extension). The VR application is executed on a handset/PDA. The VR application scenario is responsible for capturing video from a camera module, displaying video on the handset display, converting the data received from the camera module into MPEG format, and writing the MPEG data into the storage. The performance of video recording for MPEG is 8 KB/sec per frame with 30 captured frames per second. As a result, the VR application requires a very low write-performance (unlike the application scenario in line 4), but may require a constant bit rate from storage to prevent the user from noticing &#x201c;hiccups&#x201d; when watching the video. Consequently, the VR application requires the storage to disable housekeeping operations until the VR application completes capturing the MPG file.</p>
<p id="p-0087" num="0106">According to the above details, the VR application scenario uses a small 8 KB buffer size, and can operate in high power-saving mode since the storage device can change the clock frequency from frame to frame (read performance is not applicable in this case). Since amateur video capture does not require any security policy, the application scenario requires a low security level (i.e. no encryption at all).</p>
<p id="p-0088" num="0107">Table 3 includes an application scenario generated during application launch from Photo Album (PA) with PID <b>44</b> (line 7). This application scenario is characterized by the application (PA), the operation (read), and the content type (a JPEG file with the &#x201c;JPG&#x201d; file extension). This application scenario reads picture files from storage and displays them on a handset display as fast as possible. Therefore, the application scenario requires high read-performance, (write performance is not applicable in this case), uses a large buffer size, and requires very low endurance (since updates and modifications are not made to the pictures until they are deleted). There is no security policy for displaying pictures on a handset display. Thus, the application scenario requires a low security level (i.e. no encryption at all).</p>
<p id="p-0089" num="0108"><figref idref="DRAWINGS">FIG. 2</figref> is a simplified flowchart of an FS that automatically updates its AST PID field with the relevant PID, according to a preferred embodiment of the present invention. <figref idref="DRAWINGS">FIG. 2</figref> describes a process that tries to access a storage sub-area in which the application-scenario parameters of the process are updated in the AST. Such application-scenario parameters can be updated during development, when the developer knows the specific application and its application-scenario parameters (e.g. the WMP described in Table 1A), or during application run-time (as described in <figref idref="DRAWINGS">FIG. 4</figref>).</p>
<p id="p-0090" num="0109">Every time a process sends a storage request through the FS-services API of the OS (Step <b>20</b>), the OS sends the FS a request with an attached PID, as described above with regard to <figref idref="DRAWINGS">FIG. 1</figref>. The FS checks if the PID is listed in the PID field of one of the application scenarios in the AST (Step <b>22</b>). If the PID appears, the FS executes the process request (Step <b>24</b>), and the registration process comes to an end (Step <b>26</b>). If it does not appear, then the FS sends a request to the OS (responsible for the processes list as described above with regard to <figref idref="DRAWINGS">FIG. 1</figref>) to get the application name according to the PID (Step <b>28</b>). Once the FS gets the application name from the OS, the FS registers the process by updating the PID field in all application-scenario entries that include the relevant application name (Step <b>30</b>). If the FS does not find any entry that corresponds to the application name, it does not update any field.</p>
<p id="p-0091" num="0110">The FS then executes the request according the application-scenario parameters retrieved from the relevant application-scenario entries located in the AST (described in <figref idref="DRAWINGS">FIG. 3</figref>), or according to default parameters if corresponding entries are not found (Step <b>24</b>). The registration process then comes to an end (Step <b>26</b>).</p>
<p id="p-0092" num="0111"><figref idref="DRAWINGS">FIG. 3</figref> is a simplified flowchart of application-scenario parameters that are sent by a process, and are updated in application run-time, according to a preferred embodiment of the present invention. <figref idref="DRAWINGS">FIG. 3</figref> shows how a process, whose application-scenario parameters have not been updated into the AST during development, sends the application-scenario parameters to be updated in the AST in application run-time.</p>
<p id="p-0093" num="0112">Once the application is launched (as described above with regard to <figref idref="DRAWINGS">FIG. 1</figref>) (Step <b>32</b>), the process sends the application-scenario parameters to the FS through the FS-services API of the OS (Step <b>34</b>). The OS sends the request attached with the PID) (as described above with regard to <figref idref="DRAWINGS">FIG. 1</figref>) to the FS. The FS sends a request to the OS (responsible for the processes list as described above with regard to <figref idref="DRAWINGS">FIG. 1</figref>) to get the application name according to the PID (Step <b>36</b>). Once the FS gets the application name from the OS, the FS checks in the AST if there are any application-scenario entries with an application-name field identical to the application name that the FS received from the OS (Step <b>38</b>).</p>
<p id="p-0094" num="0113">If there are no application-scenario entries in the AST with the same application name, then the FS adds the application-scenario parameters into the AST (Step <b>40</b>). At the same time, the FS updates the PID in the new application-scenario entries. The process of updating application-scenario parameters into the AST then comes to an end (Step <b>42</b>).</p>
<p id="p-0095" num="0114">If there are application-scenario entries in the AST (as verified in Step <b>38</b>) with the same application name, then the FS just updates the PID by updating the appropriate PID field in the AST in the relevant application-scenario entries (Step <b>44</b>). The process of updating application scenarios parameters into the AST then comes to an end (Step <b>42</b>).</p>
<p id="p-0096" num="0115"><figref idref="DRAWINGS">FIG. 4</figref> is a simplified flowchart of the processing of a storage request, according to a preferred embodiment of the present invention. <figref idref="DRAWINGS">FIG. 4</figref> shows how the FS directs data (sent or requested by a process) to and from the relevant storage sub-area. A process calls an FS-services API of the OS with file name or file handle (described above with regard to <figref idref="DRAWINGS">FIG. 1</figref>) (Step <b>50</b>). The OS sends to the FS a request with an attached PID (as described above with regard to <figref idref="DRAWINGS">FIG. 1</figref>). The FS searches for an appropriate application scenario listed in the AST that matches the storage request received from the process according to PID, the operation type (e.g. read, write, create, delete, and rename), and the file name (Step <b>52</b>). File name can also be derived from the file handle by the FS, as described above with regard to <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0097" num="0116">The FS then reads the relevant application-scenario parameters from the AST (Step <b>54</b>). Next, the FS checks if the request is a write command or not (Step <b>56</b>). If the request is a write command, the FS looks in the SAT sub-area parameters, and tries to find an available storage sub-area with attributes that best match the attributes that were read from the AST (Step <b>58</b>). If the request is a read command, then the FS continues to the next step in the procedure.</p>
<p id="p-0098" num="0117">The FS then determines a storage mode according to the desired AST parameters (described in Table 3), and the matching SAT sub-area parameters (described in Table 2) provided by the storage sub-area (Step <b>60</b>). Lastly, the FS executes the command received from the process in Step <b>50</b> (Step <b>62</b>), and the data request by the FS comes to an end (Step <b>64</b>).</p>
<p id="p-0099" num="0118">While the invention has been described with respect to a limited number of embodiments, it will be appreciated that many variations, modifications, and other applications of the invention may be made.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method, comprising:
<claim-text>receiving a request from an operating system, the request having a process identifier;</claim-text>
<claim-text>searching an application scenario table (AST) to match the process identifier of the request with an application scenario associated with the process identifier, the AST having multiple sections, a first section containing parameters defining application scenarios, the parameters including an application name, a file type, and a storage operation;</claim-text>
</claim-text>
<claim-text>matching (a) storage requirements associated in the AST with the storage operation of the application scenario with (b) storage sub area attribute values in a storage attributes table (SAT), the SAT providing attribute values for at least two different storage sub areas in a flash memory of the digital storage device, wherein the storage requirements include timing punctuality and power saving, and wherein the attribute values differ for the at least two different storage sub areas; and
<claim-text>selecting a storage sub area in the flash memory for the file in the digital storage device based on the matching of the storage requirements, wherein each operation is executed by a processor.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein if the searching fails to find the process identifier, then the method includes,
<claim-text>requesting the application name from the operating system;</claim-text>
<claim-text>searching the AST for the application scenario having the application name; and</claim-text>
<claim-text>updating application scenarios in the AST for each found application scenario having the application name to include the process identifier of the request.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the AST includes a section listing a process identifier for each application name and wherein multiple process identifiers may be assigned to each application scenario.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. A method, comprising:
<claim-text>receiving a request from an operating system, the request having a process identifier;</claim-text>
<claim-text>searching an application scenario table (AST) to match the process identifier of the request with an application scenario associated with the process identifier, the AST having multiple sections, a first section containing parameters defining application scenarios, the parameters including an application name, a file type, and a storage operation;</claim-text>
</claim-text>
<claim-text>matching (a) storage requirements associated in the AST with the storage operation of the application scenario with (b) storage sub area attribute values in a storage attributes table (SAT), the SAT providing attribute values for at least two different storage sub areas in a flash memory of the digital storage device, wherein the storage requirements include timing punctuality and endurance, and wherein the attribute values differ for the at least two different storage sub areas; and
<claim-text>selecting a storage sub area in the flash memory for the file in the digital storage device based on the matching of the storage requirements, wherein each operation is executed by a processor.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein if the application name is not found, the method includes,
<claim-text>updating the AST during run time with parameters associated with the process identifier.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. One or more computer readable media, which are non-transitory, storing a program, wherein the program, when executed, instructs a processor to perform the following operations:
<claim-text>receive a request from an operating system, the request having a process identifier;</claim-text>
<claim-text>search an application scenario table (AST) to match the process identifier of the request with an application scenario associated with the process identifier, the AST having multiple sections, a first section containing parameters defining application scenarios, the parameters including an application name, a file type, and a storage operation;</claim-text>
<claim-text>match (a) storage requirements associated in the AST with the storage operation of the application scenario with (b) storage sub area attribute values in a storage attributes table (SAT), the SAT providing attribute values for at least two different storage sub areas in a flash memory of the digital storage device, wherein the storage requirements include timing punctuality and power saving or timing punctuality and endurance, and wherein the attribute values differ for the at least two different storage sub areas; and</claim-text>
<claim-text>select a storage sub area in the flash memory for the file in the digital storage device based on the matching of the storage requirements.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The computer-readable media of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein if the searching fails to find the process identifier, then the operations further include operations to:
<claim-text>request the application name from the operating system;</claim-text>
<claim-text>search the AST for the application scenario having the application name; and</claim-text>
<claim-text>update application scenarios in the AST for each found application scenario having the application name to include the process identifier of the request.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The computer-readable media of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the AST includes a section listing a process identifier for each application name and wherein multiple process identifiers may be assigned to each application scenario.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The computer-readable media of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein if the application name is not found, then the operations further include operations to:
<claim-text>update the AST during run time with parameters associated with the process identifier.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
