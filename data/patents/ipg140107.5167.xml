<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08626266-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08626266</doc-number>
<kind>B1</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13315234</doc-number>
<date>20111208</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>5</main-group>
<subgroup>055</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>600413</main-classification>
<further-classification>600509</further-classification>
</classification-national>
<invention-title id="d2e43">ECG triggered heart and arterial magnetic resonance imaging</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4310243</doc-number>
<kind>A</kind>
<name>Brown et al.</name>
<date>19820100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>4537200</doc-number>
<kind>A</kind>
<name>Widrow</name>
<date>19850800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>4893626</doc-number>
<kind>A</kind>
<name>Henley et al.</name>
<date>19900100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>4991580</doc-number>
<kind>A</kind>
<name>Moore</name>
<date>19910200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>4991587</doc-number>
<kind>A</kind>
<name>Blakely</name>
<date>19910200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>5038785</doc-number>
<kind>A</kind>
<name>Blakeley et al.</name>
<date>19910800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>5042499</doc-number>
<kind>A</kind>
<name>Frank et al.</name>
<date>19910800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600511</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>5436564</doc-number>
<kind>A</kind>
<name>Kreger</name>
<date>19950700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>5511553</doc-number>
<kind>A</kind>
<name>Segalwitz</name>
<date>19960400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>5523534</doc-number>
<kind>A</kind>
<name>Meister</name>
<date>19960600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>5526813</doc-number>
<kind>A</kind>
<name>Yoshida</name>
<date>19960600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>5917919</doc-number>
<kind>A</kind>
<name>Rosenthal</name>
<date>19990600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>381 7111</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>5987348</doc-number>
<kind>A</kind>
<name>Fischer</name>
<date>19991100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>6032063</doc-number>
<kind>A</kind>
<name>Hoar</name>
<date>20000200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>6052614</doc-number>
<kind>A</kind>
<name>Morris</name>
<date>20000400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>6070097</doc-number>
<kind>A</kind>
<name>Kreger</name>
<date>20000500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>6201981</doc-number>
<kind>B1</kind>
<name>Yarita</name>
<date>20010300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>7039455</doc-number>
<kind>B1</kind>
<name>Brosovich</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2002/0133086</doc-number>
<kind>A1</kind>
<name>Connelly et al.</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2003/0018248</doc-number>
<kind>A1</kind>
<name>Kreger et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600413</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>2004/0015067</doc-number>
<kind>A1</kind>
<name>Watson</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>2004/0225210</doc-number>
<kind>A1</kind>
<name>Brosovich et al.</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600372</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2009/0163798</doc-number>
<kind>A1</kind>
<name>Abbott et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00024">
<othercit>F. Odille, C. Pasquier, R. Abacherli, P.-A. Vuissoz, G.P. Zientara, and J. Felblinger, Noise Cancellation Signal Processing Method and computer System for Improved Real-Time Electrocardiogram artifact correction During MRI Data Acquisition, IEEE Transactions on Biomedical Engineering, vol. 54, No. 4, pp. 630-640, Apr. 2007, Institute of Electrical and Electronics Engineers, new York, NY.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00025">
<othercit>J.M. Parker, J.R. aLGER, M.A. Woo, D. Spriggs, and R.M. Harper, &#x201c;Acquisition of Electrophysiological Signals During Magnetic Resonance Imaging&#x201d;, Sleep, vol. 22, No. 8, pp. 1125-1126, 1999, UCLA, Los Angeles, CA.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00026">
<othercit>H.R. Van Genderingen, M. Sprenger, J.W. De Ridder, A.C. Van Rossum, &#x201c;Carbon-Fiber electrodes and Leads for Electrocardiography During MR Imaging&#x201d;, Radiology, vol. 171, p. 872, 1989, Free University Hospital Amsterdam, The Netherlands.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00027">
<othercit>M. Yelderman, B. Widrow, J.M. Coiffi, E. Hesler, and J.A. Leddy, ECG Enhancement by Adaptive Cancellation of Electrosurgical Interference, IEEE transactions on Biomedical Engineering, vol. BME-30, No. 7, Jul. 1983.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00028">
<othercit>Guha, S., &#x201c;Bioengineering in Reproduction Medicine.&#x201d; C CRC Press Boca Raton, FL, 1989, 2 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00029">
<othercit>Kreger, K.S. &#x26; Giordano, C.R., Biopotential Adaptive Filtering in an MR Environment. Paper presented at the SMRM 11th Annual Scientific Meeting, 1992, p. 661.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00030">
<othercit>B.J. Mossawir, R.D. Venook, and C.C. Wang, &#x201c;On the Applicability of the LMS Algorithm to Gradient Noise Elimination from EKG Signals During an MRI Scan&#x201d;, Stanford University, California, 2003.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00031">
<othercit>R. Abacherli, C. Pasquier, F. Odille, M. Kraemer, J.-J. Schmid, and J. Felblinger, &#x201c;Suppression of MR Gradient Artefacts on electrophysiological Signals Based on an Adaptive Real-time Filter with LMS Coefficient Updates&#x201d;, MAGMA, vol. 18, pp. 41-50, 2005, Springer, Germany.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00032">
<othercit>J. Felblinger, C. Lehmann, and C. Boesch, &#x201c;Electrocardiogram Acquisition During MR Examinations for Patient Monitoring and Sequence Triggering&#x201d;, Magnatic Resonance Medicine, vol. 32, pp. 523-529, 1994, Wiley-Liss Inc.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00033">
<othercit>J. Felblinger, J. Slotboom, R. Kreis, B. Jung, and C. Boesch, &#x201c;Restoration of Electrophysiological Signals Distorted by Inductive effects of Magnetic Field Gradients During MR Sequences&#x201d;, Magnetic Resonance in Medicine, vol. 44, pp. 715-721, 1999, University of Bern, Switzerland.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00034">
<othercit>S.E. Fischer, S.A. Wickline, and C.H. Lorenz, &#x201c;Novel Real-time R-wave Detection Algorithm Based on the Vectorcardiogram for Accurate Gated Magnetic Resonance Acquisition&#x201d;, Magnetic Resonance in Medicine, vol. 42, pp. 361-370, 1991, William &#x26; Wilkins, Baltimore, MD.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00035">
<othercit>M.K. Laudon, J.G. Webster, R. Frayne, and T.M. Grist, &#x201c;Minimizing interference from Magnetic Resonance Images During Electrocardiography&#x201d;, IEEE Transactions on Biomedical Engineering, vol. 45, No. 2, pp. 160-164, Feb. 1998, University of Wisconsin-Madison, WI.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00036">
<othercit>B.J. Mossawir, R. D. Venook, and C.C. Wang, &#x201c;On the Applicability of the LMS Algorithm to Gradient Noise Elimination from EKG Signals During an MRI Scan,&#x201d; Jul. 29, 2005, Stanford University, CA.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00037">
<othercit>F. Odille, C. Pasquier, R. Abacherli, P.-A. Vuissoz, G.P. Zientara, and J. Felblinger, &#x201c;Noise Cancellation Signal Processing Method and computer System for Improved Real-Time Electrocardiogram artifact correction During MRI Data Acquisition,&#x201d; IEEE Transactions on Biomedical Engineering, vol. 54, No. 4, pp. 630-640, Apr. 2007, Institute of Electrical and Electronics Engineers, new York, NY.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00038">
<othercit>Guha, S., &#x201c;Bioengineering in Reproduction Medicine,&#x201d; C CRC Press Boca Raton, FL, 1989, 2 pages.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00039">
<othercit>Kreger, K.S. &#x26; Giordano, C.R., &#x201c;Biopotential Adaptive Filtering in an MR Environment,&#x201d; Paper presented at the SMRM 11th Annual Scientific Meeting, 1992, p. 661.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00040">
<othercit>J. Felblinger, C. Lehmann, and C. Boesch, &#x201c;Electrocardiogram Acquisition During MR Examinations for Patient Monitoring and Sequence Triggering&#x201d;, Magnatic Resonance Medicine, vol. 32, pp. 523-529, Wiley-Liss Inc., 1994.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00041">
<othercit>B. J. Mossawir, R. D. Venook, and C. C. Wang, &#x201c;On the Applicability of the LMS Algorithm to Gradient Noise Elimination from EKG Signals During an MRI Scan&#x201d;, accessed on Jul. 29, 2005, link: http://www.stanford.edu/&#x2dc;darkside/mywork/ee373finalreport.pdf.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00042">
<othercit>Extended Search Report from European Patent Office dated Jul. 5, 2013, issued in corresponding European Patent Application No. 13156941.0. (6 pages).</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>14</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>600413</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600509</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>36</number-of-drawing-sheets>
<number-of-figures>37</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>13234762</doc-number>
<date>20110916</date>
</document-id>
<parent-status>ABANDONED</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13315234</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>11809876</doc-number>
<date>20070601</date>
</document-id>
<parent-status>ABANDONED</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13234762</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60809833</doc-number>
<date>20060601</date>
</document-id>
</us-provisional-application>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Frank</last-name>
<first-name>Thomas H.</first-name>
<address>
<city>Crofton</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Blaumanis</last-name>
<first-name>Otis R.</first-name>
<address>
<city>Sparks</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>La Rosa</last-name>
<first-name>Joseph A.</first-name>
<address>
<city>Baltimore</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Word</last-name>
<first-name>Yvette M.</first-name>
<address>
<city>Pasadena</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Frank</last-name>
<first-name>Thomas H.</first-name>
<address>
<city>Crofton</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Blaumanis</last-name>
<first-name>Otis R.</first-name>
<address>
<city>Sparks</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>La Rosa</last-name>
<first-name>Joseph A.</first-name>
<address>
<city>Baltimore</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Word</last-name>
<first-name>Yvette M.</first-name>
<address>
<city>Pasadena</city>
<state>MD</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Buchanan Ingersoll &#x26; Rooney PC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Perinatronics Medical Systems, Inc.</orgname>
<role>02</role>
<address>
<city>Crofton</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Cwern</last-name>
<first-name>Jonathan</first-name>
<department>3737</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">High resistance non-metallic ECG leads are used to capture biologically generated electrical signals, and include at least one magnetic resonance noise lead to capture a noise reference signal indicative of electromagnetic noise ambient to the leads generated by magnetic resonance imaging (MRI). The noise reference signal is canceled from the captured electrical signal using an adaptive canceling noise filter to obtain a processed electrical signal indicative of the biologically generated electrical signal that causes movement in a patient's moving body part, such as the heart. A characteristic of the processing electrical signal indicative of the biologically generated electrical signal that causes the movement is detected to obtain a trigger signal, which is then transmitted to cause the MRI system to capture at least one imagine including the moving body part.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="180.93mm" wi="135.81mm" file="US08626266-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="215.73mm" wi="93.30mm" orientation="landscape" file="US08626266-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="200.49mm" wi="95.93mm" file="US08626266-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="183.13mm" wi="157.31mm" file="US08626266-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="194.23mm" wi="108.71mm" file="US08626266-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="186.10mm" wi="133.69mm" orientation="landscape" file="US08626266-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="210.06mm" wi="201.51mm" orientation="landscape" file="US08626266-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="183.22mm" wi="162.31mm" orientation="landscape" file="US08626266-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="199.81mm" wi="145.37mm" orientation="landscape" file="US08626266-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="200.49mm" wi="128.86mm" file="US08626266-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="194.65mm" wi="143.34mm" orientation="landscape" file="US08626266-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="196.85mm" wi="115.57mm" orientation="landscape" file="US08626266-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="202.61mm" wi="97.96mm" file="US08626266-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="161.63mm" wi="144.78mm" file="US08626266-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="184.15mm" wi="147.49mm" orientation="landscape" file="US08626266-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="142.16mm" wi="164.68mm" file="US08626266-20140107-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="172.89mm" wi="164.00mm" file="US08626266-20140107-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="198.12mm" wi="147.49mm" file="US08626266-20140107-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="193.04mm" wi="95.08mm" orientation="landscape" file="US08626266-20140107-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00019" num="00019">
<img id="EMI-D00019" he="194.65mm" wi="118.70mm" orientation="landscape" file="US08626266-20140107-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00020" num="00020">
<img id="EMI-D00020" he="215.90mm" wi="219.63mm" file="US08626266-20140107-D00020.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00021" num="00021">
<img id="EMI-D00021" he="160.10mm" wi="159.85mm" file="US08626266-20140107-D00021.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00022" num="00022">
<img id="EMI-D00022" he="180.42mm" wi="173.40mm" file="US08626266-20140107-D00022.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00023" num="00023">
<img id="EMI-D00023" he="202.78mm" wi="138.35mm" orientation="landscape" file="US08626266-20140107-D00023.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00024" num="00024">
<img id="EMI-D00024" he="201.25mm" wi="111.68mm" orientation="landscape" file="US08626266-20140107-D00024.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00025" num="00025">
<img id="EMI-D00025" he="215.90mm" wi="210.14mm" file="US08626266-20140107-D00025.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00026" num="00026">
<img id="EMI-D00026" he="217.85mm" wi="223.10mm" file="US08626266-20140107-D00026.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00027" num="00027">
<img id="EMI-D00027" he="218.19mm" wi="257.22mm" file="US08626266-20140107-D00027.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00028" num="00028">
<img id="EMI-D00028" he="189.74mm" wi="126.75mm" file="US08626266-20140107-D00028.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00029" num="00029">
<img id="EMI-D00029" he="204.55mm" wi="123.70mm" orientation="landscape" file="US08626266-20140107-D00029.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00030" num="00030">
<img id="EMI-D00030" he="184.83mm" wi="169.59mm" file="US08626266-20140107-D00030.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00031" num="00031">
<img id="EMI-D00031" he="192.19mm" wi="129.88mm" orientation="landscape" file="US08626266-20140107-D00031.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00032" num="00032">
<img id="EMI-D00032" he="176.61mm" wi="156.04mm" orientation="landscape" file="US08626266-20140107-D00032.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00033" num="00033">
<img id="EMI-D00033" he="169.08mm" wi="174.16mm" file="US08626266-20140107-D00033.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00034" num="00034">
<img id="EMI-D00034" he="174.07mm" wi="159.43mm" file="US08626266-20140107-D00034.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00035" num="00035">
<img id="EMI-D00035" he="166.12mm" wi="139.95mm" file="US08626266-20140107-D00035.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00036" num="00036">
<img id="EMI-D00036" he="215.90mm" wi="186.61mm" file="US08626266-20140107-D00036.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<p id="p-0002" num="0001">This application is a continuation of U.S. patent application Ser. No. 13/234,762, filed Sep. 16, 2011 now abandoned, which is a continuation of U.S. patent application Ser. No. 11/809,876, filed on Jun. 1, 2007 now abandoned, which claims the priority benefit of U.S. Provisional Application No. 60/809,833, filed Jun. 1, 2006, which are hereby incorporated by reference in their entirety.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?GOVINT description="Government Interest" end="lead"?>
<heading id="h-0001" level="1">GOVERNMENT LICENSE RIGHTS</heading>
<p id="p-0003" num="0002">This invention was made with government support under Grant HL66791, awarded by the National Institutes of Health. The government has certain rights in the invention.</p>
<?GOVINT description="Government Interest" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">Magnetic resonance imaging of hearts and connected blood vessels is the gold standard of determining pericardial structure, disease and function of the heart and its major connected vessels.</p>
<p id="p-0005" num="0004">Hearts and blood vessels are in constant motion and collecting, pooling and emptying of blood presents difficulty in stable imaging. The beating of the heart and movement of the heart and blood vessels may be regular or irregular and may be from about 70 to 150 or more beats per minute during imaging, with fluctuations of 30 beats per minute or more. Consequently it is difficult to obtain precise magnetic resonance images of the heart and its connected vessels for study and comparison.</p>
<p id="p-0006" num="0005">Needs exist for improved magnetic resonance imaging.</p>
<heading id="h-0003" level="1">BRIEF SUMMARY OF THE INVENTION</heading>
<p id="p-0007" num="0006">The invention provides new and improved acquisition, transmission, processing, and detecting systems to control triggering of magnetic imaging for producing images of the heart and principal arteries, which are subject to movement during pulsing.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of the entire ECG cardiac gating process showing the magnetic imaging system and the transmission and processing aspects of the invention.</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 2</figref> is a diagram of carbon leads to conduct the ECG signal within the MRI.</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram of the ECG data transmission hardware.</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart representation of the software signal processing of <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 5</figref> is a detailed block diagram of the LMS adaptive filter of <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart of the LMS adaptive algorithm of <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 7</figref> is a block diagram of a lattice implementation of the RLS adaptive algorithm of <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 8</figref> is a flowchart of a lattice implementation of the RLS adaptive algorithm of <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 9</figref> is a flowchart of the non-lattice implementation of the RLS adaptive algorithm of <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 10</figref> is a flowchart of the GSO vectorization of <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 11</figref> is a flowchart of two first derivative detection algorithms of <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 12</figref> is a flowchart showing the possible execution paths for one, two, or three channels of ECG data through one of three adaptive filtering algorithms, with or without GSO vectorization, and one of two derivative detection algorithms.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 13</figref> is a photograph of the MRI compatible ECG lead wire, showing the ECG electrode clip and non-ferrous connector. The inset details the non-metallic, high-resistance carbon filament fiber coated with conductive acrylic latex.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 14</figref> is an electronic schematic diagram of the MRI compatible ECG amplifier and transmitter.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 15</figref> is a photograph of the four-channel ECG amplifier and fiber optics transmitter with MR compatible lithium batteries fabricated with surface mount components.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 16</figref> is a schematic diagram of the battery eliminator. A 2.2 W 808 nm laser diode and optical fiber is used to pipe in light to a solar cell, which is configured in a cylinder, producing 3.3 volts and power the ECG amplifier.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 17</figref> is an overview of the complete analog and digital signal processing of the ECG trigger system.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 18</figref> is an electronic schematic diagram of the prototype ECG amplifier. Refinements and other chip models will allow the circuit to be implemented using only two surface-mount chips.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 19</figref> is an electronic schematic diagram of the prototype IR transmitter. The red LED on the far right is used as a visual indicator that the system is working properly.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 20</figref> is a schematic diagram of the ECG receiver showing the photodetector (LED<b>1</b>), transimpedance amplifier (U<b>1</b>A) and analog filters.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 21</figref> is a photograph of a six-channel LED optical receiver with lithium batteries.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 22</figref> illustrates the magnitude of the magnetohydrodynamic (MHD) artifact. In this case the electrodes were positioned in accordance with the standard diagnostic ECG convention. The standard ECG amplifier response (0.05-100 Hz) leads to an artifact that can be greater in magnitude than the QRS complex.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 23</figref> is an electronic schematic diagram of the prototype optical receiver. The photodiode can be mounted remotely since the intrinsic common mode rejection of the instrumentation amplifier will cancel strong electromagnetic interference. The novelty of this system is that it can be operated in a brightly lit room or even in direct sunlight.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 24</figref> is a schematic diagram of the prototype IR receiver decoder.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 25</figref> shows ECG data recorded during an MRI scan using the Perfusion Pulse Sequence. Channels S<b>1</b> and S<b>2</b> show ECG and MR artifact data recorded from two chest leads. Channels N<b>1</b> and N<b>2</b> show the artifacts (only) recorded from two channels on the subject's arm. Note the small magnitude of the ECG signal in channel S<b>2</b>.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 26</figref> shows an ECG signal collected before and during a Perfusion pulse sequence. The lower tracing shows every other ECG complex is corrupted by noise.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 27</figref> shows a Frequency plot of MR artifacts from perfusion MR Pulse Sequence (Log. Scale). Note that the noise channel (N<b>1</b>) shows frequencies in the ECG bandwidth (5-30 Hz).</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 28</figref> shows an ECG signal and MR artifact data obtained from the subject undergoing MRI scan using perfusion pulse sequence: a) data as recorded with 100 Hz anti-alias low-pass filtering; b) data as filtered with 30 Hz FFT displaying minor oscillatory behavior in the response, and c) data as processed using a weighted FIR filter.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 29</figref> shows the well known time-varying amplitude variations of the ECG signal, with breathing, are reflected in the oscillations of the GSO vector coefficient. We propose to use the GSO vector coefficients as a measure of respiration, and thus not require a separate transducer and electronics to monitor breathing.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 30</figref> shows an overview of the MRI ECG triggering system as a real-time embedded computer system.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 31</figref> shows first derivative detection effectiveness: (a) MDE S<b>1</b> channel before digital processing; (b) MDE S<b>2</b> channel before digital processing; (c) MDE S<b>1</b> channel after FFT filtering and adaptive RLS filtering; (d) MDE S<b>2</b> channel after FFT filtering and adaptive RLS filtering; (e) Sum of processed S<b>1</b> and S<b>2</b> signals with peak detections; (f) FD<b>1</b> derivative with peak detections; (g) Magnification of first ECG peak showing the start of the R-wave and the FD<b>1</b> detection point.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 32</figref> shows an overview of the experimental setup used to evaluate the performance of Perinatronics ECG trigger system. In the experimental setup, either actual archived or simulated ECG data is optically transmitted to a phantom within the scanner.</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 33</figref> shows the SNR improvement of fiber optics data transmission versus conventional cable use. The top trace illustrates the sheer magnitude of gradient artifacts introduced via the GE cabling system. The GE lead wires caused the amplitude of the artifacts to be several orders of magnitude greater than the ECG signal. The optical system, with short carbon fiber leads, resulted in artifacts being only twice the amplitude of the ECG.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 34</figref> shows input and output signals of the digital signal processing. The first graph shows ECG data plagued by gradient noise resulting from the Perfusion pulse sequence, while the second chart displays the output from the LMS algorithm. The noise is attenuated to such an extent that the ECG signal is completely visible.</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 35</figref> shows the result of RLS adaptive lattice filtering on the ECG contaminated with artifacts from an MDE MR gradient sequence.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="h-0006" num="0000">Overview of Preferred Embodiment</p>
<p id="p-0043" num="0042">The preferred embodiment, shown in <figref idref="DRAWINGS">FIG. 1</figref>, consists of electrodes placed on the chest and arm of a human subject <b>1</b>. A hardware data acquisition system <b>5</b> acquires the electrocardiogram and electrocardiographic noise from the chest and arm electrodes and optically transmits <b>2</b>, <b>4</b> those signals out of the MRI scanner. Outside of the MRI scanner, these signals are received <b>3</b>, converted back to electrical signals, and the data archived to a LabVIEW archival display computer program <b>6</b>. In addition, these signals are concurrently processed by a number of software signal processing modules <b>11</b>. The software signal processing consists of a low pass filter <b>7</b>, one of various adaptive filters <b>8</b>, a module that calculates a detection statistic using a GSO vector <b>9</b> and a module that performs ECG detection <b>10</b> and transmits a signal to the MRI to emit MR gradient pulse sequences and an RF signal to produce images. Finally, the detected electrocardiogram signal is depicted in a LabVIEW computer program display <b>12</b>.</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 32</figref> shows an overview of an experimental setup. ECG is simulated by using archived ECG <b>500</b> and a digital to analog converter (D/A <b>501</b>), or from an ECG simulator <b>507</b>. Simulated ECG is then sent to an optical transmitter <b>502</b> which sends it to the scanner via fiber optic cables <b>509</b>, where it is injected into a phantom <b>504</b>. The phantom <b>504</b> is connected to an ECG amplifier <b>505</b> which transmits the ECG signals via fiber optic cables <b>510</b> to our triggering system <b>506</b> which then processes the signals and transmits TTL triggering signals <b>508</b> back to the MRI triggering system <b>503</b>.</p>
<p id="p-0045" num="0044">In the acquisition steps of the present invention, different kinds of leads are provided to avoid electrical noise in the leads produced by magnetic fields and pulsing and shifting of magnetic fields during magnetic resonance imaging. Since the leads are connected to probes on the human subject <b>1</b> within magnetic resonance machines, it is necessary that the leads collect as little electrical noise as possible from induction by shifting and pulsing magnetic fields to provide a high signal-to-noise ratio and do not heat up sufficiently to subject the patient. The preferred leads are carbon filament wires within relatively thick insulation, and without metallic inclusions in the wires or in the insulation. The leads are as short as possible to avoid and reduce interference.</p>
<p id="p-0046" num="0045">Ends of the carbon filament leads are connected to a transmitter <b>2</b> near the human subject <b>1</b> within the magnetic resonance imaging scanner. Electronics in the transmitter <b>2</b> amplify the ECG signals and convert the amplified ECG signals to optical signals, changing voltage in the ECG signals to frequencies in the optical signal wavelength. The optical pulses are transmitted <b>4</b> through optical fibers or through the air to receivers <b>3</b> in the data acquisition hardware <b>5</b>.</p>
<p id="p-0047" num="0046">Electrodes on the human subject's chest and arm are connected by the same carbon filament leads of the same short lengths to the transmitter <b>2</b>. The purpose of the arm electrode and connected leads is not to conduct ECG signals to the transmitter <b>2</b> in the magnetic resonance scanner, but rather to pick up and conduct noise signals. The noise signals are collected directly from leads connected to the human subject's <b>1</b> body and are not collected from the imaging equipment. The detected voltage noise signals from the carbon fiber leads attached to the chest and arm electrodes are converted in the transmitter <b>2</b> to optical frequency signals and are transmitted through optical fibers or through the air to the receiver <b>3</b> outside of the magnetic resonance imaging equipment.</p>
<p id="p-0048" num="0047">The optical signals received <b>3</b> outside of the magnet either through the air or optical fibers are sent to a software signal processor <b>11</b> outside of the magnetic resonance imaging scanner. The processor operates on the signals picked up from the chest, and using the noise signals picked up from the chest or arm leads, adaptively cancels the noise. Adaptive cancelling noise filters, such as least mean squares (LMS), recursive least-squares (RLS) and least-squares lattice (LSL) filters, use the noise signals picked up from the extra leads attached to the electrodes on the human subject's chest or arm to cancel noise from the chest electrodes and leads.</p>
<p id="p-0049" num="0048">In the software signal processor <b>11</b>, after noise is filtered <b>7</b>, <b>8</b>, the Gram-Schmidt Orthogonalization (GSO) <b>9</b> vectors are formed and derivatives of the ECG signal are taken to detect <b>10</b> the rising edge of the R wave within the ECG signal as soon as possible to trigger the transmission of the MRI magnetic gradient pulse sequences to produce precise images of the heart and primary vessels at times in the heartbeat cycle.</p>
<p id="h-0007" num="0000">ECG Leads</p>
<p id="p-0050" num="0049">A preferred embodiment uses high resistance non-metallic ECG leads. While conventional cables for acquiring ECG signals within the MR scanner have successfully dealt with the concerns of patient heating, they are very fragile, cumbersome and expensive. The usual practice for GE, Philips and Invivo has been to utilize this six foot distributed lead wire harness assembly with an additional ten feet of cabling which incorporates a set of delicate lead wires. Each lead wire has a fragile nichrome wire, helically wound on a bundle of glass that is then surrounded by a thermally insulating jacket. This arrangement provides a high resistance to each lead wire, so that eddy currents generated by the RF energy within the magnet are reduced without heating the subject.</p>
<p id="p-0051" num="0050">The present invention is based primarily on the consideration of patient safety and the potential for RF heating effects and image artifacts caused by the induction of eddy currents within the ECG leads by the time-varying MR gradients. Both of these effects are diminished by reducing the amplitude of the eddy currents which are inversely proportional to the resistance of the conductor.</p>
<p id="p-0052" num="0051">A preferred embodiment uses an MR compatible ECG lead system of a considerably different design, illustrated in <figref idref="DRAWINGS">FIG. 2A-2C</figref> and <b>13</b>, the effectiveness of which has been demonstrated in clinical testing and is shown in <figref idref="DRAWINGS">FIG. 33</figref>. The top trace <b>2101</b> shows the ECG <b>2103</b> recorded with conventional (GE) leads, while the bottom trace <b>2107</b> shows ECG <b>2109</b> data acquired with PMS optical cable. As the sequence begins <b>2105</b>, <b>2111</b>, each trace shows the additional artifacts mixed with the ECG signals. This lead system uses short (12 in.) lengths of high resistance carbon impregnated fiberglass material in <figref idref="DRAWINGS">FIG. 2A</figref>. The fiberglass <b>22</b> is wrapped with a conductive acrylic latex sheath <b>21</b> providing a distributed impedance of approximately 8.6K ohms/foot. In addition, an overall silicone rubber jacket <b>20</b> provides thermal resistance. <figref idref="DRAWINGS">FIG. 2B</figref> shows the distal end of the high resistance carbon impregnated material wire <b>23</b> with an attached electrical connector <b>26</b>, <b>27</b>. The electrical plug connector consists of an approximate 2&#x2033; copper wire gauge #14 <b>26</b>. That wire <b>26</b> is soldered at connection <b>27</b> to a brass ring <b>25</b> of approximately 8 mm in diameter and approximately &#x215b; inch width. Following the connection of <b>26</b> with <b>25</b>, the ring is placed over the silicon rubber jacket and is physically crimped to electrically connect wire <b>26</b> to an approximate &#xbd; inch length of the conductive acrylic latex sheath <b>24</b>.</p>
<p id="p-0053" num="0052"><figref idref="DRAWINGS">FIG. 2C</figref> shows the proximal end of the ECG carbon wire <b>28</b> with an attached &#xbd; inch copper wire <b>31</b> ECG and connector <b>34</b>. The electrical connector at the distal end is assembled in a fashion similar to that previously described for the end shown in <figref idref="DRAWINGS">FIG. 2B</figref>. More specifically, <figref idref="DRAWINGS">FIG. 2C</figref> shows an electrode connector <b>34</b> and its connecting copper wire <b>31</b> soldered at connection <b>33</b> to a brass ring <b>30</b> and later crimped to make a good electrical connection with the conductive acrylic latex sheath <b>29</b>.</p>
<p id="p-0054" num="0053">In a 1.5 T magnet this ECG lead assembly did not indicate a temperature exceeding 37&#xb0; C. on a Thermax Level 8 surface temperature indicator strip. This material is not fragile or cumbersome to work with in patient monitoring; it is also inexpensive.</p>
<p id="h-0008" num="0000">Transmission</p>
<p id="p-0055" num="0054">A preferred embodiment, as shown in <figref idref="DRAWINGS">FIG. 3</figref>, uses a low cost light emitting diode (LED) optical transmission design. This optical ECG transmission system provides a means of transmitting ECG signals from the MR scanner which substantially mitigates the MR scanner's electromagnetic interference, has the potential to be &#x201c;wireless&#x201d;, i.e., no fiber optics, and is simple and inexpensive. The system uses an LED analog transmission system and is therefore much less complex and less expensive than a digital system would be. <figref idref="DRAWINGS">FIG. 3</figref> shows an optical transmitter <b>40</b> and an optical receiver <b>52</b>. More specifically, the optical transmitter <b>40</b> consists of an RF filter <b>41</b> and instrumentation amplifier <b>42</b>, a means to provide a voltage offset removal <b>43</b> from the instrumentation amplifier, a voltage reference <b>44</b> for the LED driver <b>45</b>, and finally, the LED transmitter <b>46</b>. The specific details of the optical receiver <b>52</b> consist of a photodiode detector LED <b>47</b>, a transimpedance amplifier <b>48</b>, a high pass filter <b>49</b>, a low pass filter <b>50</b>, followed by a data acquisition system <b>51</b>. The transmitter LED <b>46</b> and receiver photodiode detector LED <b>47</b> are a matched pair supplied by Industrial Fiber Optics, Inc.</p>
<p id="p-0056" num="0055">We have established the following specifications for our MRI ECG data acquisitions and optical transmission system: 1) an instrumentation amplifier (INA) based ECG amplifier <b>2507</b>, 2) INA gain between 1 and 50, and 3) INA AC coupled to LED-based fiber optics transmitter.</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 14</figref> shows the electrical schematic diagram of the amplification and transmission modules. Unnecessary details, such as decoupling capacitors and other construction-related items, have been left out for clarity. Four to six channels are constructed. The INA (Texas Instruments INA128, or Analog Devices AD8221) are chosen for its superb common mode rejection capability (&#x2dc;130 dB). Capacitors <b>2501</b>, <b>2503</b> and <b>2505</b>, in combination with the high resistance of the carbon fiber ECG leads, form an RF filter with a low pass cutoff at approximately 8 KHz, which is orders of magnitude below the MR and RF-coil excitation frequencies.</p>
<p id="p-0058" num="0057">The output of the INA is capacitor <b>2509</b> coupled to a differential amplifier (OPA4277) which serves as the LED driver. Capacitor <b>2509</b> and resistor <b>2511</b> act as a high pass filter to ensure that spurious offsets from the INA do not influence the bias-point of the LED, which is independently controlled by potentiometer <b>2527</b>. The reference for the LED bias is derived from a voltage reference source <b>2525</b> which allows the batteries to be virtually exhausted without affecting the quality of the transmitted ECG signal. Capacitor <b>2523</b> removes the high frequency of the supply. In an alternative embodiment, power is piped in over an optical fiber, using a laser diode and miniature solar cells as the power source. A photograph of the amplifier and fiber optics transmitter is shown in <figref idref="DRAWINGS">FIG. 15</figref>.</p>
<p id="p-0059" num="0058">The LED driver consists of operational amplifier OPA4277, <b>2521</b>A together with low pass filters consisting of RC combinations of <b>2517</b>, <b>2519</b> and <b>2513</b>, <b>2515</b> respectively.</p>
<p id="p-0060" num="0059">In a preferred embodiment, the transmitter LEDs <b>2529</b> are low power red 660 nm wavelength and the receiver accepts power from the real-time computer system. The printed circuit boards of both the transmitter and receiver are designed to reduce their size and eliminate as much metal as possible.</p>
<p id="h-0009" num="0000">Reception</p>
<p id="p-0061" num="0060">In a preferred embodiment, a low cost LED optical receiver is used. An optical ECG data receiver placed outside the scanner room includes a photodiode-based transimpedance amplifier with easily adjustable gain, high-pass analog filter (2-pole Butterworth with 1-5 Hz cutoff), and low-pass analog filter (multi-pole Butterworth with 35-200 Hz cutoff).</p>
<p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. 20</figref> shows the electrical schematic diagram of the ECG receiver. The receiver photodetector LED <b>2803</b> circuit is a low-gain transimpedance amplifier <b>2801</b>A. The low gain, which can be adjusted via potentiometer <b>2805</b>, is acceptable because of the brightness of the transmitter LED and the efficiency of the fiber optics coupling (total length &#x3c;30 feet). The transmitter and receiver can be coupled through approximately 25 feet of 1 mm plastic optical fibers (Industrial Fiber Optics, Inc. IF-E90 &#x26; IF-D90 series). It is desirable to maintain a low gain on the transmitter amplifier because the input signal voltage can be very large due to the large gradient switching artifacts and a high gain would lead to signal clipping.</p>
<p id="p-0063" num="0062">The photodiode amplifier in the receiver is followed by high-pass and low-pass filters. The high-pass filter consisting of an op amp <b>2801</b>B and discrete RC components <b>2807</b>, <b>2809</b>, <b>2811</b>, <b>2813</b>, <b>2815</b> is a two-pole Butterworth filter with 1-5 Hz cutoff. This filter is very effective in reducing some (and, in some cases, all) of the magneto hydrodynamic (MHD) artifact from the ECG ST segment and T-wave as shown in <figref idref="DRAWINGS">FIG. 22</figref>. The MHD artifact <b>1001</b> can be virtually eliminated <b>1003</b> by judicious electrode placement and by raising the high-pass filter cutoff to 5.0 Hz. These simple maneuvers solve the MHD artifact problem in detection of the ECG R-wave.</p>
<p id="p-0064" num="0063">The low-pass filter consisting of op amps <b>2801</b>C-D and discrete RC components <b>2817</b>, <b>2819</b>, <b>2821</b>, <b>2823</b>, <b>2825</b>, <b>2827</b>, <b>2829</b>, <b>2831</b>, <b>2833</b> and <b>2835</b> is also a multi-pole Butterworth design with a frequency cutoff range between 35 and 200 Hz, which also serves as an anti-aliasing filter for the data acquisition system which follows the receiver. The values have been determined to be optimal through a series of alternate designs. The relatively wide latitudes in gain and cutoff frequencies in the ECG transmitter and receiver have allowed a flexible design. This latitude is easily justified by the wide dynamic range and power of the digital signal processing capabilities of the computer algorithm. A photograph of the ECG optical receiver is shown in <figref idref="DRAWINGS">FIG. 21</figref>.</p>
<p id="h-0010" num="0000">Analog-to-Digital Conversion, Data Acquisition and Data Archival Methods</p>
<p id="p-0065" num="0064">Several channels of ECG, RF, and gradient artifact noise are acquired and transmitted into the control room to the data acquisition system. The output from each channel of the optical receiver connects to a Personal Computer Memory Card International Association (PCMCIA) analog-to-digital converter module by means of a 50-pin ribbon cable. The data is digitized to 16 bits using a Computer Boards (now Measurement Computing Corp., Middleboro, Mass.) PCMCIA card PC-DAS16/16-AO and each channel is sampled at, for example, 4098 samples/second. The data can be collected and archived using a data acquisition application designed using LabVIEW 7 Express, which can be executed on a Dell Inspiron 8600 laptop computer.</p>
<p id="h-0011" num="0000">Digital Signal Inputs</p>
<p id="p-0066" num="0065">As shown in <figref idref="DRAWINGS">FIG. 1</figref>, four or six channels of data are collected using the data acquisition hardware. In one embodiment, two channels from the patient's chest (S<b>1</b> and S<b>2</b>) and two from the arm (N<b>1</b> and N<b>2</b>), collected at 4098 samples/second, for example, provide sufficient data fidelity to successfully isolate the respiration and ECG R waves, though another embodiment with a third set of channels (S<b>3</b> and N<b>3</b>) provides greater accuracy.</p>
<p id="p-0067" num="0066"><figref idref="DRAWINGS">FIG. 25</figref> illustrates that different anatomical positions of the ECG electrodes on the chest, labeled as channel S<b>1</b> and channel S<b>2</b>, produce quite different ECG recordings <b>1501</b>, <b>1503</b>, while both channels have the same gain. For this reason, the GSO vector lead system is utilized to provide the vector sum of these two ECG signals. Poor signal-to-noise ratio is also evidenced in <figref idref="DRAWINGS">FIG. 25</figref>. <figref idref="DRAWINGS">FIG. 25</figref> also shows two additional recorded channels of magnetic gradient artifact alone, labeled as channel N<b>1</b> and channel N<b>2</b> <b>1505</b>, <b>1507</b>. This data was recorded from the subject's arm during the MR imaging scan.</p>
<p id="p-0068" num="0067"><figref idref="DRAWINGS">FIG. 26</figref> shows an expanded time course of a 4-second portion of ECG data from the same subject. The upper trace shows a record of the ECG (alone) prior to MR image scanning, i.e., without magnetic gradient artifacts <b>1601</b>. The data in the lower trace was collected during an MR imaging scan using the perfusion pulse sequence <b>1603</b>. The lower tracing shows that the gradient amplitudes <b>1607</b> are of such a significant magnitude that detection of the ECG complexes <b>1605</b> would be virtually impossible without additional digital signal processing.</p>
<p id="p-0069" num="0068">Different sampling rates are available, with lower rates requiring less processing speed and higher rates providing greater accuracy but requiring greater processing speed for real-time implementation. All signals are received from within the magnet and transmitted to a computer outside the MRI scanner. The signals are archived to hard disk and displayed.</p>
<p id="h-0012" num="0000">FFT and FIR Digital Filtering</p>
<p id="p-0070" num="0069">Now, since most of the power of the ECG is in the 5-30 Hz bandwidth, frequencies above 30 Hz are safely filtered out without seriously distorting the ECG. The hardware data acquisition system already includes an analog anti-aliasing low pass filter with a 100 Hz cutoff frequency to begin to attenuate the large magnitude high frequency artifacts. In order to implement the required filtering in a real time environment as is required for triggering in a preferred embodiment a Finite Impulse Response (FIR) digital filter design is employed. One such filter is a hamming window-based, discrete-time, direct-form, FIR filter design with a cutoff frequency of 30 Hz.</p>
<p id="p-0071" num="0070">The top trace <b>1701</b> in <figref idref="DRAWINGS">FIG. 27</figref> shows the spectrum, on a logarithmic scale, of the ECG plus magnetic gradient artifacts. The lower trace <b>1703</b> shows the spectrum of the magnetic gradient artifacts alone. Most of the power of the ECG is in the 5-30 Hz bandwidth. As can be seen from the figure, the MR gradient artifact noise pulse sequence spectrum completely overlaps the diagnostic ECG spectrum. Since these harmonics completely mask the ECG complex, it is not possible to extract the ECG complex from the magnetic gradient artifacts using traditional frequency filtering.</p>
<p id="p-0072" num="0071"><figref idref="DRAWINGS">FIG. 27</figref> illustrates that by viewing the MR artifact noise in the frequency domain, it becomes apparent that the MRI introduces a &#x201c;fundamental&#x201d; noise frequency with many harmonics. These interfering frequencies are discrete and defined by the loop structure in the MR imaging pulse sequences. The fundamental frequency of each MRI pulse sequence varies, but is determined by the repetition rates of any given sequence. The fundamental frequency of the Perfusion scan is at 5.66 Hz, as shown in <figref idref="DRAWINGS">FIG. 27</figref>, with harmonics at 11.33, 17.0, 22.67, 28.33, 34.0 Hz, etc. This artifact noise is within the base band and is not aliased. <figref idref="DRAWINGS">FIG. 28</figref> shows an ECG signal and MR artifact data obtained from the subject undergoing MRI scan using perfusion pulse sequence: a) data as recorded with 100 Hz anti-alias low-pass filtering <b>1801</b>; b) data as filtered with 30 Hz FFT displaying minor oscillatory behavior in the response <b>1803</b>, and c) data as processed using a weighted FIR filter <b>1805</b>.</p>
<p id="h-0013" num="0000">Adaptive Filtering Methods</p>
<p id="p-0073" num="0072">A least mean square (LMS) adaptive noise cancellation filter illustrated in a block diagram in <figref idref="DRAWINGS">FIG. 4</figref> and <figref idref="DRAWINGS">FIG. 5</figref>, and in a detailed flow chart in <figref idref="DRAWINGS">FIG. 6</figref>, is used to cancel the noise created by the time-varying MR gradient artifacts that occur in the same frequency band as the ECG data. S<b>1</b>, the low-pass frequency filtered data as described above and shown by <b>81</b> and <b>132</b>, is the primary input into the least mean square (LMS) filter. The application of the least mean square (LMS) adaptive noise cancellation filter also requires access to a &#x201c;noise reference.&#x201d; This noise reference can be obtained either from one set of chest electrodes in which the ECG signal is relatively weak or obtained by simply attaching additional ECG electrodes to one of the subject's arms.</p>
<p id="p-0074" num="0073"><figref idref="DRAWINGS">FIG. 4</figref> shows the flowchart of the software signal processing <b>80</b> tasks and <figref idref="DRAWINGS">FIG. 6</figref> shows the flowchart of the implementation of the LMS algorithm <b>130</b>. The data is sampled at 4098 samples/second <b>131</b> at 16 bits per sample. Through a number of carefully controlled studies, it was determined that a desirable noise reference input for the LMS filter is obtained by adding two or three MRI noise channels (N<b>1</b>+N<b>2</b>) <b>82</b>. The step size parameter of the LMS filter, &#x3bc;, in the steepest descent algorithm in our detailed implementation 134 is a function of primary signal power and the number of weights used e.g. 32, or 64. The weight is initially set to zero <b>135</b>. <figref idref="DRAWINGS">FIG. 34</figref> shows the primary input consisting of the ECG plus gradient artifacts from the perfusion scan (S<b>1</b>), and the output of the LMS filter. By comparing the LMS output to the original data, the considerable improvement in signal-to-noise ratio is clear.</p>
<p id="p-0075" num="0074">In <figref idref="DRAWINGS">FIG. 4</figref>, each chest signal S<b>1</b> <b>83</b>, S<b>2</b>, <b>86</b> and S<b>3</b> <b>89</b> consists of both the ECG and the magnetic gradient induced artifact. One or more separate chest signals are used as the primary signal of the adaptive filtering algorithm after offset removal <b>84</b>, <b>87</b>, <b>90</b> and low pass filtering in software. The noise reference signal <b>82</b> is produced by adding the two signals from the arm (N<b>1</b>+N<b>2</b>), though a third signal (N<b>3</b>) provides greater accuracy. The noise reference signal, in another embodiment, can be obtained from one of the chest ECG signals. The output of the adaptive algorithm <b>85</b>, <b>88</b>, <b>91</b> is then used to calculate detection statistics using GSO <b>92</b>. The detection statistics are used to detect ECG based of one or all three adaptive filter outputs <b>93</b>, and also to calculate the respiration signal <b>94</b>. The detection and respiration statistics are then sent to the output <b>95</b>. The LMS adaptive filter algorithm of <figref idref="DRAWINGS">FIG. 5</figref> and <figref idref="DRAWINGS">FIG. 6</figref> acts upon a given signal <b>103</b> using a known reference noise <b>101</b> to generate a desired noise-free output <b>112</b>. The ECG signal source <b>102</b> is a pair or set of pairs of ECG chest electrodes and the noise source <b>100</b> is a pair or set of pairs of arm electrodes or ECG chest electrodes with relatively weak ECG signals. It is an adaptive filter <b>110</b>, changing with the alterations in the sampled signal to maintain a clean output in a dynamic noise environment. As shown in the details of <figref idref="DRAWINGS">FIG. 5</figref>, the algorithm acts upon the input data <b>103</b> using the sampled reference <b>101</b> and an initial forgetting factor &#x3bc;. Each noise sample <b>104</b>, <b>105</b>, <b>106</b>, <b>136</b> is multiplied by the weight vector <b>107</b>, <b>108</b> and <b>109</b> of length T <b>114</b> (the filter order) and summed to produce the dot product Y(t) <b>111</b>, <b>137</b> where:</p>
<p id="p-0076" num="0075">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>Y</mi>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mi>t</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mover>
        <mi>W</mi>
        <mo>&#x21c0;</mo>
      </mover>
      <mo>&#xb7;</mo>
      <mover>
        <mi>N</mi>
        <mo>&#x21c0;</mo>
      </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
      <munderover>
        <mo>&#x2211;</mo>
        <mrow>
          <mi>j</mi>
          <mo>=</mo>
          <mn>1</mn>
        </mrow>
        <mi>T</mi>
      </munderover>
      <mo>&#x2062;</mo>
      <mrow>
        <msub>
          <mi>W</mi>
          <mi>j</mi>
        </msub>
        <mo>&#xb7;</mo>
        <msub>
          <mi>N</mi>
          <mi>j</mi>
        </msub>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0077" num="0076">The resulting dot product Y is subtracted from the data sample P <b>112</b>, producing an error signal Z <b>113</b>, <b>138</b>, <b>140</b> which is the filtered output data point:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Z</i><sub>i</sub><i>=P</i><sub>i</sub><i>&#x2212;Y</i><sub>i </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
The weight vector is updated <b>110</b>, <b>139</b> by multiplying the data point by the forgetting factor and the noise data point and adding the product to the initial weight:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i><sub>i+1</sub><i>=W</i><sub>i</sub><i>+&#x3bc;Z</i><sub>i</sub><i>{right arrow over (N)}</i><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
The values T and &#x3bc; can be modified to impact the accuracy and complexity of the filter.
</p>
<p id="p-0078" num="0077"><figref idref="DRAWINGS">FIG. 34</figref> shows the primary input <b>2201</b> consisting of the ECG pulse and gradient artifacts <b>2203</b>, <b>2205</b>, <b>2207</b>, and the output of the LMS filter <b>2209</b>, in which ECG is detectable <b>2211</b>. Comparing the LMS output to the original data, there is considerable improvement in the signal-to-noise ratio.</p>
<p id="h-0014" num="0000">Alternative RLS (Non-Lattice) Adaptive Filter Embodiment</p>
<p id="p-0079" num="0078">While any adaptive filtering algorithm <b>85</b>, <b>88</b>, <b>91</b> can be used to remove the noise artifacts from the magnetic gradient ECG signal, alternative embodiments to the LMS to remove either the MDE pulse sequence artifacts or the artifacts from the perfusion pulse sequence may use a lattice implementation <figref idref="DRAWINGS">FIGS. 7 and 8</figref>, or a non-lattice implementation <figref idref="DRAWINGS">FIG. 9</figref> of the Recursive Least Squares (RLS) algorithms.</p>
<p id="h-0015" num="0000">Alternative RLS Lattice Adaptive Filter Embodiment</p>
<p id="p-0080" num="0079">Alternatively the RLS can also be implemented using a lattice structure</p>
<p id="p-0081" num="0080">as diagrammed in <figref idref="DRAWINGS">FIG. 7</figref>. The primary input <b>231</b> goes through a sequence of stages <b>238</b>, <b>240</b>, <b>242</b>. Each stage has two outputs: backward error residual <b>236</b>, <b>243</b>, <b>250</b>, <b>253</b> and forward error residual <b>239</b>, <b>241</b>, <b>244</b>, <b>254</b>, <b>258</b>. The first backward error residual b<sub>1</sub>(n) <b>232</b> is taken from the primary input <b>231</b>. In each stage, a lattice is formed consisting of a unit delay <b>251</b>, reflection coefficients <b>252</b>, <b>255</b> and adders <b>256</b>, <b>257</b>. The backward residual errors <b>232</b>, <b>236</b>, <b>243</b> are multiplied by corresponding gains <b>234</b>, <b>237</b>, <b>245</b>, and subtracted <b>233</b>, <b>235</b>, <b>246</b> from the noise reference <b>230</b>, to form the filter output <b>248</b> and the power estimate <b>247</b>, <b>249</b>. <figref idref="DRAWINGS">FIG. 8</figref> shows the RLS Lattice <b>160</b> flowchart. The sampling rate <b>161</b> is set at 4098. Chest electrode signals are used for primary and arm electrode signals are used for reference <b>162</b>. The value of cc and the filter order M are again chosen to maximize accuracy and minimize processing <b>163</b>. The primary signal is do and the reference signal is xn <b>164</b>. The vectors V, G, B, B<sub>&#x2014;</sub>1, F, &#x3b3;<sup>2</sup>, and &#x3c3;<sup>2 </sup>are initialized to zeros, and vector K is initialized to ones <b>165</b>. For each instant of time n=1, 2, . . . the previous values of B are saved into the vector B<sub>&#x2014;</sub>1 <b>166</b>. The lattice residual forward (F) and backward (B) errors are initialized <b>167</b>:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>B</i>(<i>n</i>)=<i>F</i>(<i>n</i>)=<i>xn </i><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
and updated for each i from 2 to M:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>B</i>(<i>i</i>)=<i>B</i><sub>&#x2014;</sub>1(<i>i&#x2212;</i>1)&#x2212;<i>K</i>(<i>i&#x2212;</i>1)<i>F</i>(<i>i&#x2212;</i>1)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i>(<i>i</i>)=<i>F</i>(<i>i&#x2212;</i>1)&#x2212;<i>K</i>(<i>i&#x2212;</i>1)<i>B</i><sub>&#x2014;</sub>1(<i>i&#x2212;</i>1)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
The filter output vector is initialized as <b>168</b>:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i>(1)=<i>dn&#x2212;G</i>(1)<i>B</i>(1)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
and for each i from 2 to M:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i>(<i>i</i>)=<i>V</i>(<i>i&#x2212;</i>1)&#x2212;<i>G</i>(<i>i</i>)<i>B</i>(<i>i</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Where the actual output for time n is:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>e</i>(<i>n</i>)=<i>V</i>(<i>M</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0082" num="0081">The power estimate is calculated for each i from 1 to M <b>169</b>:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3b3;<sup>2</sup>(<i>i</i>)=(1&#x2212;&#x3b1;)&#x3b3;<sup>2</sup>(<i>i</i>)+<i>aB</i><sup>2</sup>(<i>i</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
and the noise canceller tap gains are calculated for each i from 1 to M <b>170</b>:
</p>
<p id="p-0083" num="0082">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>G</mi>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mi>i</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mi>G</mi>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>(</mo>
        <mi>i</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
      <mfrac>
        <mi>&#x3b1;</mi>
        <mrow>
          <msup>
            <mi>&#x3b3;</mi>
            <mn>2</mn>
          </msup>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mi>i</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mfrac>
      <mo>&#x2062;</mo>
      <mrow>
        <mi>V</mi>
        <mo>&#x2061;</mo>
        <mrow>
          <mo>(</mo>
          <mi>i</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>&#x2062;</mo>
      <mrow>
        <mi>B</mi>
        <mo>&#x2061;</mo>
        <mrow>
          <mo>(</mo>
          <mi>i</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
Then, for each i from 1 to M&#x2212;1 <b>171</b>:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c3;<sup>2</sup>(<i>i</i>)=(1&#x2212;&#x3b1;)&#x3c3;<sup>2</sup>(<i>i</i>)+&#x3b1;(<i>F</i><sup>2</sup>(<i>i</i>)+<i>B</i><sub>&#x2014;</sub>1<sup>2</sup>(<i>i</i>))<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Finally the reflection coefficient is calculated for each i from 1 to M&#x2212;1 <b>172</b>:
</p>
<p id="p-0084" num="0083">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>K</mi>
    <mo>&#x2061;</mo>
    <mrow>
      <mo>(</mo>
      <mi>i</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mi>K</mi>
      <mo>&#x2061;</mo>
      <mrow>
        <mo>(</mo>
        <mi>i</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
      <mfrac>
        <mi>&#x3b1;</mi>
        <mrow>
          <msup>
            <mi>&#x3c3;</mi>
            <mn>2</mn>
          </msup>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mi>i</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mfrac>
      <mo>&#x2062;</mo>
      <mrow>
        <mi>F</mi>
        <mo>&#x2061;</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>i</mi>
            <mo>+</mo>
            <mn>1</mn>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>&#x2062;</mo>
      <mi>B_</mi>
      <mo>&#x2062;</mo>
      <mn>1</mn>
      <mo>&#x2062;</mo>
      <mrow>
        <mo>(</mo>
        <mi>i</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
      <mrow>
        <mi>F</mi>
        <mo>&#x2061;</mo>
        <mrow>
          <mo>(</mo>
          <mi>i</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>&#x2062;</mo>
      <mrow>
        <mi>B</mi>
        <mo>&#x2061;</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>i</mi>
            <mo>+</mo>
            <mn>1</mn>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
The output of the RLS lattice filter is the error e(n) <b>173</b>.
</p>
<p id="p-0085" num="0084">In an alternative adaptive algorithm embodiment, the non-lattice RLS filter algorithm <b>180</b> of <figref idref="DRAWINGS">FIG. 9</figref> acts upon the same signal of the LMS using the same known reference noise <b>182</b> and samples are the data at 4098 samples/second <b>181</b>. The exponential forgetting factor &#x3bb;, filter order M, and initial input covariance value &#x3b4; <b>183</b> are chosen to maximize accuracy and minimize processing. Here, the primary signal is the desired signal d and the reference signal is the input signal u <b>184</b>. The weight vector w is initialized to zeros, the inverse matrix P to an identity matrix of size M/8, and the error vector to d <b>185</b>. For each instant of time n=1, 2, . . . the u(n) is calculated <b>186</b>, and the following are computed <b>187</b>, <b>188</b>, <b>189</b>, <b>190</b>:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>k</i>=(&#x3bb;<sup>&#x2212;1</sup><i>Pu</i>(<i>n</i>))/(1+&#x3bb;<sup>&#x2212;1</sup><i>u</i><sup>H</sup>(<i>n</i>)<i>Pu</i>(<i>n</i>))<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3be;(<i>n</i>)=<i>d</i>(<i>n</i>)&#x2212;<i>&#x175;u</i>(<i>n</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>&#x175;=&#x175;+k</i>&#x3be;*(<i>n</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>P=&#x3bb;</i><sup>&#x2212;1</sup><i>P&#x2212;&#x3bb;</i><sup>&#x2212;1</sup><i>ku</i><sup>H</sup>(<i>n</i>)<i>P </i><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
The output of the filter is the a priori estimation error &#x3be;(n) <b>191</b>.
<br/>
Recursive Least Squares (RLS) Lattice Adaptive MR Artifact Cancellation Methods
</p>
<p id="p-0086" num="0085">One result achieved using the RLS adaptive lattice noise cancellation filter is shown in <figref idref="DRAWINGS">FIG. 35</figref>. The &#x201c;primary&#x201d; input <b>2301</b> to the lattice filter is the ECG <b>2303</b> contaminated with artifacts <b>2305</b> from an MDE MR gradient sequence as shown unprocessed at the top of <figref idref="DRAWINGS">FIG. 35</figref>. Note the small amplitude of the ECG compared to the larger amplitude of the MDE gradient artifact. The output of the adaptive lattice filter is shown in the bottom tracing <b>2307</b> of <figref idref="DRAWINGS">FIG. 35</figref>. This tracing shows that the amplitude of the ECG <b>2309</b> remains virtually unchanged while the gradient artifact noise is markedly reduced, making subsequent R-wave detection possible.</p>
<p id="h-0016" num="0000">GSO ECG Vector Framework Method for Detection</p>
<p id="p-0087" num="0086">Following the effective cancellation of the RF and magnetic gradient artifacts using one of the adaptive noise cancellation methods, the next step in the MRI ECG digital signal processing methods is to construct the Gram-Schmidt Orthogonalization (GSO) vector signal set used for ultimate ECG detection. <figref idref="DRAWINGS">FIG. 10</figref> shows the flowchart of the GSO algorithm <b>200</b>. The GSO ECG vector concept and approach entails transforming a set of ECG thoracic leads (or signals), using the GSO process, into an orthogonal ECG basis set of vectors. The approach does not require critical electrode placement, since the GSO ECG vectors are computed exactly and are not calculated a priori.</p>
<p id="p-0088" num="0087">The algorithm to obtain the GSO &#x201c;optimum vector signal set&#x201d; can be implemented in software using MATLAB. The two or three ECG signals (S<b>1</b>, S<b>2</b> and S<b>3</b>) are collected from the left upper chest in the frontal, sagittal, and coronal planes of the body. These are the X-Z, Z-Y, and X-Y planes of the MR magnet bore, respectively.</p>
<p id="p-0089" num="0088">The ECG data is acquired at a sampling rate of 4098, and the GSO window is 40 ms <b>201</b>. When the ECG data is acquired within the magnet, it is subjected to the MR magnetic gradient artifacts. Therefore, only after the effective cancellation of these artifacts by the adaptive noise cancellation process can the thoracic ECG signals T, T<b>2</b>, and T<b>3</b> <b>202</b> be combined and used to provide an optimum GSO vector for subsequent ECG detection. The GSO vector set completely describes the intrinsic temporal and spatial components of the ECG signal, and provides the R-wave's maximum composite amplitude and maximum slope for optimal detection via the derivative.</p>
<p id="p-0090" num="0089">After having adaptively filtered each chest signal (S<b>1</b>, S<b>2</b>, and S<b>3</b>) separately, the results (T<b>1</b>, T<b>2</b>, and T<b>3</b>) can be combined into a single three-dimensional detection statistic &#x3a6; <b>211</b>, <b>212</b> using the Gram-Schmidt Orthogonalization (GSO) algorithm as shown in <figref idref="DRAWINGS">FIG. 4</figref> item <b>92</b> and <figref idref="DRAWINGS">FIG. 12</figref> item <b>282</b>, and detailed in <figref idref="DRAWINGS">FIG. 10</figref> with the following set of equations initialized at zero <b>203</b>:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>1</sub>(<i>t</i>)=<i>T</i><sub>1</sub>(<i>t</i>)&#x2212;<i>T</i><sub>1av</sub>204,205,210<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>2</sub>(<i>t</i>)=<i>T</i><sub>2</sub>(<i>t</i>)&#x2212;&#x3b1;<sub>21</sub>*&#x3c6;<sub>1</sub>(<i>t</i>)&#x2212;<i>T</i><sub>2av</sub>204,207,210<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c6;<sub>3</sub>(<i>t</i>)=<i>T</i><sub>3</sub>(<i>t</i>)&#x2212;&#x3b1;<sub>31</sub>*&#x3c6;<sub>1</sub>(<i>t</i>)&#x2212;&#x3b1;<sub>32</sub>*(<i>t</i>)&#x2212;<i>T</i><sub>3av</sub>204,210<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x3a6;=&#x221a;{square root over (&#x3c6;<sub>1</sub><sup>2</sup>+&#x3c6;<sub>2</sub><sup>2</sup>+&#x3c6;<sub>3</sub><sup>2</sup>)}212<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0090">&#x3b1;<sub>ij</sub>=&#x3a3;[T<sub>i</sub>(t)&#x2212;T<sub>iav</sub>]*&#x3c6;<sub>j</sub>(t)/&#x3c4;[&#x3c6;<sub>j</sub><sup>2</sup>(t)], and <b>206</b>, <b>208</b>, <b>209</b></li>
        <li id="ul0002-0002" num="0091">T<sub>iav</sub>=the average dc value of T<sub>i</sub>.
<br/>
The filtered three-dimensional ECG detection statistic &#x3a6; <b>213</b> can be processed through an R-wave detection algorithm such as one based on the first derivative.
<br/>
Respiration Determination Method by GSO Vector Coefficients
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0091" num="0092">The GSO vector set represents the intrinsic components of the ECG as a function of time and space. These components change as a function of respiration. From a physiologic point of view, as the diaphragm moves, the lungs and the heart change the direction of the electrocardiogram QRS complex cardiac dipole and the coefficients change. Thus there is an indirect means of monitoring respiration utilizing the ECG without the need for a separate respiratory sensor and its signal conditioning electrical interface.</p>
<p id="p-0092" num="0093">As the heart is rotated by the diaphragm during breathing, it presents a different projection on the body surface, depending on the relative position of the heart within the chest. In addition, the cyclic behavior of these coefficients is also due to the changing thoracic resistivity caused by air in the lungs and the alterations in thoracic geometry and lung vasculature.</p>
<p id="p-0093" num="0094">This approach is utilized to develop an indicator of respiration from the ECG GSO vector coefficients. Two (T<sub>1 </sub>and T<sub>2</sub>) or three (T<sub>1</sub>, T<sub>2</sub>, and T<sub>3</sub>) ECG signal vectors are used, which are collected from the subject's chest using a common reference according to the ECG lead configuration previously described. One subject was instructed to inhale and exhale at five second intervals using a stopwatch to produce a respiration rate of 0.1 Hz. MATLAB was used to compute and plot one of the GSO coefficients.</p>
<p id="p-0094" num="0095"><figref idref="DRAWINGS">FIG. 29</figref> illustrates the cyclic time-variation in this GSO vector coefficient <b>1903</b>. The time varying R-Wave peak amplitudes of the recorded T<sub>1 </sub>ECG signal <b>1901</b> is shown over the course of 120 seconds reflecting the subject's respiratory rate. The GSO algorithm produced a time-varying coefficient which reflects this respiration. This is illustrated in <figref idref="DRAWINGS">FIG. 29</figref> after the time-varying coefficient passing through a bandpass filter at 0.03 and 0.2 Hz. The cyclic variation in this coefficient clearly illustrates the quality of this derived respiration signal.</p>
<p id="h-0017" num="0000">MRI ECG Derivative Detection Methods</p>
<p id="p-0095" num="0096">The derivative detection approach to detect the ECG signal is based on a threshold crossing of the first digital derivative of the ECG R-wave. Two derivative approaches are shown in <figref idref="DRAWINGS">FIG. 11</figref>. They are designate here as &#x201c;FD<b>1</b>&#x201d; <b>220</b> and &#x201c;FD<b>2</b>&#x201d; <b>224</b>. The effectiveness of each derivative approach is evaluated.</p>
<p id="p-0096" num="0097">The first method FD<b>1</b> is given by <b>222</b>:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Y</i>(<i>n</i>)=&#x2212;2<i>X</i>(<i>n&#x2212;</i>2)&#x2212;<i>X</i>(<i>n&#x2212;</i>1)+<i>X</i>(<i>n+</i>1)+2<i>X</i>(<i>n+</i>2),2<i>&#x3c;n&#x3c;N&#x2212;</i>2<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where N is the number of data points, X(n) is the composite GSO vector, and Y(n) is the computed first derivative. The second method FD<b>2</b> is given by <b>226</b>:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Y</i>(<i>n</i>)=<i>X</i>(<i>n+</i>1)&#x2212;<i>X</i>(<i>n&#x2212;</i>1),2<i>&#x3c;n&#x3c;N&#x2212;</i>1<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where N is the number of points, X(n) is the filtered ECG data, and Y(n) is the computed first derivative.
</p>
<p id="p-0097" num="0098">After computing the first derivatives, according to FD<b>1</b> and FD<b>2</b>, the detection of an R-wave is declared each time that the first derivative exceeds a predetermined threshold value <b>221</b> and <b>223</b> for FD<b>1</b> and <b>225</b> and <b>227</b> for FD<b>2</b>. The threshold values can be chosen to yield virtually 100% detection of the R-waves collected from normal subjects.</p>
<p id="h-0018" num="0000">Signal Flow Overview</p>
<p id="p-0098" num="0099"><figref idref="DRAWINGS">FIG. 12</figref> illustrates that there are several combinations of signal processing steps <b>270</b> that can be utilized to provide an optimal detection of ECG signals within MRI gradient artifacts and RF noise.</p>
<p id="p-0099" num="0100">First, one, <b>272</b> two, <b>273</b> or three <b>274</b> ECG signals <b>271</b> can be used to formulate the optimum ECG vector for detection. Similarly, one, two or three noise reference signals can be obtained from the arm. Alternatively, if signals are collected only from the chest, those signals that contain a weak ECG signal can be used for the noise reference signals. In this case, only one ECG signal and one noise reference signal will be collected. Following the data collection, any DC voltage offset will be removed from all inputs <b>275</b> and each input will be passed through a low pass filter <b>276</b>. The next step in the processing is to select a particular adaptive algorithm <b>278</b> to remove gradient artifacts for each particular sequence. The LMS <b>279</b> adaptive algorithm is the simplest algorithm to use for all pulse sequences. Alternative adaptive algorithms to remove the gradient artifact noise include the RLS lattice algorithm <b>280</b> and the RLS non-lattice algorithm <b>281</b>. Following removal of the gradient artifacts by adaptive filtering, the various ECG signals which may include one, two or three signals may be combined into one vector statistic for detection using the GSO <b>282</b> algorithm. The use of this GSO vector processing technique is optional in order to provide for optimal detection. Finally, detection of the ECG is accomplished by the use of one or more derivative detection algorithms <b>283</b>. The two derivative techniques are based on a digital derivative method referred to as FD<b>1</b> <b>284</b> and FD<b>2</b> <b>285</b>. Detection is accomplished by the use of either FD<b>1</b> or FD<b>2</b> or a combination of the two and this completes processing <b>286</b> to provide a trigger signal to initiate the MR magnetic gradient pulse sequence and RF pulses.</p>
<p id="p-0100" num="0101"><figref idref="DRAWINGS">FIG. 17</figref> provides a comprehensive signal flow overview of the entire MRI ECG triggering system. Step One is an ECG Lead Configuration <b>310</b> consisting of up to 3 ECG signals and three noise signals which are acquired to minimize false positive and false negative detections. Step Two is Signal Conditioning and Optical Transmission <b>311</b> which provides for low gain amplification, a magnetohydrodynamic (MHD) artifact filter, a fiber optic LED ECG transmitter, and may also include a solar cell battery eliminator. Step Three is Optical Receiver and Processing <b>312</b> consisting of an LED optical receiver for receiving the ECG signals either through the air or fiber optics, a low pass anti-alias filter and an IR power supply which may also include a battery eliminator. Step Four consists of a Personal Computer with a Real-Time Operating System (RTOS) <b>313</b> which performs the digital signal processing. A Hamming weighted Finite Impulse Response (FIR) low pass digital filter attenuates gradient artifacts in excess of 30 Hz and moderate Gibbs Phenomena processing artifacts. The fast Fourier transform (FFT) approach, which may be too computationally intensive for real-time implementation, is an alternative to the FIR filter. The LMS adaptive noise canceller uses various numbers of weights, one filter structure for each of the x, y, and z gradient artifacts or a single filter structure with a single noise reference as the sum of the gradient artifacts. The RLS is an alternative adaptive noise canceller and has advantages compared with the LMS algorithm, including: faster convergence, greater stability, and fewer filter weights compared with its more complex operations. Step Five consists of the MRI Scanner Interface <b>314</b> which consists of transmitting an electrical signal to cause the MRI scanner to emit a pulse sequence and a display of the ECG signal for the MRI technician.</p>
<p id="p-0101" num="0102">The embedded computer real-time operating system (RTOS) provides the ECG trigger to the scanner in a timely fashion. An overview of the MRI ECG triggering system as a real-time embedded computer system is shown in <figref idref="DRAWINGS">FIG. 30</figref>. The figure provides a block diagram of the hardware and software of the RTOS target computer and host computer development system._The MATLAB software modules that execute the FIR, LMS and RLS adaptive noise cancellation and other signal processing algorithms are optimized for performance. These MATLAB modules are modified and represented in fixed-point arithmetic to assure the most rapid execution of these mathematically intense software modules within a RTOS. These fixed-point algorithms are rewritten from MATLAB code into C/C++-code, as needed, to provide a compatible format for the RTOS compiler. The IDE runs on an x86 multicore PC which serves as the &#x201c;host&#x201d; machine. Finally, the optimized code is downloaded to the target system for execution in real-time and a digital pulse representing the ECG trigger signal is interfaced with the MR scanner to initiate the RF and magnetic gradient pulse sequences. This target system is simply another x86 multicore PC.</p>
<p id="p-0102" num="0103"><figref idref="DRAWINGS">FIG. 31</figref> summarizes the digital signal processing. The first 3&#xbd; seconds of the unprocessed thoracic ECG data S<b>1</b> (a) <b>2001</b> and S<b>2</b> (b) <b>2007</b>, containing the ECG plus 2003, 2009 myocardial delayed enhancement (MDE) MR pulse sequence gradient artifacts <b>2005</b>, <b>2011</b> are shown. Those signals are low-pass filtered at 30 Hz, using the hamming weighted finite impulse response digital filter, and then adaptively filtered using the RLS lattice filter with noise channels (N<b>1</b>+N<b>2</b>) as the noise reference for each of two lattice channels. The respective adaptive lattice outputs are shown in (c) <b>2013</b> and (d) <b>2017</b> with the amplitude of the signal relative to the noise greatly improved due to the digital filtering. The two outputs of the lattice filter are then combined into one ECG signal vector (e) <b>2019</b> using the GSO algorithm, and used as the test statistic for first derivative R-wave detection.</p>
<p id="p-0103" num="0104">The first derivative of the GSO vector is computed using the FD<b>1</b> algorithm, and shown in (f) <b>2025</b>. Also shown are vertical ticks, marking the time at which the ECGs are detected <b>2023</b>, <b>2029</b>, and horizontal flags, marking the amplitude of the corresponding test statistic at the corresponding time of the declared detection <b>2021</b>, <b>2027</b>, <b>2031</b>. All eight ECGs are detected on the rising edge of the R-wave as shown in the magnified ECG at the bottom of the figure (g). For the very limited eight second subset of the data, no false positives, due to the MR gradient noise, or false negatives, from an ECG derivative not reaching the set threshold value occurred.</p>
<p id="h-0019" num="0000">Battery Eliminator</p>
<p id="p-0104" num="0105">In an alternative embodiment, the batteries within the optical transmitter are replaced with a battery eliminator. <figref idref="DRAWINGS">FIG. 16</figref> illustrates the &#x201c;battery eliminator&#x201d; which is fabricated from flexible solar cell material into the shape of a cylinder. The ends of the cylinder are plugged with two hemispheric minors <b>303</b>. A plastic optical fiber <b>301</b> is led through a hole in one minor and cemented in place. The other end of the fiber is optically coupled to a medium power (&#x3c;2 W) laser diode <b>302</b>. All of the light <b>300</b> which is not absorbed by the minors themselves is absorbed by the cylindrical solar cell <b>304</b>. A 2&#x2033;&#xd7;2.5&#x2033; cylinder of a silicon thin film solar cell produces 3.3V with a 70 mA load when illuminated by a 2.2 W, 808 nm laser diode. Power is transmitted from the battery eliminator to the transmitter power rails <b>305</b> via wires.</p>
<p id="p-0105" num="0106">Other simple designs can be used as well. For example, the inside of the transmitter enclosure can be lined with the photocell material and an optical dispersing element couples to the incoming fiber. Finally, the power is transmitted via an optical fiber from a laser diode, as shown in the figure.</p>
<p id="p-0106" num="0107">All of the components required for this power system are inexpensive and readily available. Laser diodes can be used from DVD burners, for example. 4 W laser diodes have dropped in price below the $100 level (Spectra Diode Labs SDL 2300 series). Amplifier chips for the ECG transmitter are available in the 1.8-3V&#x3c;1 mW range (e.g., Texas Instruments OPA379). Virtually all the power draw in the transmitter is due to the LEDs. These LEDs are available with very low threshold current so that total power consumption for a 6 channel transmitter can be kept below 25 mW. Solar cell units can be obtained from numerous vendors and the cost of this aspect of the power transmission is in engineering the light dispersion coupling from the fiber, not the materials themselves. The overall cost of such a power unit is modest considering the lifetime cost of replacement MRI compatible batteries. There are only two or three battery types that can be used in the MRI environment. These batteries are difficult to procure, have a limited shelf-life and cost about $7 apiece.</p>
<p id="h-0020" num="0000">Wireless Infrared (IR) Transmitter</p>
<p id="p-0107" num="0108">In another embodiment, shown in <figref idref="DRAWINGS">FIG. 18</figref>, the wireless ECG amplifier is a straight-forward instrumentation amplifier design consisting of op amps <b>2601</b>A-B and <b>2603</b> and gain setting resistors <b>2605</b>, <b>2607</b> and <b>2609</b> followed by a conventional high pass filter with op amp <b>2601</b>C and RC combinations of <b>2611</b>, <b>2613</b>, <b>2615</b>, <b>2617</b>, <b>2619</b> and low pass filter with op amp <b>2601</b>D and RC combinations of <b>2621</b>, <b>2623</b>, <b>2625</b>, <b>2627</b> and <b>2629</b>. In the circuit shown in <figref idref="DRAWINGS">FIG. 18</figref> resistor <b>2607</b> is used to set the overall gain. Alternatively, the ECG gain may be set by an automatic gain circuit (AGC) to accommodate very low amplitude ECG signals that are frequently seen in patients with heart disease.</p>
<p id="p-0108" num="0109">In one embodiment, the high-pass filter is set in the range of 1 to 5 Hz, primarily to reduce baseline shifts and electrode artifacts. Filter cutoff frequency is variable in hardware using dip-switches to enhance R-wave detection and allow passage of diagnostic quality ECGs. The low-pass filter is set in the range of 35 to 200 Hz, consistent with standard practice for monitoring or diagnostic ECG.</p>
<p id="p-0109" num="0110">In one embodiment, the ECG amplifier output is led to the input of the infrared (IR) transmitter illustrated in <figref idref="DRAWINGS">FIG. 19</figref>, consisting of a voltage-to-frequency (V-F) converter <b>2701</b>, followed by digital logic and IR LED transmitter <b>2731</b> and an on/off indicator LED <b>2729</b>. The V-F converter <b>2701</b> (Burr-Brown VFC121) with supporting components <b>2709</b>, <b>2713</b>, <b>2717</b>, <b>2719</b>, <b>2721</b>, <b>2723</b> converts ECG analog voltages to frequencies, weighted by potentiometers &#x201c;ZERO&#x201d; <b>2711</b> and &#x201c;FULL SCALE&#x201d; <b>2715</b>. These are set so that a 1 volt signal is represented by 100 KHz. The output of the V-F converter <b>2701</b> is shaped by a Schmitt trigger one shot <b>2703</b> (74HCT221), with supporting components <b>2725</b> and <b>2727</b>.</p>
<p id="p-0110" num="0111">The standardized 1 &#x3bc;S pulses produced by the one-shot are led to AND gates <b>2705</b>A-D, solely to increase the current drive for the light emitting diode (LED) switching transistor <b>2707</b> (2N6427). The quad 74AHCT08 <b>2705</b> A-D is connected so that all sections are in parallel, providing the current boost to the transistor. The switching transistor activates the IR LED array <b>2731</b>. This series-parallel configuration is arranged to maximize the transmitter light output. LED array <b>2731</b> is chosen based on the MR imaging site.</p>
<p id="p-0111" num="0112">In this embodiment, the ECG amplifier, filters, and LED transmitter are housed in a cigarette sized container placed directly on the subject's chest, within approximately 6 inches of the heart. The LED array is on the outside of this package to emit pulses in an omni-directional field with sufficient intensity to be detected by the receiving photodiode mounted outside the MRI room. Direct line of sight between transmitter and receiver is not required. IR reflective material may be placed in the magnet room to allow a strong reflected IR beam to be robustly transmitted to the receiver outside the room.</p>
<p id="h-0021" num="0000">Wireless Infrared (IR) Receiver</p>
<p id="p-0112" num="0113"><figref idref="DRAWINGS">FIG. 23</figref> shows the optical receiver used in this alternative embodiment based on an IR photodetector <b>2905</b> and an instrumentation amplifier consisting of op amps <b>2901</b>A-B and <b>2903</b> with discrete components <b>2911</b> and <b>2913</b> in an unconventional configuration. Ordinarily the photodiode <b>2905</b> would be connected as a current source to a single-ended transimpedance amplifier with very high gain. In the novel circuit of the present application a capacitor <b>2907</b> is placed in series with the photodiode <b>2905</b>. The operation of the circuit can be understood easily if one considers the series diode <b>2905</b> and capacitor <b>2907</b> as a &#x201c;gain-setting resistor&#x201d; in an ordinary amplifier. At low frequencies and DC the capacitor <b>2907</b> acts as an open circuit, making the gain unity. At high frequencies the diode-capacitor <b>2905</b>, <b>2907</b> combination acts as a resistor which sets the amplifier gain. The net effect is to allow a high gain for short light pulses and no gain for background or ambient illumination. Thus the receiver can be operated in a brightly lit room or even in direct sunlight.</p>
<p id="p-0113" num="0114">Following an additional gain stage consisting of op amp <b>2901</b>C and gain setting resistors <b>2915</b> and <b>2917</b> photodetector output pulses are led to a Schmitt trigger consisting of 74HC121 <b>3001</b> and timing circuitry <b>3007</b> and <b>3009</b> and one-shot <b>3003</b>. This converts the variable amplitude light pulses to a standard amplitude and duration (4.8V, 1.0 &#x3bc;Sec). In the final stage shown in <figref idref="DRAWINGS">FIG. 24</figref> the variable frequency pulse trains are converted back to an analog voltage which varies precisely as the input signal ECG. This is accomplished by a single chip (VFC320) <b>3003</b>, and support circuitry consisting of RC's <b>3011</b>, <b>3013</b>, <b>3015</b>, <b>3017</b> and <b>3019</b>, which is a voltage-to-frequency (V-F) converter operated in a kind of reverse mode. The converter output is filtered by a multi-pole Bessel low-pass filter, shown as an OPA4277 <b>3005</b>A and discrete RC components <b>3021</b>, <b>3023</b>, <b>3025</b>, <b>3027</b>, <b>3029</b>, with cutoff in the range of 35 to 200 Hz to remove any residual high frequency spiking. At this point the ECG is fully recovered and can be processed and displayed as needed.</p>
<p id="p-0114" num="0115">While the invention has been described with reference to specific embodiments, modifications and variations of the invention may be constructed without departing from the scope of the invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08626266-20140107-M00001.NB">
<img id="EMI-M00001" he="9.14mm" wi="76.20mm" file="US08626266-20140107-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08626266-20140107-M00002.NB">
<img id="EMI-M00002" he="6.35mm" wi="76.20mm" file="US08626266-20140107-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08626266-20140107-M00003.NB">
<img id="EMI-M00003" he="6.01mm" wi="76.20mm" file="US08626266-20140107-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>We claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for triggering a magnetic resonance imaging system, comprising:
<claim-text>capturing a noisy electrical signal, via at least one main lead, including a biologically generated electrical signal that causes movement in a moving body part of a living being, and noise;</claim-text>
<claim-text>capturing, via at least one magnetic resonance noise lead, a noise reference signal indicative of magnetic resonance electromagnetic noise ambient to the at least one main lead;</claim-text>
<claim-text>receiving, by a receiving device, the captured noisy electrical signal and the noise reference signal;</claim-text>
<claim-text>canceling, by a processing device, the noise reference signal from the captured electrical signal to obtain a processed electrical signal indicative of the biologically generated electrical signal that causes movement in the moving body part of the living being using an adaptive canceling noise filter;</claim-text>
<claim-text>detecting, by a processing device, a characteristic of the processed electrical signal indicative of the biologically generated electrical signal that causes movement in the moving body part of the living being to obtain a trigger signal; and</claim-text>
<claim-text>transmitting, by a transmitting device, the trigger signal to cause the magnetic resonance imaging system to capture at least one image including the moving body part of a living being.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the moving body part is at least one of a heart, blood vessel, and cardiovascular system.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the moving body part is a heart of a human subject and the at least one main lead is located on the chest of the human subject.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the moving body part is a heart of a human subject and the at least one magnetic resonance noise lead is located on at least one of an arm or a leg of the human subject.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the at least one main lead and the at least one magnetic resonance noise lead include carbon filament wires without metallic inclusions.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the adaptive canceling noise filter is at least one of: a least mean square filter, a recursive least square filter, and a least square lattice filter.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>identifying, by the processing device, a vector statistic based on the processed electrical signal using a Gram-Schmidt Orthogonalization algorithm, wherein the trigger signal transmitted to the magnetic resonance imaging system is the identified vector statistic.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A system for triggering a magnetic resonance imaging system, comprising:
<claim-text>at least one main lead configured to capture a noisy electrical signal including a biologically generated electrical signal that causes movement in a moving body part of a living being, and noise;</claim-text>
<claim-text>at least one magnetic resonance noise lead configured to capture a noise reference signal indicative of magnetic resonance gradient electromagnetic noise ambient to the at least one main lead;</claim-text>
<claim-text>a receiving device configured to receive the captured noisy electrical signal and the noise reference signal;</claim-text>
<claim-text>a processing device configured to cancel the noise reference signal from the captured noisy electrical signal to obtain a processed electrical signal indicative of the electrical signal that causes movement in the moving body part of the living being using an adaptive canceling noise filter and configured to detect a characteristic of the processed electrical signal to obtain a trigger signal; and</claim-text>
<claim-text>a transmitting device configured to transmit the trigger signal to a magnetic resonance imaging system to cause the magnetic resonance imaging system to capture at least one image including the moving body part of the living body.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The system of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the moving body part of a living being is at least one of a heart, blood vessel, and cardiovascular system.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The system of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the moving body part of a living being is a heart of a human subject and the at least one main lead is adapted to be located on the chest of the human subject.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The system of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the moving body part of a living being is a heart of a human subject and the at least one magnetic resonance noise lead is adapted to be located on at least one of an arm or a leg of the human subject.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The system of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the at least one main lead and the at least one magnetic resonance noise lead include carbon filament wires without metallic inclusions.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The system of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the adaptive canceling noise filter is at least one of: a least mean square filter, a recursive least square filter, and a least square lattice filter.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The system of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein
<claim-text>the processing device is further configured to identify a vector statistic based on the processed electrical signal using a Gram-Schmidt Orthogonalization algorithm, wherein the trigger signal transmitted to the magnetic resonance imaging system is the identified vector statistic.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
