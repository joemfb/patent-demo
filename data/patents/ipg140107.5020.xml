<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08626117-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08626117</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13287059</doc-number>
<date>20111101</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<disclaimer>
<text>This patent is subject to a terminal disclaimer.</text>
</disclaimer>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>M</subclass>
<main-group>11</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20090101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>W</subclass>
<main-group>4</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>455406</main-classification>
<further-classification>705 39</further-classification>
</classification-national>
<invention-title id="d2e51">System and method for providing prepaid billing for instant messaging users</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>7120455</doc-number>
<kind>B1</kind>
<name>Chen et al.</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455466</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2002/0029189</doc-number>
<kind>A1</kind>
<name>Titus et al.</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 39</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2002/0156732</doc-number>
<kind>A1</kind>
<name>Odijk et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2003/0147363</doc-number>
<kind>A1</kind>
<name>Ala-Luukko</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2004/0102182</doc-number>
<kind>A1</kind>
<name>Reith et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2006/0002316</doc-number>
<kind>A1</kind>
<name>Ooki</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2006/0019632</doc-number>
<kind>A1</kind>
<name>Cunningham et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>27</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>455466</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455445</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455405</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455406</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>3791141</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>3791142</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>3</number-of-drawing-sheets>
<number-of-figures>3</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>11510424</doc-number>
<date>20060824</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>8073472</doc-number>
</document-id>
</parent-grant-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13287059</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60711715</doc-number>
<date>20050826</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120046011</doc-number>
<kind>A1</kind>
<date>20120223</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Thakur</last-name>
<first-name>Madhukar Narayan</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Zhuang</last-name>
<first-name>Mingzhe</first-name>
<address>
<city>Redwood City</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Kattan</last-name>
<first-name>Francisco Jose</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Thakur</last-name>
<first-name>Madhukar Narayan</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Zhuang</last-name>
<first-name>Mingzhe</first-name>
<address>
<city>Redwood City</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Kattan</last-name>
<first-name>Francisco Jose</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Sheppard, Mullin, Richter &#x26; Hampton LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Unwired Planet, LLC</orgname>
<role>02</role>
<address>
<city>Reno</city>
<state>NV</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Eng</last-name>
<first-name>George</first-name>
<department>2645</department>
</primary-examiner>
<assistant-examiner>
<last-name>Dean, Jr.</last-name>
<first-name>Joseph</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A system and method for providing prepaid billing for users of an instant messaging system. A method includes determining whether a prepaid account balance associated with an IM client request satisfies a pre-determined criteria, establishing a regular IM session if the prepaid account satisfies the criteria, and establishing a limited IM session if the prepaid account does not satisfy the criteria. The system includes a prepaid account screener operable to determine whether a prepaid account balance satisfies the criteria, establish a regular IM session if the prepaid account satisfies the criteria, and establish a limited IM session if the prepaid account does not satisfy the criteria.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="209.38mm" wi="157.48mm" file="US08626117-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="230.38mm" wi="186.94mm" orientation="landscape" file="US08626117-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="236.05mm" wi="179.83mm" orientation="landscape" file="US08626117-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="238.17mm" wi="166.37mm" file="US08626117-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is a continuation of U.S. application Ser. No. 11/510,424, filed: Aug. 24, 2006 which claims the benefit of the provisional application entitled &#x201c;System and Method for Providing Prepaid Billing for Instant Messaging Users&#x201d;, Application No. 60/711,715, filed Aug. 26, 2005.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention is directed generally to messaging services, and more specifically, to a system and method for providing a prepaid billing function for instant messaging (IM) users.</p>
<p id="p-0004" num="0003">Millions of people around the world use data services over wire line networks, wireless networks, or both. One of the most popular types of such data services is messaging services, for example, instant messaging (IM), short message service (SMS), email, or voicemail. Payment for such messaging services may be made by a monthly fee, purchase of a set amount of network resources (e.g., minutes of use) under a contractual arrangement that commits the purchaser to a certain contract time, or another type of contractual arrangement. However, in addition to traditional subscription plans, some phone carriers offer prepaid plans. Under such a plan, users pay only for the minutes they actually use with no contractual commitment. Thus, in a typical prepaid situation, there are no contracts, call plans, or monthly bills. As the user talks or utilizes a particular messaging service, money is deducted from a prepaid account, the balance of which can be adjusted by purchasing additional credits or minutes from the carrier directly or by purchasing prepaid cards having a specified balance.</p>
<p id="p-0005" num="0004">One operational issue that arises when using prepaid messaging systems and methods is that of notifying a user of a shortage of funds in their prepaid account, and controlling access to such messaging services when a shortage of funds occurs. Some prepaid instant messaging systems use out-of-band conununication methods (i.e., a messaging method different from the one being utilized and that has encountered the shortage of funds), such as Short Message Service (SMS) text messages or the Wireless Application Protocol (WAP)-push function, to notify users when their prepaid account balances do not have enough credit to complete a particular messaging transaction. This generally means that the messaging service being utilized (e.g., IM) is discontinued and additional network resources are used to notify the user of the low account balance problem. In addition, when out of band communication methods are used to inform a user of a shortage of funds, the out of band message must be accessible to the user. This requires the ability to utilize the out of band messaging service (i.e., the out of band service is configured for use on the user's device and that messages from the out of band service are accessible to the user during or at the termination of the messaging service that has a shortage of funds).</p>
<p id="p-0006" num="0005">What is desired is a system and method for notifying users of a prepaid instant messaging service of a shortage of funds in their account and which overcomes the disadvantages of present approaches to the problem.</p>
<heading id="h-0003" level="1">BRIEF SUMMARY OF THE INVENTION</heading>
<p id="p-0007" num="0006">The present invention consists of a system and method for providing a prepaid billing function for an instant messaging (IM) service. An exemplary embodiment includes determining whether a prepaid account associated with an IM client or user request has a minimum balance, establishing a regular IM session if the prepaid account has the minimum balance, and establishing a limited IM session if the prepaid account does not have the minimum balance. In the limited IM session, the user may not appear as active to other uses, but may remain connected long enough to receive a low-balance warning, such as via an IM message. One aspect of the present invention is that it utilizes the same messaging service to provide a low-balance notification as the service being used for the messaging function. This reduces or eliminates important problems associated with using an out of band messaging service to notify the user, because no new network resources are utilized to deliver the notification and reception of the low balance message by the user is assured.</p>
<p id="p-0008" num="0007">In another embodiment of the present invention, a system includes a prepaid account screener operable to receive an IM client request, a prepaid billing system coupled to the prepaid account screener, an IM gateway server coupled to the prepaid account screener, and a prepaid account biller coupled to the IM gateway server, the prepaid billing system, and an IM backend server.</p>
<p id="p-0009" num="0008">It is an object of the present invention to provide a system and method for prepaid billing for instant messaging users or clients. By using a screening system, the invention allows implementation of a prepaid billing feature for instant messaging services. The present invention also allows for providing limited service to users whose prepaid accounts do not have a sufficient balance to cover new transactions.</p>
<p id="p-0010" num="0009">It is a further object of the invention to provide an instant messaging system message to notify users of an insufficient balance, e.g., a request to recharge their account. It is an additional object of the present invention to minimize the impact on the performance and operations of existing instant messaging systems and other messaging systems, and on network resources when delivering the insufficient balance message, while avoiding or minimizing dependency on external backend servers that may be a part of the messaging system.</p>
<p id="p-0011" num="0010">In addition, it is an object of the invention to be capable of utilizing and conforming with an industry standard, if desired, so that communications are consistent with the instant messaging application. The invention further provides a method of handling low balances or credits in prepaid accounts that minimizes the degradation of the user experience and that of others who communicate with the user through the instant messaging service.</p>
<p id="p-0012" num="0011">The foregoing has broadly outlined certain features and technical advantages of the present invention in order that the detailed description of the invention that follows may be better understood. Additional features and advantages of the invention will be described hereinafter which form the subject of the claims of the invention. It should be appreciated by those skilled in the art that the conception and specific embodiment disclosed may be readily utilized as a basis for modifying or designing other structures for carrying out the same purposes of the present invention. It should also be realized by those skilled in the art that such equivalent constructions do not depart from the spirit and scope of the invention as set forth in the appended claims. The innovative features that are believed to be characteristic of the invention, both as to its organization and method of operation, together with further objects and advantages will be better understood from the following description when considered in connection with the accompanying figures. It is to be expressly understood, however, that each of the figures is provided for the purpose of illustration and description only and is not intended as a definition of the limits of the present invention.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0013" num="0012">For a more complete understanding of the present invention, reference is now made to the following descriptions taken in conjunction with the accompanying drawing, in which:</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 1</figref> is a functional block diagram of a system for providing prepaid billing for instant messaging (IM) users according to one embodiment of the present invention;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 2</figref> is a functional block diagram of a prepaid account screener according to one embodiment of the present invention; and</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 3</figref> is a flowchart of a method for providing prepaid billing for IM users according to one embodiment the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 1</figref> is a functional block diagram of a system for providing a prepaid billing function for instant messaging (IM) users <b>100</b> according to an exemplary embodiment of the present invention. Wireless device <b>105</b> is operable to connect to wireless network <b>125</b>. Wireless device <b>105</b> may be a wireless telephone, wireless modem, pager, PDA, computer, or similar device that is capable of being configured to communicate using an instant messaging system. Wireless network <b>130</b> may be, for example, a cellular telephony network complying with the Global System for Mobile communications (GSM), Digital-Advanced Mobile Phone Service (DAMPS), Interim Standard (IS)-136, IS-95, Code Division Multiple Access (CDMA) 2000, Wide-band CDMA (W-CDMA), or Universal Mobile Telecommunications Service (UMTS) standards, or other Personal Communications Services (PCS), Time Division Multiple Access (TDMA) or CDMA wireless network. The term &#x201c;network&#x201d; as used herein refers generally to typical infrastructure and components of a telecommunications network, such as base stations, mobile switching centers, switching and control networks, and any other related gateways, nodes or elements, including Home Location Registers (HLRs), Visitor Location Registers (VLRs), Signaling Control Points, message centers, and the like. Fixed computer <b>110</b> is coupled to Internet <b>130</b>. Laptop <b>115</b> is also coupled to Internet <b>130</b> through, for example, wireless base station <b>120</b>. Base station <b>120</b> may be, for example, a base station complying with the WiFi (IEEE 802.11) standard.</p>
<p id="p-0018" num="0017">Prepaid account screener system <b>200</b> is coupled-to Internet <b>130</b> and wireless network <b>125</b>. In one embodiment, prepaid account screener system <b>200</b> may include an HTTP prepaid account screener, SMS prepaid account screener, or another element capable of functioning in a similar manner. Messaging gateway <b>135</b> (e.g., an IM gateway) is coupled to prepaid account screener system <b>200</b> and may provide, for example, features and functions for a standardized instant messaging system (e.g., &#x201c;Wireless Village,&#x201d; also known as the Open Mobile Alliance (OMA) Instant Messaging and Presence Services (IMPS)). Herein, standardized instant messaging system is meant to refer to a set of standard specifications for facilitating user adoption of instant messaging data services by specifying market driven mobile service enablers that ensure service interoperability across devices, geographies, service providers, operators, and networks. Note that the IM client may be client software constructed in a manner to comply with the a specification developed under such a standardized system, and may execute on a mobile terminal such as cell phone <b>105</b>, or a fixed client, such as fixed computer <b>110</b>. In the case of an IM messaging system, IM gateway <b>135</b> is coupled to an IM backend server <b>145</b> (labeled &#x201c;External IM Community Server&#x201d; in the figure). The IM backend server <b>145</b> may be, for example, an AOLrM server, a Yahoo!&#x2122; server, an ICQ&#x2122; server, an MSN&#x2122; server, or other server that is capable of providing access to IM services.</p>
<p id="p-0019" num="0018">In operation, prepaid account screener system <b>200</b> limits the available IM service for users with a prepaid account that does not contain a sufficient balance or credit to cover a current or new IM transaction (such as a new communication session or continuance of an existing session). In contrast with existing approaches for notifying a user of an insufficient balance, prepaid account screener system <b>200</b> uses the IM system itself to notify the users of the insufficient balance and to request that they recharge their account. In addition, prepaid account screener system <b>200</b> avoids or minimizes the impact and dependency on external backend servers when performing the notification function. In one embodiment, account screener system <b>200</b> may handle prepaid as well as &#x201c;post paid&#x201d; users (i.e., those users who will be billed for messaging services after use of the service). For example, screener system <b>200</b> may detect that a user is of the postpaid variety and inform IM gateway <b>135</b> accordingly. This may be achieved, for example, by sending traffic to a different port of server <b>135</b>, adding an indication to the header of IM traffic packets, or sending traffic to a different IM gateway server (not shown). It will be understood by a person of ordinary skill in the art that system <b>100</b> may utilize the same set of servers for both prepaid and postpaid users. Prepaid account screener system <b>200</b> and its operation are shown in more detail in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 2</figref> is a functional block diagram of prepaid account screener system <b>200</b> according to an exemplary embodiment of the present invention. In operation, IM request <b>205</b>, originating from an external network, such as a cellular system or the Internet, arrives at prepaid account screener module <b>210</b> in prepaid account screener system <b>200</b>. Prepaid account screener module <b>210</b> queries prepaid billing system <b>215</b> and receives a response in order to determine whether the user's account has a sufficient balance or credit to cover the current IM request or transaction. If the prepaid account has a sufficient balance or credit to cover the transaction, livM gateway server <b>225</b> forwards the request to IM backend server <b>230</b> and sends a call data record (CDR) to prepaid account biller <b>220</b>. Prepaid account biller <b>220</b> then debits the prepaid account in prepaid billing system <b>215</b>.</p>
<p id="p-0021" num="0020">If the prepaid account associated with the user does not have a sufficient balance or credit for the requested transaction, a limited IM session may be established in order to send an insufficient balance notification and/or account replenishment message to the user. During the limited IM session, certain features of the messaging system normally accessible to the user may be curtailed or eliminated, e.g., the user may have no access to his buddy list or presence data, or may be unable to send or receive IM messages. In addition, the user may be hidden from the messaging system community, so that other users do not see the low-balance user (or may see the low-balance user as being offline) on their own buddy lists. Further, during the limited J M session, prepaid account screener module <b>210</b> may transmit a modified IM message that serves as a low account balance alert to IM gateway server <b>225</b>. Upon determining or being notified that the user's prepaid account has an insufficient balance or credit, IM gateway server <b>225</b> may automatically reply to the user with an error status code and not forward the client request or other IM message to the external backend server (element <b>145</b> of <figref idref="DRAWINGS">FIG. 1</figref>, or element <b>230</b> of <figref idref="DRAWINGS">FIG. 2</figref>).</p>
<p id="p-0022" num="0021">In addition to replying with an error status, IM gateway server <b>225</b> may send a system message to the client to inform the user of the low account balance and the need to recharge the account. In an alternative embodiment, the system message may include a uniform resource locator (LJRL) or other form of data location identifier that corresponds to a recharge page or site provided by the operator, and through which the low-balance user may replenish his/her account. After sending the system IM message, the IM gateway server <b>225</b> typically will terminate the current session for the user with a low-balance account.</p>
<p id="p-0023" num="0022">It will be understood that the term &#x201c;sufficient balance or credit&#x201d; as used in this disclosure is intended to represent any monetary or dollar amount set by the messaging service provider. In one embodiment, it represents a threshold value that defines a level at or below which messaging services will not be provided. The amount may be a zero balance, a positive balance, or a negative balance. The sufficient balance or credit amount may represent an account balance required before charging for a requested IM service, or an actual or estimated account balance that would exist if the requested IM service were performed and charged to the user's account.</p>
<p id="p-0024" num="0023">If the user recharges the prepaid account to an amount above the sufficient balance or credit amount, the prepaid user may then use the messaging service. Further, in one embodiment, when a low-balance user (i.e., one whose account has an insufficient balance or credit) sends another login request before recharging the account, IM gateway <b>225</b> establishes a new limited messaging session with the client device (e.g., a cell phone, PC, etc.) for the purpose of delivering an insufficient or low-balance message as described above, and then terminates the limited session.</p>
<p id="p-0025" num="0024">Prepaid account biller (i.e., billing module) <b>220</b> may be a program that handles post-processing of CDR records generated by IM gateway server <b>225</b> and posts charges to the accounts for billable records. Because charges may not be applied synchronously during the transactions that form the basis for the charges, a prepaid account's credit balance may not always reflect usage in real-time. As a result of the delay between the time a charge is incurred and the time the charge is posted to the account, some cases may result in &#x201c;overuse,&#x201d; which means that the system may allow a prepaid message or session to occur without recognizing that the actual account balance is, or will become, too low. Therefore, any such delays preferably should be kept to a minimum, so that overuse is limited to a small number of transactions.</p>
<p id="p-0026" num="0025">In one embodiment, the account screener system or module may flag a client request with a special token when a low balance account is detected. For example, in the case where the communication protocol is HTTP based, the screener may insert a special HTTP header to differentiate between regular and low balance modes of operation.</p>
<p id="p-0027" num="0026">In a low-balance-alert state, a client request within a previously established session may be replied to with an error code. However in standard IM protocols there is no specific error code to indicate that an account has an insufficient balance. Therefore the user most likely will not understand the cause of the error, let alone receive further instructions regarding how to recharge the account.</p>
<p id="p-0028" num="0027">It is also generally possible to provide a brief textual error message in the above mentioned error code reply. However, it is up to the client IM application to decide how to render the received error message. Note that some IM clients will simply ignore the error message in the reply.</p>
<p id="p-0029" num="0028">Therefore, it is important that in addition to the error status reply, the IM server sends an IM message to the client to inform the user of the low account balance state. Because the client is an IM application, the user will always receive such an IM message (in contrast to the situation in which the low account balance message is provided by an out of band messaging system). The system IM message should tell the user what happened and how to proceed in order to reactivate or otherwise adjust the account.</p>
<p id="p-0030" num="0029">If a prepaid account reaches a low-balance state during a normal session, IM gateway server <b>225</b> may terminate the session after delivering the system alert. In order to terminate the session, IM gateway server <b>225</b> may send a Logout-Request to external backend server <b>145</b> and also send a server-initiated Disconnect to the client. By terminating the current user's session, new server requests, such as NewMessage or PresenceNotification, may be prevented from placing a burden on the relevant servers or other messaging infrastructure. The Logout-Request to the external community service is queued as a regular outstanding client request. This transaction may be completed when a Disconnect command with matching transaction-ID is returned. If the Disconnect command is not returned within a predetermined time period, the queued request is eventually timed out, as with other client requests. Note that after recharging the account, the prepaid user can re-login to the messaging service.</p>
<p id="p-0031" num="0030">Note that when a messaging client associated with an insufficient account balance user submits a Login-Request, a system message may still be sent back. Normally, if an account's prepaid balance is low, a system would simply deny the login as if the authentication process had failed. However, because the inventive system is designed to use the in-band IM system to deliver a system message to the client, the present invention's approach is to allow the client to login, but only for the purpose of delivering the system message. Once the message is sent, the client is automatically logged out. This may be accomplished as follows. First, IM gateway server <b>225</b> allows the client to establish a new messaging session. Once the user is logged in, IM gateway server <b>225</b> delivers the system message as described above and then disconnects the limited session. Note that this limited session need not involve external community server(s) <b>145</b> and need not authenticate the user. In one embodiment, a low balance, limited session identification (ID) may follow a fixed format, such as:</p>
<p id="p-0032" num="0031">&#x3c;ClientiD Index&#x3e;&#x3c;Prefix&#x3e;&#x3c;SessionCookie&#x3e;&#x3c;UserJD&#x3e;;
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0032">where the &#x3c;prefix&#x3e; field is a configurable text string under the following key:</li>
        <li id="ul0002-0002" num="0033">billing.prepaid.lowbalance.sessionid.prefix=OIMPPLOW.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0033" num="0034">The use of a distinct prefix may differentiate between a normal IM session that is established at external community server(s) <b>145</b> and a local, limited IM session used for delivering a low balance alert or other form of notification. Note that when terminating such a limited session, there is no need to send a Logout-Request to the IM backend server <b>145</b>. Note further that some messaging clients may not process incoming messages before completing ClientCapability and Service transactions. Hence, during the setup of a limited IM session, IM gateway server <b>225</b> may complete such transactions with the client. However, in such a case the ClientCapability-Response and Service-Response should be largely static and kept relatively simple, while still providing sufficient information for the client session to be validated. This is done to permit completion of the transaction while utilizing minimal system resources.</p>
<p id="p-0034" num="0035">In one embodiment, a session is considered a limited IM session if client transactions arrive on a low-balance port. This can occur either in a newly established session or within an existing IM session. Further, during a limited IM session, the types of valid client requests may be limited to, for example, the three login related transactions (Login, ClientCapability, Service) and the Polling-Request and Logout-Request. LogoutRequests receive a locally generated Disconnect command. Polling-Request are discussed in more detail below. In order to conserve system resources, other client requests may be replied to locally with a low-balance error code or other message type as described above.</p>
<p id="p-0035" num="0036">Moreover, in order to make sure that the system message is displayed properly and that the user has a chance to read it, the Disconnect command may be sent after a delay, preferably set by a configuration key, such as, for example:</p>
<p id="p-0036" num="0037">billing.prepaid.lowbalance.disconnect.delayms=60000.</p>
<p id="p-0037" num="0038">During regular transactions, server requests are queued at an external site. However, during a limited IM session, IM gateway server <b>225</b> locally generates and sends requests to the client. This provides the benefit of reducing the burden on the messaging system infrastructure, while providing the desired notification and limited usage characteristics of the invention. This also enables the inventive system to show the low or insufficient balance user as &#x201c;off-line&#x201d; to interested users of the messaging service (e.g., other users on the &#x201c;buddy&#x201d; list). It will be understood that the IM clients may be HTTPbased, SMS, WAP, or utilize another protocol that is compatible with IM messaging methods and systems.</p>
<p id="p-0038" num="0039">In one embodiment, server messages are delivered to clients as a result of a Polling process. Polling is a type of mechanism used in some protocols to enable a client to receive messages. It is typically used in so called &#x201c;asymmetric&#x201d; communication protocols such as HTTP, because the client can send a request to a server any time it wants, but the server can only reply when there is a client request. Therefore in order for the user to receive IM messages in a timely fashion the mobile client &#x201c;polls&#x201d; the server regularly at a certain interval (e.g., every 5 seconds). When the server receives a polling request, the server can deliver IM messages to that client. In the context of the present invention, the server may also deliver the &#x201c;low balance&#x201d; system message as a reply to a polling request.</p>
<p id="p-0039" num="0040">A Polling-Request can arrive at any IM gateway server and is not restricted to the IM gateway server, such as server <b>225</b>, that sent the committed information rate (CIR). When a Polling-Request comes to a server on the low-balance port, the system returns either the system message indicating an insufficient balance or the Disconnect command. In one embodiment, the system keeps some minimum level of state information about each local session in IM gateway server <b>225</b> in order to determine which message to send back. For example, the server should keep information such as if the system message has been delivered and delivery has been confirmed. Only after the delivery of the system message is confirmed can the server proceed to disconnect the client session.</p>
<p id="p-0040" num="0041">For example, according to one possible IM specification (that associated with Wireless Village), a NewMessage primitive requires both RecipientJD and SenderiD to be specified. SenderlD may be obtained from the value specified for the billing.prepaid.lowbalance.sysalert.sender key. However, IM gateway server <b>225</b> may not know the RecipientrD when it attempts to generate the NewMessage primitive to deliver the system message. Thus, in one embodiment, IM gateway server <b>225</b> may store UserID during LoginRequest in the SessionlD, with that information eventually being used as RecipientiD. For example, the new sessioniD may be:</p>
<p id="p-0041" num="0042">Session]D=&#x3c;ClientllIndex&#x3e;&#x3c;Prefix&#x3e;&#x3c;SessionCookie&#x3e;&#x3c;Userl]D&#x3e;;</p>
<p id="p-0042" num="0043">where ClientID Index is required to fetch client specific error code(s) and messages. SessionCookie sends CIR to the client, and UserlD is used to deliver the NewMessage primitive to the client.</p>
<p id="p-0043" num="0044">Moreover, a regular Session ID does not typically store UserID information. Hence, the present invention may be configured to generate a NewMessage primitive including such UserID information when a request with a regular SessionlD is received on a low balance port. For example, a modified regular SessionlD may be:</p>
<p id="p-0044" num="0045">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="189pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>&#x2003;&#x2003;Session]D=&#x3c;Client ID Index&#x3e;&#x3c;Prefix&#x3e;&#x3c;Session</entry>
</row>
<row>
<entry/>
<entry>Cookie&#x3e;&#x3c;UserID&#x3e;&#x3c;Actual SessioniD&#x3e;;</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0045" num="0046">where &#x3c;Actual SessioniD&#x3e; is an external backend server assigned Session ID.</p>
<p id="p-0046" num="0047"><figref idref="DRAWINGS">FIG. 3</figref> is a flowchart of a method for providing prepaid billing for IM users <b>300</b> according to an exemplary embodiment of the present invention. In step <b>305</b>, a client request is received and messaging session <b>310</b> begins. In step <b>315</b>, prepaid account screener module <b>210</b> queries prepaid billing system <b>215</b> and, in step <b>320</b>, determines whether the prepaid account has a sufficient balance. If the account has the minimum balance necessary for completing the request (or satisfies other criteria set by the operator of the system), method <b>300</b> allows access to external backend servers <b>145</b> in step <b>325</b> until the client initiates termination in step <b>330</b> or the prepaid account balance drops below such minimum balance (as determined by steps <b>315</b> and <b>320</b>). In one embodiment, the minimum balance is a predetermined level or dollar amount necessary to establish or maintain a regular IM session. If the method <b>300</b> detects an insufficient balance in step <b>320</b>, a limited IM session <b>335</b> is initiated so that an error message can be sent to the client in step <b>340</b>, followed by a server initiated termination as in step <b>345</b>.</p>
<p id="p-0047" num="0048">Note that although the inventive system and methods have been described with reference to specific components and processes, the inventive system and methods are not limited to those described. The inventive system and methods may, for example, be implemented by other suitable components and/or processes that are capable of being configured to execute or otherwise carry out the desired functions. For example, various of the components described may be implemented as separate functional elements that communicate and otherwise exchange data using an appropriate communications channel, or may be implemented as parts of a larger co-located server.</p>
<p id="p-0048" num="0049">A system and method for providing prepaid instant messaging services has been described. The inventive system provides a low or insufficient balance notification to a user in a manner that increases user recognition of the problem while minimizing the use of network resources. The low or insufficient balance notification is provided within the context of the same messaging system as the one associated with the low or insufficient balance account. This ensures that a user will receive the notification, while minimizing the use of network resources associated with other messaging systems. By implementing the low or insufficient balance detection and notification processes as part of functional elements other than the backend servers, the present invention does not require modifications to those servers or related elements of the messaging system.</p>
<p id="p-0049" num="0050">Although the present invention and its advantages have been described in detail, it should be understood that various changes, substitutions and alterations can be made herein without departing from the spirit and scope of the invention as defined by the appended claims. Moreover, the scope of the present application is not intended to be limited to the particular embodiments of the process, machine, manufacture, composition of matter, means, methods and steps described in the specification. As one of ordinary skill in the art will readily appreciate from the disclosure of the present invention, processes, machines, manufacture, compositions of matter, means, methods, or steps, presently existing or later to be developed that perform substantially the same function or achieve substantially the same result as the corresponding embodiments described herein may be utilized according to the present invention. Accordingly, the appended claims are intended to include within their scope such processes, machines, manufacture, compositions of matter, means, methods, or steps.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>We claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A computer-implemented method of providing prepaid billing services as part of a messaging service, comprising:
<claim-text>at a server system having memory and one or more processors, wherein there is a wireless communication channel between the server system and a mobile device:</claim-text>
<claim-text>determining whether a prepaid account balance associated with the mobile device satisfies one or more pre-determined criteria; establishing a regular messaging service between the server system and the mobile device via the wireless communication channel if the prepaid account balance satisfies the pre-determined criteria, wherein establishing the regular messaging service between the server system and the mobile device comprises enabling exchange of information between the mobile device and an external messaging server coupled to the server system; and</claim-text>
<claim-text>establishing a limited messaging service between the server system and the mobile device via the wireless communication channel if the prepaid account balance does not satisfy the pre-determined criteria, wherein establishing the limited messaging service comprises sending a message containing an error code to the mobile device and blocking exchange of information between the mobile device and the external messaging server after sending the message containing the error code.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the pre-determined criteria include a threshold value, and the pre-determined criteria are satisfied if the prepaid account balance has a value equal to or greater than the threshold value.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>in connection with sending the message containing the error code to the mobile device, sending an account recharge message to the mobile device via the wireless communication channel.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The computer-implemented method of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the account recharge message includes a document link to a site for recharging an account associated with the mobile device.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the determining step is performed in response to a request from the mobile device to start a new instance of the messaging service for the mobile device.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The computer-implemented method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the request includes a user identifier associated with a user of the mobile device.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the determining step is performed while the mobile device is using an existing instance of the messaging service to exchange messages with the external messaging server.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein blocking exchange of information further includes blocking transmission of a buddy list from the external messaging server to the mobile device.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein blocking exchange of information further includes blocking transmission of a message from the mobile device to the external messaging server, wherein the message is directed to another mobile device that is using the messaging service.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein blocking exchange of information further includes blocking transmission of a message from the external messaging server to the mobile device, wherein the message is provided by another mobile device that is using the messaging service.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>after a predefined amount of time from sending the message containing the error code, terminating the limited messaging service with the mobile device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The computer-implemented method of <claim-ref idref="CLM-00011">claim 11</claim-ref>, further comprising:
<claim-text>sending a termination request to the external messaging server, wherein the termination request includes one or more of a user identifier associated with a user of the mobile device and a service identifier associated with a preexisting instance of the messaging service used by the mobile device before the establishment of the limited messaging service.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein establishing the regular messaging service further comprises forwarding a messaging client request to the external messaging server and wherein the message is sent to the mobile device without sending a messaging client request to the external messaging server.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the mobile device is one selected from a group consisting of a wireless telephone, a laptop computer, and a personal digital assistant.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the messaging service is a standard instant messaging service.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A server system, comprising:
<claim-text>one or more processors; and</claim-text>
<claim-text>memory for storing one or more programs, wherein the one or more programs, when executed by the one or more processors, cause the server system to perform one or more instructions including:
<claim-text>instructions for determining whether a prepaid account balance associated with a mobile device satisfies one or more pre-determined criteria, wherein there is a wireless communication channel between the server system and the mobile device;</claim-text>
<claim-text>instructions for establishing a regular messaging service between the server system and the mobile device via the wireless communication channel if the prepaid account balance satisfies the pre-determined criteria, wherein the instructions for establishing the regular messaging service comprise instructions for enabling exchange of information between the mobile device and an external messaging server coupled to the server system; and</claim-text>
<claim-text>instructions for establishing a limited messaging service between the server system and the mobile device via the wireless communication channel if the prepaid account balance does not satisfy the pre-determined criteria, wherein the instruction for establishing the limited messaging service comprise instructions for sending a message containing an error code to the mobile device and blocking exchange of information between the mobile device and the external messaging server after sending the message containing the error code.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The server system of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the one or more instructions further comprise:
<claim-text>instructions for, in connection with sending the message containing the error code to the mobile device, sending an account recharge message to the mobile device via the wireless communication channel.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The server system of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the determining instructions are performed in response to a request from the mobile device to start a new instance of the messaging service for the mobile device.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The server system of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the determining instructions are performed while the mobile device is using an existing instance of the messaging service to exchange messages with the external messaging server.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The server system of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the one or more instructions further comprise:
<claim-text>instructions for, after a predefined amount of time from sending the message containing the error code, terminating the limited messaging service with the mobile device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The server system of <claim-ref idref="CLM-00020">claim 20</claim-ref>, wherein the one or more instructions further comprise:
<claim-text>instructions for sending a termination request to the external messaging server, wherein the termination request includes one or more of a user identifier associated with a user of the mobile device and a service identifier associated with a preexisting instance of the messaging service used by the mobile device before the establishment of the limited messaging service.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. A non-transitory computer readable medium having stored therein a computer program product, the computer program product comprising one or more instructions executable by a server system, one or more instructions including:
<claim-text>instructions for determining whether a prepaid account balance associated with a mobile device satisfies one or more pre-determined criteria, wherein there is a wireless communication channel between the server system and the mobile device;</claim-text>
<claim-text>instructions for establishing a regular messaging service between the server system and the mobile device via the wireless communication channel if the prepaid account balance satisfies the pre-determined criteria, wherein the instructions for establishing the regular messaging service comprise instructions for enabling exchange of information between the mobile device and an external messaging server coupled to the server system; and</claim-text>
<claim-text>instructions for establishing a limited messaging service between the server system and the mobile device via the wireless communication channel if the prepaid account balance does not satisfy the pre-determined criteria, wherein the instructions for establishing the limited messaging service comprise instructions for sending a message containing an error code to the mobile device and blocking exchange of information between the mobile device and the external messaging server after sending the message containing the error code. wherein sending a logout request to the external backend server, after the error code message and blocking exchange of information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The non-transitory computer readable medium of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the one or more instructions further comprise:
<claim-text>instructions for, in connection with sending the message containing the error code to the mobile device, sending an account recharge message to the mobile device via the wireless communication channel.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The non-transitory computer readable medium of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the instructions for determining whether the prepaid account balance associated with the mobile device satisfies the one or more pre-determined criteria further comprise instructions performed in response to a request from the mobile device to start a new instance of the messaging service for the mobile device.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The non-transitory computer readable medium of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the instructions for determining whether the prepaid account balance associated with the mobile device satisfies the one or more pre-determined criteria further comprise instructions performed while the mobile device is using an existing instance of the messaging service to exchange messages with the external messaging server.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The non-transitory computer readable medium of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the one or more instructions further comprise:
<claim-text>instructions for, after a predefined amount of time from sending the message containing the error code, terminating the limited messaging service with the mobile device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The non-transitory computer readable medium of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the one or more instructions further comprise:
<claim-text>instructions for sending a termination request to the external messaging server, wherein the termination request includes one or more of a user identifier associated with a user of the mobile device and a service identifier associated with a preexisting instance of the messaging service used by the mobile device before the establishment of the limited messaging service.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
