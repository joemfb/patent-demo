<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08626681-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08626681</doc-number>
<kind>B1</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12984484</doc-number>
<date>20110104</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>261</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>18</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classifications-cpc>
<main-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>18</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
</main-cpc>
</classifications-cpc>
<classification-national>
<country>US</country>
<main-classification>706 12</main-classification>
</classification-national>
<invention-title id="d2e53">Training a probabilistic spelling checker from structured data</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5848373</doc-number>
<kind>A</kind>
<name>DeLorme et al.</name>
<date>19981200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>701455</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5883986</doc-number>
<kind>A</kind>
<name>Kopec et al.</name>
<date>19990300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382310</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5907821</doc-number>
<kind>A</kind>
<name>Kaji et al.</name>
<date>19990500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6184823</doc-number>
<kind>B1</kind>
<name>Smith et al.</name>
<date>20010200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>34235731</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6292771</doc-number>
<kind>B1</kind>
<name>Haug et al.</name>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704  9</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7076505</doc-number>
<kind>B2</kind>
<name>Campbell</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>701438</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7082443</doc-number>
<kind>B1</kind>
<name>Ashby</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>34235741</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>7092926</doc-number>
<kind>B2</kind>
<name>Cerrato</name>
<date>20060800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>706 48</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>7096117</doc-number>
<kind>B1</kind>
<name>Gale et al.</name>
<date>20060800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>701532</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>7197500</doc-number>
<kind>B1</kind>
<name>Israni et al.</name>
<date>20070300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707809</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>7340460</doc-number>
<kind>B1</kind>
<name>Kapur et al.</name>
<date>20080300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>7392278</doc-number>
<kind>B2</kind>
<name>Chen et al.</name>
<date>20080600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>  1  1</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>7428533</doc-number>
<kind>B2</kind>
<name>Kapur et al.</name>
<date>20080900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>  1  1</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>7593904</doc-number>
<kind>B1</kind>
<name>Kirshenbaum et al.</name>
<date>20090900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>706 12</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>7599988</doc-number>
<kind>B2</kind>
<name>Frank</name>
<date>20091000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709203</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>7620628</doc-number>
<kind>B2</kind>
<name>Kapur et al.</name>
<date>20091100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>  1  1</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>8086591</doc-number>
<kind>B2</kind>
<name>Scott et al.</name>
<date>20111200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707708</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>8195653</doc-number>
<kind>B2</kind>
<name>Dandekar et al.</name>
<date>20120600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707724</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>8201078</doc-number>
<kind>B2</kind>
<name>Boyer et al.</name>
<date>20120600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715221</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2003/0163375</doc-number>
<kind>A1</kind>
<name>Dombrowski et al.</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 14</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>2003/0217052</doc-number>
<kind>A1</kind>
<name>Rubenczyk et al.</name>
<date>20031100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>2004/0008225</doc-number>
<kind>A1</kind>
<name>Campbell</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345764</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2004/0078750</doc-number>
<kind>A1</kind>
<name>Frank</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715500</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>2004/0141354</doc-number>
<kind>A1</kind>
<name>Carnahan</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>2004/0249637</doc-number>
<kind>A1</kind>
<name>Baker</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704239</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>2004/0267718</doc-number>
<kind>A1</kind>
<name>Milligan et al.</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>2005/0066050</doc-number>
<kind>A1</kind>
<name>Dharamshi</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709232</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>2005/0182647</doc-number>
<kind>A1</kind>
<name>Saenz et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705  1</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00029">
<document-id>
<country>US</country>
<doc-number>2005/0278378</doc-number>
<kind>A1</kind>
<name>Frank</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>7071041</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00030">
<document-id>
<country>US</country>
<doc-number>2006/0122979</doc-number>
<kind>A1</kind>
<name>Kapur et al.</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  3</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00031">
<document-id>
<country>US</country>
<doc-number>2007/0067157</doc-number>
<kind>A1</kind>
<name>Kaku et al.</name>
<date>20070300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00032">
<document-id>
<country>US</country>
<doc-number>2008/0010262</doc-number>
<kind>A1</kind>
<name>Frank</name>
<date>20080100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  3</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00033">
<document-id>
<country>US</country>
<doc-number>2008/0027985</doc-number>
<kind>A1</kind>
<name>Kasperkiewicz et al.</name>
<date>20080100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00034">
<document-id>
<country>US</country>
<doc-number>2008/0243838</doc-number>
<kind>A1</kind>
<name>Scott et al.</name>
<date>20081000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  5</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00035">
<document-id>
<country>US</country>
<doc-number>2008/0288314</doc-number>
<kind>A1</kind>
<name>Dombrowski et al.</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705  7</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00036">
<document-id>
<country>US</country>
<doc-number>2008/0288338</doc-number>
<kind>A1</kind>
<name>Wiseman et al.</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 14</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00037">
<document-id>
<country>US</country>
<doc-number>2009/0089261</doc-number>
<kind>A1</kind>
<name>Leher et al.</name>
<date>20090400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  3</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00038">
<document-id>
<country>US</country>
<doc-number>2009/0164428</doc-number>
<kind>A1</kind>
<name>Green et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  3</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00039">
<document-id>
<country>US</country>
<doc-number>2009/0254512</doc-number>
<kind>A1</kind>
<name>Broder et al.</name>
<date>20091000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  2</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00040">
<document-id>
<country>US</country>
<doc-number>2009/0281792</doc-number>
<kind>A1</kind>
<name>Green et al.</name>
<date>20091100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704  9</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00041">
<document-id>
<country>US</country>
<doc-number>2010/0151816</doc-number>
<kind>A1</kind>
<name>Besehanic et al.</name>
<date>20100600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455405</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00042">
<document-id>
<country>US</country>
<doc-number>2010/0169026</doc-number>
<kind>A1</kind>
<name>Sorenson et al.</name>
<date>20100700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>702 20</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00043">
<document-id>
<country>US</country>
<doc-number>2010/0174703</doc-number>
<kind>A1</kind>
<name>Dandekar et al.</name>
<date>20100700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707722</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00044">
<document-id>
<country>US</country>
<doc-number>2010/0306249</doc-number>
<kind>A1</kind>
<name>Hill et al.</name>
<date>20101200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707769</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00045">
<document-id>
<country>US</country>
<doc-number>2011/0040695</doc-number>
<kind>A1</kind>
<name>Wasicek et al.</name>
<date>20110200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705320</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00046">
<document-id>
<country>US</country>
<doc-number>2011/0055041</doc-number>
<kind>A1</kind>
<name>Shaw et al.</name>
<date>20110300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 263</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00047">
<document-id>
<country>US</country>
<doc-number>2011/0093467</doc-number>
<kind>A1</kind>
<name>Sharp et al.</name>
<date>20110400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707741</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00048">
<document-id>
<country>US</country>
<doc-number>2011/0270820</doc-number>
<kind>A1</kind>
<name>Agarwal</name>
<date>20111100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707709</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00049">
<document-id>
<country>US</country>
<doc-number>2011/0296237</doc-number>
<kind>A1</kind>
<name>Mandagere et al.</name>
<date>20111200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714 15</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00050">
<document-id>
<country>US</country>
<doc-number>2012/0016663</doc-number>
<kind>A1</kind>
<name>Gillam et al.</name>
<date>20120100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704  9</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00051">
<document-id>
<country>US</country>
<doc-number>2013/0007256</doc-number>
<kind>A1</kind>
<name>Prieditis</name>
<date>20130100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709224</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00052">
<document-id>
<country>US</country>
<doc-number>2013/0031033</doc-number>
<kind>A1</kind>
<name>Prieditis</name>
<date>20130100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>706 12</main-classification></classification-national>
</us-citation>
<us-citation>
<nplcit num="00053">
<othercit>Cui et al, &#x201c;Probabilitstic Query Expansion Using Query Logs,&#x201d; WWW 2002, May 7-11, 2002, Honolulu, Hawaii, USA.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00054">
<othercit>Qingqing Gan, et al, &#x201c;Analysis of Geographic Queries in a Search Engine Log,&#x201d; LocWeb 2008, Apr. 22, 2008 Beijing, China.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00055">
<othercit>Hang Cui, et al, &#x201c;Probabilitic Query Expension Using Query Logs,&#x201d; WWW 2002, May 7-11, 2002, Honolulu, Hawaii, USA.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
</us-references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>4</number-of-drawing-sheets>
<number-of-figures>4</number-of-figures>
</figures>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Jurca</last-name>
<first-name>Radu</first-name>
<address>
<city>Adliswil</city>
<country>CH</country>
</address>
</addressbook>
<residence>
<country>CH</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Fleury</last-name>
<first-name>Pascal</first-name>
<address>
<city>Zurich</city>
<country>CH</country>
</address>
</addressbook>
<residence>
<country>CH</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Murphy</last-name>
<first-name>Bruce Winston</first-name>
<address>
<city>Bern</city>
<country>CH</country>
</address>
</addressbook>
<residence>
<country>CH</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Jurca</last-name>
<first-name>Radu</first-name>
<address>
<city>Adliswil</city>
<country>CH</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Fleury</last-name>
<first-name>Pascal</first-name>
<address>
<city>Zurich</city>
<country>CH</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Murphy</last-name>
<first-name>Bruce Winston</first-name>
<address>
<city>Bern</city>
<country>CH</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Fenwick &#x26; West LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Google Inc.</orgname>
<role>02</role>
<address>
<city>Mountain View</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Chaki</last-name>
<first-name>Kakali</first-name>
<department>2122</department>
</primary-examiner>
<assistant-examiner>
<last-name>Wu</last-name>
<first-name>Fuming</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A spelling system derives a language model for a particular domain of structured data, the language model enabling determinations of alternative spellings of queries or other strings of text from that domain. More specifically, the spelling system calculates (a) probabilities that the various query entity types&#x2014;such as STREET, CITY, or STATE for queries in the geographical domain&#x2014;are arranged in each of the various possible orders, and (b) probabilities that an arbitrary query references given particular ones of the entities, such as the street &#x201c;El Camino Real.&#x201d; Based on the calculated probabilities, the spelling system generates a language model that has associated scores (e.g., probabilities) for each of a set of probable entity name orderings, where the total number of entity name orderings is substantially less than the number of all possible orderings. The language model can be applied to determine probabilities of arbitrary queries, and thus to suggest alternative queries more likely to represent what a user intended.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="123.27mm" wi="174.16mm" file="US08626681-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="188.55mm" wi="159.34mm" file="US08626681-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="179.15mm" wi="207.09mm" file="US08626681-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="163.07mm" wi="185.42mm" file="US08626681-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="153.67mm" wi="175.68mm" file="US08626681-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND</heading>
<p id="p-0002" num="0001">1. Field of Art</p>
<p id="p-0003" num="0002">The present invention generally relates to the field of data processing, and more specifically, to methods of training spelling checkers for use in a domain having structured corpora of data, such as geographic name data.</p>
<p id="p-0004" num="0003">2. Background of the Invention</p>
<p id="p-0005" num="0004">Users of computer systems often input misspelled data. For example, in the domain of geographic entity names, users frequently enter misspelled queries for locations, such as a query for map data associated with the city of &#x201c;New Yrk&#x201d; or of &#x201c;Amstedam, the Netherlands.&#x201d;</p>
<p id="p-0006" num="0005">Some conventional spelling checkers for use in other data domains store all combinations of validly-spelled words along with the associated probabilities that the various combinations are what the user intended. The set of combinations is deemed a language model providing a representation of the permissible combinations of words in the relevant data domain. Although such an approach is feasible in certain domains such as those of natural languages, where the number of valid word combinations is constrained by comparatively restrictive grammatical rules governing word ordering, it is not practically possible in other domains.</p>
<p id="p-0007" num="0006">For example, in the domain of geographic entity names, there is a very large vocabulary of possible names, such as tens of thousands of distinct cities (e.g., &#x201c;New York&#x201d; or &#x201c;Paris&#x201d;), streets (e.g., &#x201c;Main Street&#x201d;), and landmarks (e.g., &#x201c;Eiffel Tower&#x201d;), hundreds of countries (e.g., &#x201c;United States&#x201d; or &#x201c;France&#x201d;), and so on. A geographic query can contain any number of the different types (e.g., street, city, or country), and the types can be arranged in different orders based on the different language conventions of the possible users (e.g., &#x201c;STREET, CITY, STATE&#x201d; in American English, and &#x201c;CITY, DISTRICT, STREET in Russian). Additionally, the different geographic entities of a geographic query can have multiple names, such as various abbreviations (e.g., &#x201c;U.S.&#x201d;, as well as &#x201c;United States&#x201d;), and/or various spellings in different languages (e.g., &#x201c;Etats Unis&#x201d; in French and &#x201c;United States&#x201d; in English). Similarly, a translation of a geographic name in one language (e.g., Chinese) can have multiple equally valid spellings in another language (e.g., English) and thus an entire set of associated misspellings. Thus, conventional techniques cannot create useful language models for domains such as that of geographic entity names, where the number of valid word combinations is extremely large.</p>
<heading id="h-0002" level="1">SUMMARY</heading>
<p id="p-0008" num="0007">A computer implemented, automated spelling system derives a language model for a particular domain of structured data, the language model enabling determinations of alternative spellings of queries or other strings of text from that domain. In various embodiments, the spelling system calculates (a) probabilities that the various query entity types&#x2014;e.g., STREET, CITY, or STATE for queries in the geographical domain&#x2014;are arranged in each of the various possible orders, and (b) probabilities that an arbitrary query references given particular ones of the entities, such as the street &#x201c;El Camino Real.&#x201d; Based on the calculated probabilities, the spelling system generates a language model that has associated scores (e.g., probabilities) for each of a set of probable entity name orderings, where the total number of entity name orderings is substantially less than the number of all possible orderings. The spelling system has application in any domain where the number of valid word combinations is extremely large.</p>
<p id="p-0009" num="0008">For example, in one embodiment specific to the domain of geographic entity names, the spelling system calculates (a) a template distribution comprising probabilities of occurrence in an arbitrary query for the various possible orderings of geographic entity types (e.g., &#x3c;ADDRESS, CITY, STATE&#x3e; and &#x3c;ADDRESS, CITY, ZIPCODE&#x3e;), and (b) a location distribution comprising probabilities that an arbitrary query refers to the regions corresponding to the various geographic entities in a domain database (e.g., the probabilities that a query refers to the specific city &#x201c;New York&#x201d; in New York State, or to the street California Street in Mountain View, Calif.). Based on the probabilities within the template distribution and the geographic distribution, the spelling system generates a language model that stores a set of pairs of geographic entities and an associated probability score for each.</p>
<p id="p-0010" num="0009">In one embodiment, the spelling system further computes conditional probabilities of different entity name combinations based on the different pairs of entities in the language model and their associated probability scores. The spelling system can then use the computed conditional probabilities to generate, for a given user query, alternative queries that the user is more likely to have intended. For example, the spelling system might compute the conditional probability that the word &#x201c;York&#x201d; will occur, given that the word &#x201c;New&#x201d; has already occurred in a geographic query, and later use this conditional probability when determining alternative geographic queries.</p>
<p id="p-0011" num="0010">The features and advantages described in the specification are not all inclusive and, in particular, many additional features and advantages will be apparent to one of ordinary skill in the art in view of the drawings, specification, and claims. Moreover, it should be noted that the language used in the specification has been principally selected for readability and instructional purposes, and may not have been selected to delineate or circumscribe the inventive subject matter.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of a geographic information and mapping system in which alternative spelling analysis can be performed.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a sample set of entities and their relationships to each other in the domain of geographic locations.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram illustrating the components of an alternative spelling module.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 4</figref> is a data flow diagram representing the relationships and derivations of the various types of data analyzed and/or produced by the alternative spelling module.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0016" num="0015">The figures depict various embodiments of the present invention for purposes of illustration only. One skilled in the art will readily recognize from the following description that other alternative embodiments of the structures and methods illustrated herein may be employed without departing from the principles of the invention described herein.</p>
<heading id="h-0004" level="1">DETAILED DESCRIPTION</heading>
<p id="h-0005" num="0000">System Architecture</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of a system in which alternative spelling analysis can be performed, according to one embodiment. The alternative spelling analysis provided by various embodiments can be performed for structured data&#x2014;i.e., data that has well-defined semantics&#x2014;in many different domains. However, for purposes of example, <figref idref="DRAWINGS">FIG. 1</figref> sets forth a specific example in the domain of geographical data employed by a geographic information and mapping system. A map service <b>100</b> represents a system such as that of GOOGLE MAPS that stores and provides map data to clients such as the client devices <b>150</b> over a network <b>140</b>.</p>
<p id="p-0018" num="0017">Client devices <b>150</b> are computing devices that execute client software, e.g., a web browser or built-in client application, to connect to the map server <b>113</b> of the map service <b>100</b> via a network <b>140</b> and to display map data. The client device <b>150</b> might be, for example, a personal computer, a personal digital assistant, a cellular, mobile, or smart phone, or a laptop computer.</p>
<p id="p-0019" num="0018">The network <b>140</b> represents the communication pathways between the client devices <b>150</b> and the map service <b>100</b>. In one embodiment, the network <b>140</b> uses standard Internet communications technologies and/or protocols. Thus, the network <b>140</b> can include links using technologies such as Ethernet, IEEE 802.11, IEEE 806.16, WiMAX, 3GPP LTE, integrated services digital network (ISDN), asynchronous transfer mode (ATM), etc. Similarly, the networking protocols used on the network <b>140</b> can include the transmission control protocol/Internet protocol (TCP/IP), the hypertext transport protocol (HTTP), the simple mail transfer protocol (SMTP), the file transfer protocol (FTP), etc. The data exchanged over the network <b>140</b> can be represented using technologies and/or formats including the hypertext markup language (HTML), the extensible markup language (XML), etc. In addition, all or some links can be encrypted using conventional encryption technologies such as the secure sockets layer (SSL), Secure HTTP (HTTPS) and/or virtual private networks (VPNs). In another embodiment, the entities can use custom and/or dedicated data communications technologies instead of, or in addition to, the ones described above.</p>
<p id="p-0020" num="0019">The map service <b>100</b> includes a geographic database <b>111</b> that stores data for the geographic domain, such as map entities like countries, cities, streets, and the like. Entities are described in further detail below.</p>
<p id="p-0021" num="0020">The map service <b>100</b> further includes a map server that receives geographic queries from the clients <b>150</b> and in response provides appropriate data from the geographic database, and a query log <b>112</b> storing prior user queries received by the map server. A geographic query can be in form of an entity name (e.g., &#x201c;Eiffel Tower&#x201d; or &#x201c;Los Angeles&#x201d;), a complete or partial address (e.g., &#x201c;1600 Pennsylvania Avenue&#x201d;), or a free text (e.g., &#x201c;lake near Chicago&#x201d;), or other queries for which the relevant information is geographic in nature.</p>
<p id="p-0022" num="0021">The map service <b>100</b> additionally includes an alternative spelling module <b>114</b> that analyzes the data in the geographic database <b>111</b> and the query log <b>112</b> and generates a geographic model that can be used, for example, to suggest alternative spellings of queries, e.g., where the user entered a query containing a misspelled name. In another embodiment, the alternative spelling module is not part of the map service <b>100</b> itself, but instead is located remotely from the map service <b>100</b> and accesses data such as the geographic database <b>111</b> and/or the query log <b>112</b> via the network <b>140</b>.</p>
<p id="p-0023" num="0022">More specifically, the geographic database <b>111</b> stores data on geographic entities <b>111</b>A such as streets, cities, states, and countries, along with geographic features, such as bodies of water, parks, mountains, forests, deserts, and so forth, as well as storing their relationships to each other. <figref idref="DRAWINGS">FIG. 2</figref> illustrates a sample set of entities and their relationships, according to one embodiment. Specifically, <figref idref="DRAWINGS">FIG. 2</figref> depicts a number of nodes in an entity graph, each node corresponding to a particular geographic entity. For example, nodes <b>201</b>A and <b>201</b>B represent the continents of North America and Europe, respectively; node <b>202</b> represents the United States (a country); node <b>203</b>A represents the state of California; node <b>204</b>A represents Mountain View (a city in California); and node <b>205</b>A represents the street Castro Street (a street in Mountain View). In practice, the entity graph would be very densely populated, for example with thousands of cities, and millions of entities such as streets and geographic features.</p>
<p id="p-0024" num="0023">Each geographic entity represents a particular region of the world, such as a large region like a continent or country, or a smaller region such as a particular street, or a geographical feature. Each geographic entity may have associated data demarcating the region that the entity represents, such a set of 1 km square cells or other regular shapes located partially or entirely within the region, or a set of coordinates defining a boundary of the entity.</p>
<p id="p-0025" num="0024">Each entity is associated with one or more entity names. The entity name can be its official name such as &#x201c;New York City&#x201d;, as well as shortened versions thereof, such as &#x201c;New York&#x201d; as well as other informal names, such as &#x201c;Big Apple.&#x201d; Referring again to <figref idref="DRAWINGS">FIG. 2</figref>, the entity names include &#x201c;Mountain View&#x201d; for the city entity <b>204</b>A, or &#x201c;California&#x201d; for the state entity <b>203</b>A, and the names may include one or more abbreviations (e.g., &#x201c;CA&#x201d; and &#x201c;Calif.&#x201d;, as well as &#x201c;California&#x201d;) and/or multiple language variants (e.g., the French &#x201c;Californie&#x201d; and the German &#x201c;Kaliformien&#x201d;, as well as the English &#x201c;California&#x201d;). The names of one entity may be the same as the names of other entities, such as the abbreviation &#x201c;CA&#x201d; for both state <b>203</b>A and country <b>202</b>B.</p>
<p id="p-0026" num="0025">Additionally, each geographic entity <b>111</b>A may have a corresponding type, such as STATE for the entity <b>203</b>A, CITY for the entity <b>204</b>A, or the like. The types may be ordered and assigned ranks based on their levels of specificity or typical geographic scope, such as 5 for STREET (most specific, lowest typical geographic scope), 4 for CITY, 3 for STATE, 2 for COUNTRY, and 1 for CONTINENT.</p>
<p id="p-0027" num="0026">The geographic entities are connected by edges representing relationships such as containment (i.e., one entity being wholly contained within another, such as the city <b>204</b>A being directly contained within the state <b>203</b>A and indirectly contained within the country <b>202</b>A and continent <b>201</b>A), or overlap (i.e., one entity being partially contained within another, such as the street <b>205</b>B being partially located within the city <b>204</b>A and partially within other cities, such as the city <b>204</b>B). The graph formed by the entities and their relationship edges may contain cycles due to the presence of both containment and overlap relationships, such as the cycle formed by nodes <b>203</b>A, <b>204</b>A, <b>204</b>B, and <b>205</b>B. The &#x201c;neighbors&#x201d; of an entity in the graph are said to be the entities whose corresponding nodes are reachable via a single link. For example, the neighbors of the street <b>205</b>B are the entities <b>204</b>A and <b>204</b>B that it overlaps, as well as the state <b>203</b>A, country <b>202</b>A, and continent <b>201</b>A, that indirectly contain it. (In order to avoid excessive visual clutter, indirect containment links, such as those between street <b>205</b>B and state <b>203</b>A or country <b>202</b>A, are generally not depicted in <figref idref="DRAWINGS">FIG. 2</figref>. Indirect containment links between city <b>204</b>C and country <b>202</b>A and continent <b>201</b>A are depicted for purposes of illustration.)</p>
<p id="p-0028" num="0027">The data in the geographic database <b>111</b> may be created from a variety of sources, such as feeds from various governmental or private geographic databases, or manual creation and/or editing by employees of the organization responsible for the map service <b>100</b> or by users of the client devices <b>150</b>.</p>
<p id="p-0029" num="0028">Referring again to <figref idref="DRAWINGS">FIG. 1</figref>, the query log <b>112</b> stores prior user queries received by the map server <b>113</b>. A valid query includes an ordered set of names of the entities <b>111</b>A from the geographic database, and may additionally include punctuation and names not in the geographic database. For example, the query &#x201c;Castro Street, Mountain View, Calif.&#x201d; comprises a name of the street entity <b>205</b>A from <figref idref="DRAWINGS">FIG. 2</figref>, followed by a name of the city entity <b>204</b>A, followed by a name of the state entity <b>203</b>A, the names being separate by commas.</p>
<p id="p-0030" num="0029">In one embodiment, the queries from different languages or locales (i.e., different country and language pairings, such as United States English, United Kingdom English, or Canadian French) are stored together in the query log <b>112</b>. In another embodiment, a separate query log is maintained for each locale, so that each query is stored in the query log for the locale from which it came. Queries from different locales may have different orderings of the various constituent entities. For example, a query for &#x201c;801 Castro Street, Mountain View, Calif.&#x201d;, when entered in the US (American English) locale, might instead be expressed as &#x201c;California, Mountain View, 801 Castro Street&#x201d; when entered in the RU (Russian) locale.</p>
<p id="p-0031" num="0030">The illustrated components of the map service <b>100</b> can be implemented as single or multiple components of software or hardware. In general, functions described in one embodiment as being performed by one component can also be performed by other components in other embodiments, or by a combination of components. Furthermore, functions described in one embodiment as being performed by components of the map service <b>100</b> can also be performed by one or more clients <b>150</b> in other embodiments if appropriate.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram illustrating the components of the alternative spelling module <b>114</b> of <figref idref="DRAWINGS">FIG. 1</figref>, according to one embodiment. The alternative spelling module <b>114</b> analyzes the data in the geographic database <b>111</b> and one or more query logs <b>112</b> and generates a geographic language model. The geographic language model may then be processed to calculate conditional probabilities of various geographic entity names occurring in a geographic query. The conditional probabilities may then be used at runtime to suggest alternative queries for a given user query, e.g., where the user entered a query containing a misspelled entity name.</p>
<p id="p-0033" num="0032">More specifically, the alternative spelling module <b>114</b> includes (a) a template distribution repository <b>310</b> that stores for each of a set of orderings of possible query types, a probability that an arbitrary query will match that ordering, and (b) a location distribution repository <b>305</b> comprising probabilities that an arbitrary query references the various geographic entities in the geographic database <b>111</b>. In one embodiment, the template distribution repository <b>310</b> is implemented as a file comprising &#x3c;template, probability&#x3e; pairs, where template is some representation of the template (e.g., the ordered set of entity types that makes up the template, or a unique identifier thereto), and probability specifies the probability that an arbitrary query will match that template. In one embodiment, the location distribution repository <b>305</b> is implemented as a file comprising &#x3c;entity, probability&#x3e; pairs, where entity is a unique identifier of the entity in the geographic database <b>111</b>, and probability is the probability that an arbitrary query will reference the region corresponding to the entity. The alternative spelling module <b>114</b> further comprises a language model <b>315</b> that stores a set of probable orderings of geographic entity names and an associated score for each, the score being derived by a below-described language model generation module <b>317</b>.</p>
<p id="p-0034" num="0033">The alternative spelling module <b>114</b> further comprises modules <b>307</b>, <b>312</b>, and <b>317</b> for generating the data of the location distribution repository <b>305</b>, template distribution repository <b>310</b>, and language model <b>315</b>, respectively. The alternative spelling module <b>114</b> optionally further comprises a query spell check module <b>320</b> that applies the generated language model <b>315</b> to suggest spelling corrections for geographic queries. These components are now described in more detail.</p>
<p id="p-0035" num="0034">The template distribution generation module <b>312</b> generates the template distribution repository <b>310</b> from the data in the query log <b>112</b>. The template distribution repository <b>310</b> includes a set of distinct templates, each template representing a particular ordering of different geographic entity types, and each template having an associated probability; the determining of template probability is described below. In one embodiment, the template distribution repository <b>310</b> includes one template for each possible ordering of different entity types.</p>
<p id="p-0036" num="0035">For example, assuming for simplicity that the only geographic entity types were STREET, CITY and STATE, then the possible templates would be:</p>
<p id="p-0037" num="0036">&#x3c;STREET, CITY, STATE&#x3e;,</p>
<p id="p-0038" num="0037">&#x3c;STREET, STATE, CITY&#x3e;,</p>
<p id="p-0039" num="0038">&#x3c;STATE, STREET, CITY&#x3e;,</p>
<p id="p-0040" num="0039">&#x3c;STATE, CITY, STREET&#x3e;,</p>
<p id="p-0041" num="0040">&#x3c;CITY, STREET, STATE&#x3e;,</p>
<p id="p-0042" num="0041">&#x3c;CITY, STATE, STREET&#x3e;,</p>
<p id="p-0043" num="0042">&#x3c;STREET, CITY&#x3e;,</p>
<p id="p-0044" num="0043">&#x3c;STREET, STATE&#x3e;,</p>
<p id="p-0045" num="0044">&#x3c;CITY, STREET&#x3e;,</p>
<p id="p-0046" num="0045">&#x3c;CITY, STATE&#x3e;,</p>
<p id="p-0047" num="0046">&#x3c;STATE, STREET&#x3e;,</p>
<p id="p-0048" num="0047">&#x3c;STATE, CITY&#x3e;,</p>
<p id="p-0049" num="0048">&#x3c;STREET&#x3e;,</p>
<p id="p-0050" num="0049">&#x3c;STATE&#x3e;, and</p>
<p id="p-0051" num="0050">&#x3c;CITY&#x3e;.</p>
<p id="p-0052" num="0051">In one embodiment, the template distribution repository <b>310</b> is derived from queries from all locales. In another embodiment, there is one template distribution for each locale and it is generated solely from queries associated with that locale. In another embodiment, each template is associated with an identifier of one or more locales in which is it applicable, and the &#x3c;template, locales, probability&#x3e; tuples are sorted by probability.</p>
<p id="p-0053" num="0052">For every query in the query log <b>112</b> (or some subset thereof), the template distribution generation module <b>312</b> identifies the template matching the query based on the various entity types and their ordering. A template is said to match a query (or a query to match a template) if the query has the same entity types as the template, and in the same order. For example, the template distribution generation module <b>312</b> matches the query &#x201c;California Street, Mountain View, Calif.&#x201d; to the template &#x3c;STREET, CITY, STATE&#x3e;, since the query consists of a street, followed by a city, followed by a state. The template distribution generation module <b>312</b> tracks, for each template, a count of queries matching that template. After all the queries have been matched, the counts are normalized, e.g., by dividing the counts by the total number of queries, thus obtaining, for each template, a probability of an arbitrary query matching that template.</p>
<p id="p-0054" num="0053">For example, for some sample set of queries, it might be found that 28.2% of queries match the template &#x3c;ADDRESS, CITY, STATE&#x3e;, 18.6% of queries match the template &#x3c;CITY, STATE&#x3e;, and 7.6% of queries match the template &#x3c;STATE, CITY, ADDRESS&#x3e;. In this example, the contents of the template distribution repository <b>310</b> would comprise the three entries:</p>
<p id="p-0055" num="0054">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="91pt" align="left"/>
<colspec colname="3" colwidth="91pt" align="char"/>
<thead>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>&#x3c;ADDRESS, CITY, STATE&#x3e;</entry>
<entry>28.2%</entry>
</row>
<row>
<entry/>
<entry>&#x3c;CITY, STATE&#x3e;</entry>
<entry>18.6%</entry>
</row>
<row>
<entry/>
<entry>&#x3c;STATE, CITY, ADDRESS&#x3e;</entry>
<entry>7.6%</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0056" num="0055">In one embodiment, templates with probabilities below some threshold are removed, since their low calculated probabilities indicate that that particular query template is not used in practice.</p>
<p id="p-0057" num="0056">The location distribution generation module <b>307</b> generates the data of the location distribution repository <b>305</b> from the data in the query log <b>112</b> and in the geographic database <b>111</b>. The location distribution comprises probabilities that an arbitrary query refers to the various geographic entities in the domain database.</p>
<p id="p-0058" num="0057">The location distribution generation module <b>307</b> first determines, for every entity <b>111</b>A in the geographic database <b>111</b>, which queries from the query log <b>112</b> referred to that entity. More specifically, the location distribution generation module <b>307</b> identifies, for each entity, queries containing one of the names associated with the entity. Additionally, since names need not uniquely identify an entity&#x2014;e.g., &#x201c;CA&#x201d; can be a name of both the state of California and the country of Canada&#x2014;the location distribution generation module <b>307</b> also determines whether each of the identified queries had results falling within the region represented by the entity. (A query is said to have results falling within the portion of map data viewed by the user issuing the query&#x2014;e.g., the portion of data displayed on a web page in response to the entry of the geographic query.) If an identified query does have results falling within the region represented by the entity, the module <b>307</b> considers the query to refer to the entity and accordingly increments a count for that entity. Once a count for an entity has been tabulated, the location distribution generation module <b>307</b> normalizes the count, e.g., by dividing the count for the entity by the total number of queries from the query log <b>112</b> that were examined. (In one embodiment, all queries are examined; in other embodiments, only some subset of the queries is examined, such as those for a particular locale(s), or a random sampling of the queries.) This process is repeated for each entity that appears in the database <b>111</b>.</p>
<p id="p-0059" num="0058">Thus, the result of the location distribution generation module <b>307</b>&#x2014;i.e., the location distribution repository <b>305</b>&#x2014;is, for every entity, a probability that an arbitrary query references the region represented by that entity.</p>
<p id="p-0060" num="0059">The language model generation module <b>317</b> generates the language model <b>315</b> from the data in the generated location distribution repository <b>305</b> and the template distribution repository <b>310</b>. The language model <b>315</b> then can be used as the basis of checking the spelling of a geographic query and suggesting alternative query spellings, for example.</p>
<p id="p-0061" num="0060">Generally, the language model generation module <b>317</b> generates a set of entity name orderings that are likely to occur using the information on entity relationships in the geographic database <b>111</b> and the templates <b>311</b>; it does not generate all theoretically possible orderings. This results in a set of orderings that is practical to store and analyze. The language model generation module <b>317</b> then calculates a score for each such ordering, the score being some function of the probability that an arbitrary query would include that ordering.</p>
<p id="p-0062" num="0061">More specifically, for each entity E in the geographic database <b>111</b>, the language model generation module <b>317</b> identifies the type T<sub>E </sub>of the entity, such as STREET, CITY, or the like, e.g., by looking up the type within a corresponding entry of the geographic database. Then, the language model generation module <b>317</b> generates a set of types S<sub>R </sub>that are related to the type T<sub>E</sub>&#x2014;i.e., any type (other than T<sub>E </sub>itself) that appears in a template directly after an entity of type T<sub>E</sub>. Then, the language model generation module <b>317</b> generates a set of entities S<sub>N </sub>that are neighbors of E in the entity graph and that are of one of the types in S<sub>R</sub>.</p>
<p id="p-0063" num="0062">As a simple example of the above steps, assume that the entity E is the street entity <b>205</b>B of the example of <figref idref="DRAWINGS">FIG. 2</figref>, and the template distribution repository <b>310</b> comprises templates &#x3c;STREET, CITY, STATE&#x3e; and &#x3c;STREET, POSTAL_CODE&#x3e;. For this example, the language model generation module <b>317</b> would determine that the type T<sub>E </sub>of E is STREET, e.g., by examining an entry corresponding to E in the database <b>111</b>. The language model generation module <b>317</b> would then generate, as the set S<sub>R </sub>of related types, the set {CITY, POSTAL_CODE}, since CITY and POSTAL_CODE both follow STREET in one of the templates, but STATE does not. Then, the language model generation module <b>317</b> would generate, as the set S<sub>N</sub>, the set consisting of city entities <b>204</b>A and <b>204</b>B, the neighbors of street entity <b>205</b>B that are also of one of the types in S<sub>R </sub>(namely, the CITY type).</p>
<p id="p-0064" num="0063">Then, using the query templates <b>311</b>, the language model generation module <b>317</b> generates all pairs of names involving a name of E and the names of the entities of S<sub>N</sub>. Finally, the language model generation module <b>317</b> assigns a score to each of the name combinations based on (a) the probability of the template corresponding to the name combination, as stored in the template distribution repository <b>310</b>, (b) the probability assigned to the area that E represents, as stored in the location distribution repository <b>305</b>, and (c) the rank or other numerical value associated with of the most specific type of the combination. For example, the three scores could be multiplied together to obtain a weighted probability score.</p>
<p id="p-0065" num="0064">Continuing the prior example, assume that the street entity <b>205</b>B has the name &#x201c;El Camino Real&#x201d;, the city entity <b>204</b>A has the names &#x201c;Mountain View&#x201d; and &#x201c;Vue Montagne&#x201d;, and the city entity <b>204</b>B has the name &#x201c;Palo Alto&#x201d;. Then the set of all unordered pairs of names involving E and the names of the entities in S<sub>N </sub>is {&#x201c;El Camino Real, Mountain View&#x201d;, &#x201c;El Camino Real, Vue Montagne&#x201d;, &#x201c;El Camino Real, Palo Alto&#x201d;}. Then, for example, the name combination &#x201c;El Camino Real, Mountain View&#x201d; might be assigned a score by computing the product of (a) the probability of its template &#x3c;STREET, CITY&#x3e; as stored in the template distribution repository <b>310</b>, (b) the probability assigned to the street entity <b>205</b>B in the location distribution repository <b>305</b> (quantifying the likelihood that an arbitrary query will be targeting that particular street), and (c) the rank of the STREET type (e.g. 5, denoting that STREET is more specific than CITY, STATE, COUNTRY, and CONTINENT, for example).</p>
<p id="p-0066" num="0065">In summary, the score for a given name combination (e.g., &#x201c;El Camino Real, Mountain View&#x201d;) is:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>P</i>(<i>T</i>(<i>Q</i>)*<i>P</i>(<i>L</i>(<i>Q</i>))*<i>R</i>(<i>Q</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where P(T(Q)) represents the probability of the template matching the query Q, P(L(Q)) represents the probability that a query references the location described by Q, and R(Q) represents the rank value assigned to the most specific entity in the query.
</p>
<p id="p-0067" num="0066">The optional query spell check module <b>320</b> uses the language model <b>315</b> generated by the language model generation module to identify, for a given user-submitted query, alternative queries that are more likely what the user intended. In one embodiment, for a query Q composed of a set of words w<sub>1</sub>, w<sub>2</sub>, . . . w<sub>N</sub>, the query spell check module <b>320</b> computes the probability of Q as the product of the conditional probabilities of each word, i.e., Pr(Q)=Pr(w<sub>1</sub>)*Pr(w<sub>2</sub>|w<sub>1</sub>)* . . . * Pr(w<sub>N</sub>|w<sub>1</sub>, w<sub>2</sub>, . . . w<sub>N-1</sub>). Thus, the conditional probabilities are required to compute the probability of the query.</p>
<p id="p-0068" num="0067">In order to learn the conditional probabilities, a preprocessing portion of the query spell check module <b>320</b> analyzes the language model <b>315</b>. In one embodiment, the preprocessing portion treats the language model itself as a document corpus. This is possible because the language model can be considered a large set of valid sentences in the form of geographic queries. A phrase corresponding to each pair of names (e.g., &#x201c;El Camino Real, Mountain View&#x201d;) serves as a valid sentence, and the frequency of occurrence of each phrase may be determined based on its associated score, e.g., with the phrase with the lowest score occurring once, and a phrase having a score that is N times greater than the lowest score occurring N times. The various conditional probabilities can then be learned by analyzing this derived document corpus using statistical algorithms known to those of skill in the art. For example, one algorithm divides each entry in the language model into tokens, such as individual word tokens. The tokenization may be language-specific, and is typically based on the presence of space characters. Each distinct token-ngram (i.e., n tokens, for some integer n) is then counted by incrementing an associated count each time that the token-ngram is found in the set of tokens. For example, for the phrase &#x201c;El Camino Real, Mountain View&#x201d;, each of the token-unigrams &#x201c;El&#x201d;, &#x201c;Camino&#x201d;, &#x201c;Real&#x201d;, &#x201c;Mountain&#x201d;, and &#x201c;View&#x201d; has its count incremented, as do the token-bigrams &#x3c;&#x201c;el&#x201d; &#x201c;camino&#x201d;&#x3e;&#x3c;&#x201c;camino&#x201d; &#x201c;real&#x201d;&#x3e;, &#x3c;&#x201c;real&#x201d; &#x201c;mountain&#x201d;&#x3e; and &#x3c;&#x201c;mountain&#x201d; &#x201c;view&#x201d;&#x3e;. The token-3-grams, token-4-grams, and token-5-grams are incremented in a similar manner. The counts are then normalized based on the total number of counts for all the token-ngrams. Then, when computing the conditional probabilities, Pr(w<b>2</b>|w<b>1</b>) can be computed as Pr(w<b>1</b> w<b>2</b>)/Pr(w<b>1</b>), where Pr(w<b>1</b> w<b>2</b>) is a token-bigram probability and Pr(w<b>1</b>) is a token-unigram probability.</p>
<p id="p-0069" num="0068">The conditional probabilities are used at runtime by the query spell check module <b>320</b> to suggest alternative, more likely queries. This module receives queries&#x2014;e.g., from the map server <b>113</b> of FIG. <b>1</b>&#x2014;and generates a set of variants of the query. For example, the runtime portion might apply edit rules that are based on past observance of user spelling corrections, such as a rule transforming the substring &#x201c;aams&#x201d; to &#x201c;ams&#x201d;, each application of an edit rule generating a variant of the original query. In one embodiment, each locale has its own set of edit rules. Then, the probability of each variant is computed by calculating the product of the conditional probabilities as described above, each of the conditional probabilities having previously been derived by the preprocessing portion of the query spell check module <b>320</b> from the language model <b>315</b>. Some or all of the variants with probabilities higher than the user-submitted query may then be presented to the user as alternative queries to be executed.</p>
<p id="p-0070" num="0069"><figref idref="DRAWINGS">FIG. 4</figref> is a data flow diagram representing the relationships and derivations of the various types of data analyzed and/or produced by the alternative spelling module <b>114</b>, according to one embodiment. The geographic database <b>111</b> and the query log <b>112</b> of the map service <b>100</b> act as input for the alternative spelling module <b>114</b>. The alternative spelling module <b>114</b> generates the template distribution repository <b>310</b> based on the contents of the query log <b>112</b>, and generates the location distribution repository <b>305</b> based both on the contents of the query log and on the contents of geographic database <b>111</b>. The alternative spelling module <b>114</b> then in turn generates the language model <b>315</b> based on the contents of the location distribution repository <b>305</b> and the template distribution repository <b>310</b>.</p>
<p id="p-0071" num="0070">As described above, the language model <b>315</b> may then be used to calculate the conditional probabilities of various geographic entity names occurring in a query, and the conditional probabilities in turn can be used to compute scores for arbitrary geographic queries. The scores can then be used to suggest, for a given geographic query, alternative queries with different spellings that are more probable than the query as originally submitted.</p>
<p id="p-0072" num="0071">Although the foregoing description has provided examples for the domain of geographic queries, it is appreciated that the disclosed techniques are broadly applicable to structured data from different domains, and are not limited to use with geographic queries. For example, the inventive techniques could also be applied for generating alternative spellings of names of people, e.g. suggesting &#x201c;Adams, John Q&#x201d; as a more probable alternative spelling for the query &#x201c;Adams, Jonh Q&#x201d; when seeking information on a person. Other applications include fields in which complex terminology or language is frequently employed, such as in medicine, biology, chemistry, and pharmaceuticals.</p>
<p id="p-0073" num="0072">The present invention has been described in particular detail with respect to one possible embodiment. Those of skill in the art will appreciate that the invention may be practiced in other embodiments. First, the particular naming of the components and variables, capitalization of terms, the attributes, data structures, or any other programming or structural aspect is not mandatory or significant, and the mechanisms that implement the invention or its features may have different names, formats, or protocols. Also, the particular division of functionality between the various system components described herein is merely for purposes of example, and not mandatory; functions performed by a single system component may instead be performed by multiple components, and functions performed by multiple components may instead performed by a single component.</p>
<p id="p-0074" num="0073">Some portions of above description present the features of the present invention in terms of algorithms and symbolic representations of operations on information. These algorithmic descriptions and representations are the means used by those skilled in the data processing arts to most effectively convey the substance of their work to others skilled in the art. These operations, while described functionally or logically, are understood to be implemented by computer programs. Furthermore, it has also proven convenient at times, to refer to these arrangements of operations as modules or by functional names, without loss of generality.</p>
<p id="p-0075" num="0074">Unless specifically stated otherwise as apparent from the above discussion, it is appreciated that throughout the description, discussions utilizing terms such as &#x201c;determine&#x201d; refer to the action and processes of a computer system, or similar electronic computing device, that manipulates and transforms data represented as physical (electronic) quantities within the computer system memories or registers or other such information storage, transmission or display devices.</p>
<p id="p-0076" num="0075">Certain aspects of the present invention include process steps and instructions described herein in the form of an algorithm. It should be noted that the process steps and instructions of the present invention could be embodied in software, firmware or hardware, and when embodied in software, could be downloaded to reside on and be operated from different platforms used by real time network operating systems.</p>
<p id="p-0077" num="0076">The present invention also relates to an apparatus for performing the operations herein. This apparatus may be specially constructed for the required purposes, or it may comprise a general-purpose computer selectively activated or reconfigured by a computer program stored on a computer readable medium that can be accessed by the computer. Such a computer program may be stored in a computer readable storage medium, such as, but is not limited to, any type of disk including floppy disks, optical disks, CD-ROMs, DVDs, magnetic-optical disks, read-only memories (ROMs), random access memories (RAMs), EPROMs, EEPROMs, magnetic or optical cards, application specific integrated circuits (ASICs), or any type of computer-readable storage medium suitable for storing electronic instructions, and each coupled to a computer system bus. Furthermore, the computers referred to in the specification may include a single processor or may be architectures employing multiple processor designs for increased computing capability.</p>
<p id="p-0078" num="0077">The algorithms and operations presented herein are not inherently related to any particular computer or other apparatus. Various general-purpose systems may also be used with programs in accordance with the teachings herein, or it may prove convenient to construct more specialized apparatus to perform the required method steps. The required structure for a variety of these systems will be apparent to those of skill in the art, along with equivalent variations. In addition, the present invention is not described with reference to any particular programming language. It is appreciated that a variety of programming languages may be used to implement the teachings of the present invention as described herein, and any references to specific languages are provided for invention of enablement and best mode of the present invention.</p>
<p id="p-0079" num="0078">The present invention is well suited to a wide variety of computer network systems over numerous topologies. Within this field, the configuration and management of large networks comprise storage devices and computers that are communicatively coupled to dissimilar computers and storage devices over a network, such as the Internet.</p>
<p id="p-0080" num="0079">Finally, it should be noted that the language used in the specification has been principally selected for readability and instructional purposes, and may not have been selected to delineate or circumscribe the inventive subject matter. Accordingly, the disclosure of the present invention is intended to be illustrative, but not limiting, of the scope of the invention, which is set forth in the following claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A computer-implemented method for generating a geographic language model for computing probabilities of occurrence of geographic queries, comprising:
<claim-text>accessing a geographic database comprising:
<claim-text>a plurality of geographic entities, each geographic entity corresponding to a geographic region and having one or more names and an entity type, and</claim-text>
<claim-text>a plurality of links between pairs of the geographic entities;</claim-text>
</claim-text>
<claim-text>accessing a query log comprising geographic queries previously entered by users, a plurality of the geographic queries including names of ones of the geographic entities in the geographic database;</claim-text>
<claim-text>generating, from the query log, a template distribution quantifying probabilities that entity types of the geographic entities named in the geographic queries correspond to ones of a plurality of query templates, each query template comprising an ordered set of the entity types appearing in the geographic database;</claim-text>
<claim-text>generating a geographic distribution from the query log quantifying probabilities of queries in the query log referencing ones of the geographic entities in the geographic database;</claim-text>
<claim-text>generating the geographic language model from the template distribution and the geographic distribution, the geographic language model comprising a set of combinations of names of the geographic entities and associated scores, the scores based on probabilities of occurrence of the combinations in a geographic query; and</claim-text>
<claim-text>storing the geographic language model on a computer readable storage device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising computing conditional probabilities of occurrence of words in geographic queries based at least in part on the geographic language model.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The computer-implemented method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising:
<claim-text>receiving a geographic query from a user;</claim-text>
<claim-text>generating an alternative geographic query that is a variant of the received geographic query;</claim-text>
<claim-text>computing a probability of occurrence of the received geographic query and a probability of occurrence of the alternative geographic query based at least in part on the computed conditional probabilities; and</claim-text>
<claim-text>responsive to the probability of occurrence of the alternative geographic query being higher than the probability of occurrence of the received geographic query, providing the alternative geographic query to the user as an alternative query.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein generating the geographic language model further comprises:
<claim-text>for a pair of names comprising a name of a first geographic entity and a name of a second geographic entity corresponding to a geographic region that includes the first geographic entity, computing a score for the pair using:
<claim-text>a probability of a template of the template distribution corresponding to the pair; and</claim-text>
<claim-text>a probability of the geographic distribution corresponding to the first geographic entity.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein generating the template distribution comprises:
<claim-text>identifying, for each of a plurality of the geographic queries in the query log, a corresponding one of the query templates; and</claim-text>
<claim-text>determining, for each distinct query template, a count of the plurality of the geographic queries that correspond to the template.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein generating the geographic distribution comprises, for each entity of a plurality of the geographic entities:
<claim-text>identifying queries comprising one of the names associated with the entity; and</claim-text>
<claim-text>counting, within the identified queries, queries having results falling within the geographic region corresponding to the entity.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The computer-implemented method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein generating the geographic language model further comprises:
<claim-text>receiving the name of the first geographic entity from the geographic database;</claim-text>
<claim-text>identifying a type of the first geographic entity;</claim-text>
<claim-text>identifying a set of related types, the related types comprising entity types that appear in the geographic database adjacent to the first geographic entity;</claim-text>
<claim-text>identifying a set of neighboring geographic entities in the geographic database, each neighboring geographic entity having a link between the neighboring geographic entity and the first geographic entity, and having a type that is included in the set of related types; and</claim-text>
<claim-text>generating a set of pairs of the name of the first geographic entity and the names of the entities in the set of neighboring geographic entities.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The computer-implemented method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein generating the geographic language model further comprises computing a score for each of the generated pairs.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The computer-implemented method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the score for a generated pair is based on a probability of a template of the template distribution corresponding to the pair.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The computer-implemented method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the score for a generated pair is based on a probability of an entity in the geographic distribution corresponding to the first geographic entity.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The computer-implemented method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the score for a generated pair is based on a rank of the type of the first geographic entity.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein each geographic entity is associated with data demarcating the geographic region corresponding to the geographic entity.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein at least one of the geographic entities has a plurality of names comprising at least two names selected from the group consisting of an official name, an informal name, an abbreviated name, and two or more language variants of a name.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A non-transitory computer-readable storage medium having executable computer program instructions embodied therein for generating a language model for analyzing probabilities of occurrence of text strings in a given domain, actions of the computer program instructions comprising:
<claim-text>accessing a geographic database comprising:
<claim-text>a plurality of geographic entities, each geographic entity corresponding to a geographic region and having one or more names, and</claim-text>
<claim-text>a plurality of links between pairs of the geographic entities;</claim-text>
</claim-text>
<claim-text>accessing a query log comprising geographic queries previously entered by users, a plurality of the geographic queries including names of ones of the geographic entities in the geographic database;</claim-text>
<claim-text>generating, from the query log, a template distribution quantifying probabilities that entity types of the geographic entities named in the geographic queries correspond to ones of a plurality of query templates, each query template comprising an ordered set of the entity types appearing in the geographic database;</claim-text>
<claim-text>generating a geographic distribution from the query log quantifying probabilities of queries in the query log referencing ones of the geographic entities in the geographic database;</claim-text>
<claim-text>generating the geographic language model from the template distribution and the geographic distribution, the geographic language model comprising a set of combinations of names of the geographic entities and associated scores, the scores based on probabilities of occurrence of the combinations in a geographic query; and</claim-text>
<claim-text>storing the geographic language model on a computer readable storage device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The non-transitory computer-readable storage medium of <claim-ref idref="CLM-00014">claim 14</claim-ref>, the actions further comprising:
<claim-text>computing conditional probabilities of occurrence of words in geographic queries based at least in part on the geographic language model;</claim-text>
<claim-text>receiving a geographic query from a user;</claim-text>
<claim-text>generating an alternative geographic query that is a variant of the received geographic query;</claim-text>
<claim-text>computing a probability of occurrence of the received geographic query and a probability of occurrence of the alternative geographic query based at least in part on the computed conditional probabilities; and</claim-text>
<claim-text>responsive to the probability of occurrence of the alternative geographic query being higher than the probability of occurrence of the received geographic query, providing the alternative geographic query to the user as an alternative query.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The non-transitory computer-readable storage medium of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein generating the geographic language model further comprises:
<claim-text>receiving a name of a first geographic entity from the geographic database;</claim-text>
<claim-text>identifying a type of the first geographic entity;</claim-text>
<claim-text>identifying a set of related types, the related types comprising entity types that appear in the geographic database adjacent to the first geographic entity;</claim-text>
<claim-text>identifying a set of neighboring geographic entities in the geographic database, each neighboring geographic entity having a link between the neighboring geographic entity and the first geographic entity, and having a type that is included in the set of related types; and</claim-text>
<claim-text>generating a set of pairs of the name of the first geographic entity and the names of the entities in the set of neighboring geographic entities.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The non-transitory computer-readable storage medium of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein generating the geographic language model further comprises computing a score for each of the generated pairs based on at least one of:
<claim-text>a probability of a template of the template distribution corresponding to the pair;</claim-text>
<claim-text>a probability of the geographic distribution corresponding to the first geographic entity; and</claim-text>
<claim-text>a rank of the type of the first geographic entity.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. A computer-implemented method for generating a geographic language model for analyzing probabilities of occurrence of geographic queries, the method comprising:
<claim-text>accessing a geographic database comprising:
<claim-text>a plurality of geographic entities, each geographic entity corresponding to a geographic region and having one or more names, and</claim-text>
<claim-text>a plurality of links between pairs of the geographic entities;</claim-text>
</claim-text>
<claim-text>accessing a query log comprising a plurality of geographic queries previously entered by users, a plurality of the geographic queries including names of ones of the geographic entities in the geographic database;</claim-text>
<claim-text>generating, from the query log, a template distribution quantifying probabilities that entity types of the geographic entities named in the geographic queries correspond to ones of a plurality of query templates, the generating comprising:
<claim-text>identifying, for each of a plurality of the geographic queries in the query log, a query template comprising an ordered set of the entity types appearing in the geographic database, and</claim-text>
<claim-text>determining, for each distinct query template, a probability that the arbitrary user query corresponds to the template;</claim-text>
</claim-text>
<claim-text>generating a geographic distribution from the query log quantifying probabilities of queries in the query log referencing ones of the geographic entities in the geographic database, comprising:
<claim-text>identifying queries comprising one of the names associated with one of the entities, and which have results falling within the geographic region corresponding to the entity; and</claim-text>
</claim-text>
<claim-text>generating the geographic language model using the template distribution and the geographic distribution, the geographic language model comprising a set of orderings of names of the geographic entities and associated scores, the scores based on probabilities of occurrence of the orderings in a geographic query.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The computer-implemented method of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein generating the geographic language model comprises:
<claim-text>receiving a name of a first geographic entity from the geographic database;</claim-text>
<claim-text>identifying a type of the first geographic entity;</claim-text>
<claim-text>identifying a set of related types, the related types comprising entity types that appear in the geographic database adjacency to the first geographic entity;</claim-text>
<claim-text>identifying a set of neighboring geographic entities in the geographic database, each neighboring geographic entity having a link between the neighboring geographic entity and the first geographic entity and having a type that is included in the set of related types;</claim-text>
<claim-text>generating a set of pairs of the name of the first geographic entity and the names of the entities in the set of neighboring geographic entities; and</claim-text>
<claim-text>for each of the generated pairs, computing a score for the pair based at least in part on:
<claim-text>a probability of a template of the template distribution corresponding to the pair;</claim-text>
<claim-text>a probability of the geographic distribution corresponding to the first geographic entity; and</claim-text>
<claim-text>a rank of the type of the first geographic entity.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The computer-implemented method of <claim-ref idref="CLM-00018">claim 18</claim-ref>, further comprising:
<claim-text>computing conditional probabilities of occurrence of words in geographic queries based at least in part on the geographic language model;</claim-text>
<claim-text>receiving a geographic query from a user;</claim-text>
<claim-text>generating an alternative geographic query that is a variant of the received geographic query;</claim-text>
<claim-text>computing a probability of occurrence of the received geographic query and a probability of occurrence of the alternative geographic query based at least in part on the computed conditional probabilities; and</claim-text>
<claim-text>responsive to the probability of occurrence of the alternative geographic query being higher than the probability of occurrence of the received geographic query, providing the alternative geographic query to the user as an alternative query.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
