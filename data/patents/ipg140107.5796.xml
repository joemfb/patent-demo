<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08626903-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08626903</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12981182</doc-number>
<date>20101229</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>CN</country>
<doc-number>2010 1 0193624</doc-number>
<date>20100601</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>108</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>J</subclass>
<main-group>3</main-group>
<subgroup>16</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>709224</main-classification>
<further-classification>709230</further-classification>
<further-classification>709231</further-classification>
<further-classification>709232</further-classification>
</classification-national>
<invention-title id="d2e71">Method and device for identifying an SCTP packet</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>7277954</doc-number>
<kind>B1</kind>
<name>Stewart et al.</name>
<date>20071000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709230</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7366096</doc-number>
<kind>B2</kind>
<name>Swami</name>
<date>20080400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370231</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7519724</doc-number>
<kind>B2</kind>
<name>Venkatsubra et al.</name>
<date>20090400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709231</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7761562</doc-number>
<kind>B1</kind>
<name>Stewart et al.</name>
<date>20100700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709224</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2005/0094637</doc-number>
<kind>A1</kind>
<name>Umesawa et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370389</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2005/0157726</doc-number>
<kind>A1</kind>
<name>Vesterinen</name>
<date>20050700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>3703955</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2006/0062203</doc-number>
<kind>A1</kind>
<name>Satapati</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2006/0176904</doc-number>
<kind>A1</kind>
<name>Stewart et al.</name>
<date>20060800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370467</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2006/0221840</doc-number>
<kind>A1</kind>
<name>Yasuoka et al.</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370242</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2007/0105549</doc-number>
<kind>A1</kind>
<name>Suda et al.</name>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4554262</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2011/0296007</doc-number>
<kind>A1</kind>
<name>Liu et al.</name>
<date>20111200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709224</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>CN</country>
<doc-number>101094240</doc-number>
<kind>A</kind>
<date>20071200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>WO</country>
<doc-number>WO03/105438</doc-number>
<kind>A1</kind>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>WO</country>
<doc-number>WO2007/067693</doc-number>
<kind>A2</kind>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00015">
<othercit>First Chinese Office Action dated (mailed) Jul. 1, 2011, issued in related Chinese Application No. 200910148423.7 Huawei Technologies Co., Ltd.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00016">
<othercit>Extended European Search Report dated (mailed) Apr. 4, 2011, issued in related Application No. 10196848.5-1244, Hauwei Technologies Co., Ltd.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>12</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>709224-228</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709200</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709230-233</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709245</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370231</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370328</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370389</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370235</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370252</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370474</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370242</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>3703955</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>10</number-of-drawing-sheets>
<number-of-figures>13</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110296007</doc-number>
<kind>A1</kind>
<date>20111201</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Liu</last-name>
<first-name>Hua</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Zhou</last-name>
<first-name>Weijun</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Duan</last-name>
<first-name>Liang</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Pan</last-name>
<first-name>Nengyi</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Liu</last-name>
<first-name>Hua</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Zhou</last-name>
<first-name>Weijun</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Duan</last-name>
<first-name>Liang</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Pan</last-name>
<first-name>Nengyi</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
</inventors>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Huawei Technologies Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Wilson</last-name>
<first-name>Robert</first-name>
<department>2475</department>
</primary-examiner>
<assistant-examiner>
<last-name>Aung</last-name>
<first-name>Sai</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method for identifying a Stream Control Transmission Protocol (SCTP) packet is provided, which includes: acquiring a feature tuple of a received SCTP packet, in which the feature tuple includes at least one piece of the following information: a source Internet Protocol (IP) address, a destination IP address, and a verification tag (V_tag); matching the acquired feature tuple of the SCTP packet with a SCTP tuple identification table, in which the SCTP tuple identification table includes a mapping relation between a feature set tuple and an SCTP association, and the feature set tuple includes at least one piece of the following information: a source IP address set, a destination IP address set, and the V_tag; and acquiring an SCTP association to which the SCTP packet belongs, if the acquired feature tuple of the SCTP packet matches one or more records of the SCTP tuple identification table. Correspondingly, a device for identifying an SCTP packet, a system for identifying an SCTP packet, and a method for establishing an SCTP tuple identification table are further provided, capable of reducing missed identification of an SCTP stream.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="245.19mm" wi="154.77mm" file="US08626903-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="236.47mm" wi="160.19mm" file="US08626903-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="244.18mm" wi="153.84mm" file="US08626903-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="240.28mm" wi="171.11mm" file="US08626903-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="159.60mm" wi="123.70mm" file="US08626903-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="175.43mm" wi="131.40mm" file="US08626903-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="149.94mm" wi="128.19mm" file="US08626903-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="191.09mm" wi="112.10mm" file="US08626903-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="147.40mm" wi="149.94mm" file="US08626903-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="235.20mm" wi="121.75mm" orientation="landscape" file="US08626903-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="117.01mm" wi="131.15mm" file="US08626903-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATION</heading>
<p id="p-0002" num="0001">This application claims priority to Chinese Patent Application No. 201010193624.1, filed on Jun. 1, 2010, which is hereby incorporated by reference in its entirety.</p>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to the field of communications technology, and in particular, to a method and device for identifying a Stream Control Transmission Protocol (SCTP) packet.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">SCTP is a reliable universal transmission layer protocol used on an Internet Protocol (IP) network. The protocol is initially designed for sending telecommunication signaling, has such characteristics as supporting multi-homing, multi-streaming, initialization protection, message framing, configurable unordered sending, and smooth shutdown, and the protocol has very high reliability and security. Therefore, many mainstream operating systems (such as Linux, BSD, and Solaris) begin to support the SCTP, so that currently services transmitted by using the protocol on a network are gradually increased.</p>
<p id="p-0005" num="0004">In the prior art, a quintuple (a source IP, a destination IP, a source Port, a destination Port, and a transmission layer protocol) is used to identify one Transmission Control Protocol (TCP)/User Datagram Protocol (UDP) packet. Information saved in a data stream is associated with the quintuple, and a subsequent packet of the data stream uses the quintuple to index the information saved in the data stream.</p>
<p id="p-0006" num="0005">However, because of a characteristic that the SCTP supports the multi-homing, i.e. the same association of the SCTP may use several different quintuples for interaction. Because a plurality of quintuples exists in the association, if the quintuple that is used for identifying the TCP/UDP packet is used to identify an SCTP association, only one or few quintuples involved in the association can be identified, a packet using other quintuples involved in the association for communication is not identified, thereby causing a large quantity of missed identification.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0007" num="0006">The embodiments of the present invention provide a method and device for identifying an SCTP packet, so as to reduce missed identification of an SCTP stream.</p>
<p id="p-0008" num="0007">An embodiment of the present invention provides a method for identifying an SCTP packet, where the method includes:</p>
<p id="p-0009" num="0008">acquiring a feature tuple of a received SCTP packet, in which the feature tuple includes at least one piece of the following information: a source IP address, a destination IP address, and a verification tag (V_tag);</p>
<p id="p-0010" num="0009">matching the acquired feature tuple of the SCTP packet with a SCTP tuple identification table, in which the SCTP tuple identification table includes a mapping relation between a feature set tuple and an SCTP association, and the feature set tuple includes at least one piece of the following information: a source IP address set, a destination IP address set, and a V_tag; and</p>
<p id="p-0011" num="0010">acquiring an SCTP association to which the SCTP packet belongs, if the acquired feature tuple of the SCTP packet matches one or more records of the SCTP tuple identification table.</p>
<p id="p-0012" num="0011">An embodiment of the present invention provides a device for identifying an SCTP packet, where the device includes:</p>
<p id="p-0013" num="0012">a first acquiring module, configured to acquire a feature tuple of a received SCTP packet, in which the feature tuple includes at least one piece of the following information: a source IP address, a destination IP address, and a V_tag;</p>
<p id="p-0014" num="0013">a matching module, configured to match the acquired feature tuple of the SCTP packet with a SCTP tuple identification table, in which the SCTP tuple identification table includes a mapping relation between a feature set tuple and an SCTP association, and the feature set tuple includes at least one piece of the following information: a source IP address set, a destination IP address set, a source port number, a destination port number, and a V_tag; and</p>
<p id="p-0015" num="0014">a second acquiring module, configured to acquire an SCTP association to which the SCTP packet belongs, if the acquired feature tuple of the SCTP packet matches one or more records of the SCTP tuple identification table by the matching module.</p>
<p id="p-0016" num="0015">An embodiment of the present invention provides a method for establishing an SCTP tuple identification table, where the method includes:</p>
<p id="p-0017" num="0016">acquiring an SCTP handshake message on an SCTP association, in which the SCTP handshake message includes an initialization (INIT) packet and an initialization acknowledgement (INIT ACK) packet that corresponds to the INIT packet;</p>
<p id="p-0018" num="0017">acquiring an SCTP feature set tuple of the SCTP association from a pair of the INIT packet and the INIT ACK packet, in which the SCTP feature set tuple includes at least one piece of the following information: a source IP address set, a destination IP address set, a source port number, a destination port number, and a V_tag; and</p>
<p id="p-0019" num="0018">establishing a mapping relation between the feature set tuple and the SCTP association.</p>
<p id="p-0020" num="0019">According to the embodiments of the present invention, for a characteristic that the SCTP supports multi-homing, the SCTP tuple identification table including the mapping relation between the feature set tuple of the SCTP packet and the SCTP association is used to identify the SCTP packet. Because the SCTP feature set tuple includes the source IP address set, the destination IP address set, and the V_tag, the SCTP feature set tuple includes all interaction in one SCTP association. If the feature tuple of the SCTP packet such as the source IP address, the destination IP address, or the SCTP tag matches the feature set tuple successfully, the SCTP association to which the SCTP packet belongs can be acquired. As compared with the prior art in which all interaction in the same association cannot be completely identified when a conventional quintuple is used to identify an SCTP data stream, after a quintuple used in the SCTP association has switched, the solution in this embodiment is still capable of correctly identifying an SCTP association to which a packet of the interaction belongs according to a matching result of the IP address set or the V_tag, so as to reduce missed identification.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0021" num="0020">To make the technical solution under the present invention clearer, the accompanying drawings for illustrating the embodiments of the present invention or the prior art are outlined below. Apparently, the accompanying drawings are for the exemplary purpose only, and person having ordinary skill in the art can derive other drawings from such accompanying drawings without any creative effort.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 1</figref> is a flow chart of a method for identifying an SCTP packet according to an embodiment of the present invention;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 2</figref> is a flow chart of a method for identifying an SCTP packet according to an embodiment of the present invention;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 3</figref> is a flow chart of a method for identifying an SCTP packet according to an embodiment of the present invention;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 4</figref> is a schematic structural view of an SCTP tuple identification table according to an embodiment of the present invention;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 5</figref> is a structural view of a device for identifying an SCTP packet according to an embodiment of the present invention;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 6</figref> is a structural view of a device for identifying an SCTP packet according to an embodiment of the present invention;</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 7</figref> is a structural view of a parsing and adding module according to an embodiment of the present invention;</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 8</figref> is a structural view of a parsing and adding module according to an embodiment of the present invention;</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 9</figref> is a structural view of a device for identifying an SCTP packet according to an embodiment of the present invention;</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 10</figref> is a structural view of a maintenance module according to an embodiment of the present invention;</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 11</figref> is a structural view of a system for identifying an SCTP packet according to an embodiment of the present invention;</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 12</figref> is a schematic structural view of an SCTP tuple identification table according to an embodiment of the present invention; and</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 13</figref> is a flow chart of a method for establishing an SCTP tuple identification table according to an embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE EMBODIMENTS</heading>
<p id="p-0035" num="0034">The following detailed description is directed to the technical solution of the present invention with reference to the accompanying drawings. However, the embodiments to be described are only part of, rather than all of, the embodiments of the present invention. Those skilled in the art can derive other embodiments from the embodiments given herein without creative work, and all such embodiments are covered in the scope of protection of the present invention.</p>
<p id="p-0036" num="0035">As shown in <figref idref="DRAWINGS">FIG. 1</figref>, an embodiment of the present invention provides a method for identifying an SCTP packet, which includes the following steps:</p>
<p id="p-0037" num="0036">Step S<b>101</b>: Acquire a feature tuple of a received SCTP packet.</p>
<p id="p-0038" num="0037">In one embodiment, the feature tuple of the SCTP packet includes at least one piece of the following information in the SCTP packet: a source IP address, a destination IP address, and a V_tag. In another embodiment, the feature tuple of the SCTP packet can further include a source port number or a destination port number. In another embodiment, the feature tuple of the SCTP packet can further include the source port number and the destination port number.</p>
<p id="p-0039" num="0038">In one embodiment, if the SCTP packet is sent from a source end to a destination end, the V_tag is a V_tag from the source end to the destination end.</p>
<p id="p-0040" num="0039">In one embodiment, if the SCTP packet is sent from the destination end to the source end, the V_tag is a V_tag from the destination end to the source end.</p>
<p id="p-0041" num="0040">Step S<b>102</b>: Match the acquired feature tuple of the SCTP packet with a preset SCTP tuple identification table. The SCTP tuple identification table includes a mapping relation between a feature set tuple of the SCTP packet and an SCTP association.</p>
<p id="p-0042" num="0041">It is noted that, in one embodiment, the SCTP tuple identification table can further include an association relation, and the association relation is used to point to records of feature set tuples belonging to the same association.</p>
<p id="p-0043" num="0042">It is noted that, in one embodiment, in the SCTP tuple identification table, the SCTP association is identified with an association identifier or an application identifier, in which the association identifier is used to identify a sequence number of the SCTP association, and the application identifier is used to identify an application type borne by the SCTP association.</p>
<p id="p-0044" num="0043">In one embodiment, the feature set tuple in the SCTP tuple identification table includes at least one piece of the following information: a source IP address set, a destination IP address set, and the V_tag. In another embodiment, the feature set tuple can further include the source port number and the destination port number.</p>
<p id="p-0045" num="0044">It is noted that, in this embodiment and other embodiments of the present invention, the source IP address set includes all IP addresses available to the source end in the SCTP association, and the destination IP address set includes all IP addresses available to the destination end in the SCTP association. A V_tag is special for establishing an association, endpoints at two sides of the SCTP exchange V_tags at the time of establishing the association, and a value of the V_tag is determined during a first time of exchange at the time of SCTP handshake and remains unchanged during subsequent interaction.</p>
<p id="p-0046" num="0045">In one embodiment, during matching, the acquired feature tuple can be used as a key value, and matches the SCTP tuple identification table using a hash lookup method. As one specific lookup manner, the hash lookup method has a quick lookup advantage, and is capable of increasing a matching speed. It can be understood that, the hash lookup method is not a unique implementation manner for matching, so that the hash lookup manner as one example should not be understood as a limitation to the embodiment of the present invention.</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 4</figref> is a schematic structural view of an SCTP tuple identification table according to an embodiment of the present invention. According to <figref idref="DRAWINGS">FIG. 4</figref>, the SCTP tuple identification table includes a V_tag, a port, an application identifier (Application), an IP list, and an association relation (Relation). In the embodiment of the present invention, each SCTP tuple identification table entry in the SCTP tuple identification table is referred to as one record. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, each entry (record) of the SCTP table includes a V_tag, a port, an application identifier, an IP list, and an association relation. In <figref idref="DRAWINGS">FIG. 4</figref>, the V_tag is used to identify an SCTP packet. The IP list identifies one IP address set through one pointer, and the IP address set can be a source IP address set or a destination IP address set.</p>
<p id="p-0048" num="0047">In this embodiment, in the SCTP tuple identification table as shown in <figref idref="DRAWINGS">FIG. 4</figref>, a mapping relation between a feature set tuple of the SCTP packet and an SCTP association is denoted through the association relation. In Table 4, the association relation is used to associate records of feature set tuples belonging to the same association. In other words, the association relation associates two records, and identifies that the two records belong to the same SCTP association.</p>
<p id="p-0049" num="0048">In <figref idref="DRAWINGS">FIG. 4</figref>, according to this embodiment, one SCTP association is identified with an application identifier, and an application type borne by the association is capable of being acquired through the application identifier. Definitely, in another embodiment, the SCTP association can also be identified by an association identifier instead of the application identifier, and a sequence number of the SCTP association is capable of being acquired through the association identifier. At this time, in one embodiment, an information entry of one application identifier can be further added, so as to identify an application borne by the SCTP association.</p>
<p id="p-0050" num="0049">Definitely, in another embodiment, an IP address set can also, be directly placed in an IP list item without using a pointer. In another embodiment, two records having an association relation can be further merged into one record, as shown in <figref idref="DRAWINGS">FIG. 12</figref>. In <figref idref="DRAWINGS">FIG. 12</figref>, each record of the SCTP tuple identification table includes a source IP address set, a destination IP address set, a source port number, a destination port number, and a V_tag (for <figref idref="DRAWINGS">FIG. 12</figref>, in one embodiment, which can also be called a V_tag pair, that is, a V_tag from a source end to a destination end and a V_tag from a destination end to a source end in <figref idref="DRAWINGS">FIG. 12</figref>). In <figref idref="DRAWINGS">FIG. 12</figref>, each record represents one association. <figref idref="DRAWINGS">FIG. 4</figref> and <figref idref="DRAWINGS">FIG. 12</figref> are only used as examples of one SCTP tuple identification table according to the embodiment of the present invention, and the embodiment of the present invention does not impose a special limitation on the SCTP tuple identification table.</p>
<p id="p-0051" num="0050">In one embodiment, the V_tag is a V_tag from the source end to the destination end and/or from the destination end to the source end. For example, when a structure of the SCTP tuple identification table as shown in <figref idref="DRAWINGS">FIG. 4</figref> is adopted, a V_tag of one record in the table can be the V_tag from the source end to the destination end, and can also be the V_tag from the destination end to the source end. When a structure of the SCTP tuple identification table as described in <figref idref="DRAWINGS">FIG. 12</figref> is adopted, a V_tag of one record in the table is the V_tag from the source end to the destination end and the V_tag from the destination end to the source end.</p>
<p id="p-0052" num="0051">To more visually illustrate an association relation of two records, in <figref idref="DRAWINGS">FIG. 4</figref>, records belonging to the same SCTP association are connected and shown with arrows. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, an SCTP packet with a V_tag of 1254932544 and an SCTP packet with a V_tag of 8941172325 belong to the same SCTP association. An IP list in a record that corresponds to the SCTP packet with the V_tag of 1254932544 identifies a source IP address set through one pointer, and an IP list in a record that corresponds to the SCTP packet with the V_tag of 8941172325 identifies a destination IP address set through one pointer.</p>
<p id="p-0053" num="0052">When a new SCTP packet is received, a feature tuple of the SCTP packet can be acquired by parsing the SCTP packet. For example, in one embodiment, by parsing the received new SCTP packet, a source IP address of the SCTP packet is acquired to be 10.70.145.28. At this time, the acquired source IP address can be matched with the SCTP tuple identification table in <figref idref="DRAWINGS">FIG. 4</figref>, to obtain an SCTP association to which the SCTP packet belongs.</p>
<p id="p-0054" num="0053">Step S<b>103</b>: Acquire the SCTP association to which the SCTP packet belongs if the acquired feature tuple of the SCTP packet matches one or more records of the preset SCTP tuple identification table.</p>
<p id="p-0055" num="0054">In one embodiment, if the feature tuple of the SCTP packet matches the SCTP tuple identification table successfully, it indicates that the SCTP packet belongs to an existing SCTP association in the SCTP tuple identification table, so that the SCTP association to which the SCTP packet belongs can be acquired through a mapping relation between the feature set tuple of the SCTP packet and the SCTP association in the SCTP tuple identification table, that is, an SCTP data stream to which the SCTP packet belongs is acquired. Further, an application borne by the SCTP association to which the SCTP packet belongs can be further acquired through an application identifier in the SCTP tuple identification table. One SCTP association corresponds to one application, so that after an association to which one SCTP packet belongs is identified according to the method in this embodiment, subsequent packets belonging to the SCTP association bear the same application.</p>
<p id="p-0056" num="0055">For example, in one embodiment, an IP address of the SCTP packet with the IP address of 10.70.145.28 matches the SCTP tuple identification table in <figref idref="DRAWINGS">FIG. 4</figref>, a record that corresponds to the SCTP packet and a record having an association relation with the SCTP packet can be acquired (in <figref idref="DRAWINGS">FIG. 4</figref>, the record corresponding to the SCTP packet with the V_tag of 8941172325), so as to determine an SCTP association to which the SCTP packet belongs. Further, an application borne by the association to which the SCTP belongs is acquired through the application identifier, and subsequently, if other packets belonging to the SCTP association are identified, it is directly known that the packets bear an HTTP application.</p>
<p id="p-0057" num="0056">For example, according to <figref idref="DRAWINGS">FIG. 4</figref>, an application borne by the SCTP association to which the SCTP packet with the IP address of 10.70.145.28 belongs is an HTTP application. In one embodiment, after a packet with an IP address of 10.25.202.183 is matched, it is found that a record corresponding to the packet and the record corresponding to the SCTP packet with the IP address of 10.70.145.28 have an association relation and belong to the same SCTP association, and a corresponding application is an HTTP application.</p>
<p id="p-0058" num="0057">It is noted that, <figref idref="DRAWINGS">FIG. 4</figref> is only an example of one tuple identification table according to the embodiment of the present invention. The SCTP tuple identification table as shown in <figref idref="DRAWINGS">FIG. 4</figref> only provides a typical manner of realizing the SCTP tuple identification table, is not unique, and can be optimized and improved on the basis of the table. For example, in one embodiment, if such factors as erroneous identification, missed identification, and unnecessity of the acquisition of a corresponding application are not considered, only a V_tag and an association relation can also be used to organize the SCTP tuple identification table.</p>
<p id="p-0059" num="0058">Alternatively, in another embodiment, only an IP list and an association relation can also be used to organize the SCTP tuple identification table. The SCTP tuple identification table is preset, so that at this time, a feature tuple of an SCTP packet needs to be retrieved correspondingly according to a record in the SCTP tuple identification table. For example, if the SCTP tuple identification table is set only with the V_tag and the association relation, the V_tag of the received SCTP packet needs to be retrieved; and if the SCTP tuple identification table is set only with the IP list and the association relation, the source IP address or the destination IP address of the received SCTP packet needs to be retrieved.</p>
<p id="p-0060" num="0059">According to the embodiments of the present invention, through the foregoing technical solution, for a feature that the SCTP supports multi-homing, the SCTP tuple identification table including the mapping relation between the feature set tuple of the SCTP packet and the SCTP association is used to identify the SCTP packet. Because the SCTP feature set tuple includes the source IP address set, the destination IP address set, or the V_tag, the SCTP feature set tuple includes all interaction in one SCTP association. If the feature tuple of the SCTP packet such as the source IP address, the destination IP address, or the SCTP tag matches the feature set tuple successfully, the SCTP association to which the SCTP packet belongs can be acquired. As compared with the prior art in which all interaction in the same association cannot be completely identified when a conventional quintuple identifies an SCTP data stream, after a quintuple is used for switching in the SCTP association, the solution in this embodiment is still capable of correctly identifying an SCTP association to which a packet of the interaction belongs according to a matching result of the IP address set or the V_tag, so as to reduce missed identification.</p>
<p id="p-0061" num="0060">As shown in <figref idref="DRAWINGS">FIG. 2</figref>, an embodiment of the present invention provides a method for identifying an SCTP packet, which includes the following steps:</p>
<p id="p-0062" num="0061">Step S<b>110</b>: Judge a transmission protocol type of a received packet.</p>
<p id="p-0063" num="0062">In one embodiment, it can be judged whether the received packet is an SCTP packet by judging a type of a transmission layer protocol of the received packet. If the type of the transmission layer protocol is a TCP/UDP protocol, the received packet is an ordinary packet, and at this time, an ordinary quintuple can be used to identify the packet. If the type of the transmission layer protocol is an SCTP protocol, the received packet is an SCTP packet.</p>
<p id="p-0064" num="0063">Step S<b>120</b>: acquire a feature tuple of the SCTP packet, if the transmission protocol type is the SCTP protocol, and the received packet is the SCTP packet.</p>
<p id="p-0065" num="0064">In one embodiment, the feature tuple of the SCTP packet includes at least one piece of the following information in the SCTP packet: a source IP address, a destination IP address, and a V_tag. In one embodiment, the feature tuple can further include the source port number and the destination port number. In one embodiment, the feature tuple can further include all the information of the source IP address, the destination IP address, the source port number, the destination port number, and the V_tag.</p>
<p id="p-0066" num="0065">Step S<b>130</b>: Match the acquired feature tuple of the SCTP packet with a preset SCTP tuple identification table. The SCTP tuple identification table includes a mapping relation between a feature set tuple of the SCTP packet and an SCTP association.</p>
<p id="p-0067" num="0066">In one embodiment, during matching, the acquired feature tuple can be used as a key value, and matches the SCTP tuple identification table with a hash lookup method. As one specific lookup manner, the hash lookup method has a quick lookup advantage, and is capable of increasing a matching speed. It can be understood that, the hash lookup method is not a unique implementation manner for matching, so that the hash lookup manner as one example should not be understood as a limitation to the embodiment of the present invention.</p>
<p id="p-0068" num="0067">In one embodiment, the feature set tuple includes at least one piece of the following information: a source IP address set, a destination IP address set, a source port number, a destination port number, and a V_tag. In one embodiment, the feature set tuple can further include the source port number and the destination port number. In one embodiment, the feature set tuple can further include all the information of the source IP address set, the destination IP address set, the source port number, the destination port number, and the V_tag. A specific type of the V_tag is described in detail in the embodiment, and is not recited anymore here.</p>
<p id="p-0069" num="0068">Step S<b>140</b>: Acquire the SCTP association to which the SCTP packet belongs if the acquired feature tuple of the SCTP packet matches one or more records of the preset SCTP tuple identification table.</p>
<p id="p-0070" num="0069">In one embodiment, further, an application borne by the SCTP association to which the SCTP packet belongs can be further acquired through an application identifier in the SCTP tuple identification table.</p>
<p id="p-0071" num="0070">Step S<b>150</b>: Parse a current SCTP handshake message to obtain new feature set tuples having an association relation if the acquired feature tuple of the SCTP packet does not match one or more records of the preset SCTP tuple identification table, and add the feature set tuples into the SCTP tuple identification table as one or more new records.</p>
<p id="p-0072" num="0071">In one embodiment, if the acquired feature tuple of the SCTP packet does not match one or more records of the preset SCTP tuple identification table, it indicates that the SCTP packet is a SCTP handshake message for establishing a new connection, and belongs to one new SCTP data stream, and one or more new records needs to be added to identify the new SCTP data stream.</p>
<p id="p-0073" num="0072">In one embodiment, step S<b>150</b> can include the following steps:</p>
<p id="p-0074" num="0073">Step S<b>1501</b>: Acquire an SCTP handshake message. The handshake message includes an INIT packet and an INIT ACK packet belonging to the same new SCTP association.</p>
<p id="p-0075" num="0074">In one embodiment, a corresponding INIT ACK packet can be acquired through an IP list in the INIT packet, to obtain the SCTP handshake message, wherein the corresponding INIT ACK packet belongs to the same SCTP handshake message as the INIT packet. Specifically, in one embodiment, the IP list of the INIT packet can be parsed to obtain a destination IP of the INIT ACK packet. If the destination IP is located in the IP list of the INIT packet, it can be acknowledged that the INIT ACK packet and the INIT packet belong to the same SCTP association.</p>
<p id="p-0076" num="0075">Step S<b>1502</b>: Acquire a feature tuple of the INIT packet by parsing the INIT packet in the handshake message to obtain a feature tuple of the INIT ACK packet by parsing the INIT ACK packet in the handshake message.</p>
<p id="p-0077" num="0076">Step S<b>1503</b>: Acquire a source IP address set, a destination IP address set, a source port number, a destination port number, and a V_tag of a new SCTP association that corresponds to the current SCTP handshake message based on the feature tuples of the INIT packet and the feature tuples of the INIT ACK packet acquired by parsing.</p>
<p id="p-0078" num="0077">Step S<b>1504</b>: Associate source end data and destination end data acquired in step S<b>1503</b>, to obtain a record of the new SCTP association that corresponds to the current SCTP handshake message.</p>
<p id="p-0079" num="0078">Step S<b>1505</b>: Add the record of the new SCTP association into the SCTP tuple identification table.</p>
<p id="p-0080" num="0079">In another embodiment, step S<b>150</b> can include the following steps:</p>
<p id="p-0081" num="0080">Step S<b>1511</b>: Acquire the SCTP handshake message. The handshake message includes the INIT packet and the INIT ACK packet belonging to the same new SCTP association.</p>
<p id="p-0082" num="0081">Step S<b>1512</b>: Parse the INIT packet, and add information acquired by parsing to the SCTP tuple identification table as one record. The information acquired by parsing includes at least one piece of the following information: an IP address set, a port, and a V_tag of the INIT packet.</p>
<p id="p-0083" num="0082">After the information acquired by parsing the INIT packet is added to the SCTP tuple identification table as one record, the record does not have a record with an association relation in the SCTP tuple identification table, so that step S<b>1513</b> needs to be performed.</p>
<p id="p-0084" num="0083">Step S<b>1513</b>: Parse the INIT ACK packet to obtain an IP address set, a port, and a V_tag of the packet.</p>
<p id="p-0085" num="0084">Step S<b>1514</b>: Parse a common packet header of the SCTP packet to obtain a V_tag, and match the V_tag in the common packet header with the SCTP tuple identification table. A record whose V_tag matches the V_tag in a common packet header is a record that corresponds to the INIT packet in step S<b>1512</b>.</p>
<p id="p-0086" num="0085">Step S<b>1515</b>: Add the information acquired by parsing in step S<b>1515</b> to the SCTP tuple identification table as another record, and establish an association relation between the another record and the record acquired by matching in step S<b>1514</b>.</p>
<p id="p-0087" num="0086">It can be known from the foregoing content that, in the two embodiments, the INIT packet and the INIT ACK packet included in the current SCTP handshake message can be parsed to identify the new SCTP data stream. In another embodiment of the present invention, when the one or more new records are added into the SCTP tuple identification table in step S<b>150</b>, it is possible that only the INIT ACK packet is parsed. The INIT ACK packet carries V_tag of a source end and a destination end and port information of a source end and a destination end. By parsing the INIT ACK packet to obtain the V_tag and the port information of the source end and the destination end, the information of the source end and the destination end obtained by the parsing is associated and is added into the SCTP tuple identification table as two records of one association.</p>
<p id="p-0088" num="0087">As shown in <figref idref="DRAWINGS">FIG. 13</figref>, an embodiment of the present invention provides a method for establishing an SCTP tuple identification table, which includes the following steps.</p>
<p id="p-0089" num="0088">Step S<b>401</b>: Acquire an SCTP handshake message on an SCTP association. The SCTP handshake message includes an INIT packet and an INIT ACK packet that corresponds to the INIT packet.</p>
<p id="p-0090" num="0089">Step S<b>402</b>: Acquire an SCTP feature set tuple from a pair of the INIT packet and the INIT ACK packet. The SCTP feature set tuple includes at least one piece of the following information: a source IP address set, a destination IP address set, a source port number, a destination port number, and a V_tag.</p>
<p id="p-0091" num="0090">Specifically, in one embodiment, step S<b>402</b> can include the following steps.</p>
<p id="p-0092" num="0091">Step S<b>4021</b>: Parse the INIT ACK packet to obtain a source IP address, a destination IP address, a source port number, a destination port number, and a V_tag from a source end to a destination end of the SCTP association.</p>
<p id="p-0093" num="0092">Step S<b>4022</b>: Parse the INIT ACK packet to obtain a destination IP address, a source IP address, a source port number, a destination port number, and a V_tag from the destination end to the source end of the SCTP association.</p>
<p id="p-0094" num="0093">Step S<b>4023</b>: according to information acquired by parsing the INIT packet and the INIT ACK, acquire the feature set tuple of the SCTP association.</p>
<p id="p-0095" num="0094">Step S<b>403</b>: Establish a mapping relation between the feature set tuple and the SCTP association.</p>
<p id="p-0096" num="0095">In one embodiment, step S<b>403</b> can include the following steps.</p>
<p id="p-0097" num="0096">Source end data and destination end data acquired in step S<b>402</b> are associated, to obtain a record of the new SCTP association that corresponds to the current SCTP handshake message.</p>
<p id="p-0098" num="0097">In one embodiment, step S<b>403</b> can include the following steps.</p>
<p id="p-0099" num="0098">Step S<b>4031</b>: Add the information acquired by parsing in step S<b>4021</b> to the SCTP tuple identification table as one record.</p>
<p id="p-0100" num="0099">Step S<b>4032</b>: Parse a common packet header of the SCTP packet on the SCTP association to obtain a V_tag, and match the V_tag in the common packet header with the SCTP tuple identification table. A record whose V_tag matches the V_tag in a common packet header is a record that corresponds to the INIT packet in step S<b>4031</b>.</p>
<p id="p-0101" num="0100">Step S<b>4033</b>: Add the information acquired by parsing in step S<b>4022</b> to the SCTP tuple identification table as another record, and establish an association relation between the another record and the record acquired by matching in step S<b>4032</b>.</p>
<p id="p-0102" num="0101">According to the embodiments of the present invention, through the foregoing technical solution, for a feature that the SCTP supports multi-homing, the SCTP tuple identification table including the mapping relation between the feature set tuple of the SCTP packet and the SCTP association is used to identify the SCTP packet. Because the SCTP feature set tuple includes the source IP address set, the destination IP address set, or the V_tag, the SCTP feature set tuple includes all interaction in one SCTP association. If the feature tuple of the SCTP packet such as the source IP address, the destination IP address, or the SCTP tag matches the feature set tuple successfully, the SCTP association to which the SCTP packet belongs can be acquired. As compared with the prior art in which all interaction in the same association cannot be completely identified when a conventional quintuple identifies an SCTP data stream, after a quintuple is used for switching in the SCTP association, the solution in this embodiment is still capable of correctly identifying an SCTP association to which a packet of the interaction belongs according to a matching result of the IP address set or the V_tag, so as to reduce missed identification. Furthermore, a packet matched with the SCTP tuple identification table unsuccessfully is parsed, and a result acquired by parsing is updated as a record in the SCTP tuple identification table, thereby facilitating subsequent identification of a packet belonging to the same SCTP association.</p>
<p id="p-0103" num="0102">As shown in <figref idref="DRAWINGS">FIG. 3</figref>, on the basis of the corresponding embodiment based on <figref idref="DRAWINGS">FIG. 2</figref>, an SCTP data stream identification method according to the embodiment of the present invention can further include the following steps:</p>
<p id="p-0104" num="0103">Step S<b>160</b>: Identify an application type borne by the SCTP association to which the SCTP packet belongs if the acquired feature tuple of the SCTP packet does not match one or more records of the preset SCTP tuple identification table.</p>
<p id="p-0105" num="0104">In one embodiment, a service identification technology (such as a Deep Packet Inspection (DPI) technology) can be used to identify an SCTP data stream, that is, the application type borne by the SCTP association.</p>
<p id="p-0106" num="0105">Step S<b>170</b>: Label the one or more new records with an application identifier, in which the application identifier corresponds to the application type.</p>
<p id="p-0107" num="0106">In one embodiment, the application type is associated with the corresponding association, and a corresponding record is labeled with the application identifier in the SCTP tuple identification table, so that it is convenient for a subsequent packet of the SCTP data stream to directly find a corresponding record through the SCTP tuple identification table to acquire a service type borne by the SCTP.</p>
<p id="p-0108" num="0107">Step S<b>180</b>: Perform aging processing on the SCTP tuple identification table according to a preset period, and delete a record not used anymore in the SCTP tuple identification table.</p>
<p id="p-0109" num="0108">In one embodiment, the received SCTP packet can be parsed, and if the received SCTP packet is an SCTP shutdown packet (such as SHUTDOWN, SHUTDOWN ACK, or ABORT), a corresponding record is deleted from the SCTP tuple identification table.</p>
<p id="p-0110" num="0109">In one embodiment, a count recording the number of times corresponding records are matched successfully in the SCTP tuple identification table can be periodically checked, and if the count of the corresponding records is not increased, the records whose count does not increase is deleted in the SCTP tuple identification table.</p>
<p id="p-0111" num="0110">In one embodiment, a timestamp recording time at which corresponding records are matched successfully in the SCTP tuple identification table can be periodically checked, and a record whose timestamp exceeds a preset aging time is deleted.</p>
<p id="p-0112" num="0111">It is noted that, in one embodiment, when the SCTP tuple identification table is pre-established, the adopted method is similar to steps S<b>1501</b> to S<b>1504</b> or steps S<b>1511</b> to S<b>1515</b>, and is not recited anymore here. In another embodiment, when the SCTP tuple identification table is pre-established, the method in steps S<b>160</b> to S<b>170</b> can be further adopted, to identify an application corresponding to one SCTP association and use a corresponding application identifier to identify the SCTP association, and is not recited anymore here.</p>
<p id="p-0113" num="0112">According to the embodiments of the present invention, through the foregoing technical solution, for a feature that the SCTP supports multi-homing, the SCTP tuple identification table including the mapping relation between the feature set tuple of the SCTP packet and the SCTP association is used to identify the SCTP packet. Because the SCTP feature set tuple includes the source IP address set, the destination IP address set, or the V_tag, the SCTP feature set tuple includes all interaction in one SCTP association. If the feature tuple of the SCTP packet such as the source IP address, the destination IP address, or the SCTP tag matches the feature set tuple successfully, the SCTP association to which the SCTP packet belongs can be acquired. As compared with the prior art in which all interaction in the same association cannot be completely identified when a conventional quintuple identifies an SCTP data stream, after a quintuple is used for switching in the SCTP association, the solution in this embodiment is still capable of correctly identifying an SCTP association to which a packet of the interaction belongs according to a matching result of the IP address set or the V_tag, so as to reduce missed identification. Furthermore, a packet matched with the SCTP tuple identification table unsuccessfully is parsed, and a result acquired by parsing is updated as a record in the SCTP tuple identification table, thereby facilitating subsequent identification of a packet belonging to the same SCTP association. Further, the service identification technology identifies the application borne by the new SCTP association, thereby facilitating subsequent identification of an application borne by an SCTP packet belonging to the same SCTP association, and by aging maintaining the SCTP tuple identification table and timely deleting a record not used anymore in the SCTP tuple identification table, identification efficiency is increased.</p>
<p id="p-0114" num="0113">As shown in <figref idref="DRAWINGS">FIG. 5</figref>, an embodiment of the present invention provides a device for identifying an SCTP packet, which includes a first acquiring module <b>210</b>, a matching module <b>220</b>, and a second acquiring module <b>230</b>.</p>
<p id="p-0115" num="0114">The first acquiring module <b>210</b> is configured to acquire a feature tuple of a received SCTP packet.</p>
<p id="p-0116" num="0115">In one embodiment, the feature tuple of the SCTP packet includes at least one piece of the following information in the SCTP packet: a source IP address, a destination IP address, and a V_tag. In one embodiment, the feature tuple can further include a source port number and a destination port number. In one embodiment, the feature set tuple can further include all the information of the source IP address, the destination IP address, the source port number, the destination port number, and the V_tag.</p>
<p id="p-0117" num="0116">The matching module <b>220</b> is configured to match the acquired feature tuple of the SCTP packet with a preset SCTP tuple identification table. The SCTP tuple identification table includes a mapping relation between a feature set tuple of the SCTP packet and an SCTP association.</p>
<p id="p-0118" num="0117">In one embodiment, the feature set tuple includes at least one piece of the following information: a source IP address set, a destination IP address set, a source port number, a destination port number, and a V_tag. In one embodiment, the feature set tuple can further include the source port number and the destination port number. In one embodiment, the feature set tuple can further include all the information of the source IP address set, the destination IP address set, the source port number, the destination port number, and the V_tag.</p>
<p id="p-0119" num="0118">The second acquiring module <b>230</b> is configured to acquire an SCTP association to which the SCTP packet belongs, if the matching module <b>220</b> performs matching successfully.</p>
<p id="p-0120" num="0119">In one embodiment, if the feature tuple of the SCTP packet matches the SCTP tuple identification table successfully, it indicates that the SCTP packet belongs to an existing SCTP association in the SCTP tuple identification table, so that the second acquiring module <b>230</b> can acquire the SCTP association to which the SCTP packet belongs through a mapping relation between the feature set tuple of the SCTP packet and the SCTP association in the SCTP tuple identification table, that is, an SCTP data stream to which the SCTP packet belongs is acquired.</p>
<p id="p-0121" num="0120">As shown in a dashed line frame in <figref idref="DRAWINGS">FIG. 5</figref>, in one embodiment, the device further includes a third acquiring module <b>231</b>.</p>
<p id="p-0122" num="0121">The third acquiring module <b>231</b> is configured to acquire an application borne by the SCTP association to which the SCTP packet belongs, according to the application identifier corresponding to the SCTP association to which the SCTP packet belongs.</p>
<p id="p-0123" num="0122">According to the embodiments of the present invention, through the foregoing technical solution, for a feature that the SCTP supports multi-homing, the SCTP tuple identification table including the mapping relation between the feature set tuple of the SCTP packet and the SCTP association is used to identify the SCTP packet. Because the SCTP feature set tuple includes the source IP address set, the destination IP address set, or the V_tag, the SCTP feature set tuple includes all interaction in one SCTP association. If the feature tuple of the SCTP packet such as the source IP address, the destination IP address, or the SCTP tag matches the feature set tuple successfully, the SCTP association to which the SCTP packet belongs can be acquired. As compared with the prior art in which all interaction in the same association cannot be completely identified when a conventional quintuple identifies an SCTP data stream, after a quintuple is used for switching in the SCTP association, the solution in this embodiment is still capable of correctly identifying an SCTP association to which a packet of the interaction belongs according to a matching result of the IP address set or the V_tag, so as to reduce missed identification. Further, the application borne by the received SCTP packet can be further acquired through a service identifier in the SCTP tuple identification table.</p>
<p id="p-0124" num="0123">As shown in <figref idref="DRAWINGS">FIG. 6</figref>, in one embodiment, the device can further include a parsing and adding module <b>240</b>, an application identification module <b>250</b>, and a service adding module <b>260</b>.</p>
<p id="p-0125" num="0124">The parsing and adding module <b>240</b> is configured to parse a current SCTP handshake message to obtain new feature set tuples having an association relation if the acquired feature tuple of the SCTP packet does not match one or more records of the preset SCTP tuple identification table by the matching module <b>220</b>, and add the feature set tuples into the SCTP tuple identification table as one or more new records.</p>
<p id="p-0126" num="0125">The application identification module <b>250</b> is configured to identify an application type borne by an SCTP data stream to which the SCTP packet belongs, if the acquired feature tuple of the SCTP packet does not match one or more records of the preset SCTP tuple identification table by the matching module <b>220</b>.</p>
<p id="p-0127" num="0126">In one embodiment, the DPI technology can be used to identify the application type borne by the SCTP data stream.</p>
<p id="p-0128" num="0127">The service adding module <b>260</b> is configured to label the one or more new records with an application identifier. The application identifier corresponds to the application type.</p>
<p id="p-0129" num="0128">As shown in <figref idref="DRAWINGS">FIG. 7</figref>, in one embodiment, the parsing and adding module <b>240</b> can include a message acquiring unit <b>2401</b>, a first parsing unit <b>2402</b>, a second parsing unit <b>2403</b>, an acquiring unit <b>2404</b>, an association unit <b>2405</b>, and an adding unit <b>2406</b>.</p>
<p id="p-0130" num="0129">The message acquiring unit <b>2401</b> is configured to acquire an SCTP handshake message. The handshake message includes an INIT packet and an INIT ACK packet belonging to the same new SCTP association.</p>
<p id="p-0131" num="0130">In one embodiment, the message acquiring unit <b>2401</b> can acquire the INIT ACK packet corresponding to the handshake message belonging to the same SCTP association through an IP list in the INIT packet, to obtain the SCTP handshake message.</p>
<p id="p-0132" num="0131">The first parsing unit <b>2402</b> is configured to acquire a feature tuple of the INIT packet by parsing the INIT packet in the handshake message.</p>
<p id="p-0133" num="0132">The second parsing unit <b>2403</b> is configured to acquire a feature tuple of the INIT ACK packet by parsing the INIT ACK packet in the handshake message.</p>
<p id="p-0134" num="0133">The acquiring unit <b>2404</b> is configured to acquire a source IP address set, a destination IP address set, a source port number, a destination port number, and a V_tag of a new SCTP association that corresponds to the current SCTP handshake message, based on the feature tuples of the INIT packet and the feature tuples of the INIT ACK packet acquired by parsing.</p>
<p id="p-0135" num="0134">The association unit <b>2405</b> is configured to associate source end data with destination end data acquired in the acquiring unit <b>2404</b>, to obtain a record of the new SCTP association.</p>
<p id="p-0136" num="0135">The adding unit <b>2406</b> is configured to add the record having an association relation into the SCTP tuple identification table.</p>
<p id="p-0137" num="0136">As shown in <figref idref="DRAWINGS">FIG. 8</figref>, in another embodiment, the parsing and adding module <b>240</b> can include a message acquiring unit <b>2401</b>, a third parsing unit <b>241</b>, a fourth parsing unit <b>242</b>, a parsing and matching unit <b>243</b>, and an association establishing unit <b>244</b>.</p>
<p id="p-0138" num="0137">The message acquiring unit <b>2401</b> is configured to acquire an SCTP handshake message. The handshake message includes an INIT packet and an INIT ACK packet belonging to the same new SCTP association.</p>
<p id="p-0139" num="0138">The third parsing unit <b>241</b> is configured to parse the INIT packet, and add information acquired by the parsing into the SCTP tuple identification table as one record. The information acquired by parsing includes at least one piece of the following information: an IP address set, a port, and a V_tag of the INIT packet.</p>
<p id="p-0140" num="0139">The fourth parsing unit <b>242</b> is configured to parse the INIT ACK packet to obtain an IP address set, a port, and a V_tag of the packet.</p>
<p id="p-0141" num="0140">The parsing and matching unit <b>243</b> is configured to parse a common packet header of the SCTP packet to obtain a V_tag, and match the V_tag in the common packet header with the SCTP tuple identification table. A record whose V_tag matches the V_tag in a common packet header is a record that corresponds to the INIT packet in the first parsing unit <b>241</b>.</p>
<p id="p-0142" num="0141">The association establishing unit <b>244</b> is configured to add the information acquired by parsing in the second parsing unit <b>242</b> to the SCTP tuple identification table as another record, and establish an association relation between the another record and the record acquired by matching in the parsing and matching unit <b>243</b>.</p>
<p id="p-0143" num="0142">According to the embodiments of the present invention, through the foregoing technical solution, for a feature that the SCTP supports multi-homing, the SCTP tuple identification table including the mapping relation between the feature set tuple of the SCTP packet and the SCTP association is used to identify the SCTP packet. Because the SCTP feature set tuple includes the source IP address set, the destination IP address set, or the V_tag, the SCTP feature set tuple includes all interaction in one SCTP association. If the feature tuple of the SCTP packet such as the source IP address, the destination IP address, or the SCTP tag matches the foregoing feature set tuple successfully, the SCTP association to which the SCTP packet belongs can be acquired. As compared with the prior art in which all interaction in the same association cannot be completely identified when a conventional quintuple identifies an SCTP data stream, after a quintuple is used for switching in the SCTP association, the solution in this embodiment is still capable of correctly identifying an SCTP association to which a packet of the interaction belongs according to a matching result of the IP address set or the V_tag, so as to reduce missed identification. Furthermore, a packet matched with the SCTP tuple identification table unsuccessfully is parsed, and a result acquired by parsing is updated as a record in the SCTP tuple identification table, thereby facilitating subsequent identification of a packet belonging to the same SCTP association. Further, the service identification technology identifies the application borne by the new SCTP association, thereby facilitating subsequent identification of an application borne by an SCTP packet belonging to the same SCTP association.</p>
<p id="p-0144" num="0143">As shown in <figref idref="DRAWINGS">FIG. 9</figref>, in another embodiment, the device can further include a maintenance module <b>270</b>.</p>
<p id="p-0145" num="0144">The maintenance module <b>270</b> is configured to perform aging processing on the SCTP tuple identification table according to a preset period, and delete the record not used anymore in the SCTP tuple identification table.</p>
<p id="p-0146" num="0145">As shown in <figref idref="DRAWINGS">FIG. 10</figref>, in one embodiment, the maintenance module <b>270</b> includes a first maintenance unit <b>271</b>, a second maintenance unit <b>272</b>, or a third maintenance unit <b>273</b>.</p>
<p id="p-0147" num="0146">The first maintenance unit <b>271</b> is configured to parse the received SCTP packet, and delete a corresponding record from the SCTP tuple identification table, if the received SCTP packet is an SCTP shutdown packet (such as SHUTDOWN, SHUTDOWN ACK, or ABORT).</p>
<p id="p-0148" num="0147">The second maintenance unit <b>272</b> is configured to periodically check a count recording the number of times corresponding records are matched successful in the SCTP tuple identification table, and delete a record in the SCTP tuple identification table if the count of the corresponding records is not increased, that is, delete a record whose count does not increase.</p>
<p id="p-0149" num="0148">The third maintenance unit <b>273</b> is configured to periodically check a timestamp recording time at which corresponding records are matched successfully in the SCTP tuple identification table, and delete a record whose timestamp exceeds a preset aging time.</p>
<p id="p-0150" num="0149">According to the embodiments of the present invention, through the foregoing technical solution, for a feature that the SCTP supports multi-homing, the SCTP tuple identification table including the mapping relation between the feature set tuple of the SCTP packet and the SCTP association is used to identify the SCTP packet. Because the SCTP feature set tuple includes the source IP address set, the destination IP address set, or the V_tag, the SCTP feature set tuple includes all interaction in one SCTP association. If the feature tuple of the SCTP packet such as the source IP address, the destination IP address, or the SCTP tag matches the foregoing feature set tuple successfully, the SCTP association to which the SCTP packet belongs can be acquired. As compared with the prior art in which all interaction in the same association cannot be completely identified when a conventional quintuple identifies an SCTP data stream, after a quintuple is used for switching in the SCTP association, the solution in this embodiment is still capable of correctly identifying an SCTP association to which a packet of the interaction belongs according to a matching result of the IP address set or the V_tag, so as to reduce missed identification. Furthermore, a packet matched with the SCTP tuple identification table unsuccessfully is parsed, and a result acquired by parsing is updated as a record in the SCTP tuple identification table, thereby facilitating subsequent identification of a packet belonging to the same SCTP association. Further, the service identification technology identifies the application borne by the new SCTP association, thereby facilitating subsequent identification of an application borne by an SCTP packet belonging to the same SCTP association, and by aging maintaining the SCTP tuple identification table and timely deleting a record not used anymore in the SCTP tuple identification table, identification efficiency is increased.</p>
<p id="p-0151" num="0150">As shown in <figref idref="DRAWINGS">FIG. 11</figref>, an embodiment of the present invention provides a system for identifying an SCTP packet, which includes a receiving device <b>10</b> and a device for identifying an SCTP packet <b>20</b>.</p>
<p id="p-0152" num="0151">The receiving device <b>10</b> is configured to receive a packet.</p>
<p id="p-0153" num="0152">The device for identifying an SCTP packet <b>20</b> is configured to acquire a feature tuple of a received SCTP packet when the receiving device <b>10</b> receives the SCTP packet, in which the feature tuple includes at least one piece of the following information: a source IP address, a destination IP address, and a V_tag; match the acquired feature tuple of the SCTP packet with a preset SCTP tuple identification table, in which the SCTP tuple identification table includes a mapping relation between a feature set tuple of the SCTP packet and an SCTP association, and the feature set tuple includes at least one piece of the following information: a source IP address set, a destination IP address set, and the V_tag; and acquire the SCTP association to which the SCTP packet belongs, if the acquired feature tuple of the SCTP packet matches one or more records of the preset SCTP tuple identification table.</p>
<p id="p-0154" num="0153">In one embodiment, the feature tuple can further include a source port number and a destination port number. In one embodiment, the feature tuple can further include all the information of the source IP address, the destination IP address, the source port number, the destination port number, and the V_tag.</p>
<p id="p-0155" num="0154">In one embodiment, the feature set tuple can further include the source port number and the destination port number. In one embodiment, the feature set tuple can further include all the information of the source IP address set, the destination IP address set, the source port number, the destination port number, and the V_tag.</p>
<p id="p-0156" num="0155">A structure and functions of the device for identifying an SCTP packet <b>20</b> are as described in the device embodiment, and are not recited anymore here.</p>
<p id="p-0157" num="0156">According to the embodiments of the present invention, through the foregoing technical solution, for a feature that the SCTP supports multi-homing, the SCTP tuple identification table including the mapping relation between the feature set tuple of the SCTP packet and the SCTP association is used to identify the SCTP packet. Because the SCTP feature set tuple includes the source IP address set, the destination IP address set, or the V_tag, the SCTP feature set tuple includes all interaction in one SCTP association. If the feature tuple of the SCTP packet such as the source IP address, the destination IP address, or the SCTP tag matches the foregoing feature set tuple successfully, the SCTP association to which the SCTP packet belongs can be acquired. As compared with the prior art in which all interaction in the same association cannot be completely identified when a conventional quintuple identifies an SCTP data stream, after a quintuple is used for switching in the SCTP association, the solution in this embodiment is still capable of correctly identifying an SCTP association to which a packet of the interaction belongs according to a matching result of the IP address set or the V_tag, so as to reduce missed identification.</p>
<p id="p-0158" num="0157">An embodiment of the present invention also provides a method for identifying an SCTP packet, which includes the following steps:</p>
<p id="p-0159" num="0158">acquiring a feature tuple of a received SCTP packet, wherein the feature tuple comprises at least one piece of the following information: a source Internet Protocol (IP) address, a destination IP address, and a verification tag (V_tag);</p>
<p id="p-0160" num="0159">matching the acquired feature tuple of the SCTP packet with a SCTP tuple identification table, wherein the SCTP tuple identification table comprises: multiple records of a feature set tuple, the one or more records from the multiple records of the feature set tuple represent a first SCTP association, and the feature set tuple comprises at least one piece of the following information: a source IP address set, a destination IP address set, and a V_tag; and</p>
<p id="p-0161" num="0160">determining that the received SCTP packet is one of SCTP packets interacted on the first SCTP association, if the acquired feature tuple of the SCTP packet matches the one or more records which represent the first SCTP association.</p>
<p id="p-0162" num="0161">In this embodiment, if the one or more records which represent the first SCTP association is labeled with an application identifier, and the application identifier is used to identify an application type borne by the first SCTP association;</p>
<p id="p-0163" num="0162">the process of determining that the received SCTP packet is one of SCTP packets interacted on the first SCTP association, if the acquired feature tuple of the SCTP packet matches the one or more records which represent the first SCTP association, includes:</p>
<p id="p-0164" num="0163">determining that the received SCTP packet is one of SCTP packets interacted on the first SCTP association if the acquired feature tuple of the SCTP packet matches the one or more records which represent the first SCTP association; and acquiring the application type of the received SCTP packet based on the application identifier with which the one or more records which represent the first SCTP association is labeled.</p>
<p id="p-0165" num="0164">In this embodiment, the method further includes: establishing the SCTP tuple identification table, where the establishing the SCTP tuple identification table includes:</p>
<p id="p-0166" num="0165">acquiring an SCTP handshake message on the first SCTP association, wherein the SCTP handshake message comprises an initialization (INIT) packet and an initialization acknowledgement (INIT ACK) packet that corresponds to the INIT packet;</p>
<p id="p-0167" num="0166">parsing the INIT packet to obtain a source IP address, a destination IP address, a source port number, a destination port number, and a V_tag from a source end to a destination end of the first SCTP association;</p>
<p id="p-0168" num="0167">parsing the INIT ACK packet to obtain a destination IP address, a source IP address, a source port number, a destination port number, and a V_tag from the destination end to the source end of the first SCTP association;</p>
<p id="p-0169" num="0168">acquiring a feature set tuple of the first SCTP association based on information acquired by parsing the INIT packet and the INIT ACK packet, wherein the feature set tuple comprises at least one piece of the following information: a source Internet Protocol (IP) address set, a destination IP address set, a source port number, a destination port number, and a verification tag (V_tag); and</p>
<p id="p-0170" num="0169">adding the acquired feature set tuples into the SCTP tuple identification table as one or more records, wherein the one or more records represent the first SCTP association.</p>
<p id="p-0171" num="0170">The specific details of the above process may be made reference to the descriptions in the foregoing method embodiments.</p>
<p id="p-0172" num="0171">An embodiment of the present invention also provides a device for identifying an SCTP packet, which includes:</p>
<p id="p-0173" num="0172">a first acquiring module, configured to acquire a feature tuple of a received SCTP packet, wherein the feature tuple comprises at least one piece of the following information: a source Internet Protocol (IP) address, a destination IP address, and a verification tag (V_tag);</p>
<p id="p-0174" num="0173">a matching module, configured to match the acquired feature tuple of the SCTP packet with a SCTP tuple identification table, wherein the SCTP tuple identification table comprises: multiple records of a feature set tuple, the one or more records from the multiple records of the feature set tuple represent a first SCTP association, and the feature set tuple comprises at least one piece of the following information: a source IP address set, a destination IP address set, and a V_tag; and</p>
<p id="p-0175" num="0174">a second acquiring module, configured to determine that the received SCTP packet is one of SCTP packets interacted on the first SCTP association, if the acquired feature tuple of the SCTP packet matches the one or more records which represent the first SCTP association.</p>
<p id="p-0176" num="0175">The specific implementations of the above functional module may be made reference to the descriptions in the foregoing method embodiments.</p>
<p id="p-0177" num="0176">Persons having ordinary skill in the art may understand that all or part of the steps of the method according to the embodiments of the present invention may be implemented by a program instructing relevant hardware. The program may be stored in a computer readable storage medium. When the program runs, the steps of the method according to the embodiments of the present invention are performed. The storage medium may be a magnetic disk, an optical disk, a read-only memory (ROM), or a random access memory (RAM).</p>
<p id="p-0178" num="0177">The foregoing description is only several embodiments of the present invention, and persons skilled in the art may make various changes or transformations to the present invention according to what is published in the application document without departing from the spirit and scope of the present invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for identifying a Stream Control Transmission Protocol (SCTP) packet, the method comprising:
<claim-text>acquiring a feature tuple of a received SCTP packet, wherein the feature tuple comprises at least one piece of the following information: a source Internet Protocol (IP) address, a destination IP address, and a verification tag (V_tag); wherein the feature tuple further comprises an association relation, wherein the association relation is used to-associate records of feature set tuples belonging to the same association;</claim-text>
<claim-text>matching the acquired feature tuple of the SCTP packet with a SCTP tuple identification table, wherein the SCTP tuple identification table comprises a mapping relation between a feature set tuple and an SCTP association, and the feature set tuple comprises at least one piece of the following information: a source IP address set, a destination IP address set, and the V_tag; and</claim-text>
<claim-text>acquiring the SCTP association to which the SCTP packet belongs, if the acquired feature tuple of the SCTP packet matches one or more records of the SCTP tuple identification table;</claim-text>
<claim-text>parsing a current SCTP handshake message to obtain new feature set tuples having an association relation if the acquired feature tuple of the SCTP packet does not match one or more records of the SCTP tuple identification table, and adding the feature set tuples into the SCTP tuple identification table as one or more new records, wherein the received SCTP packet is the current SCTP handshake message;</claim-text>
<claim-text>identifying an application type borne by the SCTP association to which the SCTP packet belongs; and</claim-text>
<claim-text>labeling the one or more new records with an application identifier, wherein the application identifier corresponds to the application type.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the V_tag comprises:
<claim-text>the V_tag from a source end to a destination end and/or the V_tag from a destination end to a source end.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the feature tuple further comprises a source port or a destination port; and the feature set tuple further comprises a source port number and a destination port number.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the SCTP association is identified with an association identifier or an application identifier, the association identifier is used to identify a sequence number of the SCTP association, and the application identifier is used to identify an application type borne by the SCTP association.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>performing aging processing on the SCTP tuple identification table according to a preset period, and deleting the record not used anymore in the SCTP tuple identification table; and the performing the aging processing on the SCTP tuple identification table according to the preset period, and deleting the record not used anymore in the SCTP tuple identification table comprises:</claim-text>
<claim-text>parsing the received SCTP packet, and deleting a record that corresponds to the SCTP packet from the SCTP tuple identification table if the received SCTP packet is an SCTP shutdown packet; or,</claim-text>
<claim-text>periodically checking a count recording the number of times corresponding records are matched successful in the SCTP tuple identification table, and deleting a record whose count does not increase; or,</claim-text>
<claim-text>periodically checking a timestamp recording time at which corresponding records are matched successfully in the SCTP tuple identification table, and deleting a record whose timestamp exceeds a preset aging time.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein parsing the current SCTP handshake message to obtain the new feature set tuples having the association relation, and adding the feature set tuples into the SCTP tuple identification table as the one or more new records comprises:
<claim-text>parsing an initialization (INIT) packet included in the current SCTP handshake message to obtain a feature tuple of the INIT packet;</claim-text>
<claim-text>parsing an initialization acknowledgement (INIT ACK) packet included in the current SCTP handshake message to obtain a feature tuple of the INIT ACK packet;</claim-text>
<claim-text>acquiring a source IP address set, a destination IP address set, a source port number, a destination port number, and a V_tag of a new SCTP association that corresponds to the current SCTP handshake message, based on the feature tuples of the INIT packet and the INIT ACK packet;</claim-text>
<claim-text>associating source end data of the new SCTP association that corresponds to the current SCTP handshake message with destination end data of the new SCTP association that corresponds to the current SCTP handshake message to obtain a record of the new SCTP association, wherein the source end data comprises: a source IP address set, a source port number, and a V_tag from a source end to a destination end of the new SCTP association that corresponds to the current SCTP handshake message; and the destination end data comprises: a destination IP address set, a destination port number, and a V_tag from a destination end to a source end of the new SCTP association that corresponds to the current SCTP handshake message; and</claim-text>
<claim-text>adding the record of the new SCTP association into the SCTP tuple identification table.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein parsing the current SCTP handshake message to obtain the new feature set tuples having the association relation, and adding the feature set tuples into the SCTP tuple identification table as the one or more new records comprises:
<claim-text>parsing an INIT packet included in the current SCTP handshake message, and adding information acquired by the parsing into the SCTP tuple identification table as one record, wherein the information acquired by parsing comprises at least one piece of the following information: an IP address set, a port, and a V_tag of the INIT packet;</claim-text>
<claim-text>parsing an INIT ACK packet included in the current SCTP handshake message to obtain the IP address set, the port, and the V_tag of the INIT packet;</claim-text>
<claim-text>parsing a common packet header of the SCTP packet to obtain a V_tag, and matching the V_tag in the common packet header with the SCTP tuple identification table, wherein a record whose V_tag matches the V_tag in a common packet header is a record that corresponds to the INIT packet; and</claim-text>
<claim-text>adding the IP address set, the port, and the Vtag acquired by parsing the INIT ACK packet included in the current SCTP handshake message to the SCTP tuple identification table as another record, and establishing an association relation between the another record and the record that corresponds to the INIT packet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A device executed by a processor for identifying a Stream Control Transmission Protocol (SCTP) packet, the device comprising:
<claim-text>a first acquiring hardware module, configured to acquire a feature tuple of a received SCTP packet, wherein the feature tuple comprises at least one piece of the following information: a source Internet Protocol (IP) address, a destination IP address, and a verification tag (V_tag);</claim-text>
<claim-text>a matching hardware module, configured to match the acquired feature tuple of the SCTP packet with a SCTP tuple identification table, wherein the SCTP tuple identification table comprises a mapping relation between a feature set tuple and an SCTP association, and the feature set tuple comprises at least one piece of the following information: a source IP address set, a destination IP address set, and a V_tag; and</claim-text>
<claim-text>a second acquiring hardware module, configured to acquire an SCTP association to which the SCTP packet belongs, if the acquired feature tuple of the SCTP packet matches one or more records of the SCTP tuple identification table by the matching hardware module;</claim-text>
<claim-text>a parsing and adding hardware module, configured to parse a current SCTP handshake message to obtain new feature set tuples having an association relation if the acquired feature tuple of the SCTP packet does not match one or more records of the SCTP tuple identification table by the matching hardware module, and add the feature set tuples into the SCTP tuple identification table as one or more new records, wherein the received SCTP packet is the current SCTP handshake message;</claim-text>
<claim-text>an application identification hardware module, configured to identify an application type borne by the SCTP association to which the SCTP packet belongs; and a service adding hardware module, configured to label the one or more new records with an application identifier, wherein the application identifier corresponds to the application type.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The device according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the parsing and adding hardware module comprises:
<claim-text>a first parsing hardware unit, configured to parse an initialization (INIT) packet included in the current SCTP handshake message to obtain a feature tuple of the INIT packet;</claim-text>
<claim-text>a second parsing hardware unit, configured to parse an initialization acknowledgement (INIT ACK) packet included in the current SCTP handshake message to obtain a feature tuple of the INIT ACK packet;</claim-text>
<claim-text>an acquiring hardware unit, configured to acquire a source IP address set, a destination IP address set, a source port number, a destination port number, and a V_tag of a new SCTP association that corresponds to the current SCTP handshake message, based on the feature tuples of the INIT packet and the INIT ACK packet;</claim-text>
<claim-text>an association hardware unit, configured to associate source end data of the new SCTP association that corresponds to the current SCTP handshake message with destination end data of the new SCTP association that corresponds to the current SCTP handshake message to obtain a record of the new SCTP association, wherein the source end data comprises: a source IP address set, a source port number, and a V_tag from a source end to a destination end of the new SCTP association that corresponds to the current SCTP handshake message; and the destination end data comprises: a destination IP address set, a destination port number, and a V_tag from a destination end to a source end of the new SCTP association that corresponds to the current SCTP handshake message; and</claim-text>
<claim-text>an adding hardware unit, configured to add the record of the new SCTP association into the SCTP tuple identification table.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The device according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the parsing and adding hardware module comprises:
<claim-text>a third parsing hardware unit, configured to parse an INIT packet included in the current SCTP handshake message, and add information acquired by the parsing into the SCTP tuple identification table as one record, wherein the information acquired by parsing comprises at least one piece of the following information: an IP address set, a port, and a Vtag of the INIT packet;</claim-text>
<claim-text>a fourth parsing hardware unit, configured to parse an INIT ACK packet included in the current SCTP handshake message to obtain the IP address set, the port, and the Vtag of the INIT packet;</claim-text>
<claim-text>a parsing and matching hardware unit, configured to parse a common packet header of the SCTP packet to obtain a V_tag, and match the V_tag in the common packet header with the SCTP tuple identification table, wherein a record whose V_tag matches the V_tag in a common packet header is a record that corresponds to the INIT packet; and</claim-text>
<claim-text>an association establishing hardware unit, configured to add the IP address set, the port, and the V_tag acquired by parsing the INIT ACK packet included in the current SCTP handshake message to the SCTP tuple identification table as another record, and establish an association relation between the another record and the record that corresponds to the INIT packet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The device according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, further comprising:
<claim-text>a maintenance hardware module, configured to perform aging processing on the SCTP tuple identification table according to a preset period, and delete the record not used anymore in the SCTP tuple identification table, and the maintenance hardware module comprises a first maintenance unit, a second maintenance unit, or a third maintenance unit; wherein</claim-text>
<claim-text>the first maintenance hardware unit is configured to parse the received SCTP packet, and delete a record that corresponds to the SCTP packet from the SCTP tuple identification table, if the received SCTP packet is an SCTP shutdown packet;</claim-text>
<claim-text>the second maintenance hardware unit is configured to periodically check a count recording the number of times corresponding records are matched successful in the SCTP tuple identification table, and delete a record whose count does not increase; and</claim-text>
<claim-text>the third maintenance hardware unit is configured to periodically check a timestamp recording time at which corresponding records are matched successfully in the SCTP tuple identification table, and delete a record whose timestamp exceeds a preset aging time.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the acquired feature tuple is used as a key value and matches the SCTP tuple identification table with a hash lookup method. </claim-text>
</claim>
</claims>
</us-patent-grant>
