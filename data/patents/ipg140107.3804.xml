<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08624870-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08624870</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12986841</doc-number>
<date>20110107</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>305</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>3</main-group>
<subgroup>045</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>345174</main-classification>
<further-classification>345173</further-classification>
<further-classification>178 1801</further-classification>
<further-classification>178 1806</further-classification>
</classification-national>
<invention-title id="d2e53">System for and method of transferring charge to convert capacitance to voltage for touchscreen controllers</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4527096</doc-number>
<kind>A</kind>
<name>Kindlmann</name>
<date>19850700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5313141</doc-number>
<kind>A</kind>
<name>Kimball</name>
<date>19940500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5463283</doc-number>
<kind>A</kind>
<name>Sanderson</name>
<date>19951000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5789870</doc-number>
<kind>A</kind>
<name>Remson</name>
<date>19980800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6466036</doc-number>
<kind>B1</kind>
<name>Philipp</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6937124</doc-number>
<kind>B1</kind>
<name>Nakamura et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7061327</doc-number>
<kind>B2</kind>
<name>Doy</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>7176753</doc-number>
<kind>B2</kind>
<name>Noda et al.</name>
<date>20070200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>7283120</doc-number>
<kind>B2</kind>
<name>Grant</name>
<date>20071000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>7667371</doc-number>
<kind>B2</kind>
<name>Sadler et al.</name>
<date>20100200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2003/0067449</doc-number>
<kind>A1</kind>
<name>Yoshikawa et al.</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2003/0174121</doc-number>
<kind>A1</kind>
<name>Poupyrev et al.</name>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2006/0119586</doc-number>
<kind>A1</kind>
<name>Grant et al.</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2008/0055277</doc-number>
<kind>A1</kind>
<name>Takenaka et al.</name>
<date>20080300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2008/0062145</doc-number>
<kind>A1</kind>
<name>Shahoian et al.</name>
<date>20080300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2010/0156823</doc-number>
<kind>A1</kind>
<name>Paleczny et al.</name>
<date>20100600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2010/0245286</doc-number>
<kind>A1</kind>
<name>Parker</name>
<date>20100900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345174</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2011/0025629</doc-number>
<kind>A1</kind>
<name>Grivna et al.</name>
<date>20110200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345173</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2011/0061949</doc-number>
<kind>A1</kind>
<name>Krah et al.</name>
<date>20110300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>178 1806</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2011/0084936</doc-number>
<kind>A1</kind>
<name>Chang et al.</name>
<date>20110400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345174</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>2011/0156839</doc-number>
<kind>A1</kind>
<name>Martin et al.</name>
<date>20110600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>333172</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00022">
<document-id>
<country>WO</country>
<doc-number>9743825</doc-number>
<date>19971100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00023">
<othercit>Publication No. US-2011-0261005-A1, Publication Date: Oct. 27, 2011, U.S. Appl. No. 12/986,776, filed Jan. 7, 2011, Ashutosh Ravindra Joharapurkar.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00024">
<othercit>Publication No. US-2011-0261006-A1, Publication Date: Oct. 27, 2011, U.S. Appl. No. 12/986,841, filed Jan. 7, 2011, Ashutosh Ravindra Joharapurkar.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00025">
<othercit>Publication No. US-2011-0261007-A1, Publication Date: Oct. 27, 2011, U.S. Appl. No. 12/986,881, filed Jan. 7, 2011, Ashutosh Ravindra Joharapurkar.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00026">
<othercit>Publication No. US-2011-0260990-A1, Publication Date: Oct. 27, 2011, U.S. Appl. No. 12/986,991, filed Jan. 7, 2011, Yassir Ali.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00027">
<othercit>Publication No. US-2011-0261008-A1, Publication Date: Oct. 27, 2011, U.S. Appl. No. 12/987,008, filed Jan. 7, 2011, Ashutosh Ravindra Joharapurkar.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00028">
<othercit>Non-Final Office Action dated Sep. 29, 2011, U.S. Appl. No. 12/315,690, filed Dec. 5, 2008, Anthony Stephen Doy.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00029">
<othercit>International Search Report dated Dec. 3, 2009, PCT Patent Application Serial No. PCT/US 09/61359, Filed Oct. 20, 2009, Maxim Integrated Products, Inc.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00030">
<othercit>Daniel Carrica et al., &#x201c;Random Sampling Applied to the Measurement of a DC Signal Immersed in Noise&#x201d;, pp. 1319-1323, IEEE Transactions on Instrumentation and Measurement, vol. 50, No. 5, Oct. 2001.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>12</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>345173</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>345174</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>178 1801</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>178 1806</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>13</number-of-drawing-sheets>
<number-of-figures>15</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61326830</doc-number>
<date>20100422</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110261006</doc-number>
<kind>A1</kind>
<date>20111027</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Joharapurkar</last-name>
<first-name>Ashutosh Ravindra</first-name>
<address>
<city>Karnataka</city>
<country>IN</country>
</address>
</addressbook>
<residence>
<country>IN</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Kodur</last-name>
<first-name>Karthikeya</first-name>
<address>
<city>Karnataka</city>
<country>IN</country>
</address>
</addressbook>
<residence>
<country>IN</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Reddy</last-name>
<first-name>Venugopal</first-name>
<address>
<city>Karnataka</city>
<country>IN</country>
</address>
</addressbook>
<residence>
<country>IN</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Chan</last-name>
<first-name>Patrick</first-name>
<address>
<city>Sunnyvale</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Joharapurkar</last-name>
<first-name>Ashutosh Ravindra</first-name>
<address>
<city>Karnataka</city>
<country>IN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Kodur</last-name>
<first-name>Karthikeya</first-name>
<address>
<city>Karnataka</city>
<country>IN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Reddy</last-name>
<first-name>Venugopal</first-name>
<address>
<city>Karnataka</city>
<country>IN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Chan</last-name>
<first-name>Patrick</first-name>
<address>
<city>Sunnyvale</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Advent, LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Maxim Integrated Products, Inc.</orgname>
<role>02</role>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Sharifi-Tafreshi</last-name>
<first-name>Koosha</first-name>
<department>2695</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A touchscreen controller system determines the actual locations of multiple simultaneous touches by eliminating mutual capacitance between adjacent rows and columns during self-capacitance measurements and selectively enabling mutual capacitance during mutual capacitance measurements. During the self-capacitance measurements, the controller system generates a set of candidate touch locations, which includes the locations of real and ghost touches. During the mutual capacitance measurements, only the locations in the candidate set are measured and, from these measurements, the actual touch locations are determined. By limiting the mutual capacitive measurements to only a small subset of the locations over the entire touch panel, real touch locations are determined on a linear order. Also, by using on-chip integration capacitors, embodiments of the invention are able to perform each measurement in a single cycle.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="114.81mm" wi="216.83mm" file="US08624870-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="231.22mm" wi="129.29mm" orientation="landscape" file="US08624870-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="238.25mm" wi="167.89mm" file="US08624870-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="120.48mm" wi="140.72mm" file="US08624870-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="217.17mm" wi="145.71mm" orientation="landscape" file="US08624870-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="216.83mm" wi="135.97mm" orientation="landscape" file="US08624870-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="229.11mm" wi="135.89mm" file="US08624870-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="239.44mm" wi="151.21mm" orientation="landscape" file="US08624870-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="238.59mm" wi="151.89mm" orientation="landscape" file="US08624870-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="241.05mm" wi="151.89mm" orientation="landscape" file="US08624870-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="191.77mm" wi="172.55mm" orientation="landscape" file="US08624870-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="122.09mm" wi="108.54mm" file="US08624870-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="188.72mm" wi="145.97mm" file="US08624870-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="168.49mm" wi="150.62mm" file="US08624870-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application claims priority under 35 U.S.C. &#xa7;119(e) of the co-pending U.S. provisional patent application Ser. No. 61/326,830, filed Apr. 22, 2010, and titled &#x201c;Differential Capacitive Touchpad Circuit and Method,&#x201d; which is hereby incorporated by reference in its entirety.</p>
<p id="p-0003" num="0002">The following co-owned, co-filed, and co-pending applications, U.S. patent application Ser. No. 12/986,776, titled &#x201c;Method and Apparatus for Improving Dynamic Range of a Touchscreen Controller,&#x201d; U.S. patent application Ser. No. 12/986,881, titled &#x201c;Noise Cancellation Technique for Capacitive Touchscreen Controller Using Differential Sensing,&#x201d; U.S. patent application Ser. No. 12/986,991, titled &#x201c;System Integration of Tactile Feedback and Touchscreen Controller for Near-Zero Latency Haptics Playout,&#x201d; U.S. patent application Ser. No. 12/987,008, titled &#x201c;Use of Random Sampling Technique to Reduce Finger-Coupled Noise,&#x201d; and U.S. patent application Ser. No. 12/986,905, titled &#x201c;Method and Apparatus for Generating Piezoelectric Transducer Excitation Waveforms Using a Boost Converter,&#x201d; are all also incorporated by reference in their entireties.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0004" num="0003">This invention relates to human-to-machine interfaces. More specifically, this invention relates to capacitive touchscreens.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0005" num="0004">Touchscreens or touch panels provide an interface for displaying output and receiving input, a structure that makes them well suited for mobile phones, personal digital assistants, digital music players, and other compact devices. Using a touchscreen, a user can select or manipulate items displayed on the touchscreen, such as buttons, sliders, scroll wheels, and other screen icons.</p>
<p id="p-0006" num="0005">Prior art systems use different methods to detect the presence of an object, such as capacitive charge transfer methods and relaxation OSC methods. In a capacitive touchscreen, for example, charge is transferred to sensing elements and objects adjacent to them. The combined stored charge is then read, with charges above a threshold indicating that the object is above the sensing element currently being read. By arranging sensing elements into a grid pattern having rows and columns, the particular location of an object on the grid can be determined.</p>
<p id="p-0007" num="0006"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of prior art capacitive touchscreen <b>100</b>. The touchscreen <b>100</b> comprises a surface containing multiple sensing elements <b>101</b>, each configured to sense the presence an object, such as a finger <b>105</b>, adjacent to it. By detecting which ones of the sensing elements the object <b>105</b> is adjacent to, the location of the object along the surface of the touchscreen <b>100</b> is determined. The capacitive touchscreen <b>100</b> functions by opening and closing switches A, A&#x2032; B, B&#x2032;, C, and C&#x2032; to transfer charge that is measured by measuring circuits <b>110</b> and <b>115</b> and calculated by calculation means <b>120</b>. Those skilled in the art will recognize that the capacitive touchscreen <b>100</b> requires multiple clock phases and multiple charge transfer cycles to determine whether an object is adjacent to its surface.</p>
<p id="p-0008" num="0007">The touchscreen <b>100</b> has several disadvantages. For example, charge must be transferred to external capacitors C<sub>S1 </sub>and C<sub>S2 </sub>several times to measure capacitance change. This increases the latency and thus reduces the maximum frame rate that can be supported. As a result, the touchscreen <b>100</b> has limited sensitivity and a reduced signal-to-noise ratio.</p>
<p id="p-0009" num="0008">The touchscreen <b>100</b>, like other prior art capacitive touchscreens, also suffers from &#x201c;ghosting,&#x201d; during which the actual locations of simultaneous touches cannot be resolved. When simultaneous touches occur at multiple locations, the system is only able to determine that several touches occurred, the &#x201c;real&#x201d; touches and &#x201c;ghost&#x201d; touches. The system is unable to easily distinguish between the real and ghost touches. This ambiguity, and the processing needed to resolve it, increases exponentially with the number of simultaneous touches.</p>
<p id="p-0010" num="0009">Some capacitive touchscreens determine simultaneous touches using &#x201c;mutual capacitance,&#x201d; a process that senses capacitances at the intersections of row and column lines. Systems that support mutual capacitance measurements require much more complex analog hardware, which results in higher power dissipation, lower throughput rate, larger die size, and more complex signal processing.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0011" num="0010">Touchscreen controller systems in accordance with the invention support mutual capacitance cancellation and selective mutual capacitance measurements between sensors, reducing the requirement of offset canceling capacitances. These touchscreen controller systems are also capable of eliminating ghost touches on a panel, a feature that is critical in detecting multi-touches without ambiguity. It does this without needing to take mutual capacitance measurements between each combination of row and column.</p>
<p id="p-0012" num="0011">Touchscreen controller systems in accordance with the invention need only a single charge transfer cycle to detect capacitance changes that indicate the presence of an object. These touchscreen controller systems use on-chip integration capacitors, which are much smaller than external integration capacitors and can be charged and discharged more quickly. These touchscreen controller systems can support faster frame rates, can improve sensitivity, and require no external components for the sensors.</p>
<p id="p-0013" num="0012">Touchscreen controller systems in accordance with the invention convert sensor capacitance of a touch screen panel to a directly proportional voltage. In a reset phase the systems are driven to ground and will not pick up noise from external sources. In one embodiment, except for one switch in the feedback path, all node voltages carry either a reference voltage or ground. This structure reduces the effect of charge injection because most of the charge injection results in a constant offset for the system, an offset that can be accommodated by calibration.</p>
<p id="p-0014" num="0013">In one aspect of the invention, a touchscreen controller systems for sensing one or more objects adjacent to and/or in contact with a surface of the touchscreen controller includes a plurality of sense lines arranged adjacent to the surface of the touch panel. Adjacent sense lines have a mutual capacitance. A plurality of capacitive sensing elements are each coupled to one of the sense lines. A control logic is configured to drive mutual capacitances between selected and unselected sense lines to the same potential during a self-capacitance measuring stage and to drive mutual capacitances between selected and unselected sense lines to different potentials during a mutual capacitance measuring stage. In one embodiment, the touchscreen controller systems includes a voltage measurement circuit that converts a charge on a selected capacitive sensing element into a corresponding voltage that indicates whether an object is adjacent thereto.</p>
<p id="p-0015" num="0014">In a second aspect of the invention, a method of sensing presence of objects simultaneously on or adjacent to a surface of a touch panel includes individually selecting row and column lines of the touch panel to determine one or more candidate locations of the objects along the surface and reading combinations of row and column lines of the touch panel from only the candidate locations to determine one or more actual locations of the objects along the surface. In one embodiment, the steps of individually selecting row and column lines and reading combinations of row and column lines are performed on a single integrated circuit. The method also includes canceling mutual capacitance between the row and column lines when individually reading selected row and column lines and selectively enabling mutual capacitance between adjacent row and column lines when reading selected combinations of row and column lines.</p>
<p id="p-0016" num="0015">In one embodiment, determining one or more actual locations comprises comparing self capacitance measurements of the candidate locations with corresponding mutual capacitance measurements.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic diagram of a prior art touchscreen.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram of a mobile telephone having a touchscreen, used to explain principles of the invention.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 3</figref> is a schematic diagram showing several components of a touchscreen, used to explain principles of the invention.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 4</figref> is a high-level diagram modeling component and parasitic capacitive elements of a capacitive touchscreen, used to explain principles of the invention.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIGS. 5A and 5B</figref> show a sensor component during reset and measurement phases, respectively, in accordance with one embodiment of the invention.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 6</figref> is a schematic diagram of an offset capacitor in accordance with one embodiment of the invention.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 7</figref> shows voltage diagrams during reset and measurement phases for the sensor components of <figref idref="DRAWINGS">FIGS. 5A and 5B</figref>.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIGS. 8A-C</figref> are schematic diagrams of a sensor component that uses integration operations in accordance with one embodiment of the invention.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 9</figref> shows voltage diagrams of the sensor component in <figref idref="DRAWINGS">FIGS. 8A-C</figref> during different phases of operation.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 10</figref> shows real and ghost locations of multiple touches on a touchscreen, used to explain the principles of the invention.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 11</figref> shows the steps of a method of measuring the voltages on sensing elements using both self capacitance and mutual capacitance to eliminate ghosting in accordance with the present invention.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 12</figref> shows the steps of a method of selectively enabling mutual capacitance in combination with self capacitance, as illustrated in <figref idref="DRAWINGS">FIG. 11</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0029" num="0028">The present invention encompasses techniques for reducing or eliminating error in the output of capacitive sensor arrays such as touchpads, touchscreens, touch sliders and the like, including sensors that detect the presence and position of a stylus, as well as those that detect and determine finger position. While the illustrative embodiment described herein is applied in a mobile telephone, it is understood that capacitive touch sensors are used in a wide variety of devices. Examples of such devices are portable devices, such as personal digital assistants (PDA5), global positioning systems (GPS) receivers, as well as larger devices such as touchscreen enabled displays and computer systems, as well as appliances.</p>
<p id="p-0030" num="0029">Referring now to <figref idref="DRAWINGS">FIG. 2</figref>, a mobile telephone <b>200</b> in accordance with one embodiment of the present invention is shown. The mobile telephone <b>200</b> includes a microprocessor (&#x3bc;P) <b>214</b> coupled to a memory <b>215</b> that stores program instructions for execution by the microprocessor <b>214</b>, and generally includes non-volatile storage for such program instructions, as well as temporary storage for use by the microprocessor <b>214</b>. The program instructions stored in a memory <b>215</b> include program instructions forming computer program products in accordance with embodiments of the present invention that determine the position of one or more fingers and/or styli at the surface of a touch sensor included in an integrated liquid crystal display (LCD)/touchpad <b>212</b>. The LCD/touchpad <b>212</b> is coupled to a touchpad circuit <b>220</b> in accordance with one embodiment of the present invention that includes the capability of simultaneously measuring the capacitance of two or more elements of the touchpad within the LCD/touchpad <b>212</b>. Alternatively, as will be described in further detail below, the present invention may integrate a voltage present on the two or more elements which is generally produced by providing a reference potential to another layer. Integrator circuit(s) may be provided to perform the integration, or the present invention may include program instructions within the memory <b>215</b> that measure the voltages present on the two or more elements, from simultaneous samples of the voltages, and integrate the voltages. The mobile telephone <b>200</b> also includes a display controller <b>216</b> for coupling the microprocessor <b>214</b> to the LCD within the integrated LCD/touchpad <b>212</b> and radio circuits <b>218</b> for providing wireless telephone communication connections. The mobile telephone <b>200</b> also includes an audio codec <b>217</b> coupled to a microphone <b>213</b> and a speaker element <b>211</b> that provide voice communications with a user.</p>
<p id="p-0031" num="0030">In accordance with the present invention, the capacitance of two or more rows/columns of a two-dimensional touchpad array or two or more elements of a one-dimensional touchpad array, such as a slider, are measured simultaneously, either directly, or by measuring a voltage present on the elements. The measurements are subtracted to yield a measurement free of common-mode error that is primarily due to incident noise, such as that produced by operation of the LCD, any backlight or other power supply under integrated LCD/touchpad <b>212</b> and other external environmental sources of noise.</p>
<p id="p-0032" num="0031">Referring now to <figref idref="DRAWINGS">FIG. 3</figref>, details of the touchpad circuit <b>220</b> in the mobile telephone <b>200</b> of <figref idref="DRAWINGS">FIG. 2</figref> are shown in accordance with one embodiment of the present invention. As in all the figures, the same label refers to the same or similar element. The touchpad circuit <b>220</b> includes a pair of multiplexers <b>260</b>A and <b>260</b>B coupled to each of eight rows of touchpad elements <b>280</b>. Single touchpad elements <b>280</b> are illustrated, but it is understood that more or fewer rows and columns of equal or unequal numbers and both one and two-dimensional touchpads can utilize the techniques of the present invention. The multiplexer <b>260</b>A selects a first row/element from among the touchpad elements <b>280</b>. The multiplexer <b>260</b>B selects another second row/element from among the touchpad elements <b>280</b>. A pair of capacitance measuring circuits <b>270</b>A and <b>270</b>B each measures the capacitance at the output of the multiplexers <b>260</b>A and <b>260</b>B, respectively, which will change due to the presence of a finger/stylus near the selected element, and converts the capacitances to corresponding voltage signals.</p>
<p id="p-0033" num="0032">A control logic circuit <b>225</b> provides a reset signal Rst for resetting capacitance measuring circuits <b>270</b>A and <b>270</b>B, which prepares capacitance measuring circuits <b>270</b>A and <b>270</b>B to make capacitance measurements. The control logic can be integrally formed with the microprocessor <b>214</b>. In such a case the signal Rst will be provided by the microprocessor <b>214</b>. Selection values Sel<b>1</b> and Sel<b>2</b> are set at address inputs of multiplexers <b>260</b>A and <b>260</b>B for selecting the measurement elements prior to performing the measurement. The reset signal Rst is de-asserted, thereby permitting the capacitance measuring circuits <b>270</b>A and <b>270</b>B to measure the capacitance of the respective selected touchpad elements <b>280</b>. The outputs of the capacitance measuring circuits <b>270</b>A and <b>270</b>B are applied differentially to the inputs of an analog-to-digital converter (ADC) <b>240</b>, which provides digital values corresponding to the difference between the capacitances measured at the outputs of the multiplexers <b>270</b>A and <b>270</b>B, after a sample control signal, Sample, signal is asserted for sampling the outputs of the capacitance measuring circuits <b>270</b>A and <b>270</b>B. Therefore any common-mode noise and offset present at the outputs of multiplexers <b>260</b>A and <b>260</b>B will be substantially canceled in the output of ADC <b>240</b>.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 4</figref> is a schematic diagram <b>400</b> modeling the touch pad circuit <b>220</b> of <figref idref="DRAWINGS">FIG. 3</figref>, used to explain principles of the invention. The schematic <b>400</b> shows that each intersecting row and column lines (e.g., R<b>1</b> and C<b>1</b>) that form the touchpad <b>212</b> contains a mutual capacitance C<sub>U</sub>. Each row line contains a sensor capacitance (C<sub>X</sub>) and a sensor offset capacitance (C<sub>XOFF</sub>), both coupled to ground. For modeling purposes, it will be appreciated that C<sub>XOFF </sub>can be combined into its corresponding C<sub>X</sub>.</p>
<p id="p-0035" num="0034">Referring now to <figref idref="DRAWINGS">FIG. 5A</figref>, details of capacitance measuring circuits <b>270</b>A and <b>270</b>B (collectively, <b>270</b>) of <figref idref="DRAWINGS">FIG. 3</figref> are shown. A capacitance measuring circuit, as provided in one embodiment of the present invention, includes a switching network formed by the switches S<b>1</b>A-S<b>1</b>D, the switches S<b>2</b>A-S<b>2</b>C, and the switch S<b>3</b>. A feedback or integration capacitor C<sub>INT </sub>is selectively coupled to an operational amplifier <b>420</b> by the switches S<b>1</b>C and S<b>2</b>B. As shown in <figref idref="DRAWINGS">FIG. 5A</figref>, when the reset signal Rst is asserted, the switch S<b>3</b> couples the input of mutual capacitor C<sub>U </sub>to ground and the switch S<b>1</b>B couples the inverting input of the amplifier <b>420</b> to a reference voltage V<sub>REF</sub>. Also during assertion of the reset signal Rst, the switch S<b>2</b>B is open and the switch S<b>1</b>C is closed, causing the integration capacitor C<sub>INT </sub>to be charged to the reference voltage V<sub>REF</sub>. Also during the assertion of the reset signal Rst, the switch S<b>1</b>A is closed, coupling the output of the multiplexer <b>260</b> to ground, which discharges a capacitance C<sub>X </sub>of the selected element, and any stray offset capacitance along the path to the selected element C<sub>XOFF</sub>. An offset cancellation capacitor C<sub>OFF </sub>is coupled to the inverting input of the operational amplifier <b>420</b> and charged to the reference voltage V<sub>REF </sub>when the reset signal Rst is asserted by the activation of the switch S<b>1</b>D that grounds the second terminal of the offset cancellation capacitor C<sub>OFF</sub>. Therefore, after a settling time, the condition of the capacitances in the capacitance measurement circuit <b>270</b> are such that the integration capacitor C<sub>INT </sub>and the offset cancellation capacitor C<sub>OFF </sub>are charged to the reference voltage V<sub>REF</sub>, and the element capacitance C<sub>X </sub>and any stray offset capacitance C<sub>XOFF </sub>are substantially discharged.</p>
<p id="p-0036" num="0035">As shown in <figref idref="DRAWINGS">FIG. 5B</figref>, when a measurement control signal Meas is asserted after the reset signal Rst is de-asserted, which is generally performed by ensuring non-overlapping control signals generated by the control logic <b>225</b>, the switches S<b>1</b>C and S<b>1</b>B are open due to the de-assertion of the reset signal Rst, and the switch S<b>3</b> couples the mutual capacitance C<sub>U </sub>to the reference voltage V<sub>REF</sub>. The switch S<b>2</b>B is closed by assertion of the measurement control signal Meas, causing the integration capacitor C<sub>INT </sub>to be coupled between the output and the inverting input of the operational amplifier <b>420</b>. Since the integration capacitor C<sub>INT </sub>is charged to a voltage of V<sub>REF </sub>with respect to the input terminal, and since the non-inverting input of the operational amplifier <b>420</b> is also referenced to the reference voltage V<sub>REF</sub>, the initial output of the operational amplifier <b>420</b> will be substantially zero. During assertion of the measurement control signal Meas, the switch S<b>2</b>A is closed, and the switch S<b>1</b>A was previously opened at de-assertion of the reset signal Rst. Also, the offset cancellation capacitor C<sub>OFF </sub>is de-coupled from ground when the reset signal Rst causes the switch S<b>1</b>D to open, and is coupled to the reference voltage V<sub>REF </sub>at the previously-grounded terminal when the measurement control signal Meas causes the switch S<b>2</b>C to close. As a result of the closure of the switches S<b>2</b>A and S<b>2</b>C, a positive charge amount equal to C<sub>OFF</sub>*V<sub>REF</sub>, where C<sub>OFF </sub>is the capacitance of the offset cancellation capacitor C<sub>OFF</sub>, is transferred from the offset cancellation capacitor C<sub>OFF </sub>to the integration capacitor C<sub>INT </sub>and a negative charge amount equal to &#x2212;C<sub>X</sub>*V<sub>REF </sub>is transferred from the output terminal of the multiplexer <b>260</b> to the integration capacitor C<sub>INT</sub>, where C<sub>X </sub>is the sum of the capacitances of the element capacitance C<sub>X </sub>and any stray offset capacitance C<sub>XOFF</sub>. (Based on a particular context, those skilled in the art will recognize when a label, such as C<sub>OFF</sub>, refers to an element, a value of an element, a charge on an element, etc.)</p>
<p id="p-0037" num="0036">The output voltage V<sub>0 </sub>of the operational amplifier <b>420</b> is equal to the output-referred voltage across the integration capacitor C<sub>INT </sub>plus V<sub>REF</sub>, which can be computed from V<sub>0</sub>=Q<sub>F</sub>/C<sub>INT</sub>+V<sub>REF </sub>where Q<sub>F </sub>is the charge on the integration capacitor C<sub>INT</sub>. The total charge transferred to the integration capacitor C<sub>INT </sub>when the measurement control signal Meas is asserted is C<sub>X</sub>*V<sub>REF</sub>&#x2212;C<sub>OFF</sub>*V<sub>REF</sub>=&#x394;Q<sub>F</sub>. The initial charge on the integration capacitor C<sub>INT </sub>is &#x2212;C<sub>INT</sub>*V<sub>REF</sub>, so the final value of charge Q<sub>F </sub>is given by Equation (1):
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>&#x2212;<i>C</i><sub>INT</sub><i>*V</i><sub>REF</sub><i>+C</i><sub>X</sub><i>*V</i><sub>REF</sub><i>&#x2212;C</i><sub>OFF</sub><i>*V</i><sub>REF</sub>&#x2003;&#x2003;Equation (1)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
and the output voltage V<sub>0 </sub>is given by Equation (2):
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>0</sub>=(&#x2212;<i>C</i><sub>INT</sub><i>*V</i><sub>REF</sub><i>+C</i><sub>X</sub><i>*V</i><sub>REF</sub><i>&#x2212;C</i><sub>OFF</sub><i>*V</i><sub>REF</sub>)<i>C</i><sub>INT</sub><i>+V</i><sub>REF</sub>=(<i>C</i><sub>X</sub><i>/C</i><sub>INT</sub><i>&#x2212;C</i><sub>OFF</sub><i>/C</i><sub>INT</sub>)*<i>V</i><sub>REF</sub>&#x2003;&#x2003;Equation (2)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
The same result can be obtained by applying charge conservation at the inverting input terminal of the operational amplifier <b>420</b>. Therefore, the output voltage V<sub>0 </sub>is proportional to the capacitance of the element plus any stray offset capacitance. The offset cancellation capacitor C<sub>OFF </sub>provides biasing of the measurement away from an always negative result, and the relative capacitance of the integration capacitor C<sub>INT </sub>sets the dynamic range of the measurement. In one embodiment of the present invention, the integration capacitor C<sub>INT </sub>can have a much higher capacitance relative to the capacitances C<sub>X </sub>and C<sub>XOFF</sub>, and the switches S<b>1</b>A and S<b>2</b>A are operated by separate clock signals having a higher frequency than the measurement control signal Meas and the reset signal Rst. The operational amplifier <b>420</b> and the integration capacitor C<sub>INT </sub>will then act as an integrator, integrating the charge transferred from the capacitance at the output of the multiplexer <b>260</b>, providing additional filtering of noise.
</p>
<p id="p-0038" num="0037">The feedback factor for the operational amplifier <b>420</b> is determined by the ratio of C<sub>X </sub>and C<sub>OFF </sub>to C<sub>INT</sub>. C<sub>X </sub>is an external capacitor that the designers have no control over. It can change from a very small value to a large value. C<sub>OFF </sub>is used to cancel the effect of parasitic capacitance, C<sub>XOFF</sub>. In one embodiment, shown in <figref idref="DRAWINGS">FIG. 6</figref>, C<sub>OFF </sub>is a capacitive digital-to-analog control element made up of unit-sized capacitors. Instead of switching unit capacitors in and out, depending on the value of C<sub>X</sub>, the number of fingers at the bottom plate of C<sub>OFF </sub>driven to V<sub>REF </sub>or ground during the measurement phase can be changed. If the bottom plate of some of the fingers of C<sub>OFF </sub>is driven to ground in the measurement phase, there is no net charge transfer from these fingers as the voltage across them stays constant in the two cycles. The feedback factor will be set by all the fingers of the C<sub>OFF </sub>capacitor and the external capacitor C<sub>X</sub>. This will significantly reduce the variation of the feedback factor of the operational amplifier.</p>
<p id="p-0039" num="0038">The embodiment of C<sub>OFF </sub>shown in <figref idref="DRAWINGS">FIG. 6</figref> allows for the calibration of the capacitance measurement circuit <b>270</b> in <figref idref="DRAWINGS">FIG. 3</figref>. In the embodiment of <figref idref="DRAWINGS">FIG. 6</figref>, C<sub>OFF </sub>can be made programmable. Additional fingers of a capacitor having a common plate are selected by a plurality of switches S<sub>C1 </sub>through S<sub>CN </sub>in response to a set of digital signals trim, effectively providing for a set of selectable capacitive elements C<b>1</b>-CN that can be used to adjust C<sub>OFF </sub>on a static per-element basis after calibration. In one embodiment, C<sub>OFF </sub>is zeroed for offset cancellation.</p>
<p id="p-0040" num="0039">Referring to <figref idref="DRAWINGS">FIG. 5A</figref>, in one embodiment, the integration capacitor C<sub>INT </sub>and the operational amplifier <b>420</b> are formed on a single integrated circuit. As one example, all the elements to the right of the dotted line are on a single integrated circuit. It will be appreciated that because the integration capacitor C<sub>INT </sub>is on-chip, it is smaller than similarly functioning capacitors in the prior art, reducing the time needed to charge and discharge it. Such structure decreases the latency of the touchscreen processing.</p>
<p id="p-0041" num="0040">Referring now to <figref idref="DRAWINGS">FIG. 7</figref>, a signal waveform diagram depicting the operation of the capacitance measurement circuit <b>400</b> of <figref idref="DRAWINGS">FIG. 5A</figref> is illustrated. The voltage V<sub>CF</sub>, is the voltage across the feedback capacitor C<sub>INT </sub>and the voltage V<sub>CX </sub>is the voltage at the output of the multiplexer <b>260</b>. During the first assertion of the reset signal Rst, at a time T<sub>a</sub>, the voltage V<sub>CF </sub>is set to V<sub>REF </sub>and the voltage V<sub>CX </sub>is set to zero. The depicted condition for the first measurement is C<sub>X</sub>=0.50C<sub>INT </sub>and C<sub>OFF</sub>=0. At a time T<sub>b</sub>, the reset signal Rst is de-asserted and the measurement control signal Meas is asserted. The voltage V<sub>CF </sub>falls to 0.5V<sub>REF</sub>, and the voltage V<sub>o </sub>rises to 0.5* V<sub>REF</sub>, which is consistent with Equation (2), above. Also at the time T<sub>b</sub>, the sample control signal Sample is asserted and the value of the difference between the outputs of the capacitance measurement circuits <b>270</b>A and <b>270</b>B is sampled and then captured at a time T<sub>c </sub>on the falling edge of sample control signal Sample. Since the operation of both of the capacitance measurement circuits <b>270</b>A and <b>270</b>B is identical except for the capacitance present at their inputs, only one set of waveforms is shown in <figref idref="DRAWINGS">FIG. 7</figref>. On the next measurement interval starting at time T<sub>d</sub>, C<sub>X</sub>=2C<sub>INT </sub>and C<sub>OFF</sub>=C<sub>INT</sub>. The voltage V<sub>CF </sub>falls to 0, and the voltage V<sub>0 </sub>rises to V<sub>REF </sub>which is consistent with Equation (2), above.</p>
<p id="p-0042" num="0041">It will be appreciated that the number of charge transfer cycles can be increased to increase the range or to perform the integration.</p>
<p id="p-0043" num="0042">Within an array of capacitive sensor elements, mutual capacitance between rows and columns, as well as between adjacent rows and between adjacent columns, can reduce the effective dynamic range of capacitance measurements, since the mutual capacitance will always be present, or require cancellation by techniques such as increasing offset cancellation capacitor C<sub>XOFF</sub>, in capacitance measurement circuit <b>400</b> of <figref idref="DRAWINGS">FIG. 5A</figref>. To avoid stray electrostatic noise from charging unselected ones of elements <b>280</b> in <figref idref="DRAWINGS">FIG. 3</figref> (i.e., those elements not selected by selection values Sel<b>1</b> and Sel<b>2</b>), the unselected elements can be grounded by circuits within the multiplexers <b>260</b>A and <b>260</b>B. Typically the unused sensors are grounded. If the unused sensors are grounded, this will add to the capacitance from the sensor ground in the form of mutual capacitance. This will require a larger offset cancellation capacitor. In the first phase, all the sensors are grounded. In the second phase, the measured sensor goes to V<sub>REF </sub>as it is coupled to the negative terminal of the operational amplifier. If all the unused sensors are driven to V<sub>REF </sub>during the second phase, they will contribute no charge towards the integrator output. This will reduce the offset capacitance that needs to be canceled without changing the feedback factor.</p>
<p id="p-0044" num="0043">In accordance with another embodiment, capacitance is measured at the input of a sensor circuit and produces a proportional voltage output. In accordance with this embodiment, a voltage proportional to the input capacitance in the analog domain is integrated for multiple cycles. This will reduce the post-processing required by the micro controller.</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIGS. 8A-C</figref> are schematic diagrams of a sensor circuit <b>500</b> using a coupling capacitor Cc for integrating a voltage proportional to an input capacitance in the analog domain, in accordance with one embodiment of the invention. The scheme is similar to the charge transfer circuit shown in <figref idref="DRAWINGS">FIG. 5A</figref>. The circuits in <figref idref="DRAWINGS">FIGS. 5A and 8A</figref> differ in that the circuit <b>500</b> has a switch S<b>2</b>D coupling the coupling capacitor Cc to a node V<sub>X</sub>, a switch S<b>1</b>E across Cc, and a switch S<b>1</b>F coupling a top plate of capacitor C<sub>OFF </sub>to the reference voltage V<sub>REF</sub>. As in all the figures, similarly labeled elements refer to the identical or a similar element.</p>
<p id="p-0046" num="0045">The coupling capacitor Cc and the feedback capacitor C<sub>INT </sub>together form an integrator circuit, which functions as an averager. The charge transferred from C<sub>C </sub>onto C<sub>INT </sub>during each integration cycle. C<sub>INT </sub>accumulates this charge over the number of integration cycles. The operational amplifier <b>420</b> maintains the charge across C<sub>INT </sub>for all the integration cycles and hence the integrated output. The number of integration cycles that can be performed depends on the maximum sensor capacitance C<sub>X </sub>at the input and the ratio of Cc/C<sub>INT</sub>. The increase in the number of integration cycles increases the chances of the sensor circuit <b>500</b> getting saturated and thereby losing data. A small value of Cc gives a low integration gain but gives a better settling response. A large value of Cc on other hand gives a better gain, but the settling time requirement also increases.</p>
<p id="p-0047" num="0046">The choice of N, the number of integration cycles, is a system design consideration and is a tradeoff between digital post-processing time, additional die area, and analog settling time tolerance. If the circuit with lesser settling accuracy can be tolerated against increased die area (due to digital post-processing) then this architecture will be well-suited for such a circuit.</p>
<p id="p-0048" num="0047">In operation, the feedback capacitor C<sub>INT </sub>is charged to V<sub>REF </sub>at the beginning of each channel conversion. For the next N integration cycles, the integration capacitor C<sub>INT </sub>will remain connected across the operational amplifier <b>420</b>, between the negative terminal and the output.</p>
<p id="p-0049" num="0048">The charge transfer occurs over 3 phases, as described below.</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 8A</figref> shows the circuit <b>500</b> in the integrator reset phase (phase <b>1</b>), the initial phase for the channel conversion. As shown in <figref idref="DRAWINGS">FIG. 8A</figref>, the switches S<b>1</b>A-F are all closed, and the switches S<b>2</b>A-D are all open. Once the channel to be converted is chosen from the channel multiplexer <b>260</b>, the input capacitance C<sub>X </sub>(the combination of C<sub>XOFF</sub>, C<sub>parasitic </sub>and C<sub>TOUCH</sub>) is discharged to GND. The offset capacitance C<sub>OFF </sub>is charged to V<sub>REF</sub>, the integration capacitance C<sub>INT </sub>is charged to V<sub>REF</sub>, and the coupling capacitor Cc is discharged by shorting its terminals and driving it with V<sub>REF</sub>. The operational amplifier <b>420</b> is in a reset phase because both of its terminals are driven to V<sub>REF </sub>and its output is thus driven to GND.</p>
<p id="p-0051" num="0050">Next, as shown in <figref idref="DRAWINGS">FIG. 8B</figref>, the sensor circuit <b>500</b> is placed in the integrator measure phase (phase <b>2</b>), the integrate phase for the channel conversion. As shown in <figref idref="DRAWINGS">FIG. 8B</figref>, switches S<b>1</b>A-F are all open, and switches S<b>2</b>A-D are all closed. C<sub>OFF </sub>is charged to V<sub>X</sub>&#x2212;V<sub>REF</sub>, C<sub>INT </sub>is charged to V<sub>REF</sub>&#x2212;V<sub>0</sub>, Cc is charged to (V<sub>X</sub>&#x2212;V<sub>REF</sub>), and the inverting terminal of the operational amplifier <b>420</b> is driven to V<sub>REF </sub>by the output of the operational amplifier <b>420</b>. The operational amplifier <b>420</b> is now in an active phase.</p>
<p id="p-0052" num="0051">Applying charge conservation law at node V<sub>X</sub>, the following equations are calculated for finding the voltage at V<sub>X</sub>:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C</i><sub>X</sub><i>*V</i><sub>X</sub><i>+C</i><sub>OFF</sub>*(<i>V</i><sub>X</sub>&#x2212;2<i>*V</i><sub>REF</sub>)+<i>Cc</i>*(<i>V</i><sub>X</sub><i>&#x2212;V</i><sub>REF</sub>)=0&#x2003;&#x2003;Equation (3)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>(<i>C</i><sub>X</sub><i>+C</i><sub>OFF</sub><i>+Cc</i>)*<i>V</i><sub>X</sub>=(2<i>*C</i><sub>OFF</sub><i>+Cc</i>)*<i>V</i><sub>REF</sub>&#x2003;&#x2003;Equation (4)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>X</sub>=((2<i>*C</i><sub>OFF</sub><i>+Cc</i>)/(<i>C</i><sub>X</sub><i>+C</i><sub>OFF</sub><i>+Cc</i>))*<i>V</i><sub>REF</sub>&#x2003;&#x2003;Equation (5)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0053" num="0052">Similarly, applying Kirchoff's Current Law at the summing junction node of the circuit <b>500</b>, the equation for the output V<sub>OUT </sub>is obtained:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Cc</i>*(<i>V</i><sub>REF</sub><i>&#x2212;V</i><sub>X</sub>)+<i>C</i><sub>F</sub>*(&#x2212;<i>V</i><sub>O</sub>)=0&#x2003;&#x2003;Equation (6)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>O</sub>=(<i>Cc/C</i><sub>INT</sub>)*(<i>V</i><sub>REF</sub><i>&#x2212;V</i><sub>X</sub>)&#x2003;&#x2003;Equation (7)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
For the Nth integration cycle, the output is given as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>O</sub>=&#x3a3;<sub>N</sub>((<i>Cc/C</i><sub>INT</sub>)*(<i>V</i><sub>REF</sub><i>&#x2212;V</i><sub>X</sub>))&#x2003;&#x2003;Equation (8)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
As seen from the Equation (8), the change in the output from one charge transfer cycle to the next is a ratio of (Cc/C<sub>INT</sub>). The node voltage V<sub>X </sub>remains constant throughout the number of charge transfer cycles as long as C<sub>X </sub>is constant.
</p>
<p id="p-0054" num="0053">Next, as shown in <figref idref="DRAWINGS">FIG. 8C</figref>, the sensor circuit <b>500</b> is placed in the coupling capacitance RESET phase (phase <b>3</b>), which is the discharge phase for the coupling capacitor Cc. As shown in <figref idref="DRAWINGS">FIG. 8C</figref>, the switches S<b>1</b>A, S<b>1</b>D, S<b>1</b>E, S<b>1</b>F, and S<b>2</b>B are all closed, and the switches SIB, S<b>1</b>C, S<b>2</b>A, S<b>2</b>C, and S<b>2</b>D are all open. In the coupling capacitance reset phase, the feedback capacitor C<sub>INT </sub>remains connected to the output of the operational amplifier <b>420</b>. The offset cancellation capacitor C<sub>OFF </sub>is charged to V<sub>REF</sub>. The bottom plates are all tied to GND. The operational amplifier <b>420</b> is in the mid cycle reset phase. The output is held constant during this phase because the charge across C<sub>INT </sub>does not change.</p>
<p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. 9</figref> is a timing diagram for the charge transfer circuit <b>500</b>, for N=4. Referring to FIGS. <b>9</b> and <b>8</b>A-C, Ta indicates the start of Phase <b>1</b>, during which Ph<b>1</b> goes HIGH. The circuit <b>500</b> enters the reset phase for the integrator. The output of the operational amplifier <b>420</b> is held at 0 V, the voltages across C<sub>X </sub>is zero, and C<sub>XOFF </sub>is charged to V<sub>REF</sub>.</p>
<p id="p-0056" num="0055">Tb indicates the start of phase <b>2</b>, during which Ph<b>2</b> goes HIGH. Ph<b>1</b> goes low and there is a non-zero non-overlap time between Ph<b>1</b> going LOW and Ph<b>2</b> going HIGH. Ph<b>2</b> remains HIGH throughout the N integration cycles. The operational amplifier <b>420</b> feedback switches are closed and the circuit <b>500</b> is connected to the sensor capacitance C<sub>X </sub>through series switches and Cc, the coupling capacitor. The output of the operational amplifier <b>420</b> goes to a value decided by the four capacitors C<sub>X</sub>, C<sub>OFF</sub>, Cc and C<sub>INT</sub>, the voltage across C<sub>X </sub>is V<sub>X</sub>, which is given by the equation above. The voltage across the feedback capacitor C<sub>INT</sub>, which was initially charged to V<sub>REF</sub>, starts to fall. The integrator output continues to accumulate and the voltage at V<sub>OUT </sub>continues to rise. The step change in the output voltage is given by the equations above. The sample from the integrator is taken after N integrator cycles.</p>
<p id="p-0057" num="0056">Still referring to <figref idref="DRAWINGS">FIG. 9</figref>, Tc indicates the start of Phase <b>3</b> and the end of Phase <b>2</b>. After a non-overlap time the next discharge phase for the coupling capacitor Cc starts. This is phase <b>3</b> as described above. During phase <b>3</b>, the output of the integrator is held constant from Phase <b>2</b>, while the coupling capacitor Cc, C<sub>XOFF </sub>and C<sub>X </sub>are all reset to their initial states. The voltage at the node V<sub>X </sub>is forced to V<sub>REF</sub>.</p>
<p id="p-0058" num="0057">This cycle of repeating phase <b>3</b> and phase <b>2</b> for the coupling capacitor Cc is performed a number of times and the final output of the integrator is sampled onto an analog-to-digital converter. This forms the single averaged voltage which represents the sensor capacitance present at the selected channel</p>
<p id="p-0059" num="0058">For the example of <figref idref="DRAWINGS">FIG. 9</figref>, C<sub>X</sub>=34 pF, C<sub>OFF</sub>=14.4 pF, Cc=12.8 pF, C<sub>INT</sub>=19.2 pF and V<sub>REF</sub>=1 V.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>X</sub>=((2<i>*C</i><sub>OFF</sub><i>+Cc</i>)/(<i>C</i><sub>X</sub><i>+C</i><sub>OFF</sub><i>+Cc</i>))*<i>V</i><sub>REF </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>X</sub>=0.680 <i>V </i><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>0</sub>=(<i>Cc/C</i><sub>INT</sub>)*(<i>V</i><sub>REF</sub><i>&#x2212;V</i><sub>X</sub>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
The step change in output voltage with integration is 0.213 V
</p>
<p id="p-0060" num="0059">As for times Td and Te, the Phases Ta and Tb are respectively repeated for the next channel. For clarity, the value of C<sub>X </sub>(sensor capacitance) is shown to be different to the two channels.</p>
<p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. 10</figref> shows a touch panel <b>700</b> used to explain how ghosting is eliminated in accordance with principles of the invention. The touch panel <b>700</b> contains four overlapping row lines (R<b>1</b>-R<b>4</b>) and column lines (C<b>1</b>-C<b>4</b>). Those skilled in the art will recognize that the principles of the invention work with touch panels having any number of row and column lines, and, generally more than 4 of each. The touch panel <b>700</b> shows only four rows and columns merely to simplify the drawings.</p>
<p id="p-0062" num="0061">Simultaneous &#x201c;real&#x201d; touches occur at the intersection of row R<b>1</b> and column C<b>1</b> (&#x201c;R<b>1</b>C<b>1</b>&#x201d;) and at the intersection of row <b>4</b> and column <b>4</b> (R<b>4</b>C<b>4</b>), as indicated by the solid circles. The system, scanning all the row and column lines sequentially, senses touches as shown by the profiles <b>705</b> and <b>710</b>, that is, on column C<b>1</b> and C<b>4</b> and rows R<b>1</b> and R<b>4</b>. The profiles <b>705</b> and <b>710</b> indicate that touches could have occurred at any of the intersections of these row and column lines, that is, at the combinations R<b>1</b>C<b>1</b>, R<b>1</b>C<b>4</b>, R<b>4</b>C<b>1</b>, and R<b>4</b>C<b>4</b>. The combinations at which touches did not occur (R<b>1</b>C<b>4</b> and R<b>4</b>C<b>1</b>) are called &#x201c;ghost touches,&#x201d; as indicated by hatched circles. It will be appreciated that the larger the number of simultaneous real touches, the larger the number of ghost touches that must be processed and eliminated from consideration.</p>
<p id="p-0063" num="0062">In accordance with the principles of the invention, the system sequentially scans the individual row and column lines (self capacitance) to determine a set of &#x201c;candidate&#x201d; touch locations (e.g., the set containing R<b>1</b>C<b>1</b>, R<b>1</b>C<b>4</b>, R<b>4</b>C<b>1</b>, and R<b>4</b>C<b>4</b>). Next, these combinations, and only these combinations, are sensed using mutual capacitance. Only the real touch locations will indicate the presence of an overlying object. In this way, embodiments of the invention require only searches on a linear order (e.g., number of rows+the number of columns, since the number of mutual capacitance touches that must be considered are of the same order) to disambiguate real touches from ghost touches.</p>
<p id="p-0064" num="0063">In mutual capacitance mode, the steps are changed from those described above, to allow for cancellation of mutual capacitance.</p>
<p id="p-0065" num="0064">Again referring to <figref idref="DRAWINGS">FIGS. 5A and 5B</figref>, in the Reset phase, C<sub>X </sub>is discharged, C<sub>INT </sub>is charged to &#x2212;V<sub>REF</sub>, and C<sub>OFF </sub>is charged to V<sub>REF</sub>. C<sub>U </sub>for all the unselected lines are discharged, and C<sub>U </sub>for the selected line (e.g., C<sub>U-R1C1</sub>) is charged to &#x2212;V<sub>REF</sub>. In the Measurement phase, C<sub>INT </sub>is coupled across the operational amplifier <b>420</b>, and C<sub>X </sub>is connected to the negative terminal of the operational amplifier <b>420</b>. Both ends of all the C<sub>X </sub>is are connected to V<sub>REF</sub>, so their charge does not change. C<sub>U </sub>for the selected line (through the switch S<b>3</b>) is charged to V<sub>REF</sub>. The output of operational amplifier <b>420</b> for the selected line is given by Equation (8):
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>0</sub>=Constant*<i>V</i><sub>REF</sub><i>*C</i><sub>U-R1C1</sub><i>/C</i><sub>INT</sub><i>+V</i><sub>REF</sub>*(<i>C</i><sub>X</sub><i>&#x2212;C</i><sub>OFF</sub>)/<i>C</i><sub>INT</sub>&#x2003;&#x2003;Equation (9)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
In this example, Constant equals 2 because flipping the polarity magnifies the effect of the mutual capacitance.
</p>
<p id="p-0066" num="0065">Comparing Equations (2) and (9), it is readily apparent that V<sub>0 </sub>contains the self-capacitance measurement of Equation (2). As explained below, the difference between these two equations, indicating a mutual capacitance between lines, can be used to disambiguate ghost touches from real touches.</p>
<p id="p-0067" num="0066">In one embodiment, the selected sensor (i.e., one row for column measurement and one column for a row measurement) is driven to V<sub>REF </sub>during the discharge phase and to ground during the integrate phase. Alternatively, the selected sensor can be held at ground all the time, in which case Constant has the value of 1.</p>
<p id="p-0068" num="0067">The output can be converted to a digital code by an ADC. When the digital output from the normal measurement (e.g., given by Equation (2) above) is subtracted from the mutual capacitance measurement (Equation (9)), the mutual capacitance between a row and column can be deduced. This result is used to resolve the ambiguity in the position when multiple simultaneous touches are present.</p>
<p id="p-0069" num="0068"><figref idref="DRAWINGS">FIG. 11</figref> is a flow chart of the steps of a process of determining the location of an object adjacent to a touch sensor in accordance with one embodiment of the invention, utilizing both self capacitance and mutual capacitance. After the start step <b>801</b>, in the step <b>805</b> the process selects the next line (e.g., R<b>1</b>) to read. In the step <b>805</b>, the reset phase, the process resets the mutual capacitances of all the lines (e.g., the capacitive sensing elements connected to each of R<b>1</b>-R<b>4</b> and C<b>1</b>-C<b>4</b>), and in the step <b>815</b> the process charges the sensor on the currently selected line and reads the voltage on it. A voltage above a predetermined threshold value indicates the presence of an object on the selected line. In the step <b>820</b>, the process determines whether there are additional lines to read. If so, the process loops back to the step <b>805</b>. Otherwise, the process continues to the step <b>825</b>. The steps <b>805</b>, <b>810</b>, and <b>815</b> are part of a self-capacitance measuring stage, in which all the lines are individually read.</p>
<p id="p-0070" num="0069">In the step <b>825</b>, the process determines whether there have been multiple locations at which a touch has been sensed. If the process determines that objects are simultaneously present at multiple locations, the process must consider and exclude any ghost touches. If there is only one touch, ghost touches do not have to be considered. Thus, if in the step <b>830</b> the process determines that it must identify and exclude ghost locations, the process continues to the step <b>835</b>. Otherwise, the process jumps to the step <b>840</b>, where it ends. In the step <b>835</b>, the process excludes any ghost locations and then continues to the step <b>840</b>.</p>
<p id="p-0071" num="0070"><figref idref="DRAWINGS">FIG. 12</figref> shows more detailed components of the step <b>835</b> in accordance with one embodiment of the invention. The component <b>835</b> starts in the step <b>850</b>, where parameters are initialized, such as by setting the &#x201c;next&#x201d; candidate location to the first candidate location. Next, in the step <b>851</b>, the process selectively enables the mutual capacitance at the next candidate location (e.g., Equation (9) above) and, in the step <b>852</b>, determines the difference between this reading and the corresponding reading when the mutual capacitance is disabled. In the step <b>853</b>, the process determines whether there is any difference and, if there is, proceeds to the step <b>854</b>, in which the location is classified as a &#x201c;real&#x201d; touch location. From step <b>854</b>, the process continues to the step <b>855</b>. If, in the step <b>853</b>, the process determines that there is no difference between the two readings, the process identifies the location as a &#x201c;ghost&#x201d; location, excluding it as a real touch location, and proceeds to the step <b>855</b>. In the step <b>855</b>, the process determines whether there are any more candidate locations to check. If there are, the process loops back to the step <b>851</b>. Otherwise, the process proceeds to the step <b>856</b>, where it ends.</p>
<p id="p-0072" num="0071">After the actual touch locations have been determined, they can be transmitted to any downstream application programs that uses them as input.</p>
<p id="p-0073" num="0072">In accordance with the invention, a touchscreen controller uses a single integrated circuit to perform both self-capacitance and mutual capacitance measurements to resolve multiple simultaneous touches in a linear number of measurements. The controller cancels mutual capacitances during the self-capacitance stage and selectively enables mutual capacitance during the mutual capacitance stage. In both stages, the controller converts sensor capacitance in the touchscreen to a directly proportional voltage. Touchscreens in accordance with the invention null the effect of mutual capacitance and therefore have increased dynamic range.</p>
<p id="p-0074" num="0073">It will be readily apparent to one skilled in the art that other modifications may be made to the embodiments without departing from the spirit and scope of the invention as defined by the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>We claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A touchscreen controller system for sensing one or more objects adjacent to a surface of a touch panel comprising:
<claim-text>a plurality of sense lines arranged adjacent to the surface of the touch panel, wherein adjacent sense lines have a mutual capacitance;</claim-text>
<claim-text>a plurality of capacitive sensing elements each coupled to one of the sense lines;</claim-text>
<claim-text>a voltage measurement circuit that converts a charge on a selected capacitive sensing element into a corresponding voltage that indicates whether an object is adjacent to the surface of the touch panel; and</claim-text>
<claim-text>control logic configured to selected sense lines for reading and to drive mutual capacitances between selected and unselected sense lines to the same potential during a self-capacitance measuring stage and to drive mutual capacitances between selected and unselected sense lines to different potentials during a mutual capacitance measuring stage,</claim-text>
<claim-text>wherein the voltage measurement circuit comprises an operational amplifier having a feedback loop that includes an integrating capacitor, the operational amplifier and the integrating capacitor formed on a single integrated circuit, and wherein the voltage measurement circuit comprises an offset cancellation capacitor in parallel with the integrating capacitor, the offset cancellation capacitor configured to provide a minimum feedback factor for the operational amplifier to alleviate a variation in a feedback factor caused by a variation in an external parasitic capacitor.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The touchscreen controller system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the sense lines are arranged as row and column lines that form a grid pattern.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The touchscreen controller system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the self-capacitance measuring stage comprises individually reading a capacitance on each of the capacitive sensing elements to determine whether an object is adjacent thereto.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The touchscreen controller system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the mutual capacitance measuring stage comprises reading a capacitance on combinations of capacitance sensing elements to determine whether an object is adjacent thereto.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The touchscreen controller system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the voltage measurement circuit generates a voltage differential proportional to a capacitance of the object and the integrating capacitor.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. A touchscreen controller system for sensing one or more objects adjacent to a surface of a touch panel comprising:
<claim-text>a plurality of sense lines arranged adjacent to the surface of the touch panel, wherein adjacent sense lines have a mutual capacitance;</claim-text>
<claim-text>a plurality of capacitive sensing elements each coupled to one of the sense lines;</claim-text>
<claim-text>a voltage measurement circuit that converts a charge on a selected capacitive sensing element into a corresponding voltage that indicates whether an object is adjacent to the surface of the touch panel; and</claim-text>
<claim-text>control logic configured to selected sense lines for reading and to drive mutual capacitances between selected and unselected sense lines to the same potential during a self-capacitance measuring stage and to drive mutual capacitances between selected and unselected sense lines to different potentials during a mutual capacitance measuring stage,</claim-text>
<claim-text>wherein the voltage measurement circuit generates a voltage differential proportional to a capacitance of the object and the integrating capacitor.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The touchscreen controller system of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the sense lines are arranged as row and column lines that form a grid pattern.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The touchscreen controller system of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the self-capacitance measuring stage comprises individually reading a capacitance on each of the capacitive sensing elements to determine whether an object is adjacent thereto.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The touchscreen controller system of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the mutual capacitance measuring stage comprises reading a capacitance on combinations of capacitance sensing elements to determine whether an object is adjacent thereto.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The touchscreen controller system of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the voltage measurement circuit comprises an operational amplifier having a feedback loop that includes an integrating capacitor, wherein the operational amplifier and the integrating capacitor are formed on a single integrated circuit.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The touchscreen controller system of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the voltage measurement circuit comprises an offset cancellation capacitor in parallel with the integrating capacitor.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The touchscreen controller system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the offset cancellation capacitor is configured to provide a minimum feedback factor for the operational amplifier to alleviate a variation in a feedback factor caused by a variation in an external parasitic capacitor. </claim-text>
</claim>
</claims>
</us-patent-grant>
