<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08625386-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08625386</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13426911</doc-number>
<date>20120322</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<us-term-extension>98</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>11</class>
<subclass>C</subclass>
<main-group>7</main-group>
<subgroup>10</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>3652385</main-classification>
<further-classification>36518512</further-classification>
<further-classification>36518904</further-classification>
<further-classification>711103</further-classification>
<further-classification>711150</further-classification>
<further-classification>714  622</further-classification>
<further-classification>714  623</further-classification>
<further-classification>358  114</further-classification>
<further-classification>358  116</further-classification>
</classification-national>
<invention-title id="d2e53">Non-volatile memory device, circuit board, printing material container and printer</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5432922</doc-number>
<kind>A</kind>
<name>Polyzois et al.</name>
<date>19950700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714  623</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7296128</doc-number>
<kind>B2</kind>
<name>Lee</name>
<date>20071100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711165</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>8307149</doc-number>
<kind>B2</kind>
<name>Honda et al.</name>
<date>20121100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711103</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2005/0182892</doc-number>
<kind>A1</kind>
<name>Nakanishi et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2011/0208905</doc-number>
<kind>A1</kind>
<name>Shaeffer et al.</name>
<date>20110800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711103</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2012/0047410</doc-number>
<kind>A1</kind>
<name>Sato et al.</name>
<date>20120200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2012/0092696</doc-number>
<kind>A1</kind>
<name>Nakano</name>
<date>20120400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>JP</country>
<doc-number>63-279347</doc-number>
<date>19881100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>JP</country>
<doc-number>04-305657</doc-number>
<date>19921000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>JP</country>
<doc-number>2004-280752</doc-number>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>8</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>36518512</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>36518904</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>3652385</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>711103</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>711150</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>714  622</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>714  623</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>358  114-  118</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>12</number-of-drawing-sheets>
<number-of-figures>21</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20130250710</doc-number>
<kind>A1</kind>
<date>20130926</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Nakano</last-name>
<first-name>Shuichi</first-name>
<address>
<city>Shiojiri</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Guan</last-name>
<first-name>Lim Cheow</first-name>
<address>
<city>Singapore</city>
<country>SG</country>
</address>
</addressbook>
<residence>
<country>SG</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Nakano</last-name>
<first-name>Shuichi</first-name>
<address>
<city>Shiojiri</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Guan</last-name>
<first-name>Lim Cheow</first-name>
<address>
<city>Singapore</city>
<country>SG</country>
</address>
</addressbook>
</inventor>
</inventors>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Seiko Epson Corporation</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Byrne</last-name>
<first-name>Harry W</first-name>
<department>2824</department>
</primary-examiner>
<assistant-examiner>
<last-name>Reidlinger</last-name>
<first-name>Lance</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A non-volatile memory device includes first and second memory regions to store data and a memory control unit. Each of the first and second memory regions is configured by a plurality of physical pages. Each of the physical pages is configured by a plurality of regions corresponding to a plurality of logical addresses. The memory control unit performs control of batch erasing and batch writing on every physical page. When a first physical page in the first memory region includes a first region corresponding to a first logical address, which is a target to be written, and when a second physical page in the second memory region includes a second region corresponding to the first logical address, which is a target to be written, the memory control unit selects either the first physical page or the second physical page as a physical page for writing.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="101.77mm" wi="216.41mm" file="US08625386-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="216.07mm" wi="120.57mm" orientation="landscape" file="US08625386-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="224.96mm" wi="206.16mm" orientation="landscape" file="US08625386-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="248.84mm" wi="162.90mm" orientation="landscape" file="US08625386-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="229.62mm" wi="160.19mm" orientation="landscape" file="US08625386-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="241.72mm" wi="159.77mm" orientation="landscape" file="US08625386-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="229.02mm" wi="164.17mm" orientation="landscape" file="US08625386-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="265.18mm" wi="166.79mm" file="US08625386-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="190.33mm" wi="167.47mm" file="US08625386-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="246.38mm" wi="167.98mm" file="US08625386-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="234.10mm" wi="113.96mm" orientation="landscape" file="US08625386-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="253.92mm" wi="169.16mm" file="US08625386-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="229.79mm" wi="166.20mm" file="US08625386-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND ART</heading>
<p id="p-0002" num="0001">The present invention relates to a non-volatile memory device, a printing material container, a printer or the like.</p>
<p id="p-0003" num="0002">As an ink cartridge (printing material container) used in a printer of ink jet type, there is an ink cartridge to which a memory device is installed. In this memory device, for example, information such as colors of inks and ink consumption is stored. Data regarding the ink consumption is transmitted to the memory device from a printer main body (host device) and is written in a non-volatile memory or the like included in the memory device. However, since the ink cartridge is generally configured to be exchangeable, there are concerns that a bad connection may easily occur in an electrical connection portion and if a communication error occurs due to the bad connection, erroneous data may be written.</p>
<p id="p-0004" num="0003">Regarding this problem, for example, a technique which continues control using data written in another memory region even when data corruption occurs during writing by providing a plurality of memory regions in a memory and by alternately writing data in the memory regions is disclosed in JP-A-2004-280752.</p>
<p id="p-0005" num="0004">However, in this technique, there is a problem in that since the data is written by a physical page unit, when only a portion among logical addresses included in one physical page is desired to be rewritten, it is necessary to transmit the data regarding all of the logical addresses included in the physical page from the host device.</p>
<heading id="h-0002" level="1">SUMMARY</heading>
<p id="p-0006" num="0005">An aspect of the present invention relates to a non-volatile memory device including a control unit performing a communication process with a host device; a non-volatile memory including a first memory region and a second memory region storing data to be written transmitted from the host device; and a memory control unit performing reading and writing of the non-volatile memory, wherein the first memory region and second memory region are configured by each of the physical pages, wherein each of the physical pages is configured by a plurality of regions corresponding to a plurality of logical addresses, wherein the memory control unit performs control of batch erasing and batch writing on every physical page, wherein when a first physical page in the first memory region includes a first region corresponding to a first logical address, which is a target to be written, of the data to be written transmitted from the host device and when a second physical page in the second memory region includes a second region corresponding to the first logical address, which is a target to be written, the memory control unit selects either of the first physical page in the first memory region or the second physical page in the second memory region as a physical page for writing and selects the other as a physical page for reading, wherein when the first physical page is selected as the physical page for writing, the memory control unit writes the data to be written in the first region corresponding to the first logical address which is the target to be written, and wherein when the first physical page, selected as the physical page for writing, includes a third region corresponding to the second logical address which is not the target to be written and the second physical page, selected as the physical page for reading, includes a fourth region corresponding to the second logical address which is not the target to be written, the memory control unit copies and writes data stored in the fourth region corresponding to the second logical address which is not the target to be written in the third region corresponding to the second logical address which is not the target to be written.</p>
<p id="p-0007" num="0006">Another aspect of the present invention relates to a printing material container including the non-volatile memory device of any one described above.</p>
<p id="p-0008" num="0007">A still another aspect of the present invention relates to a printer including the non-volatile memory device and the host device of any one described above.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 1</figref> is a basic configuration example of a non-volatile memory device.</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 2A</figref> and <figref idref="DRAWINGS">FIG. 2B</figref> are explanatory diagrams illustrating erasing and writing processes of comparison examples.</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 3A</figref> and <figref idref="DRAWINGS">FIG. 3B</figref> are first and second explanatory diagrams illustrating erasing and writing processes when errors are not detected in the non-volatile memory device.</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 4A</figref> and <figref idref="DRAWINGS">FIG. 4B</figref> are third and fourth explanatory diagrams illustrating erasing and writing processes when the errors are not detected in the non-volatile memory device.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 5A</figref> and <figref idref="DRAWINGS">FIG. 5B</figref> are the first and second explanatory diagrams illustrating the erasing and writing processes when the errors are detected in the non-volatile memory device.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 6A</figref> and <figref idref="DRAWINGS">FIG. 6B</figref> are the third and fourth explanatory diagrams illustrating erasing and writing processes when the errors are detected in the non-volatile memory device.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 7</figref> is an example of a flowchart of writing control of the non-volatile memory device.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 8</figref> is an example of a flowchart of reading control of the non-volatile memory device.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 9A</figref>, <figref idref="DRAWINGS">FIG. 9B</figref> and <figref idref="DRAWINGS">FIG. 9C</figref> are explanatory diagrams of memory region selection by a memory control unit.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 10</figref> is an example of an ID packet, a command packet and a data packet received by the non-volatile memory device.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 11</figref> is a basic configuration example of a printer.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 12</figref> is a detailed example of a configuration of a printing material container.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 13A</figref> and <figref idref="DRAWINGS">FIG. 13B</figref> are detailed examples of a configuration of a circuit board on which the non-volatile memory device is installed.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF EXEMPLARY EMBODIMENTS</heading>
<p id="p-0022" num="0021">According to some aspects of the present invention, it is possible to provide a non-volatile memory device, a printing material container and a printer capable of attaining efficient writing process and improving reliability of data stored.</p>
<p id="p-0023" num="0022">An aspect of the present invention relates to the non-volatile memory device including a control unit to perform a communication process with a host device; a non-volatile memory including a first memory region and a second memory region to store data to be written transmitted from the host device; and a memory control unit to perform control of reading and writing of the non-volatile memory, wherein the first memory region and second memory region are configured by each of physical pages, wherein each of the physical pages of the physical pages is configured by a plurality of regions corresponding to a plurality of physical addresses, wherein the memory control unit performs control of batch erasing and batch writing on every physical page, wherein when a first physical page in the first memory region includes a first region corresponding to a first logical address, which is a target to be written, of the data to be written transmitted from the host device and when a second physical page in the second memory region includes a second region corresponding to the first logical address, which is a target to be written, the memory control unit selects either of the first physical page in the first memory region or the second physical page in the second memory region as a physical page for writing and selects the other as a physical page for reading, wherein when the first physical page is selected as the physical page for writing, the memory control unit writes the data to be written in the first region corresponding to the first logical address which is the target to be written, and wherein when the first physical page, selected as the physical page for writing, includes a third region corresponding to the second logical address which is not the target to be written and the second physical page, selected as the physical page for reading, includes a fourth region corresponding to the second logical address which is not the target to be written, data stored in the fourth region corresponding to the second logical address which is not the target to be written is copied and written in the third region corresponding to the second logical address which is not the target to be written.</p>
<p id="p-0024" num="0023">In this aspect of the present invention, it is possible to reduce data corruption or the like due to a communication error since the data to be written may be received with respect to the logical address of the target to be written and dummy data may be received with respect to the logical address which is not the target to be written. In addition, since it is possible to reduce a data amount of the data to be written, prepared by the host device, a capacity of data buffering of the host device can be reduced. As a result, it is possible to attain the efficient writing process and improve the reliability of the data stored.</p>
<p id="p-0025" num="0024">Moreover, in the aspect of the present invention, it is preferable that each of the first memory region and the second memory region stores memory region selection information in addition to the data to be written in every physical page or in every region corresponding to the logical address and the memory control unit reads the memory region selection information from both of the first physical page including the first region corresponding to the first logical address of the target to be written and the second physical page including the second region corresponding to the first logical address, selects either of the first physical page or the second physical page as the physical page for writing on the basis of the memory region selection information and selects the other as the physical page for reading.</p>
<p id="p-0026" num="0025">According to the aspect described above, the memory control unit can perform the writing and reading by alternately selecting the physical page in the first memory region and the physical page in the second memory region.</p>
<p id="p-0027" num="0026">In addition, in the aspect of the present invention, it is preferable that each of the first memory region and second memory region stores error detection information in addition to the data to be written in every region corresponding to the logical address, the memory control unit reads the error detection information from both of the first physical page including the first region corresponding to the first logical address of the target to be written and the second physical page including the second region corresponding to the first logical address and analyzes the presence of the error, and wherein when the error is detected from either of the first physical page or the second physical page, the memory control unit selects the physical page on which the error is detected as the physical page for writing and selects the physical page on which the error is not detected as the physical page for reading.</p>
<p id="p-0028" num="0027">According to the aspect described above, since when the error occurs on either of two physical pages including the region corresponding to the first logical address of the target to be written, the memory control unit can write the data to be written which is received from the host device in the first logical address of the target to be written of the physical page on which the error occurs and the data copied from the physical page for reading in the second logical address which is not the target to be written, it is possible to recover the data on the physical page on which the error occurs. As a result, it is possible to improve the reliability of the data stored.</p>
<p id="p-0029" num="0028">Furthermore, in the aspect of the present invention, it is preferable that the memory control unit performs control to sequentially increment the logical address on the basis of a clock signal from the host device.</p>
<p id="p-0030" num="0029">According to the aspect described above, the memory control unit can generate the corresponding logical address with respect to the data sequentially transmitted from the host device.</p>
<p id="p-0031" num="0030">In addition, in the aspect of the present invention, it is preferable that after receiving a command to be written from the host device, the control unit sequentially receives a receiving packet including the data to be written and writing enable bits to be written by every logical address unit in synchronization with the clock signal and when the memory control unit receives the receiving packet and writing enable bit to be active, the memory control unit sets the logical address corresponding to the receiving packet as the logical address of the target to be written.</p>
<p id="p-0032" num="0031">According to the aspect described above, when the writing enable bits are not active, the memory control unit can set the received data not to be written.</p>
<p id="p-0033" num="0032">In addition, another aspect of the present invention relates to a printing material container including the non-volatile memory device of any one described above.</p>
<p id="p-0034" num="0033">Moreover, a still another aspect of the present invention relates to a printer including the non-volatile memory device and the host device of any one described above.</p>
<p id="p-0035" num="0034">Hereinafter, favorable embodiments of the present invention will be described in detail. The embodiments which will be described hereinafter do not unreasonably limit the specification of the present invention described in the scope of the claims and all configurations described in the present embodiment are not limited to be essential as solutions of the present embodiment.</p>
<p id="p-0036" num="0035">1. A Non-Volatile Memory Device</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 1</figref> shows a basic configuration example of a non-volatile memory device <b>100</b> of a present embodiment. The non-volatile memory device <b>100</b> according to the embodiment of the present invention includes a control unit <b>110</b>, a memory control unit <b>120</b> and a non-volatile memory <b>130</b>. In addition, the non-volatile memory device <b>100</b> according to the present embodiment is not limited to the configuration shown in <figref idref="DRAWINGS">FIG. 1</figref> and various modifications such as a portion of configuration elements thereof may be omitted, a portion of configuration elements may be replaced with other configuration elements, or other configuration elements may be added can be allowed.</p>
<p id="p-0038" num="0037">The non-volatile memory device <b>100</b> of the present embodiment is a non-volatile memory device installed to an ink cartridge (printing material container) used in a printer of ink jet type, for example, and information such as ink consumption or the like transmitted from a printer main body (host device) is stored. In an ink cartridge (liquid container), a bad connection in an electrical connection portion which connects the printer main body and the non-volatile memory device may occur since the ink cartridge is generally configured to be exchangeable. For this reason, there is a concern that a communication error due to a bad connection of a data signal terminal and a writing error due to a bad connection of a power terminal during the writing may occur.</p>
<p id="p-0039" num="0038">According to the non-volatile memory device <b>100</b> of the present embodiment, since the host device transmits data to be written with respect to a logical address of a target to be written and transmits dummy data with respect to a logical address which is not a target to be written, it is possible to reduce data corruption due to the communication error. In addition, even when the data corruption occurs due to the writing error, the data can be recovered.</p>
<p id="p-0040" num="0039">The control unit <b>110</b> performs a communication process with a host device <b>400</b>. Specifically, the control unit <b>110</b> performs transmitting and receiving of a data signal SDA between the control unit and the host device <b>400</b> and receives a reset signal RST and a clock signal SCK from the host device <b>400</b>. In addition, the control unit <b>110</b> detects the presence of the communication error of the received data. The detection of the communication error can be performed using a technique such as parity check, for example. The received data is, for example, the ink consumption of the ink cartridge of the printer or the like.</p>
<p id="p-0041" num="0040">The non-volatile memory <b>130</b> is a non-volatile memory in which, for example, batch erasing or batch writing is performed in a flash memory or the like and includes a first memory region MA1 and a second memory region MA2 for storing the data to be written transmitted from the host device <b>400</b>. The first and second memory regions MA1 and MA2 are respectively configured of a plurality of physical pages P0a to Pna and P0b to Pnb (n is a natural number) and each of the physical pages of the plurality of physical pages P0a to Pna and P0b to Pnb is configured of regions corresponding to a plurality of logical addresses. For example, the physical page P0a is configured of a region corresponding to logical addresses A0 and A1 and the P0b is also configured of the region corresponding to the logical addresses A0 and A1. The P0a and P0b are respectively included in separated memory regions MA1 and MA2 but correspond to the common logical addresses A0 and A1. In addition, a specific configuration of the first and second memory regions MA1 and MA2 will be described later.</p>
<p id="p-0042" num="0041">The memory control unit <b>120</b> performs control of reading and writing of the non-volatile memory <b>130</b>. Specifically, the memory control unit <b>120</b> outputs reading/writing control signals RD/WR and an address signal ADR to the non-volatile memory <b>130</b> and sends and receives the data to be written or the data to be read DATA.</p>
<p id="p-0043" num="0042">The memory control unit <b>120</b> performs control of batch erasing or batch writing on every physical page of P0a to Pna and P0b to Pnb. For example, when the physical page P0a is configured of the region corresponding to the logical addresses A0 and A1, the memory control unit <b>120</b> performs the control of erasing and writing with respect to the region corresponding to the logical addresses A0 and A1 of the physical page P0a.</p>
<p id="p-0044" num="0043">The memory control unit <b>120</b> selects either of the first physical page (for example, P0a) in the first memory region MA1 including the first region corresponding to the first logical address (for example, A0) of the target to be written of the data to be written, transmitted from the host device <b>400</b> or the second physical page (for example, P0b) in the second memory region MA2 including the second region corresponding to the first logical address (for example, A0) among the plurality of physical pages as a physical page for writing and selects the other as a physical page for reading. Then, the memory control unit <b>120</b> writes the data to be written in the first region corresponding to the first logical address (for example, A0) of the target to be written of the physical page for writing (for example, P0a).</p>
<p id="p-0045" num="0044">Furthermore, when the physical page for writing (for example, P0a) includes a third region corresponding to the second logical address (for example, A1) which is not the target to be written and the physical page for reading includes a fourth region corresponding to the second logical address (for example, A1) which is not the target to be written, the data stored in the fourth region corresponding to the second logical address (for example, A1) which is not the target to be written of the physical page for reading (for example, P0b) is copied and written in the third region corresponding to second logical address (for example, A1) which is not the target to be written of the physical page for writing (for example, P0a).</p>
<p id="p-0046" num="0045">By doing so, the host device <b>400</b> may transmit the data to be written with respect to the logical address of the target to be written and may transmit the dummy data with respect to the logical address which is not the target to be written, thereby reducing the data corruption due to the communication error. Moreover, since the data amount of the data to be written prepared by the host device <b>400</b> can be reduced, the capacity of data buffering of the host device <b>400</b> can be reduced. In addition, the erasing and writing control of the memory control unit <b>120</b> will be described in detail.</p>
<p id="p-0047" num="0046">Here, a plurality of the first logical addresses of the target to be written may be used and a plurality of the second logical addresses which is not the target to be written may be used.</p>
<p id="p-0048" num="0047">In each of the first memory region MA1 and the second memory region MA2, memory region selection information is stored on every physical pages P0a to Pna and P0b to Pnb or in every region corresponding to the logical addresses A0, A1, A2 and the like in addition to the data to be written.</p>
<p id="p-0049" num="0048">The memory control unit <b>120</b> reads the memory region selection information from both of the first physical page (for example, P0a) including the first region corresponding to the first logical address (for example, A0) of the target to be written and the second physical page (for example, P0b) including the second region corresponding to the first logical address (for example, A0). Then, on the basis of the memory region selection information, either of the first physical page (for example, P0a) or the second physical page (for example, P0b) is selected as the physical page for writing and the other is selected as the physical page for reading. By doing so, it is possible to alternately select the first physical page and the second physical page for performing the writing and reading. In addition, the memory region selection information will be described in detail later.</p>
<p id="p-0050" num="0049">In each of the first memory region MA1 and the second memory region MA2, error detection information is stored in every region corresponding to the logical addresses A0, A1, A2 and the like in addition to the data to be written.</p>
<p id="p-0051" num="0050">The memory control unit <b>120</b> reads the error detection information from both of the first physical page (for example, P0a) including the first region corresponding to the first logical address (for example, A0) of the target to be written and the second physical page (for example, P0b) including the second region corresponding to the first logical address (for example, A0) of the target to be written and analyzes the presence of error. When the error is detected from either of the first or second physical pages (for example, P0a or P0b), the physical page (for example, P0a) in which the error is detected is selected as the physical page for writing and the physical page (for example, P0b) in which the error is not detect is selected as the physical page for reading. The error detection can be performed using, for example, techniques of parity check, checksum or the like based on the error detection information.</p>
<p id="p-0052" num="0051">By doing so, when the error occurs on either of the two physical pages including the region corresponding to the logical address of the target to be written, it is possible to write the data to be written from the host device <b>400</b> in the logical address of the target to be written of the physical page on which the error occurs and the data copied from the physical page for reading in the logical address which is not the target to be written, therefore, the data on the physical page on which the error occurs can be recovered. Here, the erasing and writing control when the error is detected will be described in detail later.</p>
<p id="p-0053" num="0052">The memory control unit <b>120</b> performs control to sequentially increment the logical address on the basis of a clock signal SCK from the host device <b>400</b>. For example, when a receiving packet is configured by 16 bits, the memory control unit <b>120</b> increments the logical addresses every 16 clock cycle of the clock signal SCK and generates the logical addresses A0, A1, A2 and the like corresponding to each of the receiving packets.</p>
<p id="p-0054" num="0053">The control unit <b>110</b> sequentially receives the receiving packet including the data to be written and writing enable bits by every logical address unit in synchronization with the clock signal SCK after receiving a command to be written from the host device <b>400</b>. Subsequently, when the receiving packet in which the writing enable bits are active is received, the memory control unit <b>120</b> sets the logical address corresponding to the receiving packet as the logical address of the target to be written. By doing so, when the writing enable bits are inactive, the memory control unit <b>120</b> can set the received data not to be written in the non-volatile memory <b>130</b>. Furthermore, regarding the physical page on which even one of the logical addresses of the target to be written is not included, the memory control unit <b>120</b> can set the erasing and writing process not to be performed. Here, a detailed configuration of the receiving packet will be described later.</p>
<p id="p-0055" num="0054">The host device <b>400</b> is a printer main body, for example, and performs, for example, a printing process of the printer, a communication process with the non-volatile memory device <b>100</b>, a counting process of the ink consumption or the like. In addition, the host device <b>400</b> supplies a first power supply voltage (power supply voltage of high voltage) VDD and a second power supply voltage (power supply voltage of low voltage) VSS to the non-volatile memory device <b>100</b>.</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. 2A</figref> and <figref idref="DRAWINGS">FIG. 2B</figref> show diagrams illustrating the erasing and writing processes of comparison examples. The configuration in <figref idref="DRAWINGS">FIG. 2A</figref> and <figref idref="DRAWINGS">FIG. 2B</figref> shows a configuration of writing all of the received data from the host device in the non-volatile memory while the receiving packet does not include the writing enable bits as the comparison example. In order to simplify the description, only logical addresses A0 to A3 are shown and one physical page is assumed to be configured by two logical addresses.</p>
<p id="p-0057" num="0056">In each of the memory region MA1 and MA2, data and error detection bits (error detection information in a broad sense) are stored in every logical address. The data is shown with a hexadecimal number, for example, 0Fh shows the hexadecimal number 0F. The error detection bits (error detection information in the broad sense) are parity bits for the parity check, for example, and show OK when the error is not detected and NG when the error is detected.</p>
<p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. 2A</figref> shows a state before writing. The error occurs in a region corresponding to the logical address A0 of the physical page P0a and data corruption occurs. As shown in <figref idref="DRAWINGS">FIG. 2B</figref>, the host device can recover the data by writing new data 02h in the logical address A0. However, since the erasing and writing process is performed by the physical page unit, the host device needs to transmit not only the data 02h to be written in A0 but also the data 0Fh to be written in A1. That is, the host device needs to prepare and transmit the data to be written of not the logical address of which the data needs to be rewritten but all of the logical addresses which constitutes the physical page on which the logical address thereof is included.</p>
<p id="p-0059" num="0058">According to the non-volatile memory device <b>100</b> of the present embodiment, the host device <b>40</b> may transmit the dummy data to the logical address which does not need to be written, thereby, the capacity of data buffering of the host device <b>400</b> can be reduced.</p>
<p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. 3A</figref>, <figref idref="DRAWINGS">FIG. 3B</figref>, <figref idref="DRAWINGS">FIG. 4A</figref> and <figref idref="DRAWINGS">FIG. 4B</figref> shows diagrams illustrating the erasing and writing process when the error is not detected in the non-volatile memory device <b>100</b> of the present embodiment. In order to simplify the description, only logical addresses A0 to A3 are shown and one physical page is assumed to be configured by two logical addresses.</p>
<p id="p-0061" num="0060">In each of the memory regions MA1 and MA2, memory region selection information ASB-1 and ASB-2 are stored in every physical address, and data and error detection bits (error detection information in the broad sense) are stored in every logical address. The data is shown with the hexadecimal number and for example, 0Fh shows the hexadecimal number 0F. The error detection bits (error detection information in the broad sense) are parity bits for the parity check, for example, and show OK when the error is not detected and NG when the error is detected. Here, the memory region selection information ASB-1 and ASB-2 may be stored in every logical address.</p>
<p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. 3A</figref> shows a state of the non-volatile memory device <b>130</b> before writing. The control unit <b>110</b> receives a command to be written from the host device <b>400</b> and data 03h to be written in the logical address A0 and accommodates the received data 03h to be written in a register RG of the memory control unit <b>120</b>.</p>
<p id="p-0063" num="0062">Next, as shown in <figref idref="DRAWINGS">FIG. 3B</figref>, the memory control unit <b>120</b> reads the first physical page P0a including a first region R1 corresponding to the first logical address A0 of the target to be written and the second physical page P0b including a second region R2 corresponding to the first logical address A0 of the target to be written and detects the presence of error. Since the error is not detected in either of the physical pages P0a and P0b, the memory control unit <b>120</b> selects P0a as the physical page for writing and selects P0b as the physical page for reading on the basis of the memory region selection information ASB-1 and ASB-2 as described later.</p>
<p id="p-0064" num="0063">Next, as shown in <figref idref="DRAWINGS">FIG. 4A</figref>, the memory control unit <b>120</b> erases P0a. At this time, in the register RG, data 0Fh stored in a fourth region R4 corresponding to the second logical address A1 which is not the target to be written of P0b is accommodated. Subsequently, as shown in <figref idref="DRAWINGS">FIG. 4B</figref>, the memory control unit <b>120</b> writes a value accommodated in the register RG in P0a. In other words, the data 03h to be written is written in the first region R1 corresponding to the first logical address A0 of the target to be written. Then, the data 0Fh stored in the fourth region R4 corresponding to the second logical address A1 which is not the target to be written is copied and written in a third region R3 corresponding to the second logical address A1 which is not the target to be written. In addition, at this time, the memory region selection information ASB-1 is rewritten to 1. By doing so, when A0 or A1 is accessed at the next time, P0a is selected as the physical page for reading and P0b is selected as the physical page for writing.</p>
<p id="p-0065" num="0064">As can be seen from above, when the error is not detected, it is possible to alternately select the physical page in the first memory region MA1 and the physical page in the second memory region MA2 and perform the writing and reading.</p>
<p id="p-0066" num="0065"><figref idref="DRAWINGS">FIG. 5A</figref>, <figref idref="DRAWINGS">FIG. 5B</figref>, <figref idref="DRAWINGS">FIG. 6A</figref> and <figref idref="DRAWINGS">FIG. 6B</figref> show diagrams illustrating the erasing and writing process when the error is detect in the non-volatile memory device <b>100</b> of the present embodiment.</p>
<p id="p-0067" num="0066"><figref idref="DRAWINGS">FIG. 5A</figref> shows a state of the non-volatile memory <b>130</b> before writing. The error occurs in the region corresponding to the logical address A0 of the first physical page P0a and the data corruption occurs. The control unit <b>110</b> receives a command to be written from the host device <b>400</b> and data 03h to be written in the logical address A0 and accommodates the received data 03h to be written in the register RG of the memory control unit <b>120</b>.</p>
<p id="p-0068" num="0067">Next, as shown in <figref idref="DRAWINGS">FIG. 5B</figref>, the memory control unit <b>120</b> reads the error detection information from both of the first physical page P0a including the first region R1 corresponding to the first logical address A0 of the target to be written and the second physical page P0b including the second region R2 corresponding to the first logical address A0 of the target to be written and analyzes the presence of the error. Since the error is detected on P0a and the error is not detected on P0b, the memory control unit <b>120</b> selects the first physical page P0a on which the error is detected as the physical page for writing and selects the second physical page P0b in which the error is not detected as the physical page for reading.</p>
<p id="p-0069" num="0068">Next, as shown in <figref idref="DRAWINGS">FIG. 6A</figref>, the memory control unit <b>120</b> erases P0a. At this time, in the register RG, data 0Fh stored in a fourth region R4 corresponding to the second logical address A1 which is not the target to be written of P0b is accommodated.</p>
<p id="p-0070" num="0069">Subsequently, as shown in <figref idref="DRAWINGS">FIG. 6B</figref>, the memory control unit <b>120</b> writes a value accommodated in the register RG in P0a. In other words, the data 03h to be written is written in the first region R1 corresponding to the first logical address A0 of the target to be written. Then, the data 0Fh stored in the fourth region R4 corresponding to the second logical address A1 which is not the target to be written is copied and written in a third region R3 corresponding to the second logical address A1 which is not the target to be written. In addition, at this time, the memory region selection information ASB-1 is rewritten to 1. By doing so, when A0 or A1 is accessed at the next time, P0a is selected as the physical page for reading and P0b is selected as the physical page for writing.</p>
<p id="p-0071" num="0070"><figref idref="DRAWINGS">FIG. 6A</figref> and <figref idref="DRAWINGS">FIG. 6B</figref> shows a case when the error occurs in A0 of P0a of the target to be written but for example, even when the error occurs in A1 of P0a which is not the target to be written, the host device <b>400</b> sets A0 as the target to be written and transmits the command to be written thereby the error in A1 of P0a which is not the target to be written can be recovered.</p>
<p id="p-0072" num="0071">As can be seen from the above, when the error is detected from either of the two physical pages including the region corresponding to the logical address of the target to be written, the physical page on which the error is detected is selected as the physical page for writing and the physical page on which the error is not detected is selected as the physical page for reading. When the logical address on which the error occurs is the target to be written, the data is updated with new data from the host device and when the logical address on which the error occurs is not the target to be written, data from the physical page on which the error is not detected is copied and written. The copied data is data written at the previous access time or the access time before the previous access time.</p>
<p id="p-0073" num="0072">By doing so, when the error occurs on either of the two physical pages including the region corresponding to the logical address of the target to be written, since the data to be written from the host device <b>400</b> and the copied data from the physical page on which the error does not occur can be written on the physical page on which the error occurs, the data on the physical page on which the error occurs can be recovered.</p>
<p id="p-0074" num="0073">Furthermore, by transmitting the command to be written without recognition whether on which physical page the error occurs, the host device <b>400</b> can recover all of the data included on the physical page thereof if the error occurs on the physical page including the region corresponding to the logical address of the target to be written.</p>
<p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. 7</figref> is an example of a flowchart of writing control in the non-volatile memory device <b>100</b> according to the present embodiment.</p>
<p id="p-0076" num="0075">First, the control unit <b>110</b> receives the command and data to be written from the host device <b>400</b> (step S<b>1</b>). Specifically, the control unit <b>110</b> decodes the received command and when the received command is the command to be written, the control unit <b>110</b> sequentially receives at least one receiving packet (data packet) including the data to be written and the writing enable bits after the command. The memory control unit <b>120</b> sequentially increments the logical address on the basis of the clock signal SCK from the host device <b>400</b>. Subsequently, when the receiving packet in which the writing enable bits are active is received, the logical address corresponding to the receiving packet is set as the logical address of the target to be written. The data to be written of the logical address of the target to be written is accommodated in the register RG of the memory control unit <b>120</b>.</p>
<p id="p-0077" num="0076">Next, the memory control unit <b>120</b> reads information stored on physical pages Pia and Pib (i is an integer of 0 or more) including the region corresponding to the logical address of the target to be written (step S<b>12</b>). Subsequently, the error detection information of the physical pages Pia and Pib are analyzed and the presence of error is detected (step S<b>3</b>).</p>
<p id="p-0078" num="0077">Next, the memory control unit <b>120</b> determines whether there is the error on either of physical pages Pia and Pib on the basis of the result of error detection (step S<b>4</b>). When the error is not detected on either page, the physical page for writing is selected on the basis of the memory selection information ASB-1 and ASB-2 (step S<b>5</b>). When the error is detected on any page, the physical page on which the error is detected is selected as the physical page for writing (step S<b>6</b>).</p>
<p id="p-0079" num="0078">Next, the memory control unit <b>120</b> erases the information stored in the physical page for writing (step S<b>7</b>). Then, the memory control unit <b>120</b> determines whether the logical address which is not the target to be written is included on the physical page for writing (step S<b>8</b>). When the logical address which is not the target to be written is not included, that is, when all of the logical addresses included on the physical page for writing are the targets to be written, the data to be written accommodated in the register RG is written on the physical page for writing (step S<b>10</b>). On the other hand, when the logical address which is not the target to be written is included, the data to be written in the logical address which is not the target to be written is copied in the register RG from the other physical page (physical page for reading) (step S<b>9</b>) and the value of the register RG is written on the physical page for writing (step S<b>10</b>).</p>
<p id="p-0080" num="0079">Here, when the errors are detected on both of the two physical pages Pia and Pib, not shown, the writing process is not performed and the control unit <b>110</b> may be arranged to transmit an error code to the host device <b>400</b>. However, the possibility that the errors may occur on both of the two physical pages Pia and Pib is extremely low. The reason is that the writing error may be caused due to the bad connection of a power supply terminal during the writing but writing on both of the two physical pages Pia and Pib at the same time hardly occur.</p>
<p id="p-0081" num="0080"><figref idref="DRAWINGS">FIG. 8</figref> is an example of a flowchart of reading control in the non-volatile memory device <b>100</b> according to the present embodiment.</p>
<p id="p-0082" num="0081">First, the control unit <b>110</b> receives a command to be read from the host device <b>400</b> (step S<b>11</b>). Specifically, the control unit <b>110</b> decodes the received command and recognizes that the received command is the command to be read. The memory control unit <b>120</b> sequentially increments the logical address on the basis of the clock signal SCK from the host device <b>400</b>.</p>
<p id="p-0083" num="0082">Next, the memory control unit <b>120</b> reads information stored on physical pages Pia and Pib (i is an integer of 0 or more) including the region corresponding to the logical address of the target to be read (step S<b>2</b>). Subsequently, the error detection information on the physical pages Pia and Pib are analyzed and the presence of error is detected (step S<b>13</b>).</p>
<p id="p-0084" num="0083">Next, the memory control unit <b>120</b> determines whether there is the error on either of physical pages Pia and Pib on the basis of the result of error detection (step S<b>14</b>). When the error is not detected on either page, the physical page for reading is selected on the basis of the memory selection information ASB-1 and ASB-2 (step S<b>15</b>). When the error is detected on any page, the physical page on which the error is not detected is selected as the physical page for reading (step S<b>16</b>).</p>
<p id="p-0085" num="0084">Next, the memory control unit <b>120</b> reads the data stored on the physical page for reading and the control unit <b>110</b> transmits the data to be read to the host device <b>400</b> in synchronization with the clock signal SCK (step S<b>17</b>).</p>
<p id="p-0086" num="0085"><figref idref="DRAWINGS">FIG. 9A</figref>, <figref idref="DRAWINGS">FIG. 9B</figref> and <figref idref="DRAWINGS">FIG. 9C</figref> are diagrams illustrating memory region selection by the memory control unit <b>120</b>. Before executing the memory region selection, the memory control unit <b>120</b> detects the presence of error using the error detection information with respect to physical pages Pia and Pib of the target to be written or to be read. The memory control unit <b>120</b> selects the physical page for writing and the physical page for reading, as shown in <figref idref="DRAWINGS">FIG. 9A</figref>, on the basis of the error detection result. In other words, when the error is not detected (OK) on both of the physical pages Pia and Pib of the target to be written or to be read, the physical pages for writing and reading are selected on the basis of memory region selection information ASB. When the error is detected on any one of Pia and Pib (NG) and when the error is not detected on the other one (OK), the physical page on which the error is detected is selected as the physical page for writing and the physical page on which the error is not detected is selected as the physical page for reading. When the error is detected on both of Pia and Pib (NG), neither of the memory regions for writing and for reading is selected.</p>
<p id="p-0087" num="0086"><figref idref="DRAWINGS">FIG. 9B</figref> shows a diagram illustrating the memory region selection on the basis of the memory region selection information ASB. As described in <figref idref="DRAWINGS">FIG. 9A</figref>, when the error is not detected on either of Pia and Pib (OK), the physical page for writing and for reading is selected according to the memory region selection information ASB-1 and ASB-2 as shown in <figref idref="DRAWINGS">FIG. 9B</figref>.</p>
<p id="p-0088" num="0087">For example, when ASB-1 is 0 and ASB-2 is 0, the memory control unit <b>120</b> selects Pia as the physical page for writing and selects Pib as the physical page for reading. At the time of writing the data on Pia, the memory region selection information ASB-1 of Pia is rewritten from 0 to 1. By doing so, at the next time of writing the data, ASB-1 is changed into 1 and ASB-2 is changed into 0, therefore, the memory control unit <b>120</b> can write new data on Pib. At the time of writing the data on Pib, the memory region selection information ASB-2 on Pib is rewritten from 0 to 1. By doing so, at the next time of writing the data, the ASB-1 is changed into 1 and the ASB-2 is changed into 1, therefore, the memory control unit <b>120</b> can write the new data on Pia. At the time of writing the data on Pia, the memory region selection information ASB-1 on Pia is rewritten from 1 to 0.</p>
<p id="p-0089" num="0088">As can be seen from the above, by following a selection rule shown in <figref idref="DRAWINGS">FIG. 9B</figref>, it is possible to perform the writing and reading by alternately selecting Pia and Pib.</p>
<p id="p-0090" num="0089">Next, a case where the error is detected on any one of Pia and Pib and the error is not detected on the other will be described. In this case, as described in <figref idref="DRAWINGS">FIG. 9A</figref>, the physical page on which the error is detected is selected as the physical page for writing. For example, in a case of Pia on which the error is not detected and Pib on which the error is detected, Pib is selected as the physical page for writing and the data is written on Pib.</p>
<p id="p-0091" num="0090">Here, at the time of writing the data on Pib, there are cases that the memory region selection information ASB-2 on Pib is rewritten and is not rewritten. As shown in <figref idref="DRAWINGS">FIG. 9C</figref>, when ASB-1 is 1 and ASB-2 is 0, ASB-2 is rewritten to 1. In addition, when ASB-1 is 0 and ASB-2 is 1, ASB-2 is rewritten to 0. In other cases, ASB-2 is not rewritten. By doing so, after the data is written on Pib, the memory region selection information ASB-1 is arranged to be 0 and ASB-2 is arranged to be 0 or ASB-1 is arranged to be 1 and ASB-2 is arranged to be 1. Accordingly, by following the selection rule shown in <figref idref="DRAWINGS">FIG. 9B</figref>, at the next time of memory access, it is possible to write new data on Pia.</p>
<p id="p-0092" num="0091">According to the non-volatile memory device <b>100</b> of the present embodiment, when the error is not detected on either of the two physical pages including the logical address of the target to be written, the two physical pages are alternately selected and the writing and reading can be performed. In addition, when the error is detected from either of the two physical pages including the logical address of the target to be written, the physical page on which the error is detected is selected as the physical page for writing, the physical page on which the error is not detected is selected as the physical page for reading and the writing and reading can be performed.</p>
<p id="p-0093" num="0092"><figref idref="DRAWINGS">FIG. 10</figref> shows an example of an ID packet, a command pocket and a data packet received by the non-volatile memory device <b>100</b> according to the present embodiment.</p>
<p id="p-0094" num="0093">As shown in <figref idref="DRAWINGS">FIG. 10</figref>, an ID packet IDPK is a packet regarding ID information of the non-volatile memory device <b>100</b>, is configured by 8 bits of ID0 to ID7, for example, and a parity bit IP is added thereto. In addition, a command packet CMPK is configured by 8 bits of C0 to C7, for example, and a parity bit CP is added thereto. Moreover, a data packet DPK includes a data portion configured by 8 bits of D0 to D7, an writing enable bits WE and further includes a parity bit DP. The parity bits IP, CP and DP are bits added for the parity check and one parity bit is arranged to be added so as to be always an even number or an odd number.</p>
<p id="p-0095" num="0094">Each of the packets are transmitted in order of the ID packet IDPK, the command packet CMPK and the data packet DPK in synchronization with the clock signal SCK from the host device <b>400</b>. One data packet DPK corresponds to one logical address. An initial data packet DPK0 corresponds to the first logical address A0 and the next data packet DPK1 corresponds to the logical address A1.</p>
<p id="p-0096" num="0095">As described above, when the writing enable bits WE are active (for example, WE=1), the memory control unit <b>120</b> determines the corresponding logical address as the logical address of the target to be written. In addition, when the writing enable bits WE are inactive (for example, WE=0), the memory control unit <b>120</b> determines the corresponding logical address as the logical address which is not the target to be written. For example, as shown in <figref idref="DRAWINGS">FIG. 10</figref>, since in the initial data packet DPK0, WE is 0, the logical address A0 is determined as the logical address which is not the target to be written. Moreover, since in the data packet DPKm (m is a natural number), WE is 1, a logical address Am is determined as the logical address of the target to be written.</p>
<p id="p-0097" num="0096">According to the non-volatile memory device <b>100</b> of the present embodiment, by providing the writing enable bits WE, the logical address of the target to be written and the logical address which is not the target to be written can be distinguished. In addition, it is possible to set only the data of the data packet DPK corresponding to the logical address of the target to be written as the data to be written. As a result, since the data to be written may be received with respect to the logical address of the target to be written and the dummy data may be received with respect to the logical address which is not the target to be written, the data corruption due to the communication error can be reduced. Moreover, the data amount of data to be written prepared by the host device <b>400</b> can be reduced, thereby the capacity of data buffering of the host device <b>400</b> can be reduced.</p>
<p id="p-0098" num="0097">Here, the configurations of each packet in the non-volatile memory device <b>100</b> according to the present embodiment are not limited to the configuration as shown in <figref idref="DRAWINGS">FIG. 10</figref> and various modifications such as a portion of the configuration elements thereof is omitted, a portion of the configuration elements are replaced with other configuration elements, other configuration elements are added can be performed. For example, the number of bits in each of the packets may increase or decrease and the order of writing enable bits WE may be changed. In addition, the writing enable bits WE may be configured by not one bit but a plurality of bits.</p>
<p id="p-0099" num="0098">2. Printing Material Container and Printer</p>
<p id="p-0100" num="0099"><figref idref="DRAWINGS">FIG. 11</figref> shows a basic configuration example of a printer <b>500</b> according to the present embodiment. The printer <b>500</b> of the present embodiment includes a first non-volatile memory device <b>100</b>-<b>1</b> to nth (n is an integer of 2 or more) non-volatile memory device <b>100</b>-<i>n</i>, n circuit boards <b>200</b>-<b>1</b> to <b>200</b>-<i>n</i>, n printing material containers <b>300</b>-<b>1</b> to <b>300</b>-<i>n </i>and the host device <b>400</b>. Here, the printer <b>500</b> according to the present embodiment is not limited to the configuration in <figref idref="DRAWINGS">FIG. 11</figref> and various modifications such as a portion of the configuration elements thereof is omitted, a portion of the configuration elements are replaced with other configuration elements, other configuration elements are added can be performed.</p>
<p id="p-0101" num="0100">The first non-volatile memory device <b>100</b>-<b>1</b> to nth non-volatile memory device <b>100</b>-<i>n </i>respectively include reset terminals TRST, clock terminals TCK, data terminals TDA, a first power supply terminal TVDD and a second power supply terminal TVSS.</p>
<p id="p-0102" num="0101">A reset signal RST from the host device <b>400</b> is input in the reset terminal TRST. A clock signal CLK from the host device <b>400</b> is input in the clock terminal TCK. A data signal SDA sent and received between the non-volatile memory device and the host device <b>400</b> is input and output in the data terminal TDA. The data signal SDA includes the command to be read, the command to be written, the data to be written or the like from the host device <b>400</b>. The first power supply voltage VDD is supplied to the first power supply terminal TVDD from the host device <b>400</b> and the second power supply voltage VSS is supplied to the second power supply terminal TVSS from the host device <b>400</b>.</p>
<p id="p-0103" num="0102">As described above, each of these n non-volatile memory devices <b>100</b>-<b>1</b> to <b>100</b>-<i>n </i>includes the non-volatile memory <b>130</b> or the like and ID (Identification) information (for example, ID=1, ID=2, ID=3 or the like), the ink consumption, ink color information and the like for identifying the printing material containers (for example, an ink cartridge or the like) <b>300</b>-<b>1</b> to <b>300</b>-<i>n </i>are stored therein.</p>
<p id="p-0104" num="0103">The host device <b>400</b> (printer main body) supplies the clock signal CLK to the non-volatile memory devices <b>100</b>-<b>1</b> to <b>100</b>-<i>n </i>and performs a communication process of the data signal SDA among the non-volatile memory devices <b>100</b>-<b>1</b> to <b>100</b>-<i>n</i>. When the host device <b>400</b> communicates with any one among the non-volatile memory devices <b>100</b>-<b>1</b> to <b>100</b>-<i>n</i>, the ID packet IDPK is transmitted with respect to all of the non-volatile memory devices <b>100</b>-<b>1</b> to <b>100</b>-N. When the ID information included in the received ID packet corresponds to the ID information stored in the non-volatile memory device itself, the non-volatile memory devices <b>100</b>-<b>1</b> to <b>100</b>-<i>n </i>which receive the ID pack IDPK determine themselves as partners of communication with the host device and perform the communication process with the host device according to the command (to be read or to be written) included in the command packet CMPK which is received later. In addition, the host device <b>400</b> controls a printing process executed by the printer <b>500</b>. The host device <b>400</b> includes the reset terminal HRST near the host, the clock terminal HCK near the host, the data terminal HDA near the host, the first power supply terminal HVDD near the host and the second power supply terminal HVSS near the host. The host device <b>400</b> counts the used ink amount every time when the printing process is performed and writes the ink consumption amount in the non-volatile memory device <b>100</b> on the basis of a counted value thereof.</p>
<p id="p-0105" num="0104">Since the ink cartridge (printing material container) is generally configured to be exchangeable, the bad connection easily occurs in the electrical connection portion to connect the printer main body (host device) and the non-volatile memory device. For this reason, there is concern that the communication error due to the bad connection of the data signal terminal, a writing error due to the bad connection of the power supply terminal during the writing, or the like may occur.</p>
<p id="p-0106" num="0105">As described above, according to the non-volatile memory device <b>100</b> of the present embodiment, when the error occurs on either of the two physical pages including the region corresponding to the logical address of the target to be written, the data to be written from the host device <b>400</b> and the copied data from the physical page on which the error does not occur can be written on the physical page on which the error occurs, therefore, it is possible to recover the data on the physical page on which the error occurs. By doing so, for example, even when the data such as the ink consumption (or remaining amount), stored in the non-volatile memory device <b>100</b>, becomes the maximum value (or minimum value) due to a memory error, the correct data can be written at the next time of access. As a result, when the non-volatile memory device is applied to the ink cartridge of the printer, a problem in which the ink cannot be used even though the ink is remaining can be reduced and the high reliability of the printer can be realized.</p>
<p id="p-0107" num="0106">Furthermore, according to the non-volatile memory device <b>100</b> of the present embodiment, the host device <b>400</b> may transmit the dummy data to the logical address which does not need to be written, thereby, the capacity of data buffering of the host device <b>400</b> can be reduced. As a result, it is possible to realize the efficient writing process.</p>
<p id="p-0108" num="0107"><figref idref="DRAWINGS">FIG. 12</figref> shows a detailed configuration example of a printing material container (ink cartridge or liquid container) <b>300</b> of the present embodiment. An ink chamber for containing the ink, not shown, is formed inside the printing material container <b>300</b>. In addition, in the printing material container <b>300</b>, an ink supply port <b>340</b> which communicates with the ink chamber is provided. The ink supply port <b>340</b> is arranged to supply the ink to a print head unit when the printing material container <b>300</b> is installed to the printer.</p>
<p id="p-0109" num="0108">The printing material container <b>300</b> includes a circuit board <b>200</b>. In the circuit board <b>200</b>, the non-volatile memory device <b>100</b> of the present embodiment is provided and the circuit board <b>200</b> stores the data such as the ink consumption amount and performs the transmitting and receiving of the data to and from the host device <b>400</b>. The circuit board <b>200</b> is realized by a print substrate, for example, and is provided on the surface of the printing material container <b>300</b>. In the circuit board <b>200</b>, the terminals of the first power supply terminal TVDD or the like are provided. Therefore, when the printing material container <b>300</b> is installed to the printer, these terminals and terminals near the printer are connected (electrical connection), therefore, sending and receiving of the power supply or the data are performed.</p>
<p id="p-0110" num="0109"><figref idref="DRAWINGS">FIG. 13A</figref> and <figref idref="DRAWINGS">FIG. 13B</figref> show detailed configuration example of the circuit board <b>200</b> on which the non-volatile memory device <b>100</b> of the present embodiment is provided. As shown in <figref idref="DRAWINGS">FIG. 13A</figref>, a terminal group including a plurality of terminals is provided on the surface (surface connected to the printer) of the circuit board <b>200</b>. The terminal group includes the first power supply terminal TVDD, the second power supply terminal TVSS, a reset terminal TRST, a clock terminal TCK and a data terminal TDA. Each of the terminals is realized by a metal terminal formed in a rectangular shape (substantially rectangular shape), for example. Each of the terminals is connected to the non-volatile memory device <b>100</b> through a wiring pattern layer or a through hole, not shown, provided on the circuit board <b>200</b>.</p>
<p id="p-0111" num="0110">As shown in <figref idref="DRAWINGS">FIG. 13B</figref>, on the rear surface (rear surface of the surface connected to the printer) of the circuit board <b>200</b>, the non-volatile memory device <b>100</b> of the present embodiment is provided. As described above, the ink consumption amount (ink amount information), the ID information, using history information, manufacturing information or the like are stored in the non-volatile memory device <b>100</b>. In addition, the present embodiment is described as above but it should be understood by those skilled in the art that various modifications may occur insofar as the modifications are substantially within new matters and effects of the present invention. Accordingly, the all examples of such modifications are included in the scope of the present invention. For example, in the specification or drawings, terms which are commonly described with different terms, which are used in the board sense or for the same meaning even at least one time, may be rewritten into the different terms thereof even in any parts of the specification or the drawings. Moreover, the configurations of the non-volatile memory device, the printing material container and the printer and the operation thereof are also not limited to the description of the present embodiment and variously modified embodiment may be applied.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A non-volatile memory device comprising:
<claim-text>a control unit performing a communication process with a host device;</claim-text>
<claim-text>a non-volatile memory including a first memory region and a second memory region storing data to be written transmitted from the host device; and</claim-text>
<claim-text>a memory control unit performing reading and writing of the non-volatile memory,</claim-text>
<claim-text>wherein the first memory region and second memory region are configured by each of physical pages,</claim-text>
<claim-text>wherein each of the physical pages is configured by a plurality of regions corresponding to a plurality of logical addresses,</claim-text>
<claim-text>wherein the memory control unit performs control of batch erasing and batch writing on every physical page,</claim-text>
<claim-text>wherein when a first physical page in the first memory region includes a first region corresponding to a first logical address, which is a target to be written, of the data to be written transmitted from the host device and when a second physical page in the second memory region includes a second region corresponding to the first logical address, which is a target to be written, the memory control unit selects either of the first physical page in the first memory region or the second physical page in the second memory region as a physical page for writing and selects the other as a physical page for reading,</claim-text>
<claim-text>wherein when the first physical page is selected as the physical page for writing, the memory control unit writes the data to be written in the first region corresponding to the first logical address which is the target to be written, and</claim-text>
<claim-text>wherein when the first physical page, selected as the physical page for writing, includes a third region corresponding to a second logical address which is not the target to be written and the second physical page, selected as the physical page for reading, includes a fourth region corresponding to the second logical address which is not the target to be written, the memory control unit copies and writes data stored in the fourth region corresponding to the second logical address which is not the target to be written in the third region corresponding to the second logical address which is not the target to be written.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The non-volatile memory device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>,
<claim-text>wherein each of the first memory region and the second memory region stores memory region selection information in addition to the data to be written in every physical page or in every region corresponding to the logical address, and</claim-text>
<claim-text>wherein the memory control unit reads the memory region selection information from both of the first physical page including the first region corresponding to the first logical address of the target to be written and the second physical page including the second region corresponding to the first logical address, selects either of the first physical page or the second physical page as the physical page for writing on the basis of the memory region selection information and selects the other as the physical page for reading.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The non-volatile memory device according to <claim-ref idref="CLM-00002">claim 2</claim-ref>,
<claim-text>wherein each of the first memory region and second memory region stores error detection information in addition to the data to be written in every region corresponding to the logical address,</claim-text>
<claim-text>wherein the memory control unit reads the error detection information from both of the first physical page including the first region corresponding to the first logical address of the target to be written and the second physical page including the second region corresponding to the first logical address and analyzes the presence of the error, and</claim-text>
<claim-text>wherein when the error is detected from either of the first physical page or the second physical page, the memory control unit selects the physical page on which the error is detected as the physical page for writing and selects the physical page on which the error is not detected as the physical page for reading.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The non-volatile memory device according to <claim-ref idref="CLM-00003">claim 3</claim-ref>,
<claim-text>wherein the memory control unit performs control to sequentially increment the logical address on the basis of a clock signal from the host device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The non-volatile memory device according to <claim-ref idref="CLM-00004">claim 4</claim-ref>,
<claim-text>wherein after receiving a command to be written from the host device, the control unit sequentially receives a receiving packet including the data to be written and writing enable bits by every logical address unit in synchronization with the clock signal, and</claim-text>
<claim-text>wherein when the memory control unit receives the receiving packet and writing enable bits to be active, the memory control unit sets the logical address corresponding to the receiving packet as the first logical address of the target to be written.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. A printing material container comprising:
<claim-text>the volatile memory device according to <claim-ref idref="CLM-00003">claim 3</claim-ref>.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A printer comprising:
<claim-text>the non-volatile memory device according to <claim-ref idref="CLM-00003">claim 3</claim-ref>; and</claim-text>
<claim-text>a host device which communicates with the non-volatile memory device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A circuit board comprising:
<claim-text>the non-volatile memory device according to <claim-ref idref="CLM-00003">claim 3</claim-ref>. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
