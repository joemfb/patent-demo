<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08624679-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08624679</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13086746</doc-number>
<date>20110414</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<us-term-of-grant>
<us-term-extension>230</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>03</class>
<subclass>L</subclass>
<main-group>7</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>331 18</main-classification>
<further-classification>331 25</further-classification>
<further-classification>331 47</further-classification>
<further-classification>331107 R</further-classification>
<further-classification>331108 B</further-classification>
</classification-national>
<invention-title id="d2e53">Method and apparatus for MEMS phase locked loop</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6041642</doc-number>
<kind>A</kind>
<name>Duncan</name>
<date>20000300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification> 73 2401</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6094102</doc-number>
<kind>A</kind>
<name>Chang et al.</name>
<date>20000700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
<classification-national><country>US</country><main-classification>331 17</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6249189</doc-number>
<kind>B1</kind>
<name>Wu et al.</name>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>331 18</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6285219</doc-number>
<kind>B1</kind>
<name>Pauls</name>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>327  3</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6585338</doc-number>
<kind>B2</kind>
<name>Harris</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
<classification-national><country>US</country><main-classification>321  4</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7042213</doc-number>
<kind>B2</kind>
<name>Greywall</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
<classification-national><country>US</country><main-classification>324244</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7173495</doc-number>
<kind>B1</kind>
<name>Kenny et al.</name>
<date>20070200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>331 49</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>7570125</doc-number>
<kind>B2</kind>
<name>Ostanin et al.</name>
<date>20090800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>331158</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2005/0280879</doc-number>
<kind>A1</kind>
<name>Gibson et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by applicant</category>
<classification-national><country>US</country><main-classification>358474</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2006/0034403</doc-number>
<kind>A1</kind>
<name>Huang et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375354</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2007/0188253</doc-number>
<kind>A1</kind>
<name>Sutardja</name>
<date>20070800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
<classification-national><country>US</country><main-classification>331176</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2009/0267837</doc-number>
<kind>A1</kind>
<name>Lin</name>
<date>20091000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
<classification-national><country>US</country><main-classification>342387</main-classification></classification-national>
</us-citation>
<us-citation>
<nplcit num="00013">
<othercit>Analog Devices, Inc., Fundamentals of Phase Locked Loops (PLLs), Analog Devices, MT-086 Tutorial, 10 pages, 2009.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00014">
<othercit>Abramovitch, Daniel, Phase-Locked Loops: A Control Centric Tutorial, <i>Proceedings of the American Control Conference</i>, 15 pages, May 8-10, 2002.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00015">
<othercit>Kester, Walt, Converting Oscillator Phase Noise to Time Jitter, Analog Devices, MT-008 Tutorial, 10 pages, 2009.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>10</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>331 25</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>331 47</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>331107 R</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>331108 B</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>331116 R</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>331 18</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>7</number-of-drawing-sheets>
<number-of-figures>18</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61324093</doc-number>
<date>20100414</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110254599</doc-number>
<kind>A1</kind>
<date>20111020</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Dikshit</last-name>
<first-name>Abhinav Kumar</first-name>
<address>
<city>Varanasi</city>
<country>IN</country>
</address>
</addressbook>
<residence>
<country>IN</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Kumar</last-name>
<first-name>Gadam Chetty Deva Phanindra</first-name>
<address>
<city>Andhra Pradesh</city>
<country>IN</country>
</address>
</addressbook>
<residence>
<country>IN</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Krishnaswamy</last-name>
<first-name>Anjan Kumar</first-name>
<address>
<city>Bangalore</city>
<country>IN</country>
</address>
</addressbook>
<residence>
<country>IN</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Dikshit</last-name>
<first-name>Abhinav Kumar</first-name>
<address>
<city>Varanasi</city>
<country>IN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Kumar</last-name>
<first-name>Gadam Chetty Deva Phanindra</first-name>
<address>
<city>Andhra Pradesh</city>
<country>IN</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Krishnaswamy</last-name>
<first-name>Anjan Kumar</first-name>
<address>
<city>Bangalore</city>
<country>IN</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Sunstein Kann Murphy &#x26; Timbers LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Analog Devices, Inc.</orgname>
<role>02</role>
<address>
<city>Norwood</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Chang</last-name>
<first-name>Joseph</first-name>
<department>2817</department>
</primary-examiner>
<assistant-examiner>
<last-name>Shin</last-name>
<first-name>Jeffrey</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The proper operation of a phase locked loop is determined by monitoring certain signals within the loop for their phase relationship or duty cycle. If a malfunction of the loop is detected, proper operation may be imposed or restored by resetting a phase-frequency detector, or by flipping the output of the phase-frequency detector.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="102.02mm" wi="187.54mm" file="US08624679-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="145.29mm" wi="158.75mm" file="US08624679-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="195.50mm" wi="152.99mm" file="US08624679-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="182.80mm" wi="158.75mm" file="US08624679-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="120.73mm" wi="158.75mm" file="US08624679-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="175.85mm" wi="158.75mm" file="US08624679-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="158.75mm" wi="113.28mm" file="US08624679-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="251.21mm" wi="208.28mm" file="US08624679-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">PRIORITY</heading>
<p id="p-0002" num="0001">This patent application claims priority from provisional U.S. patent application No. 61/324,093, filed Apr. 14, 2010, entitled, &#x201c;Method and Apparatus for MEMS Phase Locked Loop,&#x201d; and naming Abhinav Kumar Dikshit, Gadam Chetty Deva Phanindra Kumar, and Anjan Kumar Krishnaswamy as inventors [practitioner's file 2906/127], the disclosure of which is incorporated herein, in its entirety, by reference.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">TECHNICAL FIELD</heading>
<p id="p-0003" num="0002">The present invention relates to phase locked loops, and more particularly to phase locked loops driving oscillating MEMS structures.</p>
<heading id="h-0003" level="1">BACKGROUND ART</heading>
<p id="p-0004" num="0003">Some micro-electromechanical systems (&#x201c;MEMS&#x201d;) operate by driving a movable member into oscillation. For example, in a MEMS gyroscope, a drive signal is applied to a MEMS structure to force the structure into oscillation, preferably at its resonant frequency. The MEMS structure imparts a phase shift on the drive signal. The magnitude of the phase shift is a function of the proximity of the oscillating frequency of the structure to its resonant frequency. A phase locked loop (&#x201c;PLL&#x201d;) in the drive circuitry processes the phase data to adjust the drive frequency towards the resonant frequency. A PLL in the drive circuitry can, once it achieves phase lock, assist in maintaining the oscillation at the desired frequency.</p>
<heading id="h-0004" level="1">SUMMARY OF THE EMBODIMENTS</heading>
<p id="p-0005" num="0004">In a first embodiment, there is provided a method of driving an oscillating member. The method includes applying a drive signal to the oscillating member, the drive signal having a drive frequency; providing a first reference signal indicative of the phase shift imparted on the drive signal by the oscillating member; decreasing the drive frequency if the phase shift is less than ninety degrees, and increasing the drive frequency if the phase shift is between ninety and one hundred eighty degrees.</p>
<p id="p-0006" num="0005">In some embodiments, the method includes providing a second reference signal, the second signal having the same frequency as the drive signal, but leading the drive signal by ninety degrees; and determining the phase shift by determining the phase between the second reference signal and the first reference signal. In some embodiments, determining the phase difference between the second reference signal and the first reference signal includes determining whether an edge of the first reference signal leads or lags a corresponding edge of the second reference signal, wherein the corresponding edge occurs within one quarter of a period of the drive frequency from the edge of the first reference signal.</p>
<p id="p-0007" num="0006">In some embodiments, decreasing the drive frequency if the phase shift is less than ninety degrees, and increasing the drive frequency if the phase shift is between ninety and one hundred eighty degrees, includes generating a first control signal if the phase shift is less than ninety degrees, and generating a second control signal if the phase shift is greater than ninety degrees.</p>
<p id="p-0008" num="0007">In another embodiment, there is provided a method of addressing positive feedback in a circuit driving an oscillating member. The method includes: applying a drive signal having a drive frequency to the oscillating member; providing a first reference signal to a phase detector, the first reference signal indicative of the phase shift imparted on the drive signal by the oscillating member; providing a second reference signal to the phase detector, the second signal having the same frequency as the drive signal, but leading the drive signal by ninety degrees; generating a first control signal if a phase detector determines that the first reference signal leads the second reference signal; and resetting the phase detector if the first control signal is active at a falling edge of the second reference signal.</p>
<p id="p-0009" num="0008">In some embodiments, applying a drive signal includes generating the second reference signal; and producing the drive signal by imposing a phase shift of negative ninety degrees on the second reference signal, such that the second reference signal leads the drive signal by 90 degrees. In some embodiments, providing a second reference signal includes generating the drive signal; and producing the second reference signal by imposing a phase shift of 270 degrees on the reference signal, such that the second reference signal leads the drive signal by 90 degrees.</p>
<p id="p-0010" num="0009">Some embodiments also include generating a second control signal if a phase detector determines that the first reference signal lags the second reference signal; and resetting the phase detector if the second control signal is active at a falling edge of the second reference signal.</p>
<p id="p-0011" num="0010">In another embodiment, there is provides a A method of driving an oscillating member using a phase locked loop, which includes applying a drive signal having a drive frequency to the oscillating member; providing a reference signal indicative of the phase shift imparted on the drive signal by the oscillating member; comparing the phase of the drive signal to the reference signal in a phase detector; generating a first control signal if the reference signal lags the drive signal; and determining whether the duty cycle of the first control signal exceeds a predetermined percent; and increasing the frequency of the drive signal if the duty cycle of the first control signal exceeds the predetermined percent.</p>
<p id="p-0012" num="0011">In some embodiments, the predetermined percent is at least 25 percent, while in other embodiments the predetermined percent is at least 50 percent, and in yet other embodiments, the predetermined percent is at least 75 percent.</p>
<p id="p-0013" num="0012">In some embodiments, determining whether the duty cycle of the first control signal exceeds a predetermined percent includes determining whether the duty cycle of the first control signal exceeds a predetermined percent for at least a predetermined number of cycles of the drive signal, the predetermined number of cycles of the drive signal being at least two. In some embodiments, the predetermined number of cycles of the drive signal is at least three cycles.</p>
<p id="p-0014" num="0013">In one embodiment, there is provides a method of driving an oscillating member using a driver, wherein the driver provides a drive signal to the oscillating member, the drive signal having a drive frequency. The method includes determining whether the oscillating member is oscillating above a desired frequency; determining whether the driver is increasing the drive frequency; and resetting the driver if the oscillating member is oscillating above a desired frequency and the driver increasing the drive frequency.</p>
<p id="p-0015" num="0014">In another embodiment, a method of driving an oscillating member using a driver, wherein the driver provides a drive signal to the oscillating member, the drive signal having a drive frequency, includes determining whether the oscillating member is oscillating below a desired frequency; determining whether the driver is decreasing the drive frequency; and resetting the driver if the oscillating member is oscillating above a desired frequency and the driver decreasing the drive frequency.</p>
<p id="p-0016" num="0015">In one embodiment, there is provides a circuit for driving an oscillating member. The circuit includes: a variable-frequency oscillator having an oscillator output; an arrival-time detector having a first arrival-time detector input and a second arrival-time detector input, an up output and a down output, and a reset input, the first arrival-time detector input coupled to the oscillator output; a phase shifter having an phase shifter input and a phase shifter output, the phase shifter input coupled to the oscillator output; an oscillating member having a member input and a member output, the member input coupled to the phase shifter output, and the member output coupled to the second arrival-time detector input; an error detector having a first error detector input coupled to the up output of the arrival-time detector, and a second error detector input coupled to the down output of the arrival-time detector, and an error detector output coupled to the reset input of the arrival-time detector.</p>
<p id="p-0017" num="0016">Yet another embodiment provides a method of driving an oscillating member using a phase locked loop, in which the method includes: applying a drive signal having a drive frequency to the oscillating member; providing a first reference signal to a phase detector, the first reference signal indicative of the phase shift imparted on the drive signal by the oscillating member; providing a second reference signal to the phase detector, the second signal having the same frequency as the drive signal, but leading the drive signal by ninety degrees; generating a first control signal if a phase detector determines that the first reference signal leads the second reference signal, and generating a second control signal if a phase detector determines that the first reference signal lags the second reference signal; and transposing at least one of the first control signal and the second control signal is active at a falling edge of the drive signal.</p>
<p id="p-0018" num="0017">In one embodiment, applying a drive signal includes generating the second reference signal; and producing the drive signal by imposing a phase shift of negative ninety degrees on the second reference signal, such that the second reference signal leads the drive signal by 90 degrees. In another embodiment, providing a second reference signal includes: generating the drive signal; and producing the second reference signal by imposing a phase shift of 270 degrees on the reference signal, such that the second reference signal leads the drive signal by 90 degrees.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0019" num="0018">The foregoing features of embodiments will be more readily understood by reference to the following detailed description, taken with reference to the accompanying drawings, in which:</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1A</figref> schematically illustrates a perspective view of a movable MEMS structure;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 1B</figref> schematically illustrates an embodiment of a phase locked loop circuit driving an oscillating MEMS structure;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIGS. 1C</figref>, <b>1</b>D, <b>1</b>E, and <b>1</b>F schematically illustrate timing diagrams of certain signals within the phase locked loop of <figref idref="DRAWINGS">FIG. 1B</figref>;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 2</figref> schematically illustrates an embodiment of the start up and error detection and correction circuit of <figref idref="DRAWINGS">FIG. 1B</figref>;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 3</figref> schematically illustrates an embodiment of the PFD <b>126</b> circuit of <figref idref="DRAWINGS">FIG. 1B</figref>;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 4</figref> is a timing diagram of certain signals within the phase locked loop of <figref idref="DRAWINGS">FIG. 1B</figref>;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 5</figref> schematically illustrates an algorithm for assessing a signal within the phase locked loop;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 6</figref> graphically illustrates the phase shift imparted on the drive signal by a MEMS device at various oscillating frequencies;</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIGS. 7A-7C</figref> schematically illustrate a phase locked loop circuit driving an oscillating MEMS structure according to an alternate embodiment;</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 8</figref> schematically illustrates an algorithm for assessing a signal within the phase locked loop; and</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIGS. 9A</figref>, <b>9</b>B and <b>9</b>C are flow charts illustrating functions of various embodiments.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF SPECIFIC EMBODIMENTS</heading>
<p id="p-0031" num="0030">Various embodiments disclosed below provide methods and circuits for detecting a malfunction of a micro-electromechanical system (&#x201c;MEMS&#x201d;), and for correcting such a malfunction. To that end, a system monitors certain signals within the drive circuitry of the MEMS to determine whether the drive circuitry is malfunctioning. If so, circuits react to correct the malfunction and set the drive circuitry to proper operation.</p>
<p id="p-0032" num="0031">A system <b>100</b> with a movable MEMS structure <b>101</b> is schematically illustrated in <figref idref="DRAWINGS">FIG. 1A</figref>. To drive the MEMS structure <b>101</b> into oscillation, the MEMS system <b>100</b> includes a set of opposing drive fingers <b>102</b>, <b>103</b>. One of the fingers is on the movable MEMS structure <b>101</b>, and the other is on a substrate <b>104</b> that supports the moveable MEMS structure <b>101</b>. As such, the opposing fingers form a variable capacitor that changes capacitance as the movable MEMS structure <b>101</b> oscillates with respect to the substrate <b>104</b>.</p>
<p id="p-0033" num="0032">One of the fingers is coupled to an oscillating drive signal, and the other is coupled to a ground reference, for example. As the drive signal oscillates, charge flows to and from the finger to which the drive signal is coupled, resulting in a corresponding oscillating electrostatic force on the second finger. The oscillating electrostatic force, in turn, causes to movable MEMS structure <b>101</b> to oscillate by alternately drawing the fingers <b>102</b>, <b>103</b> closer together, and then allowing them to pull away from each other.</p>
<p id="p-0034" num="0033">The flow of charge to the variable capacitor <b>105</b> formed by the drive fingers <b>102</b>, <b>103</b> has a phase relationship to the drive signal. The phase shift is a function the oscillating frequency of the structure, and depends on the proximity of the oscillating frequency to the member's resonant frequency.</p>
<p id="p-0035" num="0034">The phase shift may be detected using a charge amplifier to produce a voltage signal representing the time-varying charge on the variable capacitor. The voltage signal is, in turn, input to a comparator. The comparator's output will, in a sense, be a digital representation of the drive signal, as phase-shifted by the MEMS. Accordingly, in one sense the comparator's output may be described as a signal that indicates (or is indicative of) the phase shift imparted on the drive signal by the oscillating member.</p>
<p id="p-0036" num="0035">Ideally, the movable MEMS structure <b>101</b> will oscillate at the same frequency as the oscillating drive signal, although achieving that frequency of mechanical oscillation may take some time after the oscillating drive signal is initially applied. If the movable MEMS structure <b>101</b> oscillates at its resonant frequency, the amplitude of the oscillation will be maximized, which is often desirable in the operation of MEMS systems. Therefore, it is desirable in some applications to achieve and maintain a target oscillation frequency in the movable MEMS structure <b>101</b>. A phase locked loop in the drive circuitry can help achieve and hold that oscillating frequency.</p>
<p id="p-0037" num="0036">To achieve and maintain the desired oscillating frequency, the embodiment <b>110</b> of <figref idref="DRAWINGS">FIG. 1B</figref> uses a phase locked loop (&#x201c;PLL&#x201d;) <b>120</b> in the drive circuitry. The PLL <b>120</b> senses and processes the phase shift. In proper operation, the PLL <b>120</b> will adjust the frequency of the VCO output signal (&#x201c;FVCO&#x201d;) <b>121</b> (which frequency may be known as the &#x201c;drive frequency&#x201d;) towards the desired oscillating frequency, which may be the resonant frequency of the movable structure <b>101</b>. A PLL <b>120</b> in the drive circuitry can also assist in maintaining the oscillation frequency at the desired frequency.</p>
<p id="p-0038" num="0037">The ability of the PLL <b>120</b> to achieve phase lock can be a function of several factors, such as start-up conditions, and the Q-factor of the MEMS oscillator. The PLL <b>120</b> may malfunction if, for example, the PLL <b>120</b> incorrectly interprets the phase information, or if it cannot detect the phase-shifted signal.</p>
<p id="p-0039" num="0038">In the embodiment of <figref idref="DRAWINGS">FIG. 1B</figref>, a voltage controlled oscillator (VCO) <b>122</b> produces a digital clock signal. A divider <b>123</b> then divides that signal by 512 to produce a lower-frequency output signal (FDIV) <b>124</b> (in other words, in this embodiment the frequency of FDIV is 1/512 of the frequency of FVCO). That output (FDIV) <b>124</b> of the divider <b>123</b> is supplied to a phase-frequency detector (PFD) <b>126</b>, and to a phase shifter <b>127</b> to shift its phase by negative ninety degrees prior to its application to the MEMS structure <b>101</b> as a drive signal. In some embodiments, phase shifter <b>127</b> causes a phase locked loop to drive a MEMS at a frequency other than the resonant frequency of the movable member by producing a phase shift of other than negative 90 degrees (i.e., greater or less than negative 90 degrees).</p>
<p id="p-0040" num="0039">The MEMS structure <b>101</b> imparts a phase shift on the drive signal, and the phase-shifted signal <b>128</b> is output to a comparator <b>125</b>. The comparator output (FREF) <b>129</b> is supplied to the PFD <b>126</b>, where it is compared to the FDIV signal <b>124</b> from the divider <b>123</b>. Thus, the comparator output (FREF <b>129</b>) may be described as a signal that indicates (or is indicative of) the phase shift imparted on the drive signal by the oscillating member.</p>
<p id="p-0041" num="0040">At its resonant frequency, the phase imparted by the MEMS structure <b>101</b> is ninety degrees, as illustrated by the graphs <b>600</b> of <figref idref="DRAWINGS">FIG. 6</figref>, in which curve <b>601</b> represents the amplitude of oscillation as a function of frequency, and curve <b>602</b> represents the phase shift as a function of the proximity of the oscillation to the resonant frequency of the MEMS structure <b>101</b>. The dashed line <b>603</b> identifies the resonant frequency of the movable MEMS structure <b>101</b>, and shows a corresponding phase shift of ninety degrees.</p>
<p id="p-0042" num="0041">The graphs <b>600</b> of <figref idref="DRAWINGS">FIG. 6</figref> also show that, if the movable MEMS structure <b>101</b> is oscillating at a frequency below its resonant frequency, then the phase shift imparted on the drive signal will be greater than ninety degrees, and perhaps as high as 180 degrees. Similarly, if the movable MEMS structure <b>101</b> is oscillating at a frequency above its resonant frequency, then the phase shift imparted on the drive signal will be less than ninety degrees, and perhaps as low as zero degrees. In other words, the greater the difference between the oscillating frequency and the resonant frequency, the greater the phase shift.</p>
<p id="p-0043" num="0042">As such, when the MEMS structure <b>101</b> is at its resonant frequency, the comparator output (FREF) <b>129</b> should be in phase with the first divider output (FDIV <b>124</b>). In other words, at its resonant frequency, the FREF <b>129</b> signal <b>129</b> should arrive at the PFD <b>126</b> simultaneously with the FDIV signal <b>124</b>.</p>
<p id="p-0044" num="0043">If those signals are not in phase, however, they will have a different arrival time at the PFD <b>126</b>. Such a difference in arrival time (e.g., phase) between FREF <b>129</b> and FDIV <b>124</b> indicate that the MEMS structure <b>101</b> is not oscillating at its resonant frequency, causing the PFD <b>126</b> to output an appropriate signal (&#x201c;UP&#x201d; as illustrated in <figref idref="DRAWINGS">FIG. 1C</figref>, or &#x201c;DN&#x201d; as illustrated in <figref idref="DRAWINGS">FIG. 1D</figref>) to the a charge pump (&#x201c;CP&#x201d;) and filter <b>132</b>, which translate the UP and DN signals to a VCO control signal <b>133</b>, so as to direct the VCO <b>122</b> to change frequency in the direction of the resonant frequency of the MEMS structure <b>101</b>. As such, the PLL <b>120</b> eventually adjusts the frequency of the drive signal until it locks at the resonant frequency of the MEMS structure <b>101</b>. The PFD <b>126</b> may also be known as an arrival-time detector, because it responds to differences in the arrival time of the FDIV <b>124</b> and FREF <b>129</b> signals.</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 1C</figref> schematically illustrates the signals FREF <b>129</b> and FDIV <b>124</b> for the case in which MEMS structure <b>101</b> is oscillating at less than its resonant frequency. In this case, the phase shift is greater than ninety degrees, such that FDIV <b>124</b> lags FREF <b>129</b>, and a rising edge of FREF <b>129</b> will reach the PFD <b>126</b> before the a rising edge of FDIV <b>124</b>. Specifically, in this illustration, the phase shift imparted by the MEMS structure <b>101</b> is 180 degrees, so that FREF <b>129</b> leads FDIV <b>124</b> by ninety degrees.</p>
<p id="p-0046" num="0045">The PFD <b>126</b>, which may be as illustrated in <figref idref="DRAWINGS">FIG. 3</figref>, will process the signals and set the &#x201c;UP&#x201d; signal <b>130</b> to a logic high state. Specifically, the rising edge of FREF <b>129</b> causes the D-flop <b>301</b> to output the UP signal <b>130</b>. The UP signal <b>130</b>, in turn, causes the VCO <b>122</b> to increase the drive frequency. Eventually, the rising edge of FDIV <b>124</b> causes D-flop <b>302</b> to output the DN signal, which resets both of the D-flops <b>301</b> and <b>302</b>.</p>
<p id="p-0047" num="0046">As the oscillating frequency of the MEMS structure <b>101</b> increases, the rising edges of FDIV <b>124</b> and FREF <b>129</b> will arrive at the PFD <b>126</b> closer in time, until they eventually arrive simultaneously, at which point the MEMS structure <b>101</b> will oscillate at its resonant frequency.</p>
<p id="p-0048" num="0047">Similarly, <figref idref="DRAWINGS">FIG. 1D</figref> illustrates the signals FREF <b>129</b> and FDIV <b>124</b> for the case in which MEMS structure <b>101</b> is oscillating at greater than its resonant frequency. In this case, the phase shift imparted on FDIV <b>124</b> by the MEMS is less than ninety degrees, and a rising edge of FREF <b>129</b> will reach the PFD <b>126</b> after the a rising edge of FDIV <b>124</b>. Specifically, in this illustration the phase shift imparted by the MEMS structure is zero degrees, so that FREF <b>129</b> lags FDIV <b>124</b> by ninety degrees.</p>
<p id="p-0049" num="0048">The PFD <b>126</b> will process the signals and set the &#x201c;DN&#x201d; signal <b>131</b> to a logic high state. The DN signal <b>131</b>, in turn, causes the VCO <b>122</b> to decrease the drive frequency. As the oscillating frequency of the MEMS structure decreases, the rising edges of FDIV <b>124</b> and FREF <b>129</b> will arrive at the PFD <b>126</b> closer in time, until they eventually arrive simultaneously, at which point the MEMS structure <b>101</b> will oscillate at its resonant frequency.</p>
<p id="p-0050" num="0049">A problem may arise, however, if the PFD <b>126</b> misinterprets the arrival of the rising edges of FDIV <b>124</b> and FREF <b>129</b>. For example, if the MEMS structure <b>101</b> is oscillating at less than its resonant frequency, then FREF <b>129</b> will lead FDIV <b>124</b>, as illustrated in <figref idref="DRAWINGS">FIG. 1C</figref> and discussed above. In some situations (e.g., a start-up glitch), the PFD <b>126</b> may malfunction and process the signals as if FREF <b>129</b> lags FDIV <b>124</b> by 270 degrees (as opposed to leading by 90 degrees). For example, on power-up, FDIV <b>124</b> may be the first signal to arrive at the PFD <b>126</b>, causing the PFD <b>126</b> to react as if the oscillating frequency of the MEMS structure is too high.</p>
<p id="p-0051" num="0050">Such a situation is illustrated in <figref idref="DRAWINGS">FIG. 1E</figref>, in which the oscillating frequency of the MEMS structure is too low, but PFD <b>126</b> has (wrongly) asserted the DN signal. In response, the PLL will adjust the drive frequency even lower, resulting in positive feedback to cause the MEMS structure to oscillate slower still.</p>
<p id="p-0052" num="0051">As similar problem may arise if the MEMS structure is oscillating a greater than its resonant frequency (e.g., <figref idref="DRAWINGS">FIG. 1D</figref> as discussed above), and yet the PFD <b>126</b> processes the signals as if FREF <b>129</b> leads FDIV <b>124</b> by 270 degrees (as opposed to lagging by ninety degrees). In that case, the PFD <b>126</b> will react as if the oscillating frequency of the MEMS structure is too low. This situation is illustrated in <figref idref="DRAWINGS">FIG. 1F</figref>, in which the PFD <b>126</b> has (wrongly) asserted the UP signal <b>130</b>. In response, the PLL will adjust the drive frequency even higher, resulting in positive feedback to cause the MEMS structure to oscillate faster still.</p>
<p id="p-0053" num="0052">Such problems may be addressed by (a) determining whether the loop is providing feedback so as to adjust the drive frequency in the wrong direction (which may be known as positive feedback), and then (b) taking or applying corrective action. For example, if the MEMS structure <b>101</b> is oscillating below its desired (resonant) frequency, and if the loop <b>120</b> is adjusting the frequency lower, then the action of the loop <b>120</b> may be reset or reversed. Similarly, if the MEMS structure <b>101</b> is oscillating above its desired (resonant) frequency, and if the loop <b>120</b> is adjusting the frequency higher, then the action of the loop may be reset or reversed.</p>
<p id="p-0054" num="0053">Such malfunctions may be characterized in that PFD <b>126</b> is outputting a signal to change the frequency of the VCO <b>122</b> during the falling edge of FDIV <b>124</b>. For example, in <figref idref="DRAWINGS">FIG. 1E</figref>, the (erroneous) DN signal <b>131</b> is logic high at the falling edge of FDIV <b>124</b>, while in <figref idref="DRAWINGS">FIG. 1F</figref>, the (erroneous) UP signal <b>130</b> is logic high at the falling edge of FDIV <b>124</b>. Therefore, one way to recognize a malfunction is to determine whether the UP or DN signal is logic high at a falling edge of FDIV <b>124</b>.</p>
<p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. 2</figref> schematically illustrates an embodiment of a start-up error detection and correction circuit <b>200</b> (which may be known as an &#x201c;error detector&#x201d;) that determines whether the UP <b>130</b> or DN <b>131</b> signal is logic high at a falling edge of FDIV <b>124</b>. If the DN signal <b>131</b> is logic high at a falling edge of FDIV <b>124</b>, then the circuit sets the RESET_DN signal <b>202</b> to logic high, as illustrated in <figref idref="DRAWINGS">FIG. 4</figref>. The RESET_DN signal <b>202</b>, in turn, resets the D-flop <b>302</b> in the PFD <b>126</b> (see <figref idref="DRAWINGS">FIG. 3</figref>). Thereafter, a rising edge of the FREF <b>129</b> signal will arrive at the PFD <b>126</b> before the next rising edge of FDIV <b>124</b>, and the PFD <b>126</b> will react appropriately by asserting the UP signal <b>130</b>, as in <figref idref="DRAWINGS">FIG. 1C</figref>, discussed above.</p>
<p id="p-0056" num="0055">Similarly, if the UP signal <b>130</b> is logic high at a falling edge of FDIV <b>124</b>, the start-up error detection and correction circuit <b>200</b> may set the RESET_UP signal <b>201</b> to logic high (not illustrated). The RESET_UP signal <b>201</b>, in turn, resets the D-flop <b>301</b> in the PFD <b>126</b>. Thereafter, a rising edge of the FDIV <b>124</b> signal will arrive at the PFD <b>126</b> before the next rising edge of FREF <b>129</b>, and the PFD <b>126</b> will react appropriately by asserting the DN signal <b>131</b>, as in <figref idref="DRAWINGS">FIG. 1D</figref>, discussed above.</p>
<p id="p-0057" num="0056">In some embodiments, the start-up error detection and correction circuit may be configured to detect the erroneous condition (malfunction) on two or more falling edges of FDIV <b>124</b> prior to asserting a RESET_UP signal <b>201</b> or RESET_DN signal <b>202</b>. An algorithm <b>500</b> for processing signals to identify erroneous DN signal <b>131</b> may be as illustrated in the flow chart in <figref idref="DRAWINGS">FIG. 5</figref> and described below. A similar process could be used in the detection of an erroneous UP signal <b>130</b>.</p>
<p id="p-0058" num="0057">The algorithm <b>500</b> of <figref idref="DRAWINGS">FIG. 5</figref> detects an erroneous condition (malfunction) on two or more (in any event, a predetermined number, &#x201c;N&#x201d;) falling edges of FDIV <b>124</b> by counting the number of times that the DN signal <b>131</b> is logic high (step <b>503</b>) at a falling edge of FDIV <b>124</b> (step <b>502</b>). At the beginning of the process, the RESET_DN signal <b>202</b> is set to logic zero, and a counter or variable (Count) is set to zero (step <b>501</b>). When the DN signal <b>131</b> is logic high (step <b>503</b>) at a falling edge of FDIV <b>124</b> (step <b>502</b>), then the Count variable is incremented (step <b>505</b>). Otherwise the process resets the process (<b>504</b>). Each time Count is incremented (step <b>505</b>), the method <b>500</b> determines whether Count has reached the predetermined number &#x201c;N) (step <b>506</b>). If so, the RESET_DN signal <b>202</b> is set to logic high and the PFD <b>126</b> is reset as described above. Otherwise, the method loops back to await the next falling edge of FDIV (<b>508</b>).</p>
<p id="p-0059" num="0058">The method described above in connection with the circuits of <figref idref="DRAWINGS">FIG. 1B</figref> may be implemented by a variety of circuit designs, or by using a microprocessor programmed with code to monitor and react to the signals of the PLL <b>120</b>. For example, an alternate embodiments may shift the FDIV <b>124</b> signal by +90 degrees (or &#x2212;270 degrees), instead of shifting the drive signal by &#x2212;90 degrees as in <figref idref="DRAWINGS">FIG. 1B</figref>, to produce a 90 phase difference between those signals.</p>
<p id="p-0060" num="0059">Another problem may arise if the phase-shifted drive signal output from the MEMS structure is not detectable, for example, by the comparator <b>125</b>. This may potentially occur, for example, when the MEMS structure <b>101</b> is just beginning to oscillate, because the signal output <b>128</b> may have an amplitude below the threshold of the comparator <b>125</b>. Alternately, if the MEMS structure <b>101</b> has a high Q (quality factor) and is oscillating above or below its resonant frequency, the output signal <b>128</b> may have an amplitude below the threshold of the comparator <b>125</b>.</p>
<p id="p-0061" num="0060">In such situations, the comparator <b>125</b> may fail to produce the FREF signal <b>129</b>. In that case, the FDIV signal <b>124</b> will eventually arrive at the PFD <b>126</b>, and the PFD <b>126</b> will react to the FDIV signal <b>124</b> as it would in the situation where FREF <b>129</b> lags FDIV <b>124</b> (i.e., as if the oscillating frequency of the mass is greater than the desired frequency) and the PLL <b>120</b> will act to lower the drive frequency. While this would be acceptable if the oscillation frequency were, in fact, too high, it is unacceptable positive feedback when the oscillation frequency is below the desired frequency.</p>
<p id="p-0062" num="0061">This malfunction is characterized in that the DN signal <b>131</b> from the PFD <b>126</b> will have a duty cycle that is greater than 25 percent or more. Indeed, in embodiments described above (e.g., <figref idref="DRAWINGS">FIG. 1D</figref>), the DN signal <b>131</b> should preferably have a duty cycle of between zero and 25 percent (e.g., corresponding to the phase difference between FREF <b>129</b> and FDIV <b>124</b>, which could be between zero and 90 degrees). Thus, corrective action may be indicated based on the duty cycle of the DN signal <b>131</b>.</p>
<p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. 7A</figref> schematically illustrates a PLL circuit <b>700</b> with a duty cycle detection and correction apparatus <b>701</b>. The duty cycle detection and correction apparatus <b>701</b> may be a circuit, such as a digital circuit, or a microprocessor programmed to implement a process.</p>
<p id="p-0064" num="0063">Detection of the duty cycle of the DN signal <b>131</b> may be performed in a variety of ways. In the embodiment of <figref idref="DRAWINGS">FIG. 7A</figref>, the clock divider creates a signal (8&#xd7;FDIV) <b>703</b> that is eight times the frequency of the FDIV signal <b>124</b>. Other embodiments may use different multiples of FDIV <b>124</b>.</p>
<p id="p-0065" num="0064">The duty cycle detection and correction apparatus <b>701</b> samples the DN signal <b>131</b> once for each cycle of the 8&#xd7;FDIV signal <b>703</b>, and counts (using a digital counter) the number logic high samples. If the DN signal <b>131</b> is logic high for more than a predetermined number of 8&#xd7;FDIV cycles, the loop <b>700</b> has malfunctioned. For example, if the DN signal <b>131</b> is logic high for as many as three or four out of any eight 8&#xd7;FDIV cycles, then the duty cycle of DN <b>131</b> is greater than 25 percent (a 25 percent duty cycle would be two out of eight cycles), thus indicating a malfunction.</p>
<p id="p-0066" num="0065">If an erroneous duty cycle is detected, the UP <b>130</b> and DN <b>131</b> signals in the loop <b>700</b> may be transposed (or flipped or swapped). For example, switches, multiplexers or logic circuits could couple the DN signal to the UP line, with the result that the loop will then drive the frequency higher. In the embedment of <figref idref="DRAWINGS">FIG. 7A</figref>, the duty cycle detection and correction apparatus <b>701</b> asserts a signal (PFD FLIP BIT) <b>704</b> to control a PFD FLIP MUX <b>702</b> for this purpose. Signal connections within the PFD Flip Mux <b>702</b> are schematically illustrated by the dashed arrows (<b>710</b> and <b>711</b>) in <figref idref="DRAWINGS">FIG. 7B</figref> (default connection) and <figref idref="DRAWINGS">FIG. 7C</figref> (flipped connection). If the PFD Flip Mux <b>702</b> is in the state illustrated by <figref idref="DRAWINGS">FIG. 7B</figref> when a malfunction is detected, the PFD FLIP BIT <b>704</b> will cause the PFD Flip Mux <b>702</b> to change state, to couple the signals as illustrated in <figref idref="DRAWINGS">FIG. 7C</figref>. Eventually, when the system <b>700</b> is at or near phase lock, or if the duty cycle falls to 25 percent for example, the signals may optionally be restored to their original connections.</p>
<p id="p-0067" num="0066">An embodiment of a method of driving an oscillating member using a phase locked loop may be described as follows:</p>
<p id="p-0068" num="0067">applying a drive signal having a drive frequency to the oscillating member;</p>
<p id="p-0069" num="0068">providing a reference signal [FREF] indicative of the phase shift imparted on the drive signal by the oscillating member;</p>
<p id="p-0070" num="0069">comparing the phase of the drive signal (or a second reference signal having the same frequency as the drive signal, but leading the drive signal by 90 degrees) to the reference signal in a phase detector;</p>
<p id="p-0071" num="0070">generating a first control signal [DN] if the first reference signal lags the drive signal [apparently indicating that the oscillating member is oscillating too fast]; and</p>
<p id="p-0072" num="0071">determining whether the duty cycle of the first control signal exceeds a predetermined percent; and</p>
<p id="p-0073" num="0072">increasing the frequency of the drive signal if the duty cycle of the first control signal [DN] exceeds the predetermined percent.</p>
<p id="p-0074" num="0073">In some embodiments, the duty cycle detection and correction apparatus may detect the erroneous condition based on an assessment of two or more cycles. An algorithm for processing for an erroneous DN signal may be as illustrated in the flow chart <b>800</b> in <figref idref="DRAWINGS">FIG. 8</figref>, and may be implemented in hardware (e.g., digital circuits) or in software (e.g., in a programmed microprocessor, or in software on a computer readable medium such as a CD-ROM).</p>
<p id="p-0075" num="0074">In the embodiment of such a process <b>800</b> illustrated by <figref idref="DRAWINGS">FIG. 8</figref>, an erroneous duty cycle is determined as one in which the DN signal <b>131</b> is logic high for at least four out of eight cycles of 8&#xd7;FDIV <b>703</b> (i.e., at least a fifty percent duty cycle). The PFD_FLIP_BIT <b>704</b> is set to logic high (i.e., &#x201c;1&#x201d;) after &#x201c;N&#x201d; such instances have been detected. In some embodiments, the number of cycles (&#x201c;N&#x201d;) could be range from 16 to 64, but could be as low as one (i.e., a single instance of erroneous duty cycle) or greater than 64, as determined by the parameters of the system in which the loop operates. In some embodiments, an erroneous duty cycle is determined as one in which the DN signal <b>131</b> is logic high for at least three out of eight cycles of 8&#xd7;FDIV <b>703</b> (37.5 percent duty cycle) or indeed for any number of cycles greater than two out of eight or otherwise greater than a 25 percent duty cycle. In general, an erroneous duty cycle may be determined as one in which the DN signal is logic high for at least a number of cycles equal to 8&#xd7;FDIV <b>703</b> divided by four.</p>
<p id="p-0076" num="0075">Returning to the process <b>800</b> of <figref idref="DRAWINGS">FIG. 8</figref>, several variables (HIGH_DUTY_CYCLE_COUNT; 8&#xd7;FDIVCYCLE; and HIGH_COUNT_PER_CYCLE) are set to zero, and control signal PDF_FLIP (or PDF_FLIP_BIT) <b>704</b> is set to zero at steps <b>801</b> and <b>802</b>. With PDF_FLIP (or PDF_FLIP_BIT) <b>704</b> set to zero, the PFD Flip Mux <b>702</b> couples the UP signal <b>130</b> and the DN signal <b>131</b> to the charge pump <b>132</b> as shown in <figref idref="DRAWINGS">FIG. 7B</figref>.</p>
<p id="p-0077" num="0076">At a rising edge of 8&#xd7;FDIV <b>703</b>, the process <b>800</b> increments variable 8&#xd7;DIVCYCLE (step <b>803</b>), and determines whether signal DN <b>131</b> is logic high (step <b>804</b>). If not, the process <b>800</b> loops back to await the next rising edge of 8&#xd7;FDIV <b>703</b>. Otherwise, the process <b>800</b> increments the variable HIGH_COUNT_PER_CYCLE (STEP <b>806</b>), and determines whether 8&#xd7;DIVCYCLE has a value of 8 (in other words, the process determines whether it has processed eight edges of the 8&#xd7;FDIV signal) (step <b>807</b>).</p>
<p id="p-0078" num="0077">If the process <b>800</b> has not yet processed eight edges of the 8&#xd7;FDIV signal, then the process loops back to await the next rising edge of 8&#xd7;FDIV <b>703</b> (<b>805</b>).</p>
<p id="p-0079" num="0078">Otherwise (if the process <b>800</b> has processed eight edges of the 8&#xd7;FDIV signal), the process <b>800</b> determines whether the variable HIGH_COUNT_PER_CYCLE is equal to or greater than four (step <b>808</b>) (in other words, is the duty cycle of DN <b>131</b> equal to or greater than fifty percent). If not, then the loop is not in error (there is no malfunction) and so the process loops back to reset the variables (<b>809</b>). Otherwise, the process <b>800</b> increments the variable HIGH_DUTYCYCLE_COUNT (step <b>810</b>) to indicate that an instance of an erroneous DN signal <b>131</b> has been detected.</p>
<p id="p-0080" num="0079">The process then determines whether a predetermined number (N) of such instances have been detected (step <b>811</b>). If not, then the process loops back (<b>812</b>) and resets the 8&#xd7;FDIVCYCLE variable and the HIGH_DUTYCYCLE_COUNT variable (step <b>802</b>). If so (i.e., if a number &#x201c;N&#x201d; instances of an erroneous DN signal <b>131</b> have been detected), then the process <b>800</b> sets the PDF_FLIP_BIT <b>704</b>) signal to logic high, so as to flip the coupling of the UP signal <b>130</b> and the DN signal <b>131</b> to the charge pump <b>132</b>, as discussed above. Specifically, with PDF_FLIP (or PDF_FLIP_BIT) <b>704</b> set to one, the PFD Flip Mux <b>702</b> couples the UP signal <b>130</b> and the DN signal <b>131</b> to the charge pump <b>132</b> as shown in <figref idref="DRAWINGS">FIG. 7C</figref>.</p>
<p id="p-0081" num="0080">Flipping (or transposing) the UP signal <b>130</b> and the DN signal <b>131</b> in this way effectively reverses the operation of the charge pump, so as to cause the VCO <b>120</b> to increase the frequency of FVCO <b>121</b> when the DN signal <b>131</b> would otherwise cause a reduction in that frequency, and to decrease the frequency of FVCO <b>121</b> when the UP signal <b>130</b> would otherwise cause in increase in that frequency.</p>
<p id="p-0082" num="0081">The transposition of the UP <b>130</b> and DN <b>131</b> signals in the loop <b>700</b> may also address a situation in which the FREF signal <b>129</b> is present, but the loop <b>700</b> has misinterpreted the phase relationship between FREF <b>129</b> and FDIV <b>124</b>, as shown for example in <figref idref="DRAWINGS">FIG. 1E</figref> and <figref idref="DRAWINGS">FIG. 1F</figref>. In other words, if a malfunction illustrated by either of <figref idref="DRAWINGS">FIG. 1E</figref> or <figref idref="DRAWINGS">FIG. 1F</figref> occur, the malfunction may be addressed by the transposition of the UP <b>130</b> and DN <b>131</b> signals in the loop <b>700</b>.</p>
<p id="p-0083" num="0082">Through detection of a malfunctioning loop, the various embodiments may assist in adjusting the drive frequency of an oscillating mass to a desired frequency. A generalized flow chart <b>900</b> is presented in <figref idref="DRAWINGS">FIG. 9A</figref>, and involves detecting a malfunction (step <b>901</b>), and taking corrective action (step <b>902</b>) as necessary. For example, if the loop <b>700</b> detects that the UP <b>130</b> or DN <b>131</b> signal is high at a falling edge of FDIV <b>124</b> (step <b>911</b>), then the phase detector (or PFD <b>126</b>) may be reset, or the UP and/or DN signals may be transposed (step <b>912</b>) (<figref idref="DRAWINGS">FIG. 9B</figref>), as discussed above. Alternately, if the loop <b>700</b> detects that the DN signal <b>131</b> has an excessive duty cycle (e.g., greater than 25 percent) (step <b>921</b>) then the DN signal <b>131</b> may be transposed (e.g., coupled to the UP signal <b>130</b> line) (step <b>922</b>) (<figref idref="DRAWINGS">FIG. 9C</figref>).</p>
<p id="p-0084" num="0083">Various embodiments of the invention may be implemented at least in part in any conventional computer programming language. For example, some embodiments may be implemented in a procedural programming language (e.g., &#x201c;C&#x201d;), or in an object oriented programming language (e.g., &#x201c;C++&#x201d;). Other embodiments of the invention may be implemented as preprogrammed hardware elements (e.g., application specific integrated circuits, FPGAs, and digital signal processors), or other related components.</p>
<p id="p-0085" num="0084">In an alternative embodiment, the disclosed apparatus and methods may be implemented as a computer program product for use with a computer system. Such implementation may include a series of computer instructions fixed (i.e., non-transient) either on a tangible medium, such as a computer readable medium (e.g., a diskette, CD-ROM, ROM, memory card, or fixed disk). The series of computer instructions can embody all or part of the functionality previously described herein with respect to the system.</p>
<p id="p-0086" num="0085">Those skilled in the art should appreciate that such computer instructions can be written in a number of programming languages for use with many computer architectures or operating systems. Furthermore, such instructions may be stored in any memory device, such as semiconductor, magnetic, optical or other memory devices, and may be transmitted using any communications technology, such as optical, infrared, microwave, or other transmission technologies.</p>
<p id="p-0087" num="0086">Among other ways, such a computer program product may be distributed as a removable medium with accompanying printed or electronic documentation (e.g., shrink wrapped software), preloaded with a computer system (e.g., on system ROM or fixed disk), or distributed from a server or electronic bulletin board over the network (e.g., the Internet or World Wide Web). Of course, some embodiments of the invention may be implemented as a combination of both software (e.g., a computer program product) and hardware. Still other embodiments of the invention are implemented as entirely hardware, or entirely software.</p>
<p id="p-0088" num="0087">The embodiments of the invention described above are intended to be merely exemplary; numerous variations and modifications will be apparent to those skilled in the art. For example, circuits could be designed to operate on signals of inverted polarity from those shown in the embodiment described herein, or from or on either rising or falling edges of discrete signals. All such variations and modifications are intended to be within the scope of the present invention as defined in any appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of driving an oscillating member using a phase locked loop, comprising:
<claim-text>applying a drive signal having a drive frequency to the oscillating member;</claim-text>
<claim-text>providing a reference signal indicative of the phase shift imparted on the drive signal by the oscillating member;</claim-text>
<claim-text>comparing the phase of the drive signal to the reference signal in a phase detector;</claim-text>
<claim-text>generating a first control signal if the reference signal lags the drive signal; and</claim-text>
<claim-text>determining whether the duty cycle of the first control signal exceeds a predetermined percent; and</claim-text>
<claim-text>increasing the frequency of the drive signal if the duty cycle of the first control signal exceeds the predetermined percent.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the predetermined percent is at least 25 percent.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the predetermined percent is at least 50 percent.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the predetermined percent is at least 75 percent.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein determining whether the duty cycle of the first control signal exceeds a predetermined percent comprises determining whether the duty cycle of the first control signal exceeds a predetermined percent for at least a predetermined number of cycles of the drive signal, the predetermined number of cycles of the drive signal being at least two.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein the predetermined number of cycles of the drive signal is at least three cycles.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A circuit for driving an oscillating member, comprising:
<claim-text>a variable-frequency oscillator having an oscillator output;</claim-text>
<claim-text>an arrival-time detector having a first arrival-time detector input and a second arrival-time detector input, an up output and a down output, and a reset input, the first arrival-time detector input coupled to the oscillator output;</claim-text>
<claim-text>a phase shifter having an phase shifter input and a phase shifter output, the phase shifter input coupled to the oscillator output;</claim-text>
<claim-text>an oscillating member having a member input and a member output, the member input coupled to the phase shifter output, and the member output coupled to the second arrival-time detector input;</claim-text>
<claim-text>an error detector configured to determine whether the up output or down output is high at a falling edge of the oscillator output, the error detector having a first error detector input coupled to the up output of the arrival-time detector, and a second error detector input coupled to the down output of the arrival-time detector, and an error detector output coupled to the reset input of the arrival-time detector.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A method of driving an oscillating member using a phase locked loop, the method comprising:
<claim-text>applying a drive signal having a drive frequency to the oscillating member;</claim-text>
<claim-text>providing a first reference signal to a phase detector, the first reference signal indicative of the phase shift imparted on the drive signal by the oscillating member;</claim-text>
<claim-text>providing a second reference signal to the phase detector, the second signal having the same frequency as the drive signal, but leading the drive signal by ninety degrees;</claim-text>
<claim-text>generating a first control signal if a phase detector determines that the first reference signal leads the second reference signal, and generating a second control signal if a phase detector determines that the first reference signal lags the second reference signal; and</claim-text>
<claim-text>transposing at least one of the first control signal and the second control signal is active at a falling edge of the drive signal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A method of driving an oscillating member using a phase locked loop according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein applying a drive signal comprises:
<claim-text>generating the second reference signal; and</claim-text>
<claim-text>producing the drive signal by imposing a phase shift of negative ninety degrees on the second reference signal,</claim-text>
<claim-text>such that the second reference signal leads the drive signal by 90 degrees.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A method of driving an oscillating member using a phase locked loop according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein providing a second reference signal comprises:
<claim-text>generating the drive signal; and</claim-text>
<claim-text>producing the second reference signal by imposing a phase shift of 270 degrees on the reference signal,</claim-text>
<claim-text>such that the second reference signal leads the drive signal by 90 degrees.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
