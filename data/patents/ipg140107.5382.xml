<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08626482-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08626482</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12958397</doc-number>
<date>20101202</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>TW</country>
<doc-number>99117720 A</doc-number>
<date>20100602</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>463</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>17</main-group>
<subgroup>50</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classifications-cpc>
<main-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>17</main-group>
<subgroup>5022</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
</main-cpc>
</classifications-cpc>
<classification-national>
<country>US</country>
<main-classification>703 14</main-classification>
<further-classification>703  2</further-classification>
</classification-national>
<invention-title id="d2e71">Equivalent circuit simulation system and method</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>2003/0065498</doc-number>
<kind>A1</kind>
<name>Bois et al.</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>703 19</main-classification></classification-national>
</us-citation>
<us-citation>
<nplcit num="00002">
<othercit>Antonini. &#x201c;SPICE Equivalent Circuits of Frequency-Domain Responses&#x201d;., IEEE 2003., p. 502-512.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00003">
<othercit>Lamecki et al. &#x201c;Equivalent SPICE Circuits with Guaranteed Passivity From Nonpassive Models&#x201d;, IEEE, Mar. 2007., p. 526-532.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00004">
<othercit>Braken et al. &#x201c;Extension of the Asymptotic Waveform Evaluation Technique with the Method of Characteristics&#x201d;., 1992 IEEE., p. 71-75.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00005">
<othercit>Lempel et al. &#x201c;The K Matrix of n-Port Networks: Analysis and Synthesis&#x201d;., IEEE 1969., p. 471-483.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00006">
<othercit>Schutt-Aine., &#x201c;A Frequency-Dependent Transmission-Line Simulator Using S-Parameters&#x201d;, EMC 2004, p. 525528.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
</us-references-cited>
<number-of-claims>15</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>703  2</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>703 14</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110301922</doc-number>
<kind>A1</kind>
<date>20111208</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Tseng</last-name>
<first-name>Wen-Laing</first-name>
<address>
<city>Taipei Hsien</city>
<country>TW</country>
</address>
</addressbook>
<residence>
<country>TW</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Lee</last-name>
<first-name>Cheng-Hsien</first-name>
<address>
<city>Taipei Hsien</city>
<country>TW</country>
</address>
</addressbook>
<residence>
<country>TW</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Li</last-name>
<first-name>Shen-Chun</first-name>
<address>
<city>Taipei Hsien</city>
<country>TW</country>
</address>
</addressbook>
<residence>
<country>TW</country>
</residence>
</us-applicant>
<us-applicant sequence="004" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Pai</last-name>
<first-name>Yu-Chang</first-name>
<address>
<city>Taipei Hsien</city>
<country>TW</country>
</address>
</addressbook>
<residence>
<country>TW</country>
</residence>
</us-applicant>
<us-applicant sequence="005" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Hsu</last-name>
<first-name>Shou-Kuo</first-name>
<address>
<city>Taipei Hsien</city>
<country>TW</country>
</address>
</addressbook>
<residence>
<country>TW</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Tseng</last-name>
<first-name>Wen-Laing</first-name>
<address>
<city>Taipei Hsien</city>
<country>TW</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Lee</last-name>
<first-name>Cheng-Hsien</first-name>
<address>
<city>Taipei Hsien</city>
<country>TW</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Li</last-name>
<first-name>Shen-Chun</first-name>
<address>
<city>Taipei Hsien</city>
<country>TW</country>
</address>
</addressbook>
</inventor>
<inventor sequence="004" designation="us-only">
<addressbook>
<last-name>Pai</last-name>
<first-name>Yu-Chang</first-name>
<address>
<city>Taipei Hsien</city>
<country>TW</country>
</address>
</addressbook>
</inventor>
<inventor sequence="005" designation="us-only">
<addressbook>
<last-name>Hsu</last-name>
<first-name>Shou-Kuo</first-name>
<address>
<city>Taipei Hsien</city>
<country>TW</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Altis Law Group, Inc.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Hon Hai Precision Industry Co., Ltd.</orgname>
<role>03</role>
<address>
<city>New Taipei</city>
<country>TW</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Kim</last-name>
<first-name>Eunhee</first-name>
<department>2123</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A simulation system for producing equivalent circuits reads data corresponding to a tabular W element format in a storage device, and adds data of the tabular W element format file using interpolation algorithm. A frequency-dependent transmission matrix is transformed into an N-port network matrix describing electrical properties of a multi-input and multi-output network. An N-port network matrix is transformed into a S-parameter matrix. A range of frequency of a s-parameter is determined and numbers of pole-residue, times for recursion and durable maximum system errors in the equivalent circuit is also determined. A vector fitting algorithm is performed and a rational function matrix composed with s-parameters is produced, to produce a general SPICE equivalent circuit based on the generated rational function matrix.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="231.90mm" wi="173.40mm" file="US08626482-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="202.35mm" wi="177.12mm" file="US08626482-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="250.70mm" wi="172.38mm" file="US08626482-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="145.80mm" wi="173.06mm" file="US08626482-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="189.40mm" wi="187.37mm" file="US08626482-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="254.08mm" wi="152.57mm" orientation="landscape" file="US08626482-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="116.50mm" wi="181.86mm" file="US08626482-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND</heading>
<p id="p-0002" num="0001">1. Technical Field</p>
<p id="p-0003" num="0002">The present application is related to simulation systems, especially to a simulation system and method for transforming files in Tabular W-element format into general SPICE (Simulation Program with Integrated Circuit Emphasis) equivalent circuits.</p>
<p id="p-0004" num="0003">2. Description of Related Art</p>
<p id="p-0005" num="0004">Field solver applications, such as Q3D of Ansoft Inc., and Hspice of Synopsys Inc., are commonly used in obtaining equivalent models, composed of frequency dependent resistances, inductances, reactances, and capacitances (RLGC), of striplines and microstrips on a printed circuit board (PCB). To consider skin effects and dielectric lost in transmission lines of a PCB, transforming of the RLGC models by SISTAI of Intel Inc., is necessary for accuracy of the result. However, the syntax of the equivalent models is formatted in a Tabular W-element standard, which is not compatible with general circuit simulation software, such as Pspice software of Cadence Inc., SPDSIM of Sigrity Inc., and Simplis software of SIMetrix Inc. Therefore, the equivalent models in Tabular W-element syntax are limited in further applications.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0002" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0006" num="0005"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of one embodiment of a computer comprising an equivalent circuit simulation system for general SPICE.</p>
<p id="p-0007" num="0006"><figref idref="DRAWINGS">FIG. 2</figref> is a flowchart illustrating one embodiment of a method for simulating general SPICE equivalent circuits.</p>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 3</figref> is a drawing illustrating an exemplary N-port circuit system.</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 4</figref> is a drawing illustrating a main equivalent circuit generated by one embodiment of the equivalent circuit simulation system.</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 5</figref> is a drawing illustrating an exemplary first sub-equivalent circuit generated by one embodiment of the equivalent circuit simulation system.</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 6</figref> is a drawing illustrating a second sub-equivalent circuit generated by one embodiment of the equivalent circuit simulation system.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0003" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0012" num="0011">SPICE is a general-purpose open source analog electronic circuit simulator. It is a powerful program that is used in IC and board-level design to check the integrity of circuit designs and to predict circuit behavior.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of one embodiment of a computer <b>1</b> comprising an equivalent circuit simulation system for general SPICE <b>12</b>. The computer <b>1</b> further comprises a storage device <b>10</b> and a central processing unit <b>11</b> (CPU). The computer <b>1</b> is connected to an output device <b>2</b>, such as a display, for outputting generated equivalent circuits. The storage device <b>10</b> is configured for storing information of resistances, inductances, reactances, and capacitances presented in a Tabular W-element syntax format. The equivalent circuit simulation system <b>12</b> is configured for reading data presented in the Tabular W-element standard format, such as data files in *.tab, producing an equivalent circuit file (e.g., one or more files comprising data of an equivalent circuit of the data presented in the Tabular W-element standard format) corresponding to the data, and outputting the equivalent circuit to the output device <b>2</b>. The generated equivalent circuit file is compatible with general-purpose open source analog circuit simulators using SPICE syntax, such as Pspice of Cadence Inc., SPDSIM of Sigrity Inc., and Simplis of SIMetrix Inc. The equivalent circuit files are used to check the integrity of circuit designs and to predict circuit behavior.</p>
<p id="p-0014" num="0013">In this embodiment, the equivalent circuit simulation system <b>12</b> comprises an acquisition module <b>121</b>, a first parameter transformation module <b>122</b>, a parameter determination module <b>123</b>, and an equivalent circuit production module <b>124</b>. The storage device <b>10</b> may be a memory system of the computer <b>1</b>. The modules <b>121</b>-<b>124</b> may comprise computerized code in the form of one or more programs that are stored in the storage device <b>10</b>. The computerized code includes instructions that are executed by the CPU <b>11</b> to provide functions for modules <b>121</b>-<b>124</b>.</p>
<p id="p-0015" num="0014">The acquisition module <b>121</b> is configured for reading data corresponding to the Tabular W-element format in the storage device <b>10</b>, and supplementing the Tabular W element format file using an interpolation algorithm. The obtained frequency-dependent matrix is a tabular W element RLGC model comprising resistance, inductance, reactance, and capacitance information of a circuit.</p>
<p id="p-0016" num="0015">The first parameter transformation module <b>122</b>-<b>1</b> transforms a RLGC matrix into an N-port network matrix describing electrical properties of a multi-input and multi-output network. The second parameter transformation module <b>122</b>-<b>2</b> transforms the N-port network matrix into a S-parameter matrix, a diverging matrix describing a relationship between an incident voltage wave and a reflective voltage wave in a high frequency circuit. An S-parameter is a parameter representing a circuit frequency, and built by the relationship between the incident voltage wave and the reflective voltage wave.</p>
<p id="p-0017" num="0016">The parameter determination module <b>123</b> is configured for determining a range of frequency of a s-parameter, to increase accuracy of vector fitting in a RLGC matrix, and to select numbers of pole-residue, times for recursion and durable maximum system errors in an equivalent circuit simulation.</p>
<p id="p-0018" num="0017">The equivalent circuit production module <b>124</b> is configured for performing a vector fitting algorithm, producing a rational function matrix composed with s-parameters, and producing a general SPICE equivalent circuit based on the generated rational function matrix. The equivalent circuit production module <b>124</b> is configured for determining if a root mean square of the error of the rational function matrix is less than the selected system errors, and increasing the numbers of pole-residue to perform vector fitting when the system error is more than the root mean square of the error of the rational function matrix.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 2</figref> is a flowchart illustrating one embodiment of a method for simulating general SPICE equivalent circuits. The method produces equivalent circuits for general SPICE based on the rational function matrix. Depending on the embodiment, additional blocks in the flow of <figref idref="DRAWINGS">FIG. 2</figref> may be added, others removed, and the ordering of the blocks may be changed.</p>
<p id="p-0020" num="0019">In block S<b>21</b>, the acquisition module <b>121</b> reads data files of Tabular W-element from the storage device <b>10</b>. In block S<b>22</b>, the acquisition module <b>121</b> obtains the frequency-dependent RLGC matrix from the Tabular W-element format by using interpolation. The frequency-dependent RLGC matrix is composed of tabular W-element format and comprises information of resistance, inductance, reactance and capacitance.</p>
<p id="p-0021" num="0020">In block S<b>23</b>, the first parameter transformation module <b>122</b>-<b>1</b> transforms the frequency-dependent RLGC matrix into an N-port network matrix. The transformation is shown below.</p>
<p id="p-0022" num="0021">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>T</mi>
          <mo>=</mo>
          <msup>
            <mi>&#x2147;</mi>
            <mrow>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>D</mi>
                  <mo>+</mo>
                  <mi>sE</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mo>&#x2062;</mo>
              <mi>l</mi>
            </mrow>
          </msup>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <mrow>
            <mi>wherein</mi>
            <mo>&#x2062;</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <mi>D</mi>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mrow>
                    <mo>-</mo>
                    <mrow>
                      <mi>R</mi>
                      <mo>&#x2061;</mo>
                      <mrow>
                        <mo>(</mo>
                        <mi>s</mi>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <mo>-</mo>
                    <mrow>
                      <mi>G</mi>
                      <mo>&#x2061;</mo>
                      <mrow>
                        <mo>(</mo>
                        <mi>s</mi>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <mi>E</mi>
          <mo>=</mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mrow>
                    <mo>-</mo>
                    <mrow>
                      <mi>L</mi>
                      <mo>&#x2061;</mo>
                      <mrow>
                        <mo>(</mo>
                        <mi>s</mi>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <mo>-</mo>
                    <mrow>
                      <mi>C</mi>
                      <mo>&#x2061;</mo>
                      <mrow>
                        <mo>(</mo>
                        <mi>s</mi>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
s=j&#x3c9;, l=the length of the transmission line.
</p>
<p id="p-0023" num="0022">In block S<b>24</b>, the second parameter transformation module <b>122</b>-<b>2</b> transforms the N-port network matrix into an S parameter matrix. The transformation is shown below.</p>
<p id="p-0024" num="0023">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>Y</mi>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <msub>
                    <mi>Y</mi>
                    <mn>11</mn>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>Y</mi>
                    <mn>12</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>Y</mi>
                    <mn>21</mn>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>Y</mi>
                    <mn>22</mn>
                  </msub>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mrow>
                    <mrow>
                      <mo>-</mo>
                      <msubsup>
                        <mi>T</mi>
                        <mn>12</mn>
                        <mrow>
                          <mo>-</mo>
                          <mn>1</mn>
                        </mrow>
                      </msubsup>
                    </mrow>
                    <mo>&#x2062;</mo>
                    <msub>
                      <mi>T</mi>
                      <mn>11</mn>
                    </msub>
                  </mrow>
                </mtd>
                <mtd>
                  <msubsup>
                    <mi>T</mi>
                    <mn>12</mn>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msubsup>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <mrow>
                      <mo>-</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>21</mn>
                      </msub>
                    </mrow>
                    <mo>+</mo>
                    <mrow>
                      <msub>
                        <mi>T</mi>
                        <mn>22</mn>
                      </msub>
                      <mo>&#x2062;</mo>
                      <msubsup>
                        <mi>T</mi>
                        <mn>12</mn>
                        <mrow>
                          <mo>-</mo>
                          <mn>1</mn>
                        </mrow>
                      </msubsup>
                      <mo>&#x2062;</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>11</mn>
                      </msub>
                    </mrow>
                  </mrow>
                </mtd>
                <mtd>
                  <mrow>
                    <mrow>
                      <mo>-</mo>
                      <msub>
                        <mi>T</mi>
                        <mn>22</mn>
                      </msub>
                    </mrow>
                    <mo>&#x2062;</mo>
                    <msubsup>
                      <mi>T</mi>
                      <mn>12</mn>
                      <mrow>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                    </msubsup>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>2</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0025" num="0024">Secondly, the Y parameter is substituted into formula (3) as follows.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>S=</i>(<i>I</i><sub>N</sub><i>+Z</i><sub>0</sub><sup>1/2</sup><i>YZ</i><sub>0</sub><sup>1/2</sup>)<sup>&#x2212;1</sup>(<i>I</i><sub>N</sub><i>&#x2212;Z</i><sub>0</sub><sup>1/2</sup><i>YZ</i><sub>0</sub><sup>1/2</sup>)&#x2003;&#x2003;(3)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0026" num="0025">In formula (3), I<sub>N </sub>is a N&#xd7;N identity matrix, Z<sub>0 </sub>is a reference resistor, and Z<sub>0</sub>=501<sub>N</sub>. According to formula (3), the S parameter matrix is obtained.</p>
<p id="p-0027" num="0026">In block S<b>24</b>, the parameter determination module <b>123</b> determines the frequency range of S parameters using interpolation algorithm, to increase the accuracy of vector fitting in the RLGC matrix. In block S<b>25</b>, the parameter determination module <b>123</b> determines amounts and times for recursion of the pole-residue required by the vector fitting. A rational function made by m pairs of pole-residue can be obtained by formula (4). By setting the amount and times for recursion, the accuracy of formula (4) will be increased.</p>
<p id="p-0028" num="0027">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>f</mi>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mi>s</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <munderover>
              <mo>&#x2211;</mo>
              <mrow>
                <mi>m</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>M</mi>
            </munderover>
            <mo>&#x2062;</mo>
            <mfrac>
              <msub>
                <mi>r</mi>
                <mi>m</mi>
              </msub>
              <mrow>
                <mi>s</mi>
                <mo>+</mo>
                <msub>
                  <mi>p</mi>
                  <mi>m</mi>
                </msub>
              </mrow>
            </mfrac>
          </mrow>
          <mo>+</mo>
          <mi>d</mi>
          <mo>+</mo>
          <mi>se</mi>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>4</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
In formula (4), &#x192;(s) represents a continuation function, r<sub>m </sub>represents a residue, and p<sub>m </sub>represents a pole.
</p>
<p id="p-0029" num="0028">S parameter matrix can be obtained by formula (5).</p>
<p id="p-0030" num="0029">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>S</mi>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <mi>s</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mo>[</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <msub>
                    <mi>S</mi>
                    <mn>11</mn>
                  </msub>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>s</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mi>S</mi>
                    <mn>12</mn>
                  </msub>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>s</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mi>&#x2026;</mi>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mi>S</mi>
                    <mrow>
                      <mn>1</mn>
                      <mo>&#x2062;</mo>
                      <mi>N</mi>
                    </mrow>
                  </msub>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>s</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow>
                  <msub>
                    <mi>S</mi>
                    <mn>21</mn>
                  </msub>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>s</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mi>S</mi>
                    <mn>22</mn>
                  </msub>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>s</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mi>&#x2026;</mi>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mi>S</mi>
                    <mrow>
                      <mn>2</mn>
                      <mo>&#x2062;</mo>
                      <mi>N</mi>
                    </mrow>
                  </msub>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>s</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>&#x2026;</mi>
              </mtd>
              <mtd>
                <mi>&#x2026;</mi>
              </mtd>
              <mtd>
                <mi>&#x2026;</mi>
              </mtd>
              <mtd>
                <mi>&#x2026;</mi>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow>
                  <msub>
                    <mi>S</mi>
                    <mrow>
                      <mi>N</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>s</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mi>S</mi>
                    <mrow>
                      <mi>N</mi>
                      <mo>&#x2062;</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>&#x2062;</mo>
                      <mn>2</mn>
                    </mrow>
                  </msub>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>s</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mi>&#x2026;</mi>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mi>S</mi>
                    <mi>NN</mi>
                  </msub>
                  <mo>&#x2061;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>s</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
          <mo>]</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>5</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
A rational function matrix is obtained by performing vector fitting on each vector in formula (5).
</p>
<p id="p-0031" num="0030">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mrow>
              <mi>S</mi>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mi>s</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>&#x2248;</mo>
            <mrow>
              <mover>
                <mi>S</mi>
                <mo>^</mo>
              </mover>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mi>s</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mover>
                        <mi>S</mi>
                        <mo>^</mo>
                      </mover>
                      <mn>11</mn>
                    </msub>
                    <mo>&#x2061;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>s</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
                <mtd>
                  <mrow>
                    <msub>
                      <mover>
                        <mi>S</mi>
                        <mo>^</mo>
                      </mover>
                      <mn>12</mn>
                    </msub>
                    <mo>&#x2061;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>s</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
                <mtd>
                  <mrow>
                    <msub>
                      <mover>
                        <mi>S</mi>
                        <mo>^</mo>
                      </mover>
                      <mrow>
                        <mn>1</mn>
                        <mo>&#x2062;</mo>
                        <mi>N</mi>
                      </mrow>
                    </msub>
                    <mo>&#x2061;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>s</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mover>
                        <mi>S</mi>
                        <mo>^</mo>
                      </mover>
                      <mn>21</mn>
                    </msub>
                    <mo>&#x2061;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>s</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
                <mtd>
                  <mrow>
                    <msub>
                      <mover>
                        <mi>S</mi>
                        <mo>^</mo>
                      </mover>
                      <mn>22</mn>
                    </msub>
                    <mo>&#x2061;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>s</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
                <mtd>
                  <mrow>
                    <msub>
                      <mover>
                        <mi>S</mi>
                        <mo>^</mo>
                      </mover>
                      <mrow>
                        <mn>2</mn>
                        <mo>&#x2062;</mo>
                        <mi>N</mi>
                      </mrow>
                    </msub>
                    <mo>&#x2061;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>s</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mover>
                        <mi>S</mi>
                        <mo>^</mo>
                      </mover>
                      <mrow>
                        <mi>N</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                    <mo>&#x2061;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>s</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
                <mtd>
                  <mrow>
                    <msub>
                      <mover>
                        <mi>S</mi>
                        <mo>^</mo>
                      </mover>
                      <mrow>
                        <mi>N</mi>
                        <mo>&#x2062;</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>&#x2062;</mo>
                        <mn>2</mn>
                      </mrow>
                    </msub>
                    <mo>&#x2061;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>s</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
                <mtd>
                  <mrow>
                    <msub>
                      <mover>
                        <mi>S</mi>
                        <mo>^</mo>
                      </mover>
                      <mi>NN</mi>
                    </msub>
                    <mo>&#x2061;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>s</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <mrow>
            <msub>
              <mover>
                <mi>S</mi>
                <mo>^</mo>
              </mover>
              <mi>ij</mi>
            </msub>
            <mo>&#x2061;</mo>
            <mrow>
              <mo>(</mo>
              <mi>s</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mrow>
              <munderover>
                <mo>&#x2211;</mo>
                <mrow>
                  <mi>m</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                </mrow>
                <mi>M</mi>
              </munderover>
              <mo>&#x2062;</mo>
              <mfrac>
                <msubsup>
                  <mi>r</mi>
                  <mi>m</mi>
                  <mrow>
                    <mi>i</mi>
                    <mo>,</mo>
                    <mi>j</mi>
                  </mrow>
                </msubsup>
                <mrow>
                  <mi>s</mi>
                  <mo>+</mo>
                  <msubsup>
                    <mi>p</mi>
                    <mi>m</mi>
                    <mrow>
                      <mi>i</mi>
                      <mo>,</mo>
                      <mi>j</mi>
                    </mrow>
                  </msubsup>
                </mrow>
              </mfrac>
            </mrow>
            <mo>+</mo>
            <msup>
              <mi>k</mi>
              <mrow>
                <mi>i</mi>
                <mo>,</mo>
                <mi>j</mi>
              </mrow>
            </msup>
            <mo>+</mo>
            <mrow>
              <mi>s</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <msup>
                <mi>&#x2147;</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
              </msup>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>6</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
The real part of p<sub>m</sub><sup>i,j </sup>is larger than 0, that is p<sub>m</sub><sup>i,j</sup>&#x3e;0.
</p>
<p id="p-0032" num="0031">In block S<b>26</b>, the equivalent circuit production module <b>124</b> performs vector fitting on a determined amount of pole-residue to obtain a rational function matrix of S matrix. In block S<b>27</b>, the equivalent circuit production module <b>124</b> determines if the root mean square of the rational function matrix is less than the determined tolerant error of the system. In block S<b>28</b>, if the root mean square error is larger than or equals the tolerant error of the system, the equivalent circuit production module <b>124</b> increases the amount of pole-residue and then performs vector fitting. In block S<b>29</b>, if the root mean square error is less than the tolerant error of the system, the equivalent circuit production module <b>124</b> synthesizes a general SPICE equivalent circuit corresponding to the rational function matrix.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 3</figref> is a drawing illustrating an N-port circuit system, where &#x201c;a&#x201d; represents an incident wave of the S parameter, and &#x201c;b&#x201d; represents the reflected wave of the S parameter. Z<sub>0 </sub>represents a corresponding referential resistance. The S parameter of the N port circuit network can be presented as formula (7):</p>
<p id="p-0034" num="0033">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>b</mi>
          <mo>=</mo>
          <mi>Sa</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
          <mrow>
            <mi>where</mi>
            <mo>&#x2062;</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <mi>a</mi>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <msub>
                    <mi>a</mi>
                    <mn>1</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>a</mi>
                    <mn>2</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>a</mi>
                    <mi>N</mi>
                  </msub>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <mi>b</mi>
          <mo>=</mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <msub>
                    <mi>b</mi>
                    <mn>1</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>b</mi>
                    <mn>2</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>b</mi>
                    <mi>N</mi>
                  </msub>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>7</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0035" num="0034">The relationship among the incident wave &#x201c;a&#x201d;, reflective wave &#x201c;b&#x201d;, the port voltage V and the port current I can be represented by formula (8):</p>
<p id="p-0036" num="0035">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>a</mi>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mn>1</mn>
              <mn>2</mn>
            </mfrac>
            <mo>&#x2062;</mo>
            <mrow>
              <msubsup>
                <mi>Z</mi>
                <mn>0</mn>
                <mrow>
                  <mrow>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>/</mo>
                  <mn>2</mn>
                </mrow>
              </msubsup>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>V</mi>
                  <mo>+</mo>
                  <mrow>
                    <msub>
                      <mi>Z</mi>
                      <mn>0</mn>
                    </msub>
                    <mo>&#x2062;</mo>
                    <mi>I</mi>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <mi>b</mi>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mn>1</mn>
              <mn>2</mn>
            </mfrac>
            <mo>&#x2062;</mo>
            <mrow>
              <msubsup>
                <mi>Z</mi>
                <mn>0</mn>
                <mrow>
                  <mrow>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>/</mo>
                  <mn>2</mn>
                </mrow>
              </msubsup>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>V</mi>
                  <mo>-</mo>
                  <mrow>
                    <msub>
                      <mi>Z</mi>
                      <mn>0</mn>
                    </msub>
                    <mo>&#x2062;</mo>
                    <mi>I</mi>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <mrow>
            <mi>Wherein</mi>
            <mo>&#x2062;</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <mi>V</mi>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <msub>
                    <mi>V</mi>
                    <mn>1</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>V</mi>
                    <mn>2</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>V</mi>
                    <mi>N</mi>
                  </msub>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <mi>I</mi>
          <mo>=</mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <msub>
                    <mi>I</mi>
                    <mn>1</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>I</mi>
                    <mn>2</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>I</mi>
                    <mi>N</mi>
                  </msub>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>Z</mi>
            <mn>0</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <msub>
                    <mi>Z</mi>
                    <mrow>
                      <mn>0</mn>
                      <mo>,</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <msub>
                    <mi>Z</mi>
                    <mrow>
                      <mn>0</mn>
                      <mo>,</mo>
                      <mn>2</mn>
                    </mrow>
                  </msub>
                </mtd>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
                <mtd>
                  <msub>
                    <mi>Z</mi>
                    <mrow>
                      <mn>0</mn>
                      <mo>,</mo>
                      <mi>N</mi>
                    </mrow>
                  </msub>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>8</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0037" num="0036">The relationship among voltage, current and S parameters can be obtained by formula (9):
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>I=Z</i><sub>0</sub><sup>&#x2212;1</sup><i>V&#x2212;Z</i><sub>0</sub><sup>&#x2212;1/2</sup><i>SZ</i><sub>0</sub><sup>1/2</sup>(<i>Z</i><sub>0</sub><sup>&#x2212;1</sup><i>V+I</i>)&#x2003;&#x2003;(9)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0038" num="0037">Formula (10) can be obtained by substituting the rational function matrix formula (6) into formula (9):</p>
<p id="p-0039" num="0038">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <msub>
                    <mi>I</mi>
                    <mn>1</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>I</mi>
                    <mn>2</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>&#x2026;</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>I</mi>
                    <mi>N</mi>
                  </msub>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mo>[</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <mfrac>
                      <msub>
                        <mi>V</mi>
                        <mn>1</mn>
                      </msub>
                      <msub>
                        <mi>Z</mi>
                        <mrow>
                          <mi>o</mi>
                          <mo>,</mo>
                          <mn>1</mn>
                        </mrow>
                      </msub>
                    </mfrac>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mfrac>
                      <msub>
                        <mi>V</mi>
                        <mn>2</mn>
                      </msub>
                      <msub>
                        <mi>Z</mi>
                        <mrow>
                          <mi>o</mi>
                          <mo>,</mo>
                          <mn>2</mn>
                        </mrow>
                      </msub>
                    </mfrac>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mi>&#x2026;</mi>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mfrac>
                      <msub>
                        <mi>V</mi>
                        <mn>2</mn>
                      </msub>
                      <msub>
                        <mi>Z</mi>
                        <mrow>
                          <mi>o</mi>
                          <mo>,</mo>
                          <mi>N</mi>
                        </mrow>
                      </msub>
                    </mfrac>
                  </mtd>
                </mtr>
              </mtable>
              <mo>]</mo>
            </mrow>
            <mo>-</mo>
            <mrow>
              <mrow>
                <mo>[</mo>
                <mtable>
                  <mtr>
                    <mtd>
                      <mrow>
                        <msub>
                          <mover>
                            <mi>S</mi>
                            <mo>^</mo>
                          </mover>
                          <mn>11</mn>
                        </msub>
                        <mo>&#x2061;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>s</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mtd>
                    <mtd>
                      <mrow>
                        <msub>
                          <mover>
                            <mi>S</mi>
                            <mo>^</mo>
                          </mover>
                          <mn>12</mn>
                        </msub>
                        <mo>&#x2061;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>s</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mtd>
                    <mtd>
                      <mi>&#x2026;</mi>
                    </mtd>
                    <mtd>
                      <mrow>
                        <msub>
                          <mover>
                            <mi>S</mi>
                            <mo>^</mo>
                          </mover>
                          <mrow>
                            <mn>1</mn>
                            <mo>&#x2062;</mo>
                            <mi>N</mi>
                          </mrow>
                        </msub>
                        <mo>&#x2061;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>s</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow>
                        <msub>
                          <mover>
                            <mi>S</mi>
                            <mo>^</mo>
                          </mover>
                          <mn>21</mn>
                        </msub>
                        <mo>&#x2061;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>s</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mtd>
                    <mtd>
                      <mrow>
                        <msub>
                          <mover>
                            <mi>S</mi>
                            <mo>^</mo>
                          </mover>
                          <mn>22</mn>
                        </msub>
                        <mo>&#x2061;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>s</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mtd>
                    <mtd>
                      <mi>&#x2026;</mi>
                    </mtd>
                    <mtd>
                      <mrow>
                        <msub>
                          <mover>
                            <mi>S</mi>
                            <mo>^</mo>
                          </mover>
                          <mrow>
                            <mn>2</mn>
                            <mo>&#x2062;</mo>
                            <mi>N</mi>
                          </mrow>
                        </msub>
                        <mo>&#x2061;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>s</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mi>&#x2026;</mi>
                    </mtd>
                    <mtd>
                      <mi>&#x2026;</mi>
                    </mtd>
                    <mtd>
                      <mi>&#x2026;</mi>
                    </mtd>
                    <mtd>
                      <mi>&#x2026;</mi>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow>
                        <msub>
                          <mover>
                            <mi>S</mi>
                            <mo>^</mo>
                          </mover>
                          <mrow>
                            <mi>N</mi>
                            <mo>&#x2062;</mo>
                            <mstyle>
                              <mspace width="0.3em" height="0.3ex"/>
                            </mstyle>
                            <mo>&#x2062;</mo>
                            <mn>1</mn>
                          </mrow>
                        </msub>
                        <mo>&#x2061;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>s</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mtd>
                    <mtd>
                      <mrow>
                        <msub>
                          <mover>
                            <mi>S</mi>
                            <mo>^</mo>
                          </mover>
                          <mrow>
                            <mi>N</mi>
                            <mo>&#x2062;</mo>
                            <mstyle>
                              <mspace width="0.3em" height="0.3ex"/>
                            </mstyle>
                            <mo>&#x2062;</mo>
                            <mn>2</mn>
                          </mrow>
                        </msub>
                        <mo>&#x2061;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>s</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mtd>
                    <mtd>
                      <mi>&#x2026;</mi>
                    </mtd>
                    <mtd>
                      <mrow>
                        <msub>
                          <mover>
                            <mi>S</mi>
                            <mo>^</mo>
                          </mover>
                          <mi>NN</mi>
                        </msub>
                        <mo>&#x2061;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>s</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mtd>
                  </mtr>
                </mtable>
                <mo>]</mo>
              </mrow>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>[</mo>
                <mtable>
                  <mtr>
                    <mtd>
                      <msub>
                        <mover>
                          <mi>V</mi>
                          <mo>~</mo>
                        </mover>
                        <mn>1</mn>
                      </msub>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <msub>
                        <mover>
                          <mi>V</mi>
                          <mo>~</mo>
                        </mover>
                        <mn>2</mn>
                      </msub>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mi>&#x2026;</mi>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <msub>
                        <mover>
                          <mi>V</mi>
                          <mo>~</mo>
                        </mover>
                        <mi>N</mi>
                      </msub>
                    </mtd>
                  </mtr>
                </mtable>
                <mo>]</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <mrow>
            <mi>Wherein</mi>
            <mo>&#x2062;</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <msub>
              <mover>
                <mi>V</mi>
                <mo>~</mo>
              </mover>
              <mi>i</mi>
            </msub>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mfrac>
                <msub>
                  <mi>V</mi>
                  <mi>i</mi>
                </msub>
                <msub>
                  <mi>Z</mi>
                  <mrow>
                    <mi>o</mi>
                    <mo>,</mo>
                    <mi>i</mi>
                  </mrow>
                </msub>
              </mfrac>
              <mo>+</mo>
              <msub>
                <mi>I</mi>
                <mi>i</mi>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>10</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0040" num="0039">The residue of &#x15c;<sub>ij</sub>(s) can be represented as real parts and complex parts as formula (11):
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>{circumflex over (<i>S</i>)}<sub>ij</sub>(<i>s</i>)={circumflex over (<i>S</i>)}<i>r</i><sub>ij</sub>(<i>s</i>)+{circumflex over (<i>S</i>)}<i>c</i><sub>ij</sub>(<i>s</i>)+<i>k</i><sup>i,j</sup><i>+se</i><sup>i,j</sup>&#x2003;&#x2003;(11)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0041" num="0040">&#x15c;<sub>ij</sub>(s) and &#x15c;c<sub>ij</sub>(s) can be represented by formula (12):</p>
<p id="p-0042" num="0041">
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mover>
              <mi>S</mi>
              <mo>^</mo>
            </mover>
            <mo>&#x2062;</mo>
            <mrow>
              <msub>
                <mi>r</mi>
                <mi>ij</mi>
              </msub>
              <mo>&#x2061;</mo>
              <mrow>
                <mo>(</mo>
                <mi>s</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <munderover>
              <mo>&#x2211;</mo>
              <mrow>
                <mi>u</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>U</mi>
            </munderover>
            <mo>&#x2062;</mo>
            <mfrac>
              <msubsup>
                <mi>r</mi>
                <mi>u</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
              </msubsup>
              <mrow>
                <mi>s</mi>
                <mo>+</mo>
                <msubsup>
                  <mi>p</mi>
                  <mi>u</mi>
                  <mrow>
                    <mi>i</mi>
                    <mo>,</mo>
                    <mi>j</mi>
                  </mrow>
                </msubsup>
              </mrow>
            </mfrac>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msubsup>
            <mi>r</mi>
            <mi>u</mi>
            <mrow>
              <mi>i</mi>
              <mo>,</mo>
              <mi>j</mi>
            </mrow>
          </msubsup>
          <mo>&#x3e;</mo>
          <mrow>
            <mn>0</mn>
            <mo>&#x2062;</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <mi>for</mi>
            <mo>&#x2062;</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <mi>u</mi>
          </mrow>
          <mo>&#x3c;</mo>
          <msup>
            <mi>U</mi>
            <mo>+</mo>
          </msup>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msubsup>
            <mi>r</mi>
            <mi>u</mi>
            <mrow>
              <mi>i</mi>
              <mo>,</mo>
              <mi>j</mi>
            </mrow>
          </msubsup>
          <mo>&#x2264;</mo>
          <mrow>
            <mn>0</mn>
            <mo>&#x2062;</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <mi>for</mi>
            <mo>&#x2062;</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <mi>u</mi>
          </mrow>
          <mo>&#x3e;</mo>
          <msup>
            <mi>U</mi>
            <mo>+</mo>
          </msup>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>12</mn>
          <mo>&#x2062;</mo>
          <mi>a</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mstyle>
          <mspace width="4.4em" height="4.4ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mrow>
          <mrow>
            <mrow>
              <mover>
                <mi>S</mi>
                <mo>^</mo>
              </mover>
              <mo>&#x2062;</mo>
              <mrow>
                <msub>
                  <mi>c</mi>
                  <mi>ij</mi>
                </msub>
                <mo>&#x2061;</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>s</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
            <mo>=</mo>
            <mrow>
              <mrow>
                <munderover>
                  <mo>&#x2211;</mo>
                  <mrow>
                    <mi>v</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mi>V</mi>
                </munderover>
                <mo>&#x2062;</mo>
                <mfrac>
                  <mrow>
                    <msubsup>
                      <mi>c</mi>
                      <mi>v</mi>
                      <mrow>
                        <mi>i</mi>
                        <mo>,</mo>
                        <mi>j</mi>
                      </mrow>
                    </msubsup>
                    <mo>+</mo>
                    <mrow>
                      <msubsup>
                        <mi>d</mi>
                        <mi>v</mi>
                        <mrow>
                          <mi>i</mi>
                          <mo>,</mo>
                          <mi>j</mi>
                        </mrow>
                      </msubsup>
                      <mo>&#x2062;</mo>
                      <mi>j</mi>
                    </mrow>
                  </mrow>
                  <mrow>
                    <mi>s</mi>
                    <mo>+</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msubsup>
                          <mi>a</mi>
                          <mi>v</mi>
                          <mrow>
                            <mi>i</mi>
                            <mo>,</mo>
                            <mi>j</mi>
                          </mrow>
                        </msubsup>
                        <mo>+</mo>
                        <mrow>
                          <msubsup>
                            <mi>b</mi>
                            <mi>v</mi>
                            <mrow>
                              <mi>i</mi>
                              <mo>,</mo>
                              <mi>j</mi>
                            </mrow>
                          </msubsup>
                          <mo>&#x2062;</mo>
                          <mi>j</mi>
                        </mrow>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mfrac>
              </mrow>
              <mo>+</mo>
              <mfrac>
                <mrow>
                  <msubsup>
                    <mi>c</mi>
                    <mi>v</mi>
                    <mrow>
                      <mi>i</mi>
                      <mo>,</mo>
                      <mi>j</mi>
                    </mrow>
                  </msubsup>
                  <mo>-</mo>
                  <mrow>
                    <msubsup>
                      <mi>d</mi>
                      <mi>v</mi>
                      <mrow>
                        <mi>i</mi>
                        <mo>,</mo>
                        <mi>j</mi>
                      </mrow>
                    </msubsup>
                    <mo>&#x2062;</mo>
                    <mi>j</mi>
                  </mrow>
                </mrow>
                <mrow>
                  <mi>s</mi>
                  <mo>+</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <msubsup>
                        <mi>a</mi>
                        <mi>v</mi>
                        <mrow>
                          <mi>i</mi>
                          <mo>,</mo>
                          <mi>j</mi>
                        </mrow>
                      </msubsup>
                      <mo>-</mo>
                      <mrow>
                        <msubsup>
                          <mi>b</mi>
                          <mi>v</mi>
                          <mrow>
                            <mi>i</mi>
                            <mo>,</mo>
                            <mi>j</mi>
                          </mrow>
                        </msubsup>
                        <mo>&#x2062;</mo>
                        <mi>j</mi>
                      </mrow>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mfrac>
            </mrow>
          </mrow>
          <mo>,</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>12</mn>
          <mo>&#x2062;</mo>
          <mi>b</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>&#x3bd;</sub><sup>i,j</sup>&#x2266;0 for &#x3bd;&#x2266;<i>V</i><sup>+</sup><i>, c</i><sub>&#x3bd;</sub><sup>i,j</sup>&#x3c;0 for &#x3bd;&#x3e;<i>V</i><sup>+</sup><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="h-0004" num="0000">Wherein U+2V=M, p<sub>u</sub><sup>i,j</sup>&#x3e;0, &#x3b1;<sub>&#x3bd;</sub><sup>i,j</sup>&#x3e;0, b<sub>&#x3bd;</sub><sup>i,j</sup>&#x3e;0, d<sub>&#x3bd;</sub><sup>i,j</sup>&#x3e;0.</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIGS. 4 to 6</figref> show equivalent circuits stimulated and synthesized based on formulas (10) to formula (12).</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a main equivalent circuit represented by a general SPICE format. <figref idref="DRAWINGS">FIG. 5</figref> to <figref idref="DRAWINGS">FIG. 6</figref> illustrate a first sub-equivalent and a second sub-equivalent circuit of the equivalent circuit of <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0045" num="0044">The equivalent circuit generated by the circuit simulation system and method as disclosed is capable of transforming a Tabular W-element format (*.tab) to a general SPICE format with high accuracy, and increases convenience in signal simulation.</p>
<p id="p-0046" num="0045">While the invention has been described by way of example and in terms of preferred embodiment, it is to be understood that the invention is not limited thereto. To the contrary, it is intended to cover various modifications and similar arrangements (as would be apparent to those skilled in the art). Therefore, the scope of the appended claims should be accorded the broadest interpretation so as to encompass all such modifications and similar arrangements.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08626482-20140107-M00001.NB">
<img id="EMI-M00001" he="19.73mm" wi="76.20mm" file="US08626482-20140107-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08626482-20140107-M00002.NB">
<img id="EMI-M00002" he="8.81mm" wi="76.20mm" file="US08626482-20140107-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08626482-20140107-M00003.NB">
<img id="EMI-M00003" he="8.81mm" wi="76.20mm" file="US08626482-20140107-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US08626482-20140107-M00004.NB">
<img id="EMI-M00004" he="15.16mm" wi="76.20mm" file="US08626482-20140107-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US08626482-20140107-M00005.NB">
<img id="EMI-M00005" he="31.41mm" wi="76.20mm" file="US08626482-20140107-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US08626482-20140107-M00006.NB">
<img id="EMI-M00006" he="15.16mm" wi="76.20mm" file="US08626482-20140107-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US08626482-20140107-M00007.NB">
<img id="EMI-M00007" he="23.28mm" wi="76.20mm" file="US08626482-20140107-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US08626482-20140107-M00008.NB">
<img id="EMI-M00008" he="35.64mm" wi="76.20mm" file="US08626482-20140107-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US08626482-20140107-M00009.NB">
<img id="EMI-M00009" he="23.28mm" wi="76.20mm" file="US08626482-20140107-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A computer system, comprising:
<claim-text>a central processing unit;</claim-text>
<claim-text>a storage device storing one or more programs, the one or more programs comprising:
<claim-text>an acquisition module configured for reading a data file corresponding to a W-element format in the storage device, wherein the W-element is a transmission line model in HSPICE, and obtain a frequency-dependent transmission matrix from the data file using an interpolation algorithm;</claim-text>
<claim-text>a first parameter transformation module configured for transforming the frequency-dependent transmission matrix into an N-port network matrix, wherein the N-port network matrix describes electrical properties of a multi-input and multi-output network;</claim-text>
<claim-text>a second parameter transformation module configured for transforming the N-port network matrix into a S-parameter matrix;</claim-text>
<claim-text>a parameter determination module configured for determining a range of frequency of a S-parameter in the S-parameter matrix, and for determining numbers of pole-residue, a number of recursion of a vector fitting occurs, and durable maximum system errors in an equivalent circuit simulation; and</claim-text>
</claim-text>
<claim-text>an equivalent circuit production module configured for performing a vector fitting algorithm, producing a rational function matrix composed with the S-parameters,</claim-text>
</claim-text>
<claim-text>wherein the rational function matrix comprises function for determining the S-parameters in the S-parameter matrix, and producing an equivalent circuit compatible with HSPICE format based on the generated rational function matrix.</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The computer system as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the equivalent circuit production module is configured for determining if a root mean square of the error of the rational function matrix is less than selected system errors, and increasing numbers of pole-residue to perform vector fitting when the system error is more than the root mean square of the error of the rational function matrix.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The computer system as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the frequency-dependent transmission matrix is a tabular resistances, inductances, reactances, and capacitances (RLGC) model for W-element comprising information of resistance, inductance, reactance, and capacitance.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The computer system as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the N-port network matrix describes electrical properties of a multi-input and multi-output network, and connection relationship therebetween.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The computer system as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the S-parameter matrix is a diverging matrix describing relationship between an incident voltage wave and a reflective voltage wave in a high frequency circuit.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. An equivalent circuit simulation method, comprising:
<claim-text>reading a data file corresponding to a W-element format in a storage device, wherein the W-element is a transmission line model in HSPICE;</claim-text>
<claim-text>obtaining a frequency-dependent transmission matrix from the data file using interpolation algorithm;</claim-text>
<claim-text>transforming the frequency-dependent transmission matrix into a N-port network matrix, wherein the N-port network matrix describes electrical properties of a multi-input and multi-output network;</claim-text>
<claim-text>transforming the N-port network matrix into a S-parameter matrix;</claim-text>
<claim-text>determining a range of frequency of a S-parameter in the S-parameter matrix by using the interpolation algorithm;</claim-text>
<claim-text>determining numbers of pole-residue, a number of recursion of a vector fitting occurs and durable maximum system errors in an equivalent circuit simulation;</claim-text>
<claim-text>producing a rational function matrix composed with the S-parameters by performing a vector fitting algorithm, wherein the rational function matrix is a function for determining the S-parameters in the S-parameter matrix; and</claim-text>
<claim-text>producing an equivalent circuit compatible with HSPICE format based on the generated rational function matrix.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The equivalent circuit simulation method as claimed in <claim-ref idref="CLM-00006">claim 6</claim-ref>, further comprising:
<claim-text>determining if a root mean square of the error of the rational function matrix is less than selected system errors; and</claim-text>
<claim-text>increasing numbers of pole-residue to perform vector fitting when the system error is more than the root mean square of the error of the rational function matrix.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The equivalent circuit simulation method as claimed in <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the frequency-dependent transmission matrix is a tabular RLGC model for W-element comprising information of resistance, inductance, reactance, and capacitance.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The equivalent circuit simulation method as claimed in <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the N-port network matrix describing electrical properties of a multi-input and multi-output network, and connection relationship therebetween.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The equivalent circuit simulation method as claimed in <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the S-parameter matrix is a diverging matrix describing relationship between an incident voltage wave and a reflective voltage wave in a high frequency circuit.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A non-transitory storage medium having stored thereon instructions that, when executed by a processor, causing the processor to perform an equivalent circuit simulation method, wherein the method comprises:
<claim-text>reading a data file corresponding to a W element format in a storage device, wherein the W-element is a transmission line model in HSPICE;</claim-text>
<claim-text>obtaining a frequency-dependent transmission matrix from the data file using an interpolation algorithm;</claim-text>
<claim-text>transforming the frequency-dependent transmission matrix into a N-port network matrix, wherein the N-port network matrix describes electrical properties of a multi-input and multi-output network;</claim-text>
<claim-text>transforming the N-port network matrix into a S-parameter matrix;</claim-text>
<claim-text>determining a range of frequency of a S-parameter in the S-parameter matrix by using the interpolation algorithm;</claim-text>
<claim-text>determining numbers of pole-residue, a number of recursion of a vector fitting occurs and durable maximum system errors in an equivalent circuit simulation; and</claim-text>
<claim-text>producing a rational function matrix composed with the S-parameters by performing a vector fitting algorithm, wherein the rational function matrix is a function for determining the S-parameters in the S-parameter matrix;</claim-text>
<claim-text>producing an equivalent circuit compatible with HSPICE format based on the generated rational function matrix.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The non-transitory storage medium as claimed in <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the equivalent circuit simulation method further comprising:
<claim-text>determining if a root mean square of the error of the rational function matrix is less than selected system errors; and</claim-text>
<claim-text>increasing numbers of pole-residue to perform vector fitting when the system error is more than the root mean square of the error of the rational function matrix.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The non-transitory storage medium as claimed in <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the frequency-dependent transmission matrix is a tabular RLGC model for W-element comprising information of resistance, inductance, reactance, and capacitance.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The non-transitory storage medium as claimed in <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the N-port network matrix describing electrical properties of a multi-input and multi-output network, and connection relationship therebetween.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The non-transitory storage medium as claimed in <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the S-parameter matrix is a diverging matrix describing relationship between an incident voltage wave and a reflective voltage wave in a high frequency circuit. </claim-text>
</claim>
</claims>
</us-patent-grant>
