<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08627028-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08627028</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13546739</doc-number>
<date>20120711</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2008-244216</doc-number>
<date>20080924</date>
</priority-claim>
</priority-claims>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>12</main-group>
<subgroup>16</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>711162</main-classification>
<further-classification>711161</further-classification>
</classification-national>
<invention-title id="d2e61">Method of constructing replication environment and storage system</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>7206912</doc-number>
<kind>B2</kind>
<name>Mikami</name>
<date>20070400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7549027</doc-number>
<kind>B1</kind>
<name>McAndrews et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>8024536</doc-number>
<kind>B2</kind>
<name>Kaneko et al.</name>
<date>20110900</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2003/0188218</doc-number>
<kind>A1</kind>
<name>Lubbers et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2005/0088976</doc-number>
<kind>A1</kind>
<name>Chafle et al.</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2005/0138309</doc-number>
<kind>A1</kind>
<name>Hiraiwa et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711162</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2006/0107098</doc-number>
<kind>A1</kind>
<name>Maki et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2006/0161732</doc-number>
<kind>A1</kind>
<name>Murotani et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2007/0245106</doc-number>
<kind>A1</kind>
<name>Maki et al.</name>
<date>20071000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711162</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2007/0255916</doc-number>
<kind>A1</kind>
<name>Hiraiwa et al.</name>
<date>20071100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711162</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2008/0092053</doc-number>
<kind>A1</kind>
<name>Fujibayashi</name>
<date>20080400</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2008/0126437</doc-number>
<kind>A1</kind>
<name>Chiba</name>
<date>20080500</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2011/0078395</doc-number>
<kind>A1</kind>
<name>Okada et al.</name>
<date>20110300</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2011/0153968</doc-number>
<kind>A1</kind>
<name>Hiraiwa et al.</name>
<date>20110600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711162</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>JP</country>
<doc-number>2005-011311</doc-number>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>JP</country>
<doc-number>2005-182532</doc-number>
<kind>A</kind>
<date>20050700</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>7</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>18</number-of-drawing-sheets>
<number-of-figures>26</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>13213772</doc-number>
<date>20110819</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>8234474</doc-number>
</document-id>
</parent-grant-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13546739</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>12272305</doc-number>
<date>20081117</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>8024536</doc-number>
</document-id>
</parent-grant-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13213772</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120278574</doc-number>
<kind>A1</kind>
<date>20121101</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Kaneko</last-name>
<first-name>Satoshi</first-name>
<address>
<city>Yokohama</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
<us-applicant sequence="002" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Maki</last-name>
<first-name>Nobuhiro</first-name>
<address>
<city>Yokohama</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
<us-applicant sequence="003" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Emaru</last-name>
<first-name>Hironori</first-name>
<address>
<city>Yokohama</city>
<country>JP</country>
</address>
</addressbook>
<residence>
<country>JP</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Kaneko</last-name>
<first-name>Satoshi</first-name>
<address>
<city>Yokohama</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
<inventor sequence="002" designation="us-only">
<addressbook>
<last-name>Maki</last-name>
<first-name>Nobuhiro</first-name>
<address>
<city>Yokohama</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
<inventor sequence="003" designation="us-only">
<addressbook>
<last-name>Emaru</last-name>
<first-name>Hironori</first-name>
<address>
<city>Yokohama</city>
<country>JP</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Foley &#x26; Lardner LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Hitachi, Ltd.</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Nguyen</last-name>
<first-name>Than</first-name>
<department>2188</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A management computer collects a usage condition of a volume from a host computer and a storage apparatus at each site, consolidates management thereof, and prevents a volume from duplicating among applications as a copy source. This makes it possible to select a used volume in an application as a copy source without excess or deficiency and to create a copy pair configuration definition without duplication or incompatibility. If a replication environment is constructed in a large-scale storage system, the consolidated management of a usage condition of a volume collected from the host computer and the storage apparatus at each site makes it possible to create a copy pair configuration definition by a task constituted by a plurality of applications.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="253.15mm" wi="190.58mm" file="US08627028-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="234.02mm" wi="176.28mm" orientation="landscape" file="US08627028-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="212.51mm" wi="177.80mm" file="US08627028-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="222.08mm" wi="169.59mm" file="US08627028-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="173.06mm" wi="140.38mm" file="US08627028-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="181.86mm" wi="175.77mm" file="US08627028-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="273.81mm" wi="171.70mm" file="US08627028-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="225.98mm" wi="196.00mm" file="US08627028-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="260.94mm" wi="193.46mm" file="US08627028-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="246.55mm" wi="172.47mm" file="US08627028-20140107-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="263.65mm" wi="209.80mm" file="US08627028-20140107-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="218.69mm" wi="195.50mm" file="US08627028-20140107-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="238.42mm" wi="160.19mm" file="US08627028-20140107-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="195.50mm" wi="184.57mm" file="US08627028-20140107-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="207.77mm" wi="174.41mm" file="US08627028-20140107-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="230.97mm" wi="189.40mm" file="US08627028-20140107-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="264.33mm" wi="188.04mm" file="US08627028-20140107-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="229.53mm" wi="209.80mm" file="US08627028-20140107-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="264.33mm" wi="201.68mm" file="US08627028-20140107-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED PATENT APPLICATIONS</heading>
<p id="p-0002" num="0001">Japan Priority Application 2008-244216, filed Sep. 24, 2008 including the specification, drawings, claims and abstract, is incorporated herein by reference in its entirety. This application is a Continuation of U.S. application Ser. No. 13/213,772, filed Aug. 19, 2011, incorporated herein by reference in its entirety, which is a Continuation of U.S. application Ser. No. 12/272,305, filed Nov. 17, 2008, incorporated herein by reference in its entirety.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">1. Field of the Invention</p>
<p id="p-0004" num="0003">The present invention relates to a method of constructing a replication environment in which a copy pair of a volume used by a group constituted by a plurality of applications is created in a storage system including a host computer, a storage apparatus, and a management computer; and to the storage system.</p>
<p id="p-0005" num="0004">2. Description of the Related Art</p>
<p id="p-0006" num="0005">Along with a wide spread of information systems, an amount of data handled by computing systems has been increased explosively. Importance of the handled data has also grown drastically. A high-level reliability in protecting such data has been required. Thus, a system of disaster recovery (DR) which can protect data from a logic failure (system failure) and a physical disaster has increasingly become important.</p>
<p id="p-0007" num="0006">In the DR system, data can be duplicated by storing data outputted from a host computer which performs a task, not only in a volume in a storage apparatus directly connected to the host computer but also in a volume of another storage apparatus.</p>
<p id="p-0008" num="0007">Typically, so-called local copy and remote copy are used in an information system which requires a high-level reliability. The local copy refers to a copying in which a data in a volume in a storage apparatus is copied in another volume of the same storage apparatus. The remote copy refers to a copying in which a data in a volume in a storage apparatus is copied in a volume in another storage apparatus. The local copy and the remote copy are collectively referred to as a replication. With a technique of the replication, if a volume has any trouble and cannot perform its operations, another volume can take over them using a duplicated data stored therein. Two volumes as a copy source and a copy destination in a replication relationship are collectively called a copy pair.</p>
<p id="p-0009" num="0008">A replication is typically performed by selecting a volume used by an application desired to be copied, as a copy source, and selecting a volume having a free space sufficient to newly create a copy from the copy source, as a copy destination. This operation creates a configuration definition of a copy pair. A remote copy is performed by, as a preliminary operation, executing an initial copy based on information on the copy pair configuration definition prepared as described above. The initial copy means a copying of all data in the copy source volume into the copy destination volume. After executing the initial copy, an update copy is performed to the copy destination volume each time the host computer provides write data to the copy source volume. If a storage system as a copy source has any trouble, a task in the copy source volume can be restored using the copy destination volume in a storage system as a copy destination.</p>
<p id="p-0010" num="0009">Japanese Laid-Open Patent Application, Publication No. 2005-11311 discloses a technique of creating a copy pair configuration definition by specifying an application as a copy source, in a storage system including a plurality of host computers and a plurality of storage apparatuses.</p>
<p id="p-0011" num="0010">In Japanese Laid-Open Patent Application, Publication No. 2005-11311, a resource at a copy destination (a secondary computer resource) is selected based on at least a set of user-specified policy. The policy used herein includes characteristics (for example, reliability) of a secondary computer resource and a cost thereof. Nevertheless, such a selection does not give sufficient consideration to a task executed in the host computer.</p>
<p id="p-0012" num="0011">A problem in constructing a DR system is an environment construction of a replication by a task as a unit. This is because, if a task is constituted by a group configured by a plurality of applications, protection of one or more specific applications alone is not sufficient to carry on the task. Such a task may be constituted by a plurality of associated applications, or a specific application in the task may have a cluster configuration.</p>
<p id="p-0013" num="0012">The present invention has been made in an attempt to solve the aforementioned problems. The present invention provides a method of constructing a replication environment in which a copy pair of a volume used by a group constituted by a plurality of applications in a storage system is created, and the storage system.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0014" num="0013">A management computer consolidates management of a usage condition of a volume collected from a host computer and a storage apparatus at each site and prevents a volume from duplicating among applications as a copy source, by an application as a unit. This makes it possible to select a used volume of an application as a copy source without excess or deficiency and to create a copy pair configuration definition without duplication or incompatibility.</p>
<p id="p-0015" num="0014">Other features and advantages of the present invention will become more apparent from the following detailed description of the invention, when taken in conjunction with the accompanying exemplary drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 1</figref> is a diagram showing a general configuration of a storage system according to a first embodiment.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2</figref> is a diagram showing a configuration of a management computer according to the first embodiment.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram showing a configuration of a host computer according to the first embodiment.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 4</figref> is a diagram showing a configuration of a storage apparatus according to the first embodiment.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 5</figref> is a diagram showing an example of an application configuration table stored in the host computer according to the first embodiment.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 6</figref> is a diagram showing an example of an application configuration table stored in the management computer according to the first embodiment.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 7A</figref> is a diagram showing an example of a volume configuration table at a primary site in the management computer according to the first embodiment. <figref idref="DRAWINGS">FIG. 7B</figref> is a diagram showing an example of a volume configuration table at a remote site in the management computer according to the first embodiment.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 8</figref> is a diagram showing an example of a copy pair configuration definition table stored in the management computer and the storage apparatus according to the first embodiment.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 9</figref> is a diagram showing an example of a graphical user interface (GUI) according to the first embodiment.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 10</figref> is a flowchart showing a processing of copy pair configuration definition creation according to the first embodiment.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 11</figref> is a diagram showing an example of an application configuration table stored in a management computer according to a second embodiment.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 12</figref> is a diagram showing an example of a cluster configuration table according to the second embodiment.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 13</figref> is a diagram showing an example of a composite application configuration table according to a third embodiment.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 14</figref> is a diagram showing an example of a GUI according to the third embodiment.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 15</figref> is a diagram showing a configuration of a management computer according to a fourth embodiment.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 16</figref> is a diagram showing a configuration of a host computer according to the fourth embodiment.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 17</figref> is a diagram showing a configuration of a volume in a storage apparatus according to the fourth embodiment.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 18</figref> is a diagram showing an example of a VM (virtual machine) configuration table stored in the host computer according to the fourth embodiment.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 19</figref> is a diagram showing an example of a VM configuration table stored in the management computer according to the fourth embodiment.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 20A</figref> is a diagram showing an example of a volume configuration table at a primary site stored in the management computer according to the fourth embodiment.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 20B</figref> is a diagram showing an example of a volume configuration table at a remote site stored in the management computer according to the fourth embodiment.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 21</figref> is a diagram showing an example of a GUI according to the fourth embodiment.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 22</figref> is a flowchart showing a processing of copy pair configuration definition creation according to the fourth embodiment.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 23</figref> is a diagram showing an example of a GUI according to a fifth embodiment.</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 24</figref> is a flowchart showing a processing of copy pair configuration definition creation according to the fifth embodiment.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE EXEMPLARY EMBODIMENT</heading>
<p id="p-0041" num="0040">Next is described an embodiment of the present invention. The present invention is not, however, limited to the embodiment described below.</p>
<p id="h-0006" num="0000">First Embodiment</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 1</figref> shows a general configuration of a storage system according to the first embodiment. The storage system includes a storage apparatus <b>1300</b>A (which may be collectively referred to as a storage apparatus <b>1300</b>; ditto below), and host computers <b>1200</b>A(<b>1200</b>),<b>1200</b>B(<b>1200</b>),<b>1200</b>C(<b>1200</b>), which are connected via a data network <b>1500</b>A(<b>1500</b>) (which may also be referred to as a first network). The storage system also includes a storage apparatus <b>1300</b>B(<b>1300</b>) and host computers <b>1200</b>D(<b>1200</b>), <b>1200</b>E(<b>1200</b>),<b>1200</b>F(<b>1200</b>), which are connected via a data network <b>1500</b>B(<b>1500</b>). The management computer <b>1100</b>, host computers <b>1200</b>, and storage apparatus <b>1300</b> are connected via a management network <b>1400</b> (which may also be referred to as a second network). The storage apparatuses <b>1300</b>A and <b>1300</b>B are connected via a remote network <b>1600</b>.</p>
<p id="p-0043" num="0042">The data network <b>1500</b> herein is a storage area network (SAN) but may be an IP network or any other data communication network. The management network <b>1400</b> herein is an IP network, but may be a SAN or any other data communication network.</p>
<p id="p-0044" num="0043">The management computer <b>1100</b> herein is directly connected to the storage apparatus <b>1300</b> but may acquire necessary information via the host computer <b>1200</b>. The data network <b>1500</b> and the management network <b>1400</b> herein are separately provided but the data network <b>1500</b> may also serve as the management network <b>1400</b>. Or, the management computer <b>1100</b> and the host computer <b>1200</b> may be one single computer unit. For convenience of description, the storage system shown in <figref idref="DRAWINGS">FIG. 1</figref> includes two storage apparatuses <b>1300</b>, six host computers <b>1200</b>, and one management computer <b>1100</b>. In the present invention, however, the number of those units is not limited to this.</p>
<p id="p-0045" num="0044">In this embodiment, a set of the host computer <b>1200</b>, the storage apparatus <b>1300</b>, and the data network <b>1500</b> for connecting the two formers is herein referred to as a site. A plurality of sites is typically provided at geographically separated locations. This is because, if a site at a certain location is damaged and cannot continue its operations, another site at a separated location which is not damaged can take over them. In <figref idref="DRAWINGS">FIG. 1</figref>, the storage system includes a primary site <b>1700</b> and a remote site <b>1800</b> which is a backup site of the primary site <b>1700</b>. This configuration is referred to as a two data center (2DC) configuration.</p>
<p id="p-0046" num="0045">In the 2DC configuration, a remote copy is performed between the primary site <b>1700</b> and the remote site <b>1800</b> via the remote network <b>1600</b>. The remote copy herein means a technique of duplicating a data by copying a data from a volume in a storage apparatus into a volume in another storage apparatus. Using the remote copy technique, if a volume has any trouble and cannot perform its operations, another volume can take over them using a duplicated data stored therein. Two volumes as a copy source and a copy destination in a remote copy relationship are collectively called a copy pair. For convenience of description, the storage system of the present invention includes two sites. However, the number of those units is not limited to this.</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 2</figref>, <figref idref="DRAWINGS">FIG. 3</figref>, and <figref idref="DRAWINGS">FIG. 4</figref> show configurations of the management computer <b>1100</b>, host computer <b>1200</b>, and storage apparatus <b>1300</b>, respectively.</p>
<p id="p-0048" num="0047">In <figref idref="DRAWINGS">FIG. 2</figref>, the management computer <b>1100</b> includes an input unit <b>1150</b> such as a keyboard and a mouse, a CPU (central processing unit) <b>1160</b>, a display unit <b>1170</b> such as a LCD (liquid crystal display), a memory <b>1130</b>, a local disk <b>1110</b>, and a management interface <b>1180</b> for sending and receiving a data or a control instruction for a system management to and from the host computer <b>1200</b>. The local disk <b>1110</b> is a disk unit such as a hard disk drive connected to the management computer <b>1100</b> and stores a management program <b>1120</b> therein. The management interface <b>1180</b> is an interface to the management network <b>1400</b>.</p>
<p id="p-0049" num="0048">The management program <b>1120</b> is loaded into the memory <b>1130</b> in the management computer <b>1100</b> and is executed by the CPU <b>1160</b>. The management program <b>1120</b> is a program in which a function of performing a configuration definition of a copy pair is provided via the input unit <b>1150</b> such as a keyboard or a mouse or the display unit <b>1170</b> such as a graphical user interface (GUI).</p>
<p id="p-0050" num="0049">The management program <b>1120</b> includes: an application configuration information acquisition unit <b>1122</b> for acquiring information on a used volume in an application in a host computer at each site; an application configuration table creation unit <b>1124</b> for creating a table in which information acquired by the application configuration information acquisition unit <b>1122</b> is arranged; an unused volume information acquisition unit <b>1125</b> for acquiring information on an unused volume from a storage microprogram in the storage apparatus <b>1300</b>; a site volume configuration table creation unit <b>1126</b> for creating a table in which the table created by the application configuration table creation unit <b>1124</b> and the information acquired by the unused volume information acquisition unit <b>1125</b> are arranged; a GUI display unit <b>1127</b> for providing an interface of creating a configuration definition of a copy pair to a user; and a copy pair configuration definition creation unit <b>1129</b> for conducting a processing of copy pair configuration definition creation.</p>
<p id="p-0051" num="0050">The management table <b>1140</b> in the memory <b>1130</b> includes; an application configuration table <b>1142</b> (which may also be referred to as application configuration information, see <figref idref="DRAWINGS">FIG. 6</figref>) created by the application configuration table creation unit <b>1124</b>; a site volume configuration table <b>1144</b> (which may also be referred to as site volume configuration information, see <figref idref="DRAWINGS">FIG. 7A</figref> and <figref idref="DRAWINGS">FIG. 7B</figref>) created by the site volume configuration table creation unit <b>1126</b>; and a copy pair configuration definition table <b>1146</b> (see <figref idref="DRAWINGS">FIG. 8</figref>) representing configuration definition information of a copy pair. Details of each of the tables will be described later.</p>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 3</figref> shows a configuration of a host computer according to the first embodiment. In <figref idref="DRAWINGS">FIG. 3</figref>, the host computer <b>1200</b> includes an input unit <b>1240</b> such as a keyboard and a mouse, a CPU <b>1220</b>, a display unit <b>1250</b> such as a LCD, a memory <b>1270</b>, a storage interface <b>1260</b>, a management interface <b>1265</b>, and a local disk <b>1210</b>.</p>
<p id="p-0053" num="0052">The management interface <b>1265</b> is an interface to the management network <b>1400</b> and sends and receives a data or a control instruction to and from the management computer <b>1100</b>. The storage interface <b>1260</b> is an interface to the data network <b>1500</b> and sends and receives a data or a control instruction to and from the storage apparatus <b>1300</b>. The local disk <b>1210</b> is a disk unit connected to the host computer <b>1200</b>, such as a hard disk drive and stores therein a plurality of applications <b>1212</b>, <b>1213</b>,<b>1214</b> and an agent program <b>1216</b>.</p>
<p id="p-0054" num="0053">The plurality of applications <b>1212</b>, <b>1213</b> and <b>1214</b> are loaded into the memory <b>1270</b> in the host computer <b>1200</b> and are executed by the CPU <b>1220</b>. Each of the applications <b>1212</b>, <b>1213</b>, and <b>1214</b> is a program for executing a task by reading or writing data to a volume in the storage apparatus <b>1300</b>. Each of the applications <b>1212</b>, <b>1213</b> and <b>1214</b> may be a DBMS (data base management system) or a file system. For convenience of description, <figref idref="DRAWINGS">FIG. 3</figref> shows three applications. In the present invention, however, the number of the applications is not limited to this.</p>
<p id="p-0055" num="0054">The agent program <b>1216</b> is loaded into the memory <b>1270</b> of the host computer <b>1200</b> and is executed by the CPU <b>1220</b>. The agent program <b>1216</b> is a program for acquiring information from an application based on instructions from the management computer <b>1100</b>. The agent program <b>1216</b> includes: an application configuration information acquisition unit <b>1217</b> for acquiring information on a used volume in an application of its own host computer <b>1200</b>; and an application configuration table creation unit <b>1218</b> for creating a table in which information acquired by the application configuration information acquisition unit <b>1217</b> is arranged. An application configuration table <b>1280</b> (see <figref idref="DRAWINGS">FIG. 5</figref>) in the memory <b>1270</b> will be described later.</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. 4</figref> shows a configuration of a storage apparatus according to the first embodiment. In <figref idref="DRAWINGS">FIG. 4</figref>, the storage apparatus <b>1300</b> includes; a disk unit <b>1310</b> for storing data therein; a disk controller <b>1320</b> for controlling the storage apparatus <b>1300</b>.</p>
<p id="p-0057" num="0056">The disk unit <b>1310</b> includes a plurality of volumes <b>1311</b>, <b>1312</b> and <b>1313</b>. A volume used herein may be a physical volume such as a hard disk drive (HDD) or a logical volume such as a logical device. A type of the volume is not limited in the present invention. For convenience of description, <figref idref="DRAWINGS">FIG. 4</figref> shows three volumes. In the present invention, however, the number of the volumes is not limited to this. A volume can make a copy pair.</p>
<p id="p-0058" num="0057">The disk controller <b>1320</b> includes a host interface <b>1328</b>, a remote interface <b>1326</b>, a disk interface <b>1325</b>, a memory <b>1321</b>, a CPU <b>1323</b>, a management interface <b>1322</b>, and a local disk <b>1327</b>.</p>
<p id="p-0059" num="0058">The management interface <b>1322</b> is an interface to the management network <b>1400</b> and sends and receives a data or a control instruction to and from the management computer <b>1100</b>. The local disk <b>1327</b> is a disk unit connected to the disk controller <b>1320</b>, such as a hard disk and stores therein a storage microprogram <b>1330</b>.</p>
<p id="p-0060" num="0059">The storage microprogram <b>1330</b> is loaded into the memory <b>1321</b> in the disk controller <b>1320</b> and is executed by the CPU <b>1323</b>. In this embodiment, the storage microprogram <b>1330</b> is stored in the local disk <b>1327</b> in the disk controller <b>1320</b>. In the present invention, however, a configuration is not limited to this. For example, the programs and tables may be stored in a flash memory provided in the disk controller <b>1320</b> or in any disk in the disk unit <b>1310</b>.</p>
<p id="p-0061" num="0060">The storage microprogram <b>1330</b> receives instructions from the unused volume information acquisition unit <b>1125</b> and the copy pair configuration definition creation unit <b>1129</b> in the management computer <b>1100</b>. Based on the instructions, the storage microprogram <b>1330</b> acquires a name of a site to which itself belongs and a usage condition of a volume in its own storage apparatus and provides controls on a copy pair. The usage condition of a volume includes information on whether or not the volume is used by an application or an OS (Operating System). An example of the controls of a copy pair is creation of a copy pair. The copy pair configuration definition table <b>1146</b> (see <figref idref="DRAWINGS">FIG. 8</figref>) in the memory <b>1321</b> is a table representing information on the configuration definition of a copy pair created by the management computer <b>1100</b>. The storage apparatus <b>1300</b> executes a copy task using the information in the copy pair configuration definition table <b>1324</b>.</p>
<p id="p-0062" num="0061">The host interface <b>1328</b> is an interface to the data network <b>1500</b> and sends and receives a data or control instruction to and from the host computer <b>1200</b>. The remote interface <b>1326</b> is an interface to the remote network <b>1600</b> and transfers data in an operation of a site-to-site remote copy. The disk interface <b>1325</b> is an interface to the disk unit <b>1310</b> and sends and receives a data or control instruction thereto and therefrom.</p>
<p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. 5</figref> shows an example of an application configuration table <b>1280</b> stored in the host computer <b>1200</b> according to the first embodiment. In <figref idref="DRAWINGS">FIG. 5</figref>, the application configuration table <b>1280</b> stored in the host computer <b>1200</b> includes an identifier of an application <b>5100</b> and an identifier of a volume <b>5150</b> used by the application. The application <b>5100</b> stores therein an identifier of an application which is installed on the host computer <b>1200</b> and uses a volume in the storage apparatus <b>1300</b>. The volume <b>5150</b> used by the application stores therein an identifier of a volume used by the application shown at the application <b>5100</b>. In this embodiment, the application configuration information acquisition unit <b>1217</b> (see <figref idref="DRAWINGS">FIG. 3</figref>) can acquire information on an application from its own host computer <b>1200</b>.</p>
<p id="p-0064" num="0063">Reference numerals <b>5010</b> to <b>5030</b> each indicate information on a volume used by the application installed on the host computer <b>1200</b> at the primary site <b>1700</b> in the storage system shown in <figref idref="DRAWINGS">FIG. 1</figref>. More specifically, the reference numeral <b>5010</b> indicates that an application referred to as AP<b>1</b> uses only a volume referred to as VOL<b>1</b>. The reference numeral <b>5020</b> indicates that an application referred to as AP<b>2</b> uses only a volume referred to as VOL<b>2</b>. The reference numeral <b>5030</b> indicates that an application referred to as AP<b>3</b> uses two volumes referred to as VOL<b>2</b> and VOL<b>3</b>. In other words, the applications AP<b>2</b> and AP<b>3</b> share the volume VOL<b>2</b>.</p>
<p id="p-0065" num="0064"><figref idref="DRAWINGS">FIG. 6</figref> shows an example of an application configuration table stored in the management computer <b>1100</b> according to the first embodiment. In <figref idref="DRAWINGS">FIG. 6</figref>, the application configuration table <b>1142</b> in the management computer <b>1100</b> includes respective identifiers of an application <b>5300</b>, a site <b>5350</b>, a host <b>5400</b>, and a volume <b>5450</b> used by the application. The application <b>5300</b> stores therein an identifier of an application. The site <b>5350</b> stores therein an identifier of a site to which the application shown in the application <b>5300</b> belongs. The application <b>5400</b> stores therein an identifier of a host in which the application shown at the application <b>5300</b> is in operation. The volume <b>5450</b> used by the application stores therein an identifier of a used volume of the application shown at the application <b>5300</b>.</p>
<p id="p-0066" num="0065">The application configuration information acquisition unit <b>1122</b> (see <figref idref="DRAWINGS">FIG. 2</figref>) acquires information included in the application configuration table <b>1142</b> from the host computer <b>1200</b> shown in <figref idref="DRAWINGS">FIG. 1</figref>. In this embodiment, the storage system has two sites, namely, the primary site <b>1700</b> and the remote site <b>1800</b>. The application configuration information acquisition unit <b>1122</b> collects the application configuration table <b>1280</b> (see <figref idref="DRAWINGS">FIG. 3</figref>) from the host computer <b>1200</b> at the each site and creates the application configuration table <b>1142</b> from the application configuration table <b>1280</b>.</p>
<p id="p-0067" num="0066">Reference numerals <b>5210</b> to <b>5230</b> each indicate information on an application present in the host computer <b>1200</b> at the primary site <b>1700</b> and the remote site <b>1800</b> in the storage system shown in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0068" num="0067">More specifically, the reference numeral <b>5210</b> indicates that the application referred to as AP<b>1</b> belongs to a site referred to as Site A, operates in the host computer <b>1200</b> referred to as Host A, and uses only a volume referred to as VOL<b>1</b>. The reference numeral <b>5220</b> indicates that the application referred to as AP<b>2</b> belongs to a site referred to as Site A, operates in the host computer <b>1200</b> referred to as Host A, and uses only the volume referred to as VOL<b>2</b>. The reference numeral <b>5230</b> indicates that the application referred to as AP<b>3</b> belongs to a site referred to as Site A, operates in the host computer <b>1200</b> referred to as Host A, and uses the two volumes referred to as VOL<b>2</b> and VOL<b>3</b>. In other words, the applications AP<b>2</b> and AP<b>3</b> share the volume VOL<b>2</b>.</p>
<p id="p-0069" num="0068"><figref idref="DRAWINGS">FIG. 7A</figref> shows an example of a volume configuration table <b>1144</b>A at the primary site <b>1700</b> (see <figref idref="DRAWINGS">FIG. 1</figref>) in the management computer <b>1100</b> according to the first embodiment. <figref idref="DRAWINGS">FIG. 7B</figref> shows an example of a volume configuration table <b>1144</b>B at the remote site <b>1800</b> (see <figref idref="DRAWINGS">FIG. 1</figref>) in the management computer <b>1100</b> according to the first embodiment. The site volume configuration table <b>1144</b> (see <figref idref="DRAWINGS">FIG. 2</figref>) in the management computer <b>1100</b> includes the primary site volume configuration table <b>1144</b>A and the remote site volume configuration table <b>1144</b>B.</p>
<p id="p-0070" num="0069">In <figref idref="DRAWINGS">FIG. 7A</figref>, the primary site volume configuration table <b>1144</b>A includes respective identifiers at a primary site volume <b>5600</b> and of an application <b>5700</b> which is using a volume. The primary site volume <b>5600</b> stores therein an identifier of a volume present at the primary site <b>1700</b>. The application <b>5700</b> which is using a volume stores therein an identifier of an application using the volume shown at the primary site volume <b>5600</b>. The site volume configuration table creation unit <b>1126</b> (see <figref idref="DRAWINGS">FIG. 2</figref>) acquires information on the volume used by an application from the application configuration table <b>1142</b> and also acquires information on a volume not used by an application from the unused volume information acquisition unit <b>1125</b>. The management computer <b>1100</b> can acquire information on all volumes at the primary site <b>1700</b>.</p>
<p id="p-0071" num="0070">Reference numerals <b>5510</b> to <b>5540</b> each indicate information on a volume present in the storage apparatus <b>1300</b> at the primary site <b>1700</b> in the storage system shown in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0072" num="0071">More specifically, the reference numeral <b>5510</b> indicates that the volume referred to as VOL<b>1</b> is used by an application referred to as AP<b>1</b>. The reference numeral <b>5520</b> indicates that the volume referred to as VOL<b>2</b> is used by applications referred to as AP<b>2</b> and AP<b>3</b>. In other words, the applications AP<b>2</b> and AP<b>3</b> share the volume VOL<b>2</b>. The reference numeral <b>5530</b> indicates that a volume referred to as VOL<b>3</b> is used by an application referred to as AP<b>3</b>. The reference numeral <b>5540</b> indicates that a volume referred to as VOL<b>4</b> is not used by any application.</p>
<p id="p-0073" num="0072">In <figref idref="DRAWINGS">FIG. 7B</figref>, the remote site volume configuration table <b>1144</b>B includes respective identifiers of a remote site volume <b>6100</b> and of an application <b>6200</b> which is using a volume. The remote site volume <b>6100</b> stores therein an identifier of a volume present at the remote site <b>1800</b>. The application <b>6200</b> which is using a volume stores therein an identifier of an application using the volume shown at the remote site volume <b>6100</b>.</p>
<p id="p-0074" num="0073">Similarly to the primary site volume configuration table <b>1144</b>A of <figref idref="DRAWINGS">FIG. 7A</figref>, the site volume configuration table creation unit <b>1126</b> (see <figref idref="DRAWINGS">FIG. 2</figref>) acquires information on a volume used by an application from the application configuration table <b>1142</b> and also acquires information on a volume not used by an application from the unused volume information acquisition unit <b>1125</b>. In this embodiment, the remote site <b>1800</b> is assumed to be a site prepared as a copy destination, and thus, any volume in the remote site <b>1800</b> is not used. In the present invention, however, even if an application is running at a site and if the site still has a necessary and sufficient unused volume, the site may be set as a remote site. Therefore, whether or not an application is running at a site does not make any difference.</p>
<p id="p-0075" num="0074">Reference numerals <b>6010</b> to <b>6040</b> each indicate information on a volume present in the storage apparatus <b>1300</b> at the remote site <b>1800</b> in the storage system shown in <figref idref="DRAWINGS">FIG. 1</figref>. The reference numerals <b>6010</b>, <b>6020</b>, <b>6030</b> and <b>6040</b> indicate that the volumes referred to as VOL<b>1</b>, VOL<b>2</b>, VOL<b>3</b> and VOL<b>4</b> are unused, respectively.</p>
<p id="p-0076" num="0075"><figref idref="DRAWINGS">FIG. 8</figref> shows an example of a copy pair configuration definition table <b>1146</b> stored in the management computer <b>1100</b> and the storage apparatus <b>1300</b> according to the first embodiment. The copy pair configuration definition table <b>1146</b> of <figref idref="DRAWINGS">FIG. 8</figref> is both in the management computer <b>1100</b> and the storage apparatus <b>1300</b>. In the storage system in <figref idref="DRAWINGS">FIG. 1</figref>, respective storage apparatuses <b>1300</b> at the primary site <b>1700</b> and the remote site <b>1800</b> have respective copy pair configuration definition tables <b>1146</b>.</p>
<p id="p-0077" num="0076">The copy pair configuration definition table <b>1146</b> includes respective identifiers of a primary site copy source volume <b>6850</b> and of a remote site copy destination volume <b>6900</b>. The primary site copy source volume <b>6850</b> stores therein an identifier of a copy source volume. The remote site copy destination volume <b>6900</b> stores therein an identifier of a volume to make a copy pair with the volume shown at the primary site copy source volume <b>6850</b>. The copy pair configuration definition creation unit <b>1129</b> (see <figref idref="DRAWINGS">FIG. 2</figref>) determines a copy source volume and a copy destination volume according to an operation performed by a user and creates the copy pair configuration definition table <b>1146</b>. The present invention can be carried out in another configuration in which only the management computer <b>1100</b> includes the copy pair configuration definition table <b>1146</b>; the management computer <b>1100</b> sends information only on a copy source volume to the primary site <b>1700</b> and sends information only on a copy destination volume to the remote site <b>1800</b>; and communication between the primary site <b>1700</b> and the remote site <b>1800</b> allows an operation of creating a copy pair to be conducted.</p>
<p id="p-0078" num="0077">Reference numerals <b>6802</b> to <b>6808</b> each indicate configuration definition information on a copy pair in the storage system shown in <figref idref="DRAWINGS">FIG. 1</figref>. The reference numeral <b>6802</b> indicates that a volume referred to as VOL<b>1</b> and a volume referred to as VOL<b>10</b> make a copy pair. The reference numeral <b>6804</b> indicates that a volume referred to as VOL<b>2</b> and volumes referred to as VOL<b>11</b> and VOL<b>12</b> make a copy pair. The reference numeral <b>6806</b> indicates that volumes referred to as VOL<b>3</b> and VOL<b>4</b> and a volume referred to as VOL<b>13</b> make a copy pair. The reference numeral <b>6808</b> indicates that volumes referred to as VOL<b>5</b> and VOL<b>6</b> and volumes referred to as VOL<b>14</b> and VOL<b>15</b> make a copy pair.</p>
<p id="p-0079" num="0078"><figref idref="DRAWINGS">FIG. 9</figref> shows an example of a GUI according to the first embodiment. The copy pair create window <b>7000</b> is an example of a display to realize this embodiment. The copy pair create window <b>7000</b> includes a copy type select window <b>7200</b>, a copy source specify window <b>7300</b>, a copy destination specify window <b>7700</b>, and an OK button <b>7900</b>.</p>
<p id="p-0080" num="0079">The copy type select window <b>7200</b> is a window for selecting a copy type. A drop-down list <b>7240</b> displays available copy types. In this embodiment, the available copy types include, as an example, a synchronous copy and an asynchronous copy. Upon a user's selection of the copy type from the drop-down list <b>7240</b>, the copy type of a copy pair to be made is determined.</p>
<p id="p-0081" num="0080">The copy source specify window <b>7300</b> is a window for selecting an application as a copy source. The copy source specify window <b>7300</b> includes a copy source site specify window <b>7400</b> and a copy source application specify window <b>7500</b>.</p>
<p id="p-0082" num="0081">The copy source site specify window <b>7400</b> in the copy source specify window <b>7300</b> is a window for selecting a site as a copy source. A drop-down list <b>7420</b> displays sites at the site <b>5350</b> in the application configuration table <b>1142</b> shown in <figref idref="DRAWINGS">FIG. 6</figref>, as a candidate copy source. A select button <b>7430</b> is a button for determining a site selected from the drop-down list <b>7420</b> as a copy source site. A text box <b>7450</b> displays a name of the site selected from the drop-down list <b>7420</b> with the select button <b>7430</b>.</p>
<p id="p-0083" num="0082">A copy source application specify window <b>7500</b> in the copy source specify window <b>7300</b> is a window for specifying an application as a copy source. A drop-down list <b>7520</b> displays an application at the site displayed in the text box <b>7450</b>. Such an application is acquired from the application <b>5700</b> which is using a volume in the primary site volume configuration table <b>1144</b>A shown in <figref idref="DRAWINGS">FIG. 7A</figref>. An add button <b>7530</b> is a button for adding an application selected from the drop-down list <b>7520</b> as a copy source application. A text box <b>7550</b> displays a name of the application selected from the drop-down list <b>7520</b> with the add button <b>7530</b>.</p>
<p id="p-0084" num="0083">The copy destination specify window <b>7700</b> is a window for specifying a site as a copy destination. A drop-down list <b>7720</b> displays a name of a site as shown in the configuration of <figref idref="DRAWINGS">FIG. 1</figref>. The name of a site is acquired from the management program <b>1120</b> (see <figref idref="DRAWINGS">FIG. 2</figref>) in the management computer <b>1100</b>. A select button <b>7730</b> is a button for determining the site selected from the drop-down list <b>7720</b> as a copy destination site. A text box <b>7750</b> displays the site name selected from the drop-down list <b>7720</b> with the select button <b>7730</b>.</p>
<p id="p-0085" num="0084">The OK button <b>7900</b> is a button for determining creation of a copy pair configuration definition with the application shown in the text box <b>7550</b> as a copy source and the site shown in the text box <b>7750</b> as a copy destination.</p>
<p id="p-0086" num="0085">Below are described step-by-step operations for creating a copy pair configuration definition which are performed by a user using the GUI as shown in <figref idref="DRAWINGS">FIG. 9</figref>. First, the user specifies a site as a copy source and selects one or more applications constituting the task as a copy source. More specifically, the user selects the site as a copy source from the drop-down list <b>7420</b> and clicks the select button <b>7430</b>, to thereby determine the copy source site. The determined copy source site is displayed in the text box <b>7450</b>.</p>
<p id="p-0087" num="0086">Next, an application as a copy source is determined. The user selects an application as a copy source from the drop-down list <b>7520</b> in which an application at a site displayed in the text box <b>7450</b> is displayed and clicks the add button <b>7530</b>, to thereby select the copy source application. The determined copy source application is displayed in the text box <b>7550</b>. If the user wants to add another copy source application, the user once again selects a desired application from the drop-down list <b>7520</b> and clicks the add button <b>7530</b>, to thereby add another copy source application.</p>
<p id="p-0088" num="0087">Next, a site as a copy destination is specified. The user selects a site as a copy destination from the drop-down list <b>7720</b> and clicks the select button <b>7730</b>, to thereby determine the copy destination site. The determined copy destination site is displayed in the text box <b>7750</b>.</p>
<p id="p-0089" num="0088">Finally, the user clicks the OK button <b>7900</b>. This operation creates a copy pair configuration definition in which the application shown in the text box <b>7550</b> is the copy source application, and the site shown in the text box <b>7750</b> is the copy destination site.</p>
<p id="p-0090" num="0089"><figref idref="DRAWINGS">FIG. 10</figref> shows a flowchart of copy pair configuration definition creation according to the first embodiment. The processing of copy pair configuration definition creation in the management program <b>1120</b> in the management computer <b>1100</b> is performed by the application configuration information acquisition unit <b>1122</b>, application configuration table creation unit <b>1124</b>, unused volume information acquisition unit <b>1125</b>, site volume configuration table creation unit <b>1126</b>, GUI display unit <b>1127</b>, and copy pair configuration definition creation unit <b>1129</b>.</p>
<p id="p-0091" num="0090">The processing starts at step S<b>6500</b>. In step S<b>6510</b>, the application configuration information acquisition unit <b>1122</b> acquires configuration information on an application at each site. More specifically, the application configuration information acquisition unit <b>1122</b> requests the application configuration information acquisition unit <b>1217</b> in the host computer <b>1200</b> to acquire the application configuration table <b>1280</b> in which information on an application in the host computer <b>1200</b> is managed.</p>
<p id="p-0092" num="0091">In step S<b>6520</b>, the application configuration table creation unit <b>1124</b> creates the application configuration table <b>1142</b> in which the received application configuration table <b>1280</b> is arranged with information on a site to which an application of interest belongs and information on a host in which the application is in operation.</p>
<p id="p-0093" num="0092">In step S<b>6525</b>, the unused volume information acquisition unit <b>1125</b> requests the storage microprogram <b>1330</b> in the storage apparatus <b>1300</b> to acquire a name of a site connected to the management computer <b>1100</b> and a usage condition of a volume at the site. That is, the unused volume information acquisition unit <b>1125</b> acquires information on an unused volume at the site.</p>
<p id="p-0094" num="0093">In step S<b>6530</b>, the site volume configuration table creation unit <b>1126</b> creates the site volume configuration table <b>1144</b> using the application configuration table <b>1142</b> created in step S<b>6520</b> and the usage condition in the storage system received in step S<b>6525</b>.</p>
<p id="p-0095" num="0094">In step S<b>6535</b>, the copy pair configuration definition creation unit <b>1129</b> determines the copy type specified by the user and acquired via the GUI display unit <b>1127</b>. In step S<b>6540</b>, the GUI display unit <b>1127</b> displays a list of the sites included in the configuration shown in <figref idref="DRAWINGS">FIG. 1</figref> to the user. The copy pair configuration definition creation unit <b>1129</b> determines a site specified by the user as a copy source site.</p>
<p id="p-0096" num="0095">In step S<b>6550</b>, the GUI display unit <b>1127</b> displays, to the user, an application at the site determined by the copy pair configuration definition creation unit <b>1129</b> in step S<b>6540</b>. The copy pair configuration definition creation unit <b>1129</b> determines an application specified by the user from among applications at the site as a copy source application. Generally, the replication as described above is performed by a task as a unit, and the task is typically configured by a plurality of applications. Thus, a plurality of applications can be specified as a copy source herein.</p>
<p id="p-0097" num="0096">In step S<b>6560</b>, the copy pair configuration definition creation unit <b>1129</b> references the site volume configuration table <b>1144</b> created in step S<b>6530</b>. In step S<b>6570</b>, the copy pair configuration definition creation unit <b>1129</b> selects a volume used by the application determined in step S<b>6550</b> without duplication. In step S<b>6580</b>, the copy pair configuration definition creation unit <b>1129</b> determines the volume selected in step S<b>6570</b> as a copy source volume. More specifically, if a group constituted by a plurality of applications (for example, AP<b>1</b>,AP<b>2</b>,AP<b>3</b>) to be copied is specified from the copy pair create window <b>7000</b> displayed by the GUI display unit <b>1127</b>, the copy pair configuration definition creation unit <b>1129</b> selects, without duplication, volumes (for example, VOL<b>1</b>,VOL<b>2</b>,VOL<b>3</b>) used by the specified group based on the volume configuration information and determines the volumes as copy source volumes. Note that VOL<b>2</b> is used in both AP<b>2</b> and AP<b>3</b>, however, is selected only once without duplication.</p>
<p id="p-0098" num="0097">In step S<b>6590</b>, the GUI display unit <b>1127</b> displays the sites included in the configuration shown in <figref idref="DRAWINGS">FIG. 1</figref> to the user. The copy pair configuration definition creation unit <b>1129</b> determines a site specified by the user from the displayed sites as a copy destination.</p>
<p id="p-0099" num="0098">In step S<b>6600</b>, the copy pair configuration definition creation unit <b>1129</b> references the volume configuration table <b>1144</b> created in step S<b>6530</b>. In step S<b>6610</b>, the copy pair configuration definition creation unit <b>1129</b> determines whether or not there is a volume having a capacity equal to or more than a capacity of the copy source volume determined in step S<b>6580</b>, at the site determined in step S<b>6590</b>.</p>
<p id="p-0100" num="0099">In step S<b>6620</b>, if there is a volume having a capacity equal to or more than a capacity of the copy source volume determined in step S<b>6580</b>, at the site determined in step S<b>6590</b> (Yes in step S<b>6610</b>), the copy pair configuration definition creation unit <b>1129</b> determines the volume as a copy destination volume.</p>
<p id="p-0101" num="0100">In step S<b>6590</b>, if there is not a volume having a capacity equal to or more than a capacity of the copy source volume determined in step S<b>6580</b>, at the site determined in step S<b>6590</b> (No in step S<b>6610</b>), the GUI display unit <b>1127</b> again displays the sites included in the configuration of <figref idref="DRAWINGS">FIG. 1</figref> to the user. The copy pair configuration definition creation unit <b>1129</b> determines a site specified by the user from among the displayed sites as a copy destination. If an unused volume is not determined at all copy destination sites, the GUI display unit <b>1127</b> may make the display unit <b>1170</b> display a message warning that a sufficient capacity of an unused volume in the copy destination is not found.</p>
<p id="p-0102" num="0101">In step S<b>6630</b>, the copy pair configuration definition creation unit <b>1129</b> creates a copy pair configuration definition in which the volume determined in step S<b>6580</b> is the copy source, and the volume determined in step S<b>6620</b> is the copy destination. In step S<b>6640</b>, the processing of copy pair configuration definition creation terminates.</p>
<p id="h-0007" num="0000">Second Embodiment</p>
<p id="p-0103" num="0102">The first embodiment has described that a copy pair is created from among a plurality of applications constituting a task, by the task as a unit. A second embodiment describes that a copy pair is created among a plurality of applications in a cluster configuration.</p>
<p id="p-0104" num="0103">The cluster configuration shown in the second embodiment realizes a high-level availability in which, if a host computer in which an application is performing a processing has a trouble, another application same as the former on standby in another host computer can take over the processing. In such a configuration, the same applications exist in different host computers. Such applications share a same volume. Note that, in some cases, the cluster configuration has a purpose of load balancing in which a same application operates in each of different host computers so as to distribute a processing across the different host computers. However, the purpose of the cluster configuration is not herein considered in particular.</p>
<p id="p-0105" num="0104">The second embodiment assumes that, for example, if a plurality of applications have a cluster configuration in two different host computers, the applications in the cluster configuration use a same volume. If such applications are specified as a copy source, a volume as a copy source can be selected without duplication.</p>
<p id="p-0106" num="0105">The second embodiment as a variation of the first embodiment describes that, even if applications as a copy source have a cluster configuration, a copy pair configuration definition can be created without duplication. A configuration of a storage system in the second embodiment is shown in <figref idref="DRAWINGS">FIG. 1</figref> to <figref idref="DRAWINGS">FIG. 4</figref>, which is the same as the configuration in the first embodiment.</p>
<p id="p-0107" num="0106"><figref idref="DRAWINGS">FIG. 11</figref> shows an example of an application configuration table <b>1142</b>A stored in the management computer <b>1100</b> according to the second embodiment. The application configuration table <b>1142</b>A of <figref idref="DRAWINGS">FIG. 11</figref> shows a case where an application having a cluster configuration is present in the storage system. Below is described the application configuration table <b>1142</b>A, focusing on a difference from the application configuration table <b>1142</b> shown in <figref idref="DRAWINGS">FIG. 6</figref> in the first embodiment. The application configuration table <b>1142</b>A includes respective identifiers of the application <b>5300</b>, site <b>5350</b>, host <b>5400</b>, and volume <b>5450</b> used by the application. A configuration of the application configuration table <b>1142</b>A is same as that of application configuration table <b>1142</b> in the management computer <b>1100</b> in the first embodiment. However, in the second embodiment, the application <b>5300</b> of the application configuration table <b>1142</b>A has the identifiers of the applications having a cluster configuration. The applications in the cluster configuration use a same volume.</p>
<p id="p-0108" num="0107">Reference numerals <b>5211</b> to <b>5231</b> indicate information on applications present in the host computer <b>1200</b> at the primary site <b>1700</b> and the remote site <b>1800</b>, if the storage system having the configuration shown in <figref idref="DRAWINGS">FIG. 1</figref> has applications in a cluster configuration. The reference numeral <b>5211</b> indicates that an application AP<b>1</b> belongs to a site referred to as Site A, runs in a host computer Host A, and uses only a volume VOL<b>1</b>. The reference numeral <b>5221</b> indicates that an application AP<b>2</b> belongs to the site Site A, runs in the host computer Host A, and uses only a volume VOL<b>2</b>.</p>
<p id="p-0109" num="0108">The reference numeral <b>5231</b> indicates that the application AP<b>2</b> belongs to Site A, runs in Host A, and uses only VOL<b>2</b>. That is, AP<b>2</b> has a cluster configuration in the two different host computers, Host A and Host B.</p>
<p id="p-0110" num="0109"><figref idref="DRAWINGS">FIG. 12</figref> shows an example of a cluster configuration table <b>8300</b> according to the second embodiment. The cluster configuration table <b>8300</b> is a table constituting the application configuration table <b>1280</b> in the host computer <b>1200</b>. The cluster configuration table <b>8300</b> includes respective identifiers of an application <b>8350</b>, Active <b>8400</b>, and Stand-by <b>8500</b>. The application <b>8350</b> stores therein an identifier of an application having the cluster configuration. The Active <b>8400</b> stores therein an identifier of a host computer in operation among the host computers in which the application shown at the application <b>8350</b> is present. The Stand-by <b>8500</b> stores therein an identifier of a host computer on standby among the host computers in which the application shown at the application <b>8350</b> is present. In this embodiment, it is assumed that the application configuration information acquisition unit <b>1217</b> in the agent program <b>1216</b> acquires information on a cluster configuration from an application in a host computer to which the application configuration information acquisition unit <b>1217</b> belongs.</p>
<p id="p-0111" num="0110">Reference numerals <b>8310</b> to <b>8320</b> indicate information on the applications having a cluster configuration in the host computer <b>1200</b> in the storage system shown in <figref idref="DRAWINGS">FIG. 1</figref>. The reference numeral <b>8310</b> indicates that the application AP<b>2</b> has a cluster configuration, the application shown at the Active <b>8400</b> is in the host computer referred to as Host A, and the application shown at the Stand-by <b>8500</b> is in the host computer Host B. The reference numeral <b>8320</b> indicates that an application AP<b>3</b> has a cluster configuration, the application shown at the Active <b>8400</b> is in a host computer Host C, and the application shown at the Stand-by <b>8500</b> is in a host computer Host D.</p>
<p id="p-0112" num="0111">Next is described a processing of a copy pair configuration definition according to the second embodiment, with reference to <figref idref="DRAWINGS">FIG. 10</figref>. Herein is described only a difference from the processing of a copy pair configuration definition according to the first embodiment. In step S<b>6510</b>, the application configuration information acquisition unit <b>1122</b> in the management computer <b>1100</b> requests the application configuration information acquisition unit <b>1217</b> in the host computer <b>1200</b> to acquire the application configuration table <b>1280</b> and the cluster configuration table <b>8300</b>.</p>
<p id="p-0113" num="0112">In step S<b>6550</b>, the copy pair configuration definition creation unit <b>1129</b> references the cluster configuration table <b>8300</b> acquired from the host computer <b>1200</b>. The GUI display unit <b>1127</b> displays only an application at the Active <b>8400</b> among applications in a cluster configuration. Typically, a user knows which applications have a cluster configuration. Further, the applications in the cluster configuration use a same volume. Thus, the user has to do is only to specify an application currently in operation as a copy source.</p>
<p id="p-0114" num="0113">In this embodiment, if the user specifies an application having the cluster configuration as a copy source, the user can determine a volume as the copy source without particularly identifying the cluster configuration of the applications. For convenience of description, the application at the Active <b>8400</b> is displayed herein. However, any one of the applications in the cluster configuration may be displayed. Therefore, the application displayed to the user may be any at the Active <b>8400</b> or the Stand-by <b>8500</b> in the present invention. In this embodiment, the cluster configuration table <b>8300</b> is separately provided from the application configuration table <b>1142</b>A constituting the management table <b>1140</b>. However, a table in which the cluster configuration table <b>8300</b> is combined with the application configuration table <b>1142</b>A may be provided.</p>
<p id="p-0115" num="0114">With the processing described above, even if a copy source application has a cluster configuration, the copy pair configuration definition can be created without duplication or incompatibility.</p>
<p id="h-0008" num="0000">Third Embodiment</p>
<p id="p-0116" num="0115">The present invention can be applied even if an application is constituted by a plurality of sub-applications. Herein, the application constituted by a plurality of sub-applications is referred to as a composite application. In other words, the composite application is a group constituted by a plurality of sub-applications. In a third embodiment, the composite application may include an application for integrating and managing a plurality of sub-applications such as an ERP (enterprise resource planning) package. In the present invention, if a composite application is specified as a copy source, a volume as the copy source can be selected without duplication. Below is described this embodiment focusing on a difference from the first embodiment. The configuration of a storage system in the third embodiment is shown in <figref idref="DRAWINGS">FIG. 1</figref> to <figref idref="DRAWINGS">FIG. 4</figref>, which is the same as the configuration described in the first embodiment.</p>
<p id="p-0117" num="0116"><figref idref="DRAWINGS">FIG. 13</figref> shows an example of a composite application configuration table <b>8600</b> according to the third embodiment. The composite application configuration table <b>8600</b> is a table constituting the application configuration table <b>1280</b> in the host computer <b>1200</b> in this embodiment. The composite application configuration table <b>8600</b> shows a configuration of a composite application and includes respective identifiers of a composite application <b>8700</b> and of a configuration application <b>8800</b>. The composite application <b>8700</b> stores therein an identifier of a composite application which is present in its own host computer <b>1200</b>. The configuration application <b>8800</b> stores therein an identifier of an application constituting the application shown of the composite application <b>8700</b>. In the present embodiment, the application configuration information acquisition unit <b>1217</b> is assumed to acquire information on a configuration of a composite application from an application in its own host computer <b>1200</b>.</p>
<p id="p-0118" num="0117">Reference numerals <b>8610</b> and <b>8620</b> indicate information on a composite application in the host computer <b>1200</b> in the storage system shown in <figref idref="DRAWINGS">FIG. 1</figref>. The reference numeral <b>8610</b> indicates that an application ERP<b>1</b> is configured by sub-applications AP<b>1</b>, AP<b>3</b> and AP<b>5</b>. That is, the application ERP<b>1</b> uses volumes used by the sub-applications AP<b>1</b>, AP<b>3</b> and AP<b>5</b>. The reference numeral <b>8620</b> indicates that an application ERP<b>2</b> is configured by sub-applications AP<b>2</b> and AP<b>4</b>. That is, the application ERP<b>2</b> uses volumes used by the sub-applications AP<b>2</b> and AP<b>4</b>.</p>
<p id="p-0119" num="0118"><figref idref="DRAWINGS">FIG. 14</figref> shows an example of a GUI according to the third embodiment. Next is described a difference between a copy pair create window <b>9000</b> of <figref idref="DRAWINGS">FIG. 14</figref> in this embodiment and the copy pair create window <b>7000</b> of <figref idref="DRAWINGS">FIG. 9</figref> in the first embodiment. The copy pair create window <b>9000</b> includes the copy type select window <b>7200</b>, a copy source specify window <b>9300</b>, the copy destination specify window <b>7700</b>, and the OK button <b>7900</b>. The copy type select window <b>7200</b> and the copy destination specify window <b>7700</b> are configured same as those of the copy pair create window <b>7000</b> shown in <figref idref="DRAWINGS">FIG. 9</figref>. Thus, only the copy source specify window <b>9300</b> is described in detail below.</p>
<p id="p-0120" num="0119">The copy source specify window <b>9300</b> is a window for selecting an application as a copy source. The copy source specify window <b>9300</b> includes the copy source site specify window <b>7400</b>, a copy source composite application specify window <b>9500</b>, and a copy source general application specify window <b>9600</b>. The copy source site specify window <b>7400</b> is configured same as that of the copy pair create window <b>7000</b> of <figref idref="DRAWINGS">FIG. 9</figref>. Thus, the copy source composite application specify window <b>9500</b> and copy source general application specify window <b>9600</b> are described below.</p>
<p id="p-0121" num="0120">The copy source composite application specify window <b>9500</b> in the copy source specify window <b>9300</b> is a window for specifying a composite application as a copy source. A drop-down list <b>9520</b> displays a composite application included in a site displayed in the text box <b>7450</b>. Note that the drop-down list <b>9520</b> also displays a sub-application constituting the composite application. However, such a sub-application (for example, AP<b>1</b>, AP<b>3</b> and AP<b>2</b>) may preferably not be selected directly from the text box <b>7450</b>. An add button <b>9530</b> is a button for adding the composite application selected from the drop-down list <b>9520</b> as a copy source composite application. A text box <b>9550</b> displays the name of the composite application selected from the drop-down list <b>9520</b> with the add button <b>9530</b>.</p>
<p id="p-0122" num="0121">The copy source general application specify window <b>9600</b> in the copy source specify window <b>9300</b> is a window for specifying a general application, that is, a non-composite application, as a copy source. A drop-down list <b>9620</b> indicates a general application at a site displayed in the text box <b>7450</b>. Note that the drop-down list <b>9620</b> does not display a composite application displayed in the drop-down list <b>9520</b>. An add button <b>9630</b> is a button for adding the general application selected from the drop-down list <b>9620</b> as a copy source general application. A text box <b>9650</b> displays the name of the general application selected from the drop-down list <b>9620</b> with the add button <b>9630</b>.</p>
<p id="p-0123" num="0122">The OK button <b>7900</b> is a button for determining creation of a copy pair configuration definition. If the user clicks the OK button <b>7900</b>, the management program <b>1120</b> creates the copy pair configuration definition in which an application shown in the text box <b>9550</b> and the text box <b>9650</b> is the copy source and a site shown in the text box <b>7750</b> is the copy destination.</p>
<p id="p-0124" num="0123">Below are described step-by-step operations for creating a copy pair configuration definition which are performed by a user using the GUI of <figref idref="DRAWINGS">FIG. 14</figref>, while focusing on a difference from the operations using the GUI of <figref idref="DRAWINGS">FIG. 9</figref>. First, a task as a copy source is determined. The user specifies a site as a copy source and then selects one or more applications constituting the task as the copy source. The operations of selecting the copy source site are the same as those shown in <figref idref="DRAWINGS">FIG. 10</figref>.</p>
<p id="p-0125" num="0124">Next is determined a composite application as the copy source. The user selects a composite application as the copy source from the drop-down list <b>9520</b> in which composite applications at a site displayed in the text box <b>7450</b> are displayed and clicks the add button <b>9530</b>, to thereby select the copy source composite application. The application determined as the copy source composite application is then displayed in the text box <b>9550</b>. If the user wants to add another composite application as the copy source, the user once again selects a desired composite application from the drop-down list <b>9520</b> and clicks the add button <b>9530</b>, to thereby add another application as a copy source.</p>
<p id="p-0126" num="0125">Next is specified a site as a copy destination. The user selects a copy destination site from the drop-down list <b>7720</b> and clicks the select button <b>7730</b>, to thereby determine the copy destination site. The determined copy destination site is displayed in the text box <b>7750</b>. Next is determined a general application as a copy source. The user selects a general application as a copy source from the drop-down list <b>9620</b> in which general applications at a site displayed in the text box are displayed and clicks the add button <b>9630</b>, to thereby determine the copy source general application. The determined copy source general application is displayed in the text box <b>9650</b>. If the user wants to add another general application as the copy source, the user once again selects a desired general application from the drop-down list <b>9620</b> and clicks the add button <b>9630</b>, to thereby add another copy source general application.</p>
<p id="p-0127" num="0126">Then the copy destination site is specified with the same operations as those of <figref idref="DRAWINGS">FIG. 9</figref>. Finally, the user clicks the OK button <b>7900</b>. This operation creates the copy pair configuration definition in which the application shown in the text box <b>9550</b> and the text box <b>9650</b> is the copy source and the site shown in the text box <b>7750</b> is the copy destination. In this embodiment, the composite application configuration table <b>8600</b> is separately provided from the application configuration table <b>1142</b> constituting the management table <b>1140</b>. However, a table in which the composite application configuration table <b>8600</b> is combined with the application configuration table <b>1142</b> may be provided.</p>
<p id="p-0128" num="0127">Next is described a flow of the processing in this embodiment with reference to <figref idref="DRAWINGS">FIG. 10</figref>. Herein is described only a difference from the processing shown in <figref idref="DRAWINGS">FIG. 10</figref> in the first embodiment. In step S<b>6510</b>, the application configuration information acquisition unit <b>1122</b> in the management computer <b>1100</b> requests the application configuration information acquisition unit <b>1217</b> in the host computer <b>1200</b> according to the configuration shown in <figref idref="DRAWINGS">FIG. 1</figref> to acquire the application configuration table <b>1280</b> and the composite application configuration table <b>8600</b>.</p>
<p id="p-0129" num="0128">In step S<b>6550</b>, the copy pair configuration definition creation unit <b>1129</b> references the composite application configuration table <b>8600</b> acquired from the host computer <b>1200</b>. The GUI display unit <b>1127</b> displays a composite application (for example, see the drop-down list <b>9520</b> in <figref idref="DRAWINGS">FIG. 14</figref>) to the user. This operation can prevent the user from selecting a composite application as a copy source and copying a same volume in duplicate. Note that a general non-composite application is displayed to the user as in the first embodiment (for example, see the drop-down list <b>9620</b> in <figref idref="DRAWINGS">FIG. 14</figref>).</p>
<p id="p-0130" num="0129">In this embodiment, even if the user specifies a composite application as a copy source, the user can determine a volume as a copy source without particularly specifying that the composite application is constituted by a plurality of sub-applications. For convenience of description, the plurality of sub-applications constituting the composite application are displayed but would not be selected. However, what is only necessary herein is to select a volume of a composite application without duplication, using information on the composite application. Therefore, any form of a display of the composite application to the user is available.</p>
<p id="p-0131" num="0130">The processing described above allows to create the copy pair configuration definition without duplication or incompatibility even if an application as a copy source is a composite application.</p>
<p id="h-0009" num="0000">Fourth Embodiment</p>
<p id="p-0132" num="0131">A fourth embodiment describes that the present invention can be applied in a server virtualization environment. A technique of server virtualization can realize one more virtual servers (or VMs: virtual machines) on one or more physical servers. The technique of server virtualization has been widely spread in recent years.</p>
<p id="p-0133" num="0132">One of the characteristics of the technique of server virtualization is that a server virtualization program manages OS image, configuration information of a VM and its associated data. In some cases, all the data described above is managed as a single file. The configuration information includes information necessary for the VM to operate, such as, for example, the number of processors in a physical server, a memory size, and an operation rate of I/O processing capacity. Such characteristics of the technique of server virtualization allow a resource of a physical server to be used effectively, leading to an advantageous effect on reduction of cost in hardware and its management.</p>
<p id="p-0134" num="0133">The server virtualization environment in this embodiment means an environment in which a server virtualization program is operated in a host computer, and a plurality of VMs can be operated on the program. In this embodiment, one application operates in one VM. However, any number of applications may operate in the present invention.</p>
<p id="p-0135" num="0134">A configuration of a storage system according to this embodiment is shown in <figref idref="DRAWINGS">FIG. 1</figref> (general configuration), <figref idref="DRAWINGS">FIG. 4</figref> (storage apparatus <b>1300</b>), <figref idref="DRAWINGS">FIG. 15</figref> (management computer <b>1100</b>), <figref idref="DRAWINGS">FIG. 16</figref> (host computer <b>1200</b>), and <figref idref="DRAWINGS">FIG. 17</figref> (the volume <b>1311</b> in the storage apparatus <b>1300</b>). The configurations shown in <figref idref="DRAWINGS">FIG. 1</figref> and <figref idref="DRAWINGS">FIG. 4</figref> in this embodiment are the same as those in the first embodiment. Next is described the storage system according to this embodiment, focusing on a difference from that according to the first embodiment.</p>
<p id="p-0136" num="0135"><figref idref="DRAWINGS">FIG. 15</figref> shows the configuration of the management computer <b>1100</b> in the fourth embodiment. The management computer <b>1100</b> in <figref idref="DRAWINGS">FIG. 15</figref> has a same physical configuration as that of the management computer <b>1100</b> in <figref idref="DRAWINGS">FIG. 2</figref>. However, a processings performed by the management program <b>1120</b>, and the management table <b>1140</b> in the memory <b>1270</b> according to this embodiment are different from those according to the first embodiment.</p>
<p id="p-0137" num="0136">The management program <b>1120</b> includes a VM configuration information acquisition unit <b>9910</b>, a VM configuration table creation unit <b>9912</b>, the unused volume information acquisition unit <b>1125</b>, a site volume configuration table creation unit <b>9915</b>, the GUI display unit <b>1127</b>, and the copy pair configuration definition creation unit <b>1129</b>. The unused volume information acquisition unit <b>1125</b>, GUI display unit <b>1127</b>, and copy pair configuration definition creation unit <b>1129</b> have same configurations as those in the first embodiment. The VM configuration information acquisition unit <b>9910</b> acquires information on a volume used by a VM in the host computer <b>1200</b> at each site. The VM configuration table creation unit <b>9912</b> creates a VM configuration table <b>9920</b> (see <figref idref="DRAWINGS">FIG. 19</figref>) in which the information acquired by the VM configuration information acquisition unit <b>9910</b> is arranged. The site volume configuration table creation unit <b>9915</b> creates a site volume configuration table <b>9924</b> (see <figref idref="DRAWINGS">FIG. 20A</figref> and <figref idref="DRAWINGS">FIG. 20B</figref>) based on the VM configuration table <b>9920</b> created by the VM configuration table creation unit <b>9912</b> and the information acquired by the unused volume information acquisition unit <b>1125</b>.</p>
<p id="p-0138" num="0137"><figref idref="DRAWINGS">FIG. 16</figref> shows a configuration of the host computer <b>1200</b> in the fourth embodiment. The host computer <b>1200</b> in <figref idref="DRAWINGS">FIG. 16</figref> has a same physical configuration as that of the management computer <b>1200</b> in <figref idref="DRAWINGS">FIG. 3</figref>. However, data in the local disk <b>1210</b> and a table in the memory <b>1270</b> in this embodiment are different from those in the first embodiment.</p>
<p id="p-0139" num="0138">The local disk <b>1210</b> is a disk unit connected to the host computer <b>1200</b>, such as a hard disk drive and stores therein a server virtualization program <b>9940</b>. The server virtualization program <b>9940</b> is loaded into the memory <b>1270</b> of the host computer <b>1200</b> and is executed by the CPU <b>1220</b>. The server virtualization program <b>9940</b> is a program for acquiring information on an application operating on the host computer <b>1200</b> and a VM, based on instructions from the VM configuration information acquisition unit <b>9910</b> in the management computer <b>1100</b>. The host computer <b>1200</b> executes the server virtualization program <b>9940</b>, to thereby make a VM and an application stored in the storage apparatus <b>1300</b> connected to the host computer <b>1200</b> execute. The VM configuration table <b>9950</b> in the memory <b>1270</b> will be described later.</p>
<p id="p-0140" num="0139"><figref idref="DRAWINGS">FIG. 17</figref> shows a configuration of the volume <b>1311</b> in the storage apparatus <b>1300</b> according to the fourth embodiment. The volume <b>1311</b> in <figref idref="DRAWINGS">FIG. 17</figref> corresponds to the volume <b>1311</b> in <figref idref="DRAWINGS">FIG. 4</figref> in the disk unit <b>1310</b> of the storage apparatus <b>1300</b>. The volume <b>1311</b> in <figref idref="DRAWINGS">FIG. 17</figref> includes an application <b>9960</b>, VM information <b>9965</b>, and a data <b>9970</b>. The VM information <b>9965</b> includes an OS image and configuration information. The data <b>9970</b> is used by the application <b>9960</b> or the like. For convenience of description, <figref idref="DRAWINGS">FIG. 17</figref> shows that the single volume <b>1311</b> has one unit of the application <b>9960</b>, VM information <b>9965</b>, and a data <b>9970</b>. However, a volume used by a VM may be a plurality of volumes. Or, an application, a VM, and a data may be stored in a plurality of volumes distributedly.</p>
<p id="p-0141" num="0140">The application <b>9960</b> and the VM information <b>9965</b> are loaded into the memory <b>1270</b> in the host computer <b>1200</b> and are executed by the CPU <b>1220</b>. The application <b>9960</b> and the VM information <b>9965</b> are a program and information each for executing a processing by reading and writing the data <b>9970</b> in the volume <b>1311</b> in the storage apparatus <b>1300</b>.</p>
<p id="p-0142" num="0141"><figref idref="DRAWINGS">FIG. 18</figref> shows an example of the VM configuration table <b>9950</b> in the host computer <b>1200</b> in the fourth embodiment. The VM configuration table <b>9950</b> in the host computer <b>1200</b> at each site shown in <figref idref="DRAWINGS">FIG. 18</figref> includes respective identifiers of a VM <b>9980</b> and a volume <b>9985</b> used by the VM. The VM <b>9980</b> stores therein an identifier of a VM which is operating in its host computer <b>1200</b> and is using a volume in the storage apparatus <b>1300</b>. The volume <b>9985</b> used by the VM stores therein an identifier of a volume used by the VM shown in the VM <b>9980</b>. In this embodiment, the server virtualization program <b>9940</b> can acquire information on the VM which is operating in its host computer <b>1200</b>.</p>
<p id="p-0143" num="0142">Reference numerals <b>9976</b> to <b>9978</b> indicate information on a volume used by a VM which operates in the host computer <b>1200</b> at the primary site <b>1700</b> in the storage system shown in <figref idref="DRAWINGS">FIG. 1</figref>. The reference numeral <b>9976</b> indicates that a VM referred to as VM<b>1</b> uses only a volume referred to as VOL<b>1</b>. The reference numeral <b>9977</b> indicates that a VM referred to as VM<b>2</b> uses only a volume referred to as VOL<b>2</b>. The reference numeral <b>9978</b> indicates that a VM referred to as VM<b>3</b> uses two volumes referred to as VOL<b>2</b> and VOL<b>3</b>. That is, VM<b>2</b> and VM<b>3</b> share VOL<b>2</b>.</p>
<p id="p-0144" num="0143"><figref idref="DRAWINGS">FIG. 19</figref> shows an example of the VM configuration table <b>9920</b> in the management computer <b>1100</b> according to the fourth embodiment. The VM configuration table <b>9920</b> in the management computer <b>1100</b> includes respective identifiers of a VM <b>9995</b>, a site <b>10000</b>, a host <b>10005</b>, and a volume <b>10010</b> used by the VM. The VM <b>9995</b> stores an identifier of a VM. The site <b>10000</b> stores an identifier of a site to which the VM shown at the VM <b>9995</b> belongs. The host <b>10005</b> stores an identifier of a host in which the VM shown at the VM <b>9995</b> is operating. The volume used by the VM <b>10100</b> stores an identifier of a used volume of the VM shown at the VM <b>9995</b>. Information constituting the VM configuration table <b>9920</b> is acquired by the VM configuration information acquisition unit <b>9910</b> in the management computer <b>1100</b> from the host computer <b>1200</b> in the configuration as shown in <figref idref="DRAWINGS">FIG. 1</figref>. In this embodiment, it is assumed that there are two sites, the primary site <b>1700</b> and the remote site <b>1800</b>. The VM configuration information acquisition unit <b>9910</b> acquires the VM configuration table <b>9975</b> in the host computer <b>1200</b> at each site and creates the VM configuration table <b>9920</b> from the acquired VM configuration table <b>9975</b>.</p>
<p id="p-0145" num="0144">Reference numerals <b>9991</b> to <b>9993</b> indicate information on a VM in the host computer <b>1200</b> at the primary site <b>1700</b> and the remote site <b>1800</b> in the storage system having the configuration shown in <figref idref="DRAWINGS">FIG. 1</figref>. The reference numeral <b>9991</b> indicates that a VM referred to as the VM<b>1</b> belongs to a site referred to as Site A, operates in the host computer <b>1200</b> referred to as Host A, and uses only a volume referred to as VOL<b>1</b>. The reference numeral <b>9992</b> indicates that a VM referred to as VM<b>2</b> belongs to a site referred to as Site A, operates in the host computer <b>1200</b> referred to as Host A, and uses only a volume referred to as VOL<b>2</b>. The reference numeral <b>9993</b> indicates that a VM referred to as VM<b>3</b> belongs to a site referred to as Site A, operates in the host computer <b>1200</b> referred to as Host A, and uses two volumes referred to as VOL<b>2</b> and VOL<b>3</b>. That is, VM<b>2</b> and VM<b>3</b> share VOL<b>2</b>.</p>
<p id="p-0146" num="0145"><figref idref="DRAWINGS">FIG. 20A</figref> shows an example of the primary site volume configuration table <b>9924</b>A stored in the management computer <b>1100</b> according to the fourth embodiment. <figref idref="DRAWINGS">FIG. 20B</figref> shows an example of the remote site volume configuration table <b>9924</b>B stored in the management computer <b>1100</b>. The primary site volume configuration table <b>9924</b>A and the remote site volume configuration table <b>9924</b>B are tables constituting the volume configuration table <b>9924</b> at each site in this embodiment. In <figref idref="DRAWINGS">FIG. 20A</figref>, the primary site volume configuration table <b>9924</b>A includes respective identifiers of the primary site volume <b>5600</b> and of a VM <b>10200</b> which is using a volume. The primary site volume <b>5600</b> stores therein an identifier of a volume present at the primary site <b>1700</b>. The VM <b>10200</b> which is using a volume stores therein an identifier of a VM using a volume shown at the primary site volume <b>5600</b>. The site volume configuration table creation unit <b>9915</b> acquires information on a volume used by the VM from the VM configuration table <b>9920</b> and also acquires information on a volume not used by the VM from the unused volume information acquisition unit <b>1125</b>. This enables the management computer <b>1100</b> to acquire information on all the volumes at the primary site <b>1700</b>.</p>
<p id="p-0147" num="0146">Reference numerals <b>10210</b> to <b>10240</b> each indicate information on a volume present in the storage apparatus <b>1300</b> at the primary site <b>1700</b> in the storage system having the configuration shown in <figref idref="DRAWINGS">FIG. 1</figref>. The reference numeral <b>10210</b> indicates that a volume referred to as VOL<b>1</b> is used by a VM referred to as VM<b>1</b>. The reference numeral <b>10220</b> indicates that a volume referred to as VOL<b>2</b> is used by two VMs referred to as VM<b>2</b> and VM<b>3</b>. That is, VM<b>2</b> and VM<b>3</b> share VOL<b>2</b>. The reference numeral <b>10230</b> indicates that a volume referred to as VOL<b>3</b> is used by a VM referred to as VM<b>3</b>. The reference numeral <b>10240</b> indicates that a volume referred to as VOL<b>4</b> is an unused volume.</p>
<p id="p-0148" num="0147">In <figref idref="DRAWINGS">FIG. 20B</figref>, the remote site volume configuration table <b>9924</b>B includes respective identifiers of a remote site volume <b>6100</b> and a volume using VM <b>10700</b>. The remote site volume <b>6100</b> stores therein a volume present at the remote site <b>1800</b>. The volume using VM <b>10700</b> stores therein a VM using a volume shown at the remote site volume <b>6100</b>. Similarly to the primary site volume configuration table <b>9924</b>A of <figref idref="DRAWINGS">FIG. 20A</figref>, the site volume configuration table creation unit <b>9915</b> acquires information on a volume used by the VM from the VM configuration table <b>9920</b> and also acquires information on a volume used by the VM from the unused volume information acquisition unit <b>1125</b>. In this embodiment, it is assumed that the remote site <b>1800</b> is a site to be used as a copy destination. Thus, any volume at the remote site <b>1800</b> is unused. In the present invention, however, any site having a necessary and sufficient unused volume may be set as a copy destination, whether or not a VM is running at the site of interest.</p>
<p id="p-0149" num="0148">Reference numerals <b>10510</b> to <b>10540</b> each indicate information on a volume present in the storage apparatus <b>1300</b> at the remote site <b>1800</b> in the storage system having the configuration shown in <figref idref="DRAWINGS">FIG. 1</figref>. Reference numerals <b>10510</b>, <b>10520</b>, <b>10530</b> and <b>10540</b> indicate that the volumes VOL<b>1</b>, VOL<b>2</b>, VOL<b>3</b> and VOL<b>4</b> are unused, respectively.</p>
<p id="p-0150" num="0149"><figref idref="DRAWINGS">FIG. 21</figref> shows an example of the GUI according to the fourth embodiment. Herein is described only a difference between the copy pair create window <b>11000</b> in <figref idref="DRAWINGS">FIG. 21</figref> and the copy pair create window <b>7000</b> in <figref idref="DRAWINGS">FIG. 9</figref>. The copy pair create window <b>11000</b> includes the copy type select window <b>7200</b>, a copy source specify window <b>11300</b>, the copy destination specify window <b>7700</b>, and the OK button <b>7900</b>. The copy type select window <b>7200</b> and the copy destination specify window <b>7700</b> are configured same as those in the copy pair create window <b>7000</b> shown in <figref idref="DRAWINGS">FIG. 9</figref>. Thus, only the copy source specify window <b>11300</b> is described below in detail.</p>
<p id="p-0151" num="0150">The copy source specify window <b>11300</b> is a window for selecting a VM as a copy source. The copy source specify window <b>11300</b> includes the copy source site specify window <b>7400</b> and a copy source VM specify window <b>11500</b>. The copy source site specify window <b>7400</b> is configured same as the copy pair create window <b>7000</b> shown in <figref idref="DRAWINGS">FIG. 9</figref>. Thus only the copy source VM specify window <b>11500</b> is described below.</p>
<p id="p-0152" num="0151">The copy source VM specify window <b>11500</b> in the copy source specify window <b>11300</b> is a window for specifying a VM as a copy source. A drop-down list <b>11520</b> displays a VM at a site displayed in the text box <b>7450</b>. An add button <b>11530</b> is a button for adding the VM selected from the drop-down list <b>11520</b> as a copy source VM. A text box <b>11550</b> displays the name of the copy source VM selected from the drop-down list <b>11520</b> with the add button <b>11530</b>.</p>
<p id="p-0153" num="0152">Below are described step-by-step operations for creating a copy pair configuration definition in this embodiment, showing a difference from the operations according to the first embodiment shown in <figref idref="DRAWINGS">FIG. 9</figref>. First, a task of a copy source is determined. A user specifies a site as a copy source and selects a VM constituting the task as a copy source. The operations of selecting the copy source site are the same as those shown in <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0154" num="0153">Next is determined a VM as a copy source. The user selects a VM as a copy source from the drop-down list <b>11520</b> in which a VM at the site displayed in the text box <b>7450</b> is displayed and clicks the add button <b>11530</b>, to thereby determine the copy source VM. The determined copy source VM is displayed in the text box <b>11550</b>. If the user wants to add another copy source VM, the user once again selects a desired VM to be added from the drop-down list <b>11520</b> and clicks the add button <b>11530</b>, to thereby add another copy source VM.</p>
<p id="p-0155" num="0154">Next is specified a copy destination site. The user selects a site as a copy destination from the drop-down list <b>7720</b> and clicks the select button <b>7730</b>, to thereby determine the copy destination site. The determined copy destination site is displayed in the text box <b>7750</b>.</p>
<p id="p-0156" num="0155">Finally, the use clicks the OK button <b>7900</b>. This operation makes the management program <b>1120</b> create a copy pair configuration definition in which the VM displayed in the text box <b>11550</b> is the copy source, and the site displayed in the text box <b>7750</b> is the copy destination.</p>
<p id="p-0157" num="0156"><figref idref="DRAWINGS">FIG. 22</figref> is a flowchart showing a processing of copy pair configuration definition creation according to the fourth embodiment. The processing of copy pair configuration definition creation which is executed by the management program <b>1120</b> in the management computer <b>1100</b> shown in <figref idref="DRAWINGS">FIG. 22</figref> is similar to the processing shown in <figref idref="DRAWINGS">FIG. 10</figref>, if the term &#x201c;application&#x201d; in <figref idref="DRAWINGS">FIG. 10</figref> is substituted for the term &#x201c;VM&#x201d; in <figref idref="DRAWINGS">FIG. 22</figref>. Below is described the processing in detail.</p>
<p id="p-0158" num="0157">The processing starts at step S<b>11600</b>. In step S<b>11610</b>, the VM configuration information acquisition unit <b>9910</b> acquires VM configuration information at each site. More specifically, the VM configuration information acquisition unit <b>9910</b> requests the server virtualization program <b>9940</b> in the host computer <b>1200</b> included in the configuration shown in <figref idref="DRAWINGS">FIG. 1</figref> to acquire the VM configuration table <b>9950</b> in which information on a VM in the host computer <b>1200</b> is managed. In step S<b>11620</b>, the VM configuration table creation unit <b>9912</b> creates the VM configuration table <b>9920</b> in which information on a site to which the VM belongs and information on a host in operation is arranged, from the received VM configuration table <b>9950</b>.</p>
<p id="p-0159" num="0158">In step S<b>11630</b>, the unused volume information acquisition unit <b>1125</b> requests the storage microprogram <b>1330</b> in the storage apparatus <b>1300</b> to acquire a name of a site connected to the management computer <b>1100</b> and a usage condition of a volume at the site. In step S<b>11640</b>, the site volume configuration table creation unit <b>9915</b> creates the site volume configuration table <b>9924</b> in which a relation between the VM at the site and the volume is arranged, based on the VM configuration table <b>9920</b> created in step S<b>11620</b> and the usage condition of the storage received in step S<b>11630</b>. In step S<b>11650</b>, the copy pair configuration definition creation unit <b>1129</b> determines a copy type specified by the user and acquired via the GUI display unit <b>1127</b>.</p>
<p id="p-0160" num="0159">In step S<b>11660</b>, the GUI display unit <b>1127</b> displays a list of sites included in the configuration shown in <figref idref="DRAWINGS">FIG. 1</figref> to the user. The user specifies a site from the list. The copy pair configuration definition creation unit <b>1129</b> determines the site as a copy source site. In step S<b>11670</b>, the GUI display unit <b>1127</b> displays, to the user, VMs present at the site determined by the copy pair configuration definition creation unit <b>1129</b> in step S<b>11660</b>. The copy pair configuration definition creation unit <b>1129</b> determines a plurality of the VMs specified by the user as copy source VMs. Generally, replication as described above is performed by a task as a unit. A task is typically constituted by a plurality of applications, each of which runs in a VM on a one-to-one basis. Thus, a plurality of VMs can be specified herein as copy sources.</p>
<p id="p-0161" num="0160">In step S<b>11680</b>, the copy pair configuration definition creation unit <b>1129</b> references the volume configuration table <b>9924</b> at the site created in step S<b>11640</b>. In step S<b>11690</b>, the copy pair configuration definition creation unit <b>1129</b> selects a volume used by the VM determined in step S<b>11670</b> without duplication. In step S<b>11695</b>, the copy pair configuration definition creation unit <b>1129</b> determines the volume selected in step S<b>11690</b> as a copy source volume.</p>
<p id="p-0162" num="0161">In step S<b>11700</b>, the GUI display unit <b>1127</b> displays a site included in the configuration shown in <figref idref="DRAWINGS">FIG. 1</figref> to the user. The copy pair configuration definition creation unit <b>1129</b> determines the site specified by the user from among the sites acquired via the GUI display unit <b>1127</b>, as a copy destination site. In step S<b>11710</b>, the copy pair configuration definition creation unit <b>1129</b> references the volume configuration table <b>9924</b> at the site created in step S<b>11640</b>. In step S<b>11720</b>, the copy pair configuration definition creation unit <b>1129</b> determines whether or not there is a volume having a capacity equal to or more than a capacity of the copy source volume determined in step S<b>11695</b>, at the site determined in step S<b>11700</b>.</p>
<p id="p-0163" num="0162">In step S<b>11740</b>, if there is an unused volume having a capacity equal to or more than a capacity of the copy source volume determined in step S<b>11695</b>, at the site determined in step S<b>11700</b> (Yes in step S<b>11720</b>), the copy pair configuration definition creation unit <b>1129</b> determines the volume as the copy destination volume.</p>
<p id="p-0164" num="0163">In step S<b>11700</b>, if there is not an unused volume having a capacity equal to or more than a capacity of the copy source volume determined in step S<b>11695</b>, at the site determined in step S<b>11700</b> (No in step S<b>11720</b>), the GUI display unit <b>1127</b> again displays the site included in the configuration shown in <figref idref="DRAWINGS">FIG. 1</figref> to the user. The copy pair configuration definition creation unit <b>1129</b> determines the site specified by the user as the copy destination site.</p>
<p id="p-0165" num="0164">In step S<b>11750</b>, the copy pair configuration definition creation unit <b>1129</b> creates a copy pair configuration definition in which the volume determined in step S<b>11695</b> is the copy source, and the volume determined in step S<b>11740</b> is the copy destination. In step S<b>11755</b>, the processing of copy pair configuration definition creation terminates.</p>
<p id="p-0166" num="0165">In the present invention, a VM is specified as a copy source. This makes it possible to create a copy pair configuration definition without duplication or incompatibility. Creation of the copy pair configuration definition by a VM as a unit allows a batch copy of OS images and configuration information on a VM, an application operating in the VM, and its associated data. Thus, a task as a copy source can be performed without configuration information, installing an application, or any other works at a copy destination.</p>
<p id="h-0010" num="0000">Fifth Embodiment</p>
<p id="p-0167" num="0166">The fourth embodiment has described that a copy pair can be created in a plurality of VMs constituting a task, by the task as a unit. A fifth embodiment describes that, in a server virtualization environment, a copy pair configuration definition can be created by a site as a unit as described in the first embodiment. The site used in the fifth embodiment means a set configured by the host computer <b>1200</b>, the storage apparatus <b>1300</b>, and the data network <b>1500</b> for connecting the former two, in the server virtualization environment described in the fourth embodiment.</p>
<p id="p-0168" num="0167">It is advantageous to construct a replication environment by the site because, if a disaster recovery is performed at a site, many users want to protect all tasks rather than a specific task at the site. In the present invention, a site is specified as a copy source. This makes it possible to create a copy pair configuration definition without duplication or incompatibility. Additionally, after a copy source is specified by the site, an unnecessary VM among VMs at the specified site can be deleted from the copy source. This allows a further effective replication.</p>
<p id="p-0169" num="0168">Creation of a copy pair configuration definition by the site allows a bulk copy of OS images and configuration information on a VM, an application operating in the VM, and its associated data. Thus, a configuration of a site as a copy source can be created without configuration information, installing an application, or any other works at a copy destination. Note that a configuration of the storage system in this embodiment is the same as that in the fourth embodiment.</p>
<p id="p-0170" num="0169"><figref idref="DRAWINGS">FIG. 23</figref> shows an example of a GUI according to the fifth embodiment. In <figref idref="DRAWINGS">FIG. 23</figref>, the copy pair create window <b>12000</b> includes the copy type select window <b>7200</b>, a copy source specify window <b>12200</b>, the copy destination specify window <b>7700</b>, and the OK button <b>7900</b>. The copy type select window <b>7200</b> and the copy destination specify window <b>7700</b> are configured same as those in the first embodiment. Thus, only the copy source specify window <b>12200</b> is described below in detail.</p>
<p id="p-0171" num="0170">The copy source specify window <b>12200</b> is a window for selecting a site as a copy source. The copy source specify window <b>12200</b> includes a copy source site specify window <b>12500</b> and a copy source VM specify window <b>12600</b>. The copy source site specify window <b>12500</b> is a window for specifying a site as a copy source. A drop-down list <b>12520</b> displays a site shown at the site <b>10000</b> in the VM configuration table <b>9920</b> of <figref idref="DRAWINGS">FIG. 19</figref> as a candidate copy destination. An add button <b>12530</b> is a button for adding the site selected from the drop-down list <b>12520</b> as a copy source site. A text box <b>12550</b> displays the name of the site added from the drop-down list <b>12520</b> with the add button <b>12530</b>.</p>
<p id="p-0172" num="0171">The copy source VM specify window <b>12600</b> is a window for specifying a VM as a copy source. A copy source VM name <b>12620</b> indicates that a name of the copy source VM is displayed. A text box <b>12630</b> to the right of the copy source VM name <b>12620</b> displays a VM included in the site displayed in the text box <b>12550</b>. A delete button <b>12610</b> is a button for deleting a VM selected from among one or more VMs displayed in the text box <b>12630</b>. The delete button <b>12610</b> can eliminate an unnecessary VM as a copy source from a plurality of VMs at the site specified in the copy source site specify window <b>12500</b>.</p>
<p id="p-0173" num="0172">Below are described step-by-step operations for creating a copy pair configuration definition in this embodiment with reference to <figref idref="DRAWINGS">FIG. 23</figref>, showing a difference from the operations shown in <figref idref="DRAWINGS">FIG. 9</figref> in the first embodiment. First, a task as a copy source is determined. A user specifies a site as a copy source and deletes, if needed, an unnecessary VM from among one or more VMs included in the selected site. Next is determined a site as a copy source. The user selects a site as the copy source from among one or more sites displayed in the drop-down list <b>12520</b> and clicks the add button <b>12530</b>, to thereby determine the site as the copy source.</p>
<p id="p-0174" num="0173">If the user wants to add another copy source site, the user once again selects a desired site to be added from the drop-down list <b>12520</b> and clicks the add button <b>12530</b>, to thereby add another copy source site. If the user wants to delete an unnecessary VM from among the VMs at the site, the user selects a VM to be deleted from the text box <b>12630</b> and clicks the delete button <b>12610</b>, to thereby delete the unnecessary VM.</p>
<p id="p-0175" num="0174">Next is specified a copy destination site, operations of which are the same as those shown in <figref idref="DRAWINGS">FIG. 9</figref> in the first embodiment. Finally, the user clicks the OK button <b>7900</b>. This operation makes the management program <b>1120</b> create a copy pair configuration definition in which the W shown in the text box <b>12630</b> is the copy source, and the site shown in the text box <b>7750</b> is the copy destination.</p>
<p id="p-0176" num="0175"><figref idref="DRAWINGS">FIG. 24</figref> is a flowchart showing a processing of copy pair configuration definition creation according to the fifth embodiment. The processing is described below with reference also to <figref idref="DRAWINGS">FIG. 1</figref> where necessary. The processing of copy pair configuration definition creation which is executed by the management program <b>1120</b> in the management computer <b>1100</b> shown in <figref idref="DRAWINGS">FIG. 24</figref> is described below in detail, while showing a difference from the processing shown in <figref idref="DRAWINGS">FIG. 22</figref> in the fourth embodiment.</p>
<p id="p-0177" num="0176">The processing in this embodiment is the same as that in the fourth embodiment from step S<b>11600</b> at which the processing starts, to step S<b>11650</b> in which the copy pair configuration definition creation unit <b>1129</b> determines a copy type. Thus, the processing after step S<b>11650</b> is described below.</p>
<p id="p-0178" num="0177">In step S<b>13050</b>, the GUI display unit <b>1127</b> displays a list of one or more sites included in the configuration shown <figref idref="DRAWINGS">FIG. 1</figref> to the user. The copy pair configuration definition creation unit <b>1129</b> determines one or more sites specified therefrom by the user as a copy source. In step S<b>13060</b>, the GUI display unit <b>1127</b> displays one or more VMs present at the site determined in step S<b>13050</b> to the user and makes the user determine whether or not there is a VM unnecessary to be copied from among the displayed VMs. In step S<b>13065</b>, if there is a VM unnecessary to be copied (Yes in step S<b>13060</b>), the copy pair configuration definition creation unit <b>1129</b> deletes the unnecessary VM from the copy source VM. If there is not a VM unnecessary to be copied (No in step S<b>13060</b>), the processing proceeds with step S<b>13070</b>.</p>
<p id="p-0179" num="0178">In step S<b>13070</b>, the copy pair configuration definition creation unit <b>1129</b> references the volume configuration table <b>9924</b> at the site created in step S<b>11640</b>. In step S<b>13080</b>, the copy pair configuration definition creation unit <b>1129</b> selects a volume used by the VM not deleted in step S<b>13065</b> without duplication. In step S<b>13090</b>, the copy pair configuration definition creation unit <b>1129</b> determines the volume selected in step S<b>13080</b> as a copy source volume.</p>
<p id="p-0180" num="0179">The processing in this embodiment is the same as that in the fourth embodiment from step S<b>11700</b> in which the copy source site is specified, to step S<b>11740</b> in which the copy destination volume is determined.</p>
<p id="p-0181" num="0180">In step S<b>13140</b>, the copy pair configuration definition creation unit <b>1129</b> creates a copy pair configuration definition in which the volume determined in step S<b>13090</b> is the copy source, and the volume determined in step S<b>11740</b> is the copy destination. In step S<b>13150</b>, the processing of copy pair configuration definition creation terminates.</p>
<p id="p-0182" num="0181">In the present invention, a site is specified as a copy source. This makes it possible to create a copy pair configuration definition without duplication or incompatibility.</p>
<p id="p-0183" num="0182">In this embodiment, the management computer <b>1100</b> consolidates management of a usage condition of a volume from the host computer <b>1200</b> and the storage apparatus <b>1300</b> at each site and prevents a volume from duplicating among applications as a copy source. This makes it possible to select a used volume of an application as a copy source without excess or deficiency. Further, in this embodiment, if a replication environment is constructed in a large-scale storage system, management of a usage condition of a volume in the host computer <b>1200</b> and the storage apparatus <b>1300</b> at each site is consolidated. This makes it possible to create a copy pair configuration definition by the task which is constituted by a plurality of applications. That is, even if a plurality of applications share a single and same volume, a replication environment can be constructed by the task without causing such problems as a redundant configuration and inconsistent data between applications.</p>
<p id="p-0184" num="0183">The embodiments according to the present invention have been explained as aforementioned. However, the embodiments of the present invention are not limited to those explanations, and those skilled in the art ascertain the essential characteristics of the present invention and can make the various modifications and variations to the present invention to adapt it to various usages and conditions without departing from the spirit and scope of the claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A management computer, for use in a context
<claim-text>wherein one or more host computers and one or more storage apparatuses are configured to communicate with each other using a first network, and wherein the one or more host computers and the one or more storage apparatuses are configured to communicate with the management computer using a second network,</claim-text>
<claim-text>the management computer configured to acquire an application configuration information identifying using the second network, a volume of one of the storage apparatuses used by an application in one of the one or more host computers,</claim-text>
<claim-text>the management computer further configured to create management computer application configuration information identifying the volume of one of the storage apparatuses used by the one host computer, using the acquired application configuration information, and configured to store the created management computer application configuration information in a memory unit,</claim-text>
<claim-text>the management computer configured to acquire information on an unused volume in each of the storage apparatuses using the second network from each of the storage apparatuses,</claim-text>
<claim-text>the management computer configured to create volume configuration information in which the created management computer application configuration information and the acquired information on the unused volume are arranged, and configured to store the created volume configuration information in the memory unit,</claim-text>
<claim-text>the management computer configured to create a configuration definition of a copy pair including an original volume into which data in the host computer are written and a duplicated volume into which data are copied, and configured to store the copy pair configuration definition in the memory unit, and</claim-text>
<claim-text>the management computer configured to select, upon specification by an input unit of a group constituted by a plurality of applications at a primary site and a remote site, a volume used by the specified group without duplication by referencing the volume configuration information; configured to designate the selected volume as a copy source volume; configured to designate an unused volume having a capacity larger than that of the copy source volume as a copy destination volume; and configured to create copy pair configuration definition information associating the copy source volume with the copy destination volume.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The management computer according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the group is constituted by the plurality of applications constituting a task.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The management computer according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising the management computer configured so that when the management computer determines from the application configuration information that an application has a cluster configuration, then management computer is configured to display a name of an active application among two or more applications configuring the cluster.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The management computer according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising the management computer configured so that, when the application is a composite application constituted by a plurality of sub-applications, the management computer is configured to create composite application configuration information associating a name of the composite application with names of the sub-applications constituting the composite application, and to store the created composite application configuration information in the memory unit, and
<claim-text>the management computer is further configured to display the name of the composite application on the display unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The management computer according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the group is included in the composite application.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. A management computer, for use in a context
<claim-text>wherein one or more host computers and one or more storage apparatuses are configured to communicate with each other using a first network,</claim-text>
<claim-text>wherein the one or more host computers and the one or more storage apparatuses are configured to communicate each with the management computer using a second network,</claim-text>
<claim-text>wherein the management computer is configured to acquire information on a virtual machine in one of the one or more host computers and a used volume in the virtual machine,</claim-text>
<claim-text>wherein the management computer is configured to create virtual machine configuration information associating the information on the virtual machine and the used volume acquired by a virtual machine configuration information acquisition unit, and to store the virtual machine configuration information in a memory unit,</claim-text>
<claim-text>wherein the management computer is configured to acquire information on an unused volume from one of the one or more storage apparatuses,</claim-text>
<claim-text>wherein the management computer is configured to create volume configuration information in which the virtual machine configuration information and the information on an unused volume acquired by an unused volume information acquisition unit is arranged, and to store the created volume configuration information in the memory unit,</claim-text>
<claim-text>wherein the management computer is configured to create a configuration definition of a copy pair including an original volume into which data in the virtual computer are written and a duplicated volume into which data are copied, and to store the copy pair configuration definition in the memory unit, and</claim-text>
<claim-text>wherein, upon specification by an input unit of a group constituted by a plurality of virtual machines as a copy source, the management computer is configured to select a volume used by the specified group without duplication by referencing the volume configuration information; to designate the selected volume as a copy source volume; to designate an-unused volume having a capacity larger than that of the copy source volume as a copy destination volume; and to create copy pair configuration definition information associating the copy source volume with the copy destination volume.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The management computer according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the group is constituted by the plurality of virtual machines constituting a task. </claim-text>
</claim>
</claims>
</us-patent-grant>
