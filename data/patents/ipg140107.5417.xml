<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v44-2013-05-16.dtd" [ ]>
<us-patent-grant lang="EN" dtd-version="v4.4 2013-05-16" file="US08626517-20140107.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20131224" date-publ="20140107">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08626517</doc-number>
<kind>B2</kind>
<date>20140107</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12905750</doc-number>
<date>20101015</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>138</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20130101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>10</class>
<subclass>L</subclass>
<main-group>19</main-group>
<subgroup>08</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20130101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>10</class>
<subclass>L</subclass>
<main-group>19</main-group>
<subgroup>12</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20140107</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>704500</main-classification>
<further-classification>704219</further-classification>
</classification-national>
<invention-title id="d2e53">Simultaneous time-domain and frequency-domain noise shaping for TDAC transforms</invention-title>
<us-references-cited>
<us-citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5781888</doc-number>
<kind>A</kind>
<name>Herre</name>
<date>19980700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>7042001</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6363338</doc-number>
<kind>B1</kind>
<name>Ubale et al.</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>7042001</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7062040</doc-number>
<kind>B2</kind>
<name>Faller</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>37940611</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7395211</doc-number>
<kind>B2</kind>
<name>Watson et al.</name>
<date>20080700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704500</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7921009</doc-number>
<kind>B2</kind>
<name>Dai</name>
<date>20110400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704223</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>8036903</doc-number>
<kind>B2</kind>
<name>Grill et al.</name>
<date>20111000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704500</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>8046216</doc-number>
<kind>B2</kind>
<name>Dai</name>
<date>20111000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704223</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2004/0158456</doc-number>
<kind>A1</kind>
<name>Prakash et al.</name>
<date>20040800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>7042001</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2005/0267742</doc-number>
<kind>A1</kind>
<name>Makinen</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704219</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2007/0147518</doc-number>
<kind>A1</kind>
<name>Bessette</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375243</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2007/0225971</doc-number>
<kind>A1</kind>
<name>Bessette</name>
<date>20070900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704203</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2007/0282603</doc-number>
<kind>A1</kind>
<name>Bessette</name>
<date>20071200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704219</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2008/0294446</doc-number>
<kind>A1</kind>
<name>Guo et al.</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704501</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2009/0281797</doc-number>
<kind>A1</kind>
<name>Zopf et al.</name>
<date>20091100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704207</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2011/0057818</doc-number>
<kind>A1</kind>
<name>Jung et al.</name>
<date>20110300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>341 50</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2011/0145003</doc-number>
<kind>A1</kind>
<name>Bessette</name>
<date>20110600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704500</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2011/0320196</doc-number>
<kind>A1</kind>
<name>Choo et al.</name>
<date>20111200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704229</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2012/0046955</doc-number>
<kind>A1</kind>
<name>Rajendran et al.</name>
<date>20120200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>704500</main-classification></classification-national>
</us-citation>
<us-citation>
<patcit num="00019">
<document-id>
<country>CA</country>
<doc-number>2556797</doc-number>
<kind>A1</kind>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00020">
<othercit>Ani'bal J. S, Ferreira, Convolutional Effect in Transform Coding with TDAC: An Optimal Window, Mar. 1996, IEEE vol. 4, No. 2, pp. 104-114.</othercit>
</nplcit>
<category>cited by examiner</category>
</us-citation>
<us-citation>
<nplcit num="00021">
<othercit>Princen et al., &#x201c;Subband/Transform Coding Using Filter Bank Designs Based on Time Domain Aliasing Cancellation,&#x201d; IEEE International Conference on Speech, Acoustics and Signal Processing, 12:2161-2164, 1987.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00022">
<othercit>ISO/IEC, &#x201c;Information technology&#x2014;MPEG audio technologies&#x2014;Part 3: Unified speech and audio coding,&#x201d; ISO/IEC CD 23003-3, 164 pgs. 2010.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
<us-citation>
<nplcit num="00023">
<othercit>PCT International Search Report for International Patent Application No. PCT/CA2010/001649, mailed Jan. 13, 2011, 4 pgs.</othercit>
</nplcit>
<category>cited by applicant</category>
</us-citation>
</us-references-cited>
<number-of-claims>38</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>704500</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>8</number-of-drawing-sheets>
<number-of-figures>8</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>61272644</doc-number>
<date>20091015</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110145003</doc-number>
<kind>A1</kind>
<date>20110616</date>
</document-id>
</related-publication>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="001" app-type="applicant" designation="us-only">
<addressbook>
<last-name>Bessette</last-name>
<first-name>Bruno</first-name>
<address>
<city>Sherbrooke</city>
<country>CA</country>
</address>
</addressbook>
<residence>
<country>CA</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="001" designation="us-only">
<addressbook>
<last-name>Bessette</last-name>
<first-name>Bruno</first-name>
<address>
<city>Sherbrooke</city>
<country>CA</country>
</address>
</addressbook>
</inventor>
</inventors>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>K&#x26;L Gates LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Voiceage Corporation</orgname>
<role>03</role>
<address>
<city>Town of Mount Royal, Quebec</city>
<country>CA</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Hudspeth</last-name>
<first-name>David R</first-name>
<department>2657</department>
</primary-examiner>
<assistant-examiner>
<last-name>Nguyen</last-name>
<first-name>Timothy</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A frequency-domain noise shaping method and device interpolates a spectral shape and a time-domain envelope of a quantization noise in a windowed and transform-coded audio signal. In the method and device, transform coefficients of the windowed and transform-coded audio signal are split into a plurality of spectral bands. For each spectral band, a first gain representing a spectral shape of the quantization noise at a first transition between a first time window and a second time window is calculated, a second gain representing a spectral shape of the quantization noise at a second transition between the second time window and a third time window is calculated, and the transform coefficients of the second time window are filtered based on the first and second gains, to interpolate between the first and second transitions the spectral shape and the time-domain envelope of the quantization noise.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="162.31mm" wi="246.04mm" file="US08626517-20140107-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="216.49mm" wi="166.71mm" orientation="landscape" file="US08626517-20140107-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="260.60mm" wi="185.25mm" orientation="landscape" file="US08626517-20140107-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="251.80mm" wi="179.32mm" orientation="landscape" file="US08626517-20140107-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="238.84mm" wi="163.58mm" orientation="landscape" file="US08626517-20140107-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="236.05mm" wi="178.65mm" orientation="landscape" file="US08626517-20140107-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="197.19mm" wi="153.75mm" orientation="landscape" file="US08626517-20140107-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="247.99mm" wi="187.03mm" orientation="landscape" file="US08626517-20140107-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="245.19mm" wi="189.48mm" orientation="landscape" file="US08626517-20140107-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application claims priority to and the benefit of U.S. provisional patent application No. 61/272,644, filed on Oct. 15, 2009, the entire contents of which are hereby incorporated by reference herein.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD</heading>
<p id="p-0003" num="0002">The present disclosure relates to a frequency-domain noise shaping method and device for interpolating a spectral shape and a time-domain envelope of a quantization noise in a windowed and transform-coded audio signal.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">Specialized transform coding produces important bit rate savings in representing digital signals such as audio. Transforms such as the Discrete Fourier Transform (DFT) and the Discrete Cosine Transform (DCT) provide a compact representation of the audio signal by condensing most of the signal energy in relatively few spectral coefficients, compared to the time-domain samples where the energy is distributed over all the samples. This energy compaction property of transforms may lead to efficient quantization, for example through adaptive bit allocation, and perceived distortion minimization, for example through the use of noise masking models. Further data reduction can be achieved through the use of overlapped transforms and Time-Domain Aliasing Cancellation (TDAC). The Modified DCT (MDCT) is an example of such overlapped transforms, in which adjacent blocks of samples of the audio signal to be processed overlap each other to avoid discontinuity artifacts while maintaining critical sampling (N samples of the input audio signal yield N transform coefficients). The TDAC property of the MDCT provides this additional advantage in energy compaction.</p>
<p id="p-0005" num="0004">Recent audio coding models use a multi-mode approach. In this approach, several coding tools can be used to more efficiently encode any type of audio signal (speech, music, mixed, etc). These tools comprise transforms such as the MDCT and predictors such as pitch predictors and Linear Predictive Coding (LPC) filters used in speech coding. When operating a multi-mode codec, transitions between the different coding modes are processed carefully to avoid audible artifacts due to the transition. In particular, shaping of the quantization noise in the different coding modes is typically performed using different procedures. In the frames using transform coding, the quantization noise is shaped in the transform domain (i.e. when quantizing the transform coefficients), applying various quantization steps which are controlled by scale factors derived, for example, from the energy of the audio signal in different spectral bands. On the other hand, in the frames using a predictive model in the time-domain (which typically involves long-term predictors and short-term predictors), the quantization noise is shaped using a so-called weighting filter whose transfer function in the z-transform domain is often denoted W(z). Noise shaping is then applied by first filtering the time-domain samples of the input audio signal through the weighting filter W(z) to obtain a weighted signal, and then encoding the weighted signal in this so-called weighted domain. The spectral shape, or frequency response, of the weighting filter W(z) is controlled such that the coding (or quantization) noise is masked by the input audio signal. Typically, the weighting filter W(z) is derived from the LPC filter, which models the spectral envelope of the input audio signal.</p>
<p id="p-0006" num="0005">An example of a multi-mode audio codec is the Moving Pictures Expert Group (MPEG) Unified Speech and Audio Codec (USAC). This codec integrates tools including transform coding and linear predictive coding, and can switch between different coding modes depending on the characteristics of the input audio signal. There are three (3) basic coding modes in the USAC:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0006">1) An Advanced Audio Coding (AAC)-based coding mode, which encodes the input audio signal using the MDCT and perceptually-derived quantization of the MDCT coefficients;</li>
        <li id="ul0002-0002" num="0007">2) An Algebraic Code Excited Linear Prediction (ACELP) based coding mode, which encodes the input audio signal as an excitation signal (a time-domain signal) processed through a synthesis filter; and</li>
        <li id="ul0002-0003" num="0008">3) A Transform Coded eXcitation (TCX) based coding mode which is a sort of hybrid between the two previous modes, wherein the excitation of the synthesis filter of the second mode is encoded in the frequency domain; actually, this is a target signal or the weighted signal that is encoded in the transform domain.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0007" num="0009">In the USAC, the TCX-based coding mode and the AAC-based coding mode use a similar transform, for example the MDCT. However, in their standard form, AAC and TCX do not apply the same mechanism for controlling the spectral shape of the quantization noise. AAC explicitly controls the quantization noise in the frequency domain in the quantization steps of the transform coefficients. TCX however controls the spectral shape of the quantization noise through the use of time-domain filtering, and more specifically through the use of a weighting filter W(z) as described above. To facilitate quantization noise shaping in a multi-mode audio codec, there is a need for a device and method for simultaneous time-domain and frequency-domain noise shaping for TDAC transforms.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0008" num="0010">In the appended drawings:</p>
<p id="p-0009" num="0011"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic block diagram illustrating the general principle of Temporal Noise Shaping (TNS);</p>
<p id="p-0010" num="0012"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic block diagram of a frequency-domain noise shaping device for interpolating a spectral shape and time-domain envelope of quantization noise;</p>
<p id="p-0011" num="0013"><figref idref="DRAWINGS">FIG. 3</figref> is a flow chart describing the operations of a frequency-domain noise shaping method for interpolating the spectral shape and time-domain envelope of quantization noise;</p>
<p id="p-0012" num="0014"><figref idref="DRAWINGS">FIG. 4</figref> is a schematic diagram of relative window positions for transforms and noise gains, considering calculation of the noise gains for window <b>1</b>;</p>
<p id="p-0013" num="0015"><figref idref="DRAWINGS">FIG. 5</figref> is a graph illustrating the effect of noise shape interpolation, both on the spectral shape and the time-domain envelope of the quantization noise;</p>
<p id="p-0014" num="0016"><figref idref="DRAWINGS">FIG. 6</figref> is a graph illustrating a m<sup>th </sup>time-domain envelope, which can be seen as the noise shape in a m<sup>th </sup>spectral band evolving in time from point A to point B;</p>
<p id="p-0015" num="0017"><figref idref="DRAWINGS">FIG. 7</figref> is a schematic block diagram of an encoder capable of switching between a frequency-domain coding mode using, for example, MDCT and a time-domain coding mode using, for example, ACELP, the encoder applying Frequency Domain Noise Shaping (FNDS) to encode a block of samples of an input audio signal; and</p>
<p id="p-0016" num="0018"><figref idref="DRAWINGS">FIG. 8</figref> is a schematic block diagram of a decoder producing a block of synthesis signal using FDNS, wherein the decoder can switch between a frequency-domain coding mode using, for example, MDCT and a time-domain coding mode using, for example, ACELP.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0017" num="0019">According to a first aspect, the present disclosure relates to a frequency-domain noise shaping method for interpolating a spectral shape and a time-domain envelope of a quantization noise in a windowed and transform-coded audio signal, comprising splitting transform coefficients of the windowed and transform-coded audio signal into a plurality of spectral bands. The frequency-domain noise shaping method also comprises, for each spectral band: calculating a first gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a first transition between a first time window and a second time window; calculating a second gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a second transition between the second time window and a third time window; and filtering the transform coefficients of the second time window based on the first and second gains, to interpolate between the first and second transitions the spectral shape and the time-domain envelope of the quantization noise.</p>
<p id="p-0018" num="0020">According to a second aspect, the present disclosure relates to a frequency-domain noise shaping device for interpolating a spectral shape and a time-domain envelope of a quantization noise in a windowed and transform-coded audio signal, comprising: a splitter of the transform coefficients of the windowed and transform-coded audio signal into a plurality of spectral bands; a calculator, for each spectral band, of a first gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a first transition between a first time window and a second time window, and of a second gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a second transition between the second time window and a third time window; and a filter of the transform coefficients of the second time window based on the first and second gains, to interpolate between the first and second transitions the spectral shape and the time-domain envelope of the quantization noise.</p>
<p id="p-0019" num="0021">According to a third aspect, the present disclosure relates to an encoder for encoding a windowed audio signal, comprising: a first coder of the audio signal in a time-domain coding mode; a second coder of the audio signal is a transform-domain coding mode using a psychoacoustic model and producing a windowed and transform-coded audio signal; a selector between the first coder using the time-domain coding mode and the second coder using the transform-domain coding mode when encoding a time window of the audio signal; and a frequency-domain noise shaping device as described above for interpolating a spectral shape and a time-domain envelope of a quantization noise in the windowed and transform-coded audio signal, thereby achieving a desired spectral shape of the quantization noise at the first and second transitions and a smooth transition of an envelope of this spectral shape from the first transition to the second transition.</p>
<p id="p-0020" num="0022">According to a fourth aspect, the present disclosure relates to a decoder for decoding an encoded, windowed audio signal, comprising: a first decoder of the encoded audio signal using a time-domain decoding mode; a second decoder of the encoded audio signal using a transform-domain decoding mode using a psychoacoustic model; and a selector between the first decoder using the time-domain decoding mode and the second decoder using the transform-domain decoding mode when decoding a time window of the encoded audio signal; and a frequency-domain noise shaping device as described above for interpolating a spectral shape and a time-domain envelope of a quantization noise in transform-coded windows of the encoded audio signal, thereby achieving a desired spectral shape of the quantization noise at the first and second transitions and a smooth transition of an envelope of this spectral shape from the first transition to the second transition.</p>
<p id="p-0021" num="0023">In the present disclosure and the appended claims, the term &#x201c;time window&#x201d; designates a block of time-domain samples, and the term &#x201c;windowed signal&#x201d; designates a time domain window after application of a non-rectangular window.</p>
<p id="p-0022" num="0024">The basic principle of Temporal Noise Shaping (TNS), referred to in the following description will be first briefly discussed.</p>
<p id="p-0023" num="0025">TNS is a technique known to those of ordinary skill in the art of audio coding to shape coding noise in time domain. Referring to <figref idref="DRAWINGS">FIG. 1</figref>, a TNS system <b>100</b> comprises:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0026">A transform processor <b>101</b> to subject a block of samples of an input audio signal x[n] to a transform, for example the Discrete Cosine Transform (DCT) or the Modified DCT (MDCT), and produce transform coefficients X[k];</li>
        <li id="ul0004-0002" num="0027">A single filter <b>102</b> applied to all the spectral bands, more specifically to all the transform coefficients X[k] from the transform processor <b>101</b> to produce filtered transform coefficients X<sub>f</sub>[k];</li>
        <li id="ul0004-0003" num="0028">A processor <b>103</b> to quantize, encode, transmit to a receiver or store in a storage device, decode and inverse quantize the filtered transform coefficients X<sub>f</sub>[k] to produce quantized transform coefficients Y<sub>f</sub>[k];</li>
        <li id="ul0004-0004" num="0029">A single inverse filter <b>104</b> to process the quantized transform coefficients Y<sub>f</sub>[k] to produce decoded transform coefficients Y[k]; and, finally,</li>
        <li id="ul0004-0005" num="0030">An inverse transform processor <b>105</b> to apply an inverse transform to the decoded transform coefficients Y[k] to produce a decoded block of output time-domain samples y[n].</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0024" num="0031">Since, in the example of <figref idref="DRAWINGS">FIG. 1</figref>, the transform processor <b>101</b> uses the DCT or MDCT, the inverse transform applied in the inverse transform processor <b>105</b> is the inverse DCT or inverse MDCT. The single filter <b>102</b> of <figref idref="DRAWINGS">FIG. 1</figref> is derived from an optimal prediction filter for the transform coefficients. This results, in TNS, in modulating the quantization noise with a time-domain envelope which follows the time-domain envelope of the audio signal for the current frame.</p>
<p id="p-0025" num="0032">With reference to <figref idref="DRAWINGS">FIGS. 2 and 3</figref>, the following disclosure describes concurrently a frequency-domain noise shaping device <b>200</b> and method <b>300</b> for interpolating the spectral shape and time-domain envelope of quantization noise. More specifically, in the device <b>200</b> and method <b>300</b>, the spectral shape and time-domain amplitude of the quantization noise at the transition between two overlapping transform-coded blocks are simultaneously interpolated. The adjacent transform-coded blocks can be of similar nature such as two consecutive Advanced Audio Coding (AAC) blocks produced by an AAC coder or two consecutive Transform Coded eXcitation (TCX) blocks produced by a TCX coder, but they can also be of different nature such as an AAC block followed by a TCX block, or vice-versa, wherein two distinct coders are used consecutively. Both the spectral shape and the time-domain envelope of the quantization noise evolve smoothly (or are continuously interpolated) at the junction between two such transform-coded blocks.</p>
<p id="p-0026" num="0033">Operation <b>301</b> (FIG. <b>3</b>)&#x2014;Transform</p>
<p id="p-0027" num="0034">The input audio signal x[n] of <figref idref="DRAWINGS">FIGS. 2 and 3</figref> is a block of N time-domain samples of the input audio signal covering the length of a transform block. For example, the input signal x[n] spans the length of the time-domain window <b>1</b> of <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0028" num="0035">In operation <b>301</b>, the input signal x[n] is transformed through a transform processor <b>201</b> (<figref idref="DRAWINGS">FIG. 2</figref>). For example, the transform processor <b>201</b> may implement an MDCT including a time-domain window (for example window <b>1</b> of <figref idref="DRAWINGS">FIG. 4</figref>) multiplying the input signal x[n] prior to calculating transform coefficients X[k]. As illustrated in <figref idref="DRAWINGS">FIG. 2</figref>, the transform processor <b>201</b> outputs the transform coefficients X[k]. In the non limitative example of a MDCT, the transform coefficients X[k] comprise N spectral coefficients, which is the same as the number of time-domain samples forming the input audio signal x[n].</p>
<p id="p-0029" num="0036">Operation <b>302</b> (FIG. <b>3</b>)&#x2014;Band splitting</p>
<p id="p-0030" num="0037">In operation <b>302</b>, a band splitter <b>202</b> (<figref idref="DRAWINGS">FIG. 2</figref>) splits the transform coefficients X[k] into M spectral bands. More specifically, the transform coefficients X[k] are split into spectral bands B<sub>1</sub>[k], B<sub>2</sub>[k], B<sub>3</sub>[k], . . . , B<sub>M</sub>[k]. The concatenation of the spectral bands B<sub>1</sub>[k], B<sub>2</sub>[k], B<sub>3</sub>[k], . . . , B<sub>M</sub>[k] gives the entire set of transform coefficients, namely B[k]. The number of spectral bands and the number of transform coefficients per spectral band can vary depending on the desired frequency resolution.</p>
<p id="p-0031" num="0038">Operation <b>303</b> (FIG. <b>3</b>)&#x2014;Filtering <b>1</b>, <b>2</b>, <b>3</b>, . . . , M</p>
<p id="p-0032" num="0039">After band splitting <b>302</b>, in operation <b>303</b>, each spectral band B<sub>1</sub>[k], B<sub>2</sub>[k], B<sub>3</sub>[k], . . . , B<sub>M</sub>[k] is filtered through a band-specific filter (Filters <b>1</b>, <b>2</b>, <b>3</b>, . . . , M in <figref idref="DRAWINGS">FIG. 2</figref>). Filters <b>1</b>, <b>2</b>, <b>3</b>, . . . , M can be different for each spectral band, or the same filter can be used for all spectral bands. In an embodiment, Filters <b>1</b>, <b>2</b>, <b>3</b>, . . . , M of <figref idref="DRAWINGS">FIG. 2</figref> are different for each block of samples of the input audio signal x[n]. Operation <b>303</b> produces the filtered bands B<sub>1f</sub>[k], B<sub>2f</sub>[k], B<sub>3</sub>[k], . . . , B<sub>Mf</sub>[k] of <figref idref="DRAWINGS">FIGS. 2 and 3</figref>.</p>
<p id="p-0033" num="0040">Operation <b>304</b> (FIG. <b>3</b>)&#x2014;Quantization, encoding, transmission or storage, decoding, inverse quantization</p>
<p id="p-0034" num="0041">In operation <b>304</b>, the filtered bands B<sub>1f</sub>[k], B<sub>2f</sub>[k], B<sub>3f</sub>[k], . . . , B<sub>Mf</sub>[k] from Filters <b>1</b>, <b>2</b>, <b>3</b>, . . . , M may be quantized, encoded, transmitted to a receiver (not shown) and/or stored in any storage device (not shown). The quantization, encoding, transmission to a receiver and/or storage in a storage device are performed in and/or controlled by a Processor Q of <figref idref="DRAWINGS">FIG. 2</figref>. The Processor Q may be further connected to and control a transceiver (not shown) to transmit the quantized, encoded filtered bands B<sub>1f</sub>[k], B<sub>2f</sub>[k], B<sub>3f</sub>[k], . . . , B<sub>Mf</sub>[k] to the receiver. In the same manner, The Processor Q may be connected to and control the storage device for storing the quantized, encoded filtered bands B<sub>1f</sub>[k], B<sub>2f</sub>[k], B<sub>3f</sub>[k], . . . , B<sub>Mf</sub>[k].</p>
<p id="p-0035" num="0042">In operation <b>304</b>, quantized and encoded filtered bands B<sub>1f</sub>[k], B<sub>2f</sub>[k], B<sub>3</sub>[k], . . . , B<sub>Mf</sub>[k] may also be received by the transceiver or retrieved from the storage device, decoded and inverse quantized by the Processor Q. These operations of receiving (through the transceiver) or retrieving (from the storage device), decoding and inverse quantization produce quantized spectral bands C<sub>1f</sub>[k], C<sub>2f</sub>[k], C<sub>3f</sub>[k], . . . , C<sub>Mf</sub>[k] at the output of the Processor Q.</p>
<p id="p-0036" num="0043">Any type of quantization, encoding, transmission (and/or storage), receiving, decoding and inverse quantization can be used in operation <b>304</b> without loss of generality.</p>
<p id="p-0037" num="0044">Operation <b>305</b> (FIG. <b>3</b>)&#x2014;Inverse Filtering <b>1</b>, <b>2</b>, <b>3</b>, . . . , M</p>
<p id="p-0038" num="0045">In operation <b>305</b>, the quantized spectral bands C<sub>1f</sub>[k], C<sub>2f</sub>[k], C<sub>3f</sub>[k], . . . , C<sub>Mf</sub>[k] are processed through inverse filters, more specifically inverse Filter <b>1</b>, inverse Filter <b>2</b>, inverse Filter <b>3</b>, . . . , inverse filter M of <figref idref="DRAWINGS">FIG. 2</figref>, to produce decoded spectral bands C<sub>1</sub>[k], C<sub>2</sub>[k], C<sub>3</sub>[k], . . . , C<sub>M</sub>[k]. The inverse Filter <b>1</b>, inverse Filter <b>2</b>, inverse Filter <b>3</b>, . . . , inverse filter M have transfer functions inverse of the transfer functions of Filter <b>1</b>, Filter <b>2</b>, Filter <b>3</b>, . . . , Filter M, respectively.</p>
<p id="p-0039" num="0046">Operation <b>306</b> (<figref idref="DRAWINGS">FIG. 3</figref>) - Spectral band concatenation</p>
<p id="p-0040" num="0047">In operation <b>306</b>, the decoded spectral bands C<sub>1</sub>[k], C<sub>2</sub>[k], C<sub>3</sub>[k], . . . , C<sub>M</sub>[k] are then concatenated in a band concatenator <b>203</b> of <figref idref="DRAWINGS">FIG. 2</figref>, to yield decoded spectral coefficients Y[k] (decoded spectrum).</p>
<p id="p-0041" num="0048">Operation <b>307</b> (FIG. <b>3</b>)&#x2014;Inverse transform</p>
<p id="p-0042" num="0049">Finally, in operation <b>307</b>, an inverse transform processor <b>204</b> (<figref idref="DRAWINGS">FIG. 2</figref>) applies an inverse transform to the decoded spectral coefficients Y[k] to produce a decoded block of output time-domain samples y[n]. In the case of the above non-limitative example using the MDCT, the inverse transform processor <b>204</b> applies the inverse MDCT (IMDCT) to the decoded spectral coefficients Y[k].</p>
<p id="p-0043" num="0050">Operation <b>308</b> (FIG. <b>3</b>)&#x2014;Calculating noise gains g<sub>1</sub>[m] and g<sub>2</sub>[m]</p>
<p id="p-0044" num="0051">In <figref idref="DRAWINGS">FIG. 2</figref>, Filter <b>1</b>, Filter <b>2</b>, Filter <b>3</b>, . . . , Filter M and inverse Filter <b>1</b>, inverse Filter <b>2</b>, inverse Filter <b>3</b>, . . . , inverse Filter M use parameters (noise gains) g<sub>1</sub>[m] and g<sub>2</sub>[m] as input. These noise gains represent spectral shapes of the quantization noise and will be further described herein below. Also, the Filterings <b>1</b>, <b>2</b>, <b>3</b>, . . . , M of <figref idref="DRAWINGS">FIG. 3</figref> may be sequential; Filter <b>1</b> may be applied before Filter <b>2</b>, then Filter <b>3</b>, and so on until Filter M (<figref idref="DRAWINGS">FIG. 2</figref>). The inverse Filterings <b>1</b>, <b>2</b>, <b>3</b>, . . . , M may also be sequential; inverse Filter <b>1</b> may be applied before inverse Filter <b>2</b>, then inverse Filter <b>3</b>, and so on until inverse Filter M (<figref idref="DRAWINGS">FIG. 2</figref>). As such, each filter and inverse filter may use as an initial state the final state of the previous filter or inverse filter. This sequential operation may ensure continuity in the filtering process from one spectral band to the next. In one embodiment, this continuity constraint in the filter states from one spectral band to the next may not be applied.</p>
<p id="p-0045" num="0052"><figref idref="DRAWINGS">FIG. 4</figref> illustrates how the frequency-domain noise shaping for interpolating the spectral shape and time-domain envelope of quantization noise can be used when processing an audio signal segmented by overlapping windows (window <b>0</b>, window <b>1</b>, window <b>2</b> and window <b>3</b>) into adjacent overlapping transform blocks (blocks of samples of the input audio signal). Each window of <figref idref="DRAWINGS">FIG. 4</figref>, i.e. window <b>0</b>, window <b>1</b>, window <b>2</b> and window <b>3</b>, shows the time span of a transform block and the shape of the window applied by the transform processor <b>201</b> of <figref idref="DRAWINGS">FIG. 2</figref> to that block of samples of the input audio signal. As described hereinabove, the transform processor <b>201</b> of <figref idref="DRAWINGS">FIG. 2</figref> implements both windowing of the input audio signal x[n] and application of the transform to produce the transform coefficients X[k]. The shape of the windows (window <b>0</b>, window <b>1</b>, window <b>2</b> and window <b>3</b>) shown in <figref idref="DRAWINGS">FIG. 4</figref> can be changed without loss of generality.</p>
<p id="p-0046" num="0053">In <figref idref="DRAWINGS">FIG. 4</figref>, processing of a block of samples of the input audio signal x[n] from beginning to end of window <b>1</b> is considered. The block of samples of the input audio signal x[n] is supplied to the transform processor <b>201</b> of <figref idref="DRAWINGS">FIG. 2</figref>. In the calculating operation <b>308</b> (<figref idref="DRAWINGS">FIG. 3</figref>), the calculator <b>205</b> (<figref idref="DRAWINGS">FIG. 2</figref>) computes two sets of noise gains g<sub>1</sub>[m] and g<sub>2</sub>[m] used for the filtering operations (Filters <b>1</b> to M and inverse Filters <b>1</b> to M). These two sets of noise gains actually represent desired levels of noise in the M spectral bands at a given position in time. Hence, the noise gains g<sub>1</sub>[m] and g<sub>2</sub>[m] each represent the spectral shape of the quantization noise at such position on the time axis. In <figref idref="DRAWINGS">FIG. 4</figref>, the noise gains g<sub>1</sub>[m] correspond to some analysis centered at point A on the time axis, and the noise gains g<sub>2</sub>[m] correspond to another analysis further up on the time axis, at position B. For optimal operation, analyses of these noise gains are centered at the middle point of the overlap between adjacent windows and corresponding blocks of samples. Accordingly, referring to <figref idref="DRAWINGS">FIG. 4</figref>, the analysis to obtain the noise gains g<sub>1</sub>[m] for window <b>1</b> is centered at the middle point of the overlap (or transition) between window <b>0</b> and window <b>1</b> (see point A on the time axis). Also, the analysis to obtain the noise gains g<sub>2</sub>[m] for window <b>1</b> is centered at the middle point of the overlap (or transition) between window <b>1</b> and window <b>2</b> (see point B on the time axis).</p>
<p id="p-0047" num="0054">A plurality of different analysis procedures can be used by the calculator <b>205</b> (<figref idref="DRAWINGS">FIG. 2</figref>) to obtain the sets of noise gains g<sub>1</sub>[m] and g<sub>2</sub>[m], as long as such analysis procedure leads to a set of suitable noise gains in the frequency domain for each of the M spectral bands B<sub>1</sub>[k], B<sub>2</sub>[k], B<sub>3</sub>[k], . . . , B<sub>M</sub>[k] of <figref idref="DRAWINGS">FIGS. 2 and 3</figref>. For example, a Linear Predictive Coding (LPC) can be applied to the input audio signal x[n] to obtain a short-term predictor from which a weighting filter W(z) is derived. The weighting filter W(z) is then mapped into the frequency-domain to obtain the noise gains g<sub>1</sub>[m] and g<sub>2</sub>[m]. This would be a typical analysis procedure usable when the block of samples of the input signal x[n] in window <b>1</b> of <figref idref="DRAWINGS">FIG. 4</figref> is encoded in TCX mode. Another approach to obtain the noise gains g<sub>1</sub>[m] and g<sub>2</sub>[m] of <figref idref="DRAWINGS">FIGS. 2 and 3</figref> could be as in AAC, where the noise level in each frequency band is controlled by scale factors (derived from a psychoacoustic model) in the MDCT domain.</p>
<p id="p-0048" num="0055">Having processed through the transform processor <b>201</b> of <figref idref="DRAWINGS">FIG. 2</figref> the block of samples of the input signal x[n] spanning the length of window <b>1</b> of <figref idref="DRAWINGS">FIG. 4</figref>, and having obtained the sets of noise gains g<sub>1</sub>[m] and g<sub>2</sub>[m] at positions A and B on the time axis of <figref idref="DRAWINGS">FIG. 4</figref> using the calculator <b>205</b>, the filtering operations for each spectral band B<sub>1</sub>[k], B<sub>2</sub>[k], B<sub>3</sub>[k], . . . , B<sub>M</sub>[k] of <figref idref="DRAWINGS">FIG. 2</figref> are performed. The object of the filtering (and inverse filtering) operations is to achieve a desired spectral shape of the quantization noise at positions A and B on the time axis, and also to ensure a smooth transition or interpolation of this spectral shape or the envelope of this spectral shape from point A to point B, on a sample-by-sample basis. This is shown in <figref idref="DRAWINGS">FIG. 5</figref>, in which an illustration of the noise gains g<sub>1</sub>[m] is shown at point A and an illustration of the noise gains g<sub>2</sub>[m] is shown at point B. If each of the spectral bands B<sub>1</sub>[k], B<sub>2</sub>[k], B<sub>3</sub>[k], . . . , B<sub>M</sub>[k] were simply multiplied by a function of the noise gains g<sub>1</sub>[m] and g<sub>2</sub>[m], for example by taking a weighted sum of g<sub>1</sub>[m] and g<sub>2</sub>[m] and multiplying by this result the coefficients in spectral band B<sub>m</sub>[k], m taking one of the values <b>1</b>, <b>2</b>, <b>3</b>, . . . , M, then the interpolated gain curves shown in <figref idref="DRAWINGS">FIG. 5</figref> would be constant (horizontal) from point A to point B. To obtain smoothly varying noise gain curves from gain g<sub>1</sub>[m] to gain g<sub>2</sub>[m] for each spectral band as shown in <figref idref="DRAWINGS">FIG. 5</figref>, filtering can be applied to each spectral band B<sub>m</sub>[k]. By the duality property of many linear transforms, in particular the DCT and MDCT, a filtering (or convolution) operation in one domain results in a multiplication in the other domain. Accordingly, filtering the transform coefficients in one spectral band B<sub>m</sub>[k] results in interpolating and applying a time-domain envelope (multiplication) to the quantization noise in that spectral band. This is the basis of TNS, which principle is briefly presented in the foregoing description of <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0049" num="0056">However, there are fundamental differences between TNS and the herein proposed interpolation. As a first difference between TNS and the herein disclosed technique, the objective and processing are different. In the herein disclosed technique, the objective is to impose, for the duration of a given window (for example window <b>1</b> of <figref idref="DRAWINGS">FIG. 4</figref>), a time-domain envelope for the quantization noise in a given band B<sub>m</sub>[k] which smoothly varies from the noise gain g<sub>1</sub>[m] calculated at point A to the noise gain g<sub>2</sub>[m] calculated at point B. <figref idref="DRAWINGS">FIG. 6</figref> shows an example of interpolated time-domain envelope of the noise gain, for spectral band B<sub>m</sub>[k]. There are several possibilities for such an interpolated curve, and the corresponding frequency-domain filter for that spectral band B<sub>m</sub>[k]. For example, a first-order recursive filter structure can be used for each spectral band. Many other filter structures are possible, without loss of generality.</p>
<p id="p-0050" num="0057">Since the objective is to shape, through filtering, the quantization noise in each spectral band B<sub>m</sub>[k], first concern is directed to the inverse Filters <b>1</b> to M of <figref idref="DRAWINGS">FIG. 2</figref>, which is the inverse filtering operation that will shape the quantization noise introduced by processor Q (<figref idref="DRAWINGS">FIG. 2</figref>).</p>
<p id="p-0051" num="0058">If we consider then that the quantized transform coefficients Y<sub>f</sub>[k] of the spectral band C<sub>mf</sub>[k] are filtered as follows
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C</i><sub>m</sub><i>[k]=aC</i><sub>mf</sub><i>[k]+bC</i><sub>m</sub><i>[k&#x2212;</i>1]&#x2003;&#x2003;(1)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
using filter parameters a and b. Equation (1) represents a first-order recursive filter, applied to the transform coefficients of spectral band C<sub>mf</sub>[k]. As stated above, it is possible to use other filter structures.
</p>
<p id="p-0052" num="0059">To understand the effect, in time-domain, of the filter of Equation (1) applied in the frequency-domain, use is made of a duality property of Fourier transforms which applies in particular to the MDCT. This duality property states that a convolution (or filtering) of a signal in one domain is equivalent to a multiplication (or actually, a modulation) of the signal in the other domain. For example, if the following filter is applied to a time-domain signal x[n]:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>y[n]=ax[n]+by[n&#x2212;</i>1]&#x2003;&#x2003;(2)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where x[n] is the input of the filter and y[n] is the output of the filter, then this is equivalent to multiplying the transform of the input x[n], which can be noted X(e<sup>j&#x3b8;</sup>), by:
</p>
<p id="p-0053" num="0060">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>H</mi>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <msup>
              <mi>&#x2147;</mi>
              <mrow>
                <mi>j</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>&#x3b8;</mi>
              </mrow>
            </msup>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mfrac>
          <mi>a</mi>
          <mrow>
            <mn>1</mn>
            <mo>-</mo>
            <mrow>
              <mi>b</mi>
              <mo>&#x2062;</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>&#x2062;</mo>
              <msup>
                <mi>&#x2147;</mi>
                <mrow>
                  <mrow>
                    <mo>-</mo>
                    <mi>j</mi>
                  </mrow>
                  <mo>&#x2062;</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>&#x2062;</mo>
                  <mi>&#x3b8;</mi>
                </mrow>
              </msup>
            </mrow>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>3</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0054" num="0061">In Equation (3), &#x3b8; is the normalized frequency (in radians per sample) and H(e<sup>j&#x3b8;</sup>) is the transfer function of the recursive filter of Equation (2). What is used is the value of H(e<sup>j&#x3b8;</sup>) at the beginning (&#x3b8;=0) and end (&#x3b8;=&#x3c0;) of the frequency domain scale. It is easy to show that, for Equation (3),</p>
<p id="p-0055" num="0062">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>H</mi>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <msup>
              <mi>&#x2147;</mi>
              <mrow>
                <mi>j</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mn>0</mn>
              </mrow>
            </msup>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mfrac>
          <mi>a</mi>
          <mrow>
            <mn>1</mn>
            <mo>-</mo>
            <mi>b</mi>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>4</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0056" num="0063">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>H</mi>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>(</mo>
            <msup>
              <mi>&#x2147;</mi>
              <mrow>
                <mi>j</mi>
                <mo>&#x2062;</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>&#x2062;</mo>
                <mi>&#x3c0;</mi>
              </mrow>
            </msup>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mfrac>
          <mi>a</mi>
          <mrow>
            <mn>1</mn>
            <mo>+</mo>
            <mi>b</mi>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>5</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0057" num="0064">Equations (4) and (5) represent the initial and final values of the curve described by Equation (3). In between those two points, the curve will evolve smoothly between the initial and final values. For the Discrete Fourier Transform (DFT), which is a complex-valued transform, this curve will have complex values. But for other real-valued transforms such as the DCT and MDCT, this curve will exhibit real values only.</p>
<p id="p-0058" num="0065">Now, because of the duality property of the Fourier transform, if the filtering of Equation (2) is applied in the frequency-domain as in Equation (1), then this will have the effect of multiplying the time-domain signal by a smooth envelope with initial and final values as in Equations (4) and (5). This time-domain envelope will have a shape that could look like the curve of <figref idref="DRAWINGS">FIG. 6</figref>. Further, if the frequency-domain filtering as in Equation (1) is applied only to one spectral band, then the time-domain envelope produced is only related to that spectral band. The other filters amongst inverse Filter <b>1</b>, inverse Filter <b>2</b>, inverse Filter <b>3</b>, . . . , inverse Filter M of <figref idref="DRAWINGS">FIGS. 2 and 3</figref> will produce different time-domain envelopes for the corresponding spectral bands such as those shown in <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0059" num="0066">It is reminded that these time-domain envelopes of each spectral band are made equal, at the beginning and the end of a block of samples of the input signal x[n] (for example window <b>1</b> of <figref idref="DRAWINGS">FIG. 4</figref>), to the noise gains g<sub>1</sub>[m] and g<sub>2</sub>[m] calculated at these time instants. For the m<sup>th </sup>spectral band, the noise gain at the beginning of the block of samples of the input signal x[n] (frame) is g<sub>1</sub>[m] and the noise gain at the end of the block of samples of the input signal x[n] (frame) is g<sub>2</sub>[m]. Between those beginning (A) and end (B) points, the time-domain envelopes (one per spectral band) are made, more specifically interpolated to vary smoothly in time such that the noise gain in each spectral band evolve smoothly in the time-domain signal. In this manner, the spectral shape of the quantization noise evolves smoothly in time, from point A to point B. This is shown in <figref idref="DRAWINGS">FIG. 5</figref>. The dotted spectral shape at time instant C represents the instantaneous spectral shape of the quantization noise at some time instant between the beginning and end of the segment (points A and B).</p>
<p id="p-0060" num="0067">For the specific case of the frequency-domain filter of Equation (1), this implies the following constraints to determine parameters a and b in the filter equation from the noise gains g<sub>1</sub>[m] and g<sub>2</sub>[m]:</p>
<p id="p-0061" num="0068">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>g</mi>
            <mn>1</mn>
          </msub>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>[</mo>
            <mi>m</mi>
            <mo>]</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mfrac>
          <mi>a</mi>
          <mrow>
            <mn>1</mn>
            <mo>-</mo>
            <mi>b</mi>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>6</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>g</mi>
            <mn>2</mn>
          </msub>
          <mo>&#x2061;</mo>
          <mrow>
            <mo>[</mo>
            <mi>m</mi>
            <mo>]</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mfrac>
          <mi>a</mi>
          <mrow>
            <mn>1</mn>
            <mo>+</mo>
            <mi>b</mi>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>7</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0062" num="0069">To simplify notation, let us set g<sub>1</sub>=g<sub>1</sub>[m] and g<sub>2</sub>=g<sub>2</sub>[m], and remember that this is only for spectral band B<sub>m</sub>[k]. The following relations are obtained:</p>
<p id="p-0063" num="0070">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>g</mi>
          <mn>1</mn>
        </msub>
        <mo>=</mo>
        <mfrac>
          <mi>a</mi>
          <mrow>
            <mn>1</mn>
            <mo>-</mo>
            <mi>b</mi>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>8</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>g</mi>
          <mn>2</mn>
        </msub>
        <mo>=</mo>
        <mfrac>
          <mi>a</mi>
          <mrow>
            <mn>1</mn>
            <mo>+</mo>
            <mi>b</mi>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>9</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0064" num="0071">From Equations (8) and (9), it is straightforward, for each inverse Filter <b>1</b>, <b>2</b>, <b>3</b>, . . . , M, to calculate the filter coefficients a and b as a function of g<sub>1 </sub>and g<sub>2</sub>. The following relations are obtained:</p>
<p id="p-0065" num="0072">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>a</mi>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mo>-</mo>
            <mn>2</mn>
          </mrow>
          <mo>&#x2062;</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub>
                  <mi>g</mi>
                  <mn>1</mn>
                </msub>
                <mo>&#x2062;</mo>
                <msub>
                  <mi>g</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
              <mrow>
                <msub>
                  <mi>g</mi>
                  <mn>1</mn>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>g</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>10</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mi>b</mi>
        <mo>=</mo>
        <mfrac>
          <mrow>
            <msub>
              <mi>g</mi>
              <mn>1</mn>
            </msub>
            <mo>-</mo>
            <msub>
              <mi>g</mi>
              <mn>2</mn>
            </msub>
          </mrow>
          <mrow>
            <msub>
              <mi>g</mi>
              <mn>1</mn>
            </msub>
            <mo>+</mo>
            <msub>
              <mi>g</mi>
              <mn>2</mn>
            </msub>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>11</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0066" num="0073">To summarize, coefficients a and b in Equations (10) and (11) are the coefficients to use in the frequency-domain filtering of Equation (1) in order to temporally shape the quantization noise in that m<sup>th </sup>spectral band such that it follows the time-domain envelope shown in <figref idref="DRAWINGS">FIG. 6</figref>. In the special case of the MDCT used as the transform in transform processor <b>201</b> of <figref idref="DRAWINGS">FIG. 2</figref>, the signs of Equations (10) and (11) are reversed, that is the filter coefficients to use in Equation (1) become:</p>
<p id="p-0067" num="0074">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>a</mi>
        <mo>=</mo>
        <mrow>
          <mn>2</mn>
          <mo>&#x2062;</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub>
                  <mi>g</mi>
                  <mn>1</mn>
                </msub>
                <mo>&#x2062;</mo>
                <msub>
                  <mi>g</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
              <mrow>
                <msub>
                  <mi>g</mi>
                  <mn>1</mn>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>g</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>12</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mi>b</mi>
        <mo>=</mo>
        <mfrac>
          <mrow>
            <msub>
              <mi>g</mi>
              <mn>2</mn>
            </msub>
            <mo>-</mo>
            <msub>
              <mi>g</mi>
              <mn>1</mn>
            </msub>
          </mrow>
          <mrow>
            <msub>
              <mi>g</mi>
              <mn>1</mn>
            </msub>
            <mo>+</mo>
            <msub>
              <mi>g</mi>
              <mn>2</mn>
            </msub>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>13</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
This time-domain reversal of the Time-Domain Aliasing Cancellation (TDAC) is specific to the special case of the MDCT.
</p>
<p id="p-0068" num="0075">Now, the inverse filtering of Equation (1) shapes both the quantization noise and the signal itself. To ensure a reversible process, more specifically to ensure that y[n]=x[n] in <figref idref="DRAWINGS">FIGS. 2 and 3</figref> if the quantization noise is zero, a filtering through Filter <b>1</b>, Filter <b>2</b>, Filter <b>3</b>, . . . , Filter M is also applied to each spectral band B<sub>m</sub>[k] before the quantization in Processor Q (<figref idref="DRAWINGS">FIG. 2</figref>). Filter <b>1</b>, Filter <b>2</b>, Filter <b>3</b>, . . . , Filter M of <figref idref="DRAWINGS">FIG. 2</figref> form pre-filters (i.e. filters prior to quantization) that are actually the &#x201c;inverse&#x201d; of the inverse Filter <b>1</b>, inverse Filter <b>2</b>, inverse Filter <b>3</b>, . . . , inverse Filter M. In the specific case of Equation (1) representing the transfer function of the inverse Filter <b>1</b>, inverse Filter <b>2</b>, inverse Filter <b>3</b>, . . . , inverse Filter M, the filters prior to quantization, more specifically Filter <b>1</b>, Filter <b>2</b>, Filter <b>3</b>, . . . , Filter M of <figref idref="DRAWINGS">FIG. 2</figref> are defined by:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>B</i><sub>mf</sub><i>[k]=aB</i><sub>m</sub><i>[k]&#x2212;bB</i><sub>m</sub><i>[k&#x2212;</i>1]&#x2003;&#x2003;(14)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0069" num="0076">In Equation (14), coefficients a and b calculated for the Filters <b>1</b>, <b>2</b>, <b>3</b>, . . . , M are the same as in Equations (10) and (11), or Equations (12) and (13) for the special case of the MDCT. Equation (14) describes the inverse of the recursive filter of Equation (1). Again, if another type or structure of filter different from that of Equation (1) is used, then the inverse of this other type or structure of filter is used instead of that of Equation (14).</p>
<p id="p-0070" num="0077">Another aspect is that the concept can be generalized to any shapes of quantization noise at points A and B of the windows of <figref idref="DRAWINGS">FIG. 4</figref>, and is not constrained to noise shapes having always the same resolution (same number of spectral bands M and same number of spectral coefficients X[k] per band). In the foregoing disclosure, it was assumed that the number M of spectral bands B<sub>m</sub>[k] is the same in the noise gains g<sub>1</sub>[m] and g<sub>2</sub>[m], and that each spectral band has the same number of transform coefficients X[k]. But actually, this can be generalized as follows: when applying the frequency-domain filterings as in Equations (1) and (14), the filter coefficients (for example coefficients a and b) may be recalculated whenever the noise gain at one frequency bin k changes in either of the noise shape descriptions at point A or point B. As an example, if at point A of <figref idref="DRAWINGS">FIG. 4</figref>, the noise shape is a constant (only one gain for the whole frequency axis) and at point B of <figref idref="DRAWINGS">FIG. 5</figref> there are as many different noise gains as the number N of transform coefficients X[k] (input signal x[n] after application of a transform in transform processor <b>201</b> of <figref idref="DRAWINGS">FIG. 2</figref>). Then, when applying the frequency domain filterings of Equations (1) and (14), the filter coefficients would be recalculated at every frequency component, even though the noise description at point A does not change over all coefficients. The interpolated noise gains of <figref idref="DRAWINGS">FIG. 5</figref> would all start from the same amplitude (constant noise gain at point A) and converge towards the different individual noise gains at the different frequencies at point B.</p>
<p id="p-0071" num="0078">Such flexibility allows the use of the frequency-domain noise shaping device <b>200</b> and method <b>300</b> for interpolating the spectral shape and time-domain envelope of quantization noise in a system in which the resolution of the shape of the spectral noise changes in time. For example, in a variable bit rate codec, there might be enough bits at some frames (point A or point B in <figref idref="DRAWINGS">FIGS. 4 and 5</figref>) to refine the description of noise gains by adding more spectral bands or changing the frequency resolution to better follow so-called critical spectral bands, or using a multi-stage quantization of the noise gains, and so on. The filterings and inverse filterings of <figref idref="DRAWINGS">FIGS. 2 and 3</figref>, described hereinabove as operating per spectral band, can actually be seen as one single filtering (or one single inverse filtering) one frequency component at a time whereby the filter coefficients are updated whenever either the start point or the end point of the desired noise envelope changes in a noise level description.</p>
<p id="p-0072" num="0079">Illustrated in <figref idref="DRAWINGS">FIG. 7</figref> is an encoder <b>700</b> for coding audio signals, the principle of which can be used for example in the multi-mode Moving Pictures Expert Group (MPEG) Unified Speech and Audio Codec (USAC). More specifically, the encoder <b>700</b> is capable of switching between a frequency-domain coding mode using, for example, MDCT and a time-domain coding mode using, for example, ACELP, In this particular example, the encoder <b>700</b> comprises: an ACELP coder including an LPC quantizer which calculates, encodes and transmits LPC coefficients from an LPC analysis; and a transform-based coder using a perceptual model (or psychoacoustical model) and scale factors to shape the quantization noise of spectral coefficients. The transform-based coder comprises a device as described hereinabove, to simultaneously shape in the time-domain and frequency-domain the quantization noise of the transform-based coder between two frame boundaries of the transform-based coder. in which quantization noise gains can be described by either only the information from the LPC coefficients, or only the information from scale factors, or any combination of the two. A selector (not shown) chooses between the ACELP coder using the time-domain coding mode and the transform-based coder using the transform-domain coding mode when encoding a time window of the audio signal, depending for example on the type of the audio signal to be encoded and/or the type of coding mode to be used for that type of audio signal.</p>
<p id="p-0073" num="0080">Still referring to <figref idref="DRAWINGS">FIG. 7</figref>, windowing operations are first applied in windowing processor <b>701</b> to a block of samples of an input audio signal. In this manner, windowed versions of the input audio signal are produced at outputs of the windowing processor <b>701</b>. These windowed versions of the input audio signal have possibly different lengths depending on the subsequent processors in which they will be used as input in <figref idref="DRAWINGS">FIG. 7</figref>.</p>
<p id="p-0074" num="0081">As described hereinabove, the encoder <b>700</b> comprises an ACELP coder including an LPC quantizer which calculates, encodes and transmits the LPC coefficients from an LPC analysis. More specifically, referring to <figref idref="DRAWINGS">FIG. 7</figref>, the ACELP coder of the encoder <b>700</b> comprises an LPC analyser <b>704</b>, an LPC quantizer <b>706</b>, an ACELP targets calculator <b>708</b> and an excitation encoder <b>712</b>. The LPC analyser <b>704</b> processes a first windowed version of the input audio signal from processor <b>701</b> to produce LPC coefficients. The LPC coefficients from the LPC analyser <b>704</b> are quantized in an LPC quantizer <b>706</b> in any domain suitable for quantization of this information. In an ACELP frame, noise shaping is applied as well know to those of ordinary skill in the art as a time-domain filtering, using a weighting filter derived from the LPC filter (LPC coefficients). This is performed in ACELP targets calculator <b>708</b> and excitation encoder <b>712</b>. More specifically, calculator <b>708</b> uses a second windowed version of the input audio signal (using typically a rectangular window) and produces in response to the quantized LPC coefficients from the quantizer <b>706</b> the so called target signals in ACELP encoding. From the target signals produced by the calculator <b>708</b>, encoder <b>712</b> applies a procedure to encode the excitation of the LPC filter for the current block of samples of the input audio signal.</p>
<p id="p-0075" num="0082">As described hereinabove, the system <b>700</b> of <figref idref="DRAWINGS">FIG. 7</figref> also comprises a transform-based coder using a perceptual model (or psychoacoustical model) and scale factors to shape the quantization noise of the spectral coefficients, wherein the transform-based coder comprises a device to simultaneously shape in the time-domain and frequency-domain the quantization noise of the transform-based encoder. The transform-based coder comprises, as illustrated in <figref idref="DRAWINGS">FIG. 7</figref>, a MDCT processor <b>702</b>, an inverse FDNS processor <b>707</b>, and a processed spectrum quantizer <b>711</b>, wherein the device to simultaneously shape in the time-domain and frequency-domain the quantization noise of the transform-based coder comprises the inverse FDNS processor <b>707</b>. A third windowed version of the input audio signal from windowing processor <b>701</b> is processed by the MDCT processor <b>702</b> to produce spectral coefficients. The MDCT processor <b>702</b> is a specific case of the more general processor <b>201</b> of <figref idref="DRAWINGS">FIG. 2</figref> and is understood to represent the MDCT (Modified Discrete Cosine Transform). Prior to being quantized and encoded (in any domain suitable for quantization and encoding of this information) for transmission by quantizer <b>711</b>, the spectral coefficients from the MDCT processor <b>702</b> are processed through the inverse FDNS processor <b>707</b>. The operation of the inverse FDNS processor <b>707</b> is as in <figref idref="DRAWINGS">FIG. 2</figref>, starting with the spectral coefficients X[k] (<figref idref="DRAWINGS">FIG. 2</figref>) as input to the FDNS processor <b>707</b> and ending before processor Q (<figref idref="DRAWINGS">FIG. 2</figref>). The inverse FDNS processor <b>707</b> requires as input sets of noise gains g<sub>1</sub>[m] and g<sub>2</sub>[m] as described in <figref idref="DRAWINGS">FIG. 2</figref>. The noise gains are obtained from the adder <b>709</b>, which adds two inputs: the output of a scale factors quantizer <b>705</b> and the output of a noise gains calculator <b>710</b>. Any combination of scale factors, for example from a psychoacoustic model, and noise gains, for example from an LPC model, are possible, from using only scale factors to using only noise gains, to any combination or proportion of the scale factors and noise gains. For example, the scale factors from the psychoacoustic model can be used as a second set of gains or scale factors to refine, or correct, the noise gains from the LPC model. Accordingly to another alternative, the combination of the noise gains and scale factors comprises the sum of the noise gains and scale factors, where the scale factors are used as a correction to the noise gains. To produce the quantized scale factors at the output of quantizer <b>705</b>, a fourth windowed version of the input signal from processor <b>701</b> is processed by a psychoacoustic analyser <b>703</b> which produces unquantized scale factors which are then quantized by quantizer <b>705</b> in any domain suitable for quantization of this information. Similarly, to produce the noise gains at the output of calculator <b>710</b>, a noise gains calculator <b>710</b> is supplied with the quantized LPC coefficients from the quantizer <b>706</b>. In a block of input signal where the encoder <b>700</b> would switch between an ACELP frame and an MDCT frame, FDNS is only applied to the MDCT-encoded samples.</p>
<p id="p-0076" num="0083">The bit multiplexer <b>713</b> receives as input the quantized and encoded spectral coefficients from processed spectrum quantizer <b>711</b>, the quantized scale factors from quantizer <b>705</b>, the quantized LPC coefficients from LPC quantizer <b>706</b> and the encoded excitation of the LPC filter from encoder <b>712</b> and produces in response to these encoded parameters a stream of bits for transmission or storage.</p>
<p id="p-0077" num="0084">Illustrated in <figref idref="DRAWINGS">FIG. 8</figref> is a decoder <b>800</b> producing a block of synthesis signal using FDNS, wherein the decoder can switch between a frequency-domain decoding mode using, for example, IMDCT and a time-domain decoding mode using, for example, ACELP. A selector (not shown) chooses between the ACELP decoder using the time-domain decoding mode and the transform-based decoder using the transform-domain coding mode when decoding a time window of the encoding audio signal, depending on the type of encoding of this audio signal.</p>
<p id="p-0078" num="0085">The decoder <b>800</b> comprises a demultiplexer <b>801</b> receiving as input the stream of bits from bit multiplexer <b>713</b> (<figref idref="DRAWINGS">FIG. 7</figref>). The received stream of bits is demultiplexed to recover the quantized and encoded spectral coefficients from processed spectrum quantizer <b>711</b>, the quantized scale factors from quantizer <b>705</b>, the quantized LPC coefficients from LPC quantizer <b>706</b> and the encoded excitation of the LPC filter from encoder <b>712</b>.</p>
<p id="p-0079" num="0086">The recovered quantized LPC coefficients (transform-coded window of the windowed audio signal) from demultiplexer <b>801</b> are supplied to a LPC decoder <b>804</b> to produce decoded LPC coefficients. The recovered encoded excitation of the LPC filter from demultiplexer <b>301</b> is supplied to and decoded by an ACELP excitation decoder <b>805</b>. An ACELP synthesis filter <b>806</b> is responsive to the decoded LPC coefficients from decoder <b>804</b> and to the decoded excitation from decoder <b>805</b> to produce an ACELP-decoded audio signal.</p>
<p id="p-0080" num="0087">The recovered quantized scale factors are supplied to and decoded by a scale factors decoder <b>803</b>.</p>
<p id="p-0081" num="0088">The recovered quantized and encoded spectral coefficients are supplied to a spectral coefficient decoder <b>802</b>. Decoder <b>802</b> produces decoded spectral coefficients which are used as input by a FDNS processor <b>807</b>. The operation of FDNS processor <b>807</b> is as described in <figref idref="DRAWINGS">FIG. 2</figref>, starting after processor Q and ending before processor <b>204</b> (inverse transform processor). The FDNS processor <b>807</b> is supplied with the decoded spectral coefficients from decoder <b>802</b>, and an output of adder <b>808</b> which produces sets of noise gains, for example the above described sets of noise gains g<sub>1</sub>[m] and g<sub>2</sub>[m] resulting from the sum of decoded scale factors from decoder <b>803</b> and noise gains calculated by calculator <b>809</b>. Calculator <b>809</b> computes noise gains from the decoded LPC coefficients produced by decoder <b>804</b>. As in the encoder <b>700</b> (<figref idref="DRAWINGS">FIG. 7</figref>), any combination of scale factors (from a psychoacoustic model) and noise gains (from an LPC model) are possible, from using only scale factors to using only noise gains, to any proportion of scale factors and noise gains. For example, the scale factors from the psychoacoustic model can be used as a second set of gains or scale factors to refine, or correct, the noise gains from the LPC model. Accordingly to another alternative, the combination of the noise gains and scale factors comprises the sum of the noise gains and scale factors, where the scale factors are used as a correction to the noise gains. The resulting spectral coefficients at the output of the FDNS processor <b>807</b> are subjected to an IMDCT processor <b>810</b> to produce a transform-decoded audio signal.</p>
<p id="p-0082" num="0089">Finally, a windowing and overlap/add processor <b>811</b> combines the ACELP-decoded audio signal from the ACELP synthesis filter <b>806</b> with the transform-decoded audio signal from the IMDCT processor <b>810</b> to produce a synthesis audio signal.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08626517-20140107-M00001.NB">
<img id="EMI-M00001" he="6.01mm" wi="76.20mm" file="US08626517-20140107-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08626517-20140107-M00002.NB">
<img id="EMI-M00002" he="6.01mm" wi="76.20mm" file="US08626517-20140107-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08626517-20140107-M00003.NB">
<img id="EMI-M00003" he="6.01mm" wi="76.20mm" file="US08626517-20140107-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US08626517-20140107-M00004.NB">
<img id="EMI-M00004" he="13.38mm" wi="76.20mm" file="US08626517-20140107-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US08626517-20140107-M00005.NB">
<img id="EMI-M00005" he="13.38mm" wi="76.20mm" file="US08626517-20140107-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US08626517-20140107-M00006.NB">
<img id="EMI-M00006" he="14.14mm" wi="76.20mm" file="US08626517-20140107-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US08626517-20140107-M00007.NB">
<img id="EMI-M00007" he="14.14mm" wi="76.20mm" file="US08626517-20140107-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A frequency-domain noise shaping method for interpolating a spectral shape and a time-domain envelope of a quantization noise in a windowed and transform-coded audio signal, comprising:
<claim-text>splitting transform coefficients of the windowed and transform-coded audio signal into a plurality of spectral bands; and</claim-text>
<claim-text>for each spectral band:
<claim-text>calculating a first gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a first transition between a first time window and a second time window;</claim-text>
<claim-text>calculating a second gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a second transition between the second time window and a third time window; and</claim-text>
<claim-text>an operation of filtering the transform coefficients of the second time window, the filtering operation receiving as first input the transform coefficients of the second time window and as second input the first and second gains to filter said transform coefficients of the second time window using the second input, first and second gains to interpolate between the first and second transitions the spectral shape and the time-domain envelope of the quantization noise.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. A frequency-domain noise shaping method for interpolating a spectral shape and a time-domain envelope of a quantization noise in a windowed and transform-coded audio signal, comprising:
<claim-text>splitting transform coefficients of the windowed and transform-coded audio signal into a plurality of spectral bands; and</claim-text>
<claim-text>for each spectral band:
<claim-text>calculating a first gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a first transition between a first time window and a second time window;</claim-text>
<claim-text>calculating a second gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a second transition between the second time window and a third time window; and</claim-text>
<claim-text>an operation of filtering the transform coefficients of the second time window, the filtering operation receiving as first input the transform coefficients of the second time window and as second input the first and second gains to filter said transform coefficients of the second time window using the second input, first and second gains to interpolate between the first and second transitions the spectral shape and the time-domain envelope of the quantization noise;</claim-text>
<claim-text>wherein the windowed and transform-coded audio signal is windowed using successive overlapping windows,</claim-text>
<claim-text>wherein the first gain is a noise gain calculated at a middle point of an overlap between the first and second time windows, and</claim-text>
<claim-text>wherein the second gain is a noise gain calculated at a middle point of an overlap between the second and third time windows.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The frequency-domain noise shaping method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein calculating the first gain and calculating the second gain comprises applying a linear predictive coding to the windowed and transform-coded audio signal.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. A frequency-domain noise shaping method for interpolating a spectral shape and a time-domain envelope of a quantization noise in a windowed and transform-coded audio signal, comprising:
<claim-text>splitting transform coefficients of the windowed and transform-coded audio signal into a plurality of spectral bands; and</claim-text>
<claim-text>for each spectral band:
<claim-text>calculating a first gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a first transition between a first time window and a second time window;</claim-text>
<claim-text>calculating a second gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a second transition between the second time window and a third time window; and</claim-text>
<claim-text>an operation of filtering the transform coefficients of the second time window, the filtering operation receiving as first input the transform coefficients of the second time window and as second input the first and second gains to filter said transform coefficients of the second time window using the second input, first and second gains to interpolate between the first and second transitions the spectral shape and the time-domain envelope of the quantization noise;</claim-text>
<claim-text>wherein filtering the transform coefficients comprises achieving a desired spectral shape of the quantization noise at the first and second transitions and a smooth transition of an envelope of this spectral shape from the first transition to the second transition.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The frequency-domain noise shaping method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein filtering the transform coefficients is made prior to quantization of the transform coefficients producing the quantization noise.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The frequency-domain noise shaping method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein filtering the transform coefficients is made after quantization of the transform coefficients producing the quantization noise.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The frequency-domain noise shaping method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein filtering the transform coefficients comprises filtering the transform coefficients prior to quantization of the transform coefficients producing the quantization noise, and inverse filtering the transform coefficients after quantization of said transform coefficients.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A frequency-domain noise shaping method for interpolating a spectral shape and a time-domain envelope of a quantization noise in a windowed and transform-coded audio signal, comprising:
<claim-text>splitting transform coefficients of the windowed and transform-coded audio signal into a plurality of spectral bands; and</claim-text>
<claim-text>for each spectral band:
<claim-text>calculating a first gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a first transition between a first time window and a second time window;</claim-text>
<claim-text>calculating a second gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a second transition between the second time window and a third time window; and</claim-text>
<claim-text>an operation of filtering the transform coefficients of the second time window, the filtering operation receiving as first input the transform coefficients of the second time window and as second input the first and second gains to filter said transform coefficients of the second time window using the second input, first and second gains to interpolate between the first and second transitions the spectral shape and the time-domain envelope of the quantization noise;</claim-text>
<claim-text>wherein filtering the transform coefficients comprises calculating filter parameters on the basis of the first and second calculated gains.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The frequency-domain noise shaping method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising, following filtering of the transform coefficients in each of the spectral bands:
<claim-text>quantizing the filtered transform coefficients;</claim-text>
<claim-text>encoding the quantized, filtered transform coefficients; and</claim-text>
<claim-text>transmitting the encoded, quantized, filtered transform coefficients to a receiver or storing the encoded, quantized, filtered transform coefficients in a storage device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The frequency-domain noise shaping method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>receiving from a transceiver or retrieving from a storage device filtered, quantized and encoded transform coefficients;</claim-text>
<claim-text>decoding the filtered, quantized and encoded transform coefficients; and</claim-text>
<claim-text>inverse quantizing the decoded, filtered and quantized transform coefficients.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A frequency-domain noise shaping device for interpolating a spectral shape and a time-domain envelope of a quantization noise in a windowed and transform-coded audio signal having transform coefficients, comprising:
<claim-text>a processor comprising:
<claim-text>a splitter module configured to split the transform coefficients of the windowed and transform-coded audio signal into a plurality of spectral bands;</claim-text>
<claim-text>a calculator module configured to calculate, for each spectral band, a first gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a first transition between a first time window and a second time window, and a second gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a second transition between the second time window and a third time window; and</claim-text>
<claim-text>a filter module configured to filter the transform coefficients of the second time window, the filter module receiving as first input the transform coefficients of the second time window and as second input the first and second gains to filter said transform coefficients of the second time window using the second input, first and second gains to interpolate between the first and second transitions the spectral shape and the time-domain envelope of the quantization noise.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A frequency-domain noise shaping device for interpolating a spectral shape and a time-domain envelope of a quantization noise in a windowed and transform-coded audio signal having transform coefficients, comprising:
<claim-text>a processor comprising:
<claim-text>a splitter module configured to split the transform coefficients of the windowed and transform-coded audio signal into a plurality of spectral bands;</claim-text>
<claim-text>a calculator module configured to calculate, for each spectral band, a first gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a first transition between a first time window and a second time window, and a second gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a second transition between the second time window and a third time window; and</claim-text>
<claim-text>a filter module configured to filter the transform coefficients of the second time window, the filter module receiving as first input the transform coefficients of the second time window and as second input the first and second gains to filter said transform coefficients of the second time window using the second input, first and second gains to interpolate between the first and second transitions the spectral shape and the time-domain envelope of the quantization noise;</claim-text>
</claim-text>
<claim-text>wherein the windowed and transform-coded audio signal is windowed using successive overlapping windows, and wherein the calculator module calculates the first gain at a middle point of an overlap between the first and second time windows, and the second gain at a middle point of an overlap between the second and third time window.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The frequency-domain noise shaping device of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the gain calculator module applies a linear predictive coding to the windowed and transform-coded audio signal in order to calculate the first gain and the second gain.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A frequency-domain noise shaping device for interpolating a spectral shape and a time-domain envelope of a quantization noise in a windowed and transform-coded audio signal having transform coefficients, comprising:
<claim-text>a processor comprising:
<claim-text>a splitter module configured to split the transform coefficients of the windowed and transform-coded audio signal into a plurality of spectral bands;</claim-text>
<claim-text>a calculator module configured to calculate, for each spectral band, a first gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a first transition between a first time window and a second time window, and a second gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a second transition between the second time window and a third time window; and</claim-text>
<claim-text>a filter module configured to filter the transform coefficients of the second time window, the filter module receiving as first input the transform coefficients of the second time window and as second input the first and second gains to filter said transform coefficients of the second time window using the second input, first and second gains to interpolate between the first and second transitions the spectral shape and the time-domain envelope of the quantization noise,</claim-text>
</claim-text>
<claim-text>wherein the transform coefficient filter module achieves a desired spectral shape of the quantization noise at the first and second transitions and a smooth transition of an envelope of this spectral shape from the first transition to the second transition.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The frequency-domain noise shaping device of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the transform coefficient filter module filters the transform coefficients prior to quantization of the transform coefficients producing the quantization noise.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The frequency-domain noise shaping device of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the transform coefficient filter module filters the transform coefficients after quantization of the transform coefficients producing the quantization noise.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The frequency-domain noise shaping device of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the transform coefficient filter module filters the transform coefficients prior to quantization of the transform coefficients producing the quantization noise, and inverse filters the transform coefficients after quantization of said transform coefficients.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. A frequency-domain noise shaping device for interpolating a spectral shape and a time-domain envelope of a quantization noise in a windowed and transform-coded audio signal having transform coefficients, comprising:
<claim-text>a processor comprising:
<claim-text>a splitter module configured to split the transform coefficients of the windowed and transform-coded audio signal into a plurality of spectral bands;</claim-text>
<claim-text>a calculator module configured to calculate, for each spectral band, a first gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a first transition between a first time window and a second time window, and a second gain representing, together with corresponding gains calculated for the other spectral bands, a spectral shape of the quantization noise at a second transition between the second time window and a third time window; and</claim-text>
<claim-text>a filter module configured to filter the transform coefficients of the second time window, the filter module receiving as first input the transform coefficients of the second time window and as second input the first and second gains to filter said transform coefficients of the second time window using the second input, first and second gains to interpolate between the first and second transitions the spectral shape and the time-domain envelope of the quantization noise,</claim-text>
</claim-text>
<claim-text>wherein the transform coefficient filter module calculates filter parameters on the basis of the first and second calculated gains.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The frequency-domain noise shaping device of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein, following filtering of the transform coefficients in each of the spectral bands, the processor:
<claim-text>quantizes the filtered transform coefficients;</claim-text>
<claim-text>encodes the quantized, filtered transform coefficients; and</claim-text>
<claim-text>transmits the encoded, quantized, filtered transform coefficients to a transceiver or stores the encoded, quantized, filtered transform coefficients in a storage device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The frequency-domain noise shaping device of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the processor:
<claim-text>receives from a transceiver or retrieves from a storage device filtered, quantized and encoded transform coefficients;</claim-text>
<claim-text>decodes the filtered, quantized and encoded transform coefficients; and</claim-text>
<claim-text>inverse quantizes the decoded, filtered and quantized transform coefficients.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. An encoder for encoding a windowed audio signal, comprising:
<claim-text>a first coder of the windowed audio signal using a time-domain coding mode;</claim-text>
<claim-text>a second coder of the windowed audio signal using a transform-domain coding mode using a psychoacoustic model and producing a windowed and transform-coded audio signal;</claim-text>
<claim-text>a selector between the first coder using the time-domain coding mode and the second coder using the transform-domain coding mode when encoding a time window of the windowed audio signal; and</claim-text>
<claim-text>a frequency-domain noise shaping device according to <claim-ref idref="CLM-00011">claim 11</claim-ref> for interpolating a spectral shape and a time-domain envelope of a quantization noise in the windowed and transform-coded audio signal, thereby achieving a desired spectral shape of the quantization noise at the first and second transitions and a smooth transition of an envelope of this spectral shape from the first transition to the second transition.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The encoder of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the time-domain coding mode is ACELP and the transform-domain coding mode uses a MDCT.</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The encoder of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the frequency-domain noise shaping device uses, as the first and second gains, noise gains calculated from an LPC filter, scale factors calculated from the psychoacoustic model, or a combination of the noise gains and scale factors.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The encoder of <claim-ref idref="CLM-00023">claim 23</claim-ref>, wherein the combination of the noise gains and scale factors comprises the sum of the noise gains and scale factors, where the scale factors are used as a correction to the noise gains.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The encoder of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the frequency-domain noise shaping device uses, as the first and second gains, noise gains calculated from an LPC filter and a second set of gains or scale factors, used as a correction to the noise gains.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. A decoder for decoding an encoded, windowed audio signal, comprising:
<claim-text>a first decoder of the encoded, windowed audio signal using a time-domain decoding mode;</claim-text>
<claim-text>a second decoder of the encoded, windowed audio signal using a transform-domain decoding mode using a psychoacoustic model; and</claim-text>
<claim-text>a selector between the first decoder using the time-domain decoding mode and the second decoder using the transform-domain decoding mode when decoding a time window of the encoded, windowed audio signal; and</claim-text>
<claim-text>a frequency-domain noise shaping device according to <claim-ref idref="CLM-00011">claim 11</claim-ref> for interpolating a spectral shape and a time-domain envelope of a quantization noise in transform-coded windows of the encoded, windowed audio signal, thereby achieving a desired spectral shape of the quantization noise at the first and second transitions and a smooth transition of an envelope of this spectral shape from the first transition to the second transition.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The decoder of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the time-domain decoding mode is ACELP and the transform-domain decoding mode uses a MDCT.</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text>28. The decoder of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the frequency-domain noise shaping device uses, as the first and second gains, noise gains calculated from an LPC filter, scale factors calculated from the psychoacoustic model, or a combination of the noise gains and scale factors.</claim-text>
</claim>
<claim id="CLM-00029" num="00029">
<claim-text>29. The decoder of <claim-ref idref="CLM-00028">claim 28</claim-ref>, wherein the combination of noise gains and scale factors comprises the sum of the noise gains and scale factors, where the scale factors are used as a correction to the noise gains.</claim-text>
</claim>
<claim id="CLM-00030" num="00030">
<claim-text>30. The decoder of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the frequency-domain noise shaping device uses, as the first and second gains, noise gains calculated from an LPC filter and a second set of gains or scale factors, used as a correction to the noise gains.</claim-text>
</claim>
<claim id="CLM-00031" num="00031">
<claim-text>31. The frequency-domain noise shaping device of <claim-ref idref="CLM-00011">claim 11</claim-ref> further comprising:
<claim-text>a storage device,</claim-text>
<claim-text>wherein the processor is operably connected to the storage device for storing or retrieving the filtered transform coefficients.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00032" num="00032">
<claim-text>32. The frequency-domain noise shaping device of <claim-ref idref="CLM-00011">claim 11</claim-ref> further comprising:
<claim-text>a transceiver,</claim-text>
<claim-text>wherein the processor is operably connected to the transceiver for sending or receiving the filtered transform coefficients.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00033" num="00033">
<claim-text>33. The frequency-domain noise shaping device of <claim-ref idref="CLM-00012">claim 12</claim-ref> further comprising:
<claim-text>a storage device,</claim-text>
<claim-text>wherein the processor is operably connected to the storage device for storing or retrieving the filtered transform coefficients.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00034" num="00034">
<claim-text>34. The frequency-domain noise shaping device of <claim-ref idref="CLM-00012">claim 12</claim-ref> further comprising:
<claim-text>a transceiver,</claim-text>
<claim-text>wherein the processor is operably connected to the transceiver for sending or receiving the filtered transform coefficients.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00035" num="00035">
<claim-text>35. The frequency-domain noise shaping device of <claim-ref idref="CLM-00014">claim 14</claim-ref> further comprising:
<claim-text>a storage device,</claim-text>
<claim-text>wherein the processor is operably connected to the storage device for storing or retrieving the filtered transform coefficients.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00036" num="00036">
<claim-text>36. The frequency-domain noise shaping device of <claim-ref idref="CLM-00014">claim 14</claim-ref> further comprising:
<claim-text>a transceiver,</claim-text>
<claim-text>wherein the processor is operably connected to the transceiver for sending or receiving the filtered transform coefficients.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00037" num="00037">
<claim-text>37. The frequency-domain noise shaping device of <claim-ref idref="CLM-00018">claim 18</claim-ref> further comprising:
<claim-text>a storage device,</claim-text>
<claim-text>wherein the processor is operably connected to the storage device for storing or retrieving the filtered transform coefficients.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00038" num="00038">
<claim-text>38. The frequency-domain noise shaping device of <claim-ref idref="CLM-00018">claim 18</claim-ref> further comprising:
<claim-text>a transceiver,</claim-text>
<claim-text>wherein the processor is operably connected to the transceiver for sending or receiving the filtered transform coefficients.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
